"use strict";var Ko=Object.defineProperty,Jo=Object.defineProperties,$o=Object.getOwnPropertyDescriptors,vo=Object.getOwnPropertySymbols,Uo=Object.prototype.hasOwnProperty,zo=Object.prototype.propertyIsEnumerable,Wo=(Kt,Mt,d)=>Mt in Kt?Ko(Kt,Mt,{enumerable:!0,configurable:!0,writable:!0,value:d}):Kt[Mt]=d,Xt=(Kt,Mt)=>{for(var d in Mt||(Mt={}))Uo.call(Mt,d)&&Wo(Kt,d,Mt[d]);if(vo)for(var d of vo(Mt))zo.call(Mt,d)&&Wo(Kt,d,Mt[d]);return Kt},je=(Kt,Mt)=>Jo(Kt,$o(Mt)),Fo=(Kt,Mt)=>{var d={};for(var T in Kt)Uo.call(Kt,T)&&Mt.indexOf(T)<0&&(d[T]=Kt[T]);if(null!=Kt&&vo)for(var T of vo(Kt))Mt.indexOf(T)<0&&zo.call(Kt,T)&&(d[T]=Kt[T]);return d};(self.webpackChunk_taiga_ui_components=self.webpackChunk_taiga_ui_components||[]).push([[70224],{40256:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{CommandManager:()=>Ce,Editor:()=>lo,Extension:()=>ge,InputRule:()=>L,Mark:()=>Vn,Node:()=>jn,NodeView:()=>_o,PasteRule:()=>Gt,Tracker:()=>wo,callOrReturn:()=>st,combineTransactionSteps:()=>mo,defaultBlockAt:()=>ao,escapeForRegEx:()=>To,extensions:()=>Se,findChildren:()=>yo,findChildrenInRange:()=>Eo,findParentNode:()=>gn,findParentNodeClosestToPos:()=>Un,generateHTML:()=>bo,generateJSON:()=>go,generateText:()=>xo,getAttributes:()=>fo,getChangedRanges:()=>Po,getDebugJSON:()=>co,getExtensionField:()=>G,getHTMLFromFragment:()=>to,getMarkAttributes:()=>pe,getMarkRange:()=>on,getMarkType:()=>ye,getMarksBetween:()=>uo,getNodeAttributes:()=>Cn,getNodeType:()=>B,getSchema:()=>no,getText:()=>io,getTextBetween:()=>un,getTextContentFromNodes:()=>g,getTextSerializersFromSchema:()=>Le,inputRulesPlugin:()=>kt,isActive:()=>ro,isList:()=>An,isMarkActive:()=>sn,isNodeActive:()=>oe,isNodeEmpty:()=>so,isNodeSelection:()=>Ao,isTextSelection:()=>rn,markInputRule:()=>So,markPasteRule:()=>ko,mergeAttributes:()=>R,nodeInputRule:()=>Bo,pasteRulesPlugin:()=>be,posToDOMRect:()=>po,textInputRule:()=>Ho,textPasteRule:()=>Co,textblockTypeInputRule:()=>No,wrappingInputRule:()=>Io});var T=d(62463),s=d(43594),H=d(13903),P=d(35917),m=d(38480);const ct=(n,t)=>!n.selection.empty&&(t&&t(n.tr.deleteSelection().scrollIntoView()),!0),I=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("backward",n):o.parentOffset>0))return!1;let i=ut(o);if(!i){let c=o.blockRange(),p=c&&(0,m.k9)(c);return null!=p&&(t&&t(n.tr.lift(c,p).scrollIntoView()),!0)}let r=i.nodeBefore;if(!r.type.spec.isolating&&Nt(n,i,t))return!0;if(0==o.parent.content.size&&(pt(r,"end")||T.qv.isSelectable(r))){let c=(0,m.dR)(n.doc,o.before(),o.after(),P.p2.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=n.tr.step(c);p.setSelection(pt(r,"end")?T.Y1.findFrom(p.doc.resolve(p.mapping.map(i.pos,-1)),-1):T.qv.create(p.doc,i.pos-r.nodeSize)),t(p.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos-r.nodeSize,i.pos).scrollIntoView()),0))};function pt(n,t,e=!1){for(let o=n;o;o="start"==t?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(e&&1!=o.childCount)return!1}return!1}const ot=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):o.parentOffset>0)return!1;r=ut(o)}let c=r&&r.nodeBefore;return!(!c||!T.qv.isSelectable(c)||(t&&t(n.tr.setSelection(T.qv.create(n.doc,r.pos-c.nodeSize)).scrollIntoView()),0))};function ut(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}const ht=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size))return!1;let i=mt(o);if(!i)return!1;let r=i.nodeAfter;if(Nt(n,i,t))return!0;if(0==o.parent.content.size&&(pt(r,"start")||T.qv.isSelectable(r))){let c=(0,m.dR)(n.doc,o.before(),o.after(),P.p2.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=n.tr.step(c);p.setSelection(pt(r,"start")?T.Y1.findFrom(p.doc.resolve(p.mapping.map(i.pos)),1):T.qv.create(p.doc,p.mapping.map(i.pos))),t(p.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos,i.pos+r.nodeSize).scrollIntoView()),0))},xt=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size)return!1;r=mt(o)}let c=r&&r.nodeAfter;return!(!c||!T.qv.isSelectable(c)||(t&&t(n.tr.setSelection(T.qv.create(n.doc,r.pos)).scrollIntoView()),0))};function mt(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const Et=(n,t)=>{let{$head:e,$anchor:o}=n.selection;return!(!e.parent.type.spec.code||!e.sameParent(o)||(t&&t(n.tr.insertText("\n").scrollIntoView()),0))};function X(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Q=(n,t)=>{let{$head:e,$anchor:o}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(o))return!1;let i=e.node(-1),r=e.indexAfter(-1),c=X(i.contentMatchAt(r));if(!c||!i.canReplaceWith(r,r,c))return!1;if(t){let p=e.after(),h=n.tr.replaceWith(p,p,c.createAndFill());h.setSelection(T.Y1.near(h.doc.resolve(p),1)),t(h.scrollIntoView())}return!0},it=(n,t)=>{let e=n.selection,{$from:o,$to:i}=e;if(e instanceof T.C1||o.parent.inlineContent||i.parent.inlineContent)return!1;let r=X(i.parent.contentMatchAt(i.indexAfter()));if(!r||!r.isTextblock)return!1;if(t){let c=(!o.parentOffset&&i.index()<i.parent.childCount?o:i).pos,p=n.tr.insert(c,r.createAndFill());p.setSelection(T.Bs.create(p.doc,c+1)),t(p.scrollIntoView())}return!0},K=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let r=e.before();if((0,m.Ax)(n.doc,r))return t&&t(n.tr.split(r).scrollIntoView()),!0}let o=e.blockRange(),i=o&&(0,m.k9)(o);return null!=i&&(t&&t(n.tr.lift(o,i).scrollIntoView()),!0)};function Nt(n,t,e){let r,c,o=t.nodeBefore,i=t.nodeAfter;if(o.type.spec.isolating||i.type.spec.isolating)return!1;if(function(n,t,e){let o=t.nodeBefore,i=t.nodeAfter,r=t.index();return!(!(o&&i&&o.type.compatibleContent(i.type))||(!o.content.size&&t.parent.canReplace(r-1,r)?(e&&e(n.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(r,r+1)||!i.isTextblock&&!(0,m.Mn)(n.doc,t.pos)||(e&&e(n.tr.clearIncompatible(t.pos,o.type,o.contentMatchAt(o.childCount)).join(t.pos).scrollIntoView()),0)))}(n,t,e))return!0;let p=t.parent.canReplace(t.index(),t.index()+1);if(p&&(r=(c=o.contentMatchAt(o.childCount)).findWrapping(i.type))&&c.matchType(r[0]||i.type).validEnd){if(e){let F=t.pos+i.nodeSize,Y=P.HY.empty;for(let It=r.length-1;It>=0;It--)Y=P.HY.from(r[It].create(null,Y));Y=P.HY.from(o.copy(Y));let tt=n.tr.step(new m.FC(t.pos-1,F,t.pos,F,new P.p2(Y,1,0),r.length,!0)),Ct=F+2*r.length;(0,m.Mn)(tt.doc,Ct)&&tt.join(Ct),e(tt.scrollIntoView())}return!0}let h=T.Y1.findFrom(t,1),x=h&&h.$from.blockRange(h.$to),b=x&&(0,m.k9)(x);if(null!=b&&b>=t.depth)return e&&e(n.tr.lift(x,b).scrollIntoView()),!0;if(p&&pt(i,"start",!0)&&pt(o,"end")){let F=o,Y=[];for(;Y.push(F),!F.isTextblock;)F=F.lastChild;let tt=i,Ct=1;for(;!tt.isTextblock;tt=tt.firstChild)Ct++;if(F.canReplace(F.childCount,F.childCount,tt.content)){if(e){let It=P.HY.empty;for(let Qt=Y.length-1;Qt>=0;Qt--)It=P.HY.from(Y[Qt].copy(It));e(n.tr.step(new m.FC(t.pos-Y.length,t.pos+i.nodeSize,t.pos+Ct,t.pos+i.nodeSize-Ct,new P.p2(It,Y.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function zt(n){return function(t,e){let o=t.selection,i=n<0?o.$from:o.$to,r=i.depth;for(;i.node(r).isInline;){if(!r)return!1;r--}return!!i.node(r).isTextblock&&(e&&e(t.tr.setSelection(T.Bs.create(t.doc,n<0?i.start(r):i.end(r)))),!0)}}const ee=zt(-1),ft=zt(1);function et(n,t=null){return function(e,o){let{from:i,to:r}=e.selection,c=!1;return e.doc.nodesBetween(i,r,(p,h)=>{if(c)return!1;if(p.isTextblock&&!p.hasMarkup(n,t))if(p.type==n)c=!0;else{let x=e.doc.resolve(h),b=x.index();c=x.parent.canReplaceWith(b,b+1,n)}}),!!c&&(o&&o(e.tr.setBlockType(i,r,n,t).scrollIntoView()),!0)}}function dt(...n){return function(t,e,o){for(let i=0;i<n.length;i++)if(n[i](t,e,o))return!0;return!1}}let Lt=dt(ct,I,ot),Jt=dt(ct,ht,xt);const qt={Enter:dt(Et,it,K,(n,t)=>{let{$from:e,$to:o}=n.selection;if(n.selection instanceof T.qv&&n.selection.node.isBlock)return!(!e.parentOffset||!(0,m.Ax)(n.doc,e.pos)||(t&&t(n.tr.split(e.pos).scrollIntoView()),0));if(!e.parent.isBlock)return!1;if(t){let i=o.parentOffset==o.parent.content.size,r=n.tr;(n.selection instanceof T.Bs||n.selection instanceof T.C1)&&r.deleteSelection();let c=0==e.depth?null:X(e.node(-1).contentMatchAt(e.indexAfter(-1))),p=i&&c?[{type:c}]:void 0,h=(0,m.Ax)(r.doc,r.mapping.map(e.pos),1,p);if(!p&&!h&&(0,m.Ax)(r.doc,r.mapping.map(e.pos),1,c?[{type:c}]:void 0)&&(c&&(p=[{type:c}]),h=!0),h&&(r.split(r.mapping.map(e.pos),1,p),!i&&!e.parentOffset&&e.parent.type!=c)){let x=r.mapping.map(e.before()),b=r.doc.resolve(x);c&&e.node(-1).canReplaceWith(b.index(),b.index()+1,c)&&r.setNodeMarkup(r.mapping.map(e.before()),c)}t(r.scrollIntoView())}return!0}),"Mod-Enter":Q,Backspace:Lt,"Mod-Backspace":Lt,"Shift-Backspace":Lt,Delete:Jt,"Mod-Delete":Jt,"Mod-a":(n,t)=>(t&&t(n.tr.setSelection(new T.C1(n.doc))),!0)},ce={"Ctrl-h":qt.Backspace,"Alt-Backspace":qt["Mod-Backspace"],"Ctrl-d":qt.Delete,"Ctrl-Alt-Backspace":qt["Mod-Delete"],"Alt-Delete":qt["Mod-Delete"],"Alt-d":qt["Mod-Delete"],"Ctrl-a":ee,"Ctrl-e":ft};for(let n in qt)ce[n]=qt[n];function _e(n){const{state:t,transaction:e}=n;let{selection:o}=e,{doc:i}=e,{storedMarks:r}=e;return je(Xt({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return r},get selection(){return o},get doc(){return i},get tr(){return o=e.selection,i=e.doc,r=e.storedMarks,e}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class Ce{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:o}=this,{view:i}=e,{tr:r}=o,c=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([p,h])=>[p,(...b)=>{const F=h(...b)(c);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(r),F}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:c}=i,p=[],h=!!t,x=t||r.tr,F=je(Xt({},Object.fromEntries(Object.entries(o).map(([Y,tt])=>[Y,(...It)=>{const Ht=this.buildProps(x,e),Qt=tt(...It)(Ht);return p.push(Qt),F}]))),{run:()=>(!h&&e&&!x.getMeta("preventDispatch")&&!this.hasCustomState&&c.dispatch(x),p.every(Y=>!0===Y))});return F}createCan(t){const{rawCommands:e,state:o}=this,i=void 0,r=t||o.tr,c=this.buildProps(r,i),p=Object.fromEntries(Object.entries(e).map(([h,x])=>[h,(...b)=>x(...b)(je(Xt({},c),{dispatch:i}))]));return je(Xt({},p),{chain:()=>this.createChain(r,i)})}buildProps(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:c}=i;r.storedMarks&&t.setStoredMarks(r.storedMarks);const p={tr:t,editor:i,view:c,state:_e({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(o).map(([h,x])=>[h,(...b)=>x(...b)(p)]))}};return p}}function G(n,t,e){return void 0===n.config[t]&&n.parent?G(n.parent,t,e):"function"==typeof n.config[t]?n.config[t].bind(je(Xt({},e),{parent:n.parent?G(n.parent,t,e):null})):n.config[t]}function E(n){return{baseExtensions:n.filter(i=>"extension"===i.type),nodeExtensions:n.filter(i=>"node"===i.type),markExtensions:n.filter(i=>"mark"===i.type)}}function D(n){const t=[],{nodeExtensions:e,markExtensions:o}=E(n),i=[...e,...o],r={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(c=>{const h=G(c,"addGlobalAttributes",{name:c.name,options:c.options,storage:c.storage});h&&h().forEach(b=>{b.types.forEach(F=>{Object.entries(b.attributes).forEach(([Y,tt])=>{t.push({type:F,name:Y,attribute:Xt(Xt({},r),tt)})})})})}),i.forEach(c=>{const h=G(c,"addAttributes",{name:c.name,options:c.options,storage:c.storage});if(!h)return;const x=h();Object.entries(x).forEach(([b,F])=>{const Y=Xt(Xt({},r),F);F.isRequired&&void 0===F.default&&delete Y.default,t.push({type:c.name,name:b,attribute:Y})})}),t}function B(n,t){if("string"==typeof n){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}function R(...n){return n.filter(t=>!!t).reduce((t,e)=>{const o=Xt({},t);return Object.entries(e).forEach(([i,r])=>{o[i]=o[i]?"class"===i?[o[i],r].join(" "):"style"===i?[o[i],r].join("; "):r:r}),o},{})}function $(n,t){return t.filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,o)=>R(e,o),{})}function U(n){return"function"==typeof n}function st(n,t,...e){return U(n)?t?n.bind(t)(...e):n(...e):n}function $t(n,t){return n.style?n:je(Xt({},n),{getAttrs:e=>{const o=n.getAttrs?n.getAttrs(e):n.attrs;if(!1===o)return!1;const i=t.reduce((r,c)=>{const p=c.attribute.parseHTML?c.attribute.parseHTML(e):function(n){return"string"!=typeof n?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):"true"===n||"false"!==n&&n}(e.getAttribute(c.name));return null==p?r:je(Xt({},r),{[c.name]:p})},{});return Xt(Xt({},o),i)}})}function Zt(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>("attrs"!==t||!function(n={}){return 0===Object.keys(n).length&&n.constructor===Object}(e))&&null!=e))}function z(n){var t;const e=D(n),{nodeExtensions:o,markExtensions:i}=E(n),r=null===(t=o.find(h=>G(h,"topNode")))||void 0===t?void 0:t.name,c=Object.fromEntries(o.map(h=>{const x=e.filter(Ht=>Ht.type===h.name),b={name:h.name,options:h.options,storage:h.storage},F=n.reduce((Ht,Qt)=>{const me=G(Qt,"extendNodeSchema",b);return Xt(Xt({},Ht),me?me(h):{})},{}),Y=Zt(je(Xt({},F),{content:st(G(h,"content",b)),marks:st(G(h,"marks",b)),group:st(G(h,"group",b)),inline:st(G(h,"inline",b)),atom:st(G(h,"atom",b)),selectable:st(G(h,"selectable",b)),draggable:st(G(h,"draggable",b)),code:st(G(h,"code",b)),defining:st(G(h,"defining",b)),isolating:st(G(h,"isolating",b)),attrs:Object.fromEntries(x.map(Ht=>{var Qt;return[Ht.name,{default:null===(Qt=null==Ht?void 0:Ht.attribute)||void 0===Qt?void 0:Qt.default}]}))})),tt=st(G(h,"parseHTML",b));tt&&(Y.parseDOM=tt.map(Ht=>$t(Ht,x)));const Ct=G(h,"renderHTML",b);Ct&&(Y.toDOM=Ht=>Ct({node:Ht,HTMLAttributes:$(Ht,x)}));const It=G(h,"renderText",b);return It&&(Y.toText=It),[h.name,Y]})),p=Object.fromEntries(i.map(h=>{const x=e.filter(It=>It.type===h.name),b={name:h.name,options:h.options,storage:h.storage},F=n.reduce((It,Ht)=>{const Qt=G(Ht,"extendMarkSchema",b);return Xt(Xt({},It),Qt?Qt(h):{})},{}),Y=Zt(je(Xt({},F),{inclusive:st(G(h,"inclusive",b)),excludes:st(G(h,"excludes",b)),group:st(G(h,"group",b)),spanning:st(G(h,"spanning",b)),code:st(G(h,"code",b)),attrs:Object.fromEntries(x.map(It=>{var Ht;return[It.name,{default:null===(Ht=null==It?void 0:It.attribute)||void 0===Ht?void 0:Ht.default}]}))})),tt=st(G(h,"parseHTML",b));tt&&(Y.parseDOM=tt.map(It=>$t(It,x)));const Ct=G(h,"renderHTML",b);return Ct&&(Y.toDOM=It=>Ct({mark:It,HTMLAttributes:$(It,x)})),[h.name,Y]}));return new P.V_({topNode:r,nodes:c,marks:p})}function l(n,t){return t.nodes[n]||t.marks[n]||null}function u(n,t){return Array.isArray(t)?t.some(e=>("string"==typeof e?e:e.name)===n.name):t}const g=(n,t=500)=>{let e="";return n.parent.nodesBetween(Math.max(0,n.parentOffset-t),n.parentOffset,(o,i,r,c)=>{var p,h;e+=(null===(h=(p=o.type.spec).toText)||void 0===h?void 0:h.call(p,{node:o,pos:i,parent:r,index:c}))||o.textContent||"%leaf%"}),e};function O(n){return"[object RegExp]"===Object.prototype.toString.call(n)}class L{constructor(t){this.find=t.find,this.handler=t.handler}}function _t(n){var t;const{editor:e,from:o,to:i,text:r,rules:c,plugin:p}=n,{view:h}=e;if(h.composing)return!1;const x=h.state.doc.resolve(o);if(x.parent.type.spec.code||(null===(t=x.nodeBefore||x.nodeAfter)||void 0===t?void 0:t.marks.find(Y=>Y.type.spec.code)))return!1;let b=!1;const F=g(x)+r;return c.forEach(Y=>{if(b)return;const tt=((n,t)=>{if(O(t))return t.exec(n);const e=t(n);if(!e)return null;const o=[];return o.push(e.text),o.index=e.index,o.input=n,o.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(e.replaceWith)),o})(F,Y.find);if(!tt)return;const Ct=h.state.tr,It=_e({state:h.state,transaction:Ct}),Ht={from:o-(tt[0].length-r.length),to:i},{commands:Qt,chain:me,can:Ne}=new Ce({editor:e,state:It});null===Y.handler({state:It,range:Ht,match:tt,commands:Qt,chain:me,can:Ne})||!Ct.steps.length||(Ct.setMeta(p,{transform:Ct,from:o,to:i,text:r}),h.dispatch(Ct),b=!0)}),b}function kt(n){const{editor:t,rules:e}=n,o=new T.Sy({state:{init:()=>null,apply:(i,r)=>i.getMeta(o)||(i.selectionSet||i.docChanged?null:r)},props:{handleTextInput:(i,r,c,p)=>_t({editor:t,from:r,to:c,text:p,rules:e,plugin:o}),handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:r}=i.state.selection;r&&_t({editor:t,from:r.pos,to:r.pos,text:"",rules:e,plugin:o})}),!1)},handleKeyDown(i,r){if("Enter"!==r.key)return!1;const{$cursor:c}=i.state.selection;return!!c&&_t({editor:t,from:c.pos,to:c.pos,text:"\n",rules:e,plugin:o})}},isInputRules:!0});return o}class Gt{constructor(t){this.find=t.find,this.handler=t.handler}}function be(n){const{editor:t,rules:e}=n;let o=null,i=!1,r=!1;return e.map(p=>new T.Sy({view(h){const x=b=>{var F;o=(null===(F=h.dom.parentElement)||void 0===F?void 0:F.contains(b.target))?h.dom.parentElement:null};return window.addEventListener("dragstart",x),{destroy(){window.removeEventListener("dragstart",x)}}},props:{handleDOMEvents:{drop:h=>(r=o===h.dom.parentElement,!1),paste:(h,x)=>{var b;const F=null===(b=x.clipboardData)||void 0===b?void 0:b.getData("text/html");return i=!!(null==F?void 0:F.includes("data-pm-slice")),!1}}},appendTransaction:(h,x,b)=>{const F=h[0],Y="paste"===F.getMeta("uiEvent")&&!i,tt="drop"===F.getMeta("uiEvent")&&!r;if(!Y&&!tt)return;const Ct=x.doc.content.findDiffStart(b.doc.content),It=x.doc.content.findDiffEnd(b.doc.content);if(!function(n){return"number"==typeof n}(Ct)||!It||Ct===It.b)return;const Ht=b.tr,Qt=_e({state:b,transaction:Ht});return function(n){const{editor:t,state:e,from:o,to:i,rule:r}=n,{commands:c,chain:p,can:h}=new Ce({editor:t,state:e}),x=[];return e.doc.nodesBetween(o,i,(F,Y)=>{if(!F.isTextblock||F.type.spec.code)return;const tt=Math.max(o,Y),Ct=Math.min(i,Y+F.content.size);((n,t)=>{if(O(t))return[...n.matchAll(t)];const e=t(n);return e?e.map(o=>{const i=[];return i.push(o.text),i.index=o.index,i.input=n,i.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(o.replaceWith)),i}):[]})(F.textBetween(tt-Y,Ct-Y,void 0,"\ufffc"),r.find).forEach(Qt=>{if(void 0===Qt.index)return;const me=tt+Qt.index+1,Ne=me+Qt[0].length,nn={from:e.tr.mapping.map(me),to:e.tr.mapping.map(Ne)},He=r.handler({state:e,range:nn,match:Qt,commands:c,chain:p,can:h});x.push(He)})}),x.every(F=>null!==F)}({editor:t,state:Qt,from:Math.max(Ct-1,0),to:It.b,rule:p})&&Ht.steps.length?Ht:void 0}}))}class Ge{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=Ge.resolve(t),this.schema=z(this.extensions),this.extensions.forEach(o=>{var i;this.editor.extensionStorage[o.name]=o.storage;const r={name:o.name,options:o.options,storage:o.storage,editor:this.editor,type:l(o.name,this.schema)};"mark"===o.type&&(null===(i=st(G(o,"keepOnSplit",r)))||void 0===i||i)&&this.splittableMarks.push(o.name);const c=G(o,"onBeforeCreate",r);c&&this.editor.on("beforeCreate",c);const p=G(o,"onCreate",r);p&&this.editor.on("create",p);const h=G(o,"onUpdate",r);h&&this.editor.on("update",h);const x=G(o,"onSelectionUpdate",r);x&&this.editor.on("selectionUpdate",x);const b=G(o,"onTransaction",r);b&&this.editor.on("transaction",b);const F=G(o,"onFocus",r);F&&this.editor.on("focus",F);const Y=G(o,"onBlur",r);Y&&this.editor.on("blur",Y);const tt=G(o,"onDestroy",r);tt&&this.editor.on("destroy",tt)})}static resolve(t){const e=Ge.sort(Ge.flatten(t)),o=function(n){const t=n.filter((e,o)=>n.indexOf(e)!==o);return[...new Set(t)]}(e.map(i=>i.name));return o.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${o.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(e=>{const i=G(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return i?[e,...this.flatten(i())]:e}).flat(10)}static sort(t){return t.sort((o,i)=>{const r=G(o,"priority")||100,c=G(i,"priority")||100;return r>c?-1:r<c?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const i=G(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:l(e.name,this.schema)});return i?Xt(Xt({},t),i()):t},{})}get plugins(){const{editor:t}=this,e=Ge.sort([...this.extensions].reverse()),o=[],i=[],r=e.map(c=>{const p={name:c.name,options:c.options,storage:c.storage,editor:t,type:l(c.name,this.schema)},h=[],x=G(c,"addKeyboardShortcuts",p);if(x){const tt=Object.fromEntries(Object.entries(x()).map(([It,Ht])=>[It,()=>Ht({editor:t})])),Ct=(0,H.h)(tt);h.push(Ct)}const b=G(c,"addInputRules",p);u(c,t.options.enableInputRules)&&b&&o.push(...b());const F=G(c,"addPasteRules",p);u(c,t.options.enablePasteRules)&&F&&i.push(...F());const Y=G(c,"addProseMirrorPlugins",p);if(Y){const tt=Y();h.push(...tt)}return h}).flat();return[kt({editor:t,rules:o}),...be({editor:t,rules:i}),...r]}get attributes(){return D(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=E(this.extensions);return Object.fromEntries(e.filter(o=>!!G(o,"addNodeView")).map(o=>{const i=this.attributes.filter(h=>h.type===o.name),r={name:o.name,options:o.options,storage:o.storage,editor:t,type:B(o.name,this.schema)},c=G(o,"addNodeView",r);return c?[o.name,(h,x,b,F)=>{const Y=$(h,i);return c()({editor:t,node:h,getPos:b,decorations:F,HTMLAttributes:Y,extension:o})}]:[]}))}}function vn(n){return"Object"===function(n){return Object.prototype.toString.call(n).slice(8,-1)}(n)&&n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function dn(n,t){const e=Xt({},n);return vn(n)&&vn(t)&&Object.keys(t).forEach(o=>{vn(t[o])?o in n?e[o]=dn(n[o],t[o]):Object.assign(e,{[o]:t[o]}):Object.assign(e,{[o]:t[o]})}),e}class ge{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Xt(Xt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=st(G(this,"addOptions",{name:this.name}))),this.storage=st(G(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ge(t)}configure(t={}){const e=this.extend();return e.options=dn(this.options,t),e.storage=st(G(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new ge(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=st(G(e,"addOptions",{name:e.name})),e.storage=st(G(e,"addStorage",{name:e.name,options:e.options})),e}}function un(n,t,e){const{from:o,to:i}=t,{blockSeparator:r="\n\n",textSerializers:c={}}=e||{};let p="",h=!0;return n.nodesBetween(o,i,(x,b,F,Y)=>{var tt;const Ct=null==c?void 0:c[x.type.name];Ct?(x.isBlock&&!h&&(p+=r,h=!0),F&&(p+=Ct({node:x,pos:b,parent:F,index:Y,range:t}))):x.isText?(p+=null===(tt=null==x?void 0:x.text)||void 0===tt?void 0:tt.slice(Math.max(o,b)-b,i-b),h=!1):x.isBlock&&!h&&(p+=r,h=!0)}),p}function Le(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const fe=ge.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:o,selection:i}=t,{ranges:r}=i;return un(o,{from:Math.min(...r.map(b=>b.$from.pos)),to:Math.max(...r.map(b=>b.$to.pos))},{textSerializers:Le(e)})}}})]}});function an(n,t,e={strict:!0}){const o=Object.keys(t);return!o.length||o.every(i=>e.strict?t[i]===n[i]:O(t[i])?t[i].test(n[i]):t[i]===n[i])}function pn(n,t,e={}){return n.find(o=>o.type===t&&an(o.attrs,e))}function hn(n,t,e={}){return!!pn(n,t,e)}function on(n,t,e={}){if(!n||!t)return;let o=n.parent.childAfter(n.parentOffset);if(n.parentOffset===o.offset&&0!==o.offset&&(o=n.parent.childBefore(n.parentOffset)),!o.node)return;const i=pn([...o.node.marks],t,e);if(!i)return;let r=o.index,c=n.start()+o.offset,p=r+1,h=c+o.node.nodeSize;for(pn([...o.node.marks],t,e);r>0&&i.isInSet(n.parent.child(r-1).marks);)r-=1,c-=n.parent.child(r).nodeSize;for(;p<n.parent.childCount&&hn([...n.parent.child(p).marks],t,e);)h+=n.parent.child(p).nodeSize,p+=1;return{from:c,to:h}}function ye(n,t){if("string"==typeof n){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}function Ze(n){return n&&"object"==typeof n&&!Array.isArray(n)&&!function(n){var t;return"class"===(null===(t=n.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(n)}function rn(n){return Ze(n)&&n instanceof T.Bs}function Be(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function C(n,t=null){if(!t)return null;const e=T.Y1.atStart(n),o=T.Y1.atEnd(n);if("start"===t||!0===t)return e;if("end"===t)return o;const i=e.from,r=o.to;return"all"===t?T.Bs.create(n,Be(0,i,r),Be(n.content.size,i,r)):T.Bs.create(n,Be(t,i,r),Be(t,i,r))}function f(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function N(n){const t=`<body>${n}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function Z(n,t,e){if(e=Xt({slice:!0,parseOptions:{}},e),"object"==typeof n&&null!==n)try{return Array.isArray(n)?P.HY.fromArray(n.map(o=>t.nodeFromJSON(o))):t.nodeFromJSON(n)}catch(o){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),Z("",t,e)}if("string"==typeof n){const o=P.aw.fromSchema(t);return e.slice?o.parseSlice(N(n),e.parseOptions).content:o.parse(N(n),e.parseOptions)}return Z("",t,e)}function Ut(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function oe(n,t,e={}){const{from:o,to:i,empty:r}=n.selection,c=t?B(t,n.schema):null,p=[];n.doc.nodesBetween(o,i,(F,Y)=>{if(F.isText)return;const tt=Math.max(o,Y),Ct=Math.min(i,Y+F.nodeSize);p.push({node:F,from:tt,to:Ct})});const h=i-o,x=p.filter(F=>!c||c.name===F.node.type.name).filter(F=>an(F.node.attrs,e,{strict:!1}));return r?!!x.length:x.reduce((F,Y)=>F+Y.to-Y.from,0)>=h}function a(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function _(n,t){const e="string"==typeof t?[t]:t;return Object.keys(n).reduce((o,i)=>(e.includes(i)||(o[i]=n[i]),o),{})}function ie(n,t,e={}){return Z(n,t,{slice:!1,parseOptions:e})}function pe(n,t){const e=ye(t,n.schema),{from:o,to:i,empty:r}=n.selection,c=[];r?(n.storedMarks&&c.push(...n.storedMarks),c.push(...n.selection.$head.marks())):n.doc.nodesBetween(o,i,h=>{c.push(...h.marks)});const p=c.find(h=>h.type.name===e.name);return p?Xt({},p.attrs):{}}function yn(n,t,e){return Object.fromEntries(Object.entries(e).filter(([o])=>{const i=n.find(r=>r.type===t&&r.name===o);return!!i&&i.attribute.keepOnSplit}))}function Nn(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const o=e.filter(i=>null==t?void 0:t.includes(i.type.name));n.tr.ensureMarks(o)}}function Un(n,t){for(let e=n.depth;e>0;e-=1){const o=n.node(e);if(t(o))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:o}}}function gn(n){return t=>Un(t.$from,n)}function An(n,t){const{nodeExtensions:e}=E(t),o=e.find(c=>c.name===n);if(!o)return!1;const r=st(G(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}const Sn=(n,t)=>{const e=gn(c=>c.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,m.Mn)(n.doc,e.pos)&&n.join(e.pos),!0},In=(n,t)=>{const e=gn(c=>c.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(e.start).after(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,m.Mn)(n.doc,o)&&n.join(o),!0};function sn(n,t,e={}){const{empty:o,ranges:i}=n.selection,r=t?ye(t,n.schema):null;if(o)return!!(n.storedMarks||n.selection.$from.marks()).filter(F=>!r||r.name===F.type.name).find(F=>an(F.attrs,e,{strict:!1}));let c=0;const p=[];if(i.forEach(({$from:F,$to:Y})=>{const tt=F.pos,Ct=Y.pos;n.doc.nodesBetween(tt,Ct,(It,Ht)=>{if(!It.isText&&!It.marks.length)return;const Qt=Math.max(tt,Ht),me=Math.min(Ct,Ht+It.nodeSize);c+=me-Qt,p.push(...It.marks.map(nn=>({mark:nn,from:Qt,to:me})))})}),0===c)return!1;const h=p.filter(F=>!r||r.name===F.mark.type.name).filter(F=>an(F.mark.attrs,e,{strict:!1})).reduce((F,Y)=>F+Y.to-Y.from,0),x=p.filter(F=>!r||F.mark.type!==r&&F.mark.type.excludes(r)).reduce((F,Y)=>F+Y.to-Y.from,0);return(h>0?h+x:h)>=c}var En=Object.freeze({__proto__:null,blur:()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),null===(e=null==window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())}),!0),clearContent:(n=!1)=>({commands:t})=>t.setContent("",n),clearNodes:()=>({state:n,tr:t,dispatch:e})=>{const{selection:o}=t,{ranges:i}=o;return e&&i.forEach(({$from:r,$to:c})=>{n.doc.nodesBetween(r.pos,c.pos,(p,h)=>{if(p.type.isText)return;const{doc:x,mapping:b}=t,F=x.resolve(b.map(h)),Y=x.resolve(b.map(h+p.nodeSize)),tt=F.blockRange(Y);if(!tt)return;const Ct=(0,m.k9)(tt);if(p.type.isTextblock){const{defaultType:It}=F.parent.contentMatchAt(F.index());t.setNodeMarkup(tt.start,It)}(Ct||0===Ct)&&t.lift(tt,Ct)})}),!0},command:n=>t=>n(t),createParagraphNear:()=>({state:n,dispatch:t})=>it(n,t),deleteNode:n=>({tr:t,state:e,dispatch:o})=>{const i=B(n,e.schema),r=t.selection.$anchor;for(let c=r.depth;c>0;c-=1)if(r.node(c).type===i){if(o){const h=r.before(c),x=r.after(c);t.delete(h,x).scrollIntoView()}return!0}return!1},deleteRange:n=>({tr:t,dispatch:e})=>{const{from:o,to:i}=n;return e&&t.delete(o,i),!0},deleteSelection:()=>({state:n,dispatch:t})=>ct(n,t),enter:()=>({commands:n})=>n.keyboardShortcut("Enter"),exitCode:()=>({state:n,dispatch:t})=>Q(n,t),extendMarkRange:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const r=ye(n,o.schema),{doc:c,selection:p}=e,{$from:h,from:x,to:b}=p;if(i){const F=on(h,r,t);if(F&&F.from<=x&&F.to>=b){const Y=T.Bs.create(c,F.from,F.to);e.setSelection(Y)}}return!0},first:n=>t=>{const e="function"==typeof n?n(t):n;for(let o=0;o<e.length;o+=1)if(e[o](t))return!0;return!1},focus:(n=null,t={})=>({editor:e,view:o,tr:i,dispatch:r})=>{t=Xt({scrollIntoView:!0},t);const c=()=>{f()&&o.dom.focus(),requestAnimationFrame(()=>{e.isDestroyed||(o.focus(),(null==t?void 0:t.scrollIntoView)&&e.commands.scrollIntoView())})};if(o.hasFocus()&&null===n||!1===n)return!0;if(r&&null===n&&!rn(e.state.selection))return c(),!0;const p=C(e.state.doc,n)||e.state.selection,h=e.state.selection.eq(p);return r&&(h||i.setSelection(p),h&&i.storedMarks&&i.setStoredMarks(i.storedMarks),c()),!0},forEach:(n,t)=>e=>n.every((o,i)=>t(o,je(Xt({},e),{index:i}))),insertContent:(n,t)=>({tr:e,commands:o})=>o.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),insertContentAt:(n,t,e)=>({tr:o,dispatch:i,editor:r})=>{if(i){e=Xt({parseOptions:{},updateSelection:!0},e);const c=Z(t,r.schema,{parseOptions:Xt({preserveWhitespace:"full"},e.parseOptions)});if("<>"===c.toString())return!0;let{from:p,to:h}="number"==typeof n?{from:n,to:n}:n,x=!0,b=!0;if(((n=>n.toString().startsWith("<"))(c)?c:[c]).forEach(Y=>{Y.check(),x=!!x&&Y.isText&&0===Y.marks.length,b=!!b&&Y.isBlock}),p===h&&b){const{parent:Y}=o.doc.resolve(p);Y.isTextblock&&!Y.type.spec.code&&!Y.childCount&&(p-=1,h+=1)}x?o.insertText(t,p,h):o.replaceWith(p,h,c),e.updateSelection&&function(n,t,e){const o=n.steps.length-1;if(o<t)return;const i=n.steps[o];if(!(i instanceof m.Pu||i instanceof m.FC))return;let c=0;n.mapping.maps[o].forEach((p,h,x,b)=>{0===c&&(c=b)}),n.setSelection(T.Y1.near(n.doc.resolve(c),-1))}(o,o.steps.length-1)}return!0},joinBackward:()=>({state:n,dispatch:t})=>I(n,t),joinForward:()=>({state:n,dispatch:t})=>ht(n,t),keyboardShortcut:n=>({editor:t,view:e,tr:o,dispatch:i})=>{const r=function(n){const t=n.split(/-(?!$)/);let o,i,r,c,e=t[t.length-1];"Space"===e&&(e=" ");for(let p=0;p<t.length-1;p+=1){const h=t[p];if(/^(cmd|meta|m)$/i.test(h))c=!0;else if(/^a(lt)?$/i.test(h))o=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))r=!0;else{if(!/^mod$/i.test(h))throw new Error(`Unrecognized modifier name: ${h}`);f()||Ut()?c=!0:i=!0}}return o&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),c&&(e=`Meta-${e}`),r&&(e=`Shift-${e}`),e}(n).split(/-(?!$)/),c=r.find(x=>!["Alt","Ctrl","Meta","Shift"].includes(x)),p=new KeyboardEvent("keydown",{key:"Space"===c?" ":c,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),h=t.captureTransaction(()=>{e.someProp("handleKeyDown",x=>x(e,p))});return null==h||h.steps.forEach(x=>{const b=x.map(o.mapping);b&&i&&o.maybeStep(b)}),!0},lift:(n,t={})=>({state:e,dispatch:o})=>!!oe(e,B(n,e.schema),t)&&((n,t)=>{let{$from:e,$to:o}=n.selection,i=e.blockRange(o),r=i&&(0,m.k9)(i);return null!=r&&(t&&t(n.tr.lift(i,r).scrollIntoView()),!0)})(e,o),liftEmptyBlock:()=>({state:n,dispatch:t})=>K(n,t),liftListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);return!!r&&(!e||(o.node(r.depth-1).type==n?function(n,t,e,o){let i=n.tr,r=o.end,c=o.$to.end(o.depth);r<c&&(i.step(new m.FC(r-1,c,r,c,new P.p2(P.HY.from(e.create(null,o.parent.copy())),1,0),1,!0)),o=new P.Ts(i.doc.resolve(o.$from.pos),i.doc.resolve(c),o.depth));const p=(0,m.k9)(o);if(null==p)return!1;i.lift(o,p);let h=i.mapping.map(r,-1)-1;return(0,m.Mn)(i.doc,h)&&i.join(h),t(i.scrollIntoView()),!0}(t,e,n,r):function(n,t,e){let o=n.tr,i=e.parent;for(let tt=e.end,Ct=e.endIndex-1,It=e.startIndex;Ct>It;Ct--)tt-=i.child(Ct).nodeSize,o.delete(tt-1,tt+1);let r=o.doc.resolve(e.start),c=r.nodeAfter;if(o.mapping.map(e.end)!=e.start+r.nodeAfter.nodeSize)return!1;let p=0==e.startIndex,h=e.endIndex==i.childCount,x=r.node(-1),b=r.index(-1);if(!x.canReplace(b+(p?0:1),b+1,c.content.append(h?P.HY.empty:P.HY.from(i))))return!1;let F=r.pos,Y=F+c.nodeSize;return o.step(new m.FC(F-(p?1:0),Y+(h?1:0),F+1,Y-1,new P.p2((p?P.HY.empty:P.HY.from(i.copy(P.HY.empty))).append(h?P.HY.empty:P.HY.from(i.copy(P.HY.empty))),p?0:1,h?0:1),p?0:1)),t(o.scrollIntoView()),!0}(t,e,r)))}}(B(n,t.schema))(t,e),newlineInCode:()=>({state:n,dispatch:t})=>Et(n,t),resetAttributes:(n,t)=>({tr:e,state:o,dispatch:i})=>{let r=null,c=null;const p=a("string"==typeof n?n:n.name,o.schema);return!!p&&("node"===p&&(r=B(n,o.schema)),"mark"===p&&(c=ye(n,o.schema)),i&&e.selection.ranges.forEach(h=>{o.doc.nodesBetween(h.$from.pos,h.$to.pos,(x,b)=>{r&&r===x.type&&e.setNodeMarkup(b,void 0,_(x.attrs,t)),c&&x.marks.length&&x.marks.forEach(F=>{c===F.type&&e.addMark(b,b+x.nodeSize,c.create(_(F.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),selectAll:()=>({tr:n,commands:t})=>t.setTextSelection({from:0,to:n.doc.content.size}),selectNodeBackward:()=>({state:n,dispatch:t})=>ot(n,t),selectNodeForward:()=>({state:n,dispatch:t})=>xt(n,t),selectParentNode:()=>({state:n,dispatch:t})=>((n,t)=>{let i,{$from:e,to:o}=n.selection,r=e.sharedDepth(o);return 0!=r&&(i=e.before(r),t&&t(n.tr.setSelection(T.qv.create(n.doc,i))),!0)})(n,t),selectTextblockEnd:()=>({state:n,dispatch:t})=>ft(n,t),selectTextblockStart:()=>({state:n,dispatch:t})=>ee(n,t),setContent:(n,t=!1,e={})=>({tr:o,editor:i,dispatch:r})=>{const{doc:c}=o,p=ie(n,i.schema,e),h=T.Bs.create(c,0,c.content.size);return r&&o.setSelection(h).replaceSelectionWith(p,!1).setMeta("preventUpdate",!t),!0},setMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const{selection:r}=e,{empty:c,ranges:p}=r,h=ye(n,o.schema);if(i)if(c){const x=pe(o,h);e.addStoredMark(h.create(Xt(Xt({},x),t)))}else p.forEach(x=>{const b=x.$from.pos,F=x.$to.pos;o.doc.nodesBetween(b,F,(Y,tt)=>{const Ct=Math.max(tt,b),It=Math.min(tt+Y.nodeSize,F);Y.marks.find(Qt=>Qt.type===h)?Y.marks.forEach(Qt=>{h===Qt.type&&e.addMark(Ct,It,h.create(Xt(Xt({},Qt.attrs),t)))}):e.addMark(Ct,It,h.create(t))})});return!0},setMeta:(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),setNode:(n,t={})=>({state:e,dispatch:o,chain:i})=>{const r=B(n,e.schema);return r.isTextblock?i().command(({commands:c})=>!!et(r,t)(e)||c.clearNodes()).command(({state:c})=>et(r,t)(c,o)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,i=T.Y1.atStart(o).from,r=T.Y1.atEnd(o).to,c=Be(n,i,r),p=T.qv.create(o,c);t.setSelection(p)}return!0},setTextSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,{from:i,to:r}="number"==typeof n?{from:n,to:n}:n,c=T.Bs.atStart(o).from,p=T.Bs.atEnd(o).to,h=Be(i,c,p),x=Be(r,c,p),b=T.Bs.create(o,h,x);t.setSelection(b)}return!0},sinkListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,x=>x.childCount>0&&x.firstChild.type==n);if(!r)return!1;let c=r.startIndex;if(0==c)return!1;let p=r.parent,h=p.child(c-1);if(h.type!=n)return!1;if(e){let x=h.lastChild&&h.lastChild.type==p.type,b=P.HY.from(x?n.create():null),F=new P.p2(P.HY.from(n.create(null,P.HY.from(p.type.create(null,b)))),x?3:1,0),Y=r.start,tt=r.end;e(t.tr.step(new m.FC(Y-(x?3:1),tt,Y,tt,F,1,!0)).scrollIntoView())}return!0}}(B(n,t.schema))(t,e),splitBlock:({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:o,editor:i})=>{const{selection:r,doc:c}=t,{$from:p,$to:h}=r,b=yn(i.extensionManager.attributes,p.node().type.name,p.node().attrs);if(r instanceof T.qv&&r.node.isBlock)return!(!p.parentOffset||!(0,m.Ax)(c,p.pos)||(o&&(n&&Nn(e,i.extensionManager.splittableMarks),t.split(p.pos).scrollIntoView()),0));if(!p.parent.isBlock)return!1;if(o){const F=h.parentOffset===h.parent.content.size;r instanceof T.Bs&&t.deleteSelection();const Y=0===p.depth?void 0:function(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}(p.node(-1).contentMatchAt(p.indexAfter(-1)));let tt=F&&Y?[{type:Y,attrs:b}]:void 0,Ct=(0,m.Ax)(t.doc,t.mapping.map(p.pos),1,tt);if(!tt&&!Ct&&(0,m.Ax)(t.doc,t.mapping.map(p.pos),1,Y?[{type:Y}]:void 0)&&(Ct=!0,tt=Y?[{type:Y,attrs:b}]:void 0),Ct&&(t.split(t.mapping.map(p.pos),1,tt),Y&&!F&&!p.parentOffset&&p.parent.type!==Y)){const It=t.mapping.map(p.before()),Ht=t.doc.resolve(It);p.node(-1).canReplaceWith(Ht.index(),Ht.index()+1,Y)&&t.setNodeMarkup(t.mapping.map(p.before()),Y)}n&&Nn(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:n=>({tr:t,state:e,dispatch:o,editor:i})=>{var r;const c=B(n,e.schema),{$from:p,$to:h}=e.selection,x=e.selection.node;if(x&&x.isBlock||p.depth<2||!p.sameParent(h))return!1;const b=p.node(-1);if(b.type!==c)return!1;const F=i.extensionManager.attributes;if(0===p.parent.content.size&&p.node(-1).childCount===p.indexAfter(-1)){if(2===p.depth||p.node(-3).type!==c||p.index(-2)!==p.node(-2).childCount-1)return!1;if(o){let Ht=P.HY.empty;const Qt=p.index(-1)?1:p.index(-2)?2:3;for(let Tn=p.depth-Qt;Tn>=p.depth-3;Tn-=1)Ht=P.HY.from(p.node(Tn).copy(Ht));const me=p.indexAfter(-1)<p.node(-2).childCount?1:p.indexAfter(-2)<p.node(-3).childCount?2:3,Ne=yn(F,p.node().type.name,p.node().attrs),nn=(null===(r=c.contentMatch.defaultType)||void 0===r?void 0:r.createAndFill(Ne))||void 0;Ht=Ht.append(P.HY.from(c.createAndFill(null,nn)||void 0));const He=p.before(p.depth-(Qt-1));t.replace(He,p.after(-me),new P.p2(Ht,4-Qt,0));let Wn=-1;t.doc.nodesBetween(He,t.doc.content.size,(Tn,re)=>{if(Wn>-1)return!1;Tn.isTextblock&&0===Tn.content.size&&(Wn=re+1)}),Wn>-1&&t.setSelection(T.Bs.near(t.doc.resolve(Wn))),t.scrollIntoView()}return!0}const Y=h.pos===p.end()?b.contentMatchAt(0).defaultType:null,tt=yn(F,b.type.name,b.attrs),Ct=yn(F,p.node().type.name,p.node().attrs);t.delete(p.pos,h.pos);const It=Y?[{type:c,attrs:tt},{type:Y,attrs:Ct}]:[{type:c,attrs:tt}];return!!(0,m.Ax)(t.doc,p.pos,2)&&(o&&t.split(p.pos,2,It).scrollIntoView(),!0)},toggleList:(n,t)=>({editor:e,tr:o,state:i,dispatch:r,chain:c,commands:p,can:h})=>{const{extensions:x}=e.extensionManager,b=B(n,i.schema),F=B(t,i.schema),{selection:Y}=i,{$from:tt,$to:Ct}=Y,It=tt.blockRange(Ct);if(!It)return!1;const Ht=gn(Qt=>An(Qt.type.name,x))(Y);if(It.depth>=1&&Ht&&It.depth-Ht.depth<=1){if(Ht.node.type===b)return p.liftListItem(F);if(An(Ht.node.type.name,x)&&b.validContent(Ht.node.content)&&r)return c().command(()=>(o.setNodeMarkup(Ht.pos,b),!0)).command(()=>Sn(o,b)).command(()=>In(o,b)).run()}return c().command(()=>!!h().wrapInList(b)||p.clearNodes()).wrapInList(b).command(()=>Sn(o,b)).command(()=>In(o,b)).run()},toggleMark:(n,t={},e={})=>({state:o,commands:i})=>{const{extendEmptyMarkRange:r=!1}=e,c=ye(n,o.schema);return sn(o,c,t)?i.unsetMark(c,{extendEmptyMarkRange:r}):i.setMark(c,t)},toggleNode:(n,t,e={})=>({state:o,commands:i})=>{const r=B(n,o.schema),c=B(t,o.schema);return oe(o,r,e)?i.setNode(c):i.setNode(r,e)},toggleWrap:(n,t={})=>({state:e,commands:o})=>{const i=B(n,e.schema);return oe(e,i,t)?o.lift(i):o.wrapIn(i,t)},undoInputRule:()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let o=0;o<e.length;o+=1){const i=e[o];let r;if(i.spec.isInputRules&&(r=i.getState(n))){if(t){const c=n.tr,p=r.transform;for(let h=p.steps.length-1;h>=0;h-=1)c.step(p.steps[h].invert(p.docs[h]));if(r.text){const h=c.doc.resolve(r.from).marks();c.replaceWith(r.from,r.to,n.schema.text(r.text,h))}else c.delete(r.from,r.to)}return!0}}return!1},unsetAllMarks:()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:o,ranges:i}=e;return o||t&&i.forEach(r=>{n.removeMark(r.$from.pos,r.$to.pos)}),!0},unsetMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{var r;const{extendEmptyMarkRange:c=!1}=t,{selection:p}=e,h=ye(n,o.schema),{$from:x,empty:b,ranges:F}=p;if(!i)return!0;if(b&&c){let{from:Y,to:tt}=p;const Ct=null===(r=x.marks().find(Ht=>Ht.type===h))||void 0===r?void 0:r.attrs,It=on(x,h,Ct);It&&(Y=It.from,tt=It.to),e.removeMark(Y,tt,h)}else F.forEach(Y=>{e.removeMark(Y.$from.pos,Y.$to.pos,h)});return e.removeStoredMark(h),!0},updateAttributes:(n,t={})=>({tr:e,state:o,dispatch:i})=>{let r=null,c=null;const p=a("string"==typeof n?n:n.name,o.schema);return!!p&&("node"===p&&(r=B(n,o.schema)),"mark"===p&&(c=ye(n,o.schema)),i&&e.selection.ranges.forEach(h=>{const x=h.$from.pos,b=h.$to.pos;o.doc.nodesBetween(x,b,(F,Y)=>{r&&r===F.type&&e.setNodeMarkup(Y,void 0,Xt(Xt({},F.attrs),t)),c&&F.marks.length&&F.marks.forEach(tt=>{if(c===tt.type){const Ct=Math.max(Y,x),It=Math.min(Y+F.nodeSize,b);e.addMark(Ct,It,c.create(Xt(Xt({},tt.attrs),t)))}})})}),!0)},wrapIn:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,c=i.blockRange(r),p=c&&(0,m.nd)(c,n,t);return!!p&&(o&&o(e.tr.wrap(c,p).scrollIntoView()),!0)}}(B(n,e.schema),t)(e,o),wrapInList:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,c=i.blockRange(r),p=!1,h=c;if(!c)return!1;if(c.depth>=2&&i.node(c.depth-1).type.compatibleContent(n)&&0==c.startIndex){if(0==i.index(c.depth-1))return!1;let b=e.doc.resolve(c.start-2);h=new P.Ts(b,b,c.depth),c.endIndex<c.parent.childCount&&(c=new P.Ts(i,e.doc.resolve(r.end(c.depth)),c.depth)),p=!0}let x=(0,m.nd)(h,n,t,c);return!!x&&(o&&o(function(n,t,e,o,i){let r=P.HY.empty;for(let b=e.length-1;b>=0;b--)r=P.HY.from(e[b].type.create(e[b].attrs,r));n.step(new m.FC(t.start-(o?2:0),t.end,t.start,t.end,new P.p2(r,0,0),e.length,!0));let c=0;for(let b=0;b<e.length;b++)e[b].type==i&&(c=b+1);let p=e.length-c,h=t.start+e.length-(o?2:0),x=t.parent;for(let b=t.startIndex,F=t.endIndex,Y=!0;b<F;b++,Y=!1)!Y&&(0,m.Ax)(n.doc,h,p)&&(n.split(h,p),h+=2*p),h+=x.child(b).nodeSize;return n}(e.tr,c,x,p,n).scrollIntoView()),!0)}}(B(n,e.schema),t)(e,o)});const oo=ge.create({name:"commands",addCommands:()=>Xt({},En)}),en=ge.create({name:"editable",addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),zn=ge.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new T.Sy({key:new T.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const o=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1},blur:(t,e)=>{n.isFocused=!1;const o=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1}}}})]}}),kn=ge.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:c})=>[()=>c.undoInputRule(),()=>c.command(({tr:p})=>{const{selection:h,doc:x}=p,{empty:b,$anchor:F}=h,{pos:Y,parent:tt}=F,Ct=T.Y1.atStart(x).from===Y;return!(!(b&&Ct&&tt.type.isTextblock)||tt.textContent.length)&&c.clearNodes()}),()=>c.deleteSelection(),()=>c.joinBackward(),()=>c.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:c})=>[()=>c.deleteSelection(),()=>c.joinForward(),()=>c.selectNodeForward()]),o={Enter:()=>this.editor.commands.first(({commands:c})=>[()=>c.newlineInCode(),()=>c.createParagraphNear(),()=>c.liftEmptyBlock(),()=>c.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i=Xt({},o),r=je(Xt({},o),{"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return f()||Ut()?r:i},addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("clearDocument"),appendTransaction:(n,t,e)=>{if(!n.some(Ct=>Ct.docChanged)||t.doc.eq(e.doc))return;const{empty:i,from:r,to:c}=t.selection,p=T.Y1.atStart(t.doc).from,h=T.Y1.atEnd(t.doc).to,x=r===p&&c===h,b=0===e.doc.textBetween(0,e.doc.content.size," "," ").length;if(i||!x||!b)return;const F=e.tr,Y=_e({state:e,transaction:F}),{commands:tt}=new Ce({editor:this.editor,state:Y});return tt.clearNodes(),F.steps.length?F:void 0}})]}}),Ae=ge.create({name:"tabindex",addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Se=Object.freeze({__proto__:null,ClipboardTextSerializer:fe,Commands:oo,Editable:en,FocusEvents:zn,Keymap:kn,Tabindex:Ae});function Cn(n,t){const e=B(t,n.schema),{from:o,to:i}=n.selection,r=[];n.doc.nodesBetween(o,i,p=>{r.push(p)});const c=r.reverse().find(p=>p.type.name===e.name);return c?Xt({},c.attrs):{}}function fo(n,t){const e=a("string"==typeof t?t:t.name,n.schema);return"node"===e?Cn(n,t):"mark"===e?pe(n,t):{}}function to(n,t){const e=P.PW.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function io(n,t){return un(n,{from:0,to:n.content.size},t)}function ro(n,t,e={}){if(!t)return oe(n,null,e)||sn(n,null,e);const o=a(t,n.schema);return"node"===o?oe(n,t,e):"mark"===o&&sn(n,t,e)}function so(n){var t;const e=null===(t=n.type.createAndFill())||void 0===t?void 0:t.toJSON(),o=n.toJSON();return JSON.stringify(e)===JSON.stringify(o)}class lo extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const o=this.callbacks[t];return o&&o.forEach(i=>i.apply(this,e)),this}off(t,e){const o=this.callbacks[t];return o&&(e?this.callbacks[t]=o.filter(i=>i!==e):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(n,t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute("data-tiptap-style",""),o.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',document.getElementsByTagName("head")[0].appendChild(o),o}(0,this.options.injectNonce))}setOptions(t={}){this.options=Xt(Xt({},this.options),t),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const o=U(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:o});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,o=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(e))});this.view.updateState(o)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(Se):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(null==o?void 0:o.type));this.extensionManager=new Ge(e,this)}createCommandManager(){this.commandManager=new Ce({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=ie(this.options.content,this.schema,this.options.parseOptions),e=C(t,this.options.autofocus);this.view=new s.tk(this.options.element,je(Xt({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:T.yy.create({doc:t,selection:e||void 0})}));const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(c=>{var p;return null===(p=this.capturedTransaction)||void 0===p?void 0:p.step(c)}):void(this.capturedTransaction=t);const e=this.state.apply(t),o=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),o&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),r=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return fo(this.state,t)}isActive(t,e){return ro(this.state,"string"==typeof t?t:null,"string"==typeof t?e:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return to(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:o={}}=t||{};return io(this.state.doc,{blockSeparator:e,textSerializers:Xt(Xt({},o),Le(this.schema))})}get isEmpty(){return so(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function mo(n,t){const e=new m.wx(n);return t.forEach(o=>{o.steps.forEach(i=>{e.step(i)})}),e}function ao(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function yo(n,t){const e=[];return n.descendants((o,i)=>{t(o)&&e.push({node:o,pos:i})}),e}function Eo(n,t,e){const o=[];return n.nodesBetween(t.from,t.to,(i,r)=>{e(i)&&o.push({node:i,pos:r})}),o}function no(n){return z(Ge.resolve(n))}function bo(n,t){const e=no(t);return to(P.NB.fromJSON(e,n).content,e)}function go(n,t){const e=no(t),o=N(n);return P.aw.fromSchema(e).parse(o).toJSON()}function xo(n,t,e){const{blockSeparator:o="\n\n",textSerializers:i={}}=e||{},r=no(t);return io(P.NB.fromJSON(r,n),{blockSeparator:o,textSerializers:Xt(Xt({},i),Le(r))})}function Po(n){const{mapping:t,steps:e}=n,o=[];return t.maps.forEach((i,r)=>{const c=[];if(i.ranges.length)i.forEach((p,h)=>{c.push({from:p,to:h})});else{const{from:p,to:h}=e[r];if(void 0===p||void 0===h)return;c.push({from:p,to:h})}c.forEach(({from:p,to:h})=>{const x=t.slice(r).map(p,-1),b=t.slice(r).map(h),F=t.invert().map(x,-1),Y=t.invert().map(b);o.push({oldRange:{from:F,to:Y},newRange:{from:x,to:b}})})}),function(n){const t=function(n,t=JSON.stringify){const e={};return n.filter(o=>{const i=t(o);return!Object.prototype.hasOwnProperty.call(e,i)&&(e[i]=!0)})}(n);return 1===t.length?t:t.filter((e,o)=>!t.filter((r,c)=>c!==o).some(r=>e.oldRange.from>=r.oldRange.from&&e.oldRange.to<=r.oldRange.to&&e.newRange.from>=r.newRange.from&&e.newRange.to<=r.newRange.to))}(o)}function co(n,t=0){const o=n.type===n.type.schema.topNodeType?0:1,i=t,r=i+n.nodeSize,c=n.marks.map(x=>{const b={type:x.type.name};return Object.keys(x.attrs).length&&(b.attrs=Xt({},x.attrs)),b}),p=Xt({},n.attrs),h={type:n.type.name,from:i,to:r};return Object.keys(p).length&&(h.attrs=p),c.length&&(h.marks=c),n.content.childCount&&(h.content=[],n.forEach((x,b)=>{var F;null===(F=h.content)||void 0===F||F.push(co(x,t+b+o))})),n.text&&(h.text=n.text),h}function uo(n,t,e){const o=[];return n===t?e.resolve(n).marks().forEach(i=>{const c=on(e.resolve(n-1),i.type);!c||o.push(Xt({mark:i},c))}):e.nodesBetween(n,t,(i,r)=>{o.push(...i.marks.map(c=>({from:r,to:r+i.nodeSize,mark:c})))}),o}function Ao(n){return Ze(n)&&n instanceof T.qv}function po(n,t,e){const i=n.state.doc.content.size,r=Be(t,0,i),c=Be(e,0,i),p=n.coordsAtPos(r),h=n.coordsAtPos(c,-1),x=Math.min(p.top,h.top),b=Math.max(p.bottom,h.bottom),F=Math.min(p.left,h.left),Y=Math.max(p.right,h.right),Qt={top:x,bottom:b,left:F,right:Y,width:Y-F,height:b-x,x:F,y:x};return je(Xt({},Qt),{toJSON:()=>Qt})}function So(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=st(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,c=o[o.length-1],p=o[0];let h=e.to;if(c){const x=p.search(/\S/),b=e.from+p.indexOf(c),F=b+c.length;if(uo(e.from,e.to,t.doc).filter(tt=>tt.mark.type.excluded.find(It=>It===n.type&&It!==tt.mark.type)).filter(tt=>tt.to>b).length)return null;F<e.to&&r.delete(F,e.to),b>e.from&&r.delete(e.from+x,b),h=e.from+x+c.length,r.addMark(e.from+x,h,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function Bo(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=st(n.getAttributes,void 0,o)||{},{tr:r}=t,c=e.from;let p=e.to;if(o[1]){let x=c+o[0].lastIndexOf(o[1]);x>p?x=p:p=x+o[1].length,r.insertText(o[0][o[0].length-1],c+o[0].length-1),r.replaceWith(x,p,n.type.create(i))}else o[0]&&r.replaceWith(c,p,n.type.create(i))}})}function No(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=t.doc.resolve(e.from),r=st(n.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,r)}})}function Ho(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const c=e.to;if(o[1]){const p=o[0].lastIndexOf(o[1]);i+=o[0].slice(p+o[1].length),r+=p;const h=r-c;h>0&&(i=o[0].slice(p-h,p)+i,r=c)}t.tr.insertText(i,r,c)}})}function Io(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=st(n.getAttributes,void 0,o)||{},r=t.tr.delete(e.from,e.to),p=r.doc.resolve(e.from).blockRange(),h=p&&(0,m.nd)(p,n.type,i);if(!h)return null;r.wrap(p,h);const x=r.doc.resolve(e.from-1).nodeBefore;x&&x.type===n.type&&(0,m.Mn)(r.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(o,x))&&r.join(e.from-1)}})}class Vn{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Xt(Xt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=st(G(this,"addOptions",{name:this.name}))),this.storage=st(G(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Vn(t)}configure(t={}){const e=this.extend();return e.options=dn(this.options,t),e.storage=st(G(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Vn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=st(G(e,"addOptions",{name:e.name})),e.storage=st(G(e,"addStorage",{name:e.name,options:e.options})),e}}class jn{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Xt(Xt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=st(G(this,"addOptions",{name:this.name}))),this.storage=st(G(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new jn(t)}configure(t={}){const e=this.extend();return e.options=dn(this.options,t),e.storage=st(G(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new jn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=st(G(e,"addOptions",{name:e.name})),e.storage=st(G(e,"addStorage",{name:e.name,options:e.options})),e}}class _o{constructor(t,e,o){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options=Xt({stopEvent:null,ignoreMutation:null},o),this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,o,i,r,c,p,h;const{view:x}=this.editor,b=t.target,F=3===b.nodeType?null===(e=b.parentElement)||void 0===e?void 0:e.closest("[data-drag-handle]"):b.closest("[data-drag-handle]");if(!this.dom||(null===(o=this.contentDOM)||void 0===o?void 0:o.contains(b))||!F)return;let Y=0,tt=0;if(this.dom!==F){const Ht=this.dom.getBoundingClientRect(),Qt=F.getBoundingClientRect(),me=null!==(i=t.offsetX)&&void 0!==i?i:null===(r=t.nativeEvent)||void 0===r?void 0:r.offsetX,Ne=null!==(c=t.offsetY)&&void 0!==c?c:null===(p=t.nativeEvent)||void 0===p?void 0:p.offsetY;Y=Qt.x-Ht.x+me,tt=Qt.y-Ht.y+Ne}null===(h=t.dataTransfer)||void 0===h||h.setDragImage(this.dom,Y,tt);const Ct=T.qv.create(x.state.doc,this.getPos()),It=x.state.tr.setSelection(Ct);x.dispatch(It)}stopEvent(t){var e;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const o=t.target;if(!this.dom.contains(o)||(null===(e=this.contentDOM)||void 0===e?void 0:e.contains(o)))return!1;const r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(o.tagName)||o.isContentEditable)&&!r)return!0;const{isEditable:p}=this.editor,{isDragging:h}=this,x=!!this.node.type.spec.draggable,b=T.qv.isSelectable(this.node),F="copy"===t.type,Y="paste"===t.type,tt="cut"===t.type,Ct="mousedown"===t.type,It=t.type.startsWith("drag");if(!x&&b&&It&&t.preventDefault(),x&&It&&!h)return t.preventDefault(),!1;if(x&&p&&!h&&Ct){const Ht=o.closest("[data-drag-handle]");Ht&&(this.dom===Ht||this.dom.contains(Ht))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(h||r||F||Y||tt||Ct&&b)}ignoreMutation(t){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:t}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===t.type||this.dom.contains(t.target)&&"childList"===t.type&&f()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(o=>o.isContentEditable)||(this.contentDOM!==t.target||"attributes"!==t.type)&&this.contentDOM.contains(t.target))))}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const o=this.getPos();return e.setNodeMarkup(o,void 0,Xt(Xt({},this.node.attrs),t)),!0})}deleteNode(){const t=this.getPos();this.editor.commands.deleteRange({from:t,to:t+this.node.nodeSize})}}function ko(n){return new Gt({find:n.find,handler:({state:t,range:e,match:o})=>{const i=st(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,c=o[o.length-1],p=o[0];let h=e.to;if(c){const x=p.search(/\S/),b=e.from+p.indexOf(c),F=b+c.length;if(uo(e.from,e.to,t.doc).filter(tt=>tt.mark.type.excluded.find(It=>It===n.type&&It!==tt.mark.type)).filter(tt=>tt.to>b).length)return null;F<e.to&&r.delete(F,e.to),b>e.from&&r.delete(e.from+x,b),h=e.from+x+c.length,r.addMark(e.from+x,h,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function Co(n){return new Gt({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const c=e.to;if(o[1]){const p=o[0].lastIndexOf(o[1]);i+=o[0].slice(p+o[1].length),r+=p;const h=r-c;h>0&&(i=o[0].slice(p-h,p)+i,r=c)}t.tr.insertText(i,r,c)}})}class wo{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((i,r)=>{const c=r.getMap().mapResult(i);return c.deleted&&(e=!0),c.pos},t),deleted:e}}}function To(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}},74634:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{TextStyle:()=>s,default:()=>s});var T=d(40256);const s=T.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:H=>!!H.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:H}){return["span",(0,T.mergeAttributes)(this.options.HTMLAttributes,H),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:H,commands:P})=>{const m=(0,T.getMarkAttributes)(H,this.type);return!!Object.entries(m).some(([,I])=>!!I)||P.unsetMark(this.name)}}}})},97019:(Kt,Mt,d)=>{d.d(Mt,{h:()=>Dt});var T=d(64762),s=d(74788),H=d(36692),P=d(50170),m=d(1414),ct=d(10200),I=d(33250),pt=d(68874),ot=d(23738),ut=d(52219),ht=d(12057),xt=d(65009),mt=d(10383),gt=d(20933),wt=d(35065),Ot=d(63060),Et=d(62733),X=d(48214),Q=d(11189),it=d(91030);function K(bt,Nt){if(1&bt&&(s.TgZ(0,"button",6),s._uU(1),s.qZA()),2&bt){const zt=Nt.$implicit;s.Q6J("value",zt),s.xp6(1),s.hij(" ",zt," ")}}function vt(bt,Nt){if(1&bt&&(s.TgZ(0,"tui-data-list"),s.YNc(1,K,2,2,"button",5),s.qZA()),2&bt){const zt=s.oxw();s.xp6(1),s.Q6J("ngForOf",zt.modes)}}function yt(bt,Nt){if(1&bt){const zt=s.EpF();s.TgZ(0,"tui-primitive-textfield",7),s.NdJ("valueChange",function(ft){return s.CHM(zt),s.oxw().onHexChange(ft)}),s._UZ(1,"input",8),s.qZA()}if(2&bt){const zt=s.oxw();s.Q6J("textMask",zt.hexMask)("tuiTextfieldLabelOutside",!0)("value",zt.hex)}}function Pt(bt,Nt){if(1&bt){const zt=s.EpF();s.TgZ(0,"tui-input-count",9),s.NdJ("ngModelChange",function(ft){s.CHM(zt);const A=s.oxw();return A.onRgbChange(ft,A.color[1],A.color[2],A.color[3])}),s.qZA(),s.TgZ(1,"tui-input-count",9),s.NdJ("ngModelChange",function(ft){s.CHM(zt);const A=s.oxw();return A.onRgbChange(A.color[0],ft,A.color[2],A.color[3])}),s.qZA(),s.TgZ(2,"tui-input-count",9),s.NdJ("ngModelChange",function(ft){s.CHM(zt);const A=s.oxw();return A.onRgbChange(A.color[0],A.color[1],ft,A.color[3])}),s.qZA()}if(2&bt){const zt=s.oxw();s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",zt.color[0]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",zt.color[1]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",zt.color[2])}}class Dt{constructor(){this.color=[0,0,0,1],this.colorChange=new s.vpe,this.hexMask={mask:({length:Nt})=>Array.from({length:Nt},()=>/\d|[a-f]|[A-F]/),guide:!1},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return(0,H.tuiRgbToHex)(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(Nt){if(6!==Nt.length)return;const zt=(0,H.tuiHexToRgb)(Nt);this.updateColor([zt[0],zt[1],zt[2],this.color[3]])}onRgbChange(...Nt){this.updateColor(Nt)}updateColor(Nt){this.color=Nt,this.colorChange.emit(Nt)}}Dt.\u0275fac=function(Nt){return new(Nt||Dt)},Dt.\u0275cmp=s.Xpm({type:Dt,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:6,vars:8,consts:[["tuiTextfieldSize","m","tuiDropdownAlign","left","tuiDropdownLimitWidth","min",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],[4,"tuiDataList"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["postfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"],["size","xs","tuiOption","",3,"value",4,"ngFor","ngForOf"],["size","xs","tuiOption","",3,"value"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange"],["tuiTextfield","","maxlength","6"],["tuiTextfieldSize","m",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"]],template:function(Nt,zt){if(1&Nt&&(s.TgZ(0,"tui-select",0),s.NdJ("ngModelChange",function(ft){return zt.mode=ft}),s.YNc(1,vt,2,1,"tui-data-list",1),s.qZA(),s.YNc(2,yt,2,3,"tui-primitive-textfield",2),s.YNc(3,Pt,3,12,"ng-template",null,3,s.W1O),s.TgZ(5,"tui-input-count",4),s.NdJ("ngModelChange",function(ft){return zt.onRgbChange(zt.color[0],zt.color[1],zt.color[2],ft/100)}),s.qZA()),2&Nt){const ee=s.MAs(4);s.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",zt.mode),s.xp6(2),s.Q6J("ngIf",zt.isHex)("ngIfElse",ee),s.xp6(3),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",100)("ngModel",zt.opacity)}},directives:[P.u,m.O,ct.s,I.Ek,pt.x,ot.JJ,ot.On,ut.g,ht.O5,xt.E,mt.a,gt.q,ht.sg,wt.v,Ot.y,Et.B,X.n,Q.h,it.M],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:4.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}"],changeDetection:0}),(0,T.gn)([(0,H.tuiDefaultProp)()],Dt.prototype,"color",void 0)},49289:(Kt,Mt,d)=>{d.d(Mt,{$:()=>I});var T=d(64762),s=d(74788),H=d(91211),P=d(36692),m=d(71424),ct=d(65720);class I{constructor(ot){this.sanitizer=ot,this.colorChange=new s.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color(ot){if(this.currentColor.every((mt,gt)=>mt===ot[gt])&&ot[3]===this.opacity)return;const[ut,ht,xt]=(0,P.tuiRgbToHsv)(ot[0],ot[1],ot[2]);this.opacity=ot[3],this.hue=ut/360,this.point=[ht,1-xt/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${(0,P.tuiHsvToRgb)(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange(ot){this.point=ot,this.updateColor()}onHueChange(ot){this.hue=ot,this.updateColor()}onOpacityChange(ot){this.opacity=(0,P.tuiRound)(ot,2),this.updateColor()}getCurrentColor(ot,ut){return(0,P.tuiHsvToRgb)(360*ot,ut[0],255*(1-ut[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}I.\u0275fac=function(ot){return new(ot||I)(s.Y36(H.H7))},I.\u0275cmp=s.Xpm({type:I,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function(ot,ut){1&ot&&(s.TgZ(0,"tui-flat-picker",0),s.NdJ("valueChange",function(xt){return ut.onPointChange(xt)}),s.qZA(),s.TgZ(1,"div",1),s.TgZ(2,"tui-linear-picker",2),s.NdJ("valueChange",function(xt){return ut.onHueChange(xt)}),s.qZA(),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"tui-linear-picker",4),s.NdJ("valueChange",function(xt){return ut.onOpacityChange(xt)}),s.qZA(),s.qZA()),2&ot&&(s.Udp("background-color",ut.base),s.Q6J("value",ut.point),s.xp6(2),s.Q6J("value",ut.hue),s.xp6(1),s.Udp("background",ut.gradient),s.xp6(1),s.Q6J("value",ut.opacity))},directives:[m.J,ct.P],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(rgba(0,0,0,0),#000000),linear-gradient(to right,#ffffff,rgba(255,255,255,0));margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:#ff0000}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],I.prototype,"color",null),(0,T.gn)([P.tuiPure],I.prototype,"getCurrentColor",null)},23999:(Kt,Mt,d)=>{d.d(Mt,{s:()=>Tt});var T=d(64762),s=d(74788),H=d(91211),P=d(62842),m=d(37631),ct=d(36692),I=d(62939),pt=d(76189),ot=d(12057),ut=d(49289),ht=d(34880),xt=d(20933),mt=d(35065),gt=d(49472),wt=d(67446),Ot=d(29070),Et=d(54255),X=d(15491),Q=d(219),it=d(97019),K=d(39607),vt=d(5451);function yt(W,J){if(1&W&&s._UZ(0,"tui-svg",9),2&W){s.oxw();const dt=s.MAs(1);s.ekj("t-arrow_rotated",dt.open)}}function Pt(W,J){1&W&&s._UZ(0,"tui-svg",14)}function Dt(W,J){if(1&W){const dt=s.EpF();s.TgZ(0,"button",12),s.NdJ("keydown.enter.prevent",function(){const qt=s.CHM(dt).$implicit,ce=s.oxw(2),le=s.MAs(1);return ce.onModeSelect(qt,le)})("keydown.space.prevent",function(){const qt=s.CHM(dt).$implicit,ce=s.oxw(2),le=s.MAs(1);return ce.onModeSelect(qt,le)})("click",function(){const qt=s.CHM(dt).$implicit,ce=s.oxw(2),le=s.MAs(1);return ce.onModeSelect(qt,le)}),s._uU(1),s.YNc(2,Pt,1,0,"tui-svg",13),s.qZA()}if(2&W){const dt=J.$implicit,Lt=s.oxw(2);s.uIk("aria-checked",Lt.isModeActive(dt)),s.xp6(1),s.hij(" ",dt," "),s.xp6(1),s.Q6J("ngIf",Lt.isModeActive(dt))}}function bt(W,J){if(1&W&&(s.TgZ(0,"tui-data-list",10),s.YNc(1,Dt,3,3,"button",11),s.qZA()),2&W){const dt=s.oxw();s.xp6(1),s.Q6J("ngForOf",dt.modes)}}function Nt(W,J){if(1&W){const dt=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const qt=s.CHM(dt).$implicit;return s.oxw(2).onDirectionChange(qt)}),s.qZA()}if(2&W){const dt=J.$implicit,Lt=s.oxw(2);s.ekj("t-direction_active",Lt.isDirectionActive(dt)),s.Q6J("icon",Lt.getIcon(dt))("tuiHint",dt)("tuiHintDescribe","")}}function zt(W,J){if(1&W){const dt=s.EpF();s.ynx(0),s._UZ(1,"hr",15),s.TgZ(2,"div",16),s.TgZ(3,"tui-linear-multi-picker",17),s.NdJ("valueChange",function(Jt){return s.CHM(dt),s.oxw().onStopsChange(Jt)})("indexChange",function(Jt){return s.CHM(dt),s.oxw().onIndexChange(Jt)}),s.qZA(),s.qZA(),s.TgZ(4,"div",18),s.YNc(5,Nt,1,5,"button",19),s.qZA(),s.BQk()}if(2&W){const dt=s.oxw();s.xp6(2),s.Udp("background",dt.gradient),s.xp6(1),s.Q6J("value",dt.stopsKeys),s.xp6(2),s.Q6J("ngForOf",dt.buttons)}}function ee(W,J){if(1&W){const dt=s.EpF();s.TgZ(0,"tui-color-edit",21),s.NdJ("colorChange",function(Jt){return s.CHM(dt),s.oxw().onColorChange(Jt)}),s.qZA()}if(2&W){const dt=s.oxw();s.Q6J("color",dt.color)}}function ft(W,J){if(1&W){const dt=s.EpF();s.TgZ(0,"tui-palette",22),s.NdJ("selectedColor",function(Jt){return s.CHM(dt),s.oxw().onPalettePick(Jt)}),s.qZA()}if(2&W){const dt=s.oxw();s.Q6J("colors",dt.palette)}}const A=[0,0,0,0],et=[[0,[0,0,0,1]],[1,[255,255,255,1]]],at={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};class Tt{constructor(J,dt){this.sanitizer=J,this.modes=dt,this.stops=new Map(et),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new s.vpe,this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(J){this.parse(J)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(J){return at[J]}isModeActive(J){return this.currentMode===J}isDirectionActive(J){return this.direction===J}onPalettePick(J){this.updateColor(J)}onDirectionChange(J){this.direction=J,this.updateColor(this.getGradient(J))}onModeSelect(J,dt){this.currentMode=J,dt.open=!1,this.updateColor(J===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(J){this.currentStop=this.stopsKeys[J]}onColorChange(J){this.isGradient?(this.stops.set(this.currentStop,J),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${J.join(", ")})`)}onStopsChange(J){const dt=this.stopsKeys.find(Jt=>!J.includes(Jt)),Lt=J.find(Jt=>!this.stopsKeys.includes(Jt));void 0===dt&&void 0!==Lt&&this.addStop(Lt),void 0!==dt&&void 0===Lt&&this.removeStop(dt),void 0!==dt&&void 0!==Lt&&this.replaceStop(dt,Lt),this.updateColor(this.getGradient(this.direction))}getStopsKeys(J){return Array.from(J.keys())}filterPalette(J,dt){const Lt=new Map(J);return Lt.forEach((Jt,qt)=>{(Jt.startsWith("linear-gradient")&&!dt||!Jt.startsWith("linear-gradient")&&dt)&&Lt.delete(qt)}),Lt}updateColor(J){this.colorChange.emit(J)}getGradient(J){return`linear-gradient(${J}, ${[...this.stopsKeys].sort().map(dt=>`rgba(${this.getStop(dt).join(", ")}) ${100*dt}%`).join(", ")})`}getStop(J){return this.stops.get(J)||A}addStop(J){const dt=this.stopsKeys.reduce((Lt,Jt)=>Math.abs(Jt-J)<Math.abs(Lt-J)?Jt:Lt,this.stopsKeys[0]);this.stops.set(J,this.getStop(dt)),this.stops=new Map(this.stops),this.currentStop=J}removeStop(J){this.stops.delete(J),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(J,dt){const Lt=this.getStop(J);this.currentStop=dt,this.stops=new Map(this.stopsKeys.map(Jt=>Jt===J?[dt,Lt]:[Jt,this.getStop(Jt)]))}parse(J){J.startsWith("linear-gradient")?this.parseGradient(J):this.parseColor(J)}parseGradient(J){if(J===this.getGradient(this.direction))return;const dt=(0,m._N)((0,m.U5)(J));this.currentMode=this.modes[1],this.direction=dt.side,this.currentStop=0,this.stops=new Map(dt.stops.length?dt.stops.map(({color:Lt,position:Jt})=>[parseFloat(Jt)/100,(0,ct.tuiParseColor)(Lt)]):et)}parseColor(J){this.currentMode=this.modes[0],this.currentStop=0,this.color=(0,ct.tuiParseColor)(J)}}Tt.\u0275fac=function(J){return new(J||Tt)(s.Y36(H.H7),s.Y36(P.dj))},Tt.\u0275cmp=s.Xpm({type:Tt,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["tuiButton","","appearance","","size","s","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],["src","tuiIconChevronDown",1,"t-arrow"],["role","menu",1,"t-menu"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click",4,"ngFor","ngForOf"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click"],["src","tuiIconCheck","class","t-checkmark",4,"ngIf"],["src","tuiIconCheck",1,"t-checkmark"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","valueChange","indexChange"],[1,"t-buttons"],["tuiIconButton","","type","button","size","xs","appearance","","class","t-direction",3,"t-direction_active","icon","tuiHint","tuiHintDescribe","click",4,"ngFor","ngForOf"],["tuiIconButton","","type","button","size","xs","appearance","",1,"t-direction",3,"icon","tuiHint","tuiHintDescribe","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(J,dt){if(1&J&&(s.TgZ(0,"tui-hosted-dropdown",0,1),s.TgZ(2,"button",2),s._uU(3),s.qZA(),s.YNc(4,yt,1,2,"ng-template",null,3,s.W1O),s.YNc(6,bt,2,1,"ng-template",null,4,s.W1O),s.qZA(),s.YNc(8,zt,6,4,"ng-container",5),s.TgZ(9,"tui-color-picker",6),s.NdJ("colorChange",function(Jt){return dt.onColorChange(Jt)}),s.qZA(),s.YNc(10,ee,1,1,"tui-color-edit",7),s.YNc(11,ft,1,1,"tui-palette",8)),2&J){const Lt=s.MAs(5),Jt=s.MAs(7);s.Q6J("content",Jt),s.xp6(2),s.Q6J("iconRight",Lt),s.xp6(1),s.hij(" ",dt.currentMode," "),s.xp6(5),s.Q6J("ngIf",dt.isGradient),s.xp6(1),s.Q6J("color",dt.currentColor),s.xp6(1),s.Q6J("ngIf",!dt.isGradient),s.xp6(1),s.Q6J("ngIf",dt.palette.size)}},directives:[I.o,pt.v,ot.O5,ut.$,ht.P,xt.q,ot.sg,mt.v,gt.e,wt.D,Ot.x,Et.t,X.D,Q.$,it.h,K.g,vt.R],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:21.25rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,T.gn)([(0,ct.tuiDefaultProp)()],Tt.prototype,"colors",void 0),(0,T.gn)([(0,ct.tuiRequiredSetter)()],Tt.prototype,"colorSetter",null),(0,T.gn)([ct.tuiPure],Tt.prototype,"getStopsKeys",null),(0,T.gn)([ct.tuiPure],Tt.prototype,"filterPalette",null)},71424:(Kt,Mt,d)=>{d.d(Mt,{J:()=>m});var T=d(64762),s=d(74788),H=d(62141),P=d(36692);class m{constructor(I){this.value=[0,0],this.valueChange=new s.vpe,I.subscribe(pt=>{this.value=pt,this.valueChange.emit([pt[0],pt[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}m.\u0275fac=function(I){return new(I||m)(s.Y36(H.i))},m.\u0275cmp=s.Xpm({type:m,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([P.TuiDestroyService,H.i])],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(I,pt){1&I&&s._UZ(0,"div",0),2&I&&s.Udp("left",pt.left,"%")("top",pt.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],m.prototype,"value",void 0)},27050:(Kt,Mt,d)=>{d.d(Mt,{hR:()=>T.h,TD:()=>I,$v:()=>pt.$,H9:()=>ht,sV:()=>xt.s,wl:()=>Ot,Jd:()=>Et.J,ui:()=>ot,es:()=>X.e,GU:()=>gt,P:()=>Q.P,g7:()=>ut,Rh:()=>it.R,VM:()=>wt});var T=d(97019),s=d(12057),H=d(23738),P=d(72002),m=d(753),ct=d(74788);let I=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez,H.u5,m.TextMaskModule,m.TuiValueAccessorModule,m.TuiSelectModule,P.TuiPrimitiveTextfieldModule,P.TuiTextfieldControllerModule,P.TuiDropdownModule,m.TuiInputCountModule,P.TuiDataListModule]]}),K})();var pt=d(49289);let ot=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez]]}),K})(),ut=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez]]}),K})(),ht=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez,ot,ut]]}),K})();var xt=d(23999),mt=d(36692);let gt=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez]]}),K})(),wt=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez,P.TuiHintModule]]}),K})(),Ot=(()=>{class K{}return K.\u0275fac=function(yt){return new(yt||K)},K.\u0275mod=ct.oAB({type:K}),K.\u0275inj=ct.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHostedDropdownModule,ht,gt,P.TuiHintModule,P.TuiSvgModule,P.TuiDataListModule,mt.TuiActiveZoneModule,I,P.TuiGroupModule,wt]]}),K})();var Et=d(71424),X=d(49472),Q=d(65720),it=d(5451)},49472:(Kt,Mt,d)=>{d.d(Mt,{e:()=>I});var T=d(64762),s=d(74788),H=d(62141),P=d(36692),m=d(12057);function ct(pt,ot){if(1&pt){const ut=s.EpF();s.TgZ(0,"div",1),s.NdJ("mousedown",function(){const mt=s.CHM(ut).index;return s.oxw().onMouseDown(mt)})("dblclick",function(){const mt=s.CHM(ut).index;return s.oxw().onClick(mt)}),s.qZA()}2&pt&&s.Udp("left",100*ot.$implicit,"%")}class I{constructor(ot){this.value=[0,1],this.valueChange=new s.vpe,this.indexChange=new s.vpe,this.index=NaN,ot.subscribe(([ut])=>{this.onPicker(ut)})}onMouseUp(){this.index=NaN}onMouseDown(ot){this.updateIndex(ot)}onClick(ot){this.value.length>2&&this.updateValue(this.value.filter((ut,ht)=>ht!==ot))}onPicker(ot){isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((ut,ht)=>ut===ot&&ht!==this.index)&&this.updateValue(this.value.map((ut,ht)=>ht===this.index?ot:ut))}updateIndex(ot){this.index=ot,this.indexChange.emit(ot)}updateValue(ot){this.value=ot,this.valueChange.emit(ot)}}I.\u0275fac=function(ot){return new(ot||I)(s.Y36(H.i))},I.\u0275cmp=s.Xpm({type:I,selectors:[["tui-linear-multi-picker"]],hostBindings:function(ot,ut){1&ot&&s.NdJ("mouseup",function(){return ut.onMouseUp()},!1,s.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},features:[s._Bn([P.TuiDestroyService,H.i])],decls:1,vars:1,consts:[["class","t-circle",3,"left","mousedown","dblclick",4,"ngFor","ngForOf"],[1,"t-circle",3,"mousedown","dblclick"]],template:function(ot,ut){1&ot&&s.YNc(0,ct,1,2,"div",0),2&ot&&s.Q6J("ngForOf",ut.value)},directives:[m.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],I.prototype,"value",void 0)},65720:(Kt,Mt,d)=>{d.d(Mt,{P:()=>m});var T=d(64762),s=d(74788),H=d(62141),P=d(36692);class m{constructor(I){this.value=0,this.valueChange=new s.vpe,I.subscribe(([pt])=>{this.value=pt,this.valueChange.emit(pt)})}get left(){return 100*this.value}}m.\u0275fac=function(I){return new(I||m)(s.Y36(H.i))},m.\u0275cmp=s.Xpm({type:m,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([P.TuiDestroyService,H.i])],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(I,pt){1&I&&s._UZ(0,"div",0),2&I&&s.Udp("left",pt.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],m.prototype,"value",void 0)},5451:(Kt,Mt,d)=>{d.d(Mt,{R:()=>ht});var T=d(64762),s=d(74788),H=d(36692),P=d(12057),m=d(67446),ct=d(29070),I=d(54255),pt=d(15491),ot=d(219);function ut(xt,mt){if(1&xt){const gt=s.EpF();s.TgZ(0,"button",1),s.NdJ("click",function(){const Et=s.CHM(gt).$implicit;return s.oxw().selectedColor.emit(Et.value)}),s.qZA()}if(2&xt){const gt=mt.$implicit;s.Udp("background",gt.value),s.Q6J("tuiHint",gt.key)("tuiHintDescribe",gt.key)("id",gt.key)}}class ht{constructor(){this.colors=new Map,this.selectedColor=new s.vpe,this.originalOrder=(mt,gt)=>0}}ht.\u0275fac=function(mt){return new(mt||ht)},ht.\u0275cmp=s.Xpm({type:ht,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:4,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintDescribe","id","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintDescribe","id","click"]],template:function(mt,gt){1&mt&&(s.YNc(0,ut,1,5,"button",0),s.ALo(1,"keyvalue")),2&mt&&s.Q6J("ngForOf",s.xi3(1,1,gt.colors,gt.originalOrder))},directives:[P.sg,m.D,ct.x,I.t,pt.D,ot.$],pipes:[P.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),(0,T.gn)([(0,H.tuiDefaultProp)()],ht.prototype,"colors",void 0)},45050:(Kt,Mt,d)=>{d.d(Mt,{l:()=>wt});var T=d(12057),s=d(74788),H=d(36692),P=d(87623),m=d(20986),ct=d(23738),I=d(34880),pt=d(76189),ot=d(66596);function ut(Ot,Et){if(1&Ot){const X=s.EpF();s.ynx(0),s.TgZ(1,"label",2),s._uU(2," URL "),s.TgZ(3,"span",3),s._uU(4),s.TgZ(5,"tui-input-inline",4),s.NdJ("ngModelChange",function(it){return s.CHM(X),s.oxw().onChange(it)})("keydown.prevent.enter",function(){return s.CHM(X),s.oxw().onSave()})("keydown.backspace",function(){return s.CHM(X),s.oxw().onBackspace()}),s._uU(6," example.com "),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"tui-svg",5),s.NdJ("click",function(){return s.CHM(X),s.oxw().onClear()}),s.qZA(),s.TgZ(8,"button",6),s.NdJ("click",function(){return s.CHM(X),s.oxw().onSave()}),s.qZA(),s.BQk()}if(2&Ot){const X=s.oxw();s.xp6(4),s.hij(" ",X.prefix," "),s.xp6(1),s.ekj("t-input_filled",X.hasUrl),s.Q6J("ngModel",X.url),s.xp6(2),s.ekj("t-cleaner_hidden",!X.hasUrl)}}function ht(Ot,Et){if(1&Ot){const X=s.EpF();s.TgZ(0,"a",7),s._uU(1),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(X),s.oxw().onEdit()}),s.qZA(),s.TgZ(3,"button",9),s.NdJ("click",function(){return s.CHM(X),s.oxw().onRemove()}),s.qZA()}if(2&Ot){const X=s.oxw();s.Q6J("href",X.href,s.LSH),s.xp6(1),s.hij(" ",X.shortUrl," ")}}let wt=(()=>{class Ot{constructor(X){this.documentRef=X,this.addLink=new s.vpe,this.removeLink=new s.vpe,this.url=this.makeUrl(),this.edit=!this.url,this.prefix="http://"}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get shortUrl(){return this.url.length<60?this.url:`${this.url.slice(0,Math.max(0,40))}...${this.url.slice(this.url.length-10)}`}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.makeUrl())}onMouseDown(X){(0,H.tuiIsElement)(X.target)&&!X.target.matches("a, button, input")&&X.preventDefault()}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix="http://")}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange(X){this.url=this.removePrefix(X)}onClear(){this.url=""}makeUrl(){const X=this.documentRef.getSelection();return X?this.getHref(X):""}getHref({focusNode:X}){if(!(null==X?void 0:X.parentElement))return"";const Q=X.parentElement.closest("a");return Q?this.removePrefix(Q.getAttribute("href")||""):this.url}removePrefix(X){return X.startsWith("http://")?(this.prefix="http://",X.replace("http://","")):X.startsWith("https://")?(this.prefix="https://",X.replace("https://","")):X}}return Ot.\u0275fac=function(X){return new(X||Ot)(s.Y36(T.K0))},Ot.\u0275cmp=s.Xpm({type:Ot,selectors:[["tui-edit-link"]],hostBindings:function(X,Q){1&X&&s.NdJ("selectionchange",function(){return Q.onSelectionChange()},!1,s.evT)("mousedown",function(K){return Q.onMouseDown(K)})},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["view",""],[1,"t-label"],[1,"t-url"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","keydown.prevent.enter","keydown.backspace"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiLink","","target","_blank",1,"t-link",3,"href"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEditLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconTrashLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"]],template:function(X,Q){if(1&X&&(s.YNc(0,ut,9,6,"ng-container",0),s.YNc(1,ht,4,2,"ng-template",null,1,s.W1O)),2&X){const it=s.MAs(2);s.Q6J("ngIf",Q.edit)("ngIfElse",it)}},directives:[T.O5,P.l,m.k,ct.JJ,ct.On,I.P,pt.v,ot.V],styles:["[_nghost-%COMP%]{display:flex;height:var(--tui-height-l);align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02)}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),Ot})()},71115:(Kt,Mt,d)=>{d.d(Mt,{l:()=>T.l,F:()=>pt});var T=d(45050),s=d(12057),H=d(23738),P=d(36692),m=d(72002),ct=d(753),I=d(74788);let pt=(()=>{class ot{}return ot.\u0275fac=function(ht){return new(ht||ot)},ot.\u0275mod=I.oAB({type:ot}),ot.\u0275inj=I.cJS({imports:[[s.ez,H.u5,P.TuiAutoFocusModule,m.TuiButtonModule,m.TuiSvgModule,m.TuiLinkModule,ct.TuiInputInlineModule]]}),ot})()},20179:(Kt,Mt,d)=>{d.d(Mt,{D:()=>H});var T=d(74788),s=d(72002);let H=(()=>{class P{constructor(ct,I,pt,ot){this.elementRef=ct,this.renderer=I,this.sanitizer=pt,this.tuiSanitizer=ot}set content(ct){this.renderer.setProperty(this.elementRef.nativeElement,"innerHTML",this.tuiSanitizer?this.tuiSanitizer.sanitize(T.q3G.HTML,ct.replace(/colwidth/g,"width")):this.sanitizer.sanitize(T.q3G.HTML,ct))}}return P.\u0275fac=function(ct){return new(ct||P)(T.Y36(T.SBq),T.Y36(T.Qsj),T.Y36(T.Tiy),T.Y36(s.TUI_SANITIZER,8))},P.\u0275cmp=T.Xpm({type:P,selectors:[["tui-editor-socket"]],hostAttrs:[1,"tui-editor-socket"],inputs:{content:"content"},decls:0,vars:0,template:function(ct,I){},styles:['.tui-editor-socket{display:block;margin:0;overflow:hidden;color:var(--tui-text-01);font:var(--tui-font-text-m)}.tui-editor-socket._preview-image img{cursor:pointer}.tui-editor-socket h1,.tui-editor-socket h2,.tui-editor-socket h3,.tui-editor-socket h4,.tui-editor-socket h5,.tui-editor-socket h6{word-break:break-word;line-height:normal}.tui-editor-socket .tableWrapper,.tui-editor-socket .tui-table-wrapper{overflow-x:auto}.tui-editor-socket .ProseMirror{min-height:5.375rem;padding:0 1rem;outline:none;white-space:pre-wrap}.tui-editor-socket p:empty:after{content:" ";white-space:pre}.tui-editor-socket p:first-child{margin-top:0}.tui-editor-socket ul,.tui-editor-socket ol{list-style-type:none;margin:1rem 1rem 1rem 1.5rem;padding:0}.tui-editor-socket li{margin:1rem 0}.tui-editor-socket li p{display:inline-block;margin:0 auto}.tui-editor-socket ul>li:before{content:"";display:inline-block;width:.5rem;height:.5rem;border-radius:100%;margin:.5rem .875rem .0625rem -1.375rem;background-color:var(--tui-primary);vertical-align:top;box-sizing:border-box}.tui-editor-socket li ul>li:before{background:none;border:.125rem solid var(--tui-primary)}.tui-editor-socket li ul>li>ul>li:before{background:var(--tui-primary);border-radius:0;width:.375rem;height:.375rem}.tui-editor-socket ol{counter-reset:counter}.tui-editor-socket ol>li:before{content:counter(counter) ".";width:1.5rem;margin:0 .75rem 0 -1.5rem;counter-increment:counter;color:var(--tui-base-05);vertical-align:top}.tui-editor-socket pre{white-space:pre-wrap;word-break:break-word;border-radius:.25rem;margin:1rem 0;padding:.75rem 1rem;font-family:Courier,monospace;color:var(--tui-text-02);background:var(--tui-base-02)}.tui-editor-socket code{box-shadow:none}.tui-editor-socket pre+pre{margin-top:-1.8125rem;padding-top:0}.tui-editor-socket blockquote{margin:1.25rem 0 1.25rem 1.5rem;padding-left:1.0625rem;border-left:1px solid var(--tui-base-04)}.tui-editor-socket p{margin:1rem 0}.tui-editor-socket a{color:var(--tui-link);text-decoration:none;outline:none}.tui-editor-socket a:hover{color:var(--tui-link-hover);text-decoration:underline}.tui-editor-socket a:active{color:var(--tui-primary-active)}.tui-editor-socket hr{border:none;border-top:1px solid var(--tui-base-03);margin:1rem 0}.tui-editor-socket table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.tui-editor-socket table td{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word}.tui-editor-socket table th{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word;font-weight:bold;text-align:left;background-color:var(--tui-base-02);min-height:2rem}.tui-editor-socket table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tui-editor-socket table td>*{margin-top:0;margin-bottom:0}.tui-editor-socket table th>*{margin-top:0;margin-bottom:0}.tui-editor-socket .resize-cursor{cursor:ew-resize;cursor:col-resize}.tui-editor-socket table .tableWrapper{overflow-x:auto}.tui-editor-socket .selectedCell:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--tui-selection);pointer-events:none}.tui-editor-socket font[face="Courier New"]{display:inline-block;padding:.25rem .5rem;border-radius:.25rem;background-color:#ecf1f7;word-break:break-word}.tui-editor-socket details{width:100%;border:1px solid var(--tui-base-04);border-radius:var(--tui-radius-l)}.tui-editor-socket summary{display:flex;align-items:center;min-height:3.5rem;width:100%;padding:0 1.25rem;box-sizing:border-box;border-radius:var(--tui-radius-l);pointer-events:none}.tui-editor-socket summary p{min-width:1px;margin:0}.tui-editor-socket summary::-webkit-details-marker{display:none}.tui-editor-socket details[open] summary{border-radius:var(--tui-radius-l) var(--tui-radius-l) 0 0}.tui-editor-socket div[data-type=details-content]{padding:1.25rem;min-height:3rem;border:1px solid var(--tui-base-04);border-width:1px 0 0}.tui-editor-socket .details-wrapper{position:relative;display:flex}.tui-editor-socket .details-arrow{position:absolute;top:1.5rem;right:1.25rem;height:.575rem;width:.575rem;border:1px solid var(--tui-base-06);border-width:0 2px 2px 0;transform:rotate(45deg);transition:var(--tui-duration, .3s);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;padding:0;background:none;cursor:pointer}.tui-editor-socket .details-wrapper_rendered .details-arrow{pointer-events:none}.tui-editor-socket .details-wrapper_rendered summary{transition:transform var(--tui-duration, .3s);cursor:pointer;pointer-events:auto}.tui-editor-socket .details-wrapper_rendered summary:hover{background:var(--tui-base-02)}.tui-editor-socket details[open]+.details-arrow{top:1.75rem;transform:rotate(225deg)}.t-editor-placeholder:before{content:attr(data-placeholder);float:left;color:var(--tui-base-05);pointer-events:none;height:0}.tui-group-node{display:flex;flex-direction:row}.tui-group-node:hover>.tui-group-pointer{pointer-events:auto;opacity:1}.tui-group-pointer{opacity:0;min-height:.8125rem;max-height:.8125rem;min-width:.8125rem;max-width:.8125rem;margin:.3125rem .3125rem 0 0;cursor:-webkit-grab;cursor:grab;background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="black" /></svg>\');background-repeat:no-repeat;background-size:contain;background-position:center}[data-mode=onDark] .tui-group-pointer{background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="white" /></svg>\')}\n'],encapsulation:2,changeDetection:0}),P})()},69303:(Kt,Mt,d)=>{d.d(Mt,{a:()=>Tt});var T=d(64762),s=d(12057),H=d(74788),P=d(23738),m=d(17406),ct=d(19074),I=d(40632),pt=d(62842),ot=d(37631),ut=d(36692),ht=d(79089),xt=d(40939),mt=d(2697),gt=d(17163),wt=d(3881),Ot=d(1433),Et=d(9872),X=d(4997),Q=d(33250),it=d(26072),K=d(9829),vt=d(82886),yt=d(39088),Pt=d(20179),Dt=d(74982),bt=d(45050);function Nt(W,J){if(1&W&&(H.TgZ(0,"tui-toolbar",9),H.Hsn(1,1),H.qZA()),2&W){const dt=H.oxw(2);H.Q6J("tools",dt.tools)("disabled",!dt.interactive)}}function zt(W,J){if(1&W&&(H.TgZ(0,"div",10),H._uU(1),H.qZA()),2&W){const dt=H.oxw(2);H.xp6(1),H.hij(" ",dt.exampleText," ")}}function ee(W,J){if(1&W){const dt=H.EpF();H.TgZ(0,"div",11),H.TgZ(1,"tui-editor-socket",12),H.NdJ("valueChange",function(Jt){return H.CHM(dt),H.oxw(2).onModelChange(Jt)})("stateChange",function(){return 0}),H.qZA(),H.qZA()}if(2&W){H.oxw();const dt=H.MAs(9),Lt=H.oxw();H.Q6J("tuiDropdownSelection",Lt.dropdownSelectionHandler)("tuiDropdown",dt),H.xp6(1),H.Q6J("value",Lt.value)("editable",Lt.interactive)}}function ft(W,J){if(1&W){const dt=H.EpF();H.TgZ(0,"tui-edit-link",13),H.NdJ("addLink",function(Jt){return H.CHM(dt),H.oxw(2).addLink(Jt)})("removeLink",function(){return H.CHM(dt),H.oxw(2).removeLink()}),H.qZA()}}function A(W,J){if(1&W){const dt=H.EpF();H.TgZ(0,"div",1),H.NdJ("tuiActiveZoneChange",function(Jt){return H.CHM(dt),H.oxw().onActiveZone(Jt)}),H.TgZ(1,"div",2),H.YNc(2,Nt,2,2,"tui-toolbar",3),H.TgZ(3,"div",4),H.Hsn(4),H.qZA(),H.YNc(5,zt,2,1,"div",5),H.qZA(),H.TgZ(6,"tui-scrollbar",6),H.YNc(7,ee,2,4,"div",7),H.YNc(8,ft,1,0,"ng-template",null,8,H.W1O),H._UZ(10,"tui-editor-portal-host"),H.qZA(),H.qZA()}if(2&W){const dt=J.tuiLet,Lt=H.oxw();H.Q6J("readOnly",Lt.readOnly)("disabled",Lt.disabled)("focus",Lt.computedFocused)("hover",Lt.pseudoHover)("invalid",Lt.computedInvalid),H.xp6(2),H.Q6J("ngIf",dt),H.xp6(1),H.ekj("t-placeholder_raised",Lt.placeholderRaised),H.xp6(2),H.Q6J("ngIf",Lt.hasExampleText),H.xp6(2),H.Q6J("ngIf",dt)}}const et=["*",[["tools"]]];class Tt extends ut.AbstractTuiControl{constructor(J,dt,Lt,Jt,qt,ce){super(J,dt),this.editorLoaded$=Lt,this.editorService=Jt,this.contentProcessor=qt,this.documentRef=ce,this.exampleText="",this.tools=ct.Db,this.focused=!1,this.isSelectionLink=le=>this.currentFocusedNodeIsAnchor(le)&&(0,ot.nC)(le)}get nativeFocusableElement(){var J;return this.computedDisabled?null:(null===(J=this.element)||void 0===J?void 0:J.nativeElement)||null}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:ut.ALWAYS_FALSE_HANDLER}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}writeValue(J){var dt;const Lt=this.contentProcessor(J||"");super.writeValue(Lt),Lt!==J&&(null===(dt=this.control)||void 0===dt||dt.setValue(Lt))}onActiveZone(J){this.focused=J,this.updateFocused(J)}onModelChange(J){this.updateValue(J)}addLink(J){var dt,Lt;null===(dt=this.editor)||void 0===dt||dt.selectClosest(),null===(Lt=this.editor)||void 0===Lt||Lt.setLink(J)}removeLink(){var J;null===(J=this.editor)||void 0===J||J.unsetLink()}ngOnDestroy(){var J;null===(J=this.editor)||void 0===J||J.destroy()}getFallbackValue(){return""}currentFocusedNodeIsAnchor(J){var dt,Lt,Jt;return!!(null===(Lt=null===(dt=J.startContainer.parentElement)||void 0===dt?void 0:dt.closest("a"))||void 0===Lt?void 0:Lt.contains((null===(Jt=this.documentRef.getSelection())||void 0===Jt?void 0:Jt.focusNode)||null))}get hasValue(){return!!this.value}}Tt.\u0275fac=function(J){return new(J||Tt)(H.Y36(P.a5,10),H.Y36(H.sBO),H.Y36(pt.ZW),H.Y36(I.$3),H.Y36(pt.F1),H.Y36(s.K0))},Tt.\u0275cmp=H.Xpm({type:Tt,selectors:[["tui-editor"]],viewQuery:function(J,dt){if(1&J&&(H.Gf(I.JU,5,H.SBq),H.Gf(m.M6,5)),2&J){let Lt;H.iGM(Lt=H.CRH())&&(dt.element=Lt.first),H.iGM(Lt=H.CRH())&&(dt.toolbar=Lt.first)}},inputs:{exampleText:"exampleText",tools:"tools"},features:[H._Bn([(0,ut.tuiAsFocusableItemAccessor)(Tt),ht.m]),H.qOj],ngContentSelectors:["*","tools"],decls:2,vars:3,consts:[["tuiWrapper","","appearance","textfield","class","t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange",4,"tuiLet"],["tuiWrapper","","appearance","textfield",1,"t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],[3,"tools","disabled",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","",1,"t-scrollbar"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown",4,"ngIf"],["dropdown",""],[3,"tools","disabled"],[1,"t-example-text"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown"],["tuiTiptapEditor","","spellcheck","false",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange"],[3,"addLink","removeLink"]],template:function(J,dt){1&J&&(H.F$t(et),H.YNc(0,A,11,10,"div",0),H.ALo(1,"async")),2&J&&H.Q6J("tuiLet",H.lcZ(1,1,dt.editorLoaded$))},directives:[xt.L,mt.o,gt.e,s.O5,wt.I,Ot.A,Et.d,X.M,Q.Ek,it.t,K.V,vt.A,yt.y,Pt.D,Dt.J,bt.l],pipes:[s.Ov],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m);border-radius:var(--tui-radius-m)}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:10rem;cursor:text;overflow:hidden;flex-direction:column;border-radius:inherit}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);position:absolute;left:1rem;margin-top:1rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem)}[data-size=m][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}[data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], [data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size=l][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font-size:.9375rem}[data-size=l][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[data-mode=onDark][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size=m][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens: none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-placeholder_raised[_ngcontent-%COMP%]{width:110%}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;max-height:inherit;border-top:1.625rem solid transparent;border-bottom:1px solid transparent;box-sizing:border-box}"],changeDetection:0}),(0,T.gn)([(0,ut.tuiDefaultProp)()],Tt.prototype,"exampleText",void 0),(0,T.gn)([(0,ut.tuiDefaultProp)()],Tt.prototype,"tools",void 0)},79089:(Kt,Mt,d)=>{d.d(Mt,{m:()=>ut});var T=d(74788),s=d(40632),H=d(62842),P=d(82298),m=d(9112),ct=d(15257),I=d(88002),pt=d(47349),ot=d(73825);const ut=[{provide:H.F4,deps:[H.Wf],useFactory:ht=>{const xt=new P.t(1);return Promise.all(ht).then(mt=>xt.next(mt)),xt}},{provide:H.Y1,deps:[T.Qsj],useFactory:ht=>ht.createElement("div")},{provide:H.ZW,deps:[H.Y1,H.F4,H.bG],useFactory:(ht,xt,mt)=>(0,m.aj)([mt,xt]).pipe((0,ct.q)(1),(0,I.U)(([gt,wt])=>new gt({element:ht,extensions:wt})),(0,pt.d)({bufferSize:1,refCount:!0}))},s.$3,ot.Y]},9872:(Kt,Mt,d)=>{d.d(Mt,{d:()=>H});var T=d(36692),s=d(74788);let H=(()=>{class P extends T.AbstractTuiPortalHostComponent{}return P.\u0275fac=function(){let m;return function(I){return(m||(m=s.n5z(P)))(I||P)}}(),P.\u0275cmp=s.Xpm({type:P,selectors:[["tui-editor-portal-host"]],features:[s._Bn([{provide:T.AbstractTuiPortalService,useExisting:T.TuiDropdownPortalService},{provide:T.AbstractTuiPortalHostComponent,useExisting:P}]),s.qOj],decls:2,vars:0,consts:[["viewContainer",""]],template:function(ct,I){1&ct&&s.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),P})()},1433:(Kt,Mt,d)=>{d.d(Mt,{A:()=>P});var T=d(36692),s=d(73825),H=d(74788);let P=(()=>{class m{}return m.\u0275fac=function(I){return new(I||m)},m.\u0275dir=H.lG2({type:m,selectors:[["","tuiEditorPortal",""]],features:[H._Bn([{provide:T.TuiDropdownPortalService,useExisting:s.Y}])]}),m})()},73825:(Kt,Mt,d)=>{d.d(Mt,{Y:()=>H});var T=d(36692),s=d(74788);let H=(()=>{class P extends T.AbstractTuiPortalService{}return P.\u0275fac=function(){let m;return function(I){return(m||(m=s.n5z(P)))(I||P)}}(),P.\u0275prov=s.Yz7({token:P,factory:P.\u0275fac}),P})()},19769:(Kt,Mt,d)=>{d.d(Mt,{j:()=>Et});var T=d(64762),s=d(74788),H=d(23738),P=d(91211),m=d(37631),ct=d(36692),I=d(72002),pt=d(62939),ot=d(63060),ut=d(62733),ht=d(3729),xt=d(23999),mt=d(17163);function gt(X,Q){if(1&X&&s._UZ(0,"div",4),2&X){const it=s.oxw();s.Udp("background",it.background)}}function wt(X,Q){if(1&X){const it=s.EpF();s.TgZ(0,"tui-color-selector",5),s.NdJ("colorChange",function(vt){return s.CHM(it),s.oxw().onValueChange(vt)}),s.qZA()}if(2&X){const it=Q.$implicit,K=s.oxw();s.Q6J("tuiActiveZoneParent",it)("colors",K.colors)("color",K.value)}}class Et extends ct.AbstractTuiControl{constructor(Q,it,K){super(Q,it),this.domSanitizer=K,this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onValueChange(Q){this.updateValue(Q)}onFocused(Q){this.updateFocused(Q)}getFallbackValue(){return"#000000"}sanitize(Q,it){return Q.startsWith("linear-gradient(")?it.bypassSecurityTrustStyle((0,m.CH)((0,m._N)((0,m.U5)(Q)))):Q}}Et.\u0275fac=function(Q){return new(Q||Et)(s.Y36(H.a5,10),s.Y36(s.sBO),s.Y36(P.H7))},Et.\u0275cmp=s.Xpm({type:Et,selectors:[["tui-input-color"]],viewQuery:function(Q,it){if(1&Q&&(s.Gf(I.TuiPrimitiveTextfieldComponent,5),s.Gf(I.TuiHostedDropdownComponent,5)),2&Q){let K;s.iGM(K=s.CRH())&&(it.textfield=K.first),s.iGM(K=s.CRH())&&(it.dropdown=K.first)}},hostBindings:function(Q,it){1&Q&&s.NdJ("click",function(){return it.onClick()})},inputs:{colors:"colors"},features:[s._Bn([],[(0,I.tuiDropdownOptionsProvider)({maxHeight:600})]),s.qOj],ngContentSelectors:["*"],decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"tuiTextfieldIconLeft","pseudoFocus","pseudoHover","pseudoActive","invalid","focusable","nativeId","disabled","readOnly","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"tuiActiveZoneParent","colors","color","colorChange"]],template:function(Q,it){if(1&Q&&(s.F$t(),s.TgZ(0,"tui-hosted-dropdown",0),s.NdJ("openChange",function(vt){return it.open=vt}),s.TgZ(1,"tui-primitive-textfield",1),s.NdJ("valueChange",function(vt){return it.onValueChange(vt)})("focusedChange",function(vt){return it.onFocused(vt)}),s.Hsn(2),s.qZA(),s.qZA(),s.YNc(3,gt,1,2,"ng-template",null,2,s.W1O),s.YNc(5,wt,1,3,"ng-template",null,3,s.W1O)),2&Q){const K=s.MAs(4),vt=s.MAs(6);s.Q6J("content",vt)("open",it.open),s.xp6(1),s.Q6J("tuiTextfieldIconLeft",K)("pseudoFocus",it.computedFocused)("pseudoHover",it.pseudoHover)("pseudoActive",it.pseudoActive)("invalid",it.computedInvalid)("focusable",it.focusable)("nativeId",it.nativeId)("disabled",it.disabled)("readOnly",it.readOnly)("value",it.value)}},directives:[pt.o,ot.y,ut.B,ht.aR,xt.s,mt.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem}"],changeDetection:0}),(0,T.gn)([(0,ct.tuiDefaultProp)()],Et.prototype,"colors",void 0),(0,T.gn)([ct.tuiPure],Et.prototype,"sanitize",null)},37924:(Kt,Mt,d)=>{d.d(Mt,{X:()=>X});var T=d(40632),s=d(62842),H=d(9112),P=d(88002),m=d(74788),ct=d(12057),I=d(40939),pt=d(62939),ot=d(76189),ut=d(67446),ht=d(29070),xt=d(54255),mt=d(15491),gt=d(219);function wt(Q,it){if(1&Q){const K=m.EpF();m.TgZ(0,"div",6),m.TgZ(1,"button",7),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).editor.onAlign("left")}),m.qZA(),m.TgZ(2,"button",8),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).editor.onAlign("center")}),m.qZA(),m.TgZ(3,"button",9),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).editor.onAlign("right")}),m.qZA(),m.TgZ(4,"button",10),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).editor.onAlign("justify")}),m.qZA(),m.qZA()}if(2&Q){const K=m.oxw().tuiLet,vt=m.oxw().ngIf;m.xp6(1),m.Q6J("pseudoActive",!(null==K||!K.left))("tuiHint",vt.justifyLeft),m.xp6(1),m.Q6J("pseudoActive",!(null==K||!K.center))("tuiHint",vt.justifyCenter),m.xp6(1),m.Q6J("pseudoActive",!(null==K||!K.right))("tuiHint",vt.justifyRight),m.xp6(1),m.Q6J("pseudoActive",!(null==K||!K.justify))("tuiHint",vt.justifyFull)}}function Ot(Q,it){if(1&Q&&(m.TgZ(0,"tui-hosted-dropdown",2,3),m._UZ(2,"button",4),m.YNc(3,wt,5,8,"ng-template",null,5,m.W1O),m.qZA()),2&Q){const K=m.MAs(1),vt=m.MAs(4),yt=m.oxw().ngIf;m.Q6J("content",vt),m.xp6(2),m.Q6J("tuiHint",yt.justify)("tuiHintDescribe","")("pseudoActive",K.open)("focusable",K.open)}}function Et(Q,it){if(1&Q&&(m.ynx(0),m.YNc(1,Ot,5,5,"tui-hosted-dropdown",1),m.ALo(2,"async"),m.BQk()),2&Q){const K=m.oxw();m.xp6(1),m.Q6J("tuiLet",m.lcZ(2,1,K.alignState$))}}let X=(()=>{class Q{constructor(K,vt){this.editor=K,this.texts$=vt,this.alignState$=(0,H.aj)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,P.U)(([yt,Pt,Dt,bt])=>({left:yt,right:Pt,center:Dt,justify:bt})))}}return Q.\u0275fac=function(K){return new(K||Q)(m.Y36(T.$3),m.Y36(s.rf))},Q.\u0275cmp=m.Xpm({type:Q,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"]],template:function(K,vt){1&K&&(m.YNc(0,Et,3,3,"ng-container",0),m.ALo(1,"async")),2&K&&m.Q6J("ngIf",m.lcZ(1,1,vt.texts$))},directives:[ct.O5,I.L,pt.o,ot.v,ut.D,ht.x,xt.t,mt.D,gt.$],pipes:[ct.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),Q})()},15587:(Kt,Mt,d)=>{d.d(Mt,{T:()=>X});var T=d(40632),s=d(62842),H=d(88002),P=d(87519),m=d(74788),ct=d(62939),I=d(76189),pt=d(67446),ot=d(29070),ut=d(54255),ht=d(15491),xt=d(219),mt=d(20933),gt=d(12057),wt=d(35065);function Ot(Q,it){if(1&Q){const K=m.EpF();m.TgZ(0,"button",5),m.NdJ("click",function(){const Pt=m.CHM(K).index;return m.oxw(2).onCode(!!Pt)}),m._uU(1),m.qZA()}if(2&Q){const K=it.$implicit;m.xp6(1),m.hij(" ",K," ")}}function Et(Q,it){if(1&Q&&(m.TgZ(0,"tui-data-list"),m.YNc(1,Ot,2,1,"button",4),m.ALo(2,"async"),m.qZA()),2&Q){const K=m.oxw();m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,1,K.codeOptionsTexts$))}}let X=(()=>{class Q{constructor(K,vt,yt){this.editor=K,this.texts$=vt,this.codeOptionsTexts$=yt,this.hintText$=this.texts$.pipe((0,H.U)(Pt=>Pt.code)),this.insideCode$=this.editor.stateChange$.pipe((0,H.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,P.x)())}onCode(K){K?this.editor.toggleCodeBlock():this.editor.toggleCode()}}return Q.\u0275fac=function(K){return new(K||Q)(m.Y36(T.$3),m.Y36(s.rf),m.Y36(s.Mr))},Q.\u0275cmp=m.Xpm({type:Q,selectors:[["tui-code"]],decls:7,vars:9,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(K,vt){if(1&K&&(m.TgZ(0,"tui-hosted-dropdown",0,1),m._UZ(2,"button",2),m.ALo(3,"async"),m.ALo(4,"async"),m.YNc(5,Et,3,3,"ng-template",null,3,m.W1O),m.qZA()),2&K){const yt=m.MAs(1),Pt=m.MAs(6);m.Q6J("content",Pt),m.xp6(2),m.Q6J("tuiHint",m.lcZ(3,5,vt.hintText$))("tuiHintDescribe","")("pseudoActive",yt.open||m.lcZ(4,7,vt.insideCode$))("focusable",yt.open)}},directives:[ct.o,I.v,pt.D,ot.x,ut.t,ht.D,xt.$,mt.q,gt.sg,wt.v],pipes:[gt.Ov],encapsulation:2,changeDetection:0}),Q})()},18832:(Kt,Mt,d)=>{d.d(Mt,{U:()=>gt});var T=d(40632),s=d(62842),H=d(88002),P=d(87519),m=d(74788),ct=d(12057),I=d(76189),pt=d(67446),ot=d(29070),ut=d(54255),ht=d(15491),xt=d(219);function mt(wt,Ot){if(1&wt){const Et=m.EpF();m.TgZ(0,"button",1),m.NdJ("click",function(){return m.CHM(Et),m.oxw().removeDetails()}),m.ALo(1,"async"),m.qZA()}if(2&wt){const Et=Ot.ngIf,X=m.oxw();m.Q6J("tuiHint",Et.removeDetails)("tuiHintDescribe","")("focusable",!1)("disabled",!!m.lcZ(1,4,X.disabled$))}}let gt=(()=>{class wt{constructor(Et,X){this.editor=Et,this.texts$=X,this.disabled$=this.editor.stateChange$.pipe((0,H.U)(()=>!this.editor.isActive("details")),(0,P.x)())}removeDetails(){this.editor.removeDetails()}}return wt.\u0275fac=function(Et){return new(Et||wt)(m.Y36(T.$3),m.Y36(s.rf))},wt.\u0275cmp=m.Xpm({type:wt,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(Et,X){1&Et&&(m.YNc(0,mt,2,6,"button",0),m.ALo(1,"async")),2&Et&&m.Q6J("ngIf",m.lcZ(1,1,X.texts$))},directives:[ct.O5,I.v,pt.D,ot.x,ut.t,ht.D,xt.$],pipes:[ct.Ov],encapsulation:2,changeDetection:0}),wt})()},50237:(Kt,Mt,d)=>{d.d(Mt,{y:()=>xt});var T=d(40632),s=d(62842),H=d(74788),P=d(12057),m=d(76189),ct=d(67446),I=d(29070),pt=d(54255),ot=d(15491),ut=d(219);function ht(mt,gt){if(1&mt){const wt=H.EpF();H.TgZ(0,"button",1),H.NdJ("click",function(){return H.CHM(wt),H.oxw().setDetails()}),H.qZA()}2&mt&&H.Q6J("tuiHint",gt.ngIf.setDetails)("tuiHintDescribe","")("focusable",!1)}let xt=(()=>{class mt{constructor(wt,Ot){this.editor=wt,this.texts$=Ot}setDetails(){this.editor.setDetails()}}return mt.\u0275fac=function(wt){return new(wt||mt)(H.Y36(T.$3),H.Y36(s.rf))},mt.\u0275cmp=H.Xpm({type:mt,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click"]],template:function(wt,Ot){1&wt&&(H.YNc(0,ht,1,3,"button",0),H.ALo(1,"async")),2&wt&&H.Q6J("ngIf",H.lcZ(1,1,Ot.texts$))},directives:[P.O5,m.v,ct.D,I.x,pt.t,ot.D,ut.$],pipes:[P.Ov],encapsulation:2,changeDetection:0}),mt})()},84985:(Kt,Mt,d)=>{d.d(Mt,{m:()=>X});var T=d(40632),s=d(62842),H=d(36692),P=d(88002),m=d(74788),ct=d(62939),I=d(76189),pt=d(67446),ot=d(29070),ut=d(54255),ht=d(15491),xt=d(219),mt=d(20933),gt=d(12057),wt=d(35065);function Ot(Q,it){if(1&Q){const K=m.EpF();m.TgZ(0,"button",5),m.NdJ("click",function(){const Pt=m.CHM(K).$implicit;return m.oxw(2).onClick(Pt)}),m.ALo(1,"lowercase"),m._uU(2),m.qZA()}if(2&Q){const K=it.$implicit;m.Udp("font-family",K.family)("font-size",K.px,"px")("font-weight",K.weight),m.uIk("automation-id","tui_font__"+m.lcZ(1,8,K.name||"")),m.xp6(2),m.hij(" ",K.name," ")}}function Et(Q,it){if(1&Q&&(m.TgZ(0,"tui-data-list"),m.YNc(1,Ot,3,10,"button",4),m.ALo(2,"async"),m.qZA()),2&Q){const K=m.oxw();m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,1,K.fontsOptions$))}}let X=(()=>{class Q{constructor(K,vt,yt,Pt){this.options=K,this.editor=vt,this.texts$=yt,this.fontOptionsTexts$=Pt,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,P.U)(Dt=>this.options.fontOptions(Dt))),this.fontText$=this.texts$.pipe((0,P.U)(Dt=>Dt.font))}onClick({headingLevel:K,px:vt}){K?this.editor.setHeading(K):this.editor.setParagraph({fontSize:(0,H.tuiPx)(vt||0)})}}return Q.\u0275fac=function(K){return new(K||Q)(m.Y36(s.mJ),m.Y36(T.$3),m.Y36(s.rf),m.Y36(s.UN))},Q.\u0275cmp=m.Xpm({type:Q,selectors:[["tui-font-size"]],decls:6,vars:7,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(K,vt){if(1&K&&(m.TgZ(0,"tui-hosted-dropdown",0,1),m._UZ(2,"button",2),m.ALo(3,"async"),m.YNc(4,Et,3,3,"ng-template",null,3,m.W1O),m.qZA()),2&K){const yt=m.MAs(1),Pt=m.MAs(5);m.Q6J("content",Pt),m.xp6(2),m.Q6J("tuiHint",m.lcZ(3,5,vt.fontText$))("tuiHintDescribe","")("pseudoActive",yt.open)("focusable",yt.open)}},directives:[ct.o,I.v,pt.D,ot.x,ut.t,ht.D,xt.$,mt.q,gt.sg,wt.v],pipes:[gt.Ov,gt.i8],encapsulation:2,changeDetection:0}),Q})()},62976:(Kt,Mt,d)=>{d.d(Mt,{h:()=>yt});var T=d(19074),s=d(40632),H=d(48699),P=d(62842),m=d(9112),ct=d(88002),I=d(74788),pt=d(12057),ot=d(62939),ut=d(76189),ht=d(67446),xt=d(29070),mt=d(54255),gt=d(15491),wt=d(219);function Ot(Pt,Dt){if(1&Pt){const bt=I.EpF();I.TgZ(0,"button",11),I.NdJ("click",function(){return I.CHM(bt),I.oxw(4).editor.toggleBold()}),I.qZA()}if(2&Pt){const bt=I.oxw(2).ngIf,Nt=I.oxw().ngIf;I.Q6J("tuiHint",Nt.bold)("pseudoActive",bt.bold)}}function Et(Pt,Dt){if(1&Pt){const bt=I.EpF();I.TgZ(0,"button",12),I.NdJ("click",function(){return I.CHM(bt),I.oxw(4).editor.toggleItalic()}),I.qZA()}if(2&Pt){const bt=I.oxw(2).ngIf,Nt=I.oxw().ngIf;I.Q6J("tuiHint",Nt.italic)("pseudoActive",bt.italic)}}function X(Pt,Dt){if(1&Pt){const bt=I.EpF();I.TgZ(0,"button",13),I.NdJ("click",function(){return I.CHM(bt),I.oxw(4).editor.toggleUnderline()}),I.qZA()}if(2&Pt){const bt=I.oxw(2).ngIf,Nt=I.oxw().ngIf;I.Q6J("tuiHint",Nt.underline)("pseudoActive",bt.underline)}}function Q(Pt,Dt){if(1&Pt){const bt=I.EpF();I.TgZ(0,"button",14),I.NdJ("click",function(){return I.CHM(bt),I.oxw(4).editor.toggleStrike()}),I.qZA()}if(2&Pt){const bt=I.oxw(2).ngIf,Nt=I.oxw().ngIf;I.Q6J("tuiHint",Nt.strikeThrough)("pseudoActive",bt.strike)}}function it(Pt,Dt){if(1&Pt&&(I.TgZ(0,"div",6),I.YNc(1,Ot,1,2,"button",7),I.YNc(2,Et,1,2,"button",8),I.YNc(3,X,1,2,"button",9),I.YNc(4,Q,1,2,"button",10),I.qZA()),2&Pt){const bt=I.oxw(3);I.xp6(1),I.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Bold)),I.xp6(1),I.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Italic)),I.xp6(1),I.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Underline)),I.xp6(1),I.Q6J("ngIf",bt.isEnabled(bt.TuiEditorTool.Strikethrough))}}function K(Pt,Dt){if(1&Pt&&(I.TgZ(0,"tui-hosted-dropdown",2,3),I._UZ(2,"button",4),I.YNc(3,it,5,4,"ng-template",null,5,I.W1O),I.qZA()),2&Pt){const bt=Dt.ngIf,Nt=I.MAs(1),zt=I.MAs(4),ee=I.oxw().ngIf;I.Q6J("content",zt),I.xp6(2),I.Q6J("tuiHint",ee.fontStyle)("tuiHintDescribe","")("pseudoActive",Nt.open||bt.bold||bt.italic||bt.underline||bt.strike)("focusable",Nt.open)}}function vt(Pt,Dt){if(1&Pt&&(I.ynx(0),I.YNc(1,K,5,5,"tui-hosted-dropdown",1),I.ALo(2,"async"),I.BQk()),2&Pt){const bt=I.oxw();I.xp6(1),I.Q6J("ngIf",I.lcZ(2,1,bt.fontStyleState$))}}let yt=(()=>{class Pt{constructor(bt,Nt){this.editor=bt,this.texts$=Nt,this.toolsSet=new Set(T.Db),this.TuiEditorTool=H._,this.fontStyleState$=(0,m.aj)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,ct.U)(([zt,ee,ft,A])=>({bold:zt,italic:ee,underline:ft,strike:A})))}set enabledTools(bt){this.toolsSet=new Set(bt)}isEnabled(bt){return this.toolsSet.has(bt)}}return Pt.\u0275fac=function(bt){return new(bt||Pt)(I.Y36(s.$3),I.Y36(P.rf))},Pt.\u0275cmp=I.Xpm({type:Pt,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"]],template:function(bt,Nt){1&bt&&(I.YNc(0,vt,3,3,"ng-container",0),I.ALo(1,"async")),2&bt&&I.Q6J("ngIf",I.lcZ(1,1,Nt.texts$))},directives:[pt.O5,ot.o,ut.v,ht.D,xt.x,mt.t,gt.D,wt.$],pipes:[pt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),Pt})()},19762:(Kt,Mt,d)=>{d.d(Mt,{d:()=>mt});var T=d(40632),s=d(62842),H=d(88002),P=d(87519),m=d(74788),ct=d(76189),I=d(67446),pt=d(29070),ot=d(54255),ut=d(15491),ht=d(219),xt=d(12057);let mt=(()=>{class gt{constructor(Ot,Et){this.editor=Ot,this.texts$=Et,this.insertGroupText$=this.texts$.pipe((0,H.U)(X=>X.insertGroup)),this.removeGroupText$=this.texts$.pipe((0,H.U)(X=>X.removeGroup)),this.disabled$=this.editor.stateChange$.pipe((0,H.U)(()=>!this.editor.isActive("group")),(0,P.x)())}addGroup(){this.editor.setGroup()}removeGroup(){this.editor.removeGroup()}}return gt.\u0275fac=function(Ot){return new(Ot||gt)(m.Y36(T.$3),m.Y36(s.rf))},gt.\u0275cmp=m.Xpm({type:gt,selectors:[["tui-editor-group-tool"]],decls:5,vars:13,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconPlusLarge","appearance","icon",3,"focusable","tuiHint","tuiHintDescribe","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconRemoveLarge","appearance","icon",3,"focusable","disabled","tuiHint","tuiHintDescribe","click"]],template:function(Ot,Et){1&Ot&&(m.TgZ(0,"button",0),m.NdJ("click",function(){return Et.addGroup()}),m.ALo(1,"async"),m.qZA(),m.TgZ(2,"button",1),m.NdJ("click",function(){return Et.removeGroup()}),m.ALo(3,"async"),m.ALo(4,"async"),m.qZA()),2&Ot&&(m.Q6J("focusable",!1)("tuiHint",m.lcZ(1,7,Et.insertGroupText$))("tuiHintDescribe",""),m.xp6(2),m.Q6J("focusable",!1)("disabled",!!m.lcZ(3,9,Et.disabled$))("tuiHint",m.lcZ(4,11,Et.removeGroupText$))("tuiHintDescribe",""))},directives:[ct.v,I.D,pt.x,ot.t,ut.D,ht.$],pipes:[xt.Ov],encapsulation:2,changeDetection:0}),gt})()},7416:(Kt,Mt,d)=>{d.d(Mt,{U:()=>yt});var T=d(64762),s=d(40632),H=d(62842),P=d(36692),m=d(88002),ct=d(87519),I=d(74788),pt=d(40939),ot=d(62939),ut=d(33250),ht=d(76189),xt=d(67446),mt=d(29070),gt=d(54255),wt=d(15491),Ot=d(219),Et=d(12057),X=d(5451),Q=d(17163);function it(Pt,Dt){if(1&Pt&&I._UZ(0,"div",6),2&Pt){const bt=I.oxw().tuiLet;I.Udp("background",bt)}}function K(Pt,Dt){if(1&Pt){const bt=I.EpF();I.TgZ(0,"tui-palette",7),I.NdJ("selectedColor",function(zt){return I.CHM(bt),I.oxw(2).editor.setBackgroundColor(zt)}),I.qZA()}if(2&Pt){const bt=Dt.$implicit,Nt=I.oxw(2);I.Q6J("tuiActiveZoneParent",bt)("colors",Nt.colors)}}function vt(Pt,Dt){if(1&Pt&&(I.TgZ(0,"tui-hosted-dropdown",1,2),I._UZ(2,"button",3),I.ALo(3,"async"),I.YNc(4,it,1,2,"div",4),I.YNc(5,K,1,2,"ng-template",null,5,I.W1O),I.qZA()),2&Pt){const bt=Dt.tuiLet,Nt=I.MAs(1),zt=I.MAs(6),ee=I.oxw();I.Q6J("content",zt)("tuiDropdownMaxHeight",999),I.xp6(2),I.Q6J("tuiHint",I.lcZ(3,7,ee.backColorText$))("tuiHintDescribe","")("pseudoActive",Nt.open)("focusable",Nt.open),I.xp6(2),I.Q6J("ngIf",!ee.isBlankColor(bt||""))}}class yt{constructor(Dt,bt,Nt){this.editor=Dt,this.texts$=bt,this.defaultOptions=Nt,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,m.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,ct.x)()),this.backColorText$=this.texts$.pipe((0,m.U)(zt=>zt.backColor))}isBlankColor(Dt){return Dt===this.defaultOptions.blankColor}}yt.\u0275fac=function(Dt){return new(Dt||yt)(I.Y36(s.$3),I.Y36(H.rf),I.Y36(H.mJ))},yt.\u0275cmp=I.Xpm({type:yt,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(Dt,bt){1&Dt&&(I.YNc(0,vt,7,9,"tui-hosted-dropdown",0),I.ALo(1,"async")),2&Dt&&I.Q6J("tuiLet",I.lcZ(1,1,bt.backgroundColor$))},directives:[pt.L,ot.o,ut.Ek,ht.v,xt.D,mt.x,gt.t,wt.D,Ot.$,Et.O5,X.R,Q.e],pipes:[Et.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],yt.prototype,"colors",void 0)},93252:(Kt,Mt,d)=>{d.d(Mt,{Xp:()=>T.X,pu:()=>ct,Tf:()=>I.T,P_:()=>pt,yj:()=>ot.y,y9:()=>ut,Un:()=>ht.U,dN:()=>Ot.d,jP:()=>Et,mK:()=>xt.m,p7:()=>mt,hr:()=>gt.h,Zv:()=>wt,UT:()=>X.U,XC:()=>it,w2:()=>K.w,Ur:()=>vt,pH:()=>yt.p,mp:()=>Pt,iN:()=>A.i,lT:()=>Dt.l,iA:()=>zt,YH:()=>ee.Y,er:()=>ft,_I:()=>A._,__:()=>et,M8:()=>bt.M,kU:()=>Nt,G0:()=>at.G,_t:()=>Tt});var T=d(37924),s=d(12057),H=d(36692),P=d(72002),m=d(74788);let ct=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,H.TuiLetModule]]}),W})();var I=d(15587);let pt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,P.TuiDataListModule]]}),W})();var ot=d(50237);let ut=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHintModule]]}),W})();var ht=d(18832),xt=d(84985);let mt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,P.TuiDataListModule]]}),W})();var gt=d(62976);let wt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule]]}),W})();var Ot=d(19762);let Et=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHintModule]]}),W})();var X=d(7416),Q=d(27050);let it=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,Q.VM,P.TuiHintModule,P.TuiDropdownModule,H.TuiActiveZoneModule,H.TuiLetModule]]}),W})();var K=d(13441);let vt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,H.TuiLetModule]]}),W})();var yt=d(95558);let Pt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,Q.VM,P.TuiButtonModule,P.TuiHintModule,H.TuiActiveZoneModule,P.TuiDropdownModule,H.TuiLetModule]]}),W})();var Dt=d(28962),bt=d(74549);let Nt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,H.TuiRepeatTimesModule]]}),W})(),zt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiDropdownModule,P.TuiButtonModule,P.TuiHintModule,Nt]]}),W})();var ee=d(76965);let ft=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHintModule,H.TuiLetModule]]}),W})();var A=d(22063);let et=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiHintModule,P.TuiButtonModule,P.TuiDataListModule,H.TuiLetModule]]}),W})();var at=d(10528);let Tt=(()=>{class W{}return W.\u0275fac=function(dt){return new(dt||W)},W.\u0275mod=m.oAB({type:W}),W.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHostedDropdownModule,P.TuiDropdownModule,P.TuiHintModule,Q.VM,H.TuiActiveZoneModule,H.TuiLetModule]]}),W})()},13441:(Kt,Mt,d)=>{d.d(Mt,{w:()=>X});var T=d(40632),s=d(62842),H=d(9112),P=d(88002),m=d(74788),ct=d(12057),I=d(40939),pt=d(62939),ot=d(76189),ut=d(67446),ht=d(29070),xt=d(54255),mt=d(15491),gt=d(219);function wt(Q,it){if(1&Q){const K=m.EpF();m.TgZ(0,"div",6),m.TgZ(1,"button",7),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).editor.toggleUnorderedList()}),m.qZA(),m.TgZ(2,"button",8),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).editor.toggleOrderedList()}),m.qZA(),m.TgZ(3,"button",9),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).sinkListItem()}),m.qZA(),m.TgZ(4,"button",10),m.NdJ("click",function(){return m.CHM(K),m.oxw(3).liftListItem()}),m.qZA(),m.qZA()}if(2&Q){const K=m.oxw().tuiLet,vt=m.oxw().ngIf;m.xp6(1),m.Q6J("tuiHint",vt.unorderedList)("pseudoActive",!(null==K||!K.unordered)),m.xp6(1),m.Q6J("tuiHint",vt.orderedList)("pseudoActive",!(null==K||!K.ordered)),m.xp6(1),m.Q6J("tuiHint",vt.indent)("disabled",!(null!=K&&K.ordered||null!=K&&K.unordered)),m.xp6(1),m.Q6J("tuiHint",vt.outdent)("disabled",!(null!=K&&K.ordered||null!=K&&K.unordered))}}function Ot(Q,it){if(1&Q&&(m.TgZ(0,"tui-hosted-dropdown",2,3),m._UZ(2,"button",4),m.YNc(3,wt,5,8,"ng-template",null,5,m.W1O),m.qZA()),2&Q){const K=it.tuiLet,vt=m.MAs(1),yt=m.MAs(4),Pt=m.oxw().ngIf;m.Q6J("content",yt),m.xp6(2),m.Q6J("tuiHint",Pt.list)("tuiHintDescribe","")("pseudoActive",(null==vt?null:vt.open)||(null==K?null:K.unordered)||(null==K?null:K.ordered)||!1)("focusable",vt.open)}}function Et(Q,it){if(1&Q&&(m.ynx(0),m.YNc(1,Ot,5,5,"tui-hosted-dropdown",1),m.ALo(2,"async"),m.BQk()),2&Q){const K=m.oxw();m.xp6(1),m.Q6J("tuiLet",m.lcZ(2,1,K.listState$))}}let X=(()=>{class Q{constructor(K,vt){this.editor=K,this.texts$=vt,this.listState$=(0,H.aj)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,P.U)(([yt,Pt])=>({ordered:yt,unordered:Pt})))}sinkListItem(){this.editor.sinkListItem()}liftListItem(){this.editor.liftListItem()}}return Q.\u0275fac=function(K){return new(K||Q)(m.Y36(T.$3),m.Y36(s.rf))},Q.\u0275cmp=m.Xpm({type:Q,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","disabled","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","disabled","click"]],template:function(K,vt){1&K&&(m.YNc(0,Et,3,3,"ng-container",0),m.ALo(1,"async")),2&K&&m.Q6J("ngIf",m.lcZ(1,1,vt.texts$))},directives:[ct.O5,I.L,pt.o,ot.v,ut.D,ht.x,xt.t,mt.D,gt.$],pipes:[ct.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),Q})()},95558:(Kt,Mt,d)=>{d.d(Mt,{p:()=>Pt});var T=d(64762),s=d(40632),H=d(62842),P=d(36692),m=d(88002),ct=d(87519),I=d(74788),pt=d(40939),ot=d(62939),ut=d(33250),ht=d(76189),xt=d(67446),mt=d(29070),gt=d(54255),wt=d(15491),Ot=d(219),Et=d(12057),X=d(5451),Q=d(17163);function it(Dt,bt){if(1&Dt&&I._UZ(0,"div",7),2&Dt){const Nt=I.oxw(2).tuiLet;I.Udp("background",Nt)}}function K(Dt,bt){if(1&Dt){const Nt=I.EpF();I.TgZ(0,"tui-palette",8),I.NdJ("selectedColor",function(ee){return I.CHM(Nt),I.oxw(3).setCellColor(ee)}),I.qZA()}if(2&Dt){const Nt=bt.$implicit,zt=I.oxw(3);I.Q6J("tuiActiveZoneParent",Nt)("colors",zt.colors)}}function vt(Dt,bt){if(1&Dt&&(I.TgZ(0,"tui-hosted-dropdown",2,3),I._UZ(2,"button",4),I.ALo(3,"async"),I.YNc(4,it,1,2,"div",5),I.YNc(5,K,1,2,"ng-template",null,6,I.W1O),I.qZA()),2&Dt){const Nt=bt.tuiLet,zt=I.MAs(1),ee=I.MAs(6),ft=I.oxw().tuiLet,A=I.oxw();I.Q6J("content",ee)("tuiDropdownMaxHeight",999)("canOpen",!!Nt),I.xp6(2),I.Q6J("tuiHint",I.lcZ(3,9,A.cellColorText$))("tuiHintDescribe","")("pseudoActive",zt.open)("focusable",zt.open)("disabled",!Nt),I.xp6(2),I.Q6J("ngIf",!A.isBlankColor(ft||""))}}function yt(Dt,bt){if(1&Dt&&(I.ynx(0),I.YNc(1,vt,7,11,"tui-hosted-dropdown",1),I.ALo(2,"async"),I.BQk()),2&Dt){const Nt=I.oxw();I.xp6(1),I.Q6J("tuiLet",I.lcZ(2,1,Nt.isActive$))}}class Pt{constructor(bt,Nt,zt){this.defaultOptions=bt,this.editor=Nt,this.texts$=zt,this.colors=this.defaultOptions.colors,this.cellColorText$=this.texts$.pipe((0,m.U)(ee=>ee.cellColor)),this.isActive$=this.editor.isActive$("table"),this.cellColor$=this.editor.stateChange$.pipe((0,m.U)(()=>this.editor.getCellColor()||this.defaultOptions.blankColor),(0,ct.x)())}isBlankColor(bt){return bt===this.defaultOptions.blankColor}setCellColor(bt){this.editor.setCellColor(bt)}}Pt.\u0275fac=function(bt){return new(bt||Pt)(I.Y36(H.mJ),I.Y36(s.$3),I.Y36(H.rf))},Pt.\u0275cmp=I.Xpm({type:Pt,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["cellColorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","disabled"],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(bt,Nt){1&bt&&(I.YNc(0,yt,3,3,"ng-container",0),I.ALo(1,"async")),2&bt&&I.Q6J("tuiLet",I.lcZ(1,1,Nt.cellColor$))},directives:[pt.L,ot.o,ut.Ek,ht.v,xt.D,mt.x,gt.t,wt.D,Ot.$,Et.O5,X.R,Q.e],pipes:[Et.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],Pt.prototype,"colors",void 0)},28962:(Kt,Mt,d)=>{d.d(Mt,{l:()=>Ot});var T=d(40632),s=d(62842),H=d(88002),P=d(74788),m=d(62939),ct=d(33250),I=d(76189),pt=d(67446),ot=d(29070),ut=d(54255),ht=d(15491),xt=d(219),mt=d(74549),gt=d(12057);function wt(Et,X){if(1&Et){const Q=P.EpF();P.TgZ(0,"tui-table-size-selector",4),P.NdJ("onSelectSize",function(K){return P.CHM(Q),P.oxw().addTable(K)}),P.qZA()}}let Ot=(()=>{class Et{constructor(Q,it){this.editor=Q,this.texts$=it,this.insertTableText$=this.texts$.pipe((0,H.U)(K=>K.insertTable))}addTable({rows:Q,cols:it}){this.editor.enter();const K=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(K),this.editor.insertTable(Q,it)}}return Et.\u0275fac=function(Q){return new(Q||Et)(P.Y36(T.$3),P.Y36(s.rf))},Et.\u0275cmp=P.Xpm({type:Et,selectors:[["tui-table-create"]],decls:6,vars:6,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable"],["tableDropdown",""],[3,"onSelectSize"]],template:function(Q,it){if(1&Q&&(P.TgZ(0,"tui-hosted-dropdown",0,1),P._UZ(2,"button",2),P.ALo(3,"async"),P.qZA(),P.YNc(4,wt,1,0,"ng-template",null,3,P.W1O)),2&Q){const K=P.MAs(1),vt=P.MAs(5);P.Q6J("content",vt),P.xp6(2),P.Q6J("tuiHint",P.lcZ(3,4,it.insertTableText$))("tuiHintDescribe","")("focusable",K.open)}},directives:[m.o,ct.Ek,I.v,pt.D,ot.x,ut.t,ht.D,xt.$,mt.M],pipes:[gt.Ov],encapsulation:2,changeDetection:0}),Et})()},76965:(Kt,Mt,d)=>{d.d(Mt,{Y:()=>Et});var T=d(40632),s=d(62842),H=d(88002),P=d(87519),m=d(74788),ct=d(40939),I=d(12057),pt=d(76189),ot=d(67446),ut=d(29070),ht=d(54255),xt=d(15491),mt=d(219);function gt(X,Q){if(1&X){const it=m.EpF();m.TgZ(0,"button",2),m.NdJ("click",function(){m.CHM(it);const vt=m.oxw().tuiLet,yt=m.oxw();return vt.mergeCells?yt.mergeCells():yt.splitCell()}),m.qZA()}if(2&X){const it=Q.ngIf,K=m.oxw().tuiLet;m.Q6J("icon",K.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",K.mergeCells?it.mergeCells:it.splitCells)("tuiHintDescribe","")("focusable",!1)("disabled",!K.mergeCells&&!K.splitCells)}}function wt(X,Q){if(1&X&&(m.ynx(0),m.YNc(1,gt,1,5,"button",1),m.ALo(2,"async"),m.BQk()),2&X){const it=m.oxw();m.xp6(1),m.Q6J("ngIf",m.lcZ(2,1,it.texts$))}}const Ot=function(X,Q){return{mergeCells:X,splitCells:Q}};let Et=(()=>{class X{constructor(it,K){this.editor=it,this.texts$=K,this.canMergeCells$=this.editor.stateChange$.pipe((0,H.U)(()=>this.editor.canMergeCells()),(0,P.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,H.U)(()=>this.editor.canSplitCells()),(0,P.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}}return X.\u0275fac=function(it){return new(it||X)(m.Y36(T.$3),m.Y36(s.rf))},X.\u0275cmp=m.Xpm({type:X,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(it,K){1&it&&(m.YNc(0,wt,3,3,"ng-container",0),m.ALo(1,"async"),m.ALo(2,"async")),2&it&&m.Q6J("tuiLet",m.WLB(5,Ot,m.lcZ(1,1,K.canMergeCells$),m.lcZ(2,3,K.canSplitCells$)))},directives:[ct.L,I.O5,pt.v,ot.D,ut.x,ht.t,xt.D,mt.$],pipes:[I.Ov],encapsulation:2,changeDetection:0}),X})()},22063:(Kt,Mt,d)=>{d.d(Mt,{i:()=>K,_:()=>vt});var T=d(40632),s=d(62842),H=d(88002),P=d(74788),m=d(40939),ct=d(62939),I=d(76189),pt=d(67446),ot=d(29070),ut=d(54255),ht=d(15491),xt=d(219),mt=d(20933),gt=d(12057),wt=d(89786),Ot=d(35065);function Et(yt,Pt){if(1&yt&&(P.TgZ(0,"tui-hosted-dropdown",2,3),P._UZ(2,"button",4),P.ALo(3,"async"),P.qZA()),2&yt){const Dt=Pt.tuiLet,bt=P.MAs(1),Nt=P.oxw(),zt=P.MAs(3);P.Q6J("content",zt)("canOpen",!!Dt),P.xp6(2),P.Q6J("tuiHint",P.lcZ(3,6,Nt.rowsColumnsManagingText$))("tuiHintDescribe","")("focusable",bt.open)("disabled",!Dt)}}function X(yt,Pt){if(1&yt){const Dt=P.EpF();P.TgZ(0,"button",7),P.NdJ("click",function(){const zt=P.CHM(Dt).index,ee=P.oxw().index;return P.oxw(2).onTableOption(2*ee+zt)}),P._uU(1),P.qZA()}if(2&yt){const Dt=Pt.$implicit;P.xp6(1),P.hij(" ",Dt," ")}}function Q(yt,Pt){if(1&yt&&(P.TgZ(0,"tui-opt-group"),P.YNc(1,X,2,1,"button",6),P.qZA()),2&yt){const Dt=Pt.$implicit;P.xp6(1),P.Q6J("ngForOf",Dt)}}function it(yt,Pt){if(1&yt&&(P.TgZ(0,"tui-data-list"),P.YNc(1,Q,2,1,"tui-opt-group",5),P.ALo(2,"async"),P.qZA()),2&yt){const Dt=P.oxw();P.xp6(1),P.Q6J("ngForOf",P.lcZ(2,1,Dt.tableCommandTexts$))}}var K=(()=>{return(yt=K||(K={}))[yt.InsertColumnBefore=0]="InsertColumnBefore",yt[yt.InsertColumnAfter=1]="InsertColumnAfter",yt[yt.InsertRowBefore=2]="InsertRowBefore",yt[yt.InsertRowAfter=3]="InsertRowAfter",yt[yt.DeleteColumn=4]="DeleteColumn",yt[yt.DeleteRow=5]="DeleteRow",K;var yt})();let vt=(()=>{class yt{constructor(Dt,bt,Nt){this.editor=Dt,this.texts$=bt,this.tableCommandTexts$=Nt,this.commandsRegistry={[K.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[K.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[K.InsertRowAfter]:()=>this.editor.addRowAfter(),[K.InsertRowBefore]:()=>this.editor.addRowBefore(),[K.DeleteColumn]:()=>this.editor.deleteColumn(),[K.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,H.U)(zt=>zt.rowsColumnsManaging))}onTableOption(Dt){this.commandsRegistry[Dt]()}}return yt.\u0275fac=function(Dt){return new(Dt||yt)(P.Y36(T.$3),P.Y36(s.rf),P.Y36(s.$i))},yt.\u0275cmp=P.Xpm({type:yt,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled"],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(Dt,bt){1&Dt&&(P.YNc(0,Et,4,8,"tui-hosted-dropdown",0),P.ALo(1,"async"),P.YNc(2,it,3,3,"ng-template",null,1,P.W1O)),2&Dt&&P.Q6J("tuiLet",P.lcZ(1,1,bt.isActive$))},directives:[m.L,ct.o,I.v,pt.D,ot.x,ut.t,ht.D,xt.$,mt.q,gt.sg,wt.R,Ot.v],pipes:[gt.Ov],encapsulation:2,changeDetection:0}),yt})()},74549:(Kt,Mt,d)=>{d.d(Mt,{M:()=>ut});var T=d(74788),s=d(62579),H=d(72002),P=d(36097);function m(ht,xt){if(1&ht){const mt=T.EpF();T.TgZ(0,"div",4),T.NdJ("mouseenter",function(wt){const Et=T.CHM(mt).$implicit,X=T.oxw().$implicit;return T.oxw().updateCurrentSize(Et+1,X+1,wt)})("click",function(){return T.CHM(mt),T.oxw(2).onClick()}),T.qZA()}if(2&ht){const mt=xt.$implicit,gt=T.oxw().$implicit,wt=T.oxw();T.ekj("t-cell_hovered",wt.tableSelectHovered(mt,gt))}}function ct(ht,xt){if(1&ht&&(T.TgZ(0,"div",2),T.YNc(1,m,1,2,"div",3),T.qZA()),2&ht){const mt=T.oxw();T.xp6(1),T.Q6J("tuiRepeatTimesOf",mt.rowsNumber)}}let ut=(()=>{class ht{constructor(mt){this.windowRef=mt,this.onSelectSize=new T.vpe,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(mt,gt){return mt<this.tableSize.rows&&gt<this.tableSize.cols}updateCurrentSize(mt,gt,wt){(0,H.tuiGetViewportWidth)(this.windowRef)-wt.clientX>70&&(this.tableSize={rows:mt,cols:gt})}onClick(){this.onSelectSize.emit(this.tableSize)}}return ht.\u0275fac=function(mt){return new(mt||ht)(T.Y36(s.m9))},ht.\u0275cmp=T.Xpm({type:ht,selectors:[["tui-table-size-selector"]],outputs:{onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(mt,gt){1&mt&&(T.YNc(0,ct,2,1,"div",0),T.TgZ(1,"div",1),T._uU(2),T.qZA()),2&mt&&(T.Q6J("tuiRepeatTimesOf",gt.columnsNumber),T.xp6(2),T.AsE("",gt.tableSize.cols,"\xd7",gt.tableSize.rows,""))},directives:[P.X],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),ht})()},10528:(Kt,Mt,d)=>{d.d(Mt,{G:()=>vt});var T=d(64762),s=d(40632),H=d(62842),P=d(36692),m=d(88002),ct=d(87519),I=d(74788),pt=d(40939),ot=d(62939),ut=d(33250),ht=d(76189),xt=d(67446),mt=d(29070),gt=d(54255),wt=d(15491),Ot=d(219),Et=d(5451),X=d(17163),Q=d(12057);function it(yt,Pt){if(1&yt){const Dt=I.EpF();I.TgZ(0,"tui-palette",6),I.NdJ("selectedColor",function(Nt){return I.CHM(Dt),I.oxw(2).editor.setFontColor(Nt)}),I.qZA()}if(2&yt){const Dt=Pt.$implicit,bt=I.oxw(2);I.Q6J("tuiActiveZoneParent",Dt)("colors",bt.colors)}}function K(yt,Pt){if(1&yt&&(I.TgZ(0,"tui-hosted-dropdown",1,2),I._UZ(2,"button",3),I.ALo(3,"async"),I._UZ(4,"div",4),I.YNc(5,it,1,2,"ng-template",null,5,I.W1O),I.qZA()),2&yt){const Dt=Pt.tuiLet,bt=I.MAs(1),Nt=I.MAs(6),zt=I.oxw();I.Q6J("content",Nt)("tuiDropdownMaxHeight",999),I.xp6(2),I.Q6J("tuiHint",I.lcZ(3,8,zt.foreColorText$))("tuiHintDescribe","")("pseudoActive",bt.open)("focusable",bt.open),I.xp6(2),I.Udp("background",Dt)}}class vt{constructor(Pt,Dt,bt){this.defaultOptions=Pt,this.editor=Dt,this.texts$=bt,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,m.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,ct.x)()),this.foreColorText$=this.texts$.pipe((0,m.U)(Nt=>Nt.foreColor))}}vt.\u0275fac=function(Pt){return new(Pt||vt)(I.Y36(H.mJ),I.Y36(s.$3),I.Y36(H.rf))},vt.\u0275cmp=I.Xpm({type:vt,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(Pt,Dt){1&Pt&&(I.YNc(0,K,7,10,"tui-hosted-dropdown",0),I.ALo(1,"async")),2&Pt&&I.Q6J("tuiLet",I.lcZ(1,1,Dt.fontColor$))},directives:[pt.L,ot.o,ut.Ek,ht.v,xt.D,mt.x,gt.t,wt.D,Ot.$,Et.R,X.e],pipes:[Q.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],vt.prototype,"colors",void 0)},17406:(Kt,Mt,d)=>{d.d(Mt,{M6:()=>T.M,yB:()=>pt,Bp:()=>ot.B});var T=d(4997),s=d(12057),H=d(71115),P=d(93252),m=d(36692),ct=d(72002),I=d(74788);let pt=(()=>{class ut{}return ut.\u0275fac=function(xt){return new(xt||ut)},ut.\u0275mod=I.oAB({type:ut}),ut.\u0275inj=I.cJS({imports:[[s.ez,ct.TuiHintModule,m.TuiFocusableModule,ct.TuiButtonModule,ct.TuiHostedDropdownModule,H.F,P.er,P.mp,P.__,P.iA,P.p7,P.Zv,P.pu,P.Ur,P._t,P.XC,P.P_,P.y9,m.TuiItemModule,P.jP]]}),ut})();var ot=d(13044)},13044:(Kt,Mt,d)=>{d.d(Mt,{B:()=>H});var T=d(74788),s=d(36692);let H=(()=>{class P{constructor(ct){this.elementRef=ct}get toolsContainers(){return Array.from(this.elementRef.nativeElement.querySelectorAll("[tuiItem]"))}onHorizontalNavigation(ct){const{toolsContainers:I}=this,pt=I.findIndex(s.tuiIsNativeFocusedIn),ut=I[(0,s.tuiClamp)(pt+(ct?-1:1),0,I.length-1)],ht=ct?this.findPreviousTool(ut):this.findNextTool(ut);ht&&ht.focus()}findFirstFocusableTool(ct=!1){const I=ct?this.toolsContainers.slice().reverse():this.toolsContainers;for(const pt of I){const ot=(0,s.tuiIsNativeMouseFocusable)(pt)?pt:(0,s.tuiGetClosestFocusable)({initial:pt,root:pt,keyboard:!1});if(ot)return ot}return null}findPreviousTool(ct){return(0,s.tuiIsNativeMouseFocusable)(ct)?ct:(0,s.tuiGetClosestFocusable)({initial:ct,root:ct,keyboard:!1})||(0,s.tuiGetClosestFocusable)({initial:ct,root:this.elementRef.nativeElement,previous:!0,keyboard:!1})}findNextTool(ct){return(0,s.tuiIsNativeMouseFocusable)(ct)?ct:(0,s.tuiGetClosestFocusable)({initial:ct,root:this.elementRef.nativeElement,keyboard:!1})}}return P.\u0275fac=function(ct){return new(ct||P)(T.Y36(T.SBq))},P.\u0275dir=T.lG2({type:P,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(ct,I){1&ct&&T.NdJ("keydown.arrowRight.prevent",function(){return I.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return I.onHorizontalNavigation(!0)})}}),P})()},4997:(Kt,Mt,d)=>{d.d(Mt,{M:()=>D});var T=d(64762),s=d(74788),H=d(19074),P=d(40632),m=d(48699),ct=d(62842),I=d(36692),pt=d(15257),ot=d(13044),ut=d(12057),ht=d(48893),xt=d(76189),mt=d(82707),gt=d(67446),wt=d(29070),Ot=d(54255),Et=d(15491),X=d(219),Q=d(84985),it=d(62976),K=d(37924),vt=d(13441),yt=d(62939),Pt=d(45050),Dt=d(10528),bt=d(7416),Nt=d(15587),zt=d(50237),ee=d(18832),ft=d(19762),A=d(28962),et=d(22063),at=d(76965),Tt=d(95558);const W=["dropdown"];function J(R,$){1&R&&s.GkF(0)}function dt(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",7),s.NdJ("click",function(){return s.CHM(U),s.oxw(2).undo()}),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(U),s.oxw(2).redo()}),s.qZA(),s.qZA()}if(2&R){const U=s.oxw().ngIf,st=s.oxw();s.xp6(1),s.Q6J("tuiHint",U.undo)("tuiHintDescribe","")("disabled",st.undoDisabled)("focusable",!1),s.xp6(1),s.Q6J("tuiHint",U.redo)("tuiHintDescribe","")("disabled",st.redoDisabled)("focusable",!1)}}function Lt(R,$){1&R&&(s.TgZ(0,"div",6),s._UZ(1,"tui-font-size",9),s.qZA())}function Jt(R,$){if(1&R&&s._UZ(0,"tui-font-style",15),2&R){const U=s.oxw(3);s.Q6J("enabledTools",U.toolsSet)}}function qt(R,$){1&R&&s._UZ(0,"tui-align-content",9)}function ce(R,$){1&R&&s._UZ(0,"tui-list-configs",9)}function le(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"button",16,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).toggleQuote()}),s.qZA()}if(2&R){const U=s.oxw(2).ngIf,st=s.oxw();s.Q6J("tuiHint",U.quote)("tuiHintDescribe","")("pseudoActive",st.blockquote)("disabled",st.unorderedList||st.orderedList)("focusable",!1)}}function Fe(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"tui-edit-link",22,23),s.NdJ("addLink",function(Rt){s.CHM(U),s.oxw();const Wt=s.MAs(1);return s.oxw(3).onLink(Wt,Rt)})("removeLink",function(){s.CHM(U),s.oxw();const Rt=s.MAs(1);return s.oxw(3).onLink(Rt)}),s.qZA()}}function Ke(R,$){if(1&R&&(s.TgZ(0,"tui-hosted-dropdown",18,19),s._UZ(2,"button",20,17),s.YNc(4,Fe,2,0,"ng-template",null,21,s.W1O),s.qZA()),2&R){const U=s.MAs(1),st=s.MAs(5),Rt=s.oxw(2).ngIf,Wt=s.oxw();s.Q6J("canOpen",!Wt.a)("content",st),s.xp6(2),s.Q6J("tuiHint",Rt.link)("tuiHintDescribe","")("pseudoActive",U.open||Wt.a)("focusable",U.open)}}function Qe(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"button",24,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).onAttach()}),s.qZA()}if(2&R){const U=s.oxw(2).ngIf;s.Q6J("tuiHint",U.attach)("tuiHintDescribe","")("focusable",!1)}}function we(R,$){if(1&R&&(s.TgZ(0,"div",6),s.YNc(1,Jt,1,1,"tui-font-style",10),s.YNc(2,qt,1,0,"tui-align-content",11),s.YNc(3,ce,1,0,"tui-list-configs",11),s.YNc(4,le,2,5,"button",12),s.YNc(5,Ke,6,6,"tui-hosted-dropdown",13),s.YNc(6,Qe,2,3,"button",14),s.qZA()),2&R){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.formatEnabled),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Align)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.List)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Quote)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Link)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Attach))}}function he(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"button",27,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).toggleSubscript()}),s.qZA()}if(2&R){const U=s.oxw(2).ngIf,st=s.oxw();s.Q6J("tuiHint",U.subscript)("tuiHintDescribe","")("pseudoActive",st.subscript)("focusable",!1)}}function De(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"button",28,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).toggleSuperscript()}),s.qZA()}if(2&R){const U=s.oxw(2).ngIf,st=s.oxw();s.Q6J("tuiHint",U.superscript)("tuiHintDescribe","")("pseudoActive",st.superscript)("focusable",!1)}}function Ie(R,$){if(1&R&&(s.TgZ(0,"div",6),s.YNc(1,he,2,4,"button",25),s.YNc(2,De,2,4,"button",26),s.qZA()),2&R){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Sub)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Sup))}}function Te(R,$){if(1&R&&s._UZ(0,"tui-text-color",30),2&R){const U=s.oxw(3);s.Q6J("colors",U.colors)}}function Ue(R,$){if(1&R&&s._UZ(0,"tui-highlight-color",30),2&R){const U=s.oxw(3);s.Q6J("colors",U.colors)}}function de(R,$){if(1&R&&(s.TgZ(0,"div",6),s.YNc(1,Te,1,1,"tui-text-color",29),s.YNc(2,Ue,1,1,"tui-highlight-color",29),s.qZA()),2&R){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Color)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Hilite))}}function se(R,$){1&R&&s._UZ(0,"tui-code",9)}function ze(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"button",34,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).onTeX()}),s.qZA()}if(2&R){const U=s.oxw(2).ngIf;s.Q6J("tuiHint",U.tex)("tuiHintDescribe","")("focusable",!1)}}function Ee(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"div",35),s.TgZ(1,"button",36,17),s.NdJ("click",function(){return s.CHM(U),s.MAs(4).click()}),s.qZA(),s.TgZ(3,"input",37,38),s.NdJ("change",function(){s.CHM(U);const Rt=s.MAs(4);return s.oxw(3).onImage(Rt)}),s.qZA(),s.qZA()}if(2&R){const U=s.oxw(2).ngIf;s.xp6(1),s.Q6J("tuiHint",U.image)("tuiHintDescribe","")("focusable",!1),s.xp6(2),s.Q6J("tuiFocusable",!1)}}function Re(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"button",39,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).insertHorizontalRule()}),s.qZA()}if(2&R){const U=s.oxw(2).ngIf;s.Q6J("tuiHint",U.insertHorizontalRule)("tuiHintDescribe","")("focusable",!1)}}function Je(R,$){if(1&R&&(s.TgZ(0,"div",6),s.YNc(1,se,1,0,"tui-code",11),s.YNc(2,ze,2,3,"button",31),s.YNc(3,Ee,5,4,"div",32),s.YNc(4,Re,2,3,"button",33),s.qZA()),2&R){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Code)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Tex)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Img)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.HR))}}function $e(R,$){if(1&R){const U=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",40,17),s.NdJ("click",function(){return s.CHM(U),s.oxw(2).removeFormat()}),s.qZA(),s.qZA()}if(2&R){const U=s.oxw().ngIf;s.xp6(1),s.Q6J("tuiHint",U.clear)("tuiHintDescribe","")("focusable",!1)}}function _e(R,$){1&R&&(s.TgZ(0,"div",6),s._UZ(1,"tui-details",41),s._UZ(2,"tui-details-remove",41),s.qZA())}function Ce(R,$){1&R&&(s.TgZ(0,"div",6),s._UZ(1,"tui-editor-group-tool",41),s.qZA())}function Pe(R,$){if(1&R&&(s.TgZ(0,"div",6),s._UZ(1,"tui-table-create",41),s._UZ(2,"tui-table-row-column-manager",41),s._UZ(3,"tui-table-merge-cells",41),s._UZ(4,"tui-table-cell-color",30),s.qZA()),2&R){const U=s.oxw(2);s.xp6(4),s.Q6J("colors",U.colors)}}function G(R,$){if(1&R&&(s.TgZ(0,"section",4),s.YNc(1,dt,3,8,"div",5),s.YNc(2,Lt,2,0,"div",5),s.YNc(3,we,7,6,"div",5),s.YNc(4,Ie,3,2,"div",5),s.YNc(5,de,3,2,"div",5),s.YNc(6,Je,5,4,"div",5),s.YNc(7,$e,3,3,"div",5),s.YNc(8,_e,3,0,"div",5),s.YNc(9,Ce,2,0,"div",5),s.YNc(10,Pe,5,1,"div",5),s.TgZ(11,"div",6),s.Hsn(12),s.qZA(),s.qZA()),2&R){const U=s.oxw();s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Undo)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Size)),s.xp6(1),s.Q6J("ngIf",U.firstBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Sub)||U.enabled(U.TuiEditorTool.Sup)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Color)||U.enabled(U.TuiEditorTool.Hilite)),s.xp6(1),s.Q6J("ngIf",U.secondBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Clear)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Details)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Group)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Table))}}class D{constructor($,U,st,Rt,Wt){this.elementRef=$,this.editor=U,this.imageLoader=st,this.texts$=Rt,this.defaultOptions=Wt,this.dropdowns=I.EMPTY_QUERY,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new s.vpe,this.texClicked=new s.vpe,this.attachClicked=new s.vpe,this.TuiEditorTool=m._,this.toolsSet=new Set(H.Db)}set tools($){this.toolsSet=new Set($)}get focused(){return(0,I.tuiIsNativeFocusedIn)(this.elementRef.nativeElement)||!!this.dropdowns.find(({nativeElement:$})=>(0,I.tuiIsNativeFocusedIn)($))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(m._.Bold)||this.enabled(m._.Italic)||this.enabled(m._.Underline)||this.enabled(m._.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(m._.Align)||this.enabled(m._.List)||this.enabled(m._.Quote)||this.enabled(m._.Link)||this.enabled(m._.Attach)}get secondBigBlockEnabled(){return this.enabled(m._.Code)||this.enabled(m._.Tex)||this.enabled(m._.Img)||this.enabled(m._.HR)}onMouseDown($,U){U.closest("button")||($.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage($){var U;const st=null===(U=$.files)||void 0===U?void 0:U[0];$.value="",st&&this.imageLoader(st).pipe((0,pt.q)(1)).subscribe(Rt=>{this.addImage(Rt)})}onAttach(){this.attachClicked.emit()}onTeX(){this.texClicked.emit()}onLink($,U){$.open=!1,U&&(this.editor.toggleLink(U),this.editor.selectClosest())}enabled($){return this.toolsSet.has($)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage($){this.editor.setImage($)}focusFirst(){var $;const U=null===($=this.navigationManager)||void 0===$?void 0:$.findFirstFocusableTool();U&&U.focus()}focusLast(){var $;const U=null===($=this.navigationManager)||void 0===$?void 0:$.findFirstFocusableTool(!0);U&&U.focus()}}D.\u0275fac=function($){return new($||D)(s.Y36(s.SBq,8),s.Y36(P.$3),s.Y36(ct.p7),s.Y36(ct.rf),s.Y36(ct.mJ))},D.\u0275cmp=s.Xpm({type:D,selectors:[["tui-toolbar"]],viewQuery:function($,U){if(1&$&&(s.Gf(ot.B,5),s.Gf(W,5,s.SBq)),2&$){let st;s.iGM(st=s.CRH())&&(U.navigationManager=st.first),s.iGM(st=s.CRH())&&(U.dropdowns=st)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function($,U){1&$&&s.NdJ("mousedown",function(Rt){return U.onMouseDown(Rt,Rt.target)}),2&$&&s.ekj("_disabled",U.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",attachClicked:"attachClicked"},ngContentSelectors:["*"],decls:7,vars:8,consts:[[1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiItem","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiItem","",1,"t-tool","t-wrapper"],["tuiItem","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiItem","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click"],["button",""],["tuiItem","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiItem","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImgLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-tool","t-tool_margin"]],template:function($,U){1&$&&(s.F$t(),s._UZ(0,"button",0),s.YNc(1,J,1,0,"ng-container",1),s.ALo(2,"async"),s.TgZ(3,"div",2),s.NdJ("focus",function(){return U.onTopFocus()}),s.qZA(),s.TgZ(4,"div",2),s.NdJ("focus",function(){return U.onBottomFocus()}),s.qZA(),s.YNc(5,G,13,10,"section",3),s.ALo(6,"async")),2&$&&(s.xp6(1),s.Q6J("ngIf",s.lcZ(2,4,U.editor.stateChange$)),s.xp6(2),s.Q6J("tuiFocusable",U.focusable),s.xp6(1),s.Q6J("tuiFocusable",U.focusable),s.xp6(1),s.Q6J("ngIf",s.lcZ(6,6,U.texts$)))},directives:[ut.O5,ht.t,ot.B,xt.v,mt.w,gt.D,wt.x,Ot.t,Et.D,X.$,Q.m,it.h,K.X,vt.w,yt.o,Pt.l,Dt.G,bt.U,Nt.T,zt.y,ee.U,ft.d,A.l,et._,at.Y,Tt.p],pipes:[ut.Ov],styles:['.t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:"";display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}button.t-tool[_ngcontent-%COMP%]:hover, .t-tool[_ngcontent-%COMP%]     button:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:none;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-color-edit{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),(0,T.gn)([(0,I.tuiDefaultProp)()],D.prototype,"colors",void 0),(0,T.gn)([(0,I.tuiDefaultProp)()],D.prototype,"disabled",void 0),(0,T.gn)([(0,I.tuiDefaultProp)(function(R){return!R.includes(m._.Tex)&&!R.includes(m._.Attach)},"Attach and TeX are not yet implemented in Editor")],D.prototype,"tools",null)},19074:(Kt,Mt,d)=>{d.d(Mt,{hK:()=>s,sw:()=>T,Db:()=>P,RR:()=>m});const T=new Map([["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),s="rgb(51, 51, 51)";var H=d(48699);const P=[H._.Undo,H._.Size,H._.Bold,H._.Italic,H._.Underline,H._.Align,H._.List,H._.Quote,H._.Link,H._.Color,H._.Hilite,H._.Clear,H._.Strikethrough,H._.Code,H._.Img,H._.HR,H._.Sup,H._.Sub,H._.Table,H._.Details];function m(ct){return[{px:13,name:ct.small},{px:15,name:ct.normal},{px:17,name:ct.large},{px:24,family:"var(--tui-font-heading)",name:ct.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:ct.title,headingLevel:1,weight:"bold"}]}},60153:(Kt,Mt,d)=>{d.d(Mt,{Z:()=>s});var T=d(74788);let s=(()=>{class H{constructor(){this.imagePreview=new T.vpe}click(m){m instanceof HTMLImageElement&&this.imagePreview.emit(m)}}return H.\u0275fac=function(m){return new(m||H)},H.\u0275dir=T.lG2({type:H,selectors:[["tui-editor-socket","imagePreview",""]],hostAttrs:[1,"_preview-image"],hostBindings:function(m,ct){1&m&&T.NdJ("click",function(pt){return ct.click(pt.target)})},outputs:{imagePreview:"imagePreview"}}),H})()},40632:(Kt,Mt,d)=>{d.d(Mt,{Zj:()=>T.Z,BN:()=>H,JU:()=>P.J,mJ:()=>m,$3:()=>ct.$});var T=d(60153),s=d(74788);let H=(()=>{class I{}return I.\u0275fac=function(ot){return new(ot||I)},I.\u0275mod=s.oAB({type:I}),I.\u0275inj=s.cJS({}),I})();var P=d(74982);let m=(()=>{class I{}return I.\u0275fac=function(ot){return new(ot||I)},I.\u0275mod=s.oAB({type:I}),I.\u0275inj=s.cJS({}),I})();var ct=d(17804)},74982:(Kt,Mt,d)=>{d.d(Mt,{J:()=>ct});var T=d(74788),s=d(62842),H=d(36692),P=d(46782),m=d(17804);let ct=(()=>{class I{constructor(ot,ut,ht,xt,mt,gt){this.elementRef=ot,this.renderer=ut,this.editor=ht,this.editorContainer=xt,this.editorLoaded$=mt,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,this.editorLoaded$.pipe((0,P.R)(gt)).subscribe(()=>{this.renderer.appendChild(this.elementRef.nativeElement,this.editorContainer)})}set value(ot){ot!==this.editor.html&&this.editor.setValue(ot)}set editable(ot){this.editor.editable=ot}}return I.\u0275fac=function(ot){return new(ot||I)(T.Y36(T.SBq),T.Y36(T.Qsj),T.Y36(m.$),T.Y36(s.Y1),T.Y36(s.ZW),T.Y36(H.TuiDestroyService))},I.\u0275dir=T.lG2({type:I,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[T._Bn([H.TuiDestroyService])]}),I})()},17804:(Kt,Mt,d)=>{d.d(Mt,{$:()=>ut});var T=d(79765),s=d(74788);let H=(()=>{class ht{constructor(){this.stateChange$=new T.xQ,this.valueChange$=new T.xQ}}return ht.\u0275fac=function(mt){return new(mt||ht)},ht.\u0275dir=s.lG2({type:ht}),ht})();var P=d(62842),m=d(37631),ct=d(39761),I=d(88002),pt=d(87519);let ut=(()=>{class ht extends H{constructor(mt){super(),this.editorRef=mt,this.editorRef.subscribe(gt=>{this.editor=gt,gt.on("transaction",()=>{this.stateChange$.next()}),gt.on("update",()=>{const wt=gt.getHTML(),Et=function(ht){return Array.isArray(ht)&&1===ht.length&&!ht[0].hasOwnProperty("content")}(gt.getJSON().content)?"":wt;this.valueChange$.next(Et)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(mt){this.editor.setEditable(mt)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||"rgb(51, 51, 51)"}getBackgroundColor(){var mt;return(null===(mt=this.editor)||void 0===mt?void 0:mt.getAttributes("textStyle").backgroundColor)||"rgb(51, 51, 51)"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}onAlign(mt){this.editor.chain().focus().setTextAlign(mt).run()}setImage(mt){this.editor.chain().focus().first(({commands:gt})=>[()=>{var wt;return(null===(wt=gt.setEditableImage)||void 0===wt?void 0:wt.call(gt,{src:mt}))||!1},()=>gt.setImage({src:mt})]).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(mt){this.editor.chain().focus().setFontColor(mt).run()}setBackgroundColor(mt){this.editor.chain().focus().setBackgroundColor(mt).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(mt){return this.editor.isActive(mt)}isActive$(mt){return this.stateChange$.pipe((0,ct.O)(null),(0,I.U)(()=>this.isActive(mt)),(0,pt.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(mt,gt){this.editor.chain().focus().insertTable({cols:mt,rows:gt}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(mt){this.editor.chain().focus().setHeading({level:mt}).run()}setParagraph(mt){this.editor.chain().focus().setParagraph().run(),mt&&this.editor.chain().setMark("textStyle",mt).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(mt){this.editor.commands.setTextSelection(mt)}toggleLink(mt){this.editor.chain().focus().toggleLink({href:mt}).run()}setLink(mt){this.editor.chain().focus().setLink({href:mt}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}focus(){this.editor.chain().focus().run()}setValue(mt){this.editor.commands.setContent(mt)}destroy(){this.editor.destroy()}setCellColor(mt){this.editor.chain().focus().setCellBackground(mt).run()}selectClosest(){const mt=this.editor.state.selection.anchor,{schema:gt,doc:wt}=this.editor.state,Ot=(0,m.Yz)(wt.resolve(mt),gt.marks.link);Ot&&this.editor.chain().setTextSelection(Ot).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}setGroup(){this.editor.commands.setGroup()}removeGroup(){this.editor.commands.removeGroup()}}return ht.\u0275fac=function(mt){return new(mt||ht)(s.LFG(P.ZW))},ht.\u0275prov=s.Yz7({token:ht,factory:ht.\u0275fac}),ht})()},48699:(Kt,Mt,d)=>{d.d(Mt,{_:()=>T});var T=(()=>{return(s=T||(T={})).Undo="undo",s.Size="fontSize",s.Bold="bold",s.Italic="italic",s.Underline="underline",s.Strikethrough="strikeThrough",s.Align="justify",s.List="list",s.Quote="quote",s.Color="foreColor",s.Hilite="hiliteColor",s.Clear="clear",s.Link="link",s.Attach="attach",s.Tex="tex",s.Code="code",s.Img="image",s.HR="insertHorizontalRule",s.Sup="superscript",s.Sub="subscript",s.Table="insertTable",s.MergeCells="mergeCells",s.SplitCells="splitCells",s.RowsColumnsManaging="rowsColumnsManaging",s.Details="details",s.Group="group",T;var s})()},15736:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{BackgroundColor:()=>H}),d(74634);const H=d(40256).Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:P})=>P?{style:`background-color: ${P}`}:{},parseHTML:({style:P})=>P.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:P=>({chain:m})=>m().setMark("textStyle",{backgroundColor:P}).run(),unsetBackgroundColor:()=>({chain:P})=>P().setMark("textStyle",{backgroundColor:null}).run()})})},52658:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{FontColor:()=>H}),d(74634);const H=d(40256).Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:P})=>P?{style:`color: ${P}`}:{},parseHTML:({style:P})=>P.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:P=>({chain:m})=>m().setMark("textStyle",{fontColor:P}).run(),unsetFontColor:()=>({chain:P})=>P().setMark("textStyle",{fontColor:null}).run()})})},9492:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{TuiFontSize:()=>H}),d(74634);const H=d(40256).Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:P})=>P.fontSize,renderHTML:({fontSize:P})=>P?{style:`font-size: ${P}`}:{}}}}]},addCommands:()=>({setFontSize:P=>({chain:m})=>m().setMark("textStyle",{fontSize:P}).run(),unsetFontSize:()=>({chain:P})=>P().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})})},54920:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>H,createGroupExtension:()=>P});var T=d(37631),s=d(40256);const H={groupNodeClass:"tui-group-node",groupPointerNodeClass:"tui-group-pointer",nested:!0,draggable:!0,createOnEnter:!1},P=(m={})=>{const{draggable:ct,nested:I,groupNodeClass:pt,groupPointerNodeClass:ot,createOnEnter:ut}=Object.assign(Object.assign({},H),m);return s.Node.create({name:"group",draggable:ct,group:"block",content:I?"block+":"block",parseHTML:()=>[{tag:'div[data-type="group"]'}],renderHTML:({HTMLAttributes:ht})=>["div",(0,s.mergeAttributes)(ht,{"data-type":"group"}),0],addNodeView:()=>()=>{const ht=document.createElement("div"),xt=document.createElement("div");if(ht.classList.add(pt),xt.setAttribute("data-type","group"),ct){const mt=document.createElement("div");mt.classList.add(ot),mt.innerHTML="",mt.contentEditable="false",ht.append(mt,xt)}else ht.append(xt);return{dom:ht,contentDOM:xt}},addCommands(){return{setGroup:()=>({commands:ht,state:xt})=>{this.editor.chain().focus().run();const mt=(0,T.Ap)(xt,""),wt=`<div data-type="group">${mt.trim().startsWith("<p>")?mt:`<p>${mt}</p>`}</div>`;return ht.insertContent(wt)},removeGroup:()=>({state:ht,dispatch:xt})=>(0,T.yU)(ht,xt,this.name)}},addKeyboardShortcuts(){return ut?{Enter:()=>this.editor.commands.setGroup()}:{}}})}},25039:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{TUI_EDITOR_MAX_IMAGE_WIDTH:()=>ot,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>pt,TuiImageEditorComponent:()=>ut,TuiImageEditorModule:()=>wt,createImageEditorExtension:()=>gt});var T=d(12057),s=d(74788),H=d(40400),P=d(36692),m=d(66682),ct=d(46782),I=d(60015);const pt=new s.OlP("[TUI_EDITOR_MIN_IMAGE_WIDTH]: Min size of resizable image inside editor",{factory:()=>100}),ot=new s.OlP("[TUI_EDITOR_MAX_IMAGE_WIDTH]: Max size of resizable image inside editor",{factory:()=>1/0});let ut=(()=>{class Ot extends H.d{constructor(X,Q,it,K){super(),this.minWidth=X,this.maxWidth=Q,this.documentRef=it,this.destroy$=K,this._width=0,(0,m.T)((0,P.tuiTypedFromEvent)(this.documentRef,"touchend"),(0,P.tuiTypedFromEvent)(this.documentRef,"mouseup")).pipe((0,ct.R)(K)).subscribe(()=>this.updateAttributes({width:this.width}))}get attrs(){var X;return(null===(X=this.node)||void 0===X?void 0:X.attrs)||{src:""}}get src(){return this.attrs.src}get width(){return this._width||this.attrs.width||0}get alt(){return this.attrs.alt||""}get title(){return this.attrs.title||""}onHorizontalDrag([X],Q){this._width=Math.max(this.minWidth,Math.min(this.maxWidth,this.width+Q*X))}}return Ot.\u0275fac=function(X){return new(X||Ot)(s.Y36(pt),s.Y36(ot),s.Y36(T.K0),s.Y36(P.TuiDestroyService))},Ot.\u0275cmp=s.Xpm({type:Ot,selectors:[["tui-image-editor"]],features:[s._Bn([P.TuiDestroyService]),s.qOj],decls:3,vars:8,consts:[[3,"src","width","alt","title"],[1,"t-border","t-border_right",3,"tuiPan"],[1,"t-border","t-border_left",3,"tuiPan"]],template:function(X,Q){1&X&&(s._UZ(0,"img",0),s.TgZ(1,"span",1),s.NdJ("tuiPan",function(K){return Q.onHorizontalDrag(K,1)}),s.qZA(),s.TgZ(2,"span",2),s.NdJ("tuiPan",function(K){return Q.onHorizontalDrag(K,-1)}),s.qZA()),2&X&&(s.Udp("min-width",Q.minWidth,"px")("max-width",Q.maxWidth,"px"),s.Q6J("src",Q.src,s.LSH)("width",Q.width)("alt",Q.alt)("title",Q.title))},directives:[I.g],styles:['[_nghost-%COMP%]{position:relative;display:inline-block}[_nghost-%COMP%]:hover   .t-border[_ngcontent-%COMP%]:after{opacity:1}.t-border[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;display:flex;width:.75rem;cursor:col-resize;justify-content:center;align-items:center}.t-border_left[_ngcontent-%COMP%]{left:0}.t-border_right[_ngcontent-%COMP%]{right:0}.t-border[_ngcontent-%COMP%]:after{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;content:"";width:50%;height:33%;box-sizing:border-box;border-radius:var(--tui-radius-m);background:var(--tui-base-08);border:1px solid var(--tui-base-03);opacity:0}'],changeDetection:0}),Ot})();var ht=d(40256);const xt=[{tag:'img[data-type="image-editor"]'}],mt={src:{default:"",keepOnSplit:!1},width:{default:300,keepOnSplit:!1},alt:{default:"",keepOnSplit:!1},title:{default:"",keepOnSplit:!1}},gt=Ot=>ht.Node.create({name:"imageEditor",group:"block",atom:!0,draggable:!0,parseHTML:()=>xt,addAttributes:()=>mt,renderHTML:({HTMLAttributes:Et})=>["img",(0,ht.mergeAttributes)(Et,{"data-type":"image-editor"})],addNodeView:()=>(0,H.x)(ut,{injector:Ot}),addCommands(){return{setEditableImage:Et=>({commands:X})=>X.insertContent({type:this.name,attrs:Et})}}});let wt=(()=>{class Ot{}return Ot.\u0275fac=function(X){return new(X||Ot)},Ot.\u0275mod=s.oAB({type:Ot}),Ot.\u0275inj=s.cJS({imports:[[T.ez,P.TuiPanModule]]}),Ot})()},12177:(Kt,Mt,d)=>{function s(P){return P.isActive("bulletList")||P.isActive("orderedList")}d.r(Mt),d.d(Mt,{TuiTabExtension:()=>H,tuiIsOrderedOrBulletList:()=>s});const H=d(40256).Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>s(this.editor)?null:this.editor.commands.insertContent("\t")}}})},80726:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{StarterKit:()=>Dn});var T=d(40256);const s=/^\s*>\s$/,H=T.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:k}){return["blockquote",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setBlockquote:()=>({commands:k})=>k.wrapIn(this.name),toggleBlockquote:()=>({commands:k})=>k.toggleWrap(this.name),unsetBlockquote:()=>({commands:k})=>k.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,T.wrappingInputRule)({find:s,type:this.type})]}}),P=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,m=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,ct=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,I=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,pt=T.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:k=>"normal"!==k.style.fontWeight&&null},{style:"font-weight",getAttrs:k=>/^(bold(er)?|[5-9]\d{2,})$/.test(k)&&null}],renderHTML({HTMLAttributes:k}){return["strong",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setBold:()=>({commands:k})=>k.setMark(this.name),toggleBold:()=>({commands:k})=>k.toggleMark(this.name),unsetBold:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,T.markInputRule)({find:P,type:this.type}),(0,T.markInputRule)({find:ct,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:m,type:this.type}),(0,T.markPasteRule)({find:I,type:this.type})]}}),ot=/^\s*([-+*])\s$/,ut=T.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:k}){return["ul",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{toggleBulletList:()=>({commands:k})=>k.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[(0,T.wrappingInputRule)({find:ot,type:this.type})]}}),ht=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,xt=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,mt=T.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:k}){return["code",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setCode:()=>({commands:k})=>k.setMark(this.name),toggleCode:()=>({commands:k})=>k.toggleMark(this.name),unsetCode:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,T.markInputRule)({find:ht,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:xt,type:this.type})]}});var gt=d(35917),wt=d(38480);const Ot=Object.create(null);class Et{constructor(a,_,v){this.$anchor=a,this.$head=_,this.ranges=v||[new X(a.min(_),a.max(_))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let a=this.ranges;for(let _=0;_<a.length;_++)if(a[_].$from.pos!=a[_].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(a,_=gt.p2.empty){let v=_.content.lastChild,w=null;for(let St=0;St<_.openEnd;St++)w=v,v=v.lastChild;let q=a.steps.length,lt=this.ranges;for(let St=0;St<lt.length;St++){let{$from:Ft,$to:te}=lt[St],ne=a.mapping.slice(q);a.replaceRange(ne.map(Ft.pos),ne.map(te.pos),St?gt.p2.empty:_),0==St&&zt(a,q,(v?v.isInline:w&&w.isTextblock)?-1:1)}}replaceWith(a,_){let v=a.steps.length,w=this.ranges;for(let q=0;q<w.length;q++){let{$from:lt,$to:St}=w[q],Ft=a.mapping.slice(v),te=Ft.map(lt.pos),ne=Ft.map(St.pos);q?a.deleteRange(te,ne):(a.replaceRangeWith(te,ne,_),zt(a,v,_.isInline?-1:1))}}static findFrom(a,_,v=!1){let w=a.parent.inlineContent?new K(a):Nt(a.node(0),a.parent,a.pos,a.index(),_,v);if(w)return w;for(let q=a.depth-1;q>=0;q--){let lt=_<0?Nt(a.node(0),a.node(q),a.before(q+1),a.index(q),_,v):Nt(a.node(0),a.node(q),a.after(q+1),a.index(q)+1,_,v);if(lt)return lt}return null}static near(a,_=1){return this.findFrom(a,_)||this.findFrom(a,-_)||new Dt(a.node(0))}static atStart(a){return Nt(a,a,0,0,1)||new Dt(a)}static atEnd(a){return Nt(a,a,a.content.size,a.childCount,-1)||new Dt(a)}static fromJSON(a,_){if(!_||!_.type)throw new RangeError("Invalid input for Selection.fromJSON");let v=Ot[_.type];if(!v)throw new RangeError(`No selection type ${_.type} defined`);return v.fromJSON(a,_)}static jsonID(a,_){if(a in Ot)throw new RangeError("Duplicate use of selection JSON ID "+a);return Ot[a]=_,_.prototype.jsonID=a,_}getBookmark(){return K.between(this.$anchor,this.$head).getBookmark()}}Et.prototype.visible=!0;class X{constructor(a,_){this.$from=a,this.$to=_}}let Q=!1;function it(k){!Q&&!k.parent.inlineContent&&(Q=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+k.parent.type.name+")"))}class K extends Et{constructor(a,_=a){it(a),it(_),super(a,_)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(a,_){let v=a.resolve(_.map(this.head));if(!v.parent.inlineContent)return Et.near(v);let w=a.resolve(_.map(this.anchor));return new K(w.parent.inlineContent?w:v,v)}replace(a,_=gt.p2.empty){if(super.replace(a,_),_==gt.p2.empty){let v=this.$from.marksAcross(this.$to);v&&a.ensureMarks(v)}}eq(a){return a instanceof K&&a.anchor==this.anchor&&a.head==this.head}getBookmark(){return new vt(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(a,_){if("number"!=typeof _.anchor||"number"!=typeof _.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new K(a.resolve(_.anchor),a.resolve(_.head))}static create(a,_,v=_){let w=a.resolve(_);return new this(w,v==_?w:a.resolve(v))}static between(a,_,v){let w=a.pos-_.pos;if((!v||w)&&(v=w>=0?1:-1),!_.parent.inlineContent){let q=Et.findFrom(_,v,!0)||Et.findFrom(_,-v,!0);if(!q)return Et.near(_,v);_=q.$head}return a.parent.inlineContent||(0==w||(a=(Et.findFrom(a,-v,!0)||Et.findFrom(a,v,!0)).$anchor).pos<_.pos!=w<0)&&(a=_),new K(a,_)}}Et.jsonID("text",K);class vt{constructor(a,_){this.anchor=a,this.head=_}map(a){return new vt(a.map(this.anchor),a.map(this.head))}resolve(a){return K.between(a.resolve(this.anchor),a.resolve(this.head))}}class yt extends Et{constructor(a){let _=a.nodeAfter,v=a.node(0).resolve(a.pos+_.nodeSize);super(a,v),this.node=_}map(a,_){let{deleted:v,pos:w}=_.mapResult(this.anchor),q=a.resolve(w);return v?Et.near(q):new yt(q)}content(){return new gt.p2(gt.HY.from(this.node),0,0)}eq(a){return a instanceof yt&&a.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Pt(this.anchor)}static fromJSON(a,_){if("number"!=typeof _.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new yt(a.resolve(_.anchor))}static create(a,_){return new yt(a.resolve(_))}static isSelectable(a){return!a.isText&&!1!==a.type.spec.selectable}}yt.prototype.visible=!1,Et.jsonID("node",yt);class Pt{constructor(a){this.anchor=a}map(a){let{deleted:_,pos:v}=a.mapResult(this.anchor);return _?new vt(v,v):new Pt(v)}resolve(a){let _=a.resolve(this.anchor),v=_.nodeAfter;return v&&yt.isSelectable(v)?new yt(_):Et.near(_)}}class Dt extends Et{constructor(a){super(a.resolve(0),a.resolve(a.content.size))}replace(a,_=gt.p2.empty){if(_==gt.p2.empty){a.delete(0,a.doc.content.size);let v=Et.atStart(a.doc);v.eq(a.selection)||a.setSelection(v)}else super.replace(a,_)}toJSON(){return{type:"all"}}static fromJSON(a){return new Dt(a)}map(a){return new Dt(a)}eq(a){return a instanceof Dt}getBookmark(){return bt}}Et.jsonID("all",Dt);const bt={map(){return this},resolve:k=>new Dt(k)};function Nt(k,a,_,v,w,q=!1){if(a.inlineContent)return K.create(k,_);for(let lt=v-(w>0?0:1);w>0?lt<a.childCount:lt>=0;lt+=w){let St=a.child(lt);if(St.isAtom){if(!q&&yt.isSelectable(St))return yt.create(k,_-(w<0?St.nodeSize:0))}else{let Ft=Nt(k,St,_+w,w<0?St.childCount:0,w,q);if(Ft)return Ft}_+=St.nodeSize*w}return null}function zt(k,a,_){let v=k.steps.length-1;if(v<a)return;let lt,w=k.steps[v];(w instanceof wt.Pu||w instanceof wt.FC)&&(k.mapping.maps[v].forEach((St,Ft,te,ne)=>{null==lt&&(lt=ne)}),k.setSelection(Et.near(k.doc.resolve(lt),_)))}function at(k,a){return a&&k?k.bind(a):k}class Tt{constructor(a,_,v){this.name=a,this.init=at(_.init,v),this.apply=at(_.apply,v)}}function Lt(k,a,_){for(let v in k){let w=k[v];w instanceof Function?w=w.bind(a):"handleDOMEvents"==v&&(w=Lt(w,a,{})),_[v]=w}return _}new Tt("doc",{init:k=>k.doc||k.schema.topNodeType.createAndFill(),apply:k=>k.doc}),new Tt("selection",{init:(k,a)=>k.selection||Et.atStart(a.doc),apply:k=>k.selection}),new Tt("storedMarks",{init:k=>k.storedMarks||null,apply:(k,a,_,v)=>v.selection.$cursor?k.storedMarks:null}),new Tt("scrollToSelection",{init:()=>0,apply:(k,a)=>k.scrolledIntoView?a+1:a});class Jt{constructor(a){this.spec=a,this.props={},a.props&&Lt(a.props,this,this.props),this.key=a.key?a.key.key:ce("plugin")}getState(a){return a[this.key]}}const qt=Object.create(null);function ce(k){return k in qt?k+"$"+ ++qt[k]:(qt[k]=0,k+"$")}class le{constructor(a="key"){this.key=ce(a)}get(a){return a.config.pluginsByKey[this.key]}getState(a){return a[this.key]}}const Fe=/^```([a-z]+)?[\s\n]$/,Ke=/^~~~([a-z]+)?[\s\n]$/,Qe=T.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:k=>{var a;const{languageClassPrefix:_}=this.options;return[...(null===(a=k.firstElementChild)||void 0===a?void 0:a.classList)||[]].filter(lt=>lt.startsWith(_)).map(lt=>lt.replace(_,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:k,HTMLAttributes:a}){return["pre",(0,T.mergeAttributes)(this.options.HTMLAttributes,a),["code",{class:k.attrs.language?this.options.languageClassPrefix+k.attrs.language:null},0]]},addCommands(){return{setCodeBlock:k=>({commands:a})=>a.setNode(this.name,k),toggleCodeBlock:k=>({commands:a})=>a.toggleNode(this.name,"paragraph",k)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:k,$anchor:a}=this.editor.state.selection;return!(!k||a.parent.type.name!==this.name)&&!(1!==a.pos&&a.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:k})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:a}=k,{selection:_}=a,{$from:v,empty:w}=_;if(!w||v.parent.type!==this.type)return!1;const q=v.parentOffset===v.parent.nodeSize-2,lt=v.parent.textContent.endsWith("\n\n");return!(!q||!lt)&&k.chain().command(({tr:St})=>(St.delete(v.pos-2,v.pos),!0)).exitCode().run()},ArrowDown:({editor:k})=>{if(!this.options.exitOnArrowDown)return!1;const{state:a}=k,{selection:_,doc:v}=a,{$from:w,empty:q}=_;if(!q||w.parent.type!==this.type||w.parentOffset!==w.parent.nodeSize-2)return!1;const St=w.after();return void 0!==St&&!v.nodeAt(St)&&k.commands.exitCode()}}},addInputRules(){return[(0,T.textblockTypeInputRule)({find:Fe,type:this.type,getAttributes:k=>({language:k[1]})}),(0,T.textblockTypeInputRule)({find:Ke,type:this.type,getAttributes:k=>({language:k[1]})})]},addProseMirrorPlugins(){return[new Jt({key:new le("codeBlockVSCodeHandler"),props:{handlePaste:(k,a)=>{if(!a.clipboardData||this.editor.isActive(this.type.name))return!1;const _=a.clipboardData.getData("text/plain"),v=a.clipboardData.getData("vscode-editor-data"),w=v?JSON.parse(v):void 0,q=null==w?void 0:w.mode;if(!_||!q)return!1;const{tr:lt}=k.state;return lt.replaceSelectionWith(this.type.create({language:q})),lt.setSelection(K.near(lt.doc.resolve(Math.max(0,lt.selection.from-2)))),lt.insertText(_.replace(/\r\n?/g,"\n")),lt.setMeta("paste",!0),k.dispatch(lt),!0}}})]}}),we=T.Node.create({name:"doc",topNode:!0,content:"block+"});var he=d(62463);function De(k={}){return new he.Sy({view:a=>new Ie(a,k)})}class Ie{constructor(a,_){this.editorView=a,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=_.width||1,this.color=_.color||"black",this.class=_.class,this.handlers=["dragover","dragend","drop","dragleave"].map(v=>{let w=q=>{this[v](q)};return a.dom.addEventListener(v,w),{name:v,handler:w}})}destroy(){this.handlers.forEach(({name:a,handler:_})=>this.editorView.dom.removeEventListener(a,_))}update(a,_){null!=this.cursorPos&&_.doc!=a.state.doc&&(this.cursorPos>a.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(a){a!=this.cursorPos&&(this.cursorPos=a,null==a?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let _,a=this.editorView.state.doc.resolve(this.cursorPos);if(!a.parent.inlineContent){let lt=a.nodeBefore,St=a.nodeAfter;if(lt||St){let Ft=this.editorView.nodeDOM(this.cursorPos-(lt?lt.nodeSize:0)).getBoundingClientRect(),te=lt?Ft.bottom:Ft.top;lt&&St&&(te=(te+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),_={left:Ft.left,right:Ft.right,top:te-this.width/2,bottom:te+this.width/2}}}if(!_){let lt=this.editorView.coordsAtPos(this.cursorPos);_={left:lt.left-this.width/2,right:lt.left+this.width/2,top:lt.top,bottom:lt.bottom}}let w,q,v=this.editorView.dom.offsetParent;if(this.element||(this.element=v.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!v||v==document.body&&"static"==getComputedStyle(v).position)w=-pageXOffset,q=-pageYOffset;else{let lt=v.getBoundingClientRect();w=lt.left-v.scrollLeft,q=lt.top-v.scrollTop}this.element.style.left=_.left-w+"px",this.element.style.top=_.top-q+"px",this.element.style.width=_.right-_.left+"px",this.element.style.height=_.bottom-_.top+"px"}scheduleRemoval(a){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),a)}dragover(a){if(!this.editorView.editable)return;let _=this.editorView.posAtCoords({left:a.clientX,top:a.clientY}),v=_&&_.inside>=0&&this.editorView.state.doc.nodeAt(_.inside),w=v&&v.type.spec.disableDropCursor,q="function"==typeof w?w(this.editorView,_):w;if(_&&!q){let lt=_.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(lt=(0,wt.nj)(this.editorView.state.doc,lt,this.editorView.dragging.slice),null==lt))return this.setCursor(null);this.setCursor(lt),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(a){(a.target==this.editorView.dom||!this.editorView.dom.contains(a.relatedTarget))&&this.setCursor(null)}}const Te=T.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[De(this.options)]}});var Ue=d(13903),de=d(43594);class se extends he.Y1{constructor(a){super(a,a)}map(a,_){let v=a.resolve(_.map(this.head));return se.valid(v)?new se(v):he.Y1.near(v)}content(){return gt.p2.empty}eq(a){return a instanceof se&&a.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(a,_){if("number"!=typeof _.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new se(a.resolve(_.pos))}getBookmark(){return new ze(this.anchor)}static valid(a){let _=a.parent;if(_.isTextblock||!function(k){for(let a=k.depth;a>=0;a--){let _=k.index(a),v=k.node(a);if(0!=_)for(let w=v.child(_-1);;w=w.lastChild){if(0==w.childCount&&!w.inlineContent||w.isAtom||w.type.spec.isolating)return!0;if(w.inlineContent)return!1}else if(v.type.spec.isolating)return!0}return!0}(a)||!function(k){for(let a=k.depth;a>=0;a--){let _=k.indexAfter(a),v=k.node(a);if(_!=v.childCount)for(let w=v.child(_);;w=w.firstChild){if(0==w.childCount&&!w.inlineContent||w.isAtom||w.type.spec.isolating)return!0;if(w.inlineContent)return!1}else if(v.type.spec.isolating)return!0}return!0}(a))return!1;let v=_.type.spec.allowGapCursor;if(null!=v)return v;let w=_.contentMatchAt(a.index()).defaultType;return w&&w.isTextblock}static findGapCursorFrom(a,_,v=!1){t:for(;;){if(!v&&se.valid(a))return a;let w=a.pos,q=null;for(let lt=a.depth;;lt--){let St=a.node(lt);if(_>0?a.indexAfter(lt)<St.childCount:a.index(lt)>0){q=St.child(_>0?a.indexAfter(lt):a.index(lt)-1);break}if(0==lt)return null;w+=_;let Ft=a.doc.resolve(w);if(se.valid(Ft))return Ft}for(;;){let lt=_>0?q.firstChild:q.lastChild;if(!lt){if(q.isAtom&&!q.isText&&!he.qv.isSelectable(q)){a=a.doc.resolve(w+q.nodeSize*_),v=!1;continue t}break}q=lt,w+=_;let St=a.doc.resolve(w);if(se.valid(St))return St}return null}}}se.prototype.visible=!1,se.findFrom=se.findGapCursorFrom,he.Y1.jsonID("gapcursor",se);class ze{constructor(a){this.pos=a}map(a){return new ze(a.map(this.pos))}resolve(a){let _=a.resolve(this.pos);return se.valid(_)?new se(_):he.Y1.near(_)}}const $e=(0,Ue.$)({ArrowLeft:_e("horiz",-1),ArrowRight:_e("horiz",1),ArrowUp:_e("vert",-1),ArrowDown:_e("vert",1)});function _e(k,a){const _="vert"==k?a>0?"down":"up":a>0?"right":"left";return function(v,w,q){let lt=v.selection,St=a>0?lt.$to:lt.$from,Ft=lt.empty;if(lt instanceof he.Bs){if(!q.endOfTextblock(_)||0==St.depth)return!1;Ft=!1,St=v.doc.resolve(a>0?St.after():St.before())}let te=se.findGapCursorFrom(St,a,Ft);return!!te&&(w&&w(v.tr.setSelection(new se(te))),!0)}}function Ce(k,a,_){if(!k||!k.editable)return!1;let v=k.state.doc.resolve(a);if(!se.valid(v))return!1;let w=k.posAtCoords({left:_.clientX,top:_.clientY});return!(w&&w.inside>-1&&he.qv.isSelectable(k.state.doc.nodeAt(w.inside))||(k.dispatch(k.state.tr.setSelection(new se(v))),0))}function Pe(k,a){if("insertCompositionText"!=a.inputType||!(k.state.selection instanceof se))return!1;let{$from:_}=k.state.selection,v=_.parent.contentMatchAt(_.index()).findWrapping(k.state.schema.nodes.text);if(!v)return!1;let w=gt.HY.empty;for(let lt=v.length-1;lt>=0;lt--)w=gt.HY.from(v[lt].createAndFill(null,w));let q=k.state.tr.replace(_.pos,_.pos,new gt.p2(w,0,0));return q.setSelection(he.Bs.near(q.doc.resolve(_.pos+1))),k.dispatch(q),!1}function G(k){if(!(k.selection instanceof se))return null;let a=document.createElement("div");return a.className="ProseMirror-gapcursor",de.EH.create(k.doc,[de.p.widget(k.selection.head,a,{key:"gapcursor"})])}const E=T.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new he.Sy({props:{decorations:G,createSelectionBetween:(k,a,_)=>a.pos==_.pos&&se.valid(_)?new se(_):null,handleClick:Ce,handleKeyDown:$e,handleDOMEvents:{beforeinput:Pe}}})],extendNodeSchema(k){var a;return{allowGapCursor:null!==(a=(0,T.callOrReturn)((0,T.getExtensionField)(k,"allowGapCursor",{name:k.name,options:k.options,storage:k.storage})))&&void 0!==a?a:null}}}),D=T.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:k}){return["br",(0,T.mergeAttributes)(this.options.HTMLAttributes,k)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:k,chain:a,state:_,editor:v})=>k.first([()=>k.exitCode(),()=>k.command(()=>{const{selection:w,storedMarks:q}=_;if(w.$from.parent.type.spec.isolating)return!1;const{keepMarks:lt}=this.options,{splittableMarks:St}=v.extensionManager,Ft=q||w.$to.parentOffset&&w.$from.marks();return a().insertContent({type:this.name}).command(({tr:te,dispatch:ne})=>{if(ne&&Ft&&lt){const ie=Ft.filter(ue=>St.includes(ue.type.name));te.ensureMarks(ie)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),B=T.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(k=>({tag:`h${k}`,attrs:{level:k}}))},renderHTML({node:k,HTMLAttributes:a}){return[`h${this.options.levels.includes(k.attrs.level)?k.attrs.level:this.options.levels[0]}`,(0,T.mergeAttributes)(this.options.HTMLAttributes,a),0]},addCommands(){return{setHeading:k=>({commands:a})=>!!this.options.levels.includes(k.level)&&a.setNode(this.name,k),toggleHeading:k=>({commands:a})=>!!this.options.levels.includes(k.level)&&a.toggleNode(this.name,"paragraph",k)}},addKeyboardShortcuts(){return this.options.levels.reduce((k,a)=>je(Xt({},k),{[`Mod-Alt-${a}`]:()=>this.editor.commands.toggleHeading({level:a})}),{})},addInputRules(){return this.options.levels.map(k=>(0,T.textblockTypeInputRule)({find:new RegExp(`^(#{1,${k}})\\s$`),type:this.type,getAttributes:{level:k}}))}});var R=200,$=function(){};$.prototype.append=function(a){return a.length?(a=$.from(a),!this.length&&a||a.length<R&&this.leafAppend(a)||this.length<R&&a.leafPrepend(this)||this.appendInner(a)):this},$.prototype.prepend=function(a){return a.length?$.from(a).append(this):this},$.prototype.appendInner=function(a){return new st(this,a)},$.prototype.slice=function(a,_){return void 0===a&&(a=0),void 0===_&&(_=this.length),a>=_?$.empty:this.sliceInner(Math.max(0,a),Math.min(this.length,_))},$.prototype.get=function(a){if(!(a<0||a>=this.length))return this.getInner(a)},$.prototype.forEach=function(a,_,v){void 0===_&&(_=0),void 0===v&&(v=this.length),_<=v?this.forEachInner(a,_,v,0):this.forEachInvertedInner(a,_,v,0)},$.prototype.map=function(a,_,v){void 0===_&&(_=0),void 0===v&&(v=this.length);var w=[];return this.forEach(function(q,lt){return w.push(a(q,lt))},_,v),w},$.from=function(a){return a instanceof $?a:a&&a.length?new U(a):$.empty};var U=function(k){function a(v){k.call(this),this.values=v}k&&(a.__proto__=k),(a.prototype=Object.create(k&&k.prototype)).constructor=a;var _={length:{configurable:!0},depth:{configurable:!0}};return a.prototype.flatten=function(){return this.values},a.prototype.sliceInner=function(w,q){return 0==w&&q==this.length?this:new a(this.values.slice(w,q))},a.prototype.getInner=function(w){return this.values[w]},a.prototype.forEachInner=function(w,q,lt,St){for(var Ft=q;Ft<lt;Ft++)if(!1===w(this.values[Ft],St+Ft))return!1},a.prototype.forEachInvertedInner=function(w,q,lt,St){for(var Ft=q-1;Ft>=lt;Ft--)if(!1===w(this.values[Ft],St+Ft))return!1},a.prototype.leafAppend=function(w){if(this.length+w.length<=R)return new a(this.values.concat(w.flatten()))},a.prototype.leafPrepend=function(w){if(this.length+w.length<=R)return new a(w.flatten().concat(this.values))},_.length.get=function(){return this.values.length},_.depth.get=function(){return 0},Object.defineProperties(a.prototype,_),a}($);$.empty=new U([]);var st=function(k){function a(_,v){k.call(this),this.left=_,this.right=v,this.length=_.length+v.length,this.depth=Math.max(_.depth,v.depth)+1}return k&&(a.__proto__=k),(a.prototype=Object.create(k&&k.prototype)).constructor=a,a.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},a.prototype.getInner=function(v){return v<this.left.length?this.left.get(v):this.right.get(v-this.left.length)},a.prototype.forEachInner=function(v,w,q,lt){var St=this.left.length;if(w<St&&!1===this.left.forEachInner(v,w,Math.min(q,St),lt)||q>St&&!1===this.right.forEachInner(v,Math.max(w-St,0),Math.min(this.length,q)-St,lt+St))return!1},a.prototype.forEachInvertedInner=function(v,w,q,lt){var St=this.left.length;if(w>St&&!1===this.right.forEachInvertedInner(v,w-St,Math.max(q,St)-St,lt+St)||q<St&&!1===this.left.forEachInvertedInner(v,Math.min(w,St),q,lt))return!1},a.prototype.sliceInner=function(v,w){if(0==v&&w==this.length)return this;var q=this.left.length;return w<=q?this.left.slice(v,w):v>=q?this.right.slice(v-q,w-q):this.left.slice(v,q).append(this.right.slice(0,w-q))},a.prototype.leafAppend=function(v){var w=this.right.leafAppend(v);if(w)return new a(this.left,w)},a.prototype.leafPrepend=function(v){var w=this.left.leafPrepend(v);if(w)return new a(w,this.right)},a.prototype.appendInner=function(v){return this.left.depth>=Math.max(this.right.depth,v.depth)+1?new a(this.left,new a(this.right,v)):new a(this,v)},a}($);const Wt=$;class Zt{constructor(a,_){this.items=a,this.eventCount=_}popEvent(a,_){if(0==this.eventCount)return null;let w,q,v=this.items.length;for(;;v--)if(this.items.get(v-1).selection){--v;break}_&&(w=this.remapping(v,this.items.length),q=w.maps.length);let St,Ft,lt=a.tr,te=[],ne=[];return this.items.forEach((ie,ue)=>{if(!ie.step)return w||(w=this.remapping(v,ue+1),q=w.maps.length),q--,void ne.push(ie);if(w){ne.push(new l(ie.map));let Ye,pe=ie.step.map(w.slice(q));pe&&lt.maybeStep(pe).doc&&(Ye=lt.mapping.maps[lt.mapping.maps.length-1],te.push(new l(Ye,void 0,void 0,te.length+ne.length))),q--,Ye&&w.appendMap(Ye,q)}else lt.maybeStep(ie.step);return ie.selection?(St=w?ie.selection.map(w.slice(q)):ie.selection,Ft=new Zt(this.items.slice(0,v).append(ne.reverse().concat(te)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:Ft,transform:lt,selection:St}}addTransform(a,_,v,w){let q=[],lt=this.eventCount,St=this.items,Ft=!w&&St.length?St.get(St.length-1):null;for(let ne=0;ne<a.steps.length;ne++){let pe,ie=a.steps[ne].invert(a.docs[ne]),ue=new l(a.mapping.maps[ne],ie,_);(pe=Ft&&Ft.merge(ue))&&(ue=pe,ne?q.pop():St=St.slice(0,St.length-1)),q.push(ue),_&&(lt++,_=void 0),w||(Ft=ue)}let te=lt-v.depth;return te>g&&(St=function(k,a){let _;return k.forEach((v,w)=>{if(v.selection&&0==a--)return _=w,!1}),k.slice(_)}(St,te),lt-=te),new Zt(St.append(q),lt)}remapping(a,_){let v=new wt.vs;return this.items.forEach((w,q)=>{v.appendMap(w.map,null!=w.mirrorOffset&&q-w.mirrorOffset>=a?v.maps.length-w.mirrorOffset:void 0)},a,_),v}addMaps(a){return 0==this.eventCount?this:new Zt(this.items.append(a.map(_=>new l(_))),this.eventCount)}rebased(a,_){if(!this.eventCount)return this;let v=[],w=Math.max(0,this.items.length-_),q=a.mapping,lt=a.steps.length,St=this.eventCount;this.items.forEach(ue=>{ue.selection&&St--},w);let Ft=_;this.items.forEach(ue=>{let pe=q.getMirror(--Ft);if(null==pe)return;lt=Math.min(lt,pe);let Ye=q.maps[pe];if(ue.step){let mn=a.steps[pe].invert(a.docs[pe]),Ve=ue.selection&&ue.selection.map(q.slice(Ft+1,pe));Ve&&St++,v.push(new l(Ye,mn,Ve))}else v.push(new l(Ye))},w);let te=[];for(let ue=_;ue<lt;ue++)te.push(new l(q.maps[ue]));let ne=this.items.slice(0,w).append(te).append(v),ie=new Zt(ne,St);return ie.emptyItemCount()>500&&(ie=ie.compress(this.items.length-v.length)),ie}emptyItemCount(){let a=0;return this.items.forEach(_=>{_.step||a++}),a}compress(a=this.items.length){let _=this.remapping(0,a),v=_.maps.length,w=[],q=0;return this.items.forEach((lt,St)=>{if(St>=a)w.push(lt),lt.selection&&q++;else if(lt.step){let Ft=lt.step.map(_.slice(v)),te=Ft&&Ft.getMap();if(v--,te&&_.appendMap(te,v),Ft){let ne=lt.selection&&lt.selection.map(_.slice(v));ne&&q++;let ue,ie=new l(te.invert(),Ft,ne),pe=w.length-1;(ue=w.length&&w[pe].merge(ie))?w[pe]=ue:w.push(ie)}}else lt.map&&v--},this.items.length,0),new Zt(Wt.from(w.reverse()),q)}}Zt.empty=new Zt(Wt.empty,0);class l{constructor(a,_,v,w){this.map=a,this.step=_,this.selection=v,this.mirrorOffset=w}merge(a){if(this.step&&a.step&&!a.selection){let _=a.step.merge(this.step);if(_)return new l(_.getMap().invert(),_,this.selection)}}}class u{constructor(a,_,v,w){this.done=a,this.undone=_,this.prevRanges=v,this.prevTime=w}}const g=20;function V(k){let a=[];return k.forEach((_,v,w,q)=>a.push(w,q)),a}function _t(k,a){if(!k)return null;let _=[];for(let v=0;v<k.length;v+=2){let w=a.map(k[v],1),q=a.map(k[v+1],-1);w<=q&&_.push(w,q)}return _}function kt(k,a,_,v){let w=Me(a),q=be.get(a).spec.config,lt=(v?k.undone:k.done).popEvent(a,w);if(!lt)return;let St=lt.selection.resolve(lt.transform.doc),Ft=(v?k.done:k.undone).addTransform(lt.transform,a.selection.getBookmark(),q,w),te=new u(v?Ft:lt.remaining,v?lt.remaining:Ft,null,0);_(lt.transform.setSelection(St).setMeta(be,{redo:v,historyState:te}).scrollIntoView())}let Yt=!1,Gt=null;function Me(k){let a=k.plugins;if(Gt!=a){Yt=!1,Gt=a;for(let _=0;_<a.length;_++)if(a[_].spec.historyPreserveItems){Yt=!0;break}}return Yt}const be=new he.H$("history"),Rn=new he.H$("closeHistory");function Ge(k={}){return new he.Sy({key:be,state:{init:()=>new u(Zt.empty,Zt.empty,null,0),apply:(a,_,v)=>function(k,a,_,v){let q,w=_.getMeta(be);if(w)return w.historyState;_.getMeta(Rn)&&(k=new u(k.done,k.undone,null,0));let lt=_.getMeta("appendedTransaction");if(0==_.steps.length)return k;if(lt&&lt.getMeta(be))return lt.getMeta(be).redo?new u(k.done.addTransform(_,void 0,v,Me(a)),k.undone,V(_.mapping.maps[_.steps.length-1]),k.prevTime):new u(k.done,k.undone.addTransform(_,void 0,v,Me(a)),null,k.prevTime);if(!1===_.getMeta("addToHistory")||lt&&!1===lt.getMeta("addToHistory"))return(q=_.getMeta("rebased"))?new u(k.done.rebased(_,q),k.undone.rebased(_,q),_t(k.prevRanges,_.mapping),k.prevTime):new u(k.done.addMaps(_.mapping.maps),k.undone.addMaps(_.mapping.maps),_t(k.prevRanges,_.mapping),k.prevTime);{let St=0==k.prevTime||!lt&&(k.prevTime<(_.time||0)-v.newGroupDelay||!function(k,a){if(!a)return!1;if(!k.docChanged)return!0;let _=!1;return k.mapping.maps[0].forEach((v,w)=>{for(let q=0;q<a.length;q+=2)v<=a[q+1]&&w>=a[q]&&(_=!0)}),_}(_,k.prevRanges)),Ft=lt?_t(k.prevRanges,_.mapping):V(_.mapping.maps[_.steps.length-1]);return new u(k.done.addTransform(_,St?a.selection.getBookmark():void 0,v,Me(a)),Zt.empty,Ft,_.time)}}(_,v,a,k)},config:k={depth:k.depth||100,newGroupDelay:k.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(a,_){let v=_.inputType,w="historyUndo"==v?Ln:"historyRedo"==v?vn:null;return!!w&&(_.preventDefault(),w(a.state,a.dispatch))}}}})}const Ln=(k,a)=>{let _=be.getState(k);return!(!_||0==_.done.eventCount||(a&&kt(_,k,a,!1),0))},vn=(k,a)=>{let _=be.getState(k);return!(!_||0==_.undone.eventCount||(a&&kt(_,k,a,!0),0))},un=T.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:k,dispatch:a})=>Ln(k,a),redo:()=>({state:k,dispatch:a})=>vn(k,a)}),addProseMirrorPlugins(){return[Ge(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Le=Object.create(null);class fe{constructor(a,_,v){this.$anchor=a,this.$head=_,this.ranges=v||[new Xe(a.min(_),a.max(_))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let a=this.ranges;for(let _=0;_<a.length;_++)if(a[_].$from.pos!=a[_].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(a,_=gt.p2.empty){let v=_.content.lastChild,w=null;for(let St=0;St<_.openEnd;St++)w=v,v=v.lastChild;let q=a.steps.length,lt=this.ranges;for(let St=0;St<lt.length;St++){let{$from:Ft,$to:te}=lt[St],ne=a.mapping.slice(q);a.replaceRange(ne.map(Ft.pos),ne.map(te.pos),St?gt.p2.empty:_),0==St&&an(a,q,(v?v.isInline:w&&w.isTextblock)?-1:1)}}replaceWith(a,_){let v=a.steps.length,w=this.ranges;for(let q=0;q<w.length;q++){let{$from:lt,$to:St}=w[q],Ft=a.mapping.slice(v),te=Ft.map(lt.pos),ne=Ft.map(St.pos);q?a.deleteRange(te,ne):(a.replaceRangeWith(te,ne,_),an(a,v,_.isInline?-1:1))}}static findFrom(a,_,v=!1){let w=a.parent.inlineContent?new xe(a):qe(a.node(0),a.parent,a.pos,a.index(),_,v);if(w)return w;for(let q=a.depth-1;q>=0;q--){let lt=_<0?qe(a.node(0),a.node(q),a.before(q+1),a.index(q),_,v):qe(a.node(0),a.node(q),a.after(q+1),a.index(q)+1,_,v);if(lt)return lt}return null}static near(a,_=1){return this.findFrom(a,_)||this.findFrom(a,-_)||new We(a.node(0))}static atStart(a){return qe(a,a,0,0,1)||new We(a)}static atEnd(a){return qe(a,a,a.content.size,a.childCount,-1)||new We(a)}static fromJSON(a,_){if(!_||!_.type)throw new RangeError("Invalid input for Selection.fromJSON");let v=Le[_.type];if(!v)throw new RangeError(`No selection type ${_.type} defined`);return v.fromJSON(a,_)}static jsonID(a,_){if(a in Le)throw new RangeError("Duplicate use of selection JSON ID "+a);return Le[a]=_,_.prototype.jsonID=a,_}getBookmark(){return xe.between(this.$anchor,this.$head).getBookmark()}}fe.prototype.visible=!0;class Xe{constructor(a,_){this.$from=a,this.$to=_}}let bn=!1;function xn(k){!bn&&!k.parent.inlineContent&&(bn=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+k.parent.type.name+")"))}class xe extends fe{constructor(a,_=a){xn(a),xn(_),super(a,_)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(a,_){let v=a.resolve(_.map(this.head));if(!v.parent.inlineContent)return fe.near(v);let w=a.resolve(_.map(this.anchor));return new xe(w.parent.inlineContent?w:v,v)}replace(a,_=gt.p2.empty){if(super.replace(a,_),_==gt.p2.empty){let v=this.$from.marksAcross(this.$to);v&&a.ensureMarks(v)}}eq(a){return a instanceof xe&&a.anchor==this.anchor&&a.head==this.head}getBookmark(){return new ln(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(a,_){if("number"!=typeof _.anchor||"number"!=typeof _.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new xe(a.resolve(_.anchor),a.resolve(_.head))}static create(a,_,v=_){let w=a.resolve(_);return new this(w,v==_?w:a.resolve(v))}static between(a,_,v){let w=a.pos-_.pos;if((!v||w)&&(v=w>=0?1:-1),!_.parent.inlineContent){let q=fe.findFrom(_,v,!0)||fe.findFrom(_,-v,!0);if(!q)return fe.near(_,v);_=q.$head}return a.parent.inlineContent||(0==w||(a=(fe.findFrom(a,-v,!0)||fe.findFrom(a,v,!0)).$anchor).pos<_.pos!=w<0)&&(a=_),new xe(a,_)}}fe.jsonID("text",xe);class ln{constructor(a,_){this.anchor=a,this.head=_}map(a){return new ln(a.map(this.anchor),a.map(this.head))}resolve(a){return xe.between(a.resolve(this.anchor),a.resolve(this.head))}}class ke extends fe{constructor(a){let _=a.nodeAfter,v=a.node(0).resolve(a.pos+_.nodeSize);super(a,v),this.node=_}map(a,_){let{deleted:v,pos:w}=_.mapResult(this.anchor),q=a.resolve(w);return v?fe.near(q):new ke(q)}content(){return new gt.p2(gt.HY.from(this.node),0,0)}eq(a){return a instanceof ke&&a.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Mn(this.anchor)}static fromJSON(a,_){if("number"!=typeof _.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ke(a.resolve(_.anchor))}static create(a,_){return new ke(a.resolve(_))}static isSelectable(a){return!a.isText&&!1!==a.type.spec.selectable}}ke.prototype.visible=!1,fe.jsonID("node",ke);class Mn{constructor(a){this.anchor=a}map(a){let{deleted:_,pos:v}=a.mapResult(this.anchor);return _?new ln(v,v):new Mn(v)}resolve(a){let _=a.resolve(this.anchor),v=_.nodeAfter;return v&&ke.isSelectable(v)?new ke(_):fe.near(_)}}class We extends fe{constructor(a){super(a.resolve(0),a.resolve(a.content.size))}replace(a,_=gt.p2.empty){if(_==gt.p2.empty){a.delete(0,a.doc.content.size);let v=fe.atStart(a.doc);v.eq(a.selection)||a.setSelection(v)}else super.replace(a,_)}toJSON(){return{type:"all"}}static fromJSON(a){return new We(a)}map(a){return new We(a)}eq(a){return a instanceof We}getBookmark(){return Bn}}fe.jsonID("all",We);const Bn={map(){return this},resolve:k=>new We(k)};function qe(k,a,_,v,w,q=!1){if(a.inlineContent)return xe.create(k,_);for(let lt=v-(w>0?0:1);w>0?lt<a.childCount:lt>=0;lt+=w){let St=a.child(lt);if(St.isAtom){if(!q&&ke.isSelectable(St))return ke.create(k,_-(w<0?St.nodeSize:0))}else{let Ft=qe(k,St,_+w,w<0?St.childCount:0,w,q);if(Ft)return Ft}_+=St.nodeSize*w}return null}function an(k,a,_){let v=k.steps.length-1;if(v<a)return;let lt,w=k.steps[v];(w instanceof wt.Pu||w instanceof wt.FC)&&(k.mapping.maps[v].forEach((St,Ft,te,ne)=>{null==lt&&(lt=ne)}),k.setSelection(fe.near(k.doc.resolve(lt),_)))}function On(k,a){return a&&k?k.bind(a):k}class tn{constructor(a,_,v){this.name=a,this.init=On(_.init,v),this.apply=On(_.apply,v)}}new tn("doc",{init:k=>k.doc||k.schema.topNodeType.createAndFill(),apply:k=>k.doc}),new tn("selection",{init:(k,a)=>k.selection||fe.atStart(a.doc),apply:k=>k.selection}),new tn("storedMarks",{init:k=>k.storedMarks||null,apply:(k,a,_,v)=>v.selection.$cursor?k.storedMarks:null}),new tn("scrollToSelection",{init:()=>0,apply:(k,a)=>k.scrolledIntoView?a+1:a}),Object.create(null);const S=T.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:k}){return["hr",(0,T.mergeAttributes)(this.options.HTMLAttributes,k)]},addCommands(){return{setHorizontalRule:()=>({chain:k})=>k().insertContent({type:this.name}).command(({tr:a,dispatch:_})=>{var v;if(_){const{$to:w}=a.selection,q=w.end();if(w.nodeAfter)a.setSelection(xe.create(a.doc,w.pos));else{const lt=null===(v=w.parent.type.contentMatch.defaultType)||void 0===v?void 0:v.create();lt&&(a.insert(q,lt),a.setSelection(xe.create(a.doc,q)))}a.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,T.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),N=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Z=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,nt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,j=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,rt=T.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:k=>"normal"!==k.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:k}){return["em",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setItalic:()=>({commands:k})=>k.setMark(this.name),toggleItalic:()=>({commands:k})=>k.toggleMark(this.name),unsetItalic:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,T.markInputRule)({find:N,type:this.type}),(0,T.markInputRule)({find:nt,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:Z,type:this.type}),(0,T.markPasteRule)({find:j,type:this.type})]}}),At=T.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:k}){return["li",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Bt=/^(\d+)\.\s$/,Ut=T.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:k=>k.hasAttribute("start")?parseInt(k.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:k}){const v=k,{start:a}=v,_=Fo(v,["start"]);return 1===a?["ol",(0,T.mergeAttributes)(this.options.HTMLAttributes,_),0]:["ol",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{toggleOrderedList:()=>({commands:k})=>k.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[(0,T.wrappingInputRule)({find:Bt,type:this.type,getAttributes:k=>({start:+k[1]}),joinPredicate:(k,a)=>a.childCount+a.attrs.start===+k[1]})]}}),jt=T.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:k}){return["p",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setParagraph:()=>({commands:k})=>k.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Vt=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,oe=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,ae=T.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:k=>!!k.includes("line-through")&&{}}],renderHTML({HTMLAttributes:k}){return["s",(0,T.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setStrike:()=>({commands:k})=>k.setMark(this.name),toggleStrike:()=>({commands:k})=>k.toggleMark(this.name),unsetStrike:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,T.markInputRule)({find:Vt,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:oe,type:this.type})]}}),Oe=T.Node.create({name:"text",group:"inline"}),Dn=T.Extension.create({name:"starterKit",addExtensions(){var k,a,_,v,w,q,lt,St,Ft,te,ne,ie,ue,pe,Ye,mn,Ve,Kn,Jn,$n,yn,Zn,Nn,Pn,Hn,Un,gn,An,Sn,In,Yn,sn,Qn,_n,Gn,Xn;const ve=[];return!1!==(null===(k=this.options)||void 0===k?void 0:k.blockquote)&&ve.push(H.configure(null===(a=this.options)||void 0===a?void 0:a.blockquote)),!1!==(null===(_=this.options)||void 0===_?void 0:_.bold)&&ve.push(pt.configure(null===(v=this.options)||void 0===v?void 0:v.bold)),!1!==(null===(w=this.options)||void 0===w?void 0:w.bulletList)&&ve.push(ut.configure(null===(q=this.options)||void 0===q?void 0:q.bulletList)),!1!==(null===(lt=this.options)||void 0===lt?void 0:lt.code)&&ve.push(mt.configure(null===(St=this.options)||void 0===St?void 0:St.code)),!1!==(null===(Ft=this.options)||void 0===Ft?void 0:Ft.codeBlock)&&ve.push(Qe.configure(null===(te=this.options)||void 0===te?void 0:te.codeBlock)),!1!==(null===(ne=this.options)||void 0===ne?void 0:ne.document)&&ve.push(we.configure(null===(ie=this.options)||void 0===ie?void 0:ie.document)),!1!==(null===(ue=this.options)||void 0===ue?void 0:ue.dropcursor)&&ve.push(Te.configure(null===(pe=this.options)||void 0===pe?void 0:pe.dropcursor)),!1!==(null===(Ye=this.options)||void 0===Ye?void 0:Ye.gapcursor)&&ve.push(E.configure(null===(mn=this.options)||void 0===mn?void 0:mn.gapcursor)),!1!==(null===(Ve=this.options)||void 0===Ve?void 0:Ve.hardBreak)&&ve.push(D.configure(null===(Kn=this.options)||void 0===Kn?void 0:Kn.hardBreak)),!1!==(null===(Jn=this.options)||void 0===Jn?void 0:Jn.heading)&&ve.push(B.configure(null===($n=this.options)||void 0===$n?void 0:$n.heading)),!1!==(null===(yn=this.options)||void 0===yn?void 0:yn.history)&&ve.push(un.configure(null===(Zn=this.options)||void 0===Zn?void 0:Zn.history)),!1!==(null===(Nn=this.options)||void 0===Nn?void 0:Nn.horizontalRule)&&ve.push(S.configure(null===(Pn=this.options)||void 0===Pn?void 0:Pn.horizontalRule)),!1!==(null===(Hn=this.options)||void 0===Hn?void 0:Hn.italic)&&ve.push(rt.configure(null===(Un=this.options)||void 0===Un?void 0:Un.italic)),!1!==(null===(gn=this.options)||void 0===gn?void 0:gn.listItem)&&ve.push(At.configure(null===(An=this.options)||void 0===An?void 0:An.listItem)),!1!==(null===(Sn=this.options)||void 0===Sn?void 0:Sn.orderedList)&&ve.push(Ut.configure(null===(In=this.options)||void 0===In?void 0:In.orderedList)),!1!==(null===(Yn=this.options)||void 0===Yn?void 0:Yn.paragraph)&&ve.push(jt.configure(null===(sn=this.options)||void 0===sn?void 0:sn.paragraph)),!1!==(null===(Qn=this.options)||void 0===Qn?void 0:Qn.strike)&&ve.push(ae.configure(null===(_n=this.options)||void 0===_n?void 0:_n.strike)),!1!==(null===(Gn=this.options)||void 0===Gn?void 0:Gn.text)&&ve.push(Oe.configure(null===(Xn=this.options)||void 0===Xn?void 0:Xn.text)),ve}})},51919:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{TableCellBackground:()=>s});const s=d(40256).Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:H})=>H?{style:`background: ${H}`}:null,parseHTML:({style:H})=>H.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:H=>({chain:P})=>P().updateAttributes("tableCell",{background:H}).updateAttributes("tableHeader",{background:H}).run(),unsetCellBackground:()=>({chain:H})=>H().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})})},28279:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{TuiTable:()=>Be});var T=d(40256),s=d(62463),H=d(35917),P=d(13903),m=d(43594),ct=d(38480);let I,pt;if("undefined"!=typeof WeakMap){let C=new WeakMap;I=f=>C.get(f),pt=(f,y)=>(C.set(f,y),y)}else{let C=[],f=10,y=0;I=M=>{for(let S=0;S<C.length;S+=2)if(C[S]==M)return C[S+1]},pt=(M,S)=>(y==f&&(y=0),C[y++]=M,C[y++]=S)}class ot{constructor(f,y,M,S){this.left=f,this.top=y,this.right=M,this.bottom=S}}class ut{constructor(f,y,M,S){this.width=f,this.height=y,this.map=M,this.problems=S}findCell(f){for(let y=0;y<this.map.length;y++){let M=this.map[y];if(M!=f)continue;let S=y%this.width,N=y/this.width|0,Z=S+1,nt=N+1;for(let j=1;Z<this.width&&this.map[y+j]==M;j++)Z++;for(let j=1;nt<this.height&&this.map[y+this.width*j]==M;j++)nt++;return new ot(S,N,Z,nt)}throw new RangeError("No cell with offset "+f+" found")}colCount(f){for(let y=0;y<this.map.length;y++)if(this.map[y]==f)return y%this.width;throw new RangeError("No cell with offset "+f+" found")}nextCell(f,y,M){let{left:S,right:N,top:Z,bottom:nt}=this.findCell(f);return"horiz"==y?(M<0?0==S:N==this.width)?null:this.map[Z*this.width+(M<0?S-1:N)]:(M<0?0==Z:nt==this.height)?null:this.map[S+this.width*(M<0?Z-1:nt)]}rectBetween(f,y){let{left:M,right:S,top:N,bottom:Z}=this.findCell(f),{left:nt,right:j,top:rt,bottom:At}=this.findCell(y);return new ot(Math.min(M,nt),Math.min(N,rt),Math.max(S,j),Math.max(Z,At))}cellsInRect(f){let y=[],M={};for(let S=f.top;S<f.bottom;S++)for(let N=f.left;N<f.right;N++){let Z=S*this.width+N,nt=this.map[Z];M[nt]||(M[nt]=!0,(N!=f.left||!N||this.map[Z-1]!=nt)&&(S!=f.top||!S||this.map[Z-this.width]!=nt)&&y.push(nt))}return y}positionAt(f,y,M){for(let S=0,N=0;;S++){let Z=N+M.child(S).nodeSize;if(S==f){let nt=y+f*this.width,j=(f+1)*this.width;for(;nt<j&&this.map[nt]<N;)nt++;return nt==j?Z-1:this.map[nt]}N=Z}}static get(f){return I(f)||pt(f,function(C){if("table"!=C.type.spec.tableRole)throw new RangeError("Not a table node: "+C.type.name);let f=function(C){let f=-1,y=!1;for(let M=0;M<C.childCount;M++){let S=C.child(M),N=0;if(y)for(let Z=0;Z<M;Z++){let nt=C.child(Z);for(let j=0;j<nt.childCount;j++){let rt=nt.child(j);Z+rt.attrs.rowspan>M&&(N+=rt.attrs.colspan)}}for(let Z=0;Z<S.childCount;Z++){let nt=S.child(Z);N+=nt.attrs.colspan,nt.attrs.rowspan>1&&(y=!0)}-1==f?f=N:f!=N&&(f=Math.max(f,N))}return f}(C),y=C.childCount,M=[],S=0,N=null,Z=[];for(let rt=0,At=f*y;rt<At;rt++)M[rt]=0;for(let rt=0,At=0;rt<y;rt++){let Bt=C.child(rt);At++;for(let Vt=0;;Vt++){for(;S<M.length&&0!=M[S];)S++;if(Vt==Bt.childCount)break;let oe=Bt.child(Vt),{colspan:ae,rowspan:Oe,colwidth:Dn}=oe.attrs;for(let k=0;k<Oe;k++){if(k+rt>=y){(N||(N=[])).push({type:"overlong_rowspan",pos:At,n:Oe-k});break}let a=S+k*f;for(let _=0;_<ae;_++){0==M[a+_]?M[a+_]=At:(N||(N=[])).push({type:"collision",row:rt,pos:At,n:ae-_});let v=Dn&&Dn[_];if(v){let w=(a+_)%f*2,q=Z[w];null==q||q!=v&&1==Z[w+1]?(Z[w]=v,Z[w+1]=1):q==v&&Z[w+1]++}}}S+=ae,At+=oe.nodeSize}let Ut=(rt+1)*f,jt=0;for(;S<Ut;)0==M[S++]&&jt++;jt&&(N||(N=[])).push({type:"missing",row:rt,n:jt}),At++}let nt=new ut(f,y,M,N),j=!1;for(let rt=0;!j&&rt<Z.length;rt+=2)null!=Z[rt]&&Z[rt+1]<y&&(j=!0);return j&&function(C,f,y){C.problems||(C.problems=[]);for(let M=0,S={};M<C.map.length;M++){let N=C.map[M];if(S[N])continue;S[N]=!0;let Z=y.nodeAt(N),nt=null;for(let j=0;j<Z.attrs.colspan;j++){let At=f[(M+j)%C.width*2];null!=At&&(!Z.attrs.colwidth||Z.attrs.colwidth[j]!=At)&&((nt||(nt=gt(Z.attrs)))[j]=At)}nt&&C.problems.unshift({type:"colwidth mismatch",pos:N,colwidth:nt})}}(nt,Z,C),nt}(f))}}function gt(C){if(C.colwidth)return C.colwidth.slice();let f=[];for(let y=0;y<C.colspan;y++)f.push(0);return f}function X(C){let f=C.cached.tableNodeTypes;if(!f){f=C.cached.tableNodeTypes={};for(let y in C.nodes){let M=C.nodes[y],S=M.spec.tableRole;S&&(f[S]=M)}}return f}const Q=new s.H$("selectingCells");function it(C){for(let f=C.depth-1;f>0;f--)if("row"==C.node(f).type.spec.tableRole)return C.node(0).resolve(C.before(f+1));return null}function vt(C){let f=C.selection.$head;for(let y=f.depth;y>0;y--)if("row"==f.node(y).type.spec.tableRole)return!0;return!1}function yt(C){let f=C.selection;return f.$anchorCell?f.$anchorCell.pos>f.$headCell.pos?f.$anchorCell:f.$headCell:f.node&&"cell"==f.node.type.spec.tableRole?f.$anchor:it(f.$head)||function(C){for(let f=C.nodeAfter,y=C.pos;f;f=f.firstChild,y++){let M=f.type.spec.tableRole;if("cell"==M||"header_cell"==M)return C.doc.resolve(y)}for(let f=C.nodeBefore,y=C.pos;f;f=f.lastChild,y--){let M=f.type.spec.tableRole;if("cell"==M||"header_cell"==M)return C.doc.resolve(y-f.nodeSize)}}(f.$head)}function Dt(C){return"row"==C.parent.type.spec.tableRole&&C.nodeAfter}function Nt(C,f){return C.depth==f.depth&&C.pos>=f.start(-1)&&C.pos<=f.end(-1)}function ft(C,f,y){let M=C.start(-1),N=ut.get(C.node(-1)).nextCell(C.pos-M,f,y);return null==N?null:C.node(0).resolve(M+N)}function A(C,f,y){let M={};for(let S in C)M[S]=C[S];return M[f]=y,M}function et(C,f,y=1){let M=A(C,"colspan",C.colspan-y);return M.colwidth&&(M.colwidth=M.colwidth.slice(),M.colwidth.splice(f,y),M.colwidth.some(S=>S>0)||(M.colwidth=null)),M}function at(C,f,y=1){let M=A(C,"colspan",C.colspan+y);if(M.colwidth){M.colwidth=M.colwidth.slice();for(let S=0;S<y;S++)M.colwidth.splice(f,0,0)}return M}class W extends s.Y1{constructor(f,y=f){let M=f.node(-1),S=ut.get(M),N=f.start(-1),Z=S.rectBetween(f.pos-N,y.pos-N),nt=f.node(0),j=S.cellsInRect(Z).filter(At=>At!=y.pos-N);j.unshift(y.pos-N);let rt=j.map(At=>{let Bt=M.nodeAt(At),Ut=At+N+1;return new s.xm(nt.resolve(Ut),nt.resolve(Ut+Bt.content.size))});super(rt[0].$from,rt[0].$to,rt),this.$anchorCell=f,this.$headCell=y}map(f,y){let M=f.resolve(y.map(this.$anchorCell.pos)),S=f.resolve(y.map(this.$headCell.pos));if(Dt(M)&&Dt(S)&&Nt(M,S)){let N=this.$anchorCell.node(-1)!=M.node(-1);return N&&this.isRowSelection()?W.rowSelection(M,S):N&&this.isColSelection()?W.colSelection(M,S):new W(M,S)}return s.Bs.between(M,S)}content(){let f=this.$anchorCell.node(-1),y=ut.get(f),M=this.$anchorCell.start(-1),S=y.rectBetween(this.$anchorCell.pos-M,this.$headCell.pos-M),N={},Z=[];for(let j=S.top;j<S.bottom;j++){let rt=[];for(let At=j*y.width+S.left,Bt=S.left;Bt<S.right;Bt++,At++){let Ut=y.map[At];if(!N[Ut]){N[Ut]=!0;let jt=y.findCell(Ut),Vt=f.nodeAt(Ut),oe=S.left-jt.left,ae=jt.right-S.right;if(oe>0||ae>0){let Oe=Vt.attrs;oe>0&&(Oe=et(Oe,0,oe)),ae>0&&(Oe=et(Oe,Oe.colspan-ae,ae)),Vt=jt.left<S.left?Vt.type.createAndFill(Oe):Vt.type.create(Oe,Vt.content)}if(jt.top<S.top||jt.bottom>S.bottom){let Oe=A(Vt.attrs,"rowspan",Math.min(jt.bottom,S.bottom)-Math.max(jt.top,S.top));Vt=jt.top<S.top?Vt.type.createAndFill(Oe):Vt.type.create(Oe,Vt.content)}rt.push(Vt)}}Z.push(f.child(j).copy(H.HY.from(rt)))}const nt=this.isColSelection()&&this.isRowSelection()?f:Z;return new H.p2(H.HY.from(nt),1,1)}replace(f,y=H.p2.empty){let M=f.steps.length,S=this.ranges;for(let Z=0;Z<S.length;Z++){let{$from:nt,$to:j}=S[Z],rt=f.mapping.slice(M);f.replace(rt.map(nt.pos),rt.map(j.pos),Z?H.p2.empty:y)}let N=s.Y1.findFrom(f.doc.resolve(f.mapping.slice(M).map(this.to)),-1);N&&f.setSelection(N)}replaceWith(f,y){this.replace(f,new H.p2(H.HY.from(y),0,0))}forEachCell(f){let y=this.$anchorCell.node(-1),M=ut.get(y),S=this.$anchorCell.start(-1),N=M.cellsInRect(M.rectBetween(this.$anchorCell.pos-S,this.$headCell.pos-S));for(let Z=0;Z<N.length;Z++)f(y.nodeAt(N[Z]),S+N[Z])}isColSelection(){let f=this.$anchorCell.index(-1),y=this.$headCell.index(-1);return!(Math.min(f,y)>0)&&Math.max(f+this.$anchorCell.nodeAfter.attrs.rowspan,y+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(f,y=f){let M=ut.get(f.node(-1)),S=f.start(-1),N=M.findCell(f.pos-S),Z=M.findCell(y.pos-S),nt=f.node(0);return N.top<=Z.top?(N.top>0&&(f=nt.resolve(S+M.map[N.left])),Z.bottom<M.height&&(y=nt.resolve(S+M.map[M.width*(M.height-1)+Z.right-1]))):(Z.top>0&&(y=nt.resolve(S+M.map[Z.left])),N.bottom<M.height&&(f=nt.resolve(S+M.map[M.width*(M.height-1)+N.right-1]))),new W(f,y)}isRowSelection(){let f=ut.get(this.$anchorCell.node(-1)),y=this.$anchorCell.start(-1),M=f.colCount(this.$anchorCell.pos-y),S=f.colCount(this.$headCell.pos-y);return!(Math.min(M,S)>0)&&Math.max(M+this.$anchorCell.nodeAfter.attrs.colspan,S+this.$headCell.nodeAfter.attrs.colspan)==f.width}eq(f){return f instanceof W&&f.$anchorCell.pos==this.$anchorCell.pos&&f.$headCell.pos==this.$headCell.pos}static rowSelection(f,y=f){let M=ut.get(f.node(-1)),S=f.start(-1),N=M.findCell(f.pos-S),Z=M.findCell(y.pos-S),nt=f.node(0);return N.left<=Z.left?(N.left>0&&(f=nt.resolve(S+M.map[N.top*M.width])),Z.right<M.width&&(y=nt.resolve(S+M.map[M.width*(Z.top+1)-1]))):(Z.left>0&&(y=nt.resolve(S+M.map[Z.top*M.width])),N.right<M.width&&(f=nt.resolve(S+M.map[M.width*(N.top+1)-1]))),new W(f,y)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(f,y){return new W(f.resolve(y.anchor),f.resolve(y.head))}static create(f,y,M=y){return new W(f.resolve(y),f.resolve(M))}getBookmark(){return new J(this.$anchorCell.pos,this.$headCell.pos)}}W.prototype.visible=!1,s.Y1.jsonID("cell",W);class J{constructor(f,y){this.anchor=f,this.head=y}map(f){return new J(f.map(this.anchor),f.map(this.head))}resolve(f){let y=f.resolve(this.anchor),M=f.resolve(this.head);return"row"==y.parent.type.spec.tableRole&&"row"==M.parent.type.spec.tableRole&&y.index()<y.parent.childCount&&M.index()<M.parent.childCount&&Nt(y,M)?new W(y,M):s.Y1.near(M,1)}}function dt(C){if(!(C.selection instanceof W))return null;let f=[];return C.selection.forEachCell((y,M)=>{f.push(m.p.node(M,M+y.nodeSize,{class:"selectedCell"}))}),m.EH.create(C.doc,f)}function Fe(C,f){let y=C.createAndFill();return new ct.wx(y).replace(0,y.content.size,f).doc}function we(C,f,y,M,S,N,Z,nt){if(0==Z||Z==f.height)return!1;let j=!1;for(let rt=S;rt<N;rt++){let At=Z*f.width+rt,Bt=f.map[At];if(f.map[At-f.width]==Bt){j=!0;let Ut=y.nodeAt(Bt),{top:jt,left:Vt}=f.findCell(Bt);C.setNodeMarkup(C.mapping.slice(nt).map(Bt+M),null,A(Ut.attrs,"rowspan",Z-jt)),C.insert(C.mapping.slice(nt).map(f.positionAt(Z,Vt,y)),Ut.type.createAndFill(A(Ut.attrs,"rowspan",jt+Ut.attrs.rowspan-Z))),rt+=Ut.attrs.colspan-1}}return j}function he(C,f,y,M,S,N,Z,nt){if(0==Z||Z==f.width)return!1;let j=!1;for(let rt=S;rt<N;rt++){let At=rt*f.width+Z,Bt=f.map[At];if(f.map[At-1]==Bt){j=!0;let Ut=y.nodeAt(Bt),jt=f.colCount(Bt),Vt=C.mapping.slice(nt).map(Bt+M);C.setNodeMarkup(Vt,null,et(Ut.attrs,Z-jt,Ut.attrs.colspan-(Z-jt))),C.insert(Vt+Ut.nodeSize,Ut.type.createAndFill(et(Ut.attrs,0,Z-jt))),rt+=Ut.attrs.rowspan-1}}return j}function De(C,f,y,M,S){let N=y?C.doc.nodeAt(y-1):C.doc,Z=ut.get(N),{top:nt,left:j}=M,rt=j+S.width,At=nt+S.height,Bt=C.tr,Ut=0;function jt(){N=y?Bt.doc.nodeAt(y-1):Bt.doc,Z=ut.get(N),Ut=Bt.mapping.maps.length}(function(C,f,y,M,S,N,Z){let rt,At,j=X(C.doc.type.schema);if(S>f.width)for(let Bt=0,Ut=0;Bt<f.height;Bt++){let jt=y.child(Bt);Ut+=jt.nodeSize;let oe,Vt=[];oe=null==jt.lastChild||jt.lastChild.type==j.cell?rt||(rt=j.cell.createAndFill()):At||(At=j.header_cell.createAndFill());for(let ae=f.width;ae<S;ae++)Vt.push(oe);C.insert(C.mapping.slice(Z).map(Ut-1+M),Vt)}if(N>f.height){let Bt=[];for(let Vt=0,oe=(f.height-1)*f.width;Vt<Math.max(f.width,S);Vt++){let ae=!(Vt>=f.width)&&y.nodeAt(f.map[oe+Vt]).type==j.header_cell;Bt.push(ae?At||(At=j.header_cell.createAndFill()):rt||(rt=j.cell.createAndFill()))}let Ut=j.row.create(null,H.HY.from(Bt)),jt=[];for(let Vt=f.height;Vt<N;Vt++)jt.push(Ut);C.insert(C.mapping.slice(Z).map(M+y.nodeSize-2),jt)}return!(!rt&&!At)})(Bt,Z,N,y,rt,At,Ut)&&jt(),we(Bt,Z,N,y,j,rt,nt,Ut)&&jt(),we(Bt,Z,N,y,j,rt,At,Ut)&&jt(),he(Bt,Z,N,y,nt,At,j,Ut)&&jt(),he(Bt,Z,N,y,nt,At,rt,Ut)&&jt();for(let Vt=nt;Vt<At;Vt++){let oe=Z.positionAt(Vt,j,N),ae=Z.positionAt(Vt,rt,N);Bt.replace(Bt.mapping.slice(Ut).map(oe+y),Bt.mapping.slice(Ut).map(ae+y),new H.p2(S.rows[Vt-nt],0,0))}jt(),Bt.setSelection(new W(Bt.doc.resolve(y+Z.positionAt(nt,j,N)),Bt.doc.resolve(y+Z.positionAt(At-1,rt-1,N)))),f(Bt)}const Ie=(0,P.$)({ArrowLeft:Ue("horiz",-1),ArrowRight:Ue("horiz",1),ArrowUp:Ue("vert",-1),ArrowDown:Ue("vert",1),"Shift-ArrowLeft":de("horiz",-1),"Shift-ArrowRight":de("horiz",1),"Shift-ArrowUp":de("vert",-1),"Shift-ArrowDown":de("vert",1),Backspace:se,"Mod-Backspace":se,Delete:se,"Mod-Delete":se});function Te(C,f,y){return!y.eq(C.selection)&&(f&&f(C.tr.setSelection(y).scrollIntoView()),!0)}function Ue(C,f){return(y,M,S)=>{let N=y.selection;if(N instanceof W)return Te(y,M,s.Y1.near(N.$headCell,f));if("horiz"!=C&&!N.empty)return!1;let Z=Je(S,C,f);if(null==Z)return!1;if("horiz"==C)return Te(y,M,s.Y1.near(y.doc.resolve(N.head+f),f));{let rt,nt=y.doc.resolve(Z),j=ft(nt,C,f);return rt=j?s.Y1.near(j,1):f<0?s.Y1.near(y.doc.resolve(nt.before(-1)),-1):s.Y1.near(y.doc.resolve(nt.after(-1)),1),Te(y,M,rt)}}}function de(C,f){return(y,M,S)=>{let N=y.selection;if(!(N instanceof W)){let nt=Je(S,C,f);if(null==nt)return!1;N=new W(y.doc.resolve(nt))}let Z=ft(N.$headCell,C,f);return!!Z&&Te(y,M,new W(N.$anchorCell,Z))}}function se(C,f){let y=C.selection;if(!(y instanceof W))return!1;if(f){let M=C.tr,S=X(C.schema).cell.createAndFill().content;y.forEachCell((N,Z)=>{N.content.eq(S)||M.replace(M.mapping.map(Z+1),M.mapping.map(Z+N.nodeSize-1),new H.p2(S,0,0))}),M.docChanged&&f(M)}return!0}function ze(C,f){let M=it(C.state.doc.resolve(f));return!!M&&(C.dispatch(C.state.tr.setSelection(new W(M))),!0)}function Ee(C,f,y){if(!vt(C.state))return!1;let M=function(C){if(!C.size)return null;let{content:f,openStart:y,openEnd:M}=C;for(;1==f.childCount&&(y>0&&M>0||"table"==f.firstChild.type.spec.tableRole);)y--,M--,f=f.firstChild.content;let S=f.firstChild,N=S.type.spec.tableRole,Z=S.type.schema,nt=[];if("row"==N)for(let j=0;j<f.childCount;j++){let rt=f.child(j).content,At=j?0:Math.max(0,y-1),Bt=j<f.childCount-1?0:Math.max(0,M-1);(At||Bt)&&(rt=Fe(X(Z).row,new H.p2(rt,At,Bt)).content),nt.push(rt)}else{if("cell"!=N&&"header_cell"!=N)return null;nt.push(y||M?Fe(X(Z).row,new H.p2(f,y,M)).content:f)}return function(C,f){let y=[];for(let S=0;S<f.length;S++){let N=f[S];for(let Z=N.childCount-1;Z>=0;Z--){let{rowspan:nt,colspan:j}=N.child(Z).attrs;for(let rt=S;rt<S+nt;rt++)y[rt]=(y[rt]||0)+j}}let M=0;for(let S=0;S<y.length;S++)M=Math.max(M,y[S]);for(let S=0;S<y.length;S++)if(S>=f.length&&f.push(H.HY.empty),y[S]<M){let N=X(C).cell.createAndFill(),Z=[];for(let nt=y[S];nt<M;nt++)Z.push(N);f[S]=f[S].append(H.HY.from(Z))}return{height:f.length,width:M,rows:f}}(Z,nt)}(y),S=C.state.selection;if(S instanceof W){M||(M={width:1,height:1,rows:[H.HY.from(Fe(X(C.state.schema).cell,y))]});let N=S.$anchorCell.node(-1),Z=S.$anchorCell.start(-1),nt=ut.get(N).rectBetween(S.$anchorCell.pos-Z,S.$headCell.pos-Z);return M=function({width:C,height:f,rows:y},M,S){if(C!=M){let N=[],Z=[];for(let nt=0;nt<y.length;nt++){let j=y[nt],rt=[];for(let At=N[nt]||0,Bt=0;At<M;Bt++){let Ut=j.child(Bt%j.childCount);At+Ut.attrs.colspan>M&&(Ut=Ut.type.create(et(Ut.attrs,Ut.attrs.colspan,At+Ut.attrs.colspan-M),Ut.content)),rt.push(Ut),At+=Ut.attrs.colspan;for(let jt=1;jt<Ut.attrs.rowspan;jt++)N[nt+jt]=(N[nt+jt]||0)+Ut.attrs.colspan}Z.push(H.HY.from(rt))}y=Z,C=M}if(f!=S){let N=[];for(let Z=0,nt=0;Z<S;Z++,nt++){let j=[],rt=y[nt%f];for(let At=0;At<rt.childCount;At++){let Bt=rt.child(At);Z+Bt.attrs.rowspan>S&&(Bt=Bt.type.create(A(Bt.attrs,"rowspan",Math.max(1,S-Bt.attrs.rowspan)),Bt.content)),j.push(Bt)}N.push(H.HY.from(j))}y=N,f=S}return{width:C,height:f,rows:y}}(M,nt.right-nt.left,nt.bottom-nt.top),De(C.state,C.dispatch,Z,nt,M),!0}if(M){let N=yt(C.state),Z=N.start(-1);return De(C.state,C.dispatch,Z,ut.get(N.node(-1)).findCell(N.pos-Z),M),!0}return!1}function Re(C,f){if(f.ctrlKey||f.metaKey)return;let M,y=$e(C,f.target);if(f.shiftKey&&C.state.selection instanceof W)S(C.state.selection.$anchorCell,f),f.preventDefault();else if(f.shiftKey&&y&&null!=(M=it(C.state.selection.$anchor))&&_e(C,f).pos!=M.pos)S(M,f),f.preventDefault();else if(!y)return;function S(nt,j){let rt=_e(C,j),At=null==Q.getState(C.state);if(!rt||!Nt(nt,rt)){if(!At)return;rt=nt}let Bt=new W(nt,rt);if(At||!C.state.selection.eq(Bt)){let Ut=C.state.tr.setSelection(Bt);At&&Ut.setMeta(Q,nt.pos),C.dispatch(Ut)}}function N(){C.root.removeEventListener("mouseup",N),C.root.removeEventListener("dragstart",N),C.root.removeEventListener("mousemove",Z),null!=Q.getState(C.state)&&C.dispatch(C.state.tr.setMeta(Q,-1))}function Z(nt){let rt,j=Q.getState(C.state);if(null!=j)rt=C.state.doc.resolve(j);else if($e(C,nt.target)!=y&&(rt=_e(C,f),!rt))return N();rt&&S(rt,nt)}C.root.addEventListener("mouseup",N),C.root.addEventListener("dragstart",N),C.root.addEventListener("mousemove",Z)}function Je(C,f,y){if(!(C.state.selection instanceof s.Bs))return null;let{$head:M}=C.state.selection;for(let S=M.depth-1;S>=0;S--){let N=M.node(S);if((y<0?M.index(S):M.indexAfter(S))!=(y<0?0:N.childCount))return null;if("cell"==N.type.spec.tableRole||"header_cell"==N.type.spec.tableRole){let nt=M.before(S);return C.endOfTextblock("vert"==f?y>0?"down":"up":y>0?"right":"left")?nt:null}}return null}function $e(C,f){for(;f&&f!=C.dom;f=f.parentNode)if("TD"==f.nodeName||"TH"==f.nodeName)return f}function _e(C,f){let y=C.posAtCoords({left:f.clientX,top:f.clientY});return y&&y?it(C.state.doc.resolve(y.pos)):null}const Ce=new s.H$("fix-tables");function Pe(C,f,y,M){let S=C.childCount,N=f.childCount;t:for(let Z=0,nt=0;Z<N;Z++){let j=f.child(Z);for(let rt=nt,At=Math.min(S,Z+3);rt<At;rt++)if(C.child(rt)==j){nt=rt+1,y+=j.nodeSize;continue t}M(j,y),nt<S&&C.child(nt).sameMarkup(j)?Pe(C.child(nt),j,y+1,M):j.nodesBetween(0,j.content.size,M,y+1),y+=j.nodeSize}}function G(C,f){let y,M=(S,N)=>{"table"==S.type.spec.tableRole&&(y=function(C,f,y,M){let S=ut.get(f);if(!S.problems)return M;M||(M=C.tr);let Z,nt,N=[];for(let j=0;j<S.height;j++)N.push(0);for(let j=0;j<S.problems.length;j++){let rt=S.problems[j];if("collision"==rt.type){let At=f.nodeAt(rt.pos);for(let Bt=0;Bt<At.attrs.rowspan;Bt++)N[rt.row+Bt]+=rt.n;M.setNodeMarkup(M.mapping.map(y+1+rt.pos),null,et(At.attrs,At.attrs.colspan-rt.n,rt.n))}else if("missing"==rt.type)N[rt.row]+=rt.n;else if("overlong_rowspan"==rt.type){let At=f.nodeAt(rt.pos);M.setNodeMarkup(M.mapping.map(y+1+rt.pos),null,A(At.attrs,"rowspan",At.attrs.rowspan-rt.n))}else if("colwidth mismatch"==rt.type){let At=f.nodeAt(rt.pos);M.setNodeMarkup(M.mapping.map(y+1+rt.pos),null,A(At.attrs,"colwidth",rt.colwidth))}}for(let j=0;j<N.length;j++)N[j]&&(null==Z&&(Z=j),nt=j);for(let j=0,rt=y+1;j<S.height;j++){let At=f.child(j),Bt=rt+At.nodeSize,Ut=N[j];if(Ut>0){let jt="cell";At.firstChild&&(jt=At.firstChild.type.spec.tableRole);let Vt=[];for(let ae=0;ae<Ut;ae++)Vt.push(X(C.schema)[jt].createAndFill());M.insert(M.mapping.map(0!=j&&Z!=j-1||nt!=j?Bt-1:rt+1),Vt)}rt=Bt}return M.setMeta(Ce,{fixTables:!0})}(C,S,N,y))};return f?f.doc!=C.doc&&Pe(f.doc,C.doc,0,M):C.doc.descendants(M),y}function D(C){let Z,f=C.selection,y=yt(C),M=y.node(-1),S=y.start(-1),N=ut.get(M);return Z=f instanceof W?N.rectBetween(f.$anchorCell.pos-S,f.$headCell.pos-S):N.findCell(y.pos-S),Z.tableStart=S,Z.map=N,Z.table=M,Z}function B(C,{map:f,tableStart:y,table:M},S){let N=S>0?-1:0;(function(C,f,y){let M=X(f.type.schema).header_cell;for(let S=0;S<C.height;S++)if(f.nodeAt(C.map[y+S*C.width]).type!=M)return!1;return!0})(f,M,S+N)&&(N=0==S||S==f.width?null:0);for(let Z=0;Z<f.height;Z++){let nt=Z*f.width+S;if(S>0&&S<f.width&&f.map[nt-1]==f.map[nt]){let j=f.map[nt],rt=M.nodeAt(j);C.setNodeMarkup(C.mapping.map(y+j),null,at(rt.attrs,S-f.colCount(j))),Z+=rt.attrs.rowspan-1}else{let j=null==N?X(M.type.schema).cell:M.nodeAt(f.map[nt+N]).type,rt=f.positionAt(Z,S,M);C.insert(C.mapping.map(y+rt),j.createAndFill())}}return C}function U(C,{map:f,table:y,tableStart:M},S){let N=C.mapping.maps.length;for(let Z=0;Z<f.height;){let nt=Z*f.width+S,j=f.map[nt],rt=y.nodeAt(j);if(S>0&&f.map[nt-1]==j||S<f.width-1&&f.map[nt+1]==j)C.setNodeMarkup(C.mapping.slice(N).map(M+j),null,et(rt.attrs,S-f.colCount(j)));else{let At=C.mapping.slice(N).map(M+j);C.delete(At,At+rt.nodeSize)}Z+=rt.attrs.rowspan}}function Wt(C,{map:f,tableStart:y,table:M},S){let N=y;for(let j=0;j<S;j++)N+=M.child(j).nodeSize;let Z=[],nt=S>0?-1:0;(function(C,f,y){let M=X(f.type.schema).header_cell;for(let S=0;S<C.width;S++)if(f.nodeAt(C.map[S+y*C.width]).type!=M)return!1;return!0})(f,M,S+nt)&&(nt=0==S||S==f.height?null:0);for(let j=0,rt=f.width*S;j<f.width;j++,rt++)if(S>0&&S<f.height&&f.map[rt]==f.map[rt-f.width]){let At=f.map[rt],Bt=M.nodeAt(At).attrs;C.setNodeMarkup(y+At,null,A(Bt,"rowspan",Bt.rowspan+1)),j+=Bt.colspan-1}else{let At=null==nt?X(M.type.schema).cell:M.nodeAt(f.map[rt+nt*f.width]).type;Z.push(At.createAndFill())}return C.insert(N,X(M.type.schema).row.create(null,Z)),C}function z(C,{map:f,table:y,tableStart:M},S){let N=0;for(let j=0;j<S;j++)N+=y.child(j).nodeSize;let Z=N+y.child(S).nodeSize,nt=C.mapping.maps.length;C.delete(N+M,Z+M);for(let j=0,rt=S*f.width;j<f.width;j++,rt++){let At=f.map[rt];if(S>0&&At==f.map[rt-f.width]){let Bt=y.nodeAt(At).attrs;C.setNodeMarkup(C.mapping.slice(nt).map(At+M),null,A(Bt,"rowspan",Bt.rowspan-1)),j+=Bt.colspan-1}else if(S<f.width&&At==f.map[rt+f.width]){let Bt=y.nodeAt(At),Ut=Bt.type.create(A(Bt.attrs,"rowspan",Bt.attrs.rowspan-1),Bt.content),jt=f.positionAt(S+1,j,y);C.insert(C.mapping.slice(nt).map(M+jt),Ut),j+=Bt.attrs.colspan-1}}}function u(C){let f=C.content;return 1==f.childCount&&f.firstChild.isTextblock&&0==f.firstChild.childCount}function O(C,f){let y=C.selection;if(!(y instanceof W)||y.$anchorCell.pos==y.$headCell.pos)return!1;let M=D(C),{map:S}=M;if(function({width:C,height:f,map:y},M){let S=M.top*C+M.left,N=S,Z=(M.bottom-1)*C+M.left,nt=S+(M.right-M.left-1);for(let j=M.top;j<M.bottom;j++){if(M.left>0&&y[N]==y[N-1]||M.right<C&&y[nt]==y[nt+1])return!0;N+=C,nt+=C}for(let j=M.left;j<M.right;j++){if(M.top>0&&y[S]==y[S-C]||M.bottom<f&&y[Z]==y[Z+C])return!0;S++,Z++}return!1}(S,M))return!1;if(f){let j,rt,N=C.tr,Z={},nt=H.HY.empty;for(let At=M.top;At<M.bottom;At++)for(let Bt=M.left;Bt<M.right;Bt++){let Ut=S.map[At*S.width+Bt],jt=M.table.nodeAt(Ut);if(!Z[Ut])if(Z[Ut]=!0,null==j)j=Ut,rt=jt;else{u(jt)||(nt=nt.append(jt.content));let Vt=N.mapping.map(Ut+M.tableStart);N.delete(Vt,Vt+jt.nodeSize)}}if(N.setNodeMarkup(j+M.tableStart,null,A(at(rt.attrs,rt.attrs.colspan,M.right-M.left-rt.attrs.colspan),"rowspan",M.bottom-M.top)),nt.size){let At=j+1+rt.content.size,Bt=u(rt)?j+1:At;N.replaceWith(Bt+M.tableStart,At+M.tableStart,nt)}N.setSelection(new W(N.doc.resolve(j+M.tableStart))),f(N)}return!0}function L(C,f){const y=X(C.schema);return function(C){return(f,y)=>{let S,N,M=f.selection;if(M instanceof W){if(M.$anchorCell.pos!=M.$headCell.pos)return!1;S=M.$anchorCell.nodeAfter,N=M.$anchorCell.pos}else{if(S=function(C){for(let f=C.depth;f>0;f--){const y=C.node(f).type.spec.tableRole;if("cell"===y||"header_cell"===y)return C.node(f)}return null}(M.$from),!S)return!1;N=it(M.$from).pos}if(1==S.attrs.colspan&&1==S.attrs.rowspan)return!1;if(y){let Z=S.attrs,nt=[],j=Z.colwidth;Z.rowspan>1&&(Z=A(Z,"rowspan",1)),Z.colspan>1&&(Z=A(Z,"colspan",1));let Bt,rt=D(f),At=f.tr;for(let Ut=0;Ut<rt.right-rt.left;Ut++)nt.push(j?A(Z,"colwidth",j&&j[Ut]?[j[Ut]]:null):Z);for(let Ut=rt.top;Ut<rt.bottom;Ut++){let jt=rt.map.positionAt(Ut,rt.left,rt.table);Ut==rt.top&&(jt+=S.nodeSize);for(let Vt=rt.left,oe=0;Vt<rt.right;Vt++,oe++)Vt==rt.left&&Ut==rt.top||At.insert(Bt=At.mapping.map(jt+rt.tableStart,1),C({node:S,row:Ut,col:Vt}).createAndFill(nt[oe]))}At.setNodeMarkup(N,C({node:S,row:rt.top,col:rt.left}),nt[0]),M instanceof W&&At.setSelection(new W(At.doc.resolve(M.$anchorCell.pos),Bt&&At.doc.resolve(Bt))),y(At)}return!0}}(({node:M})=>y[M.type.spec.tableRole])(C,f)}function Yt(C,f,y){const M=f.map.cellsInRect({left:0,top:0,right:"row"==C?f.map.width:1,bottom:"column"==C?f.map.height:1});for(let S=0;S<M.length;S++){const N=f.table.nodeAt(M[S]);if(N&&N.type!==y.header_cell)return!1}return!0}function Gt(C,f){return(f=f||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(C){return function(f,y){if(!vt(f))return!1;if(y){let M=X(f.schema),S=D(f),N=f.tr,Z=S.map.cellsInRect("column"==C?new ot(S.left,0,S.right,S.map.height):"row"==C?new ot(0,S.top,S.map.width,S.bottom):S),nt=Z.map(j=>S.table.nodeAt(j));for(let j=0;j<Z.length;j++)nt[j].type==M.header_cell&&N.setNodeMarkup(S.tableStart+Z[j],M.cell,nt[j].attrs);if(0==N.steps.length)for(let j=0;j<Z.length;j++)N.setNodeMarkup(S.tableStart+Z[j],M.header_cell,nt[j].attrs);y(N)}return!0}}(C):function(y,M){if(!vt(y))return!1;if(M){let S=X(y.schema),N=D(y),Z=y.tr,nt=Yt("row",N,S),j=Yt("column",N,S),At=("column"===C?nt:"row"===C&&j)?1:0,Bt="column"==C?new ot(0,At,1,N.map.height):"row"==C?new ot(At,0,N.map.width,1):N,Ut="column"==C?j?S.cell:S.header_cell:"row"==C?nt?S.cell:S.header_cell:S.cell;N.map.cellsInRect(Bt).forEach(jt=>{const Vt=jt+N.tableStart,oe=Z.doc.nodeAt(Vt);oe&&Z.setNodeMarkup(Vt,Ut,oe.attrs)}),M(Z)}return!0}}Gt("row",{useDeprecatedLogic:!0}),Gt("column",{useDeprecatedLogic:!0});let be=Gt("cell",{useDeprecatedLogic:!0});function Ge(C){return function(f,y){if(!vt(f))return!1;let M=function(C,f){if(f<0){let y=C.nodeBefore;if(y)return C.pos-y.nodeSize;for(let M=C.index(-1)-1,S=C.before();M>=0;M--){let N=C.node(-1).child(M);if(N.childCount)return S-1-N.lastChild.nodeSize;S-=N.nodeSize}}else{if(C.index()<C.parent.childCount-1)return C.pos+C.nodeAfter.nodeSize;let y=C.node(-1);for(let M=C.indexAfter(-1),S=C.after();M<y.childCount;M++){let N=y.child(M);if(N.childCount)return S+1;S+=N.nodeSize}}}(yt(f),C);if(null!=M){if(y){let S=f.doc.resolve(M);y(f.tr.setSelection(s.Bs.between(S,function(C){return C.node(0).resolve(C.pos+C.nodeAfter.nodeSize)}(S))).scrollIntoView())}return!0}}}class vn{constructor(f,y){this.node=f,this.cellMinWidth=y,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),dn(f,this.colgroup,this.table,y),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(f){return f.type==this.node.type&&(this.node=f,dn(f,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(f){return"attributes"==f.type&&(f.target==this.table||this.colgroup.contains(f.target))}}function dn(C,f,y,M,S,N){let Z=0,nt=!0,j=f.firstChild,rt=C.firstChild;for(let At=0,Bt=0;At<rt.childCount;At++){let{colspan:Ut,colwidth:jt}=rt.child(At).attrs;for(let Vt=0;Vt<Ut;Vt++,Bt++){let oe=S==Bt?N:jt&&jt[Vt],ae=oe?oe+"px":"";Z+=oe||M,oe||(nt=!1),j?(j.style.width!=ae&&(j.style.width=ae),j=j.nextSibling):f.appendChild(document.createElement("col")).style.width=ae}}for(;j;){let At=j.nextSibling;j.parentNode.removeChild(j),j=At}nt?(y.style.width=Z+"px",y.style.minWidth=""):(y.style.width="",y.style.minWidth=Z+"px")}const ge=new s.H$("tableColumnResizing");function un({handleWidth:C=5,cellMinWidth:f=25,View:y=vn,lastColumnResizable:M=!0}={}){return new s.Sy({key:ge,state:{init(N,Z){return this.spec.props.nodeViews[X(Z.schema).table.name]=(nt,j)=>new y(nt,f,j),new Le(-1,!1)},apply:(N,Z)=>Z.apply(N)},props:{attributes:N=>ge.getState(N).activeHandle>-1?{class:"resize-cursor"}:null,handleDOMEvents:{mousemove(N,Z){!function(C,f,y,M,S){let N=ge.getState(C.state);if(!N.dragging){let Z=function(C){for(;C&&"TD"!=C.nodeName&&"TH"!=C.nodeName;)C=C.classList.contains("ProseMirror")?null:C.parentNode;return C}(f.target),nt=-1;if(Z){let{left:j,right:rt}=Z.getBoundingClientRect();f.clientX-j<=y?nt=ln(C,f,"left"):rt-f.clientX<=y&&(nt=ln(C,f,"right"))}if(nt!=N.activeHandle){if(!S&&-1!==nt){let j=C.state.doc.resolve(nt),rt=j.node(-1),At=ut.get(rt),Bt=j.start(-1);if(At.colCount(j.pos-Bt)+j.nodeAfter.attrs.colspan-1==At.width-1)return}Mn(C,nt)}}}(N,Z,C,0,M)},mouseleave(N){!function(C){let f=ge.getState(C.state);f.activeHandle>-1&&!f.dragging&&Mn(C,-1)}(N)},mousedown(N,Z){!function(C,f,y){let M=ge.getState(C.state);if(-1==M.activeHandle||M.dragging)return!1;let S=C.state.doc.nodeAt(M.activeHandle),N=function(C,f,{colspan:y,colwidth:M}){let S=M&&M[M.length-1];if(S)return S;let N=C.domAtPos(f),nt=N.node.childNodes[N.offset].offsetWidth,j=y;if(M)for(let rt=0;rt<y;rt++)M[rt]&&(nt-=M[rt],j--);return nt/j}(C,M.activeHandle,S.attrs);function Z(j){window.removeEventListener("mouseup",Z),window.removeEventListener("mousemove",nt);let rt=ge.getState(C.state);rt.dragging&&(function(C,f,y){let M=C.state.doc.resolve(f),S=M.node(-1),N=ut.get(S),Z=M.start(-1),nt=N.colCount(M.pos-Z)+M.nodeAfter.attrs.colspan-1,j=C.state.tr;for(let rt=0;rt<N.height;rt++){let At=rt*N.width+nt;if(rt&&N.map[At]==N.map[At-N.width])continue;let Bt=N.map[At],{attrs:Ut}=S.nodeAt(Bt),jt=1==Ut.colspan?0:nt-N.colCount(Bt);if(Ut.colwidth&&Ut.colwidth[jt]==y)continue;let Vt=Ut.colwidth?Ut.colwidth.slice():qe(Ut.colspan);Vt[jt]=y,j.setNodeMarkup(Z+Bt,null,A(Ut,"colwidth",Vt))}j.docChanged&&C.dispatch(j)}(C,rt.activeHandle,ke(rt.dragging,j,y)),C.dispatch(C.state.tr.setMeta(ge,{setDragging:null})))}function nt(j){if(!j.which)return Z(j);let rt=ge.getState(C.state),At=ke(rt.dragging,j,y);!function(C,f,y,M){let S=C.state.doc.resolve(f),N=S.node(-1),Z=S.start(-1),nt=ut.get(N).colCount(S.pos-Z)+S.nodeAfter.attrs.colspan-1,j=C.domAtPos(S.start(-1)).node;for(;"TABLE"!=j.nodeName;)j=j.parentNode;dn(N,j.firstChild,j,M,nt,y)}(C,rt.activeHandle,At,y)}C.dispatch(C.state.tr.setMeta(ge,{setDragging:{startX:f.clientX,startWidth:N}})),window.addEventListener("mouseup",Z),window.addEventListener("mousemove",nt),f.preventDefault()}(N,Z,f)}},decorations(N){let Z=ge.getState(N);if(Z.activeHandle>-1)return function(C,f){let y=[],M=C.doc.resolve(f),S=M.node(-1),N=ut.get(S),Z=M.start(-1),nt=N.colCount(M.pos-Z)+M.nodeAfter.attrs.colspan;for(let j=0;j<N.height;j++){let rt=nt+j*N.width-1;if(!(nt!=N.width&&N.map[rt]==N.map[rt+1]||0!=j&&N.map[rt-1]==N.map[rt-1-N.width])){let At=N.map[rt],Bt=Z+At+S.nodeAt(At).nodeSize-1,Ut=document.createElement("div");Ut.className="column-resize-handle",y.push(m.p.widget(Bt,Ut))}}return m.EH.create(C.doc,y)}(N,Z.activeHandle)},nodeViews:{}}})}class Le{constructor(f,y){this.activeHandle=f,this.dragging=y}apply(f){let y=this,M=f.getMeta(ge);if(M&&null!=M.setHandle)return new Le(M.setHandle,null);if(M&&void 0!==M.setDragging)return new Le(y.activeHandle,M.setDragging);if(y.activeHandle>-1&&f.docChanged){let S=f.mapping.map(y.activeHandle,-1);Dt(f.doc.resolve(S))||(S=null),y=new Le(S,y.dragging)}return y}}function ln(C,f,y){let M=C.posAtCoords({left:f.clientX,top:f.clientY});if(!M)return-1;let{pos:S}=M,N=it(C.state.doc.resolve(S));if(!N)return-1;if("right"==y)return N.pos;let Z=ut.get(N.node(-1)),nt=N.start(-1),j=Z.map.indexOf(N.pos-nt);return j%Z.width==0?-1:nt+Z.map[j-1]}function ke(C,f,y){return Math.max(y,C.startWidth+(f.clientX-C.startX))}function Mn(C,f){C.dispatch(C.state.tr.setMeta(ge,{setHandle:f}))}function qe(C){let f=[];for(let y=0;y<C;y++)f.push(0);return f}function pn({allowTableNodeSelection:C=!1}={}){return new s.Sy({key:Q,state:{init:()=>null,apply(f,y){let M=f.getMeta(Q);if(null!=M)return-1==M?null:M;if(null==y||!f.docChanged)return y;let{deleted:S,pos:N}=f.mapping.mapResult(y);return S?null:N}},props:{decorations:dt,handleDOMEvents:{mousedown:Re},createSelectionBetween(f){if(null!=Q.getState(f.state))return f.state.selection},handleTripleClick:ze,handleKeyDown:Ie,handlePaste:Ee},appendTransaction:(f,y,M)=>function(C,f,y){let N,Z,M=(f||C).selection,S=(f||C).doc;if(M instanceof s.qv&&(Z=M.node.type.spec.tableRole)){if("cell"==Z||"header_cell"==Z)N=W.create(S,M.from);else if("row"==Z){let nt=S.resolve(M.from+1);N=W.rowSelection(nt,nt)}else if(!y){let nt=ut.get(M.node),j=M.from+1;N=W.create(S,j+1,j+nt.map[nt.width*nt.height-1])}}else M instanceof s.Bs&&function({$from:C,$to:f}){if(C.pos==f.pos||C.pos<C.pos-6)return!1;let y=C.pos,M=f.pos,S=C.depth;for(;S>=0&&!(C.after(S+1)<C.end(S));S--,y++);for(let N=f.depth;N>=0&&!(f.before(N+1)>f.start(N));N--,M--);return y==M&&/row|table/.test(C.node(S).type.spec.tableRole)}(M)?N=s.Bs.create(S,M.from):M instanceof s.Bs&&function({$from:C,$to:f}){let y,M;for(let S=C.depth;S>0;S--){let N=C.node(S);if("cell"===N.type.spec.tableRole||"header_cell"===N.type.spec.tableRole){y=N;break}}for(let S=f.depth;S>0;S--){let N=f.node(S);if("cell"===N.type.spec.tableRole||"header_cell"===N.type.spec.tableRole){M=N;break}}return y!==M&&0===f.parentOffset}(M)&&(N=s.Bs.create(S,M.$from.start(),M.$from.end()));return N&&(f||(f=C.tr)).setSelection(N),f}(M,G(M,y),C)})}function hn(C,f,y,M,S,N){let Z=0,nt=!0,j=f.firstChild;const rt=C.firstChild;for(let At=0,Bt=0;At<rt.childCount;At+=1){const{colspan:Ut,colwidth:jt}=rt.child(At).attrs;for(let Vt=0;Vt<Ut;Vt+=1,Bt+=1){const oe=S===Bt?N:jt&&jt[Vt],ae=oe?`${oe}px`:"";Z+=oe||M,oe||(nt=!1),j?(j.style.width!==ae&&(j.style.width=ae),j=j.nextSibling):f.appendChild(document.createElement("col")).style.width=ae}}for(;j;){const At=j.nextSibling;j.parentNode.removeChild(j),j=At}nt?(y.style.width=`${Z}px`,y.style.minWidth=""):(y.style.width="",y.style.minWidth=`${Z}px`)}class on{constructor(f,y){this.node=f,this.cellMinWidth=y,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),hn(f,this.colgroup,this.table,y),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(f){return f.type===this.node.type&&(this.node=f,hn(f,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(f){return"attributes"===f.type&&(f.target===this.table||this.colgroup.contains(f.target))}}function ye(C,f){return f?C.createChecked(null,f):C.createAndFill()}const Ze=({editor:C})=>{const{selection:f}=C.state;if(!function(C){return C instanceof W}(f))return!1;let y=0;const M=(0,T.findParentNodeClosestToPos)(f.ranges[0].$from,N=>"table"===N.type.name);return null==M||M.node.descendants(N=>{if("table"===N.type.name)return!1;["tableCell","tableHeader"].includes(N.type.name)&&(y+=1)}),y===f.ranges.length&&(C.commands.deleteTable(),!0)},Be=T.Node.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:on,lastColumnResizable:!0,allowTableNodeSelection:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({HTMLAttributes:C}){return["table",(0,T.mergeAttributes)(this.options.HTMLAttributes,C),["tbody",0]]},addCommands:()=>({insertTable:({rows:C=3,cols:f=3,withHeaderRow:y=!0}={})=>({tr:M,dispatch:S,editor:N})=>{const Z=function(C,f,y,M,S){const N=function(C){if(C.cached.tableNodeTypes)return C.cached.tableNodeTypes;const f={};return Object.keys(C.nodes).forEach(y=>{const M=C.nodes[y];M.spec.tableRole&&(f[M.spec.tableRole]=M)}),C.cached.tableNodeTypes=f,f}(C),Z=[],nt=[];for(let rt=0;rt<y;rt+=1){const At=ye(N.cell,S);if(At&&nt.push(At),M){const Bt=ye(N.header_cell,S);Bt&&Z.push(Bt)}}const j=[];for(let rt=0;rt<f;rt+=1)j.push(N.row.createChecked(null,M&&0===rt?Z:nt));return N.table.createChecked(null,j)}(N.schema,C,f,y);if(S){const nt=M.selection.anchor+1;M.replaceSelectionWith(Z).scrollIntoView().setSelection(s.Bs.near(M.doc.resolve(nt)))}return!0},addColumnBefore:()=>({state:C,dispatch:f})=>function(C,f){if(!vt(C))return!1;if(f){let y=D(C);f(B(C.tr,y,y.left))}return!0}(C,f),addColumnAfter:()=>({state:C,dispatch:f})=>function(C,f){if(!vt(C))return!1;if(f){let y=D(C);f(B(C.tr,y,y.right))}return!0}(C,f),deleteColumn:()=>({state:C,dispatch:f})=>function(C,f){if(!vt(C))return!1;if(f){let y=D(C),M=C.tr;if(0==y.left&&y.right==y.map.width)return!1;for(let S=y.right-1;U(M,y,S),S!=y.left;S--)y.table=y.tableStart?M.doc.nodeAt(y.tableStart-1):M.doc,y.map=ut.get(y.table);f(M)}return!0}(C,f),addRowBefore:()=>({state:C,dispatch:f})=>function(C,f){if(!vt(C))return!1;if(f){let y=D(C);f(Wt(C.tr,y,y.top))}return!0}(C,f),addRowAfter:()=>({state:C,dispatch:f})=>function(C,f){if(!vt(C))return!1;if(f){let y=D(C);f(Wt(C.tr,y,y.bottom))}return!0}(C,f),deleteRow:()=>({state:C,dispatch:f})=>function(C,f){if(!vt(C))return!1;if(f){let y=D(C),M=C.tr;if(0==y.top&&y.bottom==y.map.height)return!1;for(let S=y.bottom-1;z(M,y,S),S!=y.top;S--)y.table=y.tableStart?M.doc.nodeAt(y.tableStart-1):M.doc,y.map=ut.get(y.table);f(M)}return!0}(C,f),deleteTable:()=>({state:C,dispatch:f})=>function(C,f){let y=C.selection.$anchor;for(let M=y.depth;M>0;M--)if("table"==y.node(M).type.spec.tableRole)return f&&f(C.tr.delete(y.before(M),y.after(M)).scrollIntoView()),!0;return!1}(C,f),mergeCells:()=>({state:C,dispatch:f})=>O(C,f),splitCell:()=>({state:C,dispatch:f})=>L(C,f),toggleHeaderColumn:()=>({state:C,dispatch:f})=>Gt("column")(C,f),toggleHeaderRow:()=>({state:C,dispatch:f})=>Gt("row")(C,f),toggleHeaderCell:()=>({state:C,dispatch:f})=>be(C,f),mergeOrSplit:()=>({state:C,dispatch:f})=>!!O(C,f)||L(C,f),setCellAttribute:(C,f)=>({state:y,dispatch:M})=>function(C,f){return function(y,M){if(!vt(y))return!1;let S=yt(y);if(S.nodeAfter.attrs[C]===f)return!1;if(M){let N=y.tr;y.selection instanceof W?y.selection.forEachCell((Z,nt)=>{Z.attrs[C]!==f&&N.setNodeMarkup(nt,null,A(Z.attrs,C,f))}):N.setNodeMarkup(S.pos,null,A(S.nodeAfter.attrs,C,f)),M(N)}return!0}}(C,f)(y,M),goToNextCell:()=>({state:C,dispatch:f})=>Ge(1)(C,f),goToPreviousCell:()=>({state:C,dispatch:f})=>Ge(-1)(C,f),fixTables:()=>({state:C,dispatch:f})=>(f&&G(C),!0),setCellSelection:C=>({tr:f,dispatch:y})=>{if(y){const M=W.create(f.doc,C.anchorCell,C.headCell);f.setSelection(M)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Ze,"Mod-Backspace":Ze,Delete:Ze,"Mod-Delete":Ze}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[un({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],pn({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema:C=>({tableRole:(0,T.callOrReturn)((0,T.getExtensionField)(C,"tableRole",{name:C.name,options:C.options,storage:C.storage}))})}).extend({renderHTML({node:C,HTMLAttributes:f}){var y,M;let S=0,N=!0;try{const Z=(null===(y=C.content)||void 0===y?void 0:y.content)[0];null===(M=null==Z?void 0:Z.content)||void 0===M||M.content.forEach(nt=>{nt.attrs.colwidth?nt.attrs.colwidth.forEach(j=>{j?S+=j:(N=!1,S+=this.options.cellMinWidth)}):(N=!1,S+=this.options.cellMinWidth*(nt.attrs.colspan?nt.attrs.colspan:1))})}catch(Z){N=!1}return f.style=N&&S>0?`width: ${S}px;`:S&&S>0?`min-width: ${S}px`:null,["div",{class:"tui-table-wrapper"},["table",(0,T.mergeAttributes)(this.options.HTMLAttributes,f),["tbody",0]]]}})},88806:(Kt,Mt,d)=>{d.d(Mt,{v:()=>s});var T=d(74788);class s{constructor(P,m,ct){const I=m.get(T.z2F),ot=m.get(T._Vd).resolveComponentFactory(P);this.componentRef=ot.create(m,[]),this.updateProps(ct),I.attachView(this.componentRef.hostView)}get instance(){return this.componentRef.instance}get elementRef(){return this.componentRef.injector.get(T.SBq)}get dom(){return this.elementRef.nativeElement}updateProps(P){Object.entries(P).forEach(([m,ct])=>{this.instance[m]=ct})}detectChanges(){this.componentRef.changeDetectorRef.detectChanges()}destroy(){this.componentRef.destroy()}}},40400:(Kt,Mt,d)=>{d.d(Mt,{d:()=>P,x:()=>ct});var T=d(12057),s=d(40256),H=d(88806);class P{}class m extends s.NodeView{constructor(){super(...arguments),this.contentDOMElement=null}mount(){const pt=this.options.injector,ot=pt.get(T.K0);this.renderer=new H.v(this.component,pt,{editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(ht={})=>this.updateAttributes(ht),deleteNode:()=>this.deleteNode()}),this.extension.config.draggable&&(this.renderer.elementRef.nativeElement.ondragstart=ht=>{this.onDragStart(ht)}),this.contentDOMElement=this.node.isLeaf?null:ot.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit",this.renderer.detectChanges())}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}update(pt,ot){return this.options.update?this.options.update(pt,ot):pt.type===this.node.type&&(pt===this.node&&this.decorations===ot||(this.node=pt,this.decorations=ot,this.renderer.updateProps({node:pt,decorations:ot}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy()}maybeMoveContentDOM(){const pt=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&pt&&!pt.contains(this.contentDOMElement)&&pt.appendChild(this.contentDOMElement)}}const ct=(I,pt)=>ot=>new m(I,ot,pt)},70224:(Kt,Mt,d)=>{d.r(Mt),d.d(Mt,{BackgroundColor:()=>vt.BackgroundColor,EDITOR_BLANK_COLOR:()=>it.hK,FontColor:()=>Pt.FontColor,INITIALIZATION_TIPTAP_CONTAINER:()=>Tt.Y1,LAZY_EDITOR_EXTENSIONS:()=>Tt.F4,LAZY_TIPTAP_EDITOR:()=>Tt.bG,StarterKit:()=>ee.StarterKit,TIPTAP_EDITOR:()=>Tt.ZW,TUI_EDITOR_CODE_OPTIONS:()=>Tt.Mr,TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES:()=>Tt.dj,TUI_EDITOR_CONTENT_PROCESSOR:()=>Tt.F1,TUI_EDITOR_DEFAULT_OPTIONS:()=>Tt.HG,TUI_EDITOR_EXTENSIONS:()=>Tt.Wf,TUI_EDITOR_FONT_OPTIONS:()=>Tt.UN,TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>bt.TUI_EDITOR_GROUP_DEFAULT_OPTIONS,TUI_EDITOR_MAX_IMAGE_WIDTH:()=>Nt.TUI_EDITOR_MAX_IMAGE_WIDTH,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>Nt.TUI_EDITOR_MIN_IMAGE_WIDTH,TUI_EDITOR_OPTIONS:()=>Tt.mJ,TUI_EDITOR_PROVIDERS:()=>mt.m,TUI_EDITOR_TABLE_COMMANDS:()=>Tt.$i,TUI_EDITOR_TOOLBAR_TEXTS:()=>Tt.rf,TUI_IMAGE_LOADER:()=>Tt.p7,TableCellBackground:()=>A.TableCellBackground,TuiAlignContentComponent:()=>Q.Xp,TuiAlignContentModule:()=>Q.pu,TuiCodeComponent:()=>Q.Tf,TuiCodeModule:()=>Q.P_,TuiColorEditComponent:()=>T.hR,TuiColorEditModule:()=>T.TD,TuiColorPickerComponent:()=>T.$v,TuiColorPickerModule:()=>T.H9,TuiColorSelectorComponent:()=>T.sV,TuiColorSelectorModule:()=>T.wl,TuiComponentRenderer:()=>et.v,TuiDetailsComponent:()=>Q.yj,TuiDetailsModule:()=>Q.y9,TuiDetailsRemoveComponent:()=>Q.Un,TuiEditLinkComponent:()=>s.l,TuiEditLinkModule:()=>s.F,TuiEditorComponent:()=>H.a,TuiEditorGroupToolComponent:()=>Q.dN,TuiEditorImagePreviewDirective:()=>ot.Zj,TuiEditorImagePreviewModule:()=>ot.BN,TuiEditorModule:()=>xt,TuiEditorPortalDirective:()=>gt.A,TuiEditorPortalHostComponent:()=>Ot.d,TuiEditorPortalService:()=>wt.Y,TuiEditorSocketComponent:()=>m.D,TuiEditorSocketModule:()=>I,TuiEditorTool:()=>K._,TuiEditorToolGroup:()=>Q.jP,TuiFlatPickerComponent:()=>T.Jd,TuiFlatPickerModule:()=>T.ui,TuiFontSize:()=>Dt.TuiFontSize,TuiFontSizeComponent:()=>Q.mK,TuiFontSizeModule:()=>Q.p7,TuiFontStyleComponent:()=>Q.hr,TuiFontStyleModule:()=>Q.Zv,TuiHighlightColorComponent:()=>Q.UT,TuiHighlightColorModule:()=>Q.XC,TuiImageEditorComponent:()=>Nt.TuiImageEditorComponent,TuiImageEditorModule:()=>Nt.TuiImageEditorModule,TuiInputColorComponent:()=>Et.j,TuiInputColorModule:()=>X,TuiLinearMultiPickerComponent:()=>T.es,TuiLinearMultiPickerModule:()=>T.GU,TuiLinearPickerComponent:()=>T.P,TuiLinearPickerModule:()=>T.g7,TuiListConfigsComponent:()=>Q.w2,TuiListConfigsModule:()=>Q.Ur,TuiNodeViewNgComponent:()=>at.d,TuiNodeViewRenderer:()=>at.x,TuiPaletteComponent:()=>T.Rh,TuiPaletteModule:()=>T.VM,TuiTabExtension:()=>zt.TuiTabExtension,TuiTable:()=>ft.TuiTable,TuiTableCellColorComponent:()=>Q.pH,TuiTableCellColorModule:()=>Q.mp,TuiTableCommands:()=>Q.iN,TuiTableCreateComponent:()=>Q.lT,TuiTableCreateModule:()=>Q.iA,TuiTableMergeCellsComponent:()=>Q.YH,TuiTableMergeCellsModule:()=>Q.er,TuiTableRowColumnManagerComponent:()=>Q._I,TuiTableRowColumnManagerModule:()=>Q.__,TuiTableSizeSelectorComponent:()=>Q.M8,TuiTableSizeSelectorModule:()=>Q.kU,TuiTextColorComponent:()=>Q.G0,TuiTextColorModule:()=>Q._t,TuiTiptapEditorDirective:()=>ot.JU,TuiTiptapEditorModule:()=>ot.mJ,TuiTiptapEditorService:()=>ot.$3,TuiToolbarComponent:()=>pt.M6,TuiToolbarModule:()=>pt.yB,TuiToolbarNavigationManagerDirective:()=>pt.Bp,createGroupExtension:()=>bt.createGroupExtension,createImageEditorExtension:()=>Nt.createImageEditorExtension,defaultEditorColors:()=>it.sw,defaultEditorExtensions:()=>yt,defaultEditorTools:()=>it.Db,tuiDefaultFontOptionsHandler:()=>it.RR,tuiDeleteNode:()=>W.yU,tuiEditorOptionsProvider:()=>Tt.Uv,tuiGetElementPoint:()=>W.Ws,tuiGetGradientData:()=>W.U5,tuiGetMarkRange:()=>W.Yz,tuiGetSelectedContent:()=>W.Ap,tuiInsertHtml:()=>W.Xd,tuiInsertText:()=>W.Oi,tuiIsOrderedOrBulletList:()=>zt.tuiIsOrderedOrBulletList,tuiIsSafeLinkRange:()=>W.nC,tuiIsSelectionIn:()=>W.i0,tuiLegacyEditorConverter:()=>W.Er,tuiParseGradient:()=>W._N,tuiToGradient:()=>W.CH});var T=d(27050),s=d(71115),H=d(69303),P=d(12057),m=d(20179),ct=d(74788);let I=(()=>{class J{}return J.\u0275fac=function(Lt){return new(Lt||J)},J.\u0275mod=ct.oAB({type:J}),J.\u0275inj=ct.cJS({}),J})();var pt=d(17406),ot=d(40632),ut=d(36692),ht=d(72002);let xt=(()=>{class J{}return J.\u0275fac=function(Lt){return new(Lt||J)},J.\u0275mod=ct.oAB({type:J}),J.\u0275inj=ct.cJS({imports:[[P.ez,pt.yB,ht.TuiWrapperModule,ht.TuiScrollbarModule,s.F,ut.TuiActiveZoneModule,ht.TuiDropdownModule,ot.mJ,I,ut.TuiLetModule]]}),J})();var mt=d(79089),gt=d(1433),wt=d(73825),Ot=d(9872),Et=d(19769);let X=(()=>{class J{}return J.\u0275fac=function(Lt){return new(Lt||J)},J.\u0275mod=ct.oAB({type:J}),J.\u0275inj=ct.cJS({imports:[[P.ez,ht.TuiPrimitiveTextfieldModule,ht.TuiTextfieldControllerModule,ht.TuiHostedDropdownModule,T.wl,ut.TuiActiveZoneModule]]}),J})();var Q=d(93252),it=d(19074),K=d(48699),vt=d(15736);const yt=[Promise.resolve().then(d.bind(d,80726)).then(({StarterKit:J})=>J).then(J=>J.configure({heading:{levels:[1,2]}})),d.e(45861).then(d.bind(d,45861)).then(({default:J})=>J.configure({types:["heading","paragraph"]})),Promise.resolve().then(d.bind(d,74634)).then(({default:J})=>J),d.e(77008).then(d.bind(d,77008)).then(({default:J})=>J),d.e(91347).then(d.bind(d,91347)).then(({default:J})=>J),d.e(35609).then(d.bind(d,35609)).then(({default:J})=>J),Promise.resolve().then(d.bind(d,52658)).then(({FontColor:J})=>J),d.e(12955).then(d.bind(d,12955)).then(({default:J})=>J.configure({inline:!0})),d.e(63658).then(d.bind(d,63658)).then(({default:J})=>J.configure({openOnClick:!1})),Promise.resolve().then(d.bind(d,15736)).then(({BackgroundColor:J})=>J),Promise.resolve().then(d.bind(d,28279)).then(({TuiTable:J})=>J.configure({resizable:!0})),d.e(72219).then(d.bind(d,72219)).then(({default:J})=>J),d.e(74096).then(d.bind(d,74096)).then(({default:J})=>J),d.e(53107).then(d.bind(d,53107)).then(({TableHeader:J})=>J),Promise.resolve().then(d.bind(d,12177)).then(({TuiTabExtension:J})=>J),Promise.resolve().then(d.bind(d,51919)).then(({TableCellBackground:J})=>J),d.e(44312).then(d.bind(d,44312)).then(({TuiDetailsContent:J})=>J),d.e(44312).then(d.bind(d,44312)).then(({TuiDetails:J})=>J),d.e(44312).then(d.bind(d,44312)).then(({TuiSummary:J})=>J),Promise.resolve().then(d.bind(d,9492)).then(({TuiFontSize:J})=>J)];var Pt=d(52658),Dt=d(9492),bt=d(54920),Nt=d(25039),zt=d(12177),ee=d(80726),ft=d(28279),A=d(51919),et=d(88806),at=d(40400),Tt=d(62842),W=d(37631)},62141:(Kt,Mt,d)=>{d.d(Mt,{i:()=>ut});var T=d(12057),s=d(74788),H=d(37631),P=d(36692),m=d(18891),ct=d(43190),I=d(88002),pt=d(46782),ot=d(39761);let ut=(()=>{class ht extends m.y{constructor(mt,{nativeElement:gt},wt){const Ot=(0,P.tuiTypedFromEvent)(gt,"mousedown").pipe((0,P.tuiPreventDefault)(),(0,ct.w)(Et=>{const X=(0,P.tuiTypedFromEvent)(wt,"mousemove").pipe((0,I.U)(({clientX:Q,clientY:it})=>(0,H.Ws)(Q,it,gt)),(0,pt.R)((0,P.tuiTypedFromEvent)(wt,"mouseup")));return Et.target===gt?X.pipe((0,ot.O)((0,H.Ws)(Et.clientX,Et.clientY,gt))):X}),(0,pt.R)(mt));super(Et=>Ot.subscribe(Et))}}return ht.\u0275fac=function(mt){return new(mt||ht)(s.LFG(P.TuiDestroyService),s.LFG(s.SBq),s.LFG(T.K0))},ht.\u0275prov=s.Yz7({token:ht,factory:ht.\u0275fac}),ht})()},62842:(Kt,Mt,d)=>{d.d(Mt,{Y1:()=>vt,F4:()=>H,bG:()=>K,ZW:()=>it,Mr:()=>gt,dj:()=>ht,F1:()=>ot,HG:()=>m,Wf:()=>s,UN:()=>wt,mJ:()=>ct,$i:()=>mt,rf:()=>xt,p7:()=>X,Uv:()=>I});var T=d(74788);const s=new T.OlP("[TUI_EDITOR_EXTENSIONS]: Extensions for editor"),H=new T.OlP("[LAZY_EDITOR_EXTENSIONS]: lazy extensions");var P=d(19074);const m={colors:P.sw,blankColor:P.hK,fontOptions:P.RR},ct=new T.OlP("[TUI_EDITOR_OPTIONS]: Default Editor colors",{factory:()=>m});function I(yt){return{provide:ct,useValue:Object.assign(Object.assign({},m),yt)}}var pt=d(54487);const ot=new T.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]: Content value processor for tui-editor",{factory:()=>pt.y});var ut=d(72773);const ht=new T.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]: tui-color-selector i18n",{factory:()=>["Solid color","Gradient"]}),xt=new T.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]: tui-editor-toolbar i18n",{factory:(0,ut.vv)("toolbarTools")}),mt=new T.OlP("[TUI_EDITOR_TABLE_COMMANDS]: tui-editor-toolbar table i18n",{factory:(0,ut.vv)("editorTableCommands")}),gt=new T.OlP("[TUI_EDITOR_CODE_OPTIONS]: tui-editor-toolbar codes options",{factory:(0,ut.vv)("editorCodeOptions")}),wt=new T.OlP("[TUI_EDITOR_FONT_OPTIONS]: tui-editor-toolbar font options",{factory:(0,ut.vv)("editorFontOptions")});var Ot=d(36692),Et=d(88002);const X=new T.OlP("[TUI_IMAGE_LOADER]: Image loader handler",{factory:()=>yt=>{const Pt=new FileReader;return Pt.readAsDataURL(yt),(0,Ot.tuiTypedFromEvent)(Pt,"load").pipe((0,Et.U)(()=>String(Pt.result)))}});var Q=d(82298);const it=new T.OlP("[TIPTAP_EDITOR]: Token for Tiptap Editor"),K=new T.OlP("[LAZY_TIPTAP_EDITOR]: Lazy loaded Editor",{factory:()=>{const yt=new Q.t(1);return Promise.resolve().then(d.bind(d,40256)).then(Pt=>yt.next(Pt.Editor)),yt}}),vt=new T.OlP("[INITIALIZATION_TIPTAP_CONTAINER]: The container in which the tip-tap editor is initialized")},37631:(Kt,Mt,d)=>{function T(ft,A,et){const at=ft.selection.$anchor;for(let Tt=at.depth;Tt>0;Tt--)if(at.node(Tt).type.name===et)return A&&A(ft.tr.delete(at.before(Tt),at.after(Tt)).scrollIntoView()),!0;return!1}d.d(Mt,{yU:()=>T,Ws:()=>H,U5:()=>P,Yz:()=>I,Ap:()=>ot,Xd:()=>ut,Oi:()=>ht,nC:()=>zt,i0:()=>xt,Er:()=>mt,_N:()=>bt,CH:()=>ee});var s=d(36692);function H(ft,A,et){const{left:at,top:Tt,width:W,height:J}=et.getBoundingClientRect();return[(0,s.tuiClamp)(ft-at,0,W)/W,(0,s.tuiClamp)(A-Tt,0,J)/J]}function P(ft){return ft.slice(0,Math.max(0,ft.length-1)).replace("linear-gradient(","")}function ct(ft,A,et={}){return ft.find(({attrs:at,type:Tt})=>Tt===A&&function(ft,A){const et=Object.keys(A);return!et.length||!!et.filter(at=>A[at]===ft[at]).length}(at,et))||null}function I(ft,A,et={}){if(!ft||!A)return null;const{node:at,offset:Tt}=ft.parent.childAfter(ft.parentOffset);if(!at)return null;const W=ct(at.marks,A,et);if(!W)return null;let J=ft.index(),dt=ft.start()+Tt,Lt=J+1,Jt=dt+at.nodeSize;for(ct(at.marks,A,et);J>0&&W.isInSet(ft.parent.child(J-1).marks);)J-=1,dt-=ft.parent.child(J).nodeSize;for(;Lt<ft.parent.childCount&&ct(ft.parent.child(Lt).marks,A,et);)Jt+=ft.parent.child(Lt).nodeSize,Lt+=1;return{from:dt,to:Jt}}var pt=d(40256);function ot(ft,A){const et=null!=A?A:ft.selection.$head.parent.textContent,at=ft.doc.cut(ft.selection.from,ft.selection.to);return at.content.size?(0,pt.getHTMLFromFragment)(at.content,ft.schema):et}function ut(ft,A){if(ft.queryCommandSupported("insertHTML"))return void ft.execCommand("insertHTML",!1,A);const et=ft.getSelection();if(!et)throw new s.TuiDocumentSelectionException;ft.execCommand("ms-beginUndoUnit");const at=et.getRangeAt(0),Tt=at.createContextualFragment(A);at.deleteContents(),at.insertNode(Tt),ft.execCommand("ms-endUndoUnit")}function ht(ft,A){if(ft.queryCommandSupported("insertText"))return void ft.execCommand("insertText",!1,A);const et=ft.getSelection();if(!et)throw new s.TuiDocumentSelectionException;ft.execCommand("ms-beginUndoUnit");const at=et.getRangeAt(0);at.deleteContents(),at.insertNode(ft.createTextNode(A)),ft.execCommand("ms-endUndoUnit")}function xt({anchorNode:ft,focusNode:A},et){return!!ft&&!!A&&(0,s.tuiIsNodeIn)(ft,et)&&(0,s.tuiIsNodeIn)(A,et)}function mt(ft){const A=(new DOMParser).parseFromString(ft,"text/html");return gt(A.body),A.body.innerHTML}function gt(ft){for(const A of Array.from(ft.children))if(A.children.length&&gt(A),"FONT"===A.tagName)if(A.hasAttribute("size"))switch(A.getAttribute("size")){case"6":wt("h1",A);break;case"5":wt("h2",A);break;case"4":Ot("17px",A);break;case"3":Ot("15px",A);break;case"2":Ot("13px",A)}else A.hasAttribute("color")&&Et(A)}function wt(ft,A){var et,at,Tt,W,J,dt,Lt,Jt,qt;const ce=document.createElement(ft);if(ce.innerHTML=A.innerHTML,"P"===(null===(et=A.parentElement)||void 0===et?void 0:et.tagName)){const le=null===(Tt=null===(at=A.parentElement)||void 0===at?void 0:at.parentElement)||void 0===Tt?void 0:Tt.insertBefore(ce,A.parentElement);null===(W=A.parentElement)||void 0===W||W.removeChild(A),(null==le?void 0:le.nextSibling)&&!(null===(dt=null===(J=null==le?void 0:le.nextSibling)||void 0===J?void 0:J.textContent)||void 0===dt?void 0:dt.trim())&&(null===(Jt=null===(Lt=le.nextSibling)||void 0===Lt?void 0:Lt.parentElement)||void 0===Jt||Jt.removeChild(le.nextSibling))}else null===(qt=A.parentElement)||void 0===qt||qt.replaceChild(ce,A)}function Ot(ft,A){var et;const at=document.createElement("p"),Tt=document.createElement("span");Tt.setAttribute("style",`font-size: ${ft}`),Tt.innerHTML=A.innerHTML,at.append(Tt),null===(et=A.parentElement)||void 0===et||et.replaceChild("P"===A.parentElement.tagName?Tt:at,A)}function Et(ft){var A;const et=document.createElement("span");et.setAttribute("style",`color: ${ft.getAttribute("color")}`),et.innerHTML=ft.innerHTML,null===(A=ft.parentElement)||void 0===A||A.replaceChild(et,ft)}const Dt=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function bt(ft){const A=new RegExp(Dt.join(""),"gi"),et=ft.startsWith("to")||ft.match(/^\d/)?ft.slice(Math.max(0,ft.indexOf(",")+1)).trim():ft,at=ft.startsWith("to")?ft.split(",")[0]:"to bottom";let Tt=[],W=A.exec(et);for(;null!==W;)Tt=Tt.concat({color:W[1],position:Nt(W[2],Tt.length)}),W=A.exec(et);return Tt=Tt.filter(({color:J})=>J.startsWith("#")||J.startsWith("rgb")),{stops:Tt,side:at}}function Nt(ft,A){const et=1===A?"100%":`${A}%`;return(null==ft?void 0:ft.includes("%"))?ft:et}function zt(ft){var A;return ft.endOffset-ft.startOffset>0||0!==ft.startOffset&&ft.endOffset!==((null===(A=ft.endContainer.nodeValue)||void 0===A?void 0:A.length)||0)}function ee({stops:ft,side:A}){return`linear-gradient(${A}, ${ft.map(({color:et,position:at})=>`rgba(${(0,s.tuiParseColor)(et).join(", ")}) ${at}`).join(", ")})`}},13903:(Kt,Mt,d)=>{d.d(Mt,{$:()=>Et,h:()=>Ot});for(var T={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},H="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),m=("undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)),ct="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),I=m||H&&+H[1]<57,pt=0;pt<10;pt++)T[48+pt]=T[96+pt]=String(pt);for(pt=1;pt<=24;pt++)T[pt+111]="F"+pt;for(pt=65;pt<=90;pt++)T[pt]=String.fromCharCode(pt+32),s[pt]=String.fromCharCode(pt);for(var ot in T)s.hasOwnProperty(ot)||(s[ot]=T[ot]);var ht=d(62463);const xt="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function mt(X){let K,vt,yt,Pt,Q=X.split(/-(?!$)/),it=Q[Q.length-1];"Space"==it&&(it=" ");for(let Dt=0;Dt<Q.length-1;Dt++){let bt=Q[Dt];if(/^(cmd|meta|m)$/i.test(bt))Pt=!0;else if(/^a(lt)?$/i.test(bt))K=!0;else if(/^(c|ctrl|control)$/i.test(bt))vt=!0;else if(/^s(hift)?$/i.test(bt))yt=!0;else{if(!/^mod$/i.test(bt))throw new Error("Unrecognized modifier name: "+bt);xt?Pt=!0:vt=!0}}return K&&(it="Alt-"+it),vt&&(it="Ctrl-"+it),Pt&&(it="Meta-"+it),yt&&(it="Shift-"+it),it}function wt(X,Q,it){return Q.altKey&&(X="Alt-"+X),Q.ctrlKey&&(X="Ctrl-"+X),Q.metaKey&&(X="Meta-"+X),!1!==it&&Q.shiftKey&&(X="Shift-"+X),X}function Ot(X){return new ht.Sy({props:{handleKeyDown:Et(X)}})}function Et(X){let Q=function(X){let Q=Object.create(null);for(let it in X)Q[mt(it)]=X[it];return Q}(X);return function(it,K){let Pt,vt=function(X){var it=!(I&&(X.ctrlKey||X.altKey||X.metaKey)||ct&&X.shiftKey&&X.key&&1==X.key.length||"Unidentified"==X.key)&&X.key||(X.shiftKey?s:T)[X.keyCode]||X.key||"Unidentified";return"Esc"==it&&(it="Escape"),"Del"==it&&(it="Delete"),"Left"==it&&(it="ArrowLeft"),"Up"==it&&(it="ArrowUp"),"Right"==it&&(it="ArrowRight"),"Down"==it&&(it="ArrowDown"),it}(K),yt=1==vt.length&&" "!=vt,Dt=Q[wt(vt,K,!yt)];if(Dt&&Dt(it.state,it.dispatch,it))return!0;if(yt&&(K.shiftKey||K.altKey||K.metaKey||vt.charCodeAt(0)>127)&&(Pt=T[K.keyCode])&&Pt!=vt){let bt=Q[wt(Pt,K,!0)];if(bt&&bt(it.state,it.dispatch,it))return!0}else if(yt&&K.shiftKey){let bt=Q[wt(vt,K,!0)];if(bt&&bt(it.state,it.dispatch,it))return!0}return!1}}},35917:(Kt,Mt,d)=>{function T(z){this.content=z}d.d(Mt,{aw:()=>Ee,PW:()=>Wt,HY:()=>m,vc:()=>ot,ZU:()=>de,NB:()=>ft,Ts:()=>zt,e4:()=>ut,V_:()=>se,p2:()=>ht}),T.prototype={constructor:T,find:function(z){for(var l=0;l<this.content.length;l+=2)if(this.content[l]===z)return l;return-1},get:function(z){var l=this.find(z);return-1==l?void 0:this.content[l+1]},update:function(z,l,u){var g=u&&u!=z?this.remove(u):this,O=g.find(z),L=g.content.slice();return-1==O?L.push(u||z,l):(L[O+1]=l,u&&(L[O]=u)),new T(L)},remove:function(z){var l=this.find(z);if(-1==l)return this;var u=this.content.slice();return u.splice(l,2),new T(u)},addToStart:function(z,l){return new T([z,l].concat(this.remove(z).content))},addToEnd:function(z,l){var u=this.remove(z).content.slice();return u.push(z,l),new T(u)},addBefore:function(z,l,u){var g=this.remove(l),O=g.content.slice(),L=g.find(z);return O.splice(-1==L?O.length:L,0,l,u),new T(O)},forEach:function(z){for(var l=0;l<this.content.length;l+=2)z(this.content[l],this.content[l+1])},prepend:function(z){return(z=T.from(z)).size?new T(z.content.concat(this.subtract(z).content)):this},append:function(z){return(z=T.from(z)).size?new T(this.subtract(z).content.concat(z.content)):this},subtract:function(z){var l=this;z=T.from(z);for(var u=0;u<z.content.length;u+=2)l=l.remove(z.content[u]);return l},toObject:function(){var z={};return this.forEach(function(l,u){z[l]=u}),z},get size(){return this.content.length>>1}},T.from=function(z){if(z instanceof T)return z;var l=[];if(z)for(var u in z)l.push(u,z[u]);return new T(l)};const s=T;function H(z,l,u){for(let g=0;;g++){if(g==z.childCount||g==l.childCount)return z.childCount==l.childCount?null:u;let O=z.child(g),L=l.child(g);if(O!=L){if(!O.sameMarkup(L))return u;if(O.isText&&O.text!=L.text){for(let V=0;O.text[V]==L.text[V];V++)u++;return u}if(O.content.size||L.content.size){let V=H(O.content,L.content,u+1);if(null!=V)return V}u+=O.nodeSize}else u+=O.nodeSize}}function P(z,l,u,g){for(let O=z.childCount,L=l.childCount;;){if(0==O||0==L)return O==L?null:{a:u,b:g};let V=z.child(--O),_t=l.child(--L),kt=V.nodeSize;if(V!=_t){if(!V.sameMarkup(_t))return{a:u,b:g};if(V.isText&&V.text!=_t.text){let Yt=0,Gt=Math.min(V.text.length,_t.text.length);for(;Yt<Gt&&V.text[V.text.length-Yt-1]==_t.text[_t.text.length-Yt-1];)Yt++,u--,g--;return{a:u,b:g}}if(V.content.size||_t.content.size){let Yt=P(V.content,_t.content,u-1,g-1);if(Yt)return Yt}u-=kt,g-=kt}else u-=kt,g-=kt}}class m{constructor(l,u){if(this.content=l,this.size=u||0,null==u)for(let g=0;g<l.length;g++)this.size+=l[g].nodeSize}nodesBetween(l,u,g,O=0,L){for(let V=0,_t=0;_t<u;V++){let kt=this.content[V],Yt=_t+kt.nodeSize;if(Yt>l&&!1!==g(kt,O+_t,L||null,V)&&kt.content.size){let Gt=_t+1;kt.nodesBetween(Math.max(0,l-Gt),Math.min(kt.content.size,u-Gt),g,O+Gt)}_t=Yt}}descendants(l){this.nodesBetween(0,this.size,l)}textBetween(l,u,g,O){let L="",V=!0;return this.nodesBetween(l,u,(_t,kt)=>{_t.isText?(L+=_t.text.slice(Math.max(l,kt)-kt,u-kt),V=!g):_t.isLeaf?(O?L+="function"==typeof O?O(_t):O:_t.type.spec.leafText&&(L+=_t.type.spec.leafText(_t)),V=!g):!V&&_t.isBlock&&(L+=g,V=!0)},0),L}append(l){if(!l.size)return this;if(!this.size)return l;let u=this.lastChild,g=l.firstChild,O=this.content.slice(),L=0;for(u.isText&&u.sameMarkup(g)&&(O[O.length-1]=u.withText(u.text+g.text),L=1);L<l.content.length;L++)O.push(l.content[L]);return new m(O,this.size+l.size)}cut(l,u=this.size){if(0==l&&u==this.size)return this;let g=[],O=0;if(u>l)for(let L=0,V=0;V<u;L++){let _t=this.content[L],kt=V+_t.nodeSize;kt>l&&((V<l||kt>u)&&(_t=_t.isText?_t.cut(Math.max(0,l-V),Math.min(_t.text.length,u-V)):_t.cut(Math.max(0,l-V-1),Math.min(_t.content.size,u-V-1))),g.push(_t),O+=_t.nodeSize),V=kt}return new m(g,O)}cutByIndex(l,u){return l==u?m.empty:0==l&&u==this.content.length?this:new m(this.content.slice(l,u))}replaceChild(l,u){let g=this.content[l];if(g==u)return this;let O=this.content.slice(),L=this.size+u.nodeSize-g.nodeSize;return O[l]=u,new m(O,L)}addToStart(l){return new m([l].concat(this.content),this.size+l.nodeSize)}addToEnd(l){return new m(this.content.concat(l),this.size+l.nodeSize)}eq(l){if(this.content.length!=l.content.length)return!1;for(let u=0;u<this.content.length;u++)if(!this.content[u].eq(l.content[u]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(l){let u=this.content[l];if(!u)throw new RangeError("Index "+l+" out of range for "+this);return u}maybeChild(l){return this.content[l]||null}forEach(l){for(let u=0,g=0;u<this.content.length;u++){let O=this.content[u];l(O,g,u),g+=O.nodeSize}}findDiffStart(l,u=0){return H(this,l,u)}findDiffEnd(l,u=this.size,g=l.size){return P(this,l,u,g)}findIndex(l,u=-1){if(0==l)return I(0,l);if(l==this.size)return I(this.content.length,l);if(l>this.size||l<0)throw new RangeError(`Position ${l} outside of fragment (${this})`);for(let g=0,O=0;;g++){let V=O+this.child(g).nodeSize;if(V>=l)return V==l||u>0?I(g+1,V):I(g,O);O=V}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(l=>l.toJSON()):null}static fromJSON(l,u){if(!u)return m.empty;if(!Array.isArray(u))throw new RangeError("Invalid input for Fragment.fromJSON");return new m(u.map(l.nodeFromJSON))}static fromArray(l){if(!l.length)return m.empty;let u,g=0;for(let O=0;O<l.length;O++){let L=l[O];g+=L.nodeSize,O&&L.isText&&l[O-1].sameMarkup(L)?(u||(u=l.slice(0,O)),u[u.length-1]=L.withText(u[u.length-1].text+L.text)):u&&u.push(L)}return new m(u||l,g)}static from(l){if(!l)return m.empty;if(l instanceof m)return l;if(Array.isArray(l))return this.fromArray(l);if(l.attrs)return new m([l],l.nodeSize);throw new RangeError("Can not convert "+l+" to a Fragment"+(l.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}m.empty=new m([],0);const ct={index:0,offset:0};function I(z,l){return ct.index=z,ct.offset=l,ct}function pt(z,l){if(z===l)return!0;if(!z||"object"!=typeof z||!l||"object"!=typeof l)return!1;let u=Array.isArray(z);if(Array.isArray(l)!=u)return!1;if(u){if(z.length!=l.length)return!1;for(let g=0;g<z.length;g++)if(!pt(z[g],l[g]))return!1}else{for(let g in z)if(!(g in l)||!pt(z[g],l[g]))return!1;for(let g in l)if(!(g in z))return!1}return!0}let ot=(()=>{class z{constructor(u,g){this.type=u,this.attrs=g}addToSet(u){let g,O=!1;for(let L=0;L<u.length;L++){let V=u[L];if(this.eq(V))return u;if(this.type.excludes(V.type))g||(g=u.slice(0,L));else{if(V.type.excludes(this.type))return u;!O&&V.type.rank>this.type.rank&&(g||(g=u.slice(0,L)),g.push(this),O=!0),g&&g.push(V)}}return g||(g=u.slice()),O||g.push(this),g}removeFromSet(u){for(let g=0;g<u.length;g++)if(this.eq(u[g]))return u.slice(0,g).concat(u.slice(g+1));return u}isInSet(u){for(let g=0;g<u.length;g++)if(this.eq(u[g]))return!0;return!1}eq(u){return this==u||this.type==u.type&&pt(this.attrs,u.attrs)}toJSON(){let u={type:this.type.name};for(let g in this.attrs){u.attrs=this.attrs;break}return u}static fromJSON(u,g){if(!g)throw new RangeError("Invalid input for Mark.fromJSON");let O=u.marks[g.type];if(!O)throw new RangeError(`There is no mark type ${g.type} in this schema`);return O.create(g.attrs)}static sameSet(u,g){if(u==g)return!0;if(u.length!=g.length)return!1;for(let O=0;O<u.length;O++)if(!u[O].eq(g[O]))return!1;return!0}static setFrom(u){if(!u||Array.isArray(u)&&0==u.length)return z.none;if(u instanceof z)return[u];let g=u.slice();return g.sort((O,L)=>O.type.rank-L.type.rank),g}}return z.none=[],z})();class ut extends Error{}class ht{constructor(l,u,g){this.content=l,this.openStart=u,this.openEnd=g}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(l,u){let g=mt(this.content,l+this.openStart,u);return g&&new ht(g,this.openStart,this.openEnd)}removeBetween(l,u){return new ht(xt(this.content,l+this.openStart,u+this.openStart),this.openStart,this.openEnd)}eq(l){return this.content.eq(l.content)&&this.openStart==l.openStart&&this.openEnd==l.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let l={content:this.content.toJSON()};return this.openStart>0&&(l.openStart=this.openStart),this.openEnd>0&&(l.openEnd=this.openEnd),l}static fromJSON(l,u){if(!u)return ht.empty;let g=u.openStart||0,O=u.openEnd||0;if("number"!=typeof g||"number"!=typeof O)throw new RangeError("Invalid input for Slice.fromJSON");return new ht(m.fromJSON(l,u.content),g,O)}static maxOpen(l,u=!0){let g=0,O=0;for(let L=l.firstChild;L&&!L.isLeaf&&(u||!L.type.spec.isolating);L=L.firstChild)g++;for(let L=l.lastChild;L&&!L.isLeaf&&(u||!L.type.spec.isolating);L=L.lastChild)O++;return new ht(l,g,O)}}function xt(z,l,u){let{index:g,offset:O}=z.findIndex(l),L=z.maybeChild(g),{index:V,offset:_t}=z.findIndex(u);if(O==l||L.isText){if(_t!=u&&!z.child(V).isText)throw new RangeError("Removing non-flat range");return z.cut(0,l).append(z.cut(u))}if(g!=V)throw new RangeError("Removing non-flat range");return z.replaceChild(g,L.copy(xt(L.content,l-O-1,u-O-1)))}function mt(z,l,u,g){let{index:O,offset:L}=z.findIndex(l),V=z.maybeChild(O);if(L==l||V.isText)return g&&!g.canReplace(O,O,u)?null:z.cut(0,l).append(u).append(z.cut(l));let _t=mt(V.content,l-L-1,u);return _t&&z.replaceChild(O,V.copy(_t))}function gt(z,l,u){if(u.openStart>z.depth)throw new ut("Inserted content deeper than insertion position");if(z.depth-u.openStart!=l.depth-u.openEnd)throw new ut("Inconsistent open depths");return wt(z,l,u,0)}function wt(z,l,u,g){let O=z.index(g),L=z.node(g);if(O==l.index(g)&&g<z.depth-u.openStart){let V=wt(z,l,u,g+1);return L.copy(L.content.replaceChild(O,V))}if(u.content.size){if(u.openStart||u.openEnd||z.depth!=g||l.depth!=g){let{start:V,end:_t}=function(z,l){let u=l.depth-z.openStart,O=l.node(u).copy(z.content);for(let L=u-1;L>=0;L--)O=l.node(L).copy(m.from(O));return{start:O.resolveNoCache(z.openStart+u),end:O.resolveNoCache(O.content.size-z.openEnd-u)}}(u,z);return it(L,K(z,V,_t,l,g))}{let V=z.parent,_t=V.content;return it(V,_t.cut(0,z.parentOffset).append(u.content).append(_t.cut(l.parentOffset)))}}return it(L,vt(z,l,g))}function Ot(z,l){if(!l.type.compatibleContent(z.type))throw new ut("Cannot join "+l.type.name+" onto "+z.type.name)}function Et(z,l,u){let g=z.node(u);return Ot(g,l.node(u)),g}function X(z,l){let u=l.length-1;u>=0&&z.isText&&z.sameMarkup(l[u])?l[u]=z.withText(l[u].text+z.text):l.push(z)}function Q(z,l,u,g){let O=(l||z).node(u),L=0,V=l?l.index(u):O.childCount;z&&(L=z.index(u),z.depth>u?L++:z.textOffset&&(X(z.nodeAfter,g),L++));for(let _t=L;_t<V;_t++)X(O.child(_t),g);l&&l.depth==u&&l.textOffset&&X(l.nodeBefore,g)}function it(z,l){if(!z.type.validContent(l))throw new ut("Invalid content for node "+z.type.name);return z.copy(l)}function K(z,l,u,g,O){let L=z.depth>O&&Et(z,l,O+1),V=g.depth>O&&Et(u,g,O+1),_t=[];return Q(null,z,O,_t),L&&V&&l.index(O)==u.index(O)?(Ot(L,V),X(it(L,K(z,l,u,g,O+1)),_t)):(L&&X(it(L,vt(z,l,O+1)),_t),Q(l,u,O,_t),V&&X(it(V,vt(u,g,O+1)),_t)),Q(g,null,O,_t),new m(_t)}function vt(z,l,u){let g=[];return Q(null,z,u,g),z.depth>u&&X(it(Et(z,l,u+1),vt(z,l,u+1)),g),Q(l,null,u,g),new m(g)}ht.empty=new ht(m.empty,0,0);class Pt{constructor(l,u,g){this.pos=l,this.path=u,this.parentOffset=g,this.depth=u.length/3-1}resolveDepth(l){return null==l?this.depth:l<0?this.depth+l:l}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(l){return this.path[3*this.resolveDepth(l)]}index(l){return this.path[3*this.resolveDepth(l)+1]}indexAfter(l){return l=this.resolveDepth(l),this.index(l)+(l!=this.depth||this.textOffset?1:0)}start(l){return 0==(l=this.resolveDepth(l))?0:this.path[3*l-1]+1}end(l){return l=this.resolveDepth(l),this.start(l)+this.node(l).content.size}before(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position before the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]}after(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position after the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]+this.path[3*l].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let l=this.parent,u=this.index(this.depth);if(u==l.childCount)return null;let g=this.pos-this.path[this.path.length-1],O=l.child(u);return g?l.child(u).cut(g):O}get nodeBefore(){let l=this.index(this.depth),u=this.pos-this.path[this.path.length-1];return u?this.parent.child(l).cut(0,u):0==l?null:this.parent.child(l-1)}posAtIndex(l,u){u=this.resolveDepth(u);let g=this.path[3*u],O=0==u?0:this.path[3*u-1]+1;for(let L=0;L<l;L++)O+=g.child(L).nodeSize;return O}marks(){let l=this.parent,u=this.index();if(0==l.content.size)return ot.none;if(this.textOffset)return l.child(u).marks;let g=l.maybeChild(u-1),O=l.maybeChild(u);if(!g){let _t=g;g=O,O=_t}let L=g.marks;for(var V=0;V<L.length;V++)!1===L[V].type.spec.inclusive&&(!O||!L[V].isInSet(O.marks))&&(L=L[V--].removeFromSet(L));return L}marksAcross(l){let u=this.parent.maybeChild(this.index());if(!u||!u.isInline)return null;let g=u.marks,O=l.parent.maybeChild(l.index());for(var L=0;L<g.length;L++)!1===g[L].type.spec.inclusive&&(!O||!g[L].isInSet(O.marks))&&(g=g[L--].removeFromSet(g));return g}sharedDepth(l){for(let u=this.depth;u>0;u--)if(this.start(u)<=l&&this.end(u)>=l)return u;return 0}blockRange(l=this,u){if(l.pos<this.pos)return l.blockRange(this);for(let g=this.depth-(this.parent.inlineContent||this.pos==l.pos?1:0);g>=0;g--)if(l.pos<=this.end(g)&&(!u||u(this.node(g))))return new zt(this,l,g);return null}sameParent(l){return this.pos-this.parentOffset==l.pos-l.parentOffset}max(l){return l.pos>this.pos?l:this}min(l){return l.pos<this.pos?l:this}toString(){let l="";for(let u=1;u<=this.depth;u++)l+=(l?"/":"")+this.node(u).type.name+"_"+this.index(u-1);return l+":"+this.parentOffset}static resolve(l,u){if(!(u>=0&&u<=l.content.size))throw new RangeError("Position "+u+" out of range");let g=[],O=0,L=u;for(let V=l;;){let{index:_t,offset:kt}=V.content.findIndex(L),Yt=L-kt;if(g.push(V,_t,O+kt),!Yt||(V=V.child(_t),V.isText))break;L=Yt-1,O+=kt+1}return new Pt(u,g,L)}static resolveCached(l,u){for(let O=0;O<Dt.length;O++){let L=Dt[O];if(L.pos==u&&L.doc==l)return L}let g=Dt[bt]=Pt.resolve(l,u);return bt=(bt+1)%Nt,g}}let Dt=[],bt=0,Nt=12;class zt{constructor(l,u,g){this.$from=l,this.$to=u,this.depth=g}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const ee=Object.create(null);class ft{constructor(l,u,g,O=ot.none){this.type=l,this.attrs=u,this.marks=O,this.content=g||m.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(l){return this.content.child(l)}maybeChild(l){return this.content.maybeChild(l)}forEach(l){this.content.forEach(l)}nodesBetween(l,u,g,O=0){this.content.nodesBetween(l,u,g,O,this)}descendants(l){this.nodesBetween(0,this.content.size,l)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(l,u,g,O){return this.content.textBetween(l,u,g,O)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(l){return this==l||this.sameMarkup(l)&&this.content.eq(l.content)}sameMarkup(l){return this.hasMarkup(l.type,l.attrs,l.marks)}hasMarkup(l,u,g){return this.type==l&&pt(this.attrs,u||l.defaultAttrs||ee)&&ot.sameSet(this.marks,g||ot.none)}copy(l=null){return l==this.content?this:new ft(this.type,this.attrs,l,this.marks)}mark(l){return l==this.marks?this:new ft(this.type,this.attrs,this.content,l)}cut(l,u=this.content.size){return 0==l&&u==this.content.size?this:this.copy(this.content.cut(l,u))}slice(l,u=this.content.size,g=!1){if(l==u)return ht.empty;let O=this.resolve(l),L=this.resolve(u),V=g?0:O.sharedDepth(u),_t=O.start(V),Yt=O.node(V).content.cut(O.pos-_t,L.pos-_t);return new ht(Yt,O.depth-V,L.depth-V)}replace(l,u,g){return gt(this.resolve(l),this.resolve(u),g)}nodeAt(l){for(let u=this;;){let{index:g,offset:O}=u.content.findIndex(l);if(u=u.maybeChild(g),!u)return null;if(O==l||u.isText)return u;l-=O+1}}childAfter(l){let{index:u,offset:g}=this.content.findIndex(l);return{node:this.content.maybeChild(u),index:u,offset:g}}childBefore(l){if(0==l)return{node:null,index:0,offset:0};let{index:u,offset:g}=this.content.findIndex(l);if(g<l)return{node:this.content.child(u),index:u,offset:g};let O=this.content.child(u-1);return{node:O,index:u-1,offset:g-O.nodeSize}}resolve(l){return Pt.resolveCached(this,l)}resolveNoCache(l){return Pt.resolve(this,l)}rangeHasMark(l,u,g){let O=!1;return u>l&&this.nodesBetween(l,u,L=>(g.isInSet(L.marks)&&(O=!0),!O)),O}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let l=this.type.name;return this.content.size&&(l+="("+this.content.toStringInner()+")"),et(this.marks,l)}contentMatchAt(l){let u=this.type.contentMatch.matchFragment(this.content,0,l);if(!u)throw new Error("Called contentMatchAt on a node with invalid content");return u}canReplace(l,u,g=m.empty,O=0,L=g.childCount){let V=this.contentMatchAt(l).matchFragment(g,O,L),_t=V&&V.matchFragment(this.content,u);if(!_t||!_t.validEnd)return!1;for(let kt=O;kt<L;kt++)if(!this.type.allowsMarks(g.child(kt).marks))return!1;return!0}canReplaceWith(l,u,g,O){if(O&&!this.type.allowsMarks(O))return!1;let L=this.contentMatchAt(l).matchType(g),V=L&&L.matchFragment(this.content,u);return!!V&&V.validEnd}canAppend(l){return l.content.size?this.canReplace(this.childCount,this.childCount,l.content):this.type.compatibleContent(l.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let l=ot.none;for(let u=0;u<this.marks.length;u++)l=this.marks[u].addToSet(l);if(!ot.sameSet(l,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(u=>u.type.name)}`);this.content.forEach(u=>u.check())}toJSON(){let l={type:this.type.name};for(let u in this.attrs){l.attrs=this.attrs;break}return this.content.size&&(l.content=this.content.toJSON()),this.marks.length&&(l.marks=this.marks.map(u=>u.toJSON())),l}static fromJSON(l,u){if(!u)throw new RangeError("Invalid input for Node.fromJSON");let g=null;if(u.marks){if(!Array.isArray(u.marks))throw new RangeError("Invalid mark data for Node.fromJSON");g=u.marks.map(l.markFromJSON)}if("text"==u.type){if("string"!=typeof u.text)throw new RangeError("Invalid text node in JSON");return l.text(u.text,g)}let O=m.fromJSON(l,u.content);return l.nodeType(u.type).create(u.attrs,O,g)}}ft.prototype.text=void 0;class A extends ft{constructor(l,u,g,O){if(super(l,u,null,O),!g)throw new RangeError("Empty text nodes are not allowed");this.text=g}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):et(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(l,u){return this.text.slice(l,u)}get nodeSize(){return this.text.length}mark(l){return l==this.marks?this:new A(this.type,this.attrs,this.text,l)}withText(l){return l==this.text?this:new A(this.type,this.attrs,l,this.marks)}cut(l=0,u=this.text.length){return 0==l&&u==this.text.length?this:this.withText(this.text.slice(l,u))}eq(l){return this.sameMarkup(l)&&this.text==l.text}toJSON(){let l=super.toJSON();return l.text=this.text,l}}function et(z,l){for(let u=z.length-1;u>=0;u--)l=z[u].type.name+"("+l+")";return l}class at{constructor(l){this.validEnd=l,this.next=[],this.wrapCache=[]}static parse(l,u){let g=new Tt(l,u);if(null==g.next)return at.empty;let O=W(g);g.next&&g.err("Unexpected trailing text");let L=function(z){let l=Object.create(null);return function u(g){let O=[];g.forEach(V=>{z[V].forEach(({term:_t,to:kt})=>{if(!_t)return;let Yt;for(let Gt=0;Gt<O.length;Gt++)O[Gt][0]==_t&&(Yt=O[Gt][1]);Ke(z,kt).forEach(Gt=>{Yt||O.push([_t,Yt=[]]),-1==Yt.indexOf(Gt)&&Yt.push(Gt)})})});let L=l[g.join(",")]=new at(g.indexOf(z.length-1)>-1);for(let V=0;V<O.length;V++){let _t=O[V][1].sort(Fe);L.next.push({type:O[V][0],next:l[_t.join(",")]||u(_t)})}return L}(Ke(z,0))}(function(z){let l=[[]];return O(function L(V,_t){if("choice"==V.type)return V.exprs.reduce((kt,Yt)=>kt.concat(L(Yt,_t)),[]);if("seq"!=V.type){if("star"==V.type){let kt=u();return g(_t,kt),O(L(V.expr,kt),kt),[g(kt)]}if("plus"==V.type){let kt=u();return O(L(V.expr,_t),kt),O(L(V.expr,kt),kt),[g(kt)]}if("opt"==V.type)return[g(_t)].concat(L(V.expr,_t));if("range"==V.type){let kt=_t;for(let Yt=0;Yt<V.min;Yt++){let Gt=u();O(L(V.expr,kt),Gt),kt=Gt}if(-1==V.max)O(L(V.expr,kt),kt);else for(let Yt=V.min;Yt<V.max;Yt++){let Gt=u();g(kt,Gt),O(L(V.expr,kt),Gt),kt=Gt}return[g(kt)]}if("name"==V.type)return[g(_t,void 0,V.value)];throw new Error("Unknown expr type")}for(let kt=0;;kt++){let Yt=L(V.exprs[kt],_t);if(kt==V.exprs.length-1)return Yt;O(Yt,_t=u())}}(z,0),u()),l;function u(){return l.push([])-1}function g(V,_t,kt){let Yt={term:kt,to:_t};return l[V].push(Yt),Yt}function O(V,_t){V.forEach(kt=>kt.to=_t)}}(O));return function(z,l){for(let u=0,g=[z];u<g.length;u++){let O=g[u],L=!O.validEnd,V=[];for(let _t=0;_t<O.next.length;_t++){let{type:kt,next:Yt}=O.next[_t];V.push(kt.name),L&&!(kt.isText||kt.hasRequiredAttrs())&&(L=!1),-1==g.indexOf(Yt)&&g.push(Yt)}L&&l.err("Only non-generatable nodes ("+V.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(L,g),L}matchType(l){for(let u=0;u<this.next.length;u++)if(this.next[u].type==l)return this.next[u].next;return null}matchFragment(l,u=0,g=l.childCount){let O=this;for(let L=u;O&&L<g;L++)O=O.matchType(l.child(L).type);return O}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let l=0;l<this.next.length;l++){let{type:u}=this.next[l];if(!u.isText&&!u.hasRequiredAttrs())return u}return null}compatible(l){for(let u=0;u<this.next.length;u++)for(let g=0;g<l.next.length;g++)if(this.next[u].type==l.next[g].type)return!0;return!1}fillBefore(l,u=!1,g=0){let O=[this];return function L(V,_t){let kt=V.matchFragment(l,g);if(kt&&(!u||kt.validEnd))return m.from(_t.map(Yt=>Yt.createAndFill()));for(let Yt=0;Yt<V.next.length;Yt++){let{type:Gt,next:Me}=V.next[Yt];if(!Gt.isText&&!Gt.hasRequiredAttrs()&&-1==O.indexOf(Me)){O.push(Me);let cn=L(Me,_t.concat(Gt));if(cn)return cn}}return null}(this,[])}findWrapping(l){for(let g=0;g<this.wrapCache.length;g+=2)if(this.wrapCache[g]==l)return this.wrapCache[g+1];let u=this.computeWrapping(l);return this.wrapCache.push(l,u),u}computeWrapping(l){let u=Object.create(null),g=[{match:this,type:null,via:null}];for(;g.length;){let O=g.shift(),L=O.match;if(L.matchType(l)){let V=[];for(let _t=O;_t.type;_t=_t.via)V.push(_t.type);return V.reverse()}for(let V=0;V<L.next.length;V++){let{type:_t,next:kt}=L.next[V];!_t.isLeaf&&!_t.hasRequiredAttrs()&&!(_t.name in u)&&(!O.type||kt.validEnd)&&(g.push({match:_t.contentMatch,type:_t,via:O}),u[_t.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(l){if(l>=this.next.length)throw new RangeError(`There's no ${l}th edge in this content match`);return this.next[l]}toString(){let l=[];return function u(g){l.push(g);for(let O=0;O<g.next.length;O++)-1==l.indexOf(g.next[O].next)&&u(g.next[O].next)}(this),l.map((g,O)=>{let L=O+(g.validEnd?"*":" ")+" ";for(let V=0;V<g.next.length;V++)L+=(V?", ":"")+g.next[V].type.name+"->"+l.indexOf(g.next[V].next);return L}).join("\n")}}at.empty=new at(!0);class Tt{constructor(l,u){this.string=l,this.nodeTypes=u,this.inline=null,this.pos=0,this.tokens=l.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(l){return this.next==l&&(this.pos++||!0)}err(l){throw new SyntaxError(l+" (in content expression '"+this.string+"')")}}function W(z){let l=[];do{l.push(J(z))}while(z.eat("|"));return 1==l.length?l[0]:{type:"choice",exprs:l}}function J(z){let l=[];do{l.push(dt(z))}while(z.next&&")"!=z.next&&"|"!=z.next);return 1==l.length?l[0]:{type:"seq",exprs:l}}function dt(z){let l=function(z){if(z.eat("(")){let l=W(z);return z.eat(")")||z.err("Missing closing paren"),l}if(!/\W/.test(z.next)){let l=function(z,l){let u=z.nodeTypes,g=u[l];if(g)return[g];let O=[];for(let L in u){let V=u[L];V.groups.indexOf(l)>-1&&O.push(V)}return 0==O.length&&z.err("No node type or group '"+l+"' found"),O}(z,z.next).map(u=>(null==z.inline?z.inline=u.isInline:z.inline!=u.isInline&&z.err("Mixing inline and block content"),{type:"name",value:u}));return z.pos++,1==l.length?l[0]:{type:"choice",exprs:l}}z.err("Unexpected token '"+z.next+"'")}(z);for(;;)if(z.eat("+"))l={type:"plus",expr:l};else if(z.eat("*"))l={type:"star",expr:l};else if(z.eat("?"))l={type:"opt",expr:l};else{if(!z.eat("{"))break;l=Jt(z,l)}return l}function Lt(z){/\D/.test(z.next)&&z.err("Expected number, got '"+z.next+"'");let l=Number(z.next);return z.pos++,l}function Jt(z,l){let u=Lt(z),g=u;return z.eat(",")&&(g="}"!=z.next?Lt(z):-1),z.eat("}")||z.err("Unclosed braced range"),{type:"range",min:u,max:g,expr:l}}function Fe(z,l){return l-z}function Ke(z,l){let u=[];return function g(O){let L=z[O];if(1==L.length&&!L[0].term)return g(L[0].to);u.push(O);for(let V=0;V<L.length;V++){let{term:_t,to:kt}=L[V];!_t&&-1==u.indexOf(kt)&&g(kt)}}(l),u.sort(Fe)}function he(z){let l=Object.create(null);for(let u in z){let g=z[u];if(!g.hasDefault)return null;l[u]=g.default}return l}function De(z,l){let u=Object.create(null);for(let g in z){let O=l&&l[g];if(void 0===O){let L=z[g];if(!L.hasDefault)throw new RangeError("No value supplied for attribute "+g);O=L.default}u[g]=O}return u}function Ie(z){let l=Object.create(null);if(z)for(let u in z)l[u]=new Ue(z[u]);return l}class Te{constructor(l,u,g){this.name=l,this.schema=u,this.spec=g,this.markSet=null,this.groups=g.group?g.group.split(" "):[],this.attrs=Ie(g.attrs),this.defaultAttrs=he(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(g.inline||"text"==l),this.isText="text"==l}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==at.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let l in this.attrs)if(this.attrs[l].isRequired)return!0;return!1}compatibleContent(l){return this==l||this.contentMatch.compatible(l.contentMatch)}computeAttrs(l){return!l&&this.defaultAttrs?this.defaultAttrs:De(this.attrs,l)}create(l=null,u,g){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ft(this,this.computeAttrs(l),m.from(u),ot.setFrom(g))}createChecked(l=null,u,g){if(u=m.from(u),!this.validContent(u))throw new RangeError("Invalid content for node "+this.name);return new ft(this,this.computeAttrs(l),u,ot.setFrom(g))}createAndFill(l=null,u,g){if(l=this.computeAttrs(l),(u=m.from(u)).size){let V=this.contentMatch.fillBefore(u);if(!V)return null;u=V.append(u)}let O=this.contentMatch.matchFragment(u),L=O&&O.fillBefore(m.empty,!0);return L?new ft(this,l,u.append(L),ot.setFrom(g)):null}validContent(l){let u=this.contentMatch.matchFragment(l);if(!u||!u.validEnd)return!1;for(let g=0;g<l.childCount;g++)if(!this.allowsMarks(l.child(g).marks))return!1;return!0}allowsMarkType(l){return null==this.markSet||this.markSet.indexOf(l)>-1}allowsMarks(l){if(null==this.markSet)return!0;for(let u=0;u<l.length;u++)if(!this.allowsMarkType(l[u].type))return!1;return!0}allowedMarks(l){if(null==this.markSet)return l;let u;for(let g=0;g<l.length;g++)this.allowsMarkType(l[g].type)?u&&u.push(l[g]):u||(u=l.slice(0,g));return u?u.length?u:ot.none:l}static compile(l,u){let g=Object.create(null);l.forEach((L,V)=>g[L]=new Te(L,u,V));let O=u.spec.topNode||"doc";if(!g[O])throw new RangeError("Schema is missing its top node type ('"+O+"')");if(!g.text)throw new RangeError("Every schema needs a 'text' type");for(let L in g.text.attrs)throw new RangeError("The text node type should not have attributes");return g}}class Ue{constructor(l){this.hasDefault=Object.prototype.hasOwnProperty.call(l,"default"),this.default=l.default}get isRequired(){return!this.hasDefault}}class de{constructor(l,u,g,O){this.name=l,this.rank=u,this.schema=g,this.spec=O,this.attrs=Ie(O.attrs),this.excluded=null;let L=he(this.attrs);this.instance=L?new ot(this,L):null}create(l=null){return!l&&this.instance?this.instance:new ot(this,De(this.attrs,l))}static compile(l,u){let g=Object.create(null),O=0;return l.forEach((L,V)=>g[L]=new de(L,O++,u,V)),g}removeFromSet(l){for(var u=0;u<l.length;u++)l[u].type==this&&(l=l.slice(0,u).concat(l.slice(u+1)),u--);return l}isInSet(l){for(let u=0;u<l.length;u++)if(l[u].type==this)return l[u]}excludes(l){return this.excluded.indexOf(l)>-1}}class se{constructor(l){this.cached=Object.create(null),this.spec={nodes:s.from(l.nodes),marks:s.from(l.marks||{}),topNode:l.topNode},this.nodes=Te.compile(this.spec.nodes,this),this.marks=de.compile(this.spec.marks,this);let u=Object.create(null);for(let g in this.nodes){if(g in this.marks)throw new RangeError(g+" can not be both a node and a mark");let O=this.nodes[g],L=O.spec.content||"",V=O.spec.marks;O.contentMatch=u[L]||(u[L]=at.parse(L,this.nodes)),O.inlineContent=O.contentMatch.inlineContent,O.markSet="_"==V?null:V?ze(this,V.split(" ")):""!=V&&O.inlineContent?null:[]}for(let g in this.marks){let O=this.marks[g],L=O.spec.excludes;O.excluded=null==L?[O]:""==L?[]:ze(this,L.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(l,u=null,g,O){if("string"==typeof l)l=this.nodeType(l);else{if(!(l instanceof Te))throw new RangeError("Invalid node type: "+l);if(l.schema!=this)throw new RangeError("Node type from different schema used ("+l.name+")")}return l.createChecked(u,g,O)}text(l,u){let g=this.nodes.text;return new A(g,g.defaultAttrs,l,ot.setFrom(u))}mark(l,u){return"string"==typeof l&&(l=this.marks[l]),l.create(u)}nodeFromJSON(l){return ft.fromJSON(this,l)}markFromJSON(l){return ot.fromJSON(this,l)}nodeType(l){let u=this.nodes[l];if(!u)throw new RangeError("Unknown node type: "+l);return u}}function ze(z,l){let u=[];for(let g=0;g<l.length;g++){let O=l[g],L=z.marks[O],V=L;if(L)u.push(L);else for(let _t in z.marks){let kt=z.marks[_t];("_"==O||kt.spec.group&&kt.spec.group.split(" ").indexOf(O)>-1)&&u.push(V=kt)}if(!V)throw new SyntaxError("Unknown mark type: '"+l[g]+"'")}return u}class Ee{constructor(l,u){this.schema=l,this.rules=u,this.tags=[],this.styles=[],u.forEach(g=>{g.tag?this.tags.push(g):g.style&&this.styles.push(g)}),this.normalizeLists=!this.tags.some(g=>{if(!/^(ul|ol)\b/.test(g.tag)||!g.node)return!1;let O=l.nodes[g.node];return O.contentMatch.matchType(O)})}parse(l,u={}){let g=new D(this,u,!1);return g.addAll(l,u.from,u.to),g.finish()}parseSlice(l,u={}){let g=new D(this,u,!0);return g.addAll(l,u.from,u.to),ht.maxOpen(g.finish())}matchTag(l,u,g){for(let O=g?this.tags.indexOf(g)+1:0;O<this.tags.length;O++){let L=this.tags[O];if(R(l,L.tag)&&(void 0===L.namespace||l.namespaceURI==L.namespace)&&(!L.context||u.matchesContext(L.context))){if(L.getAttrs){let V=L.getAttrs(l);if(!1===V)continue;L.attrs=V||void 0}return L}}}matchStyle(l,u,g,O){for(let L=O?this.styles.indexOf(O)+1:0;L<this.styles.length;L++){let V=this.styles[L],_t=V.style;if(!(0!=_t.indexOf(l)||V.context&&!g.matchesContext(V.context)||_t.length>l.length&&(61!=_t.charCodeAt(l.length)||_t.slice(l.length+1)!=u))){if(V.getAttrs){let kt=V.getAttrs(u);if(!1===kt)continue;V.attrs=kt||void 0}return V}}}static schemaRules(l){let u=[];function g(O){let L=null==O.priority?50:O.priority,V=0;for(;V<u.length;V++){let _t=u[V];if((null==_t.priority?50:_t.priority)<L)break}u.splice(V,0,O)}for(let O in l.marks){let L=l.marks[O].spec.parseDOM;L&&L.forEach(V=>{g(V=U(V)),V.mark=O})}for(let O in l.nodes){let L=l.nodes[O].spec.parseDOM;L&&L.forEach(V=>{g(V=U(V)),V.node=O})}return u}static fromSchema(l){return l.cached.domParser||(l.cached.domParser=new Ee(l,Ee.schemaRules(l)))}}const Re={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Je={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},$e={ol:!0,ul:!0};function G(z,l,u){return null!=l?(l?1:0)|("full"===l?2:0):z&&"pre"==z.whitespace?3:-5&u}class E{constructor(l,u,g,O,L,V,_t){this.type=l,this.attrs=u,this.marks=g,this.pendingMarks=O,this.solid=L,this.options=_t,this.content=[],this.activeMarks=ot.none,this.stashMarks=[],this.match=V||(4&_t?null:l.contentMatch)}findWrapping(l){if(!this.match){if(!this.type)return[];let u=this.type.contentMatch.fillBefore(m.from(l));if(!u){let O,g=this.type.contentMatch;return(O=g.findWrapping(l.type))?(this.match=g,O):null}this.match=this.type.contentMatch.matchFragment(u)}return this.match.findWrapping(l.type)}finish(l){if(!(1&this.options)){let O,g=this.content[this.content.length-1];if(g&&g.isText&&(O=/[ \t\r\n\u000c]+$/.exec(g.text))){let L=g;g.text.length==O[0].length?this.content.pop():this.content[this.content.length-1]=L.withText(L.text.slice(0,L.text.length-O[0].length))}}let u=m.from(this.content);return!l&&this.match&&(u=u.append(this.match.fillBefore(m.empty,!0))),this.type?this.type.create(this.attrs,u,this.marks):u}popFromStashMark(l){for(let u=this.stashMarks.length-1;u>=0;u--)if(l.eq(this.stashMarks[u]))return this.stashMarks.splice(u,1)[0]}applyPending(l){for(let u=0,g=this.pendingMarks;u<g.length;u++){let O=g[u];(this.type?this.type.allowsMarkType(O.type):st(O.type,l))&&!O.isInSet(this.activeMarks)&&(this.activeMarks=O.addToSet(this.activeMarks),this.pendingMarks=O.removeFromSet(this.pendingMarks))}}inlineContext(l){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:l.parentNode&&!Re.hasOwnProperty(l.parentNode.nodeName.toLowerCase())}}class D{constructor(l,u,g){this.parser=l,this.options=u,this.isOpen=g,this.open=0;let L,O=u.topNode,V=G(null,u.preserveWhitespace,0)|(g?4:0);L=O?new E(O.type,O.attrs,ot.none,ot.none,!0,u.topMatch||O.type.contentMatch,V):new E(g?null:l.schema.topNodeType,null,ot.none,ot.none,!0,null,V),this.nodes=[L],this.find=u.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(l){if(3==l.nodeType)this.addTextNode(l);else if(1==l.nodeType){let u=l.getAttribute("style"),g=u?this.readStyles(function(z){let u,l=/\s*([\w-]+)\s*:\s*([^;]+)/g,g=[];for(;u=l.exec(z);)g.push(u[1],u[2].trim());return g}(u)):null,O=this.top;if(null!=g)for(let L=0;L<g.length;L++)this.addPendingMark(g[L]);if(this.addElement(l),null!=g)for(let L=0;L<g.length;L++)this.removePendingMark(g[L],O)}}addTextNode(l){let u=l.nodeValue,g=this.top;if(2&g.options||g.inlineContext(l)||/[^ \t\r\n\u000c]/.test(u)){if(1&g.options)u=2&g.options?u.replace(/\r\n?/g,"\n"):u.replace(/\r?\n|\r/g," ");else if(u=u.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(u)&&this.open==this.nodes.length-1){let O=g.content[g.content.length-1],L=l.previousSibling;(!O||L&&"BR"==L.nodeName||O.isText&&/[ \t\r\n\u000c]$/.test(O.text))&&(u=u.slice(1))}u&&this.insertNode(this.parser.schema.text(u)),this.findInText(l)}else this.findInside(l)}addElement(l,u){let O,g=l.nodeName.toLowerCase();$e.hasOwnProperty(g)&&this.parser.normalizeLists&&function(z){for(let l=z.firstChild,u=null;l;l=l.nextSibling){let g=1==l.nodeType?l.nodeName.toLowerCase():null;g&&$e.hasOwnProperty(g)&&u?(u.appendChild(l),l=u):"li"==g?u=l:g&&(u=null)}}(l);let L=this.options.ruleFromNode&&this.options.ruleFromNode(l)||(O=this.parser.matchTag(l,this,u));if(L?L.ignore:Je.hasOwnProperty(g))this.findInside(l),this.ignoreFallback(l);else if(!L||L.skip||L.closeParent){L&&L.closeParent?this.open=Math.max(0,this.open-1):L&&L.skip.nodeType&&(l=L.skip);let V,_t=this.top,kt=this.needsBlock;if(Re.hasOwnProperty(g))V=!0,_t.type||(this.needsBlock=!0);else if(!l.firstChild)return void this.leafFallback(l);this.addAll(l),V&&this.sync(_t),this.needsBlock=kt}else this.addElementByRule(l,L,!1===L.consuming?O:void 0)}leafFallback(l){"BR"==l.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(l.ownerDocument.createTextNode("\n"))}ignoreFallback(l){"BR"==l.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(l){let u=ot.none;t:for(let g=0;g<l.length;g+=2)for(let O;;){let L=this.parser.matchStyle(l[g],l[g+1],this,O);if(!L)continue t;if(L.ignore)return null;if(u=this.parser.schema.marks[L.mark].create(L.attrs).addToSet(u),!1!==L.consuming)break;O=L}return u}addElementByRule(l,u,g){let O,L,V;u.node?(L=this.parser.schema.nodes[u.node],L.isLeaf?this.insertNode(L.create(u.attrs))||this.leafFallback(l):O=this.enter(L,u.attrs||null,u.preserveWhitespace)):(V=this.parser.schema.marks[u.mark].create(u.attrs),this.addPendingMark(V));let _t=this.top;if(L&&L.isLeaf)this.findInside(l);else if(g)this.addElement(l,g);else if(u.getContent)this.findInside(l),u.getContent(l,this.parser.schema).forEach(kt=>this.insertNode(kt));else{let kt=l;"string"==typeof u.contentElement?kt=l.querySelector(u.contentElement):"function"==typeof u.contentElement?kt=u.contentElement(l):u.contentElement&&(kt=u.contentElement),this.findAround(l,kt,!0),this.addAll(kt)}O&&this.sync(_t)&&this.open--,V&&this.removePendingMark(V,_t)}addAll(l,u,g){let O=u||0;for(let L=u?l.childNodes[u]:l.firstChild,V=null==g?null:l.childNodes[g];L!=V;L=L.nextSibling,++O)this.findAtPoint(l,O),this.addDOM(L);this.findAtPoint(l,O)}findPlace(l){let u,g;for(let O=this.open;O>=0;O--){let L=this.nodes[O],V=L.findWrapping(l);if(V&&(!u||u.length>V.length)&&(u=V,g=L,!V.length)||L.solid)break}if(!u)return!1;this.sync(g);for(let O=0;O<u.length;O++)this.enterInner(u[O],null,!1);return!0}insertNode(l){if(l.isInline&&this.needsBlock&&!this.top.type){let u=this.textblockFromContext();u&&this.enterInner(u)}if(this.findPlace(l)){this.closeExtra();let u=this.top;u.applyPending(l.type),u.match&&(u.match=u.match.matchType(l.type));let g=u.activeMarks;for(let O=0;O<l.marks.length;O++)(!u.type||u.type.allowsMarkType(l.marks[O].type))&&(g=l.marks[O].addToSet(g));return u.content.push(l.mark(g)),!0}return!1}enter(l,u,g){let O=this.findPlace(l.create(u));return O&&this.enterInner(l,u,!0,g),O}enterInner(l,u=null,g=!1,O){this.closeExtra();let L=this.top;L.applyPending(l),L.match=L.match&&L.match.matchType(l);let V=G(l,O,L.options);4&L.options&&0==L.content.length&&(V|=4),this.nodes.push(new E(l,u,L.activeMarks,L.pendingMarks,g,null,V)),this.open++}closeExtra(l=!1){let u=this.nodes.length-1;if(u>this.open){for(;u>this.open;u--)this.nodes[u-1].content.push(this.nodes[u].finish(l));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(l){for(let u=this.open;u>=0;u--)if(this.nodes[u]==l)return this.open=u,!0;return!1}get currentPos(){this.closeExtra();let l=0;for(let u=this.open;u>=0;u--){let g=this.nodes[u].content;for(let O=g.length-1;O>=0;O--)l+=g[O].nodeSize;u&&l++}return l}findAtPoint(l,u){if(this.find)for(let g=0;g<this.find.length;g++)this.find[g].node==l&&this.find[g].offset==u&&(this.find[g].pos=this.currentPos)}findInside(l){if(this.find)for(let u=0;u<this.find.length;u++)null==this.find[u].pos&&1==l.nodeType&&l.contains(this.find[u].node)&&(this.find[u].pos=this.currentPos)}findAround(l,u,g){if(l!=u&&this.find)for(let O=0;O<this.find.length;O++)null==this.find[O].pos&&1==l.nodeType&&l.contains(this.find[O].node)&&u.compareDocumentPosition(this.find[O].node)&(g?2:4)&&(this.find[O].pos=this.currentPos)}findInText(l){if(this.find)for(let u=0;u<this.find.length;u++)this.find[u].node==l&&(this.find[u].pos=this.currentPos-(l.nodeValue.length-this.find[u].offset))}matchesContext(l){if(l.indexOf("|")>-1)return l.split(/\s*\|\s*/).some(this.matchesContext,this);let u=l.split("/"),g=this.options.context,O=!(this.isOpen||g&&g.parent.type!=this.nodes[0].type),L=(O?0:1)-(g?g.depth+1:0),V=(_t,kt)=>{for(;_t>=0;_t--){let Yt=u[_t];if(""==Yt){if(_t==u.length-1||0==_t)continue;for(;kt>=L;kt--)if(V(_t-1,kt))return!0;return!1}{let Gt=kt>0||0==kt&&O?this.nodes[kt].type:g&&kt>=L?g.node(kt-L).type:null;if(!Gt||Gt.name!=Yt&&-1==Gt.groups.indexOf(Yt))return!1;kt--}}return!0};return V(u.length-1,this.open)}textblockFromContext(){let l=this.options.context;if(l)for(let u=l.depth;u>=0;u--){let g=l.node(u).contentMatchAt(l.indexAfter(u)).defaultType;if(g&&g.isTextblock&&g.defaultAttrs)return g}for(let u in this.parser.schema.nodes){let g=this.parser.schema.nodes[u];if(g.isTextblock&&g.defaultAttrs)return g}}addPendingMark(l){let u=function(z,l){for(let u=0;u<l.length;u++)if(z.eq(l[u]))return l[u]}(l,this.top.pendingMarks);u&&this.top.stashMarks.push(u),this.top.pendingMarks=l.addToSet(this.top.pendingMarks)}removePendingMark(l,u){for(let g=this.open;g>=0;g--){let O=this.nodes[g];if(O.pendingMarks.lastIndexOf(l)>-1)O.pendingMarks=l.removeFromSet(O.pendingMarks);else{O.activeMarks=l.removeFromSet(O.activeMarks);let V=O.popFromStashMark(l);V&&O.type&&O.type.allowsMarkType(V.type)&&(O.activeMarks=V.addToSet(O.activeMarks))}if(O==u)break}}}function R(z,l){return(z.matches||z.msMatchesSelector||z.webkitMatchesSelector||z.mozMatchesSelector).call(z,l)}function U(z){let l={};for(let u in z)l[u]=z[u];return l}function st(z,l){let u=l.schema.nodes;for(let g in u){let O=u[g];if(!O.allowsMarkType(z))continue;let L=[],V=_t=>{L.push(_t);for(let kt=0;kt<_t.edgeCount;kt++){let{type:Yt,next:Gt}=_t.edge(kt);if(Yt==l||L.indexOf(Gt)<0&&V(Gt))return!0}};if(V(O.contentMatch))return!0}}class Wt{constructor(l,u){this.nodes=l,this.marks=u}serializeFragment(l,u={},g){g||(g=Zt(u).createDocumentFragment());let O=g,L=[];return l.forEach(V=>{if(L.length||V.marks.length){let _t=0,kt=0;for(;_t<L.length&&kt<V.marks.length;){let Yt=V.marks[kt];if(this.marks[Yt.type.name]){if(!Yt.eq(L[_t][0])||!1===Yt.type.spec.spanning)break;_t++,kt++}else kt++}for(;_t<L.length;)O=L.pop()[1];for(;kt<V.marks.length;){let Yt=V.marks[kt++],Gt=this.serializeMark(Yt,V.isInline,u);Gt&&(L.push([Yt,O]),O.appendChild(Gt.dom),O=Gt.contentDOM||Gt.dom)}}O.appendChild(this.serializeNodeInner(V,u))}),g}serializeNodeInner(l,u){let{dom:g,contentDOM:O}=Wt.renderSpec(Zt(u),this.nodes[l.type.name](l));if(O){if(l.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(l.content,u,O)}return g}serializeNode(l,u={}){let g=this.serializeNodeInner(l,u);for(let O=l.marks.length-1;O>=0;O--){let L=this.serializeMark(l.marks[O],l.isInline,u);L&&((L.contentDOM||L.dom).appendChild(g),g=L.dom)}return g}serializeMark(l,u,g={}){let O=this.marks[l.type.name];return O&&Wt.renderSpec(Zt(g),O(l,u))}static renderSpec(l,u,g=null){if("string"==typeof u)return{dom:l.createTextNode(u)};if(null!=u.nodeType)return{dom:u};if(u.dom&&null!=u.dom.nodeType)return u;let O=u[0],L=O.indexOf(" ");L>0&&(g=O.slice(0,L),O=O.slice(L+1));let V,_t=g?l.createElementNS(g,O):l.createElement(O),kt=u[1],Yt=1;if(kt&&"object"==typeof kt&&null==kt.nodeType&&!Array.isArray(kt)){Yt=2;for(let Gt in kt)if(null!=kt[Gt]){let Me=Gt.indexOf(" ");Me>0?_t.setAttributeNS(Gt.slice(0,Me),Gt.slice(Me+1),kt[Gt]):_t.setAttribute(Gt,kt[Gt])}}for(let Gt=Yt;Gt<u.length;Gt++){let Me=u[Gt];if(0===Me){if(Gt<u.length-1||Gt>Yt)throw new RangeError("Content hole must be the only child of its parent node");return{dom:_t,contentDOM:_t}}{let{dom:cn,contentDOM:be}=Wt.renderSpec(l,Me,g);if(_t.appendChild(cn),be){if(V)throw new RangeError("Multiple content holes");V=be}}}return{dom:_t,contentDOM:V}}static fromSchema(l){return l.cached.domSerializer||(l.cached.domSerializer=new Wt(this.nodesFromSchema(l),this.marksFromSchema(l)))}static nodesFromSchema(l){let u=$t(l.nodes);return u.text||(u.text=g=>g.text),u}static marksFromSchema(l){return $t(l.marks)}}function $t(z){let l={};for(let u in z){let g=z[u].spec.toDOM;g&&(l[u]=g)}return l}function Zt(z){return z.document||window.document}},62463:(Kt,Mt,d)=>{d.d(Mt,{C1:()=>xt,yy:()=>Pt,qv:()=>ut,Sy:()=>bt,H$:()=>ee,Y1:()=>P,xm:()=>m,Bs:()=>pt});var T=d(35917),s=d(38480);const H=Object.create(null);class P{constructor(A,et,at){this.$anchor=A,this.$head=et,this.ranges=at||[new m(A.min(et),A.max(et))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let A=this.ranges;for(let et=0;et<A.length;et++)if(A[et].$from.pos!=A[et].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(A,et=T.p2.empty){let at=et.content.lastChild,Tt=null;for(let dt=0;dt<et.openEnd;dt++)Tt=at,at=at.lastChild;let W=A.steps.length,J=this.ranges;for(let dt=0;dt<J.length;dt++){let{$from:Lt,$to:Jt}=J[dt],qt=A.mapping.slice(W);A.replaceRange(qt.map(Lt.pos),qt.map(Jt.pos),dt?T.p2.empty:et),0==dt&&wt(A,W,(at?at.isInline:Tt&&Tt.isTextblock)?-1:1)}}replaceWith(A,et){let at=A.steps.length,Tt=this.ranges;for(let W=0;W<Tt.length;W++){let{$from:J,$to:dt}=Tt[W],Lt=A.mapping.slice(at),Jt=Lt.map(J.pos),qt=Lt.map(dt.pos);W?A.deleteRange(Jt,qt):(A.replaceRangeWith(Jt,qt,et),wt(A,at,et.isInline?-1:1))}}static findFrom(A,et,at=!1){let Tt=A.parent.inlineContent?new pt(A):gt(A.node(0),A.parent,A.pos,A.index(),et,at);if(Tt)return Tt;for(let W=A.depth-1;W>=0;W--){let J=et<0?gt(A.node(0),A.node(W),A.before(W+1),A.index(W),et,at):gt(A.node(0),A.node(W),A.after(W+1),A.index(W)+1,et,at);if(J)return J}return null}static near(A,et=1){return this.findFrom(A,et)||this.findFrom(A,-et)||new xt(A.node(0))}static atStart(A){return gt(A,A,0,0,1)||new xt(A)}static atEnd(A){return gt(A,A,A.content.size,A.childCount,-1)||new xt(A)}static fromJSON(A,et){if(!et||!et.type)throw new RangeError("Invalid input for Selection.fromJSON");let at=H[et.type];if(!at)throw new RangeError(`No selection type ${et.type} defined`);return at.fromJSON(A,et)}static jsonID(A,et){if(A in H)throw new RangeError("Duplicate use of selection JSON ID "+A);return H[A]=et,et.prototype.jsonID=A,et}getBookmark(){return pt.between(this.$anchor,this.$head).getBookmark()}}P.prototype.visible=!0;class m{constructor(A,et){this.$from=A,this.$to=et}}let ct=!1;function I(ft){!ct&&!ft.parent.inlineContent&&(ct=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+ft.parent.type.name+")"))}class pt extends P{constructor(A,et=A){I(A),I(et),super(A,et)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(A,et){let at=A.resolve(et.map(this.head));if(!at.parent.inlineContent)return P.near(at);let Tt=A.resolve(et.map(this.anchor));return new pt(Tt.parent.inlineContent?Tt:at,at)}replace(A,et=T.p2.empty){if(super.replace(A,et),et==T.p2.empty){let at=this.$from.marksAcross(this.$to);at&&A.ensureMarks(at)}}eq(A){return A instanceof pt&&A.anchor==this.anchor&&A.head==this.head}getBookmark(){return new ot(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(A,et){if("number"!=typeof et.anchor||"number"!=typeof et.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new pt(A.resolve(et.anchor),A.resolve(et.head))}static create(A,et,at=et){let Tt=A.resolve(et);return new this(Tt,at==et?Tt:A.resolve(at))}static between(A,et,at){let Tt=A.pos-et.pos;if((!at||Tt)&&(at=Tt>=0?1:-1),!et.parent.inlineContent){let W=P.findFrom(et,at,!0)||P.findFrom(et,-at,!0);if(!W)return P.near(et,at);et=W.$head}return A.parent.inlineContent||(0==Tt||(A=(P.findFrom(A,-at,!0)||P.findFrom(A,at,!0)).$anchor).pos<et.pos!=Tt<0)&&(A=et),new pt(A,et)}}P.jsonID("text",pt);class ot{constructor(A,et){this.anchor=A,this.head=et}map(A){return new ot(A.map(this.anchor),A.map(this.head))}resolve(A){return pt.between(A.resolve(this.anchor),A.resolve(this.head))}}class ut extends P{constructor(A){let et=A.nodeAfter,at=A.node(0).resolve(A.pos+et.nodeSize);super(A,at),this.node=et}map(A,et){let{deleted:at,pos:Tt}=et.mapResult(this.anchor),W=A.resolve(Tt);return at?P.near(W):new ut(W)}content(){return new T.p2(T.HY.from(this.node),0,0)}eq(A){return A instanceof ut&&A.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ht(this.anchor)}static fromJSON(A,et){if("number"!=typeof et.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ut(A.resolve(et.anchor))}static create(A,et){return new ut(A.resolve(et))}static isSelectable(A){return!A.isText&&!1!==A.type.spec.selectable}}ut.prototype.visible=!1,P.jsonID("node",ut);class ht{constructor(A){this.anchor=A}map(A){let{deleted:et,pos:at}=A.mapResult(this.anchor);return et?new ot(at,at):new ht(at)}resolve(A){let et=A.resolve(this.anchor),at=et.nodeAfter;return at&&ut.isSelectable(at)?new ut(et):P.near(et)}}class xt extends P{constructor(A){super(A.resolve(0),A.resolve(A.content.size))}replace(A,et=T.p2.empty){if(et==T.p2.empty){A.delete(0,A.doc.content.size);let at=P.atStart(A.doc);at.eq(A.selection)||A.setSelection(at)}else super.replace(A,et)}toJSON(){return{type:"all"}}static fromJSON(A){return new xt(A)}map(A){return new xt(A)}eq(A){return A instanceof xt}getBookmark(){return mt}}P.jsonID("all",xt);const mt={map(){return this},resolve:ft=>new xt(ft)};function gt(ft,A,et,at,Tt,W=!1){if(A.inlineContent)return pt.create(ft,et);for(let J=at-(Tt>0?0:1);Tt>0?J<A.childCount:J>=0;J+=Tt){let dt=A.child(J);if(dt.isAtom){if(!W&&ut.isSelectable(dt))return ut.create(ft,et-(Tt<0?dt.nodeSize:0))}else{let Lt=gt(ft,dt,et+Tt,Tt<0?dt.childCount:0,Tt,W);if(Lt)return Lt}et+=dt.nodeSize*Tt}return null}function wt(ft,A,et){let at=ft.steps.length-1;if(at<A)return;let J,Tt=ft.steps[at];(Tt instanceof s.Pu||Tt instanceof s.FC)&&(ft.mapping.maps[at].forEach((dt,Lt,Jt,qt)=>{null==J&&(J=qt)}),ft.setSelection(P.near(ft.doc.resolve(J),et)))}class Q extends s.wx{constructor(A){super(A.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=A.selection,this.storedMarks=A.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(A){if(A.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=A,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(A){return this.storedMarks=A,this.updated|=2,this}ensureMarks(A){return T.vc.sameSet(this.storedMarks||this.selection.$from.marks(),A)||this.setStoredMarks(A),this}addStoredMark(A){return this.ensureMarks(A.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(A){return this.ensureMarks(A.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(A,et){super.addStep(A,et),this.updated=-3&this.updated,this.storedMarks=null}setTime(A){return this.time=A,this}replaceSelection(A){return this.selection.replace(this,A),this}replaceSelectionWith(A,et=!0){let at=this.selection;return et&&(A=A.mark(this.storedMarks||(at.empty?at.$from.marks():at.$from.marksAcross(at.$to)||T.vc.none))),at.replaceWith(this,A),this}deleteSelection(){return this.selection.replace(this),this}insertText(A,et,at){let Tt=this.doc.type.schema;if(null==et)return A?this.replaceSelectionWith(Tt.text(A),!0):this.deleteSelection();{if(null==at&&(at=et),at=null==at?et:at,!A)return this.deleteRange(et,at);let W=this.storedMarks;if(!W){let J=this.doc.resolve(et);W=at==et?J.marks():J.marksAcross(this.doc.resolve(at))}return this.replaceRangeWith(et,at,Tt.text(A,W)),this.selection.empty||this.setSelection(P.near(this.selection.$to)),this}}setMeta(A,et){return this.meta["string"==typeof A?A:A.key]=et,this}getMeta(A){return this.meta["string"==typeof A?A:A.key]}get isGeneric(){for(let A in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function it(ft,A){return A&&ft?ft.bind(A):ft}class K{constructor(A,et,at){this.name=A,this.init=it(et.init,at),this.apply=it(et.apply,at)}}const vt=[new K("doc",{init:ft=>ft.doc||ft.schema.topNodeType.createAndFill(),apply:ft=>ft.doc}),new K("selection",{init:(ft,A)=>ft.selection||P.atStart(A.doc),apply:ft=>ft.selection}),new K("storedMarks",{init:ft=>ft.storedMarks||null,apply:(ft,A,et,at)=>at.selection.$cursor?ft.storedMarks:null}),new K("scrollToSelection",{init:()=>0,apply:(ft,A)=>ft.scrolledIntoView?A+1:A})];class yt{constructor(A,et){this.schema=A,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=vt.slice(),et&&et.forEach(at=>{if(this.pluginsByKey[at.key])throw new RangeError("Adding different instances of a keyed plugin ("+at.key+")");this.plugins.push(at),this.pluginsByKey[at.key]=at,at.spec.state&&this.fields.push(new K(at.key,at.spec.state,at))})}}class Pt{constructor(A){this.config=A}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(A){return this.applyTransaction(A).state}filterTransaction(A,et=-1){for(let at=0;at<this.config.plugins.length;at++)if(at!=et){let Tt=this.config.plugins[at];if(Tt.spec.filterTransaction&&!Tt.spec.filterTransaction.call(Tt,A,this))return!1}return!0}applyTransaction(A){if(!this.filterTransaction(A))return{state:this,transactions:[]};let et=[A],at=this.applyInner(A),Tt=null;for(;;){let W=!1;for(let J=0;J<this.config.plugins.length;J++){let dt=this.config.plugins[J];if(dt.spec.appendTransaction){let Lt=Tt?Tt[J].n:0,Jt=Tt?Tt[J].state:this,qt=Lt<et.length&&dt.spec.appendTransaction.call(dt,Lt?et.slice(Lt):et,Jt,at);if(qt&&at.filterTransaction(qt,J)){if(qt.setMeta("appendedTransaction",A),!Tt){Tt=[];for(let ce=0;ce<this.config.plugins.length;ce++)Tt.push(ce<J?{state:at,n:et.length}:{state:this,n:0})}et.push(qt),at=at.applyInner(qt),W=!0}Tt&&(Tt[J]={state:at,n:et.length})}}if(!W)return{state:at,transactions:et}}}applyInner(A){if(!A.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let et=new Pt(this.config),at=this.config.fields;for(let Tt=0;Tt<at.length;Tt++){let W=at[Tt];et[W.name]=W.apply(A,this[W.name],this,et)}return et}get tr(){return new Q(this)}static create(A){let et=new yt(A.doc?A.doc.type.schema:A.schema,A.plugins),at=new Pt(et);for(let Tt=0;Tt<et.fields.length;Tt++)at[et.fields[Tt].name]=et.fields[Tt].init(A,at);return at}reconfigure(A){let et=new yt(this.schema,A.plugins),at=et.fields,Tt=new Pt(et);for(let W=0;W<at.length;W++){let J=at[W].name;Tt[J]=this.hasOwnProperty(J)?this[J]:at[W].init(A,Tt)}return Tt}toJSON(A){let et={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(et.storedMarks=this.storedMarks.map(at=>at.toJSON())),A&&"object"==typeof A)for(let at in A){if("doc"==at||"selection"==at)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let Tt=A[at],W=Tt.spec.state;W&&W.toJSON&&(et[at]=W.toJSON.call(Tt,this[Tt.key]))}return et}static fromJSON(A,et,at){if(!et)throw new RangeError("Invalid input for EditorState.fromJSON");if(!A.schema)throw new RangeError("Required config field 'schema' missing");let Tt=new yt(A.schema,A.plugins),W=new Pt(Tt);return Tt.fields.forEach(J=>{if("doc"==J.name)W.doc=T.NB.fromJSON(A.schema,et.doc);else if("selection"==J.name)W.selection=P.fromJSON(W.doc,et.selection);else if("storedMarks"==J.name)et.storedMarks&&(W.storedMarks=et.storedMarks.map(A.schema.markFromJSON));else{if(at)for(let dt in at){let Lt=at[dt],Jt=Lt.spec.state;if(Lt.key==J.name&&Jt&&Jt.fromJSON&&Object.prototype.hasOwnProperty.call(et,dt))return void(W[J.name]=Jt.fromJSON.call(Lt,A,et[dt],W))}W[J.name]=J.init(A,W)}}),W}}function Dt(ft,A,et){for(let at in ft){let Tt=ft[at];Tt instanceof Function?Tt=Tt.bind(A):"handleDOMEvents"==at&&(Tt=Dt(Tt,A,{})),et[at]=Tt}return et}class bt{constructor(A){this.spec=A,this.props={},A.props&&Dt(A.props,this,this.props),this.key=A.key?A.key.key:zt("plugin")}getState(A){return A[this.key]}}const Nt=Object.create(null);function zt(ft){return ft in Nt?ft+"$"+ ++Nt[ft]:(Nt[ft]=0,ft+"$")}class ee{constructor(A="key"){this.key=zt(A)}get(A){return A.config.pluginsByKey[this.key]}getState(A){return A[this.key]}}},38480:(Kt,Mt,d)=>{d.d(Mt,{vs:()=>mt,FC:()=>K,Pu:()=>it,wx:()=>Pe,Mn:()=>Jt,Ax:()=>dt,nj:()=>Ke,nd:()=>ee,k9:()=>Nt,dR:()=>Qe});var T=d(35917);const H=Math.pow(2,16);function P(G,E){return G+E*H}function m(G){return 65535&G}class ht{constructor(E,D,B){this.pos=E,this.delInfo=D,this.recover=B}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class xt{constructor(E,D=!1){if(this.ranges=E,this.inverted=D,!E.length&&xt.empty)return xt.empty}recover(E){let D=0,B=m(E);if(!this.inverted)for(let R=0;R<B;R++)D+=this.ranges[3*R+2]-this.ranges[3*R+1];return this.ranges[3*B]+D+((G=E)-(65535&G))/H;var G}mapResult(E,D=1){return this._map(E,D,!1)}map(E,D=1){return this._map(E,D,!0)}_map(E,D,B){let R=0,$=this.inverted?2:1,U=this.inverted?1:2;for(let st=0;st<this.ranges.length;st+=3){let Rt=this.ranges[st]-(this.inverted?R:0);if(Rt>E)break;let Wt=this.ranges[st+$],$t=this.ranges[st+U],Zt=Rt+Wt;if(E<=Zt){let l=Rt+R+((Wt?E==Rt?-1:E==Zt?1:D:D)<0?0:$t);if(B)return l;let u=E==(D<0?Rt:Zt)?null:P(st/3,E-Rt),g=E==Rt?2:E==Zt?1:4;return(D<0?E!=Rt:E!=Zt)&&(g|=8),new ht(l,g,u)}R+=$t-Wt}return B?E+R:new ht(E+R,0,null)}touches(E,D){let B=0,R=m(D),$=this.inverted?2:1,U=this.inverted?1:2;for(let st=0;st<this.ranges.length;st+=3){let Rt=this.ranges[st]-(this.inverted?B:0);if(Rt>E)break;let Wt=this.ranges[st+$];if(E<=Rt+Wt&&st==3*R)return!0;B+=this.ranges[st+U]-Wt}return!1}forEach(E){let D=this.inverted?2:1,B=this.inverted?1:2;for(let R=0,$=0;R<this.ranges.length;R+=3){let U=this.ranges[R],st=U-(this.inverted?$:0),Rt=U+(this.inverted?0:$),Wt=this.ranges[R+D],$t=this.ranges[R+B];E(st,st+Wt,Rt,Rt+$t),$+=$t-Wt}}invert(){return new xt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(E){return 0==E?xt.empty:new xt(E<0?[0,-E,0]:[0,0,E])}}xt.empty=new xt([]);class mt{constructor(E=[],D,B=0,R=E.length){this.maps=E,this.mirror=D,this.from=B,this.to=R}slice(E=0,D=this.maps.length){return new mt(this.maps,this.mirror,E,D)}copy(){return new mt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(E,D){this.to=this.maps.push(E),null!=D&&this.setMirror(this.maps.length-1,D)}appendMapping(E){for(let D=0,B=this.maps.length;D<E.maps.length;D++){let R=E.getMirror(D);this.appendMap(E.maps[D],null!=R&&R<D?B+R:void 0)}}getMirror(E){if(this.mirror)for(let D=0;D<this.mirror.length;D++)if(this.mirror[D]==E)return this.mirror[D+(D%2?-1:1)]}setMirror(E,D){this.mirror||(this.mirror=[]),this.mirror.push(E,D)}appendMappingInverted(E){for(let D=E.maps.length-1,B=this.maps.length+E.maps.length;D>=0;D--){let R=E.getMirror(D);this.appendMap(E.maps[D].invert(),null!=R&&R>D?B-R-1:void 0)}}invert(){let E=new mt;return E.appendMappingInverted(this),E}map(E,D=1){if(this.mirror)return this._map(E,D,!0);for(let B=this.from;B<this.to;B++)E=this.maps[B].map(E,D);return E}mapResult(E,D=1){return this._map(E,D,!1)}_map(E,D,B){let R=0;for(let $=this.from;$<this.to;$++){let st=this.maps[$].mapResult(E,D);if(null!=st.recover){let Rt=this.getMirror($);if(null!=Rt&&Rt>$&&Rt<this.to){$=Rt,E=this.maps[Rt].recover(st.recover);continue}}R|=st.delInfo,E=st.pos}return B?E:new ht(E,R,null)}}const gt=Object.create(null);class wt{getMap(){return xt.empty}merge(E){return null}static fromJSON(E,D){if(!D||!D.stepType)throw new RangeError("Invalid input for Step.fromJSON");let B=gt[D.stepType];if(!B)throw new RangeError(`No step type ${D.stepType} defined`);return B.fromJSON(E,D)}static jsonID(E,D){if(E in gt)throw new RangeError("Duplicate use of step JSON ID "+E);return gt[E]=D,D.prototype.jsonID=E,D}}class Ot{constructor(E,D){this.doc=E,this.failed=D}static ok(E){return new Ot(E,null)}static fail(E){return new Ot(null,E)}static fromReplace(E,D,B,R){try{return Ot.ok(E.replace(D,B,R))}catch($){if($ instanceof T.e4)return Ot.fail($.message);throw $}}}function Et(G,E,D){let B=[];for(let R=0;R<G.childCount;R++){let $=G.child(R);$.content.size&&($=$.copy(Et($.content,E,$))),$.isInline&&($=E($,D,R)),B.push($)}return T.HY.fromArray(B)}class X extends wt{constructor(E,D,B){super(),this.from=E,this.to=D,this.mark=B}apply(E){let D=E.slice(this.from,this.to),B=E.resolve(this.from),R=B.node(B.sharedDepth(this.to)),$=new T.p2(Et(D.content,(U,st)=>U.isAtom&&st.type.allowsMarkType(this.mark.type)?U.mark(this.mark.addToSet(U.marks)):U,R),D.openStart,D.openEnd);return Ot.fromReplace(E,this.from,this.to,$)}invert(){return new Q(this.from,this.to,this.mark)}map(E){let D=E.mapResult(this.from,1),B=E.mapResult(this.to,-1);return D.deleted&&B.deleted||D.pos>=B.pos?null:new X(D.pos,B.pos,this.mark)}merge(E){return E instanceof X&&E.mark.eq(this.mark)&&this.from<=E.to&&this.to>=E.from?new X(Math.min(this.from,E.from),Math.max(this.to,E.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(E,D){if("number"!=typeof D.from||"number"!=typeof D.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new X(D.from,D.to,E.markFromJSON(D.mark))}}wt.jsonID("addMark",X);class Q extends wt{constructor(E,D,B){super(),this.from=E,this.to=D,this.mark=B}apply(E){let D=E.slice(this.from,this.to),B=new T.p2(Et(D.content,R=>R.mark(this.mark.removeFromSet(R.marks)),E),D.openStart,D.openEnd);return Ot.fromReplace(E,this.from,this.to,B)}invert(){return new X(this.from,this.to,this.mark)}map(E){let D=E.mapResult(this.from,1),B=E.mapResult(this.to,-1);return D.deleted&&B.deleted||D.pos>=B.pos?null:new Q(D.pos,B.pos,this.mark)}merge(E){return E instanceof Q&&E.mark.eq(this.mark)&&this.from<=E.to&&this.to>=E.from?new Q(Math.min(this.from,E.from),Math.max(this.to,E.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(E,D){if("number"!=typeof D.from||"number"!=typeof D.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Q(D.from,D.to,E.markFromJSON(D.mark))}}wt.jsonID("removeMark",Q);class it extends wt{constructor(E,D,B,R=!1){super(),this.from=E,this.to=D,this.slice=B,this.structure=R}apply(E){return this.structure&&vt(E,this.from,this.to)?Ot.fail("Structure replace would overwrite content"):Ot.fromReplace(E,this.from,this.to,this.slice)}getMap(){return new xt([this.from,this.to-this.from,this.slice.size])}invert(E){return new it(this.from,this.from+this.slice.size,E.slice(this.from,this.to))}map(E){let D=E.mapResult(this.from,1),B=E.mapResult(this.to,-1);return D.deletedAcross&&B.deletedAcross?null:new it(D.pos,Math.max(D.pos,B.pos),this.slice)}merge(E){if(!(E instanceof it)||E.structure||this.structure)return null;if(this.from+this.slice.size!=E.from||this.slice.openEnd||E.slice.openStart){if(E.to!=this.from||this.slice.openStart||E.slice.openEnd)return null;{let D=this.slice.size+E.slice.size==0?T.p2.empty:new T.p2(E.slice.content.append(this.slice.content),E.slice.openStart,this.slice.openEnd);return new it(E.from,this.to,D,this.structure)}}{let D=this.slice.size+E.slice.size==0?T.p2.empty:new T.p2(this.slice.content.append(E.slice.content),this.slice.openStart,E.slice.openEnd);return new it(this.from,this.to+(E.to-E.from),D,this.structure)}}toJSON(){let E={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(E.slice=this.slice.toJSON()),this.structure&&(E.structure=!0),E}static fromJSON(E,D){if("number"!=typeof D.from||"number"!=typeof D.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new it(D.from,D.to,T.p2.fromJSON(E,D.slice),!!D.structure)}}wt.jsonID("replace",it);class K extends wt{constructor(E,D,B,R,$,U,st=!1){super(),this.from=E,this.to=D,this.gapFrom=B,this.gapTo=R,this.slice=$,this.insert=U,this.structure=st}apply(E){if(this.structure&&(vt(E,this.from,this.gapFrom)||vt(E,this.gapTo,this.to)))return Ot.fail("Structure gap-replace would overwrite content");let D=E.slice(this.gapFrom,this.gapTo);if(D.openStart||D.openEnd)return Ot.fail("Gap is not a flat range");let B=this.slice.insertAt(this.insert,D.content);return B?Ot.fromReplace(E,this.from,this.to,B):Ot.fail("Content does not fit in gap")}getMap(){return new xt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(E){let D=this.gapTo-this.gapFrom;return new K(this.from,this.from+this.slice.size+D,this.from+this.insert,this.from+this.insert+D,E.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(E){let D=E.mapResult(this.from,1),B=E.mapResult(this.to,-1),R=E.map(this.gapFrom,-1),$=E.map(this.gapTo,1);return D.deletedAcross&&B.deletedAcross||R<D.pos||$>B.pos?null:new K(D.pos,B.pos,R,$,this.slice,this.insert,this.structure)}toJSON(){let E={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(E.slice=this.slice.toJSON()),this.structure&&(E.structure=!0),E}static fromJSON(E,D){if("number"!=typeof D.from||"number"!=typeof D.to||"number"!=typeof D.gapFrom||"number"!=typeof D.gapTo||"number"!=typeof D.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new K(D.from,D.to,D.gapFrom,D.gapTo,T.p2.fromJSON(E,D.slice),D.insert,!!D.structure)}}function vt(G,E,D){let B=G.resolve(E),R=D-E,$=B.depth;for(;R>0&&$>0&&B.indexAfter($)==B.node($).childCount;)$--,R--;if(R>0){let U=B.node($).maybeChild(B.indexAfter($));for(;R>0;){if(!U||U.isLeaf)return!0;U=U.firstChild,R--}}return!1}function bt(G,E,D){return(0==E||G.canReplace(E,G.childCount))&&(D==G.childCount||G.canReplace(0,D))}function Nt(G){let D=G.parent.content.cutByIndex(G.startIndex,G.endIndex);for(let B=G.depth;;--B){let R=G.$from.node(B),$=G.$from.index(B),U=G.$to.indexAfter(B);if(B<G.depth&&R.canReplace($,U,D))return B;if(0==B||R.type.spec.isolating||!bt(R,$,U))break}return null}function ee(G,E,D=null,B=G){let R=function(G,E){let{parent:D,startIndex:B,endIndex:R}=G,$=D.contentMatchAt(B).findWrapping(E);return $&&D.canReplaceWith(B,R,$.length?$[0]:E)?$:null}(G,E),$=R&&function(G,E){let{parent:D,startIndex:B,endIndex:R}=G,$=D.child(B),U=E.contentMatch.findWrapping($.type);if(!U)return null;let Rt=(U.length?U[U.length-1]:E).contentMatch;for(let Wt=B;Rt&&Wt<R;Wt++)Rt=Rt.matchType(D.child(Wt).type);return Rt&&Rt.validEnd?U:null}(B,E);return $?R.map(ft).concat({type:E,attrs:D}).concat($.map(ft)):null}function ft(G){return{type:G,attrs:null}}function dt(G,E,D=1,B){let R=G.resolve(E),$=R.depth-D,U=B&&B[B.length-1]||R.parent;if($<0||R.parent.type.spec.isolating||!R.parent.canReplace(R.index(),R.parent.childCount)||!U.type.validContent(R.parent.content.cutByIndex(R.index(),R.parent.childCount)))return!1;for(let Wt=R.depth-1,$t=D-2;Wt>$;Wt--,$t--){let Zt=R.node(Wt),z=R.index(Wt);if(Zt.type.spec.isolating)return!1;let l=Zt.content.cutByIndex(z,Zt.childCount),u=B&&B[$t]||Zt;if(u!=Zt&&(l=l.replaceChild(0,u.type.create(u.attrs))),!Zt.canReplace(z+1,Zt.childCount)||!u.type.validContent(l))return!1}let st=R.indexAfter($),Rt=B&&B[0];return R.node($).canReplaceWith(st,st,Rt?Rt.type:R.node($+1).type)}function Jt(G,E){let D=G.resolve(E),B=D.index();return function(G,E){return!(!G||!E||G.isLeaf||!G.canAppend(E))}(D.nodeBefore,D.nodeAfter)&&D.parent.canReplace(B,B+1)}function Ke(G,E,D){let B=G.resolve(E);if(!D.content.size)return E;let R=D.content;for(let $=0;$<D.openStart;$++)R=R.firstChild.content;for(let $=1;$<=(0==D.openStart&&D.size?2:1);$++)for(let U=B.depth;U>=0;U--){let st=U==B.depth?0:B.pos<=(B.start(U+1)+B.end(U+1))/2?-1:1,Rt=B.index(U)+(st>0?1:0),Wt=B.node(U),$t=!1;if(1==$)$t=Wt.canReplace(Rt,Rt,R);else{let Zt=Wt.contentMatchAt(Rt).findWrapping(R.firstChild.type);$t=Zt&&Wt.canReplaceWith(Rt,Rt,Zt[0])}if($t)return 0==st?B.pos:st<0?B.before(U+1):B.after(U+1)}return null}function Qe(G,E,D=E,B=T.p2.empty){if(E==D&&!B.size)return null;let R=G.resolve(E),$=G.resolve(D);return we(R,$,B)?new it(E,D,B):new he(R,$,B).fit()}function we(G,E,D){return!D.openStart&&!D.openEnd&&G.start()==E.start()&&G.parent.canReplace(G.index(),E.index(),D.content)}wt.jsonID("replaceAround",K);class he{constructor(E,D,B){this.$from=E,this.$to=D,this.unplaced=B,this.frontier=[],this.placed=T.HY.empty;for(let R=0;R<=E.depth;R++){let $=E.node(R);this.frontier.push({type:$.type,match:$.contentMatchAt(E.indexAfter(R))})}for(let R=E.depth;R>0;R--)this.placed=T.HY.from(E.node(R).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let Wt=this.findFittable();Wt?this.placeNodes(Wt):this.openMore()||this.dropNode()}let E=this.mustMoveInline(),D=this.placed.size-this.depth-this.$from.depth,B=this.$from,R=this.close(E<0?this.$to:B.doc.resolve(E));if(!R)return null;let $=this.placed,U=B.depth,st=R.depth;for(;U&&st&&1==$.childCount;)$=$.firstChild.content,U--,st--;let Rt=new T.p2($,U,st);return E>-1?new K(B.pos,E,this.$to.pos,this.$to.end(),Rt,D):Rt.size||B.pos!=this.$to.pos?new it(B.pos,R.pos,Rt):null}findFittable(){for(let E=1;E<=2;E++)for(let D=this.unplaced.openStart;D>=0;D--){let B,R=null;D?(R=Te(this.unplaced.content,D-1).firstChild,B=R.content):B=this.unplaced.content;let $=B.firstChild;for(let U=this.depth;U>=0;U--){let Wt,{type:st,match:Rt}=this.frontier[U],$t=null;if(1==E&&($?Rt.matchType($.type)||($t=Rt.fillBefore(T.HY.from($),!1)):R&&st.compatibleContent(R.type)))return{sliceDepth:D,frontierDepth:U,parent:R,inject:$t};if(2==E&&$&&(Wt=Rt.findWrapping($.type)))return{sliceDepth:D,frontierDepth:U,parent:R,wrap:Wt};if(R&&Rt.matchType(R.type))break}}}openMore(){let{content:E,openStart:D,openEnd:B}=this.unplaced,R=Te(E,D);return!(!R.childCount||R.firstChild.isLeaf||(this.unplaced=new T.p2(E,D+1,Math.max(B,R.size+D>=E.size-B?D+1:0)),0))}dropNode(){let{content:E,openStart:D,openEnd:B}=this.unplaced,R=Te(E,D);if(R.childCount<=1&&D>0){let $=E.size-D<=D+R.size;this.unplaced=new T.p2(De(E,D-1,1),D-1,$?D-1:B)}else this.unplaced=new T.p2(De(E,D,1),D,B)}placeNodes({sliceDepth:E,frontierDepth:D,parent:B,inject:R,wrap:$}){for(;this.depth>D;)this.closeFrontierNode();if($)for(let g=0;g<$.length;g++)this.openFrontierNode($[g]);let U=this.unplaced,st=B?B.content:U.content,Rt=U.openStart-E,Wt=0,$t=[],{match:Zt,type:z}=this.frontier[D];if(R){for(let g=0;g<R.childCount;g++)$t.push(R.child(g));Zt=Zt.matchFragment(R)}let l=st.size+E-(U.content.size-U.openEnd);for(;Wt<st.childCount;){let g=st.child(Wt),O=Zt.matchType(g.type);if(!O)break;Wt++,(Wt>1||0==Rt||g.content.size)&&(Zt=O,$t.push(Ue(g.mark(z.allowedMarks(g.marks)),1==Wt?Rt:0,Wt==st.childCount?l:-1)))}let u=Wt==st.childCount;u||(l=-1),this.placed=Ie(this.placed,D,T.HY.from($t)),this.frontier[D].match=Zt,u&&l<0&&B&&B.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,O=st;g<l;g++){let L=O.lastChild;this.frontier.push({type:L.type,match:L.contentMatchAt(L.childCount)}),O=L.content}this.unplaced=u?0==E?T.p2.empty:new T.p2(De(U.content,E-1,1),E-1,l<0?U.openEnd:E-1):new T.p2(De(U.content,E,Wt),U.openStart,U.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let D,E=this.frontier[this.depth];if(!E.type.isTextblock||!de(this.$to,this.$to.depth,E.type,E.match,!1)||this.$to.depth==this.depth&&(D=this.findCloseLevel(this.$to))&&D.depth==this.depth)return-1;let{depth:B}=this.$to,R=this.$to.after(B);for(;B>1&&R==this.$to.end(--B);)++R;return R}findCloseLevel(E){t:for(let D=Math.min(this.depth,E.depth);D>=0;D--){let{match:B,type:R}=this.frontier[D],$=D<E.depth&&E.end(D+1)==E.pos+(E.depth-(D+1)),U=de(E,D,R,B,$);if(U){for(let st=D-1;st>=0;st--){let{match:Rt,type:Wt}=this.frontier[st],$t=de(E,st,Wt,Rt,!0);if(!$t||$t.childCount)continue t}return{depth:D,fit:U,move:$?E.doc.resolve(E.after(D+1)):E}}}}close(E){let D=this.findCloseLevel(E);if(!D)return null;for(;this.depth>D.depth;)this.closeFrontierNode();D.fit.childCount&&(this.placed=Ie(this.placed,D.depth,D.fit)),E=D.move;for(let B=D.depth+1;B<=E.depth;B++){let R=E.node(B),$=R.type.contentMatch.fillBefore(R.content,!0,E.index(B));this.openFrontierNode(R.type,R.attrs,$)}return E}openFrontierNode(E,D=null,B){let R=this.frontier[this.depth];R.match=R.match.matchType(E),this.placed=Ie(this.placed,this.depth,T.HY.from(E.create(D,B))),this.frontier.push({type:E,match:E.contentMatch})}closeFrontierNode(){let D=this.frontier.pop().match.fillBefore(T.HY.empty,!0);D.childCount&&(this.placed=Ie(this.placed,this.frontier.length,D))}}function De(G,E,D){return 0==E?G.cutByIndex(D,G.childCount):G.replaceChild(0,G.firstChild.copy(De(G.firstChild.content,E-1,D)))}function Ie(G,E,D){return 0==E?G.append(D):G.replaceChild(G.childCount-1,G.lastChild.copy(Ie(G.lastChild.content,E-1,D)))}function Te(G,E){for(let D=0;D<E;D++)G=G.firstChild.content;return G}function Ue(G,E,D){if(E<=0)return G;let B=G.content;return E>1&&(B=B.replaceChild(0,Ue(B.firstChild,E-1,1==B.childCount?D-1:0))),E>0&&(B=G.type.contentMatch.fillBefore(B).append(B),D<=0&&(B=B.append(G.type.contentMatch.matchFragment(B).fillBefore(T.HY.empty,!0)))),G.copy(B)}function de(G,E,D,B,R){let $=G.node(E),U=R?G.indexAfter(E):G.index(E);if(U==$.childCount&&!D.compatibleContent($.type))return null;let st=B.fillBefore($.content,!0,U);return st&&!function(G,E,D){for(let B=D;B<E.childCount;B++)if(!G.allowsMarks(E.child(B).marks))return!0;return!1}(D,$.content,U)?st:null}function ze(G){return G.spec.defining||G.spec.definingForContent}function Re(G,E,D,B,R){if(E<D){let $=G.firstChild;G=G.replaceChild(0,$.copy(Re($.content,E+1,D,B,$)))}if(E>B){let $=R.contentMatchAt(0),U=$.fillBefore(G).append(G);G=U.append($.matchFragment(U).fillBefore(T.HY.empty,!0))}return G}function _e(G,E){let D=[];for(let R=Math.min(G.depth,E.depth);R>=0;R--){let $=G.start(R);if($<G.pos-(G.depth-R)||E.end(R)>E.pos+(E.depth-R)||G.node(R).type.spec.isolating||E.node(R).type.spec.isolating)break;($==E.start(R)||R==G.depth&&R==E.depth&&G.parent.inlineContent&&E.parent.inlineContent&&R&&E.start(R-1)==$-1)&&D.push(R)}return D}let Ce=class extends Error{};Ce=function G(E){let D=Error.call(this,E);return D.__proto__=G.prototype,D},(Ce.prototype=Object.create(Error.prototype)).constructor=Ce,Ce.prototype.name="TransformError";class Pe{constructor(E){this.doc=E,this.steps=[],this.docs=[],this.mapping=new mt}get before(){return this.docs.length?this.docs[0]:this.doc}step(E){let D=this.maybeStep(E);if(D.failed)throw new Ce(D.failed);return this}maybeStep(E){let D=E.apply(this.doc);return D.failed||this.addStep(E,D.doc),D}get docChanged(){return this.steps.length>0}addStep(E,D){this.docs.push(this.doc),this.steps.push(E),this.mapping.appendMap(E.getMap()),this.doc=D}replace(E,D=E,B=T.p2.empty){let R=Qe(this.doc,E,D,B);return R&&this.step(R),this}replaceWith(E,D,B){return this.replace(E,D,new T.p2(T.HY.from(B),0,0))}delete(E,D){return this.replace(E,D,T.p2.empty)}insert(E,D){return this.replaceWith(E,E,D)}replaceRange(E,D,B){return function(G,E,D,B){if(!B.size)return G.deleteRange(E,D);let R=G.doc.resolve(E),$=G.doc.resolve(D);if(we(R,$,B))return G.step(new it(E,D,B));let U=_e(R,G.doc.resolve(D));0==U[U.length-1]&&U.pop();let st=-(R.depth+1);U.unshift(st);for(let z=R.depth,l=R.pos-1;z>0;z--,l--){let u=R.node(z).type.spec;if(u.defining||u.definingAsContext||u.isolating)break;U.indexOf(z)>-1?st=z:R.before(z)==l&&U.splice(1,0,-z)}let Rt=U.indexOf(st),Wt=[],$t=B.openStart;for(let z=B.content,l=0;;l++){let u=z.firstChild;if(Wt.push(u),l==B.openStart)break;z=u.content}for(let z=$t-1;z>=0;z--){let l=Wt[z].type,u=ze(l);if(u&&R.node(Rt).type!=l)$t=z;else if(u||!l.isTextblock)break}for(let z=B.openStart;z>=0;z--){let l=(z+$t+1)%(B.openStart+1),u=Wt[l];if(u)for(let g=0;g<U.length;g++){let O=U[(g+Rt)%U.length],L=!0;O<0&&(L=!1,O=-O);let V=R.node(O-1),_t=R.index(O-1);if(V.canReplaceWith(_t,_t,u.type,u.marks))return G.replace(R.before(O),L?$.after(O):D,new T.p2(Re(B.content,0,B.openStart,l),l,B.openEnd))}}let Zt=G.steps.length;for(let z=U.length-1;z>=0&&(G.replace(E,D,B),!(G.steps.length>Zt));z--){let l=U[z];l<0||(E=R.before(l),D=$.after(l))}}(this,E,D,B),this}replaceRangeWith(E,D,B){return function(G,E,D,B){if(!B.isInline&&E==D&&G.doc.resolve(E).parent.content.size){let R=function(G,E,D){let B=G.resolve(E);if(B.parent.canReplaceWith(B.index(),B.index(),D))return E;if(0==B.parentOffset)for(let R=B.depth-1;R>=0;R--){let $=B.index(R);if(B.node(R).canReplaceWith($,$,D))return B.before(R+1);if($>0)return null}if(B.parentOffset==B.parent.content.size)for(let R=B.depth-1;R>=0;R--){let $=B.indexAfter(R);if(B.node(R).canReplaceWith($,$,D))return B.after(R+1);if($<B.node(R).childCount)return null}return null}(G.doc,E,B.type);null!=R&&(E=D=R)}G.replaceRange(E,D,new T.p2(T.HY.from(B),0,0))}(this,E,D,B),this}deleteRange(E,D){return function(G,E,D){let B=G.doc.resolve(E),R=G.doc.resolve(D),$=_e(B,R);for(let U=0;U<$.length;U++){let st=$[U],Rt=U==$.length-1;if(Rt&&0==st||B.node(st).type.contentMatch.validEnd)return G.delete(B.start(st),R.end(st));if(st>0&&(Rt||B.node(st-1).canReplace(B.index(st-1),R.indexAfter(st-1))))return G.delete(B.before(st),R.after(st))}for(let U=1;U<=B.depth&&U<=R.depth;U++)if(E-B.start(U)==B.depth-U&&D>B.end(U)&&R.end(U)-D!=R.depth-U)return G.delete(B.before(U),D);G.delete(E,D)}(this,E,D),this}lift(E,D){return function(G,E,D){let{$from:B,$to:R,depth:$}=E,U=B.before($+1),st=R.after($+1),Rt=U,Wt=st,$t=T.HY.empty,Zt=0;for(let u=$,g=!1;u>D;u--)g||B.index(u)>0?(g=!0,$t=T.HY.from(B.node(u).copy($t)),Zt++):Rt--;let z=T.HY.empty,l=0;for(let u=$,g=!1;u>D;u--)g||R.after(u+1)<R.end(u)?(g=!0,z=T.HY.from(R.node(u).copy(z)),l++):Wt++;G.step(new K(Rt,Wt,U,st,new T.p2($t.append(z),Zt,l),$t.size-Zt,!0))}(this,E,D),this}join(E,D=1){return function(G,E,D){let B=new it(E-D,E+D,T.p2.empty,!0);G.step(B)}(this,E,D),this}wrap(E,D){return function(G,E,D){let B=T.HY.empty;for(let U=D.length-1;U>=0;U--){if(B.size){let st=D[U].type.contentMatch.matchFragment(B);if(!st||!st.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}B=T.HY.from(D[U].type.create(D[U].attrs,B))}let R=E.start,$=E.end;G.step(new K(R,$,R,$,new T.p2(B,0,0),D.length,!0))}(this,E,D),this}setBlockType(E,D=E,B,R=null){return function(G,E,D,B,R){if(!B.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let $=G.steps.length;G.doc.nodesBetween(E,D,(U,st)=>{if(U.isTextblock&&!U.hasMarkup(B,R)&&function(G,E,D){let B=G.resolve(E),R=B.index();return B.parent.canReplaceWith(R,R+1,D)}(G.doc,G.mapping.slice($).map(st),B)){G.clearIncompatible(G.mapping.slice($).map(st,1),B);let Rt=G.mapping.slice($),Wt=Rt.map(st,1),$t=Rt.map(st+U.nodeSize,1);return G.step(new K(Wt,$t,Wt+1,$t-1,new T.p2(T.HY.from(B.create(R,null,U.marks)),0,0),1,!0)),!1}})}(this,E,D,B,R),this}setNodeMarkup(E,D,B=null,R=[]){return function(G,E,D,B,R){let $=G.doc.nodeAt(E);if(!$)throw new RangeError("No node at given position");D||(D=$.type);let U=D.create(B,null,R||$.marks);if($.isLeaf)return G.replaceWith(E,E+$.nodeSize,U);if(!D.validContent($.content))throw new RangeError("Invalid content for node type "+D.name);G.step(new K(E,E+$.nodeSize,E+1,E+$.nodeSize-1,new T.p2(T.HY.from(U),0,0),1,!0))}(this,E,D,B,R),this}split(E,D=1,B){return function(G,E,D=1,B){let R=G.doc.resolve(E),$=T.HY.empty,U=T.HY.empty;for(let st=R.depth,Rt=R.depth-D,Wt=D-1;st>Rt;st--,Wt--){$=T.HY.from(R.node(st).copy($));let $t=B&&B[Wt];U=T.HY.from($t?$t.type.create($t.attrs,U):R.node(st).copy(U))}G.step(new it(E,E,new T.p2($.append(U),D,D),!0))}(this,E,D,B),this}addMark(E,D,B){return function(G,E,D,B){let U,st,R=[],$=[];G.doc.nodesBetween(E,D,(Rt,Wt,$t)=>{if(!Rt.isInline)return;let Zt=Rt.marks;if(!B.isInSet(Zt)&&$t.type.allowsMarkType(B.type)){let z=Math.max(Wt,E),l=Math.min(Wt+Rt.nodeSize,D),u=B.addToSet(Zt);for(let g=0;g<Zt.length;g++)Zt[g].isInSet(u)||(U&&U.to==z&&U.mark.eq(Zt[g])?U.to=l:R.push(U=new Q(z,l,Zt[g])));st&&st.to==z?st.to=l:$.push(st=new X(z,l,B))}}),R.forEach(Rt=>G.step(Rt)),$.forEach(Rt=>G.step(Rt))}(this,E,D,B),this}removeMark(E,D,B){return function(G,E,D,B){let R=[],$=0;G.doc.nodesBetween(E,D,(U,st)=>{if(!U.isInline)return;$++;let Rt=null;if(B instanceof T.ZU){let $t,Wt=U.marks;for(;$t=B.isInSet(Wt);)(Rt||(Rt=[])).push($t),Wt=$t.removeFromSet(Wt)}else B?B.isInSet(U.marks)&&(Rt=[B]):Rt=U.marks;if(Rt&&Rt.length){let Wt=Math.min(st+U.nodeSize,D);for(let $t=0;$t<Rt.length;$t++){let z,Zt=Rt[$t];for(let l=0;l<R.length;l++){let u=R[l];u.step==$-1&&Zt.eq(R[l].style)&&(z=u)}z?(z.to=Wt,z.step=$):R.push({style:Zt,from:Math.max(st,E),to:Wt,step:$})}}}),R.forEach(U=>G.step(new Q(U.from,U.to,U.style)))}(this,E,D,B),this}clearIncompatible(E,D,B){return function(G,E,D,B=D.contentMatch){let R=G.doc.nodeAt(E),$=[],U=E+1;for(let st=0;st<R.childCount;st++){let Rt=R.child(st),Wt=U+Rt.nodeSize,$t=B.matchType(Rt.type);if($t){B=$t;for(let Zt=0;Zt<Rt.marks.length;Zt++)D.allowsMarkType(Rt.marks[Zt].type)||G.step(new Q(U,Wt,Rt.marks[Zt]))}else $.push(new it(U,Wt,T.p2.empty));U=Wt}if(!B.validEnd){let st=B.fillBefore(T.HY.empty,!0);G.replace(U,U,new T.p2(st,0,0))}for(let st=$.length-1;st>=0;st--)G.step($[st])}(this,E,D,B),this}}},43594:(Kt,Mt,d)=>{d.d(Mt,{p:()=>en,EH:()=>Ae,tk:()=>Io});var T=d(62463),s=d(35917),H=d(38480);const P="undefined"!=typeof navigator?navigator:null,m="undefined"!=typeof document?document:null,ct=P&&P.userAgent||"",I=/Edge\/(\d+)/.exec(ct),pt=/MSIE \d/.exec(ct),ot=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ct),ut=!!(pt||ot||I),ht=pt?document.documentMode:ot?+ot[1]:I?+I[1]:0,xt=!ut&&/gecko\/(\d+)/i.test(ct);xt&&/Firefox\/(\d+)/.exec(ct);const mt=!ut&&/Chrome\/(\d+)/.exec(ct),gt=!!mt,wt=mt?+mt[1]:0,Ot=!ut&&!!P&&/Apple Computer/.test(P.vendor),Et=Ot&&(/Mobile\/\w+/.test(ct)||!!P&&P.maxTouchPoints>2),X=Et||!!P&&/Mac/.test(P.platform),Q=/Android \d/.test(ct),it=!!m&&"webkitFontSmoothing"in m.documentElement.style,K=it?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,vt=function(n){for(var t=0;;t++)if(!(n=n.previousSibling))return t},yt=function(n){let t=n.assignedSlot||n.parentNode;return t&&11==t.nodeType?t.host:t};let Pt=null;const Dt=function(n,t,e){let o=Pt||(Pt=document.createRange());return o.setEnd(n,null==e?n.nodeValue.length:e),o.setStart(n,t||0),o},bt=function(n,t,e,o){return e&&(zt(n,t,e,o,-1)||zt(n,t,e,o,1))},Nt=/^(img|br|input|textarea|hr)$/i;function zt(n,t,e,o,i){for(;;){if(n==e&&t==o)return!0;if(t==(i<0?0:ee(n))){let r=n.parentNode;if(!r||1!=r.nodeType||A(n)||Nt.test(n.nodeName)||"false"==n.contentEditable)return!1;t=vt(n)+(i<0?0:1),n=r}else{if(1!=n.nodeType)return!1;if("false"==(n=n.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?ee(n):0}}}function ee(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function A(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const et=function(n){let t=n.isCollapsed;return t&&gt&&n.rangeCount&&!n.getRangeAt(0).collapsed&&(t=!1),t};function at(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function Tt(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function W(n,t){return"number"==typeof n?n:n[t]}function J(n){let t=n.getBoundingClientRect();return{left:t.left,right:t.left+n.clientWidth*(t.width/n.offsetWidth||1),top:t.top,bottom:t.top+n.clientHeight*(t.height/n.offsetHeight||1)}}function dt(n,t,e){let o=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,r=n.dom.ownerDocument;for(let c=e||n.dom;c;c=yt(c)){if(1!=c.nodeType)continue;let p=c,h=p==r.body,x=h?Tt(r):J(p),b=0,F=0;if(t.top<x.top+W(o,"top")?F=-(x.top-t.top+W(i,"top")):t.bottom>x.bottom-W(o,"bottom")&&(F=t.bottom-x.bottom+W(i,"bottom")),t.left<x.left+W(o,"left")?b=-(x.left-t.left+W(i,"left")):t.right>x.right-W(o,"right")&&(b=t.right-x.right+W(i,"right")),b||F)if(h)r.defaultView.scrollBy(b,F);else{let Y=p.scrollLeft,tt=p.scrollTop;F&&(p.scrollTop+=F),b&&(p.scrollLeft+=b);let Ct=p.scrollLeft-Y,It=p.scrollTop-tt;t={left:t.left-Ct,top:t.top-It,right:t.right-Ct,bottom:t.bottom-It}}if(h)break}}function Jt(n){let t=[],e=n.ownerDocument;for(let o=n;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),n!=e);o=yt(o));return t}function ce(n,t){for(let e=0;e<n.length;e++){let{dom:o,top:i,left:r}=n[e];o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=r&&(o.scrollLeft=r)}}let le=null;function Ke(n,t){let e,i,o=2e8,r=0,c=t.top,p=t.top;for(let h=n.firstChild,x=0;h;h=h.nextSibling,x++){let b;if(1==h.nodeType)b=h.getClientRects();else{if(3!=h.nodeType)continue;b=Dt(h).getClientRects()}for(let F=0;F<b.length;F++){let Y=b[F];if(Y.top<=c&&Y.bottom>=p){c=Math.max(Y.bottom,c),p=Math.min(Y.top,p);let tt=Y.left>t.left?Y.left-t.left:Y.right<t.left?t.left-Y.right:0;if(tt<o){e=h,o=tt,i=tt&&3==e.nodeType?{left:Y.right<t.left?Y.right:Y.left,top:t.top}:t,1==h.nodeType&&tt&&(r=x+(t.left>=(Y.left+Y.right)/2?1:0));continue}}!e&&(t.left>=Y.right&&t.top>=Y.top||t.left>=Y.left&&t.top>=Y.bottom)&&(r=x+1)}}return e&&3==e.nodeType?function(n,t){let e=n.nodeValue.length,o=document.createRange();for(let i=0;i<e;i++){o.setEnd(n,i+1),o.setStart(n,i);let r=de(o,1);if(r.top!=r.bottom&&we(t,r))return{node:n,offset:i+(t.left>=(r.left+r.right)/2?1:0)}}return{node:n,offset:0}}(e,i):!e||o&&1==e.nodeType?{node:n,offset:r}:Ke(e,i)}function we(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function Te(n,t,e){let o=n.childNodes.length;if(o&&e.top<e.bottom)for(let i=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-e.top)/(e.bottom-e.top))-2)),r=i;;){let c=n.childNodes[r];if(1==c.nodeType){let p=c.getClientRects();for(let h=0;h<p.length;h++){let x=p[h];if(we(t,x))return Te(c,t,x)}}if((r=(r+1)%o)==i)break}return n}function Ue(n,t){let o,e=n.dom.ownerDocument,i=0;if(e.caretPositionFromPoint)try{let h=e.caretPositionFromPoint(t.left,t.top);h&&({offsetNode:o,offset:i}=h)}catch(h){}if(!o&&e.caretRangeFromPoint){let h=e.caretRangeFromPoint(t.left,t.top);h&&({startContainer:o,startOffset:i}=h)}let c,r=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top);if(!r||!n.dom.contains(1!=r.nodeType?r.parentNode:r)){let h=n.dom.getBoundingClientRect();if(!we(t,h)||(r=Te(n.dom,t,h),!r))return null}if(Ot)for(let h=r;o&&h;h=yt(h))h.draggable&&(o=void 0);if(r=function(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}(r,t),o){if(xt&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length),i<o.childNodes.length)){let x,h=o.childNodes[i];"IMG"==h.nodeName&&(x=h.getBoundingClientRect()).right<=t.left&&x.bottom>t.top&&i++}o==n.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?c=n.state.doc.content.size:(0==i||1!=o.nodeType||"BR"!=o.childNodes[i-1].nodeName)&&(c=function(n,t,e,o){let i=-1;for(let r=t;r!=n.dom;){let c=n.docView.nearestDesc(r,!0);if(!c)return null;if(c.node.isBlock&&c.parent){let p=c.dom.getBoundingClientRect();if(p.left>o.left||p.top>o.top)i=c.posBefore;else{if(!(p.right<o.left||p.bottom<o.top))break;i=c.posAfter}}r=c.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,1)}(n,o,i,t))}null==c&&(c=function(n,t,e){let{node:o,offset:i}=Ke(t,e),r=-1;if(1==o.nodeType&&!o.firstChild){let c=o.getBoundingClientRect();r=c.left!=c.right&&e.left>(c.left+c.right)/2?1:-1}return n.docView.posFromDOM(o,i,r)}(n,r,t));let p=n.docView.nearestDesc(r,!0);return{pos:c,inside:p?p.posAtStart-p.border:-1}}function de(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const se=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ze(n,t,e){let{node:o,offset:i,atom:r}=n.docView.domFromPos(t,e<0?-1:1),c=it||xt;if(3==o.nodeType){if(!c||!se.test(o.nodeValue)&&(e<0?i:i!=o.nodeValue.length)){let h=i,x=i,b=e<0?1:-1;return e<0&&!i?(x++,b=-1):e>=0&&i==o.nodeValue.length?(h--,b=1):e<0?h--:x++,Ee(de(Dt(o,h,x),b),b<0)}{let h=de(Dt(o,i,i),e);if(xt&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){let x=de(Dt(o,i-1,i-1),-1);if(x.top==h.top){let b=de(Dt(o,i,i+1),-1);if(b.top!=h.top)return Ee(b,b.left<x.left)}}return h}}if(!n.state.doc.resolve(t-(r||0)).parent.inlineContent){if(null==r&&i&&(e<0||i==ee(o))){let h=o.childNodes[i-1];if(1==h.nodeType)return Re(h.getBoundingClientRect(),!1)}if(null==r&&i<ee(o)){let h=o.childNodes[i];if(1==h.nodeType)return Re(h.getBoundingClientRect(),!0)}return Re(o.getBoundingClientRect(),e>=0)}if(null==r&&i&&(e<0||i==ee(o))){let h=o.childNodes[i-1],x=3==h.nodeType?Dt(h,ee(h)-(c?0:1)):1!=h.nodeType||"BR"==h.nodeName&&h.nextSibling?null:h;if(x)return Ee(de(x,1),!1)}if(null==r&&i<ee(o)){let h=o.childNodes[i];for(;h.pmViewDesc&&h.pmViewDesc.ignoreForCoords;)h=h.nextSibling;let x=h?3==h.nodeType?Dt(h,0,c?0:1):1==h.nodeType?h:null:null;if(x)return Ee(de(x,-1),!0)}return Ee(de(3==o.nodeType?Dt(o):o,-e),e>=0)}function Ee(n,t){if(0==n.width)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Re(n,t){if(0==n.height)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Je(n,t,e){let o=n.state,i=n.root.activeElement;o!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{o!=t&&n.updateState(o),i!=n.dom&&i&&i.focus()}}const _e=/[\u0590-\u08ac]/;let Pe=null,G=null,E=!1;class st{constructor(t,e,o,i){this.parent=t,this.children=e,this.dom=o,this.contentDOM=i,this.dirty=0,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,o=this.posAtStart;;e++){let i=this.children[e];if(i==t)return o;o+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,o){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(o<0){let r,c;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(c=r.pmViewDesc)||c.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(c)+c.size:this.posAtStart}{let r,c;if(t==this.contentDOM)r=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.nextSibling}for(;r&&(!(c=r.pmViewDesc)||c.parent!=this);)r=r.nextSibling;return r?this.posBeforeChild(c):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>vt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!1;break}if(r.previousSibling)break}if(null==i&&e==t.childNodes.length)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!0;break}if(r.nextSibling)break}}return(null==i?o>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let o=!0,i=t;i;i=i.parentNode){let c,r=this.getDesc(i);if(r&&(!e||r.node)){if(!o||!(c=r.nodeDOM)||(1==c.nodeType?c.contains(1==t.nodeType?t:t.parentNode):c==t))return r;o=!1}}}getDesc(t){let e=t.pmViewDesc;for(let o=e;o;o=o.parent)if(o==this)return e}posFromDOM(t,e,o){for(let i=t;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(t,e,o)}return-1}descAt(t){for(let e=0,o=0;e<this.children.length;e++){let i=this.children[e],r=o+i.size;if(o==t&&r!=o){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<r)return i.descAt(t-o-i.border);o=r}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r,o=0,i=0;for(let r=0;o<this.children.length;o++){let c=this.children[o],p=r+c.size;if(p>t||c instanceof u){i=t-r;break}r=p}if(i)return this.children[o].domFromPos(i-this.children[o].border,e);for(;o&&!(r=this.children[o-1]).size&&r instanceof Rt&&r.side>=0;o--);if(e<=0){let r,c=!0;for(;r=o?this.children[o-1]:null,r&&r.dom.parentNode!=this.contentDOM;o--,c=!1);return r&&e&&c&&!r.border&&!r.domAtom?r.domFromPos(r.size,e):{node:this.contentDOM,offset:r?vt(r.dom)+1:0}}{let r,c=!0;for(;r=o<this.children.length?this.children[o]:null,r&&r.dom.parentNode!=this.contentDOM;o++,c=!1);return r&&c&&!r.border&&!r.domAtom?r.domFromPos(0,e):{node:this.contentDOM,offset:r?vt(r.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,o=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let c=o,p=0;;p++){let h=this.children[p],x=c+h.size;if(-1==i&&t<=x){let b=c+h.border;if(t>=b&&e<=x-h.border&&h.node&&h.contentDOM&&this.contentDOM.contains(h.contentDOM))return h.parseRange(t,e,b);t=c;for(let F=p;F>0;F--){let Y=this.children[F-1];if(Y.size&&Y.dom.parentNode==this.contentDOM&&!Y.emptyChildAt(1)){i=vt(Y.dom)+1;break}t-=Y.size}-1==i&&(i=0)}if(i>-1&&(x>e||p==this.children.length-1)){e=x;for(let b=p+1;b<this.children.length;b++){let F=this.children[b];if(F.size&&F.dom.parentNode==this.contentDOM&&!F.emptyChildAt(-1)){r=vt(F.dom);break}e+=F.size}-1==r&&(r=this.contentDOM.childNodes.length);break}c=x}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:o}=this.domFromPos(t,0);if(1!=e.nodeType||o==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[o]}setSelection(t,e,o,i=!1){let r=Math.min(t,e),c=Math.max(t,e);for(let Y=0,tt=0;Y<this.children.length;Y++){let Ct=this.children[Y],It=tt+Ct.size;if(r>tt&&c<It)return Ct.setSelection(t-tt-Ct.border,e-tt-Ct.border,o,i);tt=It}let p=this.domFromPos(t,t?-1:1),h=e==t?p:this.domFromPos(e,e?-1:1),x=o.getSelection(),b=!1;if((xt||Ot)&&t==e){let{node:Y,offset:tt}=p;if(3==Y.nodeType){if(b=!(!tt||"\n"!=Y.nodeValue[tt-1]),b&&tt==Y.nodeValue.length)for(let It,Ct=Y;Ct;Ct=Ct.parentNode){if(It=Ct.nextSibling){"BR"==It.nodeName&&(p=h={node:It.parentNode,offset:vt(It)+1});break}let Ht=Ct.pmViewDesc;if(Ht&&Ht.node&&Ht.node.isBlock)break}}else{let Ct=Y.childNodes[tt-1];b=Ct&&("BR"==Ct.nodeName||"false"==Ct.contentEditable)}}if(xt&&x.focusNode&&x.focusNode!=h.node&&1==x.focusNode.nodeType){let Y=x.focusNode.childNodes[x.focusOffset];Y&&"false"==Y.contentEditable&&(i=!0)}if(!(i||b&&Ot)&&bt(p.node,p.offset,x.anchorNode,x.anchorOffset)&&bt(h.node,h.offset,x.focusNode,x.focusOffset))return;let F=!1;if((x.extend||t==e)&&!b){x.collapse(p.node,p.offset);try{t!=e&&x.extend(h.node,h.offset),F=!0}catch(Y){if(!(Y instanceof DOMException))throw Y}}if(!F){if(t>e){let tt=p;p=h,h=tt}let Y=document.createRange();Y.setEnd(h.node,h.offset),Y.setStart(p.node,p.offset),x.removeAllRanges(),x.addRange(Y)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let o=0,i=0;i<this.children.length;i++){let r=this.children[i],c=o+r.size;if(o==c?t<=c&&e>=o:t<c&&e>o){let p=o+r.border,h=c-r.border;if(t>=p&&e<=h)return this.dirty=t==o||e==c?2:1,void(t!=p||e!=h||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-p,e-p):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}o=c}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let o=1==t?2:1;e.dirty<o&&(e.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Rt extends st{constructor(t,e,o,i){let r,c=e.type.toDOM;if("function"==typeof c&&(c=c(o,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!e.type.spec.raw){if(1!=c.nodeType){let p=document.createElement("span");p.appendChild(c),c=p}c.contentEditable="false",c.classList.add("ProseMirror-widget")}super(t,[],c,null),this.widget=e,this.widget=e,r=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Wt extends st{constructor(t,e,o,i){super(t,[],e,null),this.textDOM=o,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class $t extends st{constructor(t,e,o,i){super(t,[],o,i),this.mark=e}static create(t,e,o,i){let r=i.nodeViews[e.type.name],c=r&&r(e,i,o);return(!c||!c.dom)&&(c=s.PW.renderSpec(document,e.type.spec.toDOM(e,o))),new $t(t,e,c.dom,c.contentDOM||c.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}}slice(t,e,o){let i=$t.create(this.parent,this.mark,!0,o),r=this.children,c=this.size;e<c&&(r=un(r,e,c,o)),t>0&&(r=un(r,0,t,o));for(let p=0;p<r.length;p++)r[p].parent=i;return i.children=r,i}}class Zt extends st{constructor(t,e,o,i,r,c,p,h,x){super(t,[],r,c),this.node=e,this.outerDeco=o,this.innerDeco=i,this.nodeDOM=p,c&&this.updateChildren(h,x)}static create(t,e,o,i,r,c){let h,p=r.nodeViews[e.type.name],x=p&&p(e,r,()=>h?h.parent?h.parent.posBeforeChild(h):void 0:c,o,i),b=x&&x.dom,F=x&&x.contentDOM;if(e.isText)if(b){if(3!=b.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else b=document.createTextNode(e.text);else b||({dom:b,contentDOM:F}=s.PW.renderSpec(document,e.type.spec.toDOM(e)));!F&&!e.isText&&"BR"!=b.nodeName&&(b.hasAttribute("contenteditable")||(b.contentEditable="false"),e.type.spec.draggable&&(b.draggable=!0));let Y=b;return b=Gt(b,o,e),x?h=new g(t,e,o,i,b,F||null,Y,x,r,c+1):e.isText?new l(t,e,o,i,b,Y,r):new Zt(t,e,o,i,b,F||null,Y,r,c+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let o=this.children[e];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>s.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,o){return 0==this.dirty&&t.eq(this.node)&&Me(e,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let o=this.node.inlineContent,i=e,r=t.composing?this.localCompositionInfo(t,e):null,c=r&&r.pos>-1?r:null,p=r&&r.pos<0,h=new be(this,c&&c.node);(function(n,t,e,o){let i=t.locals(n),r=0;if(0==i.length){for(let x=0;x<n.childCount;x++){let b=n.child(x);o(b,i,t.forChild(r,b),x),r+=b.nodeSize}return}let c=0,p=[],h=null;for(let x=0;;){if(c<i.length&&i[c].to==r){let It,Ct=i[c++];for(;c<i.length&&i[c].to==r;)(It||(It=[Ct])).push(i[c++]);if(It){It.sort(Ge);for(let Ht=0;Ht<It.length;Ht++)e(It[Ht],x,!!h)}else e(Ct,x,!!h)}let b,F;if(h)F=-1,b=h,h=null;else{if(!(x<n.childCount))break;F=x,b=n.child(x++)}for(let Ct=0;Ct<p.length;Ct++)p[Ct].to<=r&&p.splice(Ct--,1);for(;c<i.length&&i[c].from<=r&&i[c].to>r;)p.push(i[c++]);let Y=r+b.nodeSize;if(b.isText){let Ct=Y;c<i.length&&i[c].from<Ct&&(Ct=i[c].from);for(let It=0;It<p.length;It++)p[It].to<Ct&&(Ct=p[It].to);Ct<Y&&(h=b.cut(Ct-r),b=b.cut(0,Ct-r),Y=Ct,F=-1)}o(b,b.isInline&&!b.isLeaf?p.filter(Ct=>!Ct.inline):p.slice(),t.forChild(r,b),F),r=Y}})(this.node,this.innerDeco,(x,b,F)=>{x.spec.marks?h.syncToMarks(x.spec.marks,o,t):x.type.side>=0&&!F&&h.syncToMarks(b==this.node.childCount?s.vc.none:this.node.child(b).marks,o,t),h.placeWidget(x,t,i)},(x,b,F,Y)=>{let tt;h.syncToMarks(x.marks,o,t),h.findNodeMatch(x,b,F,Y)||p&&t.state.selection.from>i&&t.state.selection.to<i+x.nodeSize&&(tt=h.findIndexWithChild(r.node))>-1&&h.updateNodeAt(x,b,F,tt,t)||h.updateNextNode(x,b,F,t,Y)||h.addNode(x,b,F,t,i),i+=x.nodeSize}),h.syncToMarks([],o,t),this.node.isTextblock&&h.addTextblockHacks(),h.destroyRest(),(h.changed||2==this.dirty)&&(c&&this.protectLocalComposition(t,c),O(this.contentDOM,this.children,t),Et&&function(n){if("UL"==n.nodeName||"OL"==n.nodeName){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n),n.style.cssText=t}}(this.dom))}localCompositionInfo(t,e){let{from:o,to:i}=t.state.selection;if(!(t.state.selection instanceof T.Bs)||o<e||i>e+this.node.content.size)return null;let r=t.domSelection(),c=function(n,t){for(;;){if(3==n.nodeType)return n;if(1==n.nodeType&&t>0){if(n.childNodes.length>t&&3==n.childNodes[t].nodeType)return n.childNodes[t];t=ee(n=n.childNodes[t-1])}else{if(!(1==n.nodeType&&t<n.childNodes.length))return null;n=n.childNodes[t],t=0}}}(r.focusNode,r.focusOffset);if(!c||!this.dom.contains(c.parentNode))return null;if(this.node.inlineContent){let p=c.nodeValue,h=function(n,t,e,o){for(let i=0,r=0;i<n.childCount&&r<=o;){let c=n.child(i++),p=r;if(r+=c.nodeSize,!c.isText)continue;let h=c.text;for(;i<n.childCount;){let x=n.child(i++);if(r+=x.nodeSize,!x.isText)break;h+=x.text}if(r>=e){let x=p<o?h.lastIndexOf(t,o-p-1):-1;if(x>=0&&x+t.length+p>=e)return p+x;if(e==o&&h.length>=o+t.length-p&&h.slice(o-p,o-p+t.length)==t)return o}}return-1}(this.node.content,p,o-e,i-e);return h<0?null:{node:c,pos:h,text:p}}return{node:c,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:o,text:i}){if(this.getDesc(e))return;let r=e;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let c=new Wt(this,r,e,i);t.input.compositionNodes.push(c),this.children=un(this.children,o,o+i.length,t,c)}update(t,e,o,i){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,o,i),0))}updateInner(t,e,o,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(Me(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=kt(this.dom,this.nodeDOM,_t(this.outerDeco,this.node,e),_t(t,this.node,e)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function z(n,t,e,o,i){return Gt(o,t,n),new Zt(void 0,n,t,e,o,o,o,i,0)}class l extends Zt{constructor(t,e,o,i,r,c,p){super(t,e,o,i,r,null,c,p,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,o,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,o){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,o)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,o){let i=this.node.cut(t,e),r=document.createTextNode(i.text);return new l(this.parent,i,this.outerDeco,this.innerDeco,r,r,o)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(0==t||e==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class u extends st{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class g extends Zt{constructor(t,e,o,i,r,c,p,h,x,b){super(t,e,o,i,r,c,p,x,b),this.spec=h}update(t,e,o,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(t,e,o);return r&&this.updateInner(t,e,o,i),r}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,o,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,o,i){this.spec.setSelection?this.spec.setSelection(t,e,o):super.setSelection(t,e,o,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function O(n,t,e){let o=n.firstChild,i=!1;for(let r=0;r<t.length;r++){let c=t[r],p=c.dom;if(p.parentNode==n){for(;p!=o;)o=cn(o),i=!0;o=o.nextSibling}else i=!0,n.insertBefore(p,o);if(c instanceof $t){let h=o?o.previousSibling:n.lastChild;O(c.contentDOM,c.children,e),o=h?h.nextSibling:n.firstChild}}for(;o;)o=cn(o),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const L=function(n){n&&(this.nodeName=n)};L.prototype=Object.create(null);const V=[new L];function _t(n,t,e){if(0==n.length)return V;let o=e?V[0]:new L,i=[o];for(let r=0;r<n.length;r++){let c=n[r].type.attrs;if(c){c.nodeName&&i.push(o=new L(c.nodeName));for(let p in c){let h=c[p];null!=h&&(e&&1==i.length&&i.push(o=new L(t.isInline?"span":"div")),"class"==p?o.class=(o.class?o.class+" ":"")+h:"style"==p?o.style=(o.style?o.style+";":"")+h:"nodeName"!=p&&(o[p]=h))}}}return i}function kt(n,t,e,o){if(e==V&&o==V)return t;let i=t;for(let r=0;r<o.length;r++){let c=o[r],p=e[r];if(r){let h;p&&p.nodeName==c.nodeName&&i!=n&&(h=i.parentNode)&&h.nodeName.toLowerCase()==c.nodeName||(h=document.createElement(c.nodeName),h.pmIsDeco=!0,h.appendChild(i),p=V[0]),i=h}Yt(i,p||V[0],c)}return i}function Yt(n,t,e){for(let o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&!(o in e)&&n.removeAttribute(o);for(let o in e)"class"!=o&&"style"!=o&&"nodeName"!=o&&e[o]!=t[o]&&n.setAttribute(o,e[o]);if(t.class!=e.class){let o=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let r=0;r<o.length;r++)-1==i.indexOf(o[r])&&n.classList.remove(o[r]);for(let r=0;r<i.length;r++)-1==o.indexOf(i[r])&&n.classList.add(i[r]);0==n.classList.length&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let i,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=o.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Gt(n,t,e){return kt(n,n,V,_t(t,e,1!=n.nodeType))}function Me(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function cn(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class be{constructor(t,e){this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(n,t){let e=t,o=e.children.length,i=n.childCount,r=new Map,c=[];t:for(;i>0;){let p;for(;;)if(o){let x=e.children[o-1];if(!(x instanceof $t)){p=x,o--;break}e=x,o=x.children.length}else{if(e==t)break t;o=e.parent.children.indexOf(e),e=e.parent}let h=p.node;if(h){if(h!=n.child(i-1))break;--i,r.set(p,i),c.push(p)}}return{index:i,matched:r,matches:c.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let o=t;o<e;o++)this.top.children[o].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,o){let i=0,r=this.stack.length>>1,c=Math.min(r,t.length);for(;i<c&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let p=-1;for(let h=this.index;h<Math.min(this.index+3,this.top.children.length);h++)if(this.top.children[h].matchesMark(t[r])){p=h;break}if(p>-1)p>this.index&&(this.changed=!0,this.destroyBetween(this.index,p)),this.top=this.top.children[this.index];else{let h=$t.create(this.top,t[r],e,o);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,r++}}findNodeMatch(t,e,o,i){let c,r=-1;if(i>=this.preMatch.index&&(c=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&c.matchesNode(t,e,o))r=this.top.children.indexOf(c,this.index);else for(let p=this.index,h=Math.min(this.top.children.length,p+5);p<h;p++){let x=this.top.children[p];if(x.matchesNode(t,e,o)&&!this.preMatch.matched.has(x)){r=p;break}}return!(r<0||(this.destroyBetween(this.index,r),this.index++,0))}updateNodeAt(t,e,o,i,r){let c=this.top.children[i];return 3==c.dirty&&c.dom==c.contentDOM&&(c.dirty=2),!!c.update(t,e,o,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let o=t.pmViewDesc;if(o)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==o)return i;return-1}t=e}}updateNextNode(t,e,o,i,r){for(let c=this.index;c<this.top.children.length;c++){let p=this.top.children[c];if(p instanceof Zt){let h=this.preMatch.matched.get(p);if(null!=h&&h!=r)return!1;let x=p.dom;if((!this.lock||!(x==this.lock||1==x.nodeType&&x.contains(this.lock.parentNode))||t.isText&&p.node&&p.node.isText&&p.nodeDOM.nodeValue==t.text&&3!=p.dirty&&Me(e,p.outerDeco))&&p.update(t,e,o,i))return this.destroyBetween(this.index,c),p.dom!=x&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,o,i,r){this.top.children.splice(this.index++,0,Zt.create(this.top,t,e,o,i,r)),this.changed=!0}placeWidget(t,e,o){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let r=new Rt(this.top,t,e,o);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof $t;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof l)||/\n$/.test(t.node.text))&&((Ot||gt)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);"IMG"==t&&(o.className="ProseMirror-separator",o.alt=""),"BR"==t&&(o.className="ProseMirror-trailingBreak");let i=new u(this.top,[],o,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}}function Ge(n,t){return n.type.side-t.type.side}function un(n,t,e,o,i){let r=[];for(let c=0,p=0;c<n.length;c++){let h=n[c],x=p,b=p+=h.size;x>=e||b<=t?r.push(h):(x<t&&r.push(h.slice(0,t-x,o)),i&&(r.push(i),i=void 0),b>e&&r.push(h.slice(e-x,h.size,o)))}return r}function Le(n,t=null){let e=n.domSelection(),o=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),r=i&&0==i.size,c=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(c<0)return null;let h,x,p=o.resolve(c);if(et(e)){for(h=p;i&&!i.node;)i=i.parent;let b=i.node;if(i&&b.isAtom&&T.qv.isSelectable(b)&&i.parent&&(!b.isInline||!function(n,t,e){for(let o=0==t,i=t==ee(n);o||i;){if(n==e)return!0;let r=vt(n);if(!(n=n.parentNode))return!1;o=o&&0==r,i=i&&r==ee(n)}}(e.focusNode,e.focusOffset,i.dom))){let F=i.posBefore;x=new T.qv(c==F?p:o.resolve(F))}}else{let b=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(b<0)return null;h=o.resolve(b)}return x||(x=qe(n,h,p,"pointer"==t||n.state.selection.head<p.pos&&!r?1:-1)),x}function fe(n){return n.editable?n.hasFocus():pn(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Xe(n,t=!1){let e=n.state.selection;if(We(n,e),fe(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&gt){let o=n.domSelection(),i=n.domObserver.currentSelection;if(o.anchorNode&&i.anchorNode&&bt(o.anchorNode,o.anchorOffset,i.anchorNode,i.anchorOffset))return n.input.mouseDown.delayedSelectionSync=!0,void n.domObserver.setCurSelection()}if(n.domObserver.disconnectSelection(),n.cursorWrapper)!function(n){let t=n.domSelection(),e=document.createRange(),o=n.cursorWrapper.dom,i="IMG"==o.nodeName;i?e.setEnd(o.parentNode,vt(o)+1):e.setEnd(o,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&ut&&ht<=11&&(o.disabled=!0,o.disabled=!1)}(n);else{let r,c,{anchor:o,head:i}=e;bn&&!(e instanceof T.Bs)&&(e.$from.parent.inlineContent||(r=xn(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(c=xn(n,e.to))),n.docView.setSelection(o,i,n.root,t),bn&&(r&&ln(r),c&&ln(c)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelection(),o=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=o||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!fe(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const bn=Ot||gt&&wt<63;function xn(n,t){let{node:e,offset:o}=n.docView.domFromPos(t,0),i=o<e.childNodes.length?e.childNodes[o]:null,r=o?e.childNodes[o-1]:null;if(Ot&&i&&"false"==i.contentEditable)return xe(i);if(!(i&&"false"!=i.contentEditable||r&&"false"!=r.contentEditable)){if(i)return xe(i);if(r)return xe(r)}}function xe(n){return n.contentEditable="true",Ot&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function ln(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function We(n,t){if(t instanceof T.qv){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(Bn(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else Bn(n)}function Bn(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function qe(n,t,e,o){return n.someProp("createSelectionBetween",i=>i(n,t,e))||T.Bs.between(t,e,o)}function an(n){return(!n.editable||n.root.activeElement==n.dom)&&pn(n)}function pn(n){let t=n.domSelection();if(!t.anchorNode)return!1;try{return n.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function on(n,t){let{$anchor:e,$head:o}=n.selection,i=t>0?e.max(o):e.min(o),r=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return r&&T.Y1.findFrom(r,t)}function ye(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function On(n,t,e){let o=n.state.selection;if(!(o instanceof T.Bs)){if(o instanceof T.qv&&o.node.isInline)return ye(n,new T.Bs(t>0?o.$to:o.$from));{let i=on(n.state,t);return!!i&&ye(n,i)}}if(!o.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=on(n.state,t);return!!(i&&i instanceof T.qv)&&ye(n,i)}if(!(X&&e.indexOf("m")>-1)){let c,i=o.$head,r=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!r||r.isText)return!1;let p=t<0?i.pos-r.nodeSize:i.pos;return!!(r.isAtom||(c=n.docView.descAt(p))&&!c.contentDOM)&&(T.qv.isSelectable(r)?ye(n,new T.qv(t<0?n.state.doc.resolve(i.pos-r.nodeSize):i)):!!it&&ye(n,new T.Bs(n.state.doc.resolve(t<0?p:p+r.nodeSize))))}}function tn(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function fn(n){let t=n.pmViewDesc;return t&&0==t.size&&(n.nextSibling||"BR"!=n.nodeName)}function Ze(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let i,r,c=!1;for(xt&&1==e.nodeType&&o<tn(e)&&fn(e.childNodes[o])&&(c=!0);;)if(o>0){if(1!=e.nodeType)break;{let p=e.childNodes[o-1];if(fn(p))i=e,r=--o;else{if(3!=p.nodeType)break;e=p,o=e.nodeValue.length}}}else{if(Be(e))break;{let p=e.previousSibling;for(;p&&fn(p);)i=e.parentNode,r=vt(p),p=p.previousSibling;if(p)e=p,o=tn(e);else{if(e=e.parentNode,e==n.dom)break;o=0}}}c?C(n,t,e,o):i&&C(n,t,i,r)}function rn(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let r,c,i=tn(e);for(;;)if(o<i){if(1!=e.nodeType)break;if(!fn(e.childNodes[o]))break;r=e,c=++o}else{if(Be(e))break;{let p=e.nextSibling;for(;p&&fn(p);)r=p.parentNode,c=vt(p)+1,p=p.nextSibling;if(p)e=p,o=0,i=tn(e);else{if(e=e.parentNode,e==n.dom)break;o=i=0}}}r&&C(n,t,r,c)}function Be(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function C(n,t,e,o){if(et(t)){let r=document.createRange();r.setEnd(e,o),r.setStart(e,o),t.removeAllRanges(),t.addRange(r)}else t.extend&&t.extend(e,o);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Xe(n)},50)}function f(n,t,e){let o=n.state.selection;if(o instanceof T.Bs&&!o.empty||e.indexOf("s")>-1||X&&e.indexOf("m")>-1)return!1;let{$from:i,$to:r}=o;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let c=on(n.state,t);if(c&&c instanceof T.qv)return ye(n,c)}if(!i.parent.inlineContent){let c=t<0?i:r,p=o instanceof T.C1?T.Y1.near(c,t):T.Y1.findFrom(c,t);return!!p&&ye(n,p)}return!1}function y(n,t){if(!(n.state.selection instanceof T.Bs))return!0;let{$head:e,$anchor:o,empty:i}=n.state.selection;if(!e.sameParent(o))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let r=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(r&&!r.isText){let c=n.state.tr;return t<0?c.delete(e.pos-r.nodeSize,e.pos):c.delete(e.pos,e.pos+r.nodeSize),n.dispatch(c),!0}return!1}function M(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function nt(n,t){let e=[],{content:o,openStart:i,openEnd:r}=t;for(;i>1&&r>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,r--;let tt=o.firstChild;e.push(tt.type.name,tt.attrs!=tt.type.defaultAttrs?tt.attrs:null),o=tt.content}let c=n.someProp("clipboardSerializer")||s.PW.fromSchema(n.state.schema),p=Dn(),h=p.createElement("div");h.appendChild(c.serializeFragment(o,{document:p}));let b,x=h.firstChild,F=0;for(;x&&1==x.nodeType&&(b=ae[x.nodeName.toLowerCase()]);){for(let tt=b.length-1;tt>=0;tt--){let Ct=p.createElement(b[tt]);for(;h.firstChild;)Ct.appendChild(h.firstChild);h.appendChild(Ct),F++}x=h.firstChild}return x&&1==x.nodeType&&x.setAttribute("data-pm-slice",`${i} ${r}${F?` -${F}`:""} ${JSON.stringify(e)}`),{dom:h,text:n.someProp("clipboardTextSerializer",tt=>tt(t))||t.content.textBetween(0,t.content.size,"\n\n")}}function j(n,t,e,o,i){let c,p,r=i.parent.type.spec.code;if(!e&&!t)return null;let h=t&&(o||r||!e);if(h){if(n.someProp("transformPastedText",Y=>{t=Y(t,r||o)}),r)return t?new s.p2(s.HY.from(n.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):s.p2.empty;let F=n.someProp("clipboardTextParser",Y=>Y(t,i,o));if(F)p=F;else{let Y=i.marks(),{schema:tt}=n.state,Ct=s.PW.fromSchema(tt);c=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(It=>{let Ht=c.appendChild(document.createElement("p"));It&&Ht.appendChild(Ct.serializeNode(tt.text(It,Y)))})}}else n.someProp("transformPastedHTML",F=>{e=F(e)}),c=function(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let i,e=Dn().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(n);if((i=o&&ae[o[1].toLowerCase()])&&(n=i.map(r=>"<"+r+">").join("")+n+i.map(r=>"</"+r+">").reverse().join("")),e.innerHTML=n,i)for(let r=0;r<i.length;r++)e=e.querySelector(i[r])||e;return e}(e),it&&function(n){let t=n.querySelectorAll(gt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let o=t[e];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),o)}}(c);let x=c&&c.querySelector("[data-pm-slice]"),b=x&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(x.getAttribute("data-pm-slice")||"");if(b&&b[3])for(let F=+b[3];F>0&&c.firstChild;F--)c=c.firstChild;if(p||(p=(n.someProp("clipboardParser")||n.someProp("domParser")||s.aw.fromSchema(n.state.schema)).parseSlice(c,{preserveWhitespace:!(!h&&!b),context:i,ruleFromNode:Y=>"BR"!=Y.nodeName||Y.nextSibling||!Y.parentNode||rt.test(Y.parentNode.nodeName)?null:{ignore:!0}})),b)p=function(n,t){if(!n.size)return n;let o,e=n.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(p){return n}let{content:i,openStart:r,openEnd:c}=n;for(let p=o.length-2;p>=0;p-=2){let h=e.nodes[o[p]];if(!h||h.hasRequiredAttrs())break;i=s.HY.from(h.create(o[p+1],i)),r++,c++}return new s.p2(i,r,c)}(oe(p,+b[1],+b[2]),b[4]);else if(p=s.p2.maxOpen(function(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let r,i=t.node(e).contentMatchAt(t.index(e)),c=[];if(n.forEach(p=>{if(!c)return;let x,h=i.findWrapping(p.type);if(!h)return c=null;if(x=c.length&&r.length&&Ut(h,r,p,c[c.length-1],0))c[c.length-1]=x;else{c.length&&(c[c.length-1]=jt(c[c.length-1],r.length));let b=Bt(p,h);c.push(b),i=i.matchType(b.type),r=h}}),c)return s.HY.from(c)}return n}(p.content,i),!0),p.openStart||p.openEnd){let F=0,Y=0;for(let tt=p.content.firstChild;F<p.openStart&&!tt.type.spec.isolating;F++,tt=tt.firstChild);for(let tt=p.content.lastChild;Y<p.openEnd&&!tt.type.spec.isolating;Y++,tt=tt.lastChild);p=oe(p,F,Y)}return n.someProp("transformPasted",F=>{p=F(p)}),p}const rt=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Bt(n,t,e=0){for(let o=t.length-1;o>=e;o--)n=t[o].create(null,s.HY.from(n));return n}function Ut(n,t,e,o,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let r=Ut(n,t,e,o.lastChild,i+1);if(r)return o.copy(o.content.replaceChild(o.childCount-1,r));if(o.contentMatchAt(o.childCount).matchType(i==n.length-1?e.type:n[i+1]))return o.copy(o.content.append(s.HY.from(Bt(e,n,i+1))))}}function jt(n,t){if(0==t)return n;let e=n.content.replaceChild(n.childCount-1,jt(n.lastChild,t-1)),o=n.contentMatchAt(n.childCount).fillBefore(s.HY.empty,!0);return n.copy(e.append(o))}function Vt(n,t,e,o,i,r){let c=t<0?n.firstChild:n.lastChild,p=c.content;return i<o-1&&(p=Vt(p,t,e,o,i+1,r)),i>=e&&(p=t<0?c.contentMatchAt(0).fillBefore(p,n.childCount>1||r<=i).append(p):p.append(c.contentMatchAt(c.childCount).fillBefore(s.HY.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,c.copy(p))}function oe(n,t,e){return t<n.openStart&&(n=new s.p2(Vt(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new s.p2(Vt(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const ae={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Oe=null;function Dn(){return Oe||(Oe=document.implementation.createHTMLDocument("title"))}const v={};let w={};class q{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function St(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function te(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=o=>ne(n,o))})}function ne(n,t){return n.someProp("handleDOMEvents",e=>{let o=e[t.type];return!!o&&(o(n,t)||t.defaultPrevented)})}function ie(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function pe(n){return{left:n.clientX,top:n.clientY}}function mn(n,t,e,o,i){if(-1==o)return!1;let r=n.state.doc.resolve(o);for(let c=r.depth+1;c>0;c--)if(n.someProp(t,p=>c>r.depth?p(n,e,r.nodeAfter,r.before(c),i,!0):p(n,e,r.node(c),r.before(c),i,!1)))return!0;return!1}function Ve(n,t,e){n.focused||n.focus();let o=n.state.tr.setSelection(t);"pointer"==e&&o.setMeta("pointer",!0),n.dispatch(o)}function yn(n,t,e,o){return mn(n,"handleDoubleClickOn",t,e,o)||n.someProp("handleDoubleClick",i=>i(n,t,o))}function Zn(n,t,e,o){return mn(n,"handleTripleClickOn",t,e,o)||n.someProp("handleTripleClick",i=>i(n,t,o))||function(n,t,e){if(0!=e.button)return!1;let o=n.state.doc;if(-1==t)return!!o.inlineContent&&(Ve(n,T.Bs.create(o,0,o.content.size),"pointer"),!0);let i=o.resolve(t);for(let r=i.depth+1;r>0;r--){let c=r>i.depth?i.nodeAfter:i.node(r),p=i.before(r);if(c.inlineContent)Ve(n,T.Bs.create(o,p+1,p+1+c.content.size),"pointer");else{if(!T.qv.isSelectable(c))continue;Ve(n,T.qv.create(o,p),"pointer")}return!0}}(n,e,o)}function Pn(n){return sn(n)}w.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=16==e.keyCode||e.shiftKey,!gn(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!Q||!gt||13!=e.keyCode))if(229!=e.keyCode&&n.domObserver.forceFlush(),!Et||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)n.someProp("handleKeyDown",o=>o(n,e))||function(n,t){let e=t.keyCode,o=function(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}(t);return 8==e||X&&72==e&&"c"==o?y(n,-1)||Ze(n):46==e||X&&68==e&&"c"==o?y(n,1)||rn(n):13==e||27==e||(37==e||X&&66==e&&"c"==o?On(n,-1,o)||Ze(n):39==e||X&&70==e&&"c"==o?On(n,1,o)||rn(n):38==e||X&&80==e&&"c"==o?f(n,-1,o)||Ze(n):40==e||X&&78==e&&"c"==o?function(n){if(!Ot||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelection();if(t&&1==t.nodeType&&0==e&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;M(n,o,"true"),setTimeout(()=>M(n,o,"false"),20)}return!1}(n)||f(n,1,o)||rn(n):o==(X?"m":"c")&&(66==e||73==e||89==e||90==e))}(n,e)?e.preventDefault():St(n,"key");else{let o=Date.now();n.input.lastIOSEnter=o,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==o&&(n.someProp("handleKeyDown",i=>i(n,at(13,"Enter"))),n.input.lastIOSEnter=0)},200)}},w.keyup=(n,t)=>{16==t.keyCode&&(n.input.shiftKey=!1)},w.keypress=(n,t)=>{let e=t;if(gn(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||X&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e)))return void e.preventDefault();let o=n.state.selection;if(!(o instanceof T.Bs&&o.$from.sameParent(o.$to))){let i=String.fromCharCode(e.charCode);n.someProp("handleTextInput",r=>r(n,o.$from.pos,o.$to.pos,i))||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};const Hn=X?"metaKey":"ctrlKey";v.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let o=Pn(n),i=Date.now(),r="singleClick";i-n.input.lastClick.time<500&&function(n,t){let e=t.x-n.clientX,o=t.y-n.clientY;return e*e+o*o<100}(e,n.input.lastClick)&&!e[Hn]&&("singleClick"==n.input.lastClick.type?r="doubleClick":"doubleClick"==n.input.lastClick.type&&(r="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:r};let c=n.posAtCoords(pe(e));!c||("singleClick"==r?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Un(n,c,e,!!o)):("doubleClick"==r?yn:Zn)(n,c.pos,c.inside,e)?e.preventDefault():St(n,"pointer"))};class Un{constructor(t,e,o,i){let r,c;if(this.view=t,this.pos=e,this.event=o,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[Hn],this.allowDefault=o.shiftKey,e.inside>-1)r=t.state.doc.nodeAt(e.inside),c=e.inside;else{let b=t.state.doc.resolve(e.pos);r=b.parent,c=b.depth?b.before():0}const p=i?null:o.target,h=p?t.docView.nearestDesc(p,!0):null;this.target=h?h.dom:null;let{selection:x}=t.state;(0==o.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||x instanceof T.qv&&x.from<=c&&x.to>c)&&(this.mightDrag={node:r,pos:c,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!xt||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),St(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Xe(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(pe(t))),this.allowDefault||!e?St(this.view,"pointer"):function(n,t,e,o,i){return mn(n,"handleClickOn",t,e,o)||n.someProp("handleClick",r=>r(n,t,o))||(i?function(n,t){if(-1==t)return!1;let o,i,e=n.state.selection;e instanceof T.qv&&(o=e.node);let r=n.state.doc.resolve(t);for(let c=r.depth+1;c>0;c--){let p=c>r.depth?r.nodeAfter:r.node(c);if(T.qv.isSelectable(p)){i=o&&e.$from.depth>0&&c>=e.$from.depth&&r.before(e.$from.depth+1)==e.$from.pos?r.before(e.$from.depth):r.before(c);break}}return null!=i&&(Ve(n,T.qv.create(n.state.doc,i),"pointer"),!0)}(n,e):function(n,t){if(-1==t)return!1;let e=n.state.doc.resolve(t),o=e.nodeAfter;return!!(o&&o.isAtom&&T.qv.isSelectable(o))&&(Ve(n,new T.qv(e),"pointer"),!0)}(n,e))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Ot&&this.mightDrag&&!this.mightDrag.node.isAtom||gt&&!(this.view.state.selection instanceof T.Bs)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Ve(this.view,T.Y1.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):St(this.view,"pointer")}move(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),St(this.view,"pointer"),0==t.buttons&&this.done()}}function gn(n,t){return!!n.composing||!!(Ot&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500)&&(n.input.compositionEndedAt=-2e8,!0)}v.touchdown=n=>{Pn(n),St(n,"pointer")},v.contextmenu=n=>Pn(n);const An=Q?5e3:-1;function Sn(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>sn(n),t))}function In(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=function(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function sn(n,t=!1){if(!(Q&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),In(n),t||n.docView&&n.docView.dirty){let e=Le(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}w.compositionstart=w.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(o=>!1===o.type.spec.inclusive)))n.markCursor=n.state.storedMarks||e.marks(),sn(n,!0),n.markCursor=null;else if(sn(n),xt&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let o=n.domSelection();for(let i=o.focusNode,r=o.focusOffset;i&&1==i.nodeType&&0!=r;){let c=r<0?i.lastChild:i.childNodes[r-1];if(!c)break;if(3==c.nodeType){o.collapse(c,c.nodeValue.length);break}i=c,r=-1}}n.input.composing=!0}Sn(n,An)},w.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,Sn(n,20))};const _n=ut&&ht<15||Et&&K<604;function ve(n,t,e,o){let i=j(n,t,e,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",p=>p(n,o,i||s.p2.empty)))return!0;if(!i)return!1;let r=function(n){return 0==n.openStart&&0==n.openEnd&&1==n.content.childCount?n.content.firstChild:null}(i),c=r?n.state.tr.replaceSelectionWith(r,n.input.shiftKey):n.state.tr.replaceSelection(i);return n.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}v.copy=w.cut=(n,t)=>{let e=t,o=n.state.selection,i="cut"==e.type;if(o.empty)return;let r=_n?null:e.clipboardData,c=o.content(),{dom:p,text:h}=nt(n,c);r?(e.preventDefault(),r.clearData(),r.setData("text/html",p.innerHTML),r.setData("text/plain",h)):function(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}(n,p),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},w.paste=(n,t)=>{let e=t;if(n.composing&&!Q)return;let o=_n?null:e.clipboardData;o&&ve(n,o.getData("text/plain"),o.getData("text/html"),e)?e.preventDefault():function(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,o=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout(()=>{n.focus(),o.parentNode&&o.parentNode.removeChild(o),e?ve(n,o.value,null,t):ve(n,o.textContent,o.innerHTML,t)},50)}(n,e)};class Lo{constructor(t,e){this.slice=t,this.move=e}}const Mo=X?"altKey":"ctrlKey";v.dragstart=(n,t)=>{let e=t,o=n.input.mouseDown;if(o&&o.done(),!e.dataTransfer)return;let i=n.state.selection,r=i.empty?null:n.posAtCoords(pe(e));if(!(r&&r.pos>=i.from&&r.pos<=(i instanceof T.qv?i.to-1:i.to)))if(o&&o.mightDrag)n.dispatch(n.state.tr.setSelection(T.qv.create(n.state.doc,o.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){let x=n.docView.nearestDesc(e.target,!0);x&&x.node.type.spec.draggable&&x!=n.docView&&n.dispatch(n.state.tr.setSelection(T.qv.create(n.state.doc,x.posBefore)))}let c=n.state.selection.content(),{dom:p,text:h}=nt(n,c);e.dataTransfer.clearData(),e.dataTransfer.setData(_n?"Text":"text/html",p.innerHTML),e.dataTransfer.effectAllowed="copyMove",_n||e.dataTransfer.setData("text/plain",h),n.dragging=new Lo(c,!e[Mo])},v.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},w.dragover=w.dragenter=(n,t)=>t.preventDefault(),w.drop=(n,t)=>{let e=t,o=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(pe(e));if(!i)return;let r=n.state.doc.resolve(i.pos);if(!r)return;let c=o&&o.slice;c?n.someProp("transformPasted",Ct=>{c=Ct(c)}):c=j(n,e.dataTransfer.getData(_n?"Text":"text/plain"),_n?null:e.dataTransfer.getData("text/html"),!1,r);let p=!(!o||e[Mo]);if(n.someProp("handleDrop",Ct=>Ct(n,e,c||s.p2.empty,p)))return void e.preventDefault();if(!c)return;e.preventDefault();let h=c?(0,H.nj)(n.state.doc,r.pos,c):r.pos;null==h&&(h=r.pos);let x=n.state.tr;p&&x.deleteSelection();let b=x.mapping.map(h),F=0==c.openStart&&0==c.openEnd&&1==c.content.childCount,Y=x.doc;if(F?x.replaceRangeWith(b,b,c.content.firstChild):x.replaceRange(b,b,c),x.doc.eq(Y))return;let tt=x.doc.resolve(b);if(F&&T.qv.isSelectable(c.content.firstChild)&&tt.nodeAfter&&tt.nodeAfter.sameMarkup(c.content.firstChild))x.setSelection(new T.qv(tt));else{let Ct=x.mapping.map(h);x.mapping.maps[x.mapping.maps.length-1].forEach((It,Ht,Qt,me)=>Ct=me),x.setSelection(qe(n,tt,x.doc.resolve(Ct)))}n.focus(),n.dispatch(x.setMeta("uiEvent","drop"))},v.focus=n=>{n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelection())&&Xe(n)},20))},v.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},v.beforeinput=(n,t)=>{if(gt&&Q&&"deleteContentBackward"==t.inputType){n.domObserver.flushSoon();let{domChangeCount:o}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=o||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",r=>r(n,at(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in w)v[n]=w[n];function qn(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class ho{constructor(t,e){this.toDOM=t,this.spec=e||kn,this.side=this.spec.side||0}map(t,e,o,i){let{pos:r,deleted:c}=t.mapResult(e.from+i,this.side<0?-1:1);return c?null:new en(r-o,r-o,this)}valid(){return!0}eq(t){return this==t||t instanceof ho&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&qn(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class En{constructor(t,e){this.attrs=t,this.spec=e||kn}map(t,e,o,i){let r=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-o,c=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-o;return r>=c?null:new en(r,c,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof En&&qn(this.attrs,t.attrs)&&qn(this.spec,t.spec)}static is(t){return t.type instanceof En}destroy(){}}class oo{constructor(t,e){this.attrs=t,this.spec=e||kn}map(t,e,o,i){let r=t.mapResult(e.from+i,1);if(r.deleted)return null;let c=t.mapResult(e.to+i,-1);return c.deleted||c.pos<=r.pos?null:new en(r.pos-o,c.pos-o,this)}valid(t,e){let r,{index:o,offset:i}=t.content.findIndex(e.from);return i==e.from&&!(r=t.child(o)).isText&&i+r.nodeSize==e.to}eq(t){return this==t||t instanceof oo&&qn(this.attrs,t.attrs)&&qn(this.spec,t.spec)}destroy(){}}class en{constructor(t,e,o){this.from=t,this.to=e,this.type=o}copy(t,e){return new en(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,o){return this.type.map(t,this,e,o)}static widget(t,e,o){return new en(t,t,new ho(e,o))}static inline(t,e,o,i){return new en(t,e,new En(o,i))}static node(t,e,o,i){return new en(t,e,new oo(o,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof En}}const zn=[],kn={};class Ae{constructor(t,e){this.local=t.length?t:zn,this.children=e.length?e:zn}static create(t,e){return e.length?eo(e,t,0,kn):Se}find(t,e,o){let i=[];return this.findInner(null==t?0:t,null==e?1e9:e,i,0,o),i}findInner(t,e,o,i,r){for(let c=0;c<this.local.length;c++){let p=this.local[c];p.from<=e&&p.to>=t&&(!r||r(p.spec))&&o.push(p.copy(p.from+i,p.to+i))}for(let c=0;c<this.children.length;c+=3)if(this.children[c]<e&&this.children[c+1]>t){let p=this.children[c]+1;this.children[c+2].findInner(t-p,e-p,o,i+p,r)}}map(t,e,o){return this==Se||0==t.maps.length?this:this.mapInner(t,e,0,0,o||kn)}mapInner(t,e,o,i,r){let c;for(let p=0;p<this.local.length;p++){let h=this.local[p].map(t,o,i);h&&h.type.valid(e,h)?(c||(c=[])).push(h):r.onRemove&&r.onRemove(this.local[p].spec)}return this.children.length?function(n,t,e,o,i,r,c){let p=n.slice(),h=(b,F,Y,tt)=>{for(let Ct=0;Ct<p.length;Ct+=3){let Ht,It=p[Ct+1];if(It<0||b>It+r)continue;let Qt=p[Ct]+r;F>=Qt?p[Ct+1]=b<=Qt?-2:-1:Y>=i&&(Ht=tt-Y-(F-b))&&(p[Ct]+=Ht,p[Ct+1]+=Ht)}};for(let b=0;b<e.maps.length;b++)e.maps[b].forEach(h);let x=!1;for(let b=0;b<p.length;b+=3)if(p[b+1]<0){if(-2==p[b+1]){x=!0,p[b+1]=-1;continue}let F=e.map(n[b]+r),Y=F-i;if(Y<0||Y>=o.content.size){x=!0;continue}let Ct=e.map(n[b+1]+r,-1)-i,{index:It,offset:Ht}=o.content.findIndex(Y),Qt=o.maybeChild(It);if(Qt&&Ht==Y&&Ht+Qt.nodeSize==Ct){let me=p[b+2].mapInner(e,Qt,F+1,n[b]+r+1,c);me!=Se?(p[b]=Y,p[b+1]=Ct,p[b+2]=me):(p[b+1]=-2,x=!0)}else x=!0}if(x){let b=function(n,t,e,o,i,r,c){function p(h,x){for(let b=0;b<h.local.length;b++){let F=h.local[b].map(o,i,x);F?e.push(F):c.onRemove&&c.onRemove(h.local[b].spec)}for(let b=0;b<h.children.length;b+=3)p(h.children[b+2],h.children[b]+x+1)}for(let h=0;h<n.length;h+=3)-1==n[h+1]&&p(n[h+2],t[h]+r+1);return e}(p,n,t,e,i,r,c),F=eo(b,o,0,c);t=F.local;for(let Y=0;Y<p.length;Y+=3)p[Y+1]<0&&(p.splice(Y,3),Y-=3);for(let Y=0,tt=0;Y<F.children.length;Y+=3){let Ct=F.children[Y];for(;tt<p.length&&p[tt]<Ct;)tt+=3;p.splice(tt,0,F.children[Y],F.children[Y+1],F.children[Y+2])}}return new Ae(t.sort(wn),p)}(this.children,c||[],t,e,o,i,r):c?new Ae(c.sort(wn),zn):Se}add(t,e){return e.length?this==Se?Ae.create(t,e):this.addInner(t,e,0):this}addInner(t,e,o){let i,r=0;t.forEach((p,h)=>{let b,x=h+o;if(b=ro(e,p,x)){for(i||(i=this.children.slice());r<i.length&&i[r]<h;)r+=3;i[r]==h?i[r+2]=i[r+2].addInner(p,b,x+1):i.splice(r,0,h,h+p.nodeSize,eo(b,p,x+1,kn)),r+=3}});let c=to(r?so(e):e,-o);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||c.splice(p--,1);return new Ae(c.length?this.local.concat(c).sort(wn):this.local,i||this.children)}remove(t){return 0==t.length||this==Se?this:this.removeInner(t,0)}removeInner(t,e){let o=this.children,i=this.local;for(let r=0;r<o.length;r+=3){let c,p=o[r]+e,h=o[r+1]+e;for(let F,b=0;b<t.length;b++)(F=t[b])&&F.from>p&&F.to<h&&(t[b]=null,(c||(c=[])).push(F));if(!c)continue;o==this.children&&(o=this.children.slice());let x=o[r+2].removeInner(c,p+1);x!=Se?o[r+2]=x:(o.splice(r,3),r-=3)}if(i.length)for(let c,r=0;r<t.length;r++)if(c=t[r])for(let p=0;p<i.length;p++)i[p].eq(c,e)&&(i==this.local&&(i=this.local.slice()),i.splice(p--,1));return o==this.children&&i==this.local?this:i.length||o.length?new Ae(i,o):Se}forChild(t,e){if(this==Se)return this;if(e.isLeaf)return Ae.empty;let o,i;for(let p=0;p<this.children.length;p+=3)if(this.children[p]>=t){this.children[p]==t&&(o=this.children[p+2]);break}let r=t+1,c=r+e.content.size;for(let p=0;p<this.local.length;p++){let h=this.local[p];if(h.from<c&&h.to>r&&h.type instanceof En){let x=Math.max(r,h.from)-r,b=Math.min(c,h.to)-r;x<b&&(i||(i=[])).push(h.copy(x,b))}}if(i){let p=new Ae(i.sort(wn),zn);return o?new Cn([p,o]):p}return o||Se}eq(t){if(this==t)return!0;if(!(t instanceof Ae)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return lo(this.localsInner(t))}localsInner(t){if(this==Se)return zn;if(t.inlineContent||!this.local.some(En.is))return this.local;let e=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof En||e.push(this.local[o]);return e}}Ae.empty=new Ae([],[]),Ae.removeOverlap=lo;const Se=Ae.empty;class Cn{constructor(t){this.members=t}map(t,e){const o=this.members.map(i=>i.map(t,e,kn));return Cn.from(o)}forChild(t,e){if(e.isLeaf)return Ae.empty;let o=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(t,e);r!=Se&&(r instanceof Cn?o=o.concat(r.members):o.push(r))}return Cn.from(o)}eq(t){if(!(t instanceof Cn)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,o=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(t);if(r.length)if(e){o&&(e=e.slice(),o=!1);for(let c=0;c<r.length;c++)e.push(r[c])}else e=r}return e?lo(o?e:e.sort(wn)):zn}static from(t){switch(t.length){case 0:return Se;case 1:return t[0];default:return new Cn(t)}}}function to(n,t){if(!t||!n.length)return n;let e=[];for(let o=0;o<n.length;o++){let i=n[o];e.push(new en(i.from+t,i.to+t,i.type))}return e}function ro(n,t,e){if(t.isLeaf)return null;let o=e+t.nodeSize,i=null;for(let c,r=0;r<n.length;r++)(c=n[r])&&c.from>e&&c.to<o&&((i||(i=[])).push(c),n[r]=null);return i}function so(n){let t=[];for(let e=0;e<n.length;e++)null!=n[e]&&t.push(n[e]);return t}function eo(n,t,e,o){let i=[],r=!1;t.forEach((p,h)=>{let x=ro(n,p,h+e);if(x){r=!0;let b=eo(x,p,e+h+1,o);b!=Se&&i.push(h,h+p.nodeSize,b)}});let c=to(r?so(n):n,-e).sort(wn);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||(o.onRemove&&o.onRemove(c[p].spec),c.splice(p--,1));return c.length||i.length?new Ae(c,i):Se}function wn(n,t){return n.from-t.from||n.to-t.to}function lo(n){let t=n;for(let e=0;e<t.length-1;e++){let o=t[e];if(o.from!=o.to)for(let i=e+1;i<t.length;i++){let r=t[i];if(r.from!=o.from){r.from<o.to&&(t==n&&(t=n.slice()),t[e]=o.copy(o.from,r.from),mo(t,i,o.copy(r.from,o.to)));break}r.to!=o.to&&(t==n&&(t=n.slice()),t[i]=r.copy(r.from,o.to),mo(t,i+1,r.copy(o.to,r.to)))}}return t}function mo(n,t,e){for(;t<n.length&&wn(e,n[t])>0;)t++;n.splice(t,0,e)}function ao(n){let t=[];return n.someProp("decorations",e=>{let o=e(n.state);o&&o!=Se&&t.push(o)}),n.cursorWrapper&&t.push(Ae.create(n.state.doc,[n.cursorWrapper.deco])),Cn.from(t)}const yo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Eo=ut&&ht<=11;class no{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class bo{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new no,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let i=0;i<o.length;i++)this.queue.push(o[i]);ut&&ht<=11&&o.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Eo&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,yo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(an(this.view)){if(this.suppressingSelectionUpdates)return Xe(this.view);if(ut&&ht<=11&&!this.view.state.selection.empty){let t=this.view.domSelection();if(t.focusNode&&bt(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(t){if(0==t.rangeCount)return!0;let e=t.getRangeAt(0).commonAncestorContainer,o=this.view.docView.nearestDesc(e);return o&&o.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let e=this.view.domSelection(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&an(this.view)&&!this.ignoreSelectionChange(e),i=-1,r=-1,c=!1,p=[];if(this.view.editable)for(let h=0;h<t.length;h++){let x=this.registerMutation(t[h],p);x&&(i=i<0?x.from:Math.min(x.from,i),r=r<0?x.to:Math.max(x.to,r),x.typeOver&&(c=!0))}if(xt&&p.length>1){let h=p.filter(x=>"BR"==x.nodeName);if(2==h.length){let x=h[0],b=h[1];x.parentNode&&x.parentNode.parentNode==b.parentNode?b.remove():x.remove()}}(i>-1||o)&&(i>-1&&(this.view.docView.markDirty(i,r),go||(go=!0,"normal"==getComputedStyle(this.view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(i,r,c,p),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Xe(this.view),this.currentSelection.set(e))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(o==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if("childList"==t.type){for(let b=0;b<t.addedNodes.length;b++)e.push(t.addedNodes[b]);if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let i=t.previousSibling,r=t.nextSibling;if(ut&&ht<=11&&t.addedNodes.length)for(let b=0;b<t.addedNodes.length;b++){let{previousSibling:F,nextSibling:Y}=t.addedNodes[b];(!F||Array.prototype.indexOf.call(t.addedNodes,F)<0)&&(i=F),(!Y||Array.prototype.indexOf.call(t.addedNodes,Y)<0)&&(r=Y)}let c=i&&i.parentNode==t.target?vt(i)+1:0,p=o.localPosFromDOM(t.target,c,-1),h=r&&r.parentNode==t.target?vt(r):t.target.childNodes.length;return{from:p,to:o.localPosFromDOM(t.target,h,1)}}return"attributes"==t.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let go=!1;function Do(n){let t=n.pmViewDesc;if(t)return t.parseRule();if("BR"==n.nodeName&&n.parentNode){if(Ot&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(n.parentNode.lastChild==n||Ot&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function co(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:qe(n,t.resolve(e.anchor),t.resolve(e.head))}function po(n,t,e){let o=n.depth,i=t?n.end():n.pos;for(;o>0&&(t||n.indexAfter(o)==n.node(o).childCount);)o--,i++,t=!1;if(e){let r=n.node(o).maybeChild(n.indexAfter(o));for(;r&&!r.isLeaf;)r=r.firstChild,i++}return i}class Io{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new q,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(To),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=_o(this),jn(this),this.nodeViews=Co(this),this.docView=z(this.state.doc,Vn(this),ao(this),this.dom,this),this.domObserver=new bo(this,(o,i,r,c)=>function(n,t,e,o,i){if(t<0){let re=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,Fn=Le(n,re);if(Fn&&!n.state.selection.eq(Fn)){let Ro=n.state.tr.setSelection(Fn);"pointer"==re?Ro.setMeta("pointer",!0):"key"==re&&Ro.scrollIntoView(),n.dispatch(Ro)}return}let r=n.state.doc.resolve(t),c=r.sharedDepth(e);t=r.before(c+1),e=n.state.doc.resolve(e).after(c+1);let p=n.state.selection,h=function(n,t,e){let x,{node:o,fromOffset:i,toOffset:r,from:c,to:p}=n.docView.parseRange(t,e),h=n.domSelection(),b=h.anchorNode;if(b&&n.dom.contains(1==b.nodeType?b:b.parentNode)&&(x=[{node:b,offset:h.anchorOffset}],et(h)||x.push({node:h.focusNode,offset:h.focusOffset})),gt&&8===n.input.lastKeyCode)for(let Ht=r;Ht>i;Ht--){let Qt=o.childNodes[Ht-1],me=Qt.pmViewDesc;if("BR"==Qt.nodeName&&!me){r=Ht;break}if(!me||me.size)break}let F=n.state.doc,Y=n.someProp("domParser")||s.aw.fromSchema(n.state.schema),tt=F.resolve(c),Ct=null,It=Y.parse(o,{topNode:tt.parent,topMatch:tt.parent.contentMatchAt(tt.index()),topOpen:!0,from:i,to:r,preserveWhitespace:"pre"!=tt.parent.type.whitespace||"full",findPositions:x,ruleFromNode:Do,context:tt});if(x&&null!=x[0].pos){let Ht=x[0].pos,Qt=x[1]&&x[1].pos;null==Qt&&(Qt=Ht),Ct={anchor:Ht+c,head:Qt+c}}return{doc:It,sel:Ct,from:c,to:p}}(n,t,e);if(gt&&n.cursorWrapper&&h.sel&&h.sel.anchor==n.cursorWrapper.deco.from){let re=n.cursorWrapper.deco.type.toDOM.nextSibling,Fn=re&&re.nodeValue?re.nodeValue.length:1;h.sel={anchor:h.sel.anchor+Fn,head:h.sel.anchor+Fn}}let F,Y,x=n.state.doc,b=x.slice(h.from,h.to);8===n.input.lastKeyCode&&Date.now()-100<n.input.lastKeyCodeTime?(F=n.state.selection.to,Y="end"):(F=n.state.selection.from,Y="start"),n.input.lastKeyCode=null;let tt=function(n,t,e,o,i){let r=n.findDiffStart(t,e);if(null==r)return null;let{a:c,b:p}=n.findDiffEnd(t,e+n.size,e+t.size);return"end"==i&&(o-=c+Math.max(0,r-Math.min(c,p))-r),c<r&&n.size<t.size?(r-=o<=r&&o>=c?r-o:0,p=r+(p-c),c=r):p<r&&(r-=o<=r&&o>=p?r-o:0,c=r+(c-p),p=r),{start:r,endA:c,endB:p}}(b.content,h.doc.content,h.from,F,Y);if((Et&&n.input.lastIOSEnter>Date.now()-225||Q)&&i.some(re=>"DIV"==re.nodeName||"P"==re.nodeName)&&(!tt||tt.endA>=tt.endB)&&n.someProp("handleKeyDown",re=>re(n,at(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(!tt){if(!(o&&p instanceof T.Bs&&!p.empty&&p.$head.sameParent(p.$anchor))||n.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let re=co(n,n.state.doc,h.sel);re&&!re.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(re))}return}tt={start:p.from,endA:p.to,endB:p.to}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&tt.start==tt.endB&&n.state.selection instanceof T.Bs&&(tt.start>n.state.selection.from&&tt.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?tt.start=n.state.selection.from:tt.endA<n.state.selection.to&&tt.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(tt.endB+=n.state.selection.to-tt.endA,tt.endA=n.state.selection.to)),ut&&ht<=11&&tt.endB==tt.start+1&&tt.endA==tt.start&&tt.start>h.from&&" \xa0"==h.doc.textBetween(tt.start-h.from-1,tt.start-h.from+1)&&(tt.start--,tt.endA--,tt.endB--);let me,Ct=h.doc.resolveNoCache(tt.start-h.from),It=h.doc.resolveNoCache(tt.endB-h.from),Ht=x.resolve(tt.start),Qt=Ct.sameParent(It)&&Ct.parent.inlineContent&&Ht.end()>=tt.endA;if((Et&&n.input.lastIOSEnter>Date.now()-225&&(!Qt||i.some(re=>"DIV"==re.nodeName||"P"==re.nodeName))||!Qt&&Ct.pos<h.doc.content.size&&(me=T.Y1.findFrom(h.doc.resolve(Ct.pos+1),1,!0))&&me.head==It.pos)&&n.someProp("handleKeyDown",re=>re(n,at(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(n.state.selection.anchor>tt.start&&function(n,t,e,o,i){if(!o.parent.isTextblock||e-t<=i.pos-o.pos||po(o,!0,!1)<i.pos)return!1;let r=n.resolve(t);if(r.parentOffset<r.parent.content.size||!r.parent.isTextblock)return!1;let c=n.resolve(po(r,!0,!0));return!(!c.parent.isTextblock||c.pos>e||po(c,!0,!1)<e)&&o.parent.content.cut(o.parentOffset).eq(c.parent.content)}(x,tt.start,tt.endA,Ct,It)&&n.someProp("handleKeyDown",re=>re(n,at(8,"Backspace"))))return void(Q&&gt&&n.domObserver.suppressSelectionUpdates());gt&&Q&&tt.endB==tt.start&&(n.input.lastAndroidDelete=Date.now()),Q&&!Qt&&Ct.start()!=It.start()&&0==It.parentOffset&&Ct.depth==It.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==tt.endA&&(tt.endB-=2,It=h.doc.resolveNoCache(tt.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(re){return re(n,at(13,"Enter"))})},20));let He,Wn,Tn,Ne=tt.start,nn=tt.endA;if(Qt)if(Ct.pos==It.pos)ut&&ht<=11&&0==Ct.parentOffset&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Xe(n),20)),He=n.state.tr.delete(Ne,nn),Wn=x.resolve(tt.start).marksAcross(x.resolve(tt.endA));else if(tt.endA==tt.endB&&(Tn=function(n,t){let c,p,h,e=n.firstChild.marks,o=t.firstChild.marks,i=e,r=o;for(let b=0;b<o.length;b++)i=o[b].removeFromSet(i);for(let b=0;b<e.length;b++)r=e[b].removeFromSet(r);if(1==i.length&&0==r.length)p=i[0],c="add",h=b=>b.mark(p.addToSet(b.marks));else{if(0!=i.length||1!=r.length)return null;p=r[0],c="remove",h=b=>b.mark(p.removeFromSet(b.marks))}let x=[];for(let b=0;b<t.childCount;b++)x.push(h(t.child(b)));if(s.HY.from(x).eq(n))return{mark:p,type:c}}(Ct.parent.content.cut(Ct.parentOffset,It.parentOffset),Ht.parent.content.cut(Ht.parentOffset,tt.endA-Ht.start()))))He=n.state.tr,"add"==Tn.type?He.addMark(Ne,nn,Tn.mark):He.removeMark(Ne,nn,Tn.mark);else if(Ct.parent.child(Ct.index()).isText&&Ct.index()==It.index()-(It.textOffset?0:1)){let re=Ct.parent.textBetween(Ct.parentOffset,It.parentOffset);if(n.someProp("handleTextInput",Fn=>Fn(n,Ne,nn,re)))return;He=n.state.tr.insertText(re,Ne,nn)}if(He||(He=n.state.tr.replace(Ne,nn,h.doc.slice(tt.start-h.from,tt.endB-h.from))),h.sel){let re=co(n,He.doc,h.sel);re&&!(gt&&Q&&n.composing&&re.empty&&(tt.start!=tt.endB||n.input.lastAndroidDelete<Date.now()-100)&&(re.head==Ne||re.head==He.mapping.map(nn)-1)||ut&&re.empty&&re.head==Ne)&&He.setSelection(re)}Wn&&He.ensureMarks(Wn),n.dispatch(He.scrollIntoView())}(this,o,i,r,c)),this.domObserver.start(),function(n){for(let t in v){let e=v[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=o=>{ie(n,o)&&!ne(n,o)&&(n.editable||!(o.type in w))&&e(n,o)})}Ot&&n.dom.addEventListener("input",()=>null),te(n)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&te(this),this._props=t,t.plugins&&(t.plugins.forEach(To),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)}setProps(t){let e={};for(let o in this._props)e[o]=this._props[o];e.state=this.state;for(let o in t)e[o]=t[o];this.update(e)}updateState(t){this.updateStateInner(t,this.state.plugins!=t.plugins)}updateStateInner(t,e){let o=this.state,i=!1,r=!1;if(t.storedMarks&&this.composing&&(In(this),r=!0),this.state=t,e){let F=Co(this);(function(n,t){let e=0,o=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)o++;return e!=o})(F,this.nodeViews)&&(this.nodeViews=F,i=!0),te(this)}this.editable=_o(this),jn(this);let c=ao(this),p=Vn(this),h=e?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",x=i||!this.docView.matchesNode(t.doc,p,c);(x||!t.selection.eq(o.selection))&&(r=!0);let b="preserve"==h&&r&&null==this.dom.style.overflowAnchor&&function(n){let o,i,t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top);for(let r=(t.left+t.right)/2,c=e+1;c<Math.min(innerHeight,t.bottom);c+=5){let p=n.root.elementFromPoint(r,c);if(!p||p==n.dom||!n.dom.contains(p))continue;let h=p.getBoundingClientRect();if(h.top>=e-20){o=p,i=h.top;break}}return{refDOM:o,refTop:i,stack:Jt(n.dom)}}(this);if(r){this.domObserver.stop();let F=x&&(ut||gt)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&function(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}(o.selection,t.selection);if(x){let Y=gt?this.trackWrites=this.domSelection().focusNode:null;(i||!this.docView.update(t.doc,p,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=z(t.doc,p,c,this.dom,this)),Y&&!this.trackWrites&&(F=!0)}F||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelection();return bt(t.node,t.offset,e.anchorNode,e.anchorOffset)}(this))?Xe(this,F):(We(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==h)this.dom.scrollTop=0;else if("to selection"==h){let F=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",Y=>Y(this)))if(t.selection instanceof T.qv){let Y=this.docView.domAfterPos(t.selection.from);1==Y.nodeType&&dt(this,Y.getBoundingClientRect(),F)}else dt(this,this.coordsAtPos(t.selection.head,1),F)}else b&&function({refDOM:n,refTop:t,stack:e}){let o=n?n.getBoundingClientRect().top:0;ce(e,0==o?0:o-t)}(b)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let o=this.pluginViews[e];o.update&&o.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let o=this.directPlugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let o=this.state.plugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}}someProp(t,e){let i,o=this._props&&this._props[t];if(null!=o&&(i=e?e(o):o))return i;for(let c=0;c<this.directPlugins.length;c++){let p=this.directPlugins[c].props[t];if(null!=p&&(i=e?e(p):p))return i}let r=this.state.plugins;if(r)for(let c=0;c<r.length;c++){let p=r[c].props[t];if(null!=p&&(i=e?e(p):p))return i}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(n){if(n.setActive)return n.setActive();if(le)return n.focus(le);let t=Jt(n);n.focus(null==le?{get preventScroll(){return le={preventScroll:!0},!0}}:void 0),le||(le=!1,ce(t,0))}(this.dom),Xe(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e;return t||document}posAtCoords(t){return Ue(this,t)}coordsAtPos(t,e=1){return ze(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,o=-1){let i=this.docView.posFromDOM(t,e,o);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return function(n,t,e){return Pe==t&&G==e?E:(Pe=t,G=e,E="up"==e||"down"==e?function(n,t,e){let o=t.selection,i="up"==e?o.$from:o.$to;return Je(n,t,()=>{let{node:r}=n.docView.domFromPos(i.pos,"up"==e?-1:1);for(;;){let p=n.docView.nearestDesc(r,!0);if(!p)break;if(p.node.isBlock){r=p.dom;break}r=p.dom.parentNode}let c=ze(n,i.pos,1);for(let p=r.firstChild;p;p=p.nextSibling){let h;if(1==p.nodeType)h=p.getClientRects();else{if(3!=p.nodeType)continue;h=Dt(p,0,p.nodeValue.length).getClientRects()}for(let x=0;x<h.length;x++){let b=h[x];if(b.bottom>b.top+1&&("up"==e?c.top-b.top>2*(b.bottom-c.top):b.bottom-c.bottom>2*(c.bottom-b.top)))return!1}}return!0})}(n,t,e):function(n,t,e){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let i=o.parentOffset,r=!i,c=i==o.parent.content.size,p=n.domSelection();return _e.test(o.parent.textContent)&&p.modify?Je(n,t,()=>{let h=p.getRangeAt(0),x=p.focusNode,b=p.focusOffset,F=p.caretBidiLevel;p.modify("move",e,"character");let tt=!(o.depth?n.docView.domAfterPos(o.before()):n.dom).contains(1==p.focusNode.nodeType?p.focusNode:p.focusNode.parentNode)||x==p.focusNode&&b==p.focusOffset;return p.removeAllRanges(),p.addRange(h),null!=F&&(p.caretBidiLevel=F),tt}):"left"==e||"backward"==e?r:c}(n,t,e))}(this,e||this.state,t)}destroy(){!this.docView||(function(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ao(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(n,t){!ne(n,t)&&v[t.type]&&(n.editable||!(t.type in w))&&v[t.type](n,t)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelection(){return this.root.getSelection()}}function Vn(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if("function"==typeof e&&(e=e(n.state)),e)for(let o in e)"class"==o&&(t.class+=" "+e[o]),"style"==o?t.style=(t.style?t.style+";":"")+e[o]:!t[o]&&"contenteditable"!=o&&"nodeName"!=o&&(t[o]=String(e[o]))}),[en.node(0,n.state.doc.content.size,t)]}function jn(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:en.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function _o(n){return!n.someProp("editable",t=>!1===t(n.state))}function Co(n){let t=Object.create(null);function e(o){for(let i in o)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=o[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function To(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);
"use strict";var Ko=Object.defineProperty,Jo=Object.defineProperties,Zo=Object.getOwnPropertyDescriptors,Mo=Object.getOwnPropertySymbols,Uo=Object.prototype.hasOwnProperty,Fo=Object.prototype.propertyIsEnumerable,Wo=(St,dt,u)=>dt in St?Ko(St,dt,{enumerable:!0,configurable:!0,writable:!0,value:u}):St[dt]=u,Bt=(St,dt)=>{for(var u in dt||(dt={}))Uo.call(dt,u)&&Wo(St,u,dt[u]);if(Mo)for(var u of Mo(dt))Fo.call(dt,u)&&Wo(St,u,dt[u]);return St},Me=(St,dt)=>Jo(St,Zo(dt)),zo=(St,dt)=>{var u={};for(var g in St)Uo.call(St,g)&&dt.indexOf(g)<0&&(u[g]=St[g]);if(null!=St&&Mo)for(var g of Mo(St))dt.indexOf(g)<0&&Fo.call(St,g)&&(u[g]=St[g]);return u};(self.webpackChunk_taiga_ui_components=self.webpackChunk_taiga_ui_components||[]).push([[70224],{40256:(St,dt,u)=>{u.r(dt),u.d(dt,{CommandManager:()=>te,Editor:()=>lo,Extension:()=>De,InputRule:()=>A,Mark:()=>Rn,Node:()=>Ln,NodeView:()=>go,PasteRule:()=>Nt,Tracker:()=>wo,callOrReturn:()=>X,combineTransactionSteps:()=>mo,defaultBlockAt:()=>ao,escapeForRegEx:()=>vo,extensions:()=>se,findChildren:()=>Eo,findChildrenInRange:()=>yo,findParentNode:()=>Je,findParentNodeClosestToPos:()=>mn,generateHTML:()=>Oo,generateJSON:()=>_o,generateText:()=>xo,getAttributes:()=>fo,getChangedRanges:()=>Po,getDebugJSON:()=>co,getExtensionField:()=>z,getHTMLFromFragment:()=>Qn,getMarkAttributes:()=>Yt,getMarkRange:()=>Fe,getMarkType:()=>ie,getMarksBetween:()=>uo,getNodeAttributes:()=>$e,getNodeType:()=>I,getSchema:()=>Xn,getText:()=>io,getTextBetween:()=>qe,getTextContentFromNodes:()=>m,getTextSerializersFromSchema:()=>Ue,inputRulesPlugin:()=>Ct,isActive:()=>ro,isList:()=>rn,isMarkActive:()=>Pe,isNodeActive:()=>ze,isNodeEmpty:()=>so,isNodeSelection:()=>Ao,isTextSelection:()=>Le,markInputRule:()=>So,markPasteRule:()=>ko,mergeAttributes:()=>P,nodeInputRule:()=>Bo,pasteRulesPlugin:()=>ae,posToDOMRect:()=>po,textInputRule:()=>Ho,textPasteRule:()=>To,textblockTypeInputRule:()=>No,wrappingInputRule:()=>Io});var g=u(62463),s=u(43594),L=u(13903),y=u(35917),f=u(38480);const q=(n,t)=>!n.selection.empty&&(t&&t(n.tr.deleteSelection().scrollIntoView()),!0),b=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("backward",n):o.parentOffset>0))return!1;let i=at(o);if(!i){let c=o.blockRange(),p=c&&(0,f.k9)(c);return null!=p&&(t&&t(n.tr.lift(c,p).scrollIntoView()),!0)}let r=i.nodeBefore;if(!r.type.spec.isolating&&xt(n,i,t))return!0;if(0==o.parent.content.size&&(nt(r,"end")||g.qv.isSelectable(r))){let c=(0,f.dR)(n.doc,o.before(),o.after(),y.p2.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=n.tr.step(c);p.setSelection(nt(r,"end")?g.Y1.findFrom(p.doc.resolve(p.mapping.map(i.pos,-1)),-1):g.qv.create(p.doc,i.pos-r.nodeSize)),t(p.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos-r.nodeSize,i.pos).scrollIntoView()),0))};function nt(n,t,e=!1){for(let o=n;o;o="start"==t?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(e&&1!=o.childCount)return!1}return!1}const j=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):o.parentOffset>0)return!1;r=at(o)}let c=r&&r.nodeBefore;return!(!c||!g.qv.isSelectable(c)||(t&&t(n.tr.setSelection(g.qv.create(n.doc,r.pos-c.nodeSize)).scrollIntoView()),0))};function at(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}const et=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size))return!1;let i=it(o);if(!i)return!1;let r=i.nodeAfter;if(xt(n,i,t))return!0;if(0==o.parent.content.size&&(nt(r,"start")||g.qv.isSelectable(r))){let c=(0,f.dR)(n.doc,o.before(),o.after(),y.p2.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=n.tr.step(c);p.setSelection(nt(r,"start")?g.Y1.findFrom(p.doc.resolve(p.mapping.map(i.pos)),1):g.qv.create(p.doc,p.mapping.map(i.pos))),t(p.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos,i.pos+r.nodeSize).scrollIntoView()),0))},mt=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size)return!1;r=it(o)}let c=r&&r.nodeAfter;return!(!c||!g.qv.isSelectable(c)||(t&&t(n.tr.setSelection(g.qv.create(n.doc,r.pos)).scrollIntoView()),0))};function it(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const ut=(n,t)=>{let{$head:e,$anchor:o}=n.selection;return!(!e.parent.type.spec.code||!e.sameParent(o)||(t&&t(n.tr.insertText("\n").scrollIntoView()),0))};function $(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const W=(n,t)=>{let{$head:e,$anchor:o}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(o))return!1;let i=e.node(-1),r=e.indexAfter(-1),c=$(i.contentMatchAt(r));if(!c||!i.canReplaceWith(r,r,c))return!1;if(t){let p=e.after(),h=n.tr.replaceWith(p,p,c.createAndFill());h.setSelection(g.Y1.near(h.doc.resolve(p),1)),t(h.scrollIntoView())}return!0},Q=(n,t)=>{let e=n.selection,{$from:o,$to:i}=e;if(e instanceof g.C1||o.parent.inlineContent||i.parent.inlineContent)return!1;let r=$(i.parent.contentMatchAt(i.indexAfter()));if(!r||!r.isTextblock)return!1;if(t){let c=(!o.parentOffset&&i.index()<i.parent.childCount?o:i).pos,p=n.tr.insert(c,r.createAndFill());p.setSelection(g.Bs.create(p.doc,c+1)),t(p.scrollIntoView())}return!0},N=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let r=e.before();if((0,f.Ax)(n.doc,r))return t&&t(n.tr.split(r).scrollIntoView()),!0}let o=e.blockRange(),i=o&&(0,f.k9)(o);return null!=i&&(t&&t(n.tr.lift(o,i).scrollIntoView()),!0)};function xt(n,t,e){let r,c,o=t.nodeBefore,i=t.nodeAfter;if(o.type.spec.isolating||i.type.spec.isolating)return!1;if(function(n,t,e){let o=t.nodeBefore,i=t.nodeAfter,r=t.index();return!(!(o&&i&&o.type.compatibleContent(i.type))||(!o.content.size&&t.parent.canReplace(r-1,r)?(e&&e(n.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(r,r+1)||!i.isTextblock&&!(0,f.Mn)(n.doc,t.pos)||(e&&e(n.tr.clearIncompatible(t.pos,o.type,o.contentMatchAt(o.childCount)).join(t.pos).scrollIntoView()),0)))}(n,t,e))return!0;let p=t.parent.canReplace(t.index(),t.index()+1);if(p&&(r=(c=o.contentMatchAt(o.childCount)).findWrapping(i.type))&&c.matchType(r[0]||i.type).validEnd){if(e){let B=t.pos+i.nodeSize,U=y.HY.empty;for(let Mt=r.length-1;Mt>=0;Mt--)U=y.HY.from(r[Mt].create(null,U));U=y.HY.from(o.copy(U));let K=n.tr.step(new f.FC(t.pos-1,B,t.pos,B,new y.p2(U,1,0),r.length,!0)),rt=B+2*r.length;(0,f.Mn)(K.doc,rt)&&K.join(rt),e(K.scrollIntoView())}return!0}let h=g.Y1.findFrom(t,1),C=h&&h.$from.blockRange(h.$to),M=C&&(0,f.k9)(C);if(null!=M&&M>=t.depth)return e&&e(n.tr.lift(C,M).scrollIntoView()),!0;if(p&&nt(i,"start",!0)&&nt(o,"end")){let B=o,U=[];for(;U.push(B),!B.isTextblock;)B=B.lastChild;let K=i,rt=1;for(;!K.isTextblock;K=K.firstChild)rt++;if(B.canReplace(B.childCount,B.childCount,K.content)){if(e){let Mt=y.HY.empty;for(let Lt=U.length-1;Lt>=0;Lt--)Mt=y.HY.from(U[Lt].copy(Mt));e(n.tr.step(new f.FC(t.pos-U.length,t.pos+i.nodeSize,t.pos+rt,t.pos+i.nodeSize-rt,new y.p2(Mt,U.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Dt(n){return function(t,e){let o=t.selection,i=n<0?o.$from:o.$to,r=i.depth;for(;i.node(r).isInline;){if(!r)return!1;r--}return!!i.node(r).isTextblock&&(e&&e(t.tr.setSelection(g.Bs.create(t.doc,n<0?i.start(r):i.end(r)))),!0)}}const Ut=Dt(-1),ot=Dt(1);function Z(n,t=null){return function(e,o){let{from:i,to:r}=e.selection,c=!1;return e.doc.nodesBetween(i,r,(p,h)=>{if(c)return!1;if(p.isTextblock&&!p.hasMarkup(n,t))if(p.type==n)c=!0;else{let C=e.doc.resolve(h),M=C.index();c=C.parent.canReplaceWith(M,M+1,n)}}),!!c&&(o&&o(e.tr.setBlockType(i,r,n,t).scrollIntoView()),!0)}}function tt(...n){return function(t,e,o){for(let i=0;i<n.length;i++)if(n[i](t,e,o))return!0;return!1}}let Ot=tt(q,b,j),It=tt(q,et,mt);const Ft={Enter:tt(ut,Q,N,(n,t)=>{let{$from:e,$to:o}=n.selection;if(n.selection instanceof g.qv&&n.selection.node.isBlock)return!(!e.parentOffset||!(0,f.Ax)(n.doc,e.pos)||(t&&t(n.tr.split(e.pos).scrollIntoView()),0));if(!e.parent.isBlock)return!1;if(t){let i=o.parentOffset==o.parent.content.size,r=n.tr;(n.selection instanceof g.Bs||n.selection instanceof g.C1)&&r.deleteSelection();let c=0==e.depth?null:$(e.node(-1).contentMatchAt(e.indexAfter(-1))),p=i&&c?[{type:c}]:void 0,h=(0,f.Ax)(r.doc,r.mapping.map(e.pos),1,p);if(!p&&!h&&(0,f.Ax)(r.doc,r.mapping.map(e.pos),1,c?[{type:c}]:void 0)&&(c&&(p=[{type:c}]),h=!0),h&&(r.split(r.mapping.map(e.pos),1,p),!i&&!e.parentOffset&&e.parent.type!=c)){let C=r.mapping.map(e.before()),M=r.doc.resolve(C);c&&e.node(-1).canReplaceWith(M.index(),M.index()+1,c)&&r.setNodeMarkup(r.mapping.map(e.before()),c)}t(r.scrollIntoView())}return!0}),"Mod-Enter":W,Backspace:Ot,"Mod-Backspace":Ot,"Shift-Backspace":Ot,Delete:It,"Mod-Delete":It,"Mod-a":(n,t)=>(t&&t(n.tr.setSelection(new g.C1(n.doc))),!0)},$t={"Ctrl-h":Ft.Backspace,"Alt-Backspace":Ft["Mod-Backspace"],"Ctrl-d":Ft.Delete,"Ctrl-Alt-Backspace":Ft["Mod-Delete"],"Alt-Delete":Ft["Mod-Delete"],"Alt-d":Ft["Mod-Delete"],"Ctrl-a":Ut,"Ctrl-e":ot};for(let n in Ft)$t[n]=Ft[n];function ee(n){const{state:t,transaction:e}=n;let{selection:o}=e,{doc:i}=e,{storedMarks:r}=e;return Me(Bt({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return r},get selection(){return o},get doc(){return i},get tr(){return o=e.selection,i=e.doc,r=e.storedMarks,e}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class te{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:o}=this,{view:i}=e,{tr:r}=o,c=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([p,h])=>[p,(...M)=>{const B=h(...M)(c);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(r),B}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:c}=i,p=[],h=!!t,C=t||r.tr,B=Me(Bt({},Object.fromEntries(Object.entries(o).map(([U,K])=>[U,(...Mt)=>{const bt=this.buildProps(C,e),Lt=K(...Mt)(bt);return p.push(Lt),B}]))),{run:()=>(!h&&e&&!C.getMeta("preventDispatch")&&!this.hasCustomState&&c.dispatch(C),p.every(U=>!0===U))});return B}createCan(t){const{rawCommands:e,state:o}=this,i=void 0,r=t||o.tr,c=this.buildProps(r,i),p=Object.fromEntries(Object.entries(e).map(([h,C])=>[h,(...M)=>C(...M)(Me(Bt({},c),{dispatch:i}))]));return Me(Bt({},p),{chain:()=>this.createChain(r,i)})}buildProps(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:c}=i;r.storedMarks&&t.setStoredMarks(r.storedMarks);const p={tr:t,editor:i,view:c,state:ee({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(o).map(([h,C])=>[h,(...M)=>C(...M)(p)]))}};return p}}function z(n,t,e){return void 0===n.config[t]&&n.parent?z(n.parent,t,e):"function"==typeof n.config[t]?n.config[t].bind(Me(Bt({},e),{parent:n.parent?z(n.parent,t,e):null})):n.config[t]}function v(n){return{baseExtensions:n.filter(i=>"extension"===i.type),nodeExtensions:n.filter(i=>"node"===i.type),markExtensions:n.filter(i=>"mark"===i.type)}}function O(n){const t=[],{nodeExtensions:e,markExtensions:o}=v(n),i=[...e,...o],r={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(c=>{const h=z(c,"addGlobalAttributes",{name:c.name,options:c.options,storage:c.storage});h&&h().forEach(M=>{M.types.forEach(B=>{Object.entries(M.attributes).forEach(([U,K])=>{t.push({type:B,name:U,attribute:Bt(Bt({},r),K)})})})})}),i.forEach(c=>{const h=z(c,"addAttributes",{name:c.name,options:c.options,storage:c.storage});if(!h)return;const C=h();Object.entries(C).forEach(([M,B])=>{const U=Bt(Bt({},r),B);B.isRequired&&void 0===B.default&&delete U.default,t.push({type:c.name,name:M,attribute:U})})}),t}function I(n,t){if("string"==typeof n){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}function P(...n){return n.filter(t=>!!t).reduce((t,e)=>{const o=Bt({},t);return Object.entries(e).forEach(([i,r])=>{o[i]=o[i]?"class"===i?[o[i],r].join(" "):"style"===i?[o[i],r].join("; "):r:r}),o},{})}function H(n,t){return t.filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,o)=>P(e,o),{})}function k(n){return"function"==typeof n}function X(n,t,...e){return k(n)?t?n.bind(t)(...e):n(...e):n}function kt(n,t){return n.style?n:Me(Bt({},n),{getAttrs:e=>{const o=n.getAttrs?n.getAttrs(e):n.attrs;if(!1===o)return!1;const i=t.reduce((r,c)=>{const p=c.attribute.parseHTML?c.attribute.parseHTML(e):function(n){return"string"!=typeof n?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):"true"===n||"false"!==n&&n}(e.getAttribute(c.name));return null==p?r:Me(Bt({},r),{[c.name]:p})},{});return Bt(Bt({},o),i)}})}function wt(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>("attrs"!==t||!function(n={}){return 0===Object.keys(n).length&&n.constructor===Object}(e))&&null!=e))}function w(n){var t;const e=O(n),{nodeExtensions:o,markExtensions:i}=v(n),r=null===(t=o.find(h=>z(h,"topNode")))||void 0===t?void 0:t.name,c=Object.fromEntries(o.map(h=>{const C=e.filter(bt=>bt.type===h.name),M={name:h.name,options:h.options,storage:h.storage},B=n.reduce((bt,Lt)=>{const jt=z(Lt,"extendNodeSchema",M);return Bt(Bt({},bt),jt?jt(h):{})},{}),U=wt(Me(Bt({},B),{content:X(z(h,"content",M)),marks:X(z(h,"marks",M)),group:X(z(h,"group",M)),inline:X(z(h,"inline",M)),atom:X(z(h,"atom",M)),selectable:X(z(h,"selectable",M)),draggable:X(z(h,"draggable",M)),code:X(z(h,"code",M)),defining:X(z(h,"defining",M)),isolating:X(z(h,"isolating",M)),attrs:Object.fromEntries(C.map(bt=>{var Lt;return[bt.name,{default:null===(Lt=null==bt?void 0:bt.attribute)||void 0===Lt?void 0:Lt.default}]}))})),K=X(z(h,"parseHTML",M));K&&(U.parseDOM=K.map(bt=>kt(bt,C)));const rt=z(h,"renderHTML",M);rt&&(U.toDOM=bt=>rt({node:bt,HTMLAttributes:H(bt,C)}));const Mt=z(h,"renderText",M);return Mt&&(U.toText=Mt),[h.name,U]})),p=Object.fromEntries(i.map(h=>{const C=e.filter(Mt=>Mt.type===h.name),M={name:h.name,options:h.options,storage:h.storage},B=n.reduce((Mt,bt)=>{const Lt=z(bt,"extendMarkSchema",M);return Bt(Bt({},Mt),Lt?Lt(h):{})},{}),U=wt(Me(Bt({},B),{inclusive:X(z(h,"inclusive",M)),excludes:X(z(h,"excludes",M)),group:X(z(h,"group",M)),spanning:X(z(h,"spanning",M)),code:X(z(h,"code",M)),attrs:Object.fromEntries(C.map(Mt=>{var bt;return[Mt.name,{default:null===(bt=null==Mt?void 0:Mt.attribute)||void 0===bt?void 0:bt.default}]}))})),K=X(z(h,"parseHTML",M));K&&(U.parseDOM=K.map(Mt=>kt(Mt,C)));const rt=z(h,"renderHTML",M);return rt&&(U.toDOM=Mt=>rt({mark:Mt,HTMLAttributes:H(Mt,C)})),[h.name,U]}));return new y.V_({topNode:r,nodes:c,marks:p})}function l(n,t){return t.nodes[n]||t.marks[n]||null}function d(n,t){return Array.isArray(t)?t.some(e=>("string"==typeof e?e:e.name)===n.name):t}const m=(n,t=500)=>{let e="";return n.parent.nodesBetween(Math.max(0,n.parentOffset-t),n.parentOffset,(o,i,r,c)=>{var p,h;e+=(null===(h=(p=o.type.spec).toText)||void 0===h?void 0:h.call(p,{node:o,pos:i,parent:r,index:c}))||o.textContent||"%leaf%"}),e};function E(n){return"[object RegExp]"===Object.prototype.toString.call(n)}class A{constructor(t){this.find=t.find,this.handler=t.handler}}function lt(n){var t;const{editor:e,from:o,to:i,text:r,rules:c,plugin:p}=n,{view:h}=e;if(h.composing)return!1;const C=h.state.doc.resolve(o);if(C.parent.type.spec.code||(null===(t=C.nodeBefore||C.nodeAfter)||void 0===t?void 0:t.marks.find(U=>U.type.spec.code)))return!1;let M=!1;const B=m(C)+r;return c.forEach(U=>{if(M)return;const K=((n,t)=>{if(E(t))return t.exec(n);const e=t(n);if(!e)return null;const o=[];return o.push(e.text),o.index=e.index,o.input=n,o.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(e.replaceWith)),o})(B,U.find);if(!K)return;const rt=h.state.tr,Mt=ee({state:h.state,transaction:rt}),bt={from:o-(K[0].length-r.length),to:i},{commands:Lt,chain:jt,can:de}=new te({editor:e,state:Mt});null===U.handler({state:Mt,range:bt,match:K,commands:Lt,chain:jt,can:de})||!rt.steps.length||(rt.setMeta(p,{transform:rt,from:o,to:i,text:r}),h.dispatch(rt),M=!0)}),M}function Ct(n){const{editor:t,rules:e}=n,o=new g.Sy({state:{init:()=>null,apply:(i,r)=>i.getMeta(o)||(i.selectionSet||i.docChanged?null:r)},props:{handleTextInput:(i,r,c,p)=>lt({editor:t,from:r,to:c,text:p,rules:e,plugin:o}),handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:r}=i.state.selection;r&&lt({editor:t,from:r.pos,to:r.pos,text:"",rules:e,plugin:o})}),!1)},handleKeyDown(i,r){if("Enter"!==r.key)return!1;const{$cursor:c}=i.state.selection;return!!c&&lt({editor:t,from:c.pos,to:c.pos,text:"\n",rules:e,plugin:o})}},isInputRules:!0});return o}class Nt{constructor(t){this.find=t.find,this.handler=t.handler}}function ae(n){const{editor:t,rules:e}=n;let o=null,i=!1,r=!1;return e.map(p=>new g.Sy({view(h){const C=M=>{var B;o=(null===(B=h.dom.parentElement)||void 0===B?void 0:B.contains(M.target))?h.dom.parentElement:null};return window.addEventListener("dragstart",C),{destroy(){window.removeEventListener("dragstart",C)}}},props:{handleDOMEvents:{drop:h=>(r=o===h.dom.parentElement,!1),paste:(h,C)=>{var M;const B=null===(M=C.clipboardData)||void 0===M?void 0:M.getData("text/html");return i=!!(null==B?void 0:B.includes("data-pm-slice")),!1}}},appendTransaction:(h,C,M)=>{const B=h[0],U="paste"===B.getMeta("uiEvent")&&!i,K="drop"===B.getMeta("uiEvent")&&!r;if(!U&&!K)return;const rt=C.doc.content.findDiffStart(M.doc.content),Mt=C.doc.content.findDiffEnd(M.doc.content);if(!function(n){return"number"==typeof n}(rt)||!Mt||rt===Mt.b)return;const bt=M.tr,Lt=ee({state:M,transaction:bt});return function(n){const{editor:t,state:e,from:o,to:i,rule:r}=n,{commands:c,chain:p,can:h}=new te({editor:t,state:e}),C=[];return e.doc.nodesBetween(o,i,(B,U)=>{if(!B.isTextblock||B.type.spec.code)return;const K=Math.max(o,U),rt=Math.min(i,U+B.content.size);((n,t)=>{if(E(t))return[...n.matchAll(t)];const e=t(n);return e?e.map(o=>{const i=[];return i.push(o.text),i.index=o.index,i.input=n,i.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(o.replaceWith)),i}):[]})(B.textBetween(K-U,rt-U,void 0,"\ufffc"),r.find).forEach(Lt=>{if(void 0===Lt.index)return;const jt=K+Lt.index+1,de=jt+Lt[0].length,xe={from:e.tr.mapping.map(jt),to:e.tr.mapping.map(de)},ue=r.handler({state:e,range:xe,match:Lt,commands:c,chain:p,can:h});C.push(ue)})}),C.every(B=>null!==B)}({editor:t,state:Lt,from:Math.max(rt-1,0),to:Mt.b,rule:p})&&bt.steps.length?bt:void 0}}))}class He{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=He.resolve(t),this.schema=w(this.extensions),this.extensions.forEach(o=>{var i;this.editor.extensionStorage[o.name]=o.storage;const r={name:o.name,options:o.options,storage:o.storage,editor:this.editor,type:l(o.name,this.schema)};"mark"===o.type&&(null===(i=X(z(o,"keepOnSplit",r)))||void 0===i||i)&&this.splittableMarks.push(o.name);const c=z(o,"onBeforeCreate",r);c&&this.editor.on("beforeCreate",c);const p=z(o,"onCreate",r);p&&this.editor.on("create",p);const h=z(o,"onUpdate",r);h&&this.editor.on("update",h);const C=z(o,"onSelectionUpdate",r);C&&this.editor.on("selectionUpdate",C);const M=z(o,"onTransaction",r);M&&this.editor.on("transaction",M);const B=z(o,"onFocus",r);B&&this.editor.on("focus",B);const U=z(o,"onBlur",r);U&&this.editor.on("blur",U);const K=z(o,"onDestroy",r);K&&this.editor.on("destroy",K)})}static resolve(t){const e=He.sort(He.flatten(t)),o=function(n){const t=n.filter((e,o)=>n.indexOf(e)!==o);return[...new Set(t)]}(e.map(i=>i.name));return o.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${o.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(e=>{const i=z(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return i?[e,...this.flatten(i())]:e}).flat(10)}static sort(t){return t.sort((o,i)=>{const r=z(o,"priority")||100,c=z(i,"priority")||100;return r>c?-1:r<c?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const i=z(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:l(e.name,this.schema)});return i?Bt(Bt({},t),i()):t},{})}get plugins(){const{editor:t}=this,e=He.sort([...this.extensions].reverse()),o=[],i=[],r=e.map(c=>{const p={name:c.name,options:c.options,storage:c.storage,editor:t,type:l(c.name,this.schema)},h=[],C=z(c,"addKeyboardShortcuts",p);if(C){const K=Object.fromEntries(Object.entries(C()).map(([Mt,bt])=>[Mt,()=>bt({editor:t})])),rt=(0,L.h)(K);h.push(rt)}const M=z(c,"addInputRules",p);d(c,t.options.enableInputRules)&&M&&o.push(...M());const B=z(c,"addPasteRules",p);d(c,t.options.enablePasteRules)&&B&&i.push(...B());const U=z(c,"addProseMirrorPlugins",p);if(U){const K=U();h.push(...K)}return h}).flat();return[Ct({editor:t,rules:o}),...ae({editor:t,rules:i}),...r]}get attributes(){return O(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=v(this.extensions);return Object.fromEntries(e.filter(o=>!!z(o,"addNodeView")).map(o=>{const i=this.attributes.filter(h=>h.type===o.name),r={name:o.name,options:o.options,storage:o.storage,editor:t,type:I(o.name,this.schema)},c=z(o,"addNodeView",r);return c?[o.name,(h,C,M,B)=>{const U=H(h,i);return c()({editor:t,node:h,getPos:M,decorations:B,HTMLAttributes:U,extension:o})}]:[]}))}}function dn(n){return"Object"===function(n){return Object.prototype.toString.call(n).slice(8,-1)}(n)&&n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function vn(n,t){const e=Bt({},n);return dn(n)&&dn(t)&&Object.keys(t).forEach(o=>{dn(t[o])?o in n?e[o]=vn(n[o],t[o]):Object.assign(e,{[o]:t[o]}):Object.assign(e,{[o]:t[o]})}),e}class De{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Bt(Bt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=X(z(this,"addOptions",{name:this.name}))),this.storage=X(z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new De(t)}configure(t={}){const e=this.extend();return e.options=vn(this.options,t),e.storage=X(z(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new De(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=X(z(e,"addOptions",{name:e.name})),e.storage=X(z(e,"addStorage",{name:e.name,options:e.options})),e}}function qe(n,t,e){const{from:o,to:i}=t,{blockSeparator:r="\n\n",textSerializers:c={}}=e||{};let p="",h=!0;return n.nodesBetween(o,i,(C,M,B,U)=>{var K;const rt=null==c?void 0:c[C.type.name];rt?(C.isBlock&&!h&&(p+=r,h=!0),B&&(p+=rt({node:C,pos:M,parent:B,index:U,range:t}))):C.isText?(p+=null===(K=null==C?void 0:C.text)||void 0===K?void 0:K.slice(Math.max(o,M)-M,i-M),h=!1):C.isBlock&&!h&&(p+=r,h=!0)}),p}function Ue(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const Qt=De.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new g.Sy({key:new g.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:o,selection:i}=t,{ranges:r}=i;return qe(o,{from:Math.min(...r.map(M=>M.$from.pos)),to:Math.max(...r.map(M=>M.$to.pos))},{textSerializers:Ue(e)})}}})]}});function je(n,t,e={strict:!0}){const o=Object.keys(t);return!o.length||o.every(i=>e.strict?t[i]===n[i]:E(t[i])?t[i].test(n[i]):t[i]===n[i])}function en(n,t,e={}){return n.find(o=>o.type===t&&je(o.attrs,e))}function un(n,t,e={}){return!!en(n,t,e)}function Fe(n,t,e={}){if(!n||!t)return;let o=n.parent.childAfter(n.parentOffset);if(n.parentOffset===o.offset&&0!==o.offset&&(o=n.parent.childBefore(n.parentOffset)),!o.node)return;const i=en([...o.node.marks],t,e);if(!i)return;let r=o.index,c=n.start()+o.offset,p=r+1,h=c+o.node.nodeSize;for(en([...o.node.marks],t,e);r>0&&i.isInSet(n.parent.child(r-1).marks);)r-=1,c-=n.parent.child(r).nodeSize;for(;p<n.parent.childCount&&un([...n.parent.child(p).marks],t,e);)h+=n.parent.child(p).nodeSize,p+=1;return{from:c,to:h}}function ie(n,t){if("string"==typeof n){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}function Qe(n){return n&&"object"==typeof n&&!Array.isArray(n)&&!function(n){var t;return"class"===(null===(t=n.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(n)}function Le(n){return Qe(n)&&n instanceof g.Bs}function ge(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function On(n,t=null){if(!t)return null;const e=g.Y1.atStart(n),o=g.Y1.atEnd(n);if("start"===t||!0===t)return e;if("end"===t)return o;const i=e.from,r=o.to;return"all"===t?g.Bs.create(n,ge(0,i,r),ge(n.content.size,i,r)):g.Bs.create(n,ge(t,i,r),ge(t,i,r))}function We(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function bn(n){const t=`<body>${n}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function pn(n,t,e){if(e=Bt({slice:!0,parseOptions:{}},e),"object"==typeof n&&null!==n)try{return Array.isArray(n)?y.HY.fromArray(n.map(o=>t.nodeFromJSON(o))):t.nodeFromJSON(n)}catch(o){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),pn("",t,e)}if("string"==typeof n){const o=y.aw.fromSchema(t);return e.slice?o.parseSlice(bn(n),e.parseOptions).content:o.parse(bn(n),e.parseOptions)}return pn("",t,e)}function Dn(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function ze(n,t,e={}){const{from:o,to:i,empty:r}=n.selection,c=t?I(t,n.schema):null,p=[];n.doc.nodesBetween(o,i,(B,U)=>{if(B.isText)return;const K=Math.max(o,U),rt=Math.min(i,U+B.nodeSize);p.push({node:B,from:K,to:rt})});const h=i-o,C=p.filter(B=>!c||c.name===B.node.type.name).filter(B=>je(B.node.attrs,e,{strict:!1}));return r?!!C.length:C.reduce((B,U)=>B+U.to-U.from,0)>=h}function a(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function _(n,t){const e="string"==typeof t?[t]:t;return Object.keys(n).reduce((o,i)=>(e.includes(i)||(o[i]=n[i]),o),{})}function zt(n,t,e={}){return pn(n,t,{slice:!1,parseOptions:e})}function Yt(n,t){const e=ie(t,n.schema),{from:o,to:i,empty:r}=n.selection,c=[];r?(n.storedMarks&&c.push(...n.storedMarks),c.push(...n.selection.$head.marks())):n.doc.nodesBetween(o,i,h=>{c.push(...h.marks)});const p=c.find(h=>h.type.name===e.name);return p?Bt({},p.attrs):{}}function Ge(n,t,e){return Object.fromEntries(Object.entries(e).filter(([o])=>{const i=n.find(r=>r.type===t&&r.name===o);return!!i&&i.attribute.keepOnSplit}))}function hn(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const o=e.filter(i=>null==t?void 0:t.includes(i.type.name));n.tr.ensureMarks(o)}}function mn(n,t){for(let e=n.depth;e>0;e-=1){const o=n.node(e);if(t(o))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:o}}}function Je(n){return t=>mn(t.$from,n)}function rn(n,t){const{nodeExtensions:e}=v(t),o=e.find(c=>c.name===n);if(!o)return!1;const r=X(z(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}const sn=(n,t)=>{const e=Je(c=>c.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,f.Mn)(n.doc,e.pos)&&n.join(e.pos),!0},ln=(n,t)=>{const e=Je(c=>c.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(e.start).after(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,f.Mn)(n.doc,o)&&n.join(o),!0};function Pe(n,t,e={}){const{empty:o,ranges:i}=n.selection,r=t?ie(t,n.schema):null;if(o)return!!(n.storedMarks||n.selection.$from.marks()).filter(B=>!r||r.name===B.type.name).find(B=>je(B.attrs,e,{strict:!1}));let c=0;const p=[];if(i.forEach(({$from:B,$to:U})=>{const K=B.pos,rt=U.pos;n.doc.nodesBetween(K,rt,(Mt,bt)=>{if(!Mt.isText&&!Mt.marks.length)return;const Lt=Math.max(K,bt),jt=Math.min(rt,bt+Mt.nodeSize);c+=jt-Lt,p.push(...Mt.marks.map(xe=>({mark:xe,from:Lt,to:jt})))})}),0===c)return!1;const h=p.filter(B=>!r||r.name===B.mark.type.name).filter(B=>je(B.mark.attrs,e,{strict:!1})).reduce((B,U)=>B+U.to-U.from,0),C=p.filter(B=>!r||B.mark.type!==r&&B.mark.type.excludes(r)).reduce((B,U)=>B+U.to-U.from,0);return(h>0?h+C:h)>=c}var Xe=Object.freeze({__proto__:null,blur:()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),null===(e=null==window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())}),!0),clearContent:(n=!1)=>({commands:t})=>t.setContent("",n),clearNodes:()=>({state:n,tr:t,dispatch:e})=>{const{selection:o}=t,{ranges:i}=o;return e&&i.forEach(({$from:r,$to:c})=>{n.doc.nodesBetween(r.pos,c.pos,(p,h)=>{if(p.type.isText)return;const{doc:C,mapping:M}=t,B=C.resolve(M.map(h)),U=C.resolve(M.map(h+p.nodeSize)),K=B.blockRange(U);if(!K)return;const rt=(0,f.k9)(K);if(p.type.isTextblock){const{defaultType:Mt}=B.parent.contentMatchAt(B.index());t.setNodeMarkup(K.start,Mt)}(rt||0===rt)&&t.lift(K,rt)})}),!0},command:n=>t=>n(t),createParagraphNear:()=>({state:n,dispatch:t})=>Q(n,t),deleteNode:n=>({tr:t,state:e,dispatch:o})=>{const i=I(n,e.schema),r=t.selection.$anchor;for(let c=r.depth;c>0;c-=1)if(r.node(c).type===i){if(o){const h=r.before(c),C=r.after(c);t.delete(h,C).scrollIntoView()}return!0}return!1},deleteRange:n=>({tr:t,dispatch:e})=>{const{from:o,to:i}=n;return e&&t.delete(o,i),!0},deleteSelection:()=>({state:n,dispatch:t})=>q(n,t),enter:()=>({commands:n})=>n.keyboardShortcut("Enter"),exitCode:()=>({state:n,dispatch:t})=>W(n,t),extendMarkRange:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const r=ie(n,o.schema),{doc:c,selection:p}=e,{$from:h,from:C,to:M}=p;if(i){const B=Fe(h,r,t);if(B&&B.from<=C&&B.to>=M){const U=g.Bs.create(c,B.from,B.to);e.setSelection(U)}}return!0},first:n=>t=>{const e="function"==typeof n?n(t):n;for(let o=0;o<e.length;o+=1)if(e[o](t))return!0;return!1},focus:(n=null,t={})=>({editor:e,view:o,tr:i,dispatch:r})=>{t=Bt({scrollIntoView:!0},t);const c=()=>{We()&&o.dom.focus(),requestAnimationFrame(()=>{e.isDestroyed||(o.focus(),(null==t?void 0:t.scrollIntoView)&&e.commands.scrollIntoView())})};if(o.hasFocus()&&null===n||!1===n)return!0;if(r&&null===n&&!Le(e.state.selection))return c(),!0;const p=On(e.state.doc,n)||e.state.selection,h=e.state.selection.eq(p);return r&&(h||i.setSelection(p),h&&i.storedMarks&&i.setStoredMarks(i.storedMarks),c()),!0},forEach:(n,t)=>e=>n.every((o,i)=>t(o,Me(Bt({},e),{index:i}))),insertContent:(n,t)=>({tr:e,commands:o})=>o.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),insertContentAt:(n,t,e)=>({tr:o,dispatch:i,editor:r})=>{if(i){e=Bt({parseOptions:{},updateSelection:!0},e);const c=pn(t,r.schema,{parseOptions:Bt({preserveWhitespace:"full"},e.parseOptions)});if("<>"===c.toString())return!0;let{from:p,to:h}="number"==typeof n?{from:n,to:n}:n,C=!0,M=!0;if(((n=>n.toString().startsWith("<"))(c)?c:[c]).forEach(U=>{U.check(),C=!!C&&U.isText&&0===U.marks.length,M=!!M&&U.isBlock}),p===h&&M){const{parent:U}=o.doc.resolve(p);U.isTextblock&&!U.type.spec.code&&!U.childCount&&(p-=1,h+=1)}C?o.insertText(t,p,h):o.replaceWith(p,h,c),e.updateSelection&&function(n,t,e){const o=n.steps.length-1;if(o<t)return;const i=n.steps[o];if(!(i instanceof f.Pu||i instanceof f.FC))return;let c=0;n.mapping.maps[o].forEach((p,h,C,M)=>{0===c&&(c=M)}),n.setSelection(g.Y1.near(n.doc.resolve(c),-1))}(o,o.steps.length-1)}return!0},joinBackward:()=>({state:n,dispatch:t})=>b(n,t),joinForward:()=>({state:n,dispatch:t})=>et(n,t),keyboardShortcut:n=>({editor:t,view:e,tr:o,dispatch:i})=>{const r=function(n){const t=n.split(/-(?!$)/);let o,i,r,c,e=t[t.length-1];"Space"===e&&(e=" ");for(let p=0;p<t.length-1;p+=1){const h=t[p];if(/^(cmd|meta|m)$/i.test(h))c=!0;else if(/^a(lt)?$/i.test(h))o=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))r=!0;else{if(!/^mod$/i.test(h))throw new Error(`Unrecognized modifier name: ${h}`);We()||Dn()?c=!0:i=!0}}return o&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),c&&(e=`Meta-${e}`),r&&(e=`Shift-${e}`),e}(n).split(/-(?!$)/),c=r.find(C=>!["Alt","Ctrl","Meta","Shift"].includes(C)),p=new KeyboardEvent("keydown",{key:"Space"===c?" ":c,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),h=t.captureTransaction(()=>{e.someProp("handleKeyDown",C=>C(e,p))});return null==h||h.steps.forEach(C=>{const M=C.map(o.mapping);M&&i&&o.maybeStep(M)}),!0},lift:(n,t={})=>({state:e,dispatch:o})=>!!ze(e,I(n,e.schema),t)&&((n,t)=>{let{$from:e,$to:o}=n.selection,i=e.blockRange(o),r=i&&(0,f.k9)(i);return null!=r&&(t&&t(n.tr.lift(i,r).scrollIntoView()),!0)})(e,o),liftEmptyBlock:()=>({state:n,dispatch:t})=>N(n,t),liftListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);return!!r&&(!e||(o.node(r.depth-1).type==n?function(n,t,e,o){let i=n.tr,r=o.end,c=o.$to.end(o.depth);r<c&&(i.step(new f.FC(r-1,c,r,c,new y.p2(y.HY.from(e.create(null,o.parent.copy())),1,0),1,!0)),o=new y.Ts(i.doc.resolve(o.$from.pos),i.doc.resolve(c),o.depth));const p=(0,f.k9)(o);if(null==p)return!1;i.lift(o,p);let h=i.mapping.map(r,-1)-1;return(0,f.Mn)(i.doc,h)&&i.join(h),t(i.scrollIntoView()),!0}(t,e,n,r):function(n,t,e){let o=n.tr,i=e.parent;for(let K=e.end,rt=e.endIndex-1,Mt=e.startIndex;rt>Mt;rt--)K-=i.child(rt).nodeSize,o.delete(K-1,K+1);let r=o.doc.resolve(e.start),c=r.nodeAfter;if(o.mapping.map(e.end)!=e.start+r.nodeAfter.nodeSize)return!1;let p=0==e.startIndex,h=e.endIndex==i.childCount,C=r.node(-1),M=r.index(-1);if(!C.canReplace(M+(p?0:1),M+1,c.content.append(h?y.HY.empty:y.HY.from(i))))return!1;let B=r.pos,U=B+c.nodeSize;return o.step(new f.FC(B-(p?1:0),U+(h?1:0),B+1,U-1,new y.p2((p?y.HY.empty:y.HY.from(i.copy(y.HY.empty))).append(h?y.HY.empty:y.HY.from(i.copy(y.HY.empty))),p?0:1,h?0:1),p?0:1)),t(o.scrollIntoView()),!0}(t,e,r)))}}(I(n,t.schema))(t,e),newlineInCode:()=>({state:n,dispatch:t})=>ut(n,t),resetAttributes:(n,t)=>({tr:e,state:o,dispatch:i})=>{let r=null,c=null;const p=a("string"==typeof n?n:n.name,o.schema);return!!p&&("node"===p&&(r=I(n,o.schema)),"mark"===p&&(c=ie(n,o.schema)),i&&e.selection.ranges.forEach(h=>{o.doc.nodesBetween(h.$from.pos,h.$to.pos,(C,M)=>{r&&r===C.type&&e.setNodeMarkup(M,void 0,_(C.attrs,t)),c&&C.marks.length&&C.marks.forEach(B=>{c===B.type&&e.addMark(M,M+C.nodeSize,c.create(_(B.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),selectAll:()=>({tr:n,commands:t})=>t.setTextSelection({from:0,to:n.doc.content.size}),selectNodeBackward:()=>({state:n,dispatch:t})=>j(n,t),selectNodeForward:()=>({state:n,dispatch:t})=>mt(n,t),selectParentNode:()=>({state:n,dispatch:t})=>((n,t)=>{let i,{$from:e,to:o}=n.selection,r=e.sharedDepth(o);return 0!=r&&(i=e.before(r),t&&t(n.tr.setSelection(g.qv.create(n.doc,i))),!0)})(n,t),selectTextblockEnd:()=>({state:n,dispatch:t})=>ot(n,t),selectTextblockStart:()=>({state:n,dispatch:t})=>Ut(n,t),setContent:(n,t=!1,e={})=>({tr:o,editor:i,dispatch:r})=>{const{doc:c}=o,p=zt(n,i.schema,e),h=g.Bs.create(c,0,c.content.size);return r&&o.setSelection(h).replaceSelectionWith(p,!1).setMeta("preventUpdate",!t),!0},setMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const{selection:r}=e,{empty:c,ranges:p}=r,h=ie(n,o.schema);if(i)if(c){const C=Yt(o,h);e.addStoredMark(h.create(Bt(Bt({},C),t)))}else p.forEach(C=>{const M=C.$from.pos,B=C.$to.pos;o.doc.nodesBetween(M,B,(U,K)=>{const rt=Math.max(K,M),Mt=Math.min(K+U.nodeSize,B);U.marks.find(Lt=>Lt.type===h)?U.marks.forEach(Lt=>{h===Lt.type&&e.addMark(rt,Mt,h.create(Bt(Bt({},Lt.attrs),t)))}):e.addMark(rt,Mt,h.create(t))})});return!0},setMeta:(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),setNode:(n,t={})=>({state:e,dispatch:o,chain:i})=>{const r=I(n,e.schema);return r.isTextblock?i().command(({commands:c})=>!!Z(r,t)(e)||c.clearNodes()).command(({state:c})=>Z(r,t)(c,o)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,i=g.Y1.atStart(o).from,r=g.Y1.atEnd(o).to,c=ge(n,i,r),p=g.qv.create(o,c);t.setSelection(p)}return!0},setTextSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,{from:i,to:r}="number"==typeof n?{from:n,to:n}:n,c=g.Bs.atStart(o).from,p=g.Bs.atEnd(o).to,h=ge(i,c,p),C=ge(r,c,p),M=g.Bs.create(o,h,C);t.setSelection(M)}return!0},sinkListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,C=>C.childCount>0&&C.firstChild.type==n);if(!r)return!1;let c=r.startIndex;if(0==c)return!1;let p=r.parent,h=p.child(c-1);if(h.type!=n)return!1;if(e){let C=h.lastChild&&h.lastChild.type==p.type,M=y.HY.from(C?n.create():null),B=new y.p2(y.HY.from(n.create(null,y.HY.from(p.type.create(null,M)))),C?3:1,0),U=r.start,K=r.end;e(t.tr.step(new f.FC(U-(C?3:1),K,U,K,B,1,!0)).scrollIntoView())}return!0}}(I(n,t.schema))(t,e),splitBlock:({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:o,editor:i})=>{const{selection:r,doc:c}=t,{$from:p,$to:h}=r,M=Ge(i.extensionManager.attributes,p.node().type.name,p.node().attrs);if(r instanceof g.qv&&r.node.isBlock)return!(!p.parentOffset||!(0,f.Ax)(c,p.pos)||(o&&(n&&hn(e,i.extensionManager.splittableMarks),t.split(p.pos).scrollIntoView()),0));if(!p.parent.isBlock)return!1;if(o){const B=h.parentOffset===h.parent.content.size;r instanceof g.Bs&&t.deleteSelection();const U=0===p.depth?void 0:function(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}(p.node(-1).contentMatchAt(p.indexAfter(-1)));let K=B&&U?[{type:U,attrs:M}]:void 0,rt=(0,f.Ax)(t.doc,t.mapping.map(p.pos),1,K);if(!K&&!rt&&(0,f.Ax)(t.doc,t.mapping.map(p.pos),1,U?[{type:U}]:void 0)&&(rt=!0,K=U?[{type:U,attrs:M}]:void 0),rt&&(t.split(t.mapping.map(p.pos),1,K),U&&!B&&!p.parentOffset&&p.parent.type!==U)){const Mt=t.mapping.map(p.before()),bt=t.doc.resolve(Mt);p.node(-1).canReplaceWith(bt.index(),bt.index()+1,U)&&t.setNodeMarkup(t.mapping.map(p.before()),U)}n&&hn(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:n=>({tr:t,state:e,dispatch:o,editor:i})=>{var r;const c=I(n,e.schema),{$from:p,$to:h}=e.selection,C=e.selection.node;if(C&&C.isBlock||p.depth<2||!p.sameParent(h))return!1;const M=p.node(-1);if(M.type!==c)return!1;const B=i.extensionManager.attributes;if(0===p.parent.content.size&&p.node(-1).childCount===p.indexAfter(-1)){if(2===p.depth||p.node(-3).type!==c||p.index(-2)!==p.node(-2).childCount-1)return!1;if(o){let bt=y.HY.empty;const Lt=p.index(-1)?1:p.index(-2)?2:3;for(let Ve=p.depth-Lt;Ve>=p.depth-3;Ve-=1)bt=y.HY.from(p.node(Ve).copy(bt));const jt=p.indexAfter(-1)<p.node(-2).childCount?1:p.indexAfter(-2)<p.node(-3).childCount?2:3,de=Ge(B,p.node().type.name,p.node().attrs),xe=(null===(r=c.contentMatch.defaultType)||void 0===r?void 0:r.createAndFill(de))||void 0;bt=bt.append(y.HY.from(c.createAndFill(null,xe)||void 0));const ue=p.before(p.depth-(Lt-1));t.replace(ue,p.after(-jt),new y.p2(bt,4-Lt,0));let gn=-1;t.doc.nodesBetween(ue,t.doc.content.size,(Ve,Kt)=>{if(gn>-1)return!1;Ve.isTextblock&&0===Ve.content.size&&(gn=Kt+1)}),gn>-1&&t.setSelection(g.Bs.near(t.doc.resolve(gn))),t.scrollIntoView()}return!0}const U=h.pos===p.end()?M.contentMatchAt(0).defaultType:null,K=Ge(B,M.type.name,M.attrs),rt=Ge(B,p.node().type.name,p.node().attrs);t.delete(p.pos,h.pos);const Mt=U?[{type:c,attrs:K},{type:U,attrs:rt}]:[{type:c,attrs:K}];return!!(0,f.Ax)(t.doc,p.pos,2)&&(o&&t.split(p.pos,2,Mt).scrollIntoView(),!0)},toggleList:(n,t)=>({editor:e,tr:o,state:i,dispatch:r,chain:c,commands:p,can:h})=>{const{extensions:C}=e.extensionManager,M=I(n,i.schema),B=I(t,i.schema),{selection:U}=i,{$from:K,$to:rt}=U,Mt=K.blockRange(rt);if(!Mt)return!1;const bt=Je(Lt=>rn(Lt.type.name,C))(U);if(Mt.depth>=1&&bt&&Mt.depth-bt.depth<=1){if(bt.node.type===M)return p.liftListItem(B);if(rn(bt.node.type.name,C)&&M.validContent(bt.node.content)&&r)return c().command(()=>(o.setNodeMarkup(bt.pos,M),!0)).command(()=>sn(o,M)).command(()=>ln(o,M)).run()}return c().command(()=>!!h().wrapInList(M)||p.clearNodes()).wrapInList(M).command(()=>sn(o,M)).command(()=>ln(o,M)).run()},toggleMark:(n,t={},e={})=>({state:o,commands:i})=>{const{extendEmptyMarkRange:r=!1}=e,c=ie(n,o.schema);return Pe(o,c,t)?i.unsetMark(c,{extendEmptyMarkRange:r}):i.setMark(c,t)},toggleNode:(n,t,e={})=>({state:o,commands:i})=>{const r=I(n,o.schema),c=I(t,o.schema);return ze(o,r,e)?i.setNode(c):i.setNode(r,e)},toggleWrap:(n,t={})=>({state:e,commands:o})=>{const i=I(n,e.schema);return ze(e,i,t)?o.lift(i):o.wrapIn(i,t)},undoInputRule:()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let o=0;o<e.length;o+=1){const i=e[o];let r;if(i.spec.isInputRules&&(r=i.getState(n))){if(t){const c=n.tr,p=r.transform;for(let h=p.steps.length-1;h>=0;h-=1)c.step(p.steps[h].invert(p.docs[h]));if(r.text){const h=c.doc.resolve(r.from).marks();c.replaceWith(r.from,r.to,n.schema.text(r.text,h))}else c.delete(r.from,r.to)}return!0}}return!1},unsetAllMarks:()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:o,ranges:i}=e;return o||t&&i.forEach(r=>{n.removeMark(r.$from.pos,r.$to.pos)}),!0},unsetMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{var r;const{extendEmptyMarkRange:c=!1}=t,{selection:p}=e,h=ie(n,o.schema),{$from:C,empty:M,ranges:B}=p;if(!i)return!0;if(M&&c){let{from:U,to:K}=p;const rt=null===(r=C.marks().find(bt=>bt.type===h))||void 0===r?void 0:r.attrs,Mt=Fe(C,h,rt);Mt&&(U=Mt.from,K=Mt.to),e.removeMark(U,K,h)}else B.forEach(U=>{e.removeMark(U.$from.pos,U.$to.pos,h)});return e.removeStoredMark(h),!0},updateAttributes:(n,t={})=>({tr:e,state:o,dispatch:i})=>{let r=null,c=null;const p=a("string"==typeof n?n:n.name,o.schema);return!!p&&("node"===p&&(r=I(n,o.schema)),"mark"===p&&(c=ie(n,o.schema)),i&&e.selection.ranges.forEach(h=>{const C=h.$from.pos,M=h.$to.pos;o.doc.nodesBetween(C,M,(B,U)=>{r&&r===B.type&&e.setNodeMarkup(U,void 0,Bt(Bt({},B.attrs),t)),c&&B.marks.length&&B.marks.forEach(K=>{if(c===K.type){const rt=Math.max(U,C),Mt=Math.min(U+B.nodeSize,M);e.addMark(rt,Mt,c.create(Bt(Bt({},K.attrs),t)))}})})}),!0)},wrapIn:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,c=i.blockRange(r),p=c&&(0,f.nd)(c,n,t);return!!p&&(o&&o(e.tr.wrap(c,p).scrollIntoView()),!0)}}(I(n,e.schema),t)(e,o),wrapInList:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,c=i.blockRange(r),p=!1,h=c;if(!c)return!1;if(c.depth>=2&&i.node(c.depth-1).type.compatibleContent(n)&&0==c.startIndex){if(0==i.index(c.depth-1))return!1;let M=e.doc.resolve(c.start-2);h=new y.Ts(M,M,c.depth),c.endIndex<c.parent.childCount&&(c=new y.Ts(i,e.doc.resolve(r.end(c.depth)),c.depth)),p=!0}let C=(0,f.nd)(h,n,t,c);return!!C&&(o&&o(function(n,t,e,o,i){let r=y.HY.empty;for(let M=e.length-1;M>=0;M--)r=y.HY.from(e[M].type.create(e[M].attrs,r));n.step(new f.FC(t.start-(o?2:0),t.end,t.start,t.end,new y.p2(r,0,0),e.length,!0));let c=0;for(let M=0;M<e.length;M++)e[M].type==i&&(c=M+1);let p=e.length-c,h=t.start+e.length-(o?2:0),C=t.parent;for(let M=t.startIndex,B=t.endIndex,U=!0;M<B;M++,U=!1)!U&&(0,f.Ax)(n.doc,h,p)&&(n.split(h,p),h+=2*p),h+=C.child(M).nodeSize;return n}(e.tr,c,C,p,n).scrollIntoView()),!0)}}(I(n,e.schema),t)(e,o)});const oo=De.create({name:"commands",addCommands:()=>Bt({},Xe)}),Oe=De.create({name:"editable",addProseMirrorPlugins(){return[new g.Sy({key:new g.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),_n=De.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new g.Sy({key:new g.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const o=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1},blur:(t,e)=>{n.isFocused=!1;const o=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1}}}})]}}),an=De.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:c})=>[()=>c.undoInputRule(),()=>c.command(({tr:p})=>{const{selection:h,doc:C}=p,{empty:M,$anchor:B}=h,{pos:U,parent:K}=B,rt=g.Y1.atStart(C).from===U;return!(!(M&&rt&&K.type.isTextblock)||K.textContent.length)&&c.clearNodes()}),()=>c.deleteSelection(),()=>c.joinBackward(),()=>c.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:c})=>[()=>c.deleteSelection(),()=>c.joinForward(),()=>c.selectNodeForward()]),o={Enter:()=>this.editor.commands.first(({commands:c})=>[()=>c.newlineInCode(),()=>c.createParagraphNear(),()=>c.liftEmptyBlock(),()=>c.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i=Bt({},o),r=Me(Bt({},o),{"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return We()||Dn()?r:i},addProseMirrorPlugins(){return[new g.Sy({key:new g.H$("clearDocument"),appendTransaction:(n,t,e)=>{if(!n.some(rt=>rt.docChanged)||t.doc.eq(e.doc))return;const{empty:i,from:r,to:c}=t.selection,p=g.Y1.atStart(t.doc).from,h=g.Y1.atEnd(t.doc).to,C=r===p&&c===h,M=0===e.doc.textBetween(0,e.doc.content.size," "," ").length;if(i||!C||!M)return;const B=e.tr,U=ee({state:e,transaction:B}),{commands:K}=new te({editor:this.editor,state:U});return K.clearNodes(),B.steps.length?B:void 0}})]}}),re=De.create({name:"tabindex",addProseMirrorPlugins(){return[new g.Sy({key:new g.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var se=Object.freeze({__proto__:null,ClipboardTextSerializer:Qt,Commands:oo,Editable:Oe,FocusEvents:_n,Keymap:an,Tabindex:re});function $e(n,t){const e=I(t,n.schema),{from:o,to:i}=n.selection,r=[];n.doc.nodesBetween(o,i,p=>{r.push(p)});const c=r.reverse().find(p=>p.type.name===e.name);return c?Bt({},c.attrs):{}}function fo(n,t){const e=a("string"==typeof t?t:t.name,n.schema);return"node"===e?$e(n,t):"mark"===e?Yt(n,t):{}}function Qn(n,t){const e=y.PW.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function io(n,t){return qe(n,{from:0,to:n.content.size},t)}function ro(n,t,e={}){if(!t)return ze(n,null,e)||Pe(n,null,e);const o=a(t,n.schema);return"node"===o?ze(n,t,e):"mark"===o&&Pe(n,t,e)}function so(n){var t;const e=null===(t=n.type.createAndFill())||void 0===t?void 0:t.toJSON(),o=n.toJSON();return JSON.stringify(e)===JSON.stringify(o)}class lo extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const o=this.callbacks[t];return o&&o.forEach(i=>i.apply(this,e)),this}off(t,e){const o=this.callbacks[t];return o&&(e?this.callbacks[t]=o.filter(i=>i!==e):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(n,t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute("data-tiptap-style",""),o.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',document.getElementsByTagName("head")[0].appendChild(o),o}(0,this.options.injectNonce))}setOptions(t={}){this.options=Bt(Bt({},this.options),t),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const o=k(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:o});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,o=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(e))});this.view.updateState(o)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(se):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(null==o?void 0:o.type));this.extensionManager=new He(e,this)}createCommandManager(){this.commandManager=new te({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=zt(this.options.content,this.schema,this.options.parseOptions),e=On(t,this.options.autofocus);this.view=new s.tk(this.options.element,Me(Bt({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:g.yy.create({doc:t,selection:e||void 0})}));const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(c=>{var p;return null===(p=this.capturedTransaction)||void 0===p?void 0:p.step(c)}):void(this.capturedTransaction=t);const e=this.state.apply(t),o=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),o&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),r=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return fo(this.state,t)}isActive(t,e){return ro(this.state,"string"==typeof t?t:null,"string"==typeof t?e:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Qn(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:o={}}=t||{};return io(this.state.doc,{blockSeparator:e,textSerializers:Bt(Bt({},o),Ue(this.schema))})}get isEmpty(){return so(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function mo(n,t){const e=new f.wx(n);return t.forEach(o=>{o.steps.forEach(i=>{e.step(i)})}),e}function ao(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function Eo(n,t){const e=[];return n.descendants((o,i)=>{t(o)&&e.push({node:o,pos:i})}),e}function yo(n,t,e){const o=[];return n.nodesBetween(t.from,t.to,(i,r)=>{e(i)&&o.push({node:i,pos:r})}),o}function Xn(n){return w(He.resolve(n))}function Oo(n,t){const e=Xn(t);return Qn(y.NB.fromJSON(e,n).content,e)}function _o(n,t){const e=Xn(t),o=bn(n);return y.aw.fromSchema(e).parse(o).toJSON()}function xo(n,t,e){const{blockSeparator:o="\n\n",textSerializers:i={}}=e||{},r=Xn(t);return io(y.NB.fromJSON(r,n),{blockSeparator:o,textSerializers:Bt(Bt({},i),Ue(r))})}function Po(n){const{mapping:t,steps:e}=n,o=[];return t.maps.forEach((i,r)=>{const c=[];if(i.ranges.length)i.forEach((p,h)=>{c.push({from:p,to:h})});else{const{from:p,to:h}=e[r];if(void 0===p||void 0===h)return;c.push({from:p,to:h})}c.forEach(({from:p,to:h})=>{const C=t.slice(r).map(p,-1),M=t.slice(r).map(h),B=t.invert().map(C,-1),U=t.invert().map(M);o.push({oldRange:{from:B,to:U},newRange:{from:C,to:M}})})}),function(n){const t=function(n,t=JSON.stringify){const e={};return n.filter(o=>{const i=t(o);return!Object.prototype.hasOwnProperty.call(e,i)&&(e[i]=!0)})}(n);return 1===t.length?t:t.filter((e,o)=>!t.filter((r,c)=>c!==o).some(r=>e.oldRange.from>=r.oldRange.from&&e.oldRange.to<=r.oldRange.to&&e.newRange.from>=r.newRange.from&&e.newRange.to<=r.newRange.to))}(o)}function co(n,t=0){const o=n.type===n.type.schema.topNodeType?0:1,i=t,r=i+n.nodeSize,c=n.marks.map(C=>{const M={type:C.type.name};return Object.keys(C.attrs).length&&(M.attrs=Bt({},C.attrs)),M}),p=Bt({},n.attrs),h={type:n.type.name,from:i,to:r};return Object.keys(p).length&&(h.attrs=p),c.length&&(h.marks=c),n.content.childCount&&(h.content=[],n.forEach((C,M)=>{var B;null===(B=h.content)||void 0===B||B.push(co(C,t+M+o))})),n.text&&(h.text=n.text),h}function uo(n,t,e){const o=[];return n===t?e.resolve(n).marks().forEach(i=>{const c=Fe(e.resolve(n-1),i.type);!c||o.push(Bt({mark:i},c))}):e.nodesBetween(n,t,(i,r)=>{o.push(...i.marks.map(c=>({from:r,to:r+i.nodeSize,mark:c})))}),o}function Ao(n){return Qe(n)&&n instanceof g.qv}function po(n,t,e){const i=n.state.doc.content.size,r=ge(t,0,i),c=ge(e,0,i),p=n.coordsAtPos(r),h=n.coordsAtPos(c,-1),C=Math.min(p.top,h.top),M=Math.max(p.bottom,h.bottom),B=Math.min(p.left,h.left),U=Math.max(p.right,h.right),Lt={top:C,bottom:M,left:B,right:U,width:U-B,height:M-C,x:B,y:C};return Me(Bt({},Lt),{toJSON:()=>Lt})}function So(n){return new A({find:n.find,handler:({state:t,range:e,match:o})=>{const i=X(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,c=o[o.length-1],p=o[0];let h=e.to;if(c){const C=p.search(/\S/),M=e.from+p.indexOf(c),B=M+c.length;if(uo(e.from,e.to,t.doc).filter(K=>K.mark.type.excluded.find(Mt=>Mt===n.type&&Mt!==K.mark.type)).filter(K=>K.to>M).length)return null;B<e.to&&r.delete(B,e.to),M>e.from&&r.delete(e.from+C,M),h=e.from+C+c.length,r.addMark(e.from+C,h,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function Bo(n){return new A({find:n.find,handler:({state:t,range:e,match:o})=>{const i=X(n.getAttributes,void 0,o)||{},{tr:r}=t,c=e.from;let p=e.to;if(o[1]){let C=c+o[0].lastIndexOf(o[1]);C>p?C=p:p=C+o[1].length,r.insertText(o[0][o[0].length-1],c+o[0].length-1),r.replaceWith(C,p,n.type.create(i))}else o[0]&&r.replaceWith(c,p,n.type.create(i))}})}function No(n){return new A({find:n.find,handler:({state:t,range:e,match:o})=>{const i=t.doc.resolve(e.from),r=X(n.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,r)}})}function Ho(n){return new A({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const c=e.to;if(o[1]){const p=o[0].lastIndexOf(o[1]);i+=o[0].slice(p+o[1].length),r+=p;const h=r-c;h>0&&(i=o[0].slice(p-h,p)+i,r=c)}t.tr.insertText(i,r,c)}})}function Io(n){return new A({find:n.find,handler:({state:t,range:e,match:o})=>{const i=X(n.getAttributes,void 0,o)||{},r=t.tr.delete(e.from,e.to),p=r.doc.resolve(e.from).blockRange(),h=p&&(0,f.nd)(p,n.type,i);if(!h)return null;r.wrap(p,h);const C=r.doc.resolve(e.from-1).nodeBefore;C&&C.type===n.type&&(0,f.Mn)(r.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(o,C))&&r.join(e.from-1)}})}class Rn{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Bt(Bt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=X(z(this,"addOptions",{name:this.name}))),this.storage=X(z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Rn(t)}configure(t={}){const e=this.extend();return e.options=vn(this.options,t),e.storage=X(z(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Rn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=X(z(e,"addOptions",{name:e.name})),e.storage=X(z(e,"addStorage",{name:e.name,options:e.options})),e}}class Ln{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Bt(Bt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=X(z(this,"addOptions",{name:this.name}))),this.storage=X(z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Ln(t)}configure(t={}){const e=this.extend();return e.options=vn(this.options,t),e.storage=X(z(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Ln(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=X(z(e,"addOptions",{name:e.name})),e.storage=X(z(e,"addStorage",{name:e.name,options:e.options})),e}}class go{constructor(t,e,o){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options=Bt({stopEvent:null,ignoreMutation:null},o),this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,o,i,r,c,p,h;const{view:C}=this.editor,M=t.target,B=3===M.nodeType?null===(e=M.parentElement)||void 0===e?void 0:e.closest("[data-drag-handle]"):M.closest("[data-drag-handle]");if(!this.dom||(null===(o=this.contentDOM)||void 0===o?void 0:o.contains(M))||!B)return;let U=0,K=0;if(this.dom!==B){const bt=this.dom.getBoundingClientRect(),Lt=B.getBoundingClientRect(),jt=null!==(i=t.offsetX)&&void 0!==i?i:null===(r=t.nativeEvent)||void 0===r?void 0:r.offsetX,de=null!==(c=t.offsetY)&&void 0!==c?c:null===(p=t.nativeEvent)||void 0===p?void 0:p.offsetY;U=Lt.x-bt.x+jt,K=Lt.y-bt.y+de}null===(h=t.dataTransfer)||void 0===h||h.setDragImage(this.dom,U,K);const rt=g.qv.create(C.state.doc,this.getPos()),Mt=C.state.tr.setSelection(rt);C.dispatch(Mt)}stopEvent(t){var e;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const o=t.target;if(!this.dom.contains(o)||(null===(e=this.contentDOM)||void 0===e?void 0:e.contains(o)))return!1;const r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(o.tagName)||o.isContentEditable)&&!r)return!0;const{isEditable:p}=this.editor,{isDragging:h}=this,C=!!this.node.type.spec.draggable,M=g.qv.isSelectable(this.node),B="copy"===t.type,U="paste"===t.type,K="cut"===t.type,rt="mousedown"===t.type,Mt=t.type.startsWith("drag");if(!C&&M&&Mt&&t.preventDefault(),C&&Mt&&!h)return t.preventDefault(),!1;if(C&&p&&!h&&rt){const bt=o.closest("[data-drag-handle]");bt&&(this.dom===bt||this.dom.contains(bt))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(h||r||B||U||K||rt&&M)}ignoreMutation(t){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:t}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===t.type||this.dom.contains(t.target)&&"childList"===t.type&&We()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(o=>o.isContentEditable)||(this.contentDOM!==t.target||"attributes"!==t.type)&&this.contentDOM.contains(t.target))))}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const o=this.getPos();return e.setNodeMarkup(o,void 0,Bt(Bt({},this.node.attrs),t)),!0})}deleteNode(){const t=this.getPos();this.editor.commands.deleteRange({from:t,to:t+this.node.nodeSize})}}function ko(n){return new Nt({find:n.find,handler:({state:t,range:e,match:o})=>{const i=X(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,c=o[o.length-1],p=o[0];let h=e.to;if(c){const C=p.search(/\S/),M=e.from+p.indexOf(c),B=M+c.length;if(uo(e.from,e.to,t.doc).filter(K=>K.mark.type.excluded.find(Mt=>Mt===n.type&&Mt!==K.mark.type)).filter(K=>K.to>M).length)return null;B<e.to&&r.delete(B,e.to),M>e.from&&r.delete(e.from+C,M),h=e.from+C+c.length,r.addMark(e.from+C,h,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function To(n){return new Nt({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const c=e.to;if(o[1]){const p=o[0].lastIndexOf(o[1]);i+=o[0].slice(p+o[1].length),r+=p;const h=r-c;h>0&&(i=o[0].slice(p-h,p)+i,r=c)}t.tr.insertText(i,r,c)}})}class wo{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((i,r)=>{const c=r.getMap().mapResult(i);return c.deleted&&(e=!0),c.pos},t),deleted:e}}}function vo(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}},74634:(St,dt,u)=>{u.r(dt),u.d(dt,{TextStyle:()=>s,default:()=>s});var g=u(40256);const s=g.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:L=>!!L.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:L}){return["span",(0,g.mergeAttributes)(this.options.HTMLAttributes,L),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:L,commands:y})=>{const f=(0,g.getMarkAttributes)(L,this.type);return!!Object.entries(f).some(([,b])=>!!b)||y.unsetMark(this.name)}}}})},97019:(St,dt,u)=>{u.d(dt,{h:()=>Tt});var g=u(64762),s=u(74788),L=u(36692),y=u(50170),f=u(1414),q=u(10200),b=u(33250),nt=u(68874),j=u(23738),at=u(52219),et=u(12057),mt=u(65009),it=u(10383),st=u(20933),Et=u(35065),_t=u(63060),ut=u(62733),$=u(48214),W=u(11189),Q=u(91030);function N(ft,xt){if(1&ft&&(s.TgZ(0,"button",6),s._uU(1),s.qZA()),2&ft){const Dt=xt.$implicit;s.Q6J("value",Dt),s.xp6(1),s.hij(" ",Dt," ")}}function pt(ft,xt){if(1&ft&&(s.TgZ(0,"tui-data-list"),s.YNc(1,N,2,2,"button",5),s.qZA()),2&ft){const Dt=s.oxw();s.xp6(1),s.Q6J("ngForOf",Dt.modes)}}function ht(ft,xt){if(1&ft){const Dt=s.EpF();s.TgZ(0,"tui-primitive-textfield",7),s.NdJ("valueChange",function(ot){return s.CHM(Dt),s.oxw().onHexChange(ot)}),s._UZ(1,"input",8),s.qZA()}if(2&ft){const Dt=s.oxw();s.Q6J("textMask",Dt.hexMask)("tuiTextfieldLabelOutside",!0)("value",Dt.hex)}}function gt(ft,xt){if(1&ft){const Dt=s.EpF();s.TgZ(0,"tui-input-count",9),s.NdJ("ngModelChange",function(ot){s.CHM(Dt);const x=s.oxw();return x.onRgbChange(ot,x.color[1],x.color[2],x.color[3])}),s.qZA(),s.TgZ(1,"tui-input-count",9),s.NdJ("ngModelChange",function(ot){s.CHM(Dt);const x=s.oxw();return x.onRgbChange(x.color[0],ot,x.color[2],x.color[3])}),s.qZA(),s.TgZ(2,"tui-input-count",9),s.NdJ("ngModelChange",function(ot){s.CHM(Dt);const x=s.oxw();return x.onRgbChange(x.color[0],x.color[1],ot,x.color[3])}),s.qZA()}if(2&ft){const Dt=s.oxw();s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Dt.color[0]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Dt.color[1]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Dt.color[2])}}class Tt{constructor(){this.color=[0,0,0,1],this.colorChange=new s.vpe,this.hexMask={mask:({length:xt})=>Array.from({length:xt},()=>/\d|[a-f]|[A-F]/),guide:!1},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return(0,L.tuiRgbToHex)(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(xt){if(6!==xt.length)return;const Dt=(0,L.tuiHexToRgb)(xt);this.updateColor([Dt[0],Dt[1],Dt[2],this.color[3]])}onRgbChange(...xt){this.updateColor(xt)}updateColor(xt){this.color=xt,this.colorChange.emit(xt)}}Tt.\u0275fac=function(xt){return new(xt||Tt)},Tt.\u0275cmp=s.Xpm({type:Tt,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:6,vars:8,consts:[["tuiTextfieldSize","m","tuiDropdownAlign","left","tuiDropdownLimitWidth","min",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],[4,"tuiDataList"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["postfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"],["size","xs","tuiOption","",3,"value",4,"ngFor","ngForOf"],["size","xs","tuiOption","",3,"value"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange"],["tuiTextfield","","maxlength","6"],["tuiTextfieldSize","m",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"]],template:function(xt,Dt){if(1&xt&&(s.TgZ(0,"tui-select",0),s.NdJ("ngModelChange",function(ot){return Dt.mode=ot}),s.YNc(1,pt,2,1,"tui-data-list",1),s.qZA(),s.YNc(2,ht,2,3,"tui-primitive-textfield",2),s.YNc(3,gt,3,12,"ng-template",null,3,s.W1O),s.TgZ(5,"tui-input-count",4),s.NdJ("ngModelChange",function(ot){return Dt.onRgbChange(Dt.color[0],Dt.color[1],Dt.color[2],ot/100)}),s.qZA()),2&xt){const Ut=s.MAs(4);s.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",Dt.mode),s.xp6(2),s.Q6J("ngIf",Dt.isHex)("ngIfElse",Ut),s.xp6(3),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",100)("ngModel",Dt.opacity)}},directives:[y.u,f.O,q.s,b.Ek,nt.x,j.JJ,j.On,at.g,et.O5,mt.E,it.a,st.q,et.sg,Et.v,_t.y,ut.B,$.n,W.h,Q.M],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:4.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}"],changeDetection:0}),(0,g.gn)([(0,L.tuiDefaultProp)()],Tt.prototype,"color",void 0)},49289:(St,dt,u)=>{u.d(dt,{$:()=>b});var g=u(64762),s=u(74788),L=u(91211),y=u(36692),f=u(71424),q=u(65720);class b{constructor(j){this.sanitizer=j,this.colorChange=new s.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color(j){if(this.currentColor.every((it,st)=>it===j[st])&&j[3]===this.opacity)return;const[at,et,mt]=(0,y.tuiRgbToHsv)(j[0],j[1],j[2]);this.opacity=j[3],this.hue=at/360,this.point=[et,1-mt/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${(0,y.tuiHsvToRgb)(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange(j){this.point=j,this.updateColor()}onHueChange(j){this.hue=j,this.updateColor()}onOpacityChange(j){this.opacity=(0,y.tuiRound)(j,2),this.updateColor()}getCurrentColor(j,at){return(0,y.tuiHsvToRgb)(360*j,at[0],255*(1-at[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}b.\u0275fac=function(j){return new(j||b)(s.Y36(L.H7))},b.\u0275cmp=s.Xpm({type:b,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function(j,at){1&j&&(s.TgZ(0,"tui-flat-picker",0),s.NdJ("valueChange",function(mt){return at.onPointChange(mt)}),s.qZA(),s.TgZ(1,"div",1),s.TgZ(2,"tui-linear-picker",2),s.NdJ("valueChange",function(mt){return at.onHueChange(mt)}),s.qZA(),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"tui-linear-picker",4),s.NdJ("valueChange",function(mt){return at.onOpacityChange(mt)}),s.qZA(),s.qZA()),2&j&&(s.Udp("background-color",at.base),s.Q6J("value",at.point),s.xp6(2),s.Q6J("value",at.hue),s.xp6(1),s.Udp("background",at.gradient),s.xp6(1),s.Q6J("value",at.opacity))},directives:[f.J,q.P],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(rgba(0,0,0,0),#000000),linear-gradient(to right,#ffffff,rgba(255,255,255,0));margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:#ff0000}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],b.prototype,"color",null),(0,g.gn)([y.tuiPure],b.prototype,"getCurrentColor",null)},23999:(St,dt,u)=>{u.d(dt,{s:()=>ct});var g=u(64762),s=u(74788),L=u(91211),y=u(62842),f=u(37631),q=u(36692),b=u(62939),nt=u(76189),j=u(12057),at=u(49289),et=u(34880),mt=u(20933),it=u(35065),st=u(49472),Et=u(67446),_t=u(29070),ut=u(54255),$=u(15491),W=u(219),Q=u(97019),N=u(39607),pt=u(5451);function ht(R,V){if(1&R&&s._UZ(0,"tui-svg",9),2&R){s.oxw();const tt=s.MAs(1);s.ekj("t-arrow_rotated",tt.open)}}function gt(R,V){1&R&&s._UZ(0,"tui-svg",14)}function Tt(R,V){if(1&R){const tt=s.EpF();s.TgZ(0,"button",12),s.NdJ("keydown.enter.prevent",function(){const Ft=s.CHM(tt).$implicit,$t=s.oxw(2),Jt=s.MAs(1);return $t.onModeSelect(Ft,Jt)})("keydown.space.prevent",function(){const Ft=s.CHM(tt).$implicit,$t=s.oxw(2),Jt=s.MAs(1);return $t.onModeSelect(Ft,Jt)})("click",function(){const Ft=s.CHM(tt).$implicit,$t=s.oxw(2),Jt=s.MAs(1);return $t.onModeSelect(Ft,Jt)}),s._uU(1),s.YNc(2,gt,1,0,"tui-svg",13),s.qZA()}if(2&R){const tt=V.$implicit,Ot=s.oxw(2);s.uIk("aria-checked",Ot.isModeActive(tt)),s.xp6(1),s.hij(" ",tt," "),s.xp6(1),s.Q6J("ngIf",Ot.isModeActive(tt))}}function ft(R,V){if(1&R&&(s.TgZ(0,"tui-data-list",10),s.YNc(1,Tt,3,3,"button",11),s.qZA()),2&R){const tt=s.oxw();s.xp6(1),s.Q6J("ngForOf",tt.modes)}}function xt(R,V){if(1&R){const tt=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const Ft=s.CHM(tt).$implicit;return s.oxw(2).onDirectionChange(Ft)}),s.qZA()}if(2&R){const tt=V.$implicit,Ot=s.oxw(2);s.ekj("t-direction_active",Ot.isDirectionActive(tt)),s.Q6J("icon",Ot.getIcon(tt))("tuiHint",tt)("tuiHintDescribe","")}}function Dt(R,V){if(1&R){const tt=s.EpF();s.ynx(0),s._UZ(1,"hr",15),s.TgZ(2,"div",16),s.TgZ(3,"tui-linear-multi-picker",17),s.NdJ("valueChange",function(It){return s.CHM(tt),s.oxw().onStopsChange(It)})("indexChange",function(It){return s.CHM(tt),s.oxw().onIndexChange(It)}),s.qZA(),s.qZA(),s.TgZ(4,"div",18),s.YNc(5,xt,1,5,"button",19),s.qZA(),s.BQk()}if(2&R){const tt=s.oxw();s.xp6(2),s.Udp("background",tt.gradient),s.xp6(1),s.Q6J("value",tt.stopsKeys),s.xp6(2),s.Q6J("ngForOf",tt.buttons)}}function Ut(R,V){if(1&R){const tt=s.EpF();s.TgZ(0,"tui-color-edit",21),s.NdJ("colorChange",function(It){return s.CHM(tt),s.oxw().onColorChange(It)}),s.qZA()}if(2&R){const tt=s.oxw();s.Q6J("color",tt.color)}}function ot(R,V){if(1&R){const tt=s.EpF();s.TgZ(0,"tui-palette",22),s.NdJ("selectedColor",function(It){return s.CHM(tt),s.oxw().onPalettePick(It)}),s.qZA()}if(2&R){const tt=s.oxw();s.Q6J("colors",tt.palette)}}const x=[0,0,0,0],Z=[[0,[0,0,0,1]],[1,[255,255,255,1]]],Y={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};class ct{constructor(V,tt){this.sanitizer=V,this.modes=tt,this.stops=new Map(Z),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new s.vpe,this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(V){this.parse(V)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(V){return Y[V]}isModeActive(V){return this.currentMode===V}isDirectionActive(V){return this.direction===V}onPalettePick(V){this.updateColor(V)}onDirectionChange(V){this.direction=V,this.updateColor(this.getGradient(V))}onModeSelect(V,tt){this.currentMode=V,tt.open=!1,this.updateColor(V===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(V){this.currentStop=this.stopsKeys[V]}onColorChange(V){this.isGradient?(this.stops.set(this.currentStop,V),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${V.join(", ")})`)}onStopsChange(V){const tt=this.stopsKeys.find(It=>!V.includes(It)),Ot=V.find(It=>!this.stopsKeys.includes(It));void 0===tt&&void 0!==Ot&&this.addStop(Ot),void 0!==tt&&void 0===Ot&&this.removeStop(tt),void 0!==tt&&void 0!==Ot&&this.replaceStop(tt,Ot),this.updateColor(this.getGradient(this.direction))}getStopsKeys(V){return Array.from(V.keys())}filterPalette(V,tt){const Ot=new Map(V);return Ot.forEach((It,Ft)=>{(It.startsWith("linear-gradient")&&!tt||!It.startsWith("linear-gradient")&&tt)&&Ot.delete(Ft)}),Ot}updateColor(V){this.colorChange.emit(V)}getGradient(V){return`linear-gradient(${V}, ${[...this.stopsKeys].sort().map(tt=>`rgba(${this.getStop(tt).join(", ")}) ${100*tt}%`).join(", ")})`}getStop(V){return this.stops.get(V)||x}addStop(V){const tt=this.stopsKeys.reduce((Ot,It)=>Math.abs(It-V)<Math.abs(Ot-V)?It:Ot,this.stopsKeys[0]);this.stops.set(V,this.getStop(tt)),this.stops=new Map(this.stops),this.currentStop=V}removeStop(V){this.stops.delete(V),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(V,tt){const Ot=this.getStop(V);this.currentStop=tt,this.stops=new Map(this.stopsKeys.map(It=>It===V?[tt,Ot]:[It,this.getStop(It)]))}parse(V){V.startsWith("linear-gradient")?this.parseGradient(V):this.parseColor(V)}parseGradient(V){if(V===this.getGradient(this.direction))return;const tt=(0,f._N)((0,f.U5)(V));this.currentMode=this.modes[1],this.direction=tt.side,this.currentStop=0,this.stops=new Map(tt.stops.length?tt.stops.map(({color:Ot,position:It})=>[parseFloat(It)/100,(0,q.tuiParseColor)(Ot)]):Z)}parseColor(V){this.currentMode=this.modes[0],this.currentStop=0,this.color=(0,q.tuiParseColor)(V)}}ct.\u0275fac=function(V){return new(V||ct)(s.Y36(L.H7),s.Y36(y.dj))},ct.\u0275cmp=s.Xpm({type:ct,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["tuiButton","","appearance","","size","s","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],["src","tuiIconChevronDown",1,"t-arrow"],["role","menu",1,"t-menu"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click",4,"ngFor","ngForOf"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click"],["src","tuiIconCheck","class","t-checkmark",4,"ngIf"],["src","tuiIconCheck",1,"t-checkmark"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","valueChange","indexChange"],[1,"t-buttons"],["tuiIconButton","","type","button","size","xs","appearance","","class","t-direction",3,"t-direction_active","icon","tuiHint","tuiHintDescribe","click",4,"ngFor","ngForOf"],["tuiIconButton","","type","button","size","xs","appearance","",1,"t-direction",3,"icon","tuiHint","tuiHintDescribe","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(V,tt){if(1&V&&(s.TgZ(0,"tui-hosted-dropdown",0,1),s.TgZ(2,"button",2),s._uU(3),s.qZA(),s.YNc(4,ht,1,2,"ng-template",null,3,s.W1O),s.YNc(6,ft,2,1,"ng-template",null,4,s.W1O),s.qZA(),s.YNc(8,Dt,6,4,"ng-container",5),s.TgZ(9,"tui-color-picker",6),s.NdJ("colorChange",function(It){return tt.onColorChange(It)}),s.qZA(),s.YNc(10,Ut,1,1,"tui-color-edit",7),s.YNc(11,ot,1,1,"tui-palette",8)),2&V){const Ot=s.MAs(5),It=s.MAs(7);s.Q6J("content",It),s.xp6(2),s.Q6J("iconRight",Ot),s.xp6(1),s.hij(" ",tt.currentMode," "),s.xp6(5),s.Q6J("ngIf",tt.isGradient),s.xp6(1),s.Q6J("color",tt.currentColor),s.xp6(1),s.Q6J("ngIf",!tt.isGradient),s.xp6(1),s.Q6J("ngIf",tt.palette.size)}},directives:[b.o,nt.v,j.O5,at.$,et.P,mt.q,j.sg,it.v,st.e,Et.D,_t.x,ut.t,$.D,W.$,Q.h,N.g,pt.R],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:21.25rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,g.gn)([(0,q.tuiDefaultProp)()],ct.prototype,"colors",void 0),(0,g.gn)([(0,q.tuiRequiredSetter)()],ct.prototype,"colorSetter",null),(0,g.gn)([q.tuiPure],ct.prototype,"getStopsKeys",null),(0,g.gn)([q.tuiPure],ct.prototype,"filterPalette",null)},71424:(St,dt,u)=>{u.d(dt,{J:()=>f});var g=u(64762),s=u(74788),L=u(62141),y=u(36692);class f{constructor(b){this.value=[0,0],this.valueChange=new s.vpe,b.subscribe(nt=>{this.value=nt,this.valueChange.emit([nt[0],nt[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}f.\u0275fac=function(b){return new(b||f)(s.Y36(L.i))},f.\u0275cmp=s.Xpm({type:f,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([y.TuiDestroyService,L.i])],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(b,nt){1&b&&s._UZ(0,"div",0),2&b&&s.Udp("left",nt.left,"%")("top",nt.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],f.prototype,"value",void 0)},27050:(St,dt,u)=>{u.d(dt,{hR:()=>g.h,TD:()=>b,$v:()=>nt.$,H9:()=>et,sV:()=>mt.s,wl:()=>_t,Jd:()=>ut.J,ui:()=>j,es:()=>$.e,GU:()=>st,P:()=>W.P,g7:()=>at,Rh:()=>Q.R,VM:()=>Et});var g=u(97019),s=u(12057),L=u(23738),y=u(72002),f=u(31748),q=u(74788);let b=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez,L.u5,f.TextMaskModule,f.TuiValueAccessorModule,f.TuiSelectModule,y.TuiPrimitiveTextfieldModule,y.TuiTextfieldControllerModule,y.TuiDropdownModule,f.TuiInputCountModule,y.TuiDataListModule]]}),N})();var nt=u(49289);let j=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez]]}),N})(),at=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez]]}),N})(),et=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez,j,at]]}),N})();var mt=u(23999),it=u(36692);let st=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez]]}),N})(),Et=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez,y.TuiHintModule]]}),N})(),_t=(()=>{class N{}return N.\u0275fac=function(ht){return new(ht||N)},N.\u0275mod=q.oAB({type:N}),N.\u0275inj=q.cJS({imports:[[s.ez,y.TuiButtonModule,y.TuiHostedDropdownModule,et,st,y.TuiHintModule,y.TuiSvgModule,y.TuiDataListModule,it.TuiActiveZoneModule,b,y.TuiGroupModule,Et]]}),N})();var ut=u(71424),$=u(49472),W=u(65720),Q=u(5451)},49472:(St,dt,u)=>{u.d(dt,{e:()=>b});var g=u(64762),s=u(74788),L=u(62141),y=u(36692),f=u(12057);function q(nt,j){if(1&nt){const at=s.EpF();s.TgZ(0,"div",1),s.NdJ("mousedown",function(){const it=s.CHM(at).index;return s.oxw().onMouseDown(it)})("dblclick",function(){const it=s.CHM(at).index;return s.oxw().onClick(it)}),s.qZA()}2&nt&&s.Udp("left",100*j.$implicit,"%")}class b{constructor(j){this.value=[0,1],this.valueChange=new s.vpe,this.indexChange=new s.vpe,this.index=NaN,j.subscribe(([at])=>{this.onPicker(at)})}onMouseUp(){this.index=NaN}onMouseDown(j){this.updateIndex(j)}onClick(j){this.value.length>2&&this.updateValue(this.value.filter((at,et)=>et!==j))}onPicker(j){isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((at,et)=>at===j&&et!==this.index)&&this.updateValue(this.value.map((at,et)=>et===this.index?j:at))}updateIndex(j){this.index=j,this.indexChange.emit(j)}updateValue(j){this.value=j,this.valueChange.emit(j)}}b.\u0275fac=function(j){return new(j||b)(s.Y36(L.i))},b.\u0275cmp=s.Xpm({type:b,selectors:[["tui-linear-multi-picker"]],hostBindings:function(j,at){1&j&&s.NdJ("mouseup",function(){return at.onMouseUp()},!1,s.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},features:[s._Bn([y.TuiDestroyService,L.i])],decls:1,vars:1,consts:[["class","t-circle",3,"left","mousedown","dblclick",4,"ngFor","ngForOf"],[1,"t-circle",3,"mousedown","dblclick"]],template:function(j,at){1&j&&s.YNc(0,q,1,2,"div",0),2&j&&s.Q6J("ngForOf",at.value)},directives:[f.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],b.prototype,"value",void 0)},65720:(St,dt,u)=>{u.d(dt,{P:()=>f});var g=u(64762),s=u(74788),L=u(62141),y=u(36692);class f{constructor(b){this.value=0,this.valueChange=new s.vpe,b.subscribe(([nt])=>{this.value=nt,this.valueChange.emit(nt)})}get left(){return 100*this.value}}f.\u0275fac=function(b){return new(b||f)(s.Y36(L.i))},f.\u0275cmp=s.Xpm({type:f,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([y.TuiDestroyService,L.i])],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(b,nt){1&b&&s._UZ(0,"div",0),2&b&&s.Udp("left",nt.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],f.prototype,"value",void 0)},5451:(St,dt,u)=>{u.d(dt,{R:()=>et});var g=u(64762),s=u(74788),L=u(36692),y=u(12057),f=u(67446),q=u(29070),b=u(54255),nt=u(15491),j=u(219);function at(mt,it){if(1&mt){const st=s.EpF();s.TgZ(0,"button",1),s.NdJ("click",function(){const ut=s.CHM(st).$implicit;return s.oxw().selectedColor.emit(ut.value)}),s.qZA()}if(2&mt){const st=it.$implicit;s.Udp("background",st.value),s.Q6J("tuiHint",st.key)("tuiHintDescribe",st.key)("id",st.key)}}class et{constructor(){this.colors=new Map,this.selectedColor=new s.vpe}}et.\u0275fac=function(it){return new(it||et)},et.\u0275cmp=s.Xpm({type:et,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:3,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintDescribe","id","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintDescribe","id","click"]],template:function(it,st){1&it&&(s.YNc(0,at,1,5,"button",0),s.ALo(1,"keyvalue")),2&it&&s.Q6J("ngForOf",s.lcZ(1,1,st.colors))},directives:[y.sg,f.D,q.x,b.t,nt.D,j.$],pipes:[y.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),(0,g.gn)([(0,L.tuiDefaultProp)()],et.prototype,"colors",void 0)},45050:(St,dt,u)=>{u.d(dt,{l:()=>Et});var g=u(12057),s=u(74788),L=u(36692),y=u(87623),f=u(20986),q=u(23738),b=u(34880),nt=u(76189),j=u(66596);function at(_t,ut){if(1&_t){const $=s.EpF();s.ynx(0),s.TgZ(1,"label",2),s._uU(2," URL "),s.TgZ(3,"span",3),s._uU(4),s.TgZ(5,"tui-input-inline",4),s.NdJ("ngModelChange",function(Q){return s.CHM($),s.oxw().onChange(Q)})("keydown.prevent.enter",function(){return s.CHM($),s.oxw().onSave()})("keydown.backspace",function(){return s.CHM($),s.oxw().onBackspace()}),s._uU(6," example.com "),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"tui-svg",5),s.NdJ("click",function(){return s.CHM($),s.oxw().onClear()}),s.qZA(),s.TgZ(8,"button",6),s.NdJ("click",function(){return s.CHM($),s.oxw().onSave()}),s.qZA(),s.BQk()}if(2&_t){const $=s.oxw();s.xp6(4),s.hij(" ",$.prefix," "),s.xp6(1),s.ekj("t-input_filled",$.hasUrl),s.Q6J("ngModel",$.url),s.xp6(2),s.ekj("t-cleaner_hidden",!$.hasUrl)}}function et(_t,ut){if(1&_t){const $=s.EpF();s.TgZ(0,"a",7),s._uU(1),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM($),s.oxw().onEdit()}),s.qZA(),s.TgZ(3,"button",9),s.NdJ("click",function(){return s.CHM($),s.oxw().onRemove()}),s.qZA()}if(2&_t){const $=s.oxw();s.Q6J("href",$.href,s.LSH),s.xp6(1),s.hij(" ",$.shortUrl," ")}}let Et=(()=>{class _t{constructor($){this.documentRef=$,this.addLink=new s.vpe,this.removeLink=new s.vpe,this.url=this.makeUrl(),this.edit=!this.url,this.prefix="http://"}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get shortUrl(){return this.url.length<60?this.url:`${this.url.slice(0,Math.max(0,40))}...${this.url.slice(this.url.length-10)}`}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.makeUrl())}onMouseDown($){(0,L.tuiIsElement)($.target)&&!$.target.matches("a, button, input")&&$.preventDefault()}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix="http://")}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange($){this.url=this.removePrefix($)}onClear(){this.url=""}makeUrl(){const $=this.documentRef.getSelection();return $?this.getHref($):""}getHref({focusNode:$}){if(!(null==$?void 0:$.parentElement))return"";const W=$.parentElement.closest("a");return W?this.removePrefix(W.getAttribute("href")||""):this.url}removePrefix($){return $.startsWith("http://")?(this.prefix="http://",$.replace("http://","")):$.startsWith("https://")?(this.prefix="https://",$.replace("https://","")):$}}return _t.\u0275fac=function($){return new($||_t)(s.Y36(g.K0))},_t.\u0275cmp=s.Xpm({type:_t,selectors:[["tui-edit-link"]],hostBindings:function($,W){1&$&&s.NdJ("selectionchange",function(){return W.onSelectionChange()},!1,s.evT)("mousedown",function(N){return W.onMouseDown(N)})},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["view",""],[1,"t-label"],[1,"t-url"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","keydown.prevent.enter","keydown.backspace"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiLink","","target","_blank",1,"t-link",3,"href"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEditLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconTrashLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"]],template:function($,W){if(1&$&&(s.YNc(0,at,9,6,"ng-container",0),s.YNc(1,et,4,2,"ng-template",null,1,s.W1O)),2&$){const Q=s.MAs(2);s.Q6J("ngIf",W.edit)("ngIfElse",Q)}},directives:[g.O5,y.l,f.k,q.JJ,q.On,b.P,nt.v,j.V],styles:["[_nghost-%COMP%]{display:flex;height:var(--tui-height-l);align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02)}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),_t})()},71115:(St,dt,u)=>{u.d(dt,{l:()=>g.l,F:()=>nt});var g=u(45050),s=u(12057),L=u(23738),y=u(36692),f=u(72002),q=u(31748),b=u(74788);let nt=(()=>{class j{}return j.\u0275fac=function(et){return new(et||j)},j.\u0275mod=b.oAB({type:j}),j.\u0275inj=b.cJS({imports:[[s.ez,L.u5,y.TuiAutoFocusModule,f.TuiButtonModule,f.TuiSvgModule,f.TuiLinkModule,q.TuiInputInlineModule]]}),j})()},20179:(St,dt,u)=>{u.d(dt,{D:()=>L});var g=u(74788),s=u(72002);let L=(()=>{class y{constructor(q,b,nt,j){this.elementRef=q,this.renderer=b,this.sanitizer=nt,this.tuiSanitizer=j}set content(q){this.renderer.setProperty(this.elementRef.nativeElement,"innerHTML",this.tuiSanitizer?this.tuiSanitizer.sanitize(g.q3G.HTML,q.replace(/colwidth/g,"width")):this.sanitizer.sanitize(g.q3G.HTML,q))}}return y.\u0275fac=function(q){return new(q||y)(g.Y36(g.SBq),g.Y36(g.Qsj),g.Y36(g.Tiy),g.Y36(s.TUI_SANITIZER,8))},y.\u0275cmp=g.Xpm({type:y,selectors:[["tui-editor-socket"]],hostAttrs:[1,"tui-editor-socket"],inputs:{content:"content"},decls:0,vars:0,template:function(q,b){},styles:['.tui-editor-socket{display:block;margin:0;overflow:hidden;color:var(--tui-text-01);font:var(--tui-font-text-m)}.tui-editor-socket._preview-image img{cursor:pointer}.tui-editor-socket h1,.tui-editor-socket h2,.tui-editor-socket h3,.tui-editor-socket h4,.tui-editor-socket h5,.tui-editor-socket h6{word-break:break-word;line-height:normal}.tui-editor-socket .ProseMirror{min-height:5.375rem;padding:0 1rem;outline:none;white-space:pre-wrap}.tui-editor-socket p:empty:after{content:" ";white-space:pre}.tui-editor-socket p:first-child{margin-top:0}.tui-editor-socket ul,.tui-editor-socket ol{list-style-type:none;margin:1rem 1rem 1rem 1.5rem;padding:0}.tui-editor-socket li{margin:1rem 0}.tui-editor-socket li p{display:inline-block;margin:0 auto}.tui-editor-socket ul>li:before{content:"";display:inline-block;width:.5rem;height:.5rem;border-radius:100%;margin:.5rem .875rem .0625rem -1.375rem;background-color:var(--tui-primary);vertical-align:top;box-sizing:border-box}.tui-editor-socket li ul>li:before{background:none;border:.125rem solid var(--tui-primary)}.tui-editor-socket li ul>li>ul>li:before{background:var(--tui-primary);border-radius:0;width:.375rem;height:.375rem}.tui-editor-socket ol{counter-reset:counter}.tui-editor-socket ol>li:before{content:counter(counter) ".";width:1.5rem;margin:0 .75rem 0 -1.5rem;counter-increment:counter;color:var(--tui-base-05);vertical-align:top}.tui-editor-socket pre{white-space:pre-wrap;word-break:break-word;border-radius:.25rem;margin:1rem 0;padding:.75rem 1rem;font-family:Courier,monospace;color:var(--tui-text-02);background:var(--tui-base-02)}.tui-editor-socket code{box-shadow:none}.tui-editor-socket pre+pre{margin-top:-1.8125rem;padding-top:0}.tui-editor-socket blockquote{margin:1.25rem 0 1.25rem 1.5rem;padding-left:1.0625rem;border-left:1px solid var(--tui-base-04)}.tui-editor-socket p{margin:1rem 0}.tui-editor-socket a{color:var(--tui-link);text-decoration:none;outline:none}.tui-editor-socket a:hover{color:var(--tui-link-hover);text-decoration:underline}.tui-editor-socket a:active{color:var(--tui-primary-active)}.tui-editor-socket hr{border:none;border-top:1px solid var(--tui-base-03);margin:1rem 0}.tui-editor-socket table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.tui-editor-socket table td{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word}.tui-editor-socket table th{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word;font-weight:bold;text-align:left;background-color:var(--tui-base-02);min-height:2rem}.tui-editor-socket table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tui-editor-socket table td>*{margin-top:0;margin-bottom:0}.tui-editor-socket table th>*{margin-top:0;margin-bottom:0}.tui-editor-socket .resize-cursor{cursor:ew-resize;cursor:col-resize}.tui-editor-socket table .tableWrapper{overflow-x:auto}.tui-editor-socket .selectedCell:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--tui-selection);pointer-events:none}.tui-editor-socket font[face="Courier New"]{display:inline-block;padding:.25rem .5rem;border-radius:.25rem;background-color:#ecf1f7;word-break:break-word}.tui-editor-socket details{width:100%;border:1px solid var(--tui-base-04);border-radius:var(--tui-radius-l)}.tui-editor-socket summary{display:flex;align-items:center;min-height:3.5rem;width:100%;padding:0 1.25rem;box-sizing:border-box;border-radius:var(--tui-radius-l);pointer-events:none}.tui-editor-socket summary p{min-width:1px;margin:0}.tui-editor-socket summary::-webkit-details-marker{display:none}.tui-editor-socket details[open] summary{border-radius:var(--tui-radius-l) var(--tui-radius-l) 0 0}.tui-editor-socket div[data-type=details-content]{padding:1.25rem;min-height:3rem;border:1px solid var(--tui-base-04);border-width:1px 0 0}.tui-editor-socket .details-wrapper{position:relative;display:flex}.tui-editor-socket .details-arrow{position:absolute;top:1.5rem;right:1.25rem;height:.575rem;width:.575rem;border:1px solid var(--tui-base-06);border-width:0 2px 2px 0;transform:rotate(45deg);transition:var(--tui-duration, .3s);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;padding:0;background:none;cursor:pointer}.tui-editor-socket .details-wrapper_rendered .details-arrow{pointer-events:none}.tui-editor-socket .details-wrapper_rendered summary{transition:transform var(--tui-duration, .3s);cursor:pointer;pointer-events:auto}.tui-editor-socket .details-wrapper_rendered summary:hover{background:var(--tui-base-02)}.tui-editor-socket details[open]+.details-arrow{top:1.75rem;transform:rotate(225deg)}.t-editor-placeholder:before{content:attr(data-placeholder);float:left;color:var(--tui-base-05);pointer-events:none;height:0}.tui-group-node{display:flex;flex-direction:row}.tui-group-node:hover>.tui-group-pointer{pointer-events:auto;opacity:1}.tui-group-pointer{opacity:0;min-height:.8125rem;max-height:.8125rem;min-width:.8125rem;max-width:.8125rem;margin:.3125rem .3125rem 0 0;cursor:-webkit-grab;cursor:grab;background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="black" /></svg>\');background-repeat:no-repeat;background-size:contain;background-position:center}[data-mode=onDark] .tui-group-pointer{background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="white" /></svg>\')}\n'],encapsulation:2,changeDetection:0}),y})()},69303:(St,dt,u)=>{u.d(dt,{a:()=>ct});var g=u(64762),s=u(12057),L=u(74788),y=u(23738),f=u(17406),q=u(19074),b=u(40632),nt=u(62842),j=u(37631),at=u(36692),et=u(79089),mt=u(40939),it=u(2697),st=u(17163),Et=u(3881),_t=u(1433),ut=u(9872),$=u(4997),W=u(33250),Q=u(26072),N=u(9829),pt=u(82886),ht=u(39088),gt=u(20179),Tt=u(74982),ft=u(45050);function xt(R,V){if(1&R&&(L.TgZ(0,"tui-toolbar",9),L.Hsn(1,1),L.qZA()),2&R){const tt=L.oxw(2);L.Q6J("tools",tt.tools)("disabled",!tt.interactive)}}function Dt(R,V){if(1&R&&(L.TgZ(0,"div",10),L._uU(1),L.qZA()),2&R){const tt=L.oxw(2);L.xp6(1),L.hij(" ",tt.exampleText," ")}}function Ut(R,V){if(1&R){const tt=L.EpF();L.TgZ(0,"div",11),L.TgZ(1,"tui-editor-socket",12),L.NdJ("valueChange",function(It){return L.CHM(tt),L.oxw(2).onModelChange(It)})("stateChange",function(){return 0}),L.qZA(),L.qZA()}if(2&R){L.oxw();const tt=L.MAs(9),Ot=L.oxw();L.Q6J("tuiDropdownSelection",Ot.dropdownSelectionHandler)("tuiDropdown",tt),L.xp6(1),L.Q6J("value",Ot.value)("editable",Ot.interactive)}}function ot(R,V){if(1&R){const tt=L.EpF();L.TgZ(0,"tui-edit-link",13),L.NdJ("addLink",function(It){return L.CHM(tt),L.oxw(2).addLink(It)})("removeLink",function(){return L.CHM(tt),L.oxw(2).removeLink()}),L.qZA()}}function x(R,V){if(1&R){const tt=L.EpF();L.TgZ(0,"div",1),L.NdJ("tuiActiveZoneChange",function(It){return L.CHM(tt),L.oxw().onActiveZone(It)}),L.TgZ(1,"div",2),L.YNc(2,xt,2,2,"tui-toolbar",3),L.TgZ(3,"div",4),L.Hsn(4),L.qZA(),L.YNc(5,Dt,2,1,"div",5),L.qZA(),L.TgZ(6,"tui-scrollbar",6),L.YNc(7,Ut,2,4,"div",7),L.YNc(8,ot,1,0,"ng-template",null,8,L.W1O),L._UZ(10,"tui-editor-portal-host"),L.qZA(),L.qZA()}if(2&R){const tt=V.tuiLet,Ot=L.oxw();L.Q6J("readOnly",Ot.readOnly)("disabled",Ot.disabled)("focus",Ot.computedFocused)("hover",Ot.pseudoHover)("invalid",Ot.computedInvalid),L.xp6(2),L.Q6J("ngIf",tt),L.xp6(1),L.ekj("t-placeholder_raised",Ot.placeholderRaised),L.xp6(2),L.Q6J("ngIf",Ot.hasExampleText),L.xp6(2),L.Q6J("ngIf",tt)}}const Z=["*",[["tools"]]];class ct extends at.AbstractTuiControl{constructor(V,tt,Ot,It,Ft,$t){super(V,tt),this.editorLoaded$=Ot,this.editorService=It,this.contentProcessor=Ft,this.documentRef=$t,this.exampleText="",this.tools=q.Db,this.focused=!1,this.isSelectionLink=Jt=>this.currentFocusedNodeIsAnchor(Jt)&&(0,j.nC)(Jt)}get nativeFocusableElement(){var V;return this.computedDisabled?null:(null===(V=this.element)||void 0===V?void 0:V.nativeElement)||null}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:at.ALWAYS_FALSE_HANDLER}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}writeValue(V){var tt;const Ot=this.contentProcessor(V||"");super.writeValue(Ot),Ot!==V&&(null===(tt=this.control)||void 0===tt||tt.setValue(Ot))}onActiveZone(V){this.focused=V,this.updateFocused(V)}onModelChange(V){this.updateValue(V)}addLink(V){var tt,Ot;null===(tt=this.editor)||void 0===tt||tt.selectClosest(),null===(Ot=this.editor)||void 0===Ot||Ot.setLink(V)}removeLink(){var V;null===(V=this.editor)||void 0===V||V.unsetLink()}ngOnDestroy(){var V;null===(V=this.editor)||void 0===V||V.destroy()}getFallbackValue(){return""}currentFocusedNodeIsAnchor(V){var tt,Ot,It;return!!(null===(Ot=null===(tt=V.startContainer.parentElement)||void 0===tt?void 0:tt.closest("a"))||void 0===Ot?void 0:Ot.contains((null===(It=this.documentRef.getSelection())||void 0===It?void 0:It.focusNode)||null))}get hasValue(){return!!this.value}}ct.\u0275fac=function(V){return new(V||ct)(L.Y36(y.a5,10),L.Y36(L.sBO),L.Y36(nt.ZW),L.Y36(b.$3),L.Y36(nt.F1),L.Y36(s.K0))},ct.\u0275cmp=L.Xpm({type:ct,selectors:[["tui-editor"]],viewQuery:function(V,tt){if(1&V&&(L.Gf(b.JU,5,L.SBq),L.Gf(f.M6,5)),2&V){let Ot;L.iGM(Ot=L.CRH())&&(tt.element=Ot.first),L.iGM(Ot=L.CRH())&&(tt.toolbar=Ot.first)}},inputs:{exampleText:"exampleText",tools:"tools"},features:[L._Bn([(0,at.tuiAsFocusableItemAccessor)(ct),et.m]),L.qOj],ngContentSelectors:["*","tools"],decls:2,vars:3,consts:[["tuiWrapper","","appearance","textfield","class","t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange",4,"tuiLet"],["tuiWrapper","","appearance","textfield",1,"t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],[3,"tools","disabled",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","",1,"t-scrollbar"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown",4,"ngIf"],["dropdown",""],[3,"tools","disabled"],[1,"t-example-text"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown"],["tuiTiptapEditor","","spellcheck","false",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange"],[3,"addLink","removeLink"]],template:function(V,tt){1&V&&(L.F$t(Z),L.YNc(0,x,11,10,"div",0),L.ALo(1,"async")),2&V&&L.Q6J("tuiLet",L.lcZ(1,1,tt.editorLoaded$))},directives:[mt.L,it.o,st.e,s.O5,Et.I,_t.A,ut.d,$.M,W.Ek,Q.t,N.V,pt.A,ht.y,gt.D,Tt.J,ft.l],pipes:[s.Ov],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m);border-radius:var(--tui-radius-m)}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:10rem;cursor:text;overflow:hidden;flex-direction:column;border-radius:inherit}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);position:absolute;left:1rem;margin-top:1rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem)}[data-size=m][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}[data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], [data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size=l][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font-size:.9375rem}[data-size=l][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[data-mode=onDark][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size=m][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens: none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-placeholder_raised[_ngcontent-%COMP%]{width:110%}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;max-height:inherit;border-top:1.625rem solid transparent;border-bottom:1px solid transparent;box-sizing:border-box}"],changeDetection:0}),(0,g.gn)([(0,at.tuiDefaultProp)()],ct.prototype,"exampleText",void 0),(0,g.gn)([(0,at.tuiDefaultProp)()],ct.prototype,"tools",void 0)},79089:(St,dt,u)=>{u.d(dt,{m:()=>at});var g=u(74788),s=u(40632),L=u(62842),y=u(82298),f=u(9112),q=u(15257),b=u(88002),nt=u(47349),j=u(73825);const at=[{provide:L.F4,deps:[L.Wf],useFactory:et=>{const mt=new y.t(1);return Promise.all(et).then(it=>mt.next(it)),mt}},{provide:L.Y1,deps:[g.Qsj],useFactory:et=>et.createElement("div")},{provide:L.ZW,deps:[L.Y1,L.F4,L.bG],useFactory:(et,mt,it)=>(0,f.aj)([it,mt]).pipe((0,q.q)(1),(0,b.U)(([st,Et])=>new st({element:et,extensions:Et})),(0,nt.d)({bufferSize:1,refCount:!0}))},s.$3,j.Y]},9872:(St,dt,u)=>{u.d(dt,{d:()=>L});var g=u(36692),s=u(74788);let L=(()=>{class y extends g.AbstractTuiPortalHostComponent{}return y.\u0275fac=function(){let f;return function(b){return(f||(f=s.n5z(y)))(b||y)}}(),y.\u0275cmp=s.Xpm({type:y,selectors:[["tui-editor-portal-host"]],features:[s._Bn([{provide:g.AbstractTuiPortalService,useExisting:g.TuiDropdownPortalService},{provide:g.AbstractTuiPortalHostComponent,useExisting:y}]),s.qOj],decls:2,vars:0,consts:[["viewContainer",""]],template:function(q,b){1&q&&s.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),y})()},1433:(St,dt,u)=>{u.d(dt,{A:()=>y});var g=u(36692),s=u(73825),L=u(74788);let y=(()=>{class f{}return f.\u0275fac=function(b){return new(b||f)},f.\u0275dir=L.lG2({type:f,selectors:[["","tuiEditorPortal",""]],features:[L._Bn([{provide:g.TuiDropdownPortalService,useExisting:s.Y}])]}),f})()},73825:(St,dt,u)=>{u.d(dt,{Y:()=>L});var g=u(36692),s=u(74788);let L=(()=>{class y extends g.AbstractTuiPortalService{}return y.\u0275fac=function(){let f;return function(b){return(f||(f=s.n5z(y)))(b||y)}}(),y.\u0275prov=s.Yz7({token:y,factory:y.\u0275fac}),y})()},19769:(St,dt,u)=>{u.d(dt,{j:()=>ut});var g=u(64762),s=u(74788),L=u(23738),y=u(91211),f=u(37631),q=u(36692),b=u(72002),nt=u(62939),j=u(63060),at=u(62733),et=u(3729),mt=u(23999),it=u(17163);function st($,W){if(1&$&&s._UZ(0,"div",4),2&$){const Q=s.oxw();s.Udp("background",Q.background)}}function Et($,W){if(1&$){const Q=s.EpF();s.TgZ(0,"tui-color-selector",5),s.NdJ("colorChange",function(pt){return s.CHM(Q),s.oxw().onValueChange(pt)}),s.qZA()}if(2&$){const Q=W.$implicit,N=s.oxw();s.Q6J("tuiActiveZoneParent",Q)("colors",N.colors)("color",N.value)}}class ut extends q.AbstractTuiControl{constructor(W,Q,N){super(W,Q),this.domSanitizer=N,this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onValueChange(W){this.updateValue(W)}onFocused(W){this.updateFocused(W)}getFallbackValue(){return"#000000"}sanitize(W,Q){return W.startsWith("linear-gradient(")?Q.bypassSecurityTrustStyle((0,f.CH)((0,f._N)((0,f.U5)(W)))):W}}ut.\u0275fac=function(W){return new(W||ut)(s.Y36(L.a5,10),s.Y36(s.sBO),s.Y36(y.H7))},ut.\u0275cmp=s.Xpm({type:ut,selectors:[["tui-input-color"]],viewQuery:function(W,Q){if(1&W&&(s.Gf(b.TuiPrimitiveTextfieldComponent,5),s.Gf(b.TuiHostedDropdownComponent,5)),2&W){let N;s.iGM(N=s.CRH())&&(Q.textfield=N.first),s.iGM(N=s.CRH())&&(Q.dropdown=N.first)}},hostBindings:function(W,Q){1&W&&s.NdJ("click",function(){return Q.onClick()})},inputs:{colors:"colors"},features:[s._Bn([],[(0,b.tuiDropdownOptionsProvider)({maxHeight:600})]),s.qOj],ngContentSelectors:["*"],decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"tuiTextfieldIconLeft","pseudoFocus","pseudoHover","pseudoActive","invalid","focusable","nativeId","disabled","readOnly","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"tuiActiveZoneParent","colors","color","colorChange"]],template:function(W,Q){if(1&W&&(s.F$t(),s.TgZ(0,"tui-hosted-dropdown",0),s.NdJ("openChange",function(pt){return Q.open=pt}),s.TgZ(1,"tui-primitive-textfield",1),s.NdJ("valueChange",function(pt){return Q.onValueChange(pt)})("focusedChange",function(pt){return Q.onFocused(pt)}),s.Hsn(2),s.qZA(),s.qZA(),s.YNc(3,st,1,2,"ng-template",null,2,s.W1O),s.YNc(5,Et,1,3,"ng-template",null,3,s.W1O)),2&W){const N=s.MAs(4),pt=s.MAs(6);s.Q6J("content",pt)("open",Q.open),s.xp6(1),s.Q6J("tuiTextfieldIconLeft",N)("pseudoFocus",Q.computedFocused)("pseudoHover",Q.pseudoHover)("pseudoActive",Q.pseudoActive)("invalid",Q.computedInvalid)("focusable",Q.focusable)("nativeId",Q.nativeId)("disabled",Q.disabled)("readOnly",Q.readOnly)("value",Q.value)}},directives:[nt.o,j.y,at.B,et.aR,mt.s,it.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem}"],changeDetection:0}),(0,g.gn)([(0,q.tuiDefaultProp)()],ut.prototype,"colors",void 0),(0,g.gn)([q.tuiPure],ut.prototype,"sanitize",null)},37924:(St,dt,u)=>{u.d(dt,{X:()=>$});var g=u(40632),s=u(62842),L=u(9112),y=u(88002),f=u(74788),q=u(12057),b=u(40939),nt=u(62939),j=u(76189),at=u(67446),et=u(29070),mt=u(54255),it=u(15491),st=u(219);function Et(W,Q){if(1&W){const N=f.EpF();f.TgZ(0,"div",6),f.TgZ(1,"button",7),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).editor.onAlign("left")}),f.qZA(),f.TgZ(2,"button",8),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).editor.onAlign("center")}),f.qZA(),f.TgZ(3,"button",9),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).editor.onAlign("right")}),f.qZA(),f.TgZ(4,"button",10),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).editor.onAlign("justify")}),f.qZA(),f.qZA()}if(2&W){const N=f.oxw().tuiLet,pt=f.oxw().ngIf;f.xp6(1),f.Q6J("pseudoActive",!(null==N||!N.left))("tuiHint",pt.justifyLeft),f.xp6(1),f.Q6J("pseudoActive",!(null==N||!N.center))("tuiHint",pt.justifyCenter),f.xp6(1),f.Q6J("pseudoActive",!(null==N||!N.right))("tuiHint",pt.justifyRight),f.xp6(1),f.Q6J("pseudoActive",!(null==N||!N.justify))("tuiHint",pt.justifyFull)}}function _t(W,Q){if(1&W&&(f.TgZ(0,"tui-hosted-dropdown",2,3),f._UZ(2,"button",4),f.YNc(3,Et,5,8,"ng-template",null,5,f.W1O),f.qZA()),2&W){const N=f.MAs(1),pt=f.MAs(4),ht=f.oxw().ngIf;f.Q6J("content",pt),f.xp6(2),f.Q6J("tuiHint",ht.justify)("tuiHintDescribe","")("pseudoActive",N.open)("focusable",N.open)}}function ut(W,Q){if(1&W&&(f.ynx(0),f.YNc(1,_t,5,5,"tui-hosted-dropdown",1),f.ALo(2,"async"),f.BQk()),2&W){const N=f.oxw();f.xp6(1),f.Q6J("tuiLet",f.lcZ(2,1,N.alignState$))}}let $=(()=>{class W{constructor(N,pt){this.editor=N,this.texts$=pt,this.alignState$=(0,L.aj)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,y.U)(([ht,gt,Tt,ft])=>({left:ht,right:gt,center:Tt,justify:ft})))}}return W.\u0275fac=function(N){return new(N||W)(f.Y36(g.$3),f.Y36(s.rf))},W.\u0275cmp=f.Xpm({type:W,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"]],template:function(N,pt){1&N&&(f.YNc(0,ut,3,3,"ng-container",0),f.ALo(1,"async")),2&N&&f.Q6J("ngIf",f.lcZ(1,1,pt.texts$))},directives:[q.O5,b.L,nt.o,j.v,at.D,et.x,mt.t,it.D,st.$],pipes:[q.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),W})()},15587:(St,dt,u)=>{u.d(dt,{T:()=>$});var g=u(40632),s=u(62842),L=u(88002),y=u(87519),f=u(74788),q=u(62939),b=u(76189),nt=u(67446),j=u(29070),at=u(54255),et=u(15491),mt=u(219),it=u(20933),st=u(12057),Et=u(35065);function _t(W,Q){if(1&W){const N=f.EpF();f.TgZ(0,"button",5),f.NdJ("click",function(){const gt=f.CHM(N).index;return f.oxw(2).onCode(!!gt)}),f._uU(1),f.qZA()}if(2&W){const N=Q.$implicit;f.xp6(1),f.hij(" ",N," ")}}function ut(W,Q){if(1&W&&(f.TgZ(0,"tui-data-list"),f.YNc(1,_t,2,1,"button",4),f.ALo(2,"async"),f.qZA()),2&W){const N=f.oxw();f.xp6(1),f.Q6J("ngForOf",f.lcZ(2,1,N.codeOptionsTexts$))}}let $=(()=>{class W{constructor(N,pt,ht){this.editor=N,this.texts$=pt,this.codeOptionsTexts$=ht,this.hintText$=this.texts$.pipe((0,L.U)(gt=>gt.code)),this.insideCode$=this.editor.stateChange$.pipe((0,L.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,y.x)())}onCode(N){N?this.editor.toggleCodeBlock():this.editor.toggleCode()}}return W.\u0275fac=function(N){return new(N||W)(f.Y36(g.$3),f.Y36(s.rf),f.Y36(s.Mr))},W.\u0275cmp=f.Xpm({type:W,selectors:[["tui-code"]],decls:7,vars:9,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(N,pt){if(1&N&&(f.TgZ(0,"tui-hosted-dropdown",0,1),f._UZ(2,"button",2),f.ALo(3,"async"),f.ALo(4,"async"),f.YNc(5,ut,3,3,"ng-template",null,3,f.W1O),f.qZA()),2&N){const ht=f.MAs(1),gt=f.MAs(6);f.Q6J("content",gt),f.xp6(2),f.Q6J("tuiHint",f.lcZ(3,5,pt.hintText$))("tuiHintDescribe","")("pseudoActive",ht.open||f.lcZ(4,7,pt.insideCode$))("focusable",ht.open)}},directives:[q.o,b.v,nt.D,j.x,at.t,et.D,mt.$,it.q,st.sg,Et.v],pipes:[st.Ov],encapsulation:2,changeDetection:0}),W})()},18832:(St,dt,u)=>{u.d(dt,{U:()=>st});var g=u(40632),s=u(62842),L=u(88002),y=u(87519),f=u(74788),q=u(12057),b=u(76189),nt=u(67446),j=u(29070),at=u(54255),et=u(15491),mt=u(219);function it(Et,_t){if(1&Et){const ut=f.EpF();f.TgZ(0,"button",1),f.NdJ("click",function(){return f.CHM(ut),f.oxw().removeDetails()}),f.ALo(1,"async"),f.qZA()}if(2&Et){const ut=_t.ngIf,$=f.oxw();f.Q6J("tuiHint",ut.removeDetails)("tuiHintDescribe","")("focusable",!1)("disabled",!!f.lcZ(1,4,$.disabled$))}}let st=(()=>{class Et{constructor(ut,$){this.editor=ut,this.texts$=$,this.disabled$=this.editor.stateChange$.pipe((0,L.U)(()=>!this.editor.isActive("details")),(0,y.x)())}removeDetails(){this.editor.removeDetails()}}return Et.\u0275fac=function(ut){return new(ut||Et)(f.Y36(g.$3),f.Y36(s.rf))},Et.\u0275cmp=f.Xpm({type:Et,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(ut,$){1&ut&&(f.YNc(0,it,2,6,"button",0),f.ALo(1,"async")),2&ut&&f.Q6J("ngIf",f.lcZ(1,1,$.texts$))},directives:[q.O5,b.v,nt.D,j.x,at.t,et.D,mt.$],pipes:[q.Ov],encapsulation:2,changeDetection:0}),Et})()},50237:(St,dt,u)=>{u.d(dt,{y:()=>mt});var g=u(40632),s=u(62842),L=u(74788),y=u(12057),f=u(76189),q=u(67446),b=u(29070),nt=u(54255),j=u(15491),at=u(219);function et(it,st){if(1&it){const Et=L.EpF();L.TgZ(0,"button",1),L.NdJ("click",function(){return L.CHM(Et),L.oxw().setDetails()}),L.qZA()}2&it&&L.Q6J("tuiHint",st.ngIf.setDetails)("tuiHintDescribe","")("focusable",!1)}let mt=(()=>{class it{constructor(Et,_t){this.editor=Et,this.texts$=_t}setDetails(){this.editor.setDetails()}}return it.\u0275fac=function(Et){return new(Et||it)(L.Y36(g.$3),L.Y36(s.rf))},it.\u0275cmp=L.Xpm({type:it,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click"]],template:function(Et,_t){1&Et&&(L.YNc(0,et,1,3,"button",0),L.ALo(1,"async")),2&Et&&L.Q6J("ngIf",L.lcZ(1,1,_t.texts$))},directives:[y.O5,f.v,q.D,b.x,nt.t,j.D,at.$],pipes:[y.Ov],encapsulation:2,changeDetection:0}),it})()},84985:(St,dt,u)=>{u.d(dt,{m:()=>$});var g=u(40632),s=u(62842),L=u(36692),y=u(88002),f=u(74788),q=u(62939),b=u(76189),nt=u(67446),j=u(29070),at=u(54255),et=u(15491),mt=u(219),it=u(20933),st=u(12057),Et=u(35065);function _t(W,Q){if(1&W){const N=f.EpF();f.TgZ(0,"button",5),f.NdJ("click",function(){const gt=f.CHM(N).$implicit;return f.oxw(2).onClick(gt)}),f.ALo(1,"lowercase"),f._uU(2),f.qZA()}if(2&W){const N=Q.$implicit;f.Udp("font-family",N.family)("font-size",N.px,"px")("font-weight",N.weight),f.uIk("automation-id","tui_font__"+f.lcZ(1,8,N.name||"")),f.xp6(2),f.hij(" ",N.name," ")}}function ut(W,Q){if(1&W&&(f.TgZ(0,"tui-data-list"),f.YNc(1,_t,3,10,"button",4),f.ALo(2,"async"),f.qZA()),2&W){const N=f.oxw();f.xp6(1),f.Q6J("ngForOf",f.lcZ(2,1,N.fontsOptions$))}}let $=(()=>{class W{constructor(N,pt,ht,gt){this.options=N,this.editor=pt,this.texts$=ht,this.fontOptionsTexts$=gt,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,y.U)(Tt=>this.options.fontOptions(Tt))),this.fontText$=this.texts$.pipe((0,y.U)(Tt=>Tt.font))}onClick({headingLevel:N,px:pt}){N?this.editor.setHeading(N):this.editor.setParagraph({fontSize:(0,L.tuiPx)(pt||0)})}}return W.\u0275fac=function(N){return new(N||W)(f.Y36(s.mJ),f.Y36(g.$3),f.Y36(s.rf),f.Y36(s.UN))},W.\u0275cmp=f.Xpm({type:W,selectors:[["tui-font-size"]],decls:6,vars:7,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(N,pt){if(1&N&&(f.TgZ(0,"tui-hosted-dropdown",0,1),f._UZ(2,"button",2),f.ALo(3,"async"),f.YNc(4,ut,3,3,"ng-template",null,3,f.W1O),f.qZA()),2&N){const ht=f.MAs(1),gt=f.MAs(5);f.Q6J("content",gt),f.xp6(2),f.Q6J("tuiHint",f.lcZ(3,5,pt.fontText$))("tuiHintDescribe","")("pseudoActive",ht.open)("focusable",ht.open)}},directives:[q.o,b.v,nt.D,j.x,at.t,et.D,mt.$,it.q,st.sg,Et.v],pipes:[st.Ov,st.i8],encapsulation:2,changeDetection:0}),W})()},62976:(St,dt,u)=>{u.d(dt,{h:()=>ht});var g=u(19074),s=u(40632),L=u(48699),y=u(62842),f=u(9112),q=u(88002),b=u(74788),nt=u(12057),j=u(62939),at=u(76189),et=u(67446),mt=u(29070),it=u(54255),st=u(15491),Et=u(219);function _t(gt,Tt){if(1&gt){const ft=b.EpF();b.TgZ(0,"button",11),b.NdJ("click",function(){return b.CHM(ft),b.oxw(4).editor.toggleBold()}),b.qZA()}if(2&gt){const ft=b.oxw(2).ngIf,xt=b.oxw().ngIf;b.Q6J("tuiHint",xt.bold)("pseudoActive",ft.bold)}}function ut(gt,Tt){if(1&gt){const ft=b.EpF();b.TgZ(0,"button",12),b.NdJ("click",function(){return b.CHM(ft),b.oxw(4).editor.toggleItalic()}),b.qZA()}if(2&gt){const ft=b.oxw(2).ngIf,xt=b.oxw().ngIf;b.Q6J("tuiHint",xt.italic)("pseudoActive",ft.italic)}}function $(gt,Tt){if(1&gt){const ft=b.EpF();b.TgZ(0,"button",13),b.NdJ("click",function(){return b.CHM(ft),b.oxw(4).editor.toggleUnderline()}),b.qZA()}if(2&gt){const ft=b.oxw(2).ngIf,xt=b.oxw().ngIf;b.Q6J("tuiHint",xt.underline)("pseudoActive",ft.underline)}}function W(gt,Tt){if(1&gt){const ft=b.EpF();b.TgZ(0,"button",14),b.NdJ("click",function(){return b.CHM(ft),b.oxw(4).editor.toggleStrike()}),b.qZA()}if(2&gt){const ft=b.oxw(2).ngIf,xt=b.oxw().ngIf;b.Q6J("tuiHint",xt.strikeThrough)("pseudoActive",ft.strike)}}function Q(gt,Tt){if(1&gt&&(b.TgZ(0,"div",6),b.YNc(1,_t,1,2,"button",7),b.YNc(2,ut,1,2,"button",8),b.YNc(3,$,1,2,"button",9),b.YNc(4,W,1,2,"button",10),b.qZA()),2&gt){const ft=b.oxw(3);b.xp6(1),b.Q6J("ngIf",ft.isEnabled(ft.TuiEditorTool.Bold)),b.xp6(1),b.Q6J("ngIf",ft.isEnabled(ft.TuiEditorTool.Italic)),b.xp6(1),b.Q6J("ngIf",ft.isEnabled(ft.TuiEditorTool.Underline)),b.xp6(1),b.Q6J("ngIf",ft.isEnabled(ft.TuiEditorTool.Strikethrough))}}function N(gt,Tt){if(1&gt&&(b.TgZ(0,"tui-hosted-dropdown",2,3),b._UZ(2,"button",4),b.YNc(3,Q,5,4,"ng-template",null,5,b.W1O),b.qZA()),2&gt){const ft=Tt.ngIf,xt=b.MAs(1),Dt=b.MAs(4),Ut=b.oxw().ngIf;b.Q6J("content",Dt),b.xp6(2),b.Q6J("tuiHint",Ut.fontStyle)("tuiHintDescribe","")("pseudoActive",xt.open||ft.bold||ft.italic||ft.underline||ft.strike)("focusable",xt.open)}}function pt(gt,Tt){if(1&gt&&(b.ynx(0),b.YNc(1,N,5,5,"tui-hosted-dropdown",1),b.ALo(2,"async"),b.BQk()),2&gt){const ft=b.oxw();b.xp6(1),b.Q6J("ngIf",b.lcZ(2,1,ft.fontStyleState$))}}let ht=(()=>{class gt{constructor(ft,xt){this.editor=ft,this.texts$=xt,this.toolsSet=new Set(g.Db),this.TuiEditorTool=L._,this.fontStyleState$=(0,f.aj)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,q.U)(([Dt,Ut,ot,x])=>({bold:Dt,italic:Ut,underline:ot,strike:x})))}set enabledTools(ft){this.toolsSet=new Set(ft)}isEnabled(ft){return this.toolsSet.has(ft)}}return gt.\u0275fac=function(ft){return new(ft||gt)(b.Y36(s.$3),b.Y36(y.rf))},gt.\u0275cmp=b.Xpm({type:gt,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"]],template:function(ft,xt){1&ft&&(b.YNc(0,pt,3,3,"ng-container",0),b.ALo(1,"async")),2&ft&&b.Q6J("ngIf",b.lcZ(1,1,xt.texts$))},directives:[nt.O5,j.o,at.v,et.D,mt.x,it.t,st.D,Et.$],pipes:[nt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),gt})()},19762:(St,dt,u)=>{u.d(dt,{d:()=>it});var g=u(40632),s=u(62842),L=u(88002),y=u(87519),f=u(74788),q=u(76189),b=u(67446),nt=u(29070),j=u(54255),at=u(15491),et=u(219),mt=u(12057);let it=(()=>{class st{constructor(_t,ut){this.editor=_t,this.texts$=ut,this.insertGroupText$=this.texts$.pipe((0,L.U)($=>$.insertGroup)),this.removeGroupText$=this.texts$.pipe((0,L.U)($=>$.removeGroup)),this.disabled$=this.editor.stateChange$.pipe((0,L.U)(()=>!this.editor.isActive("group")),(0,y.x)())}addGroup(){this.editor.setGroup()}removeGroup(){this.editor.removeGroup()}}return st.\u0275fac=function(_t){return new(_t||st)(f.Y36(g.$3),f.Y36(s.rf))},st.\u0275cmp=f.Xpm({type:st,selectors:[["tui-editor-group-tool"]],decls:5,vars:13,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconPlusLarge","appearance","icon",3,"focusable","tuiHint","tuiHintDescribe","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconRemoveLarge","appearance","icon",3,"focusable","disabled","tuiHint","tuiHintDescribe","click"]],template:function(_t,ut){1&_t&&(f.TgZ(0,"button",0),f.NdJ("click",function(){return ut.addGroup()}),f.ALo(1,"async"),f.qZA(),f.TgZ(2,"button",1),f.NdJ("click",function(){return ut.removeGroup()}),f.ALo(3,"async"),f.ALo(4,"async"),f.qZA()),2&_t&&(f.Q6J("focusable",!1)("tuiHint",f.lcZ(1,7,ut.insertGroupText$))("tuiHintDescribe",""),f.xp6(2),f.Q6J("focusable",!1)("disabled",!!f.lcZ(3,9,ut.disabled$))("tuiHint",f.lcZ(4,11,ut.removeGroupText$))("tuiHintDescribe",""))},directives:[q.v,b.D,nt.x,j.t,at.D,et.$],pipes:[mt.Ov],encapsulation:2,changeDetection:0}),st})()},7416:(St,dt,u)=>{u.d(dt,{U:()=>ht});var g=u(64762),s=u(40632),L=u(62842),y=u(36692),f=u(88002),q=u(87519),b=u(74788),nt=u(40939),j=u(62939),at=u(33250),et=u(76189),mt=u(67446),it=u(29070),st=u(54255),Et=u(15491),_t=u(219),ut=u(12057),$=u(5451),W=u(17163);function Q(gt,Tt){if(1&gt&&b._UZ(0,"div",6),2&gt){const ft=b.oxw().tuiLet;b.Udp("background",ft)}}function N(gt,Tt){if(1&gt){const ft=b.EpF();b.TgZ(0,"tui-palette",7),b.NdJ("selectedColor",function(Dt){return b.CHM(ft),b.oxw(2).editor.setBackgroundColor(Dt)}),b.qZA()}if(2&gt){const ft=Tt.$implicit,xt=b.oxw(2);b.Q6J("tuiActiveZoneParent",ft)("colors",xt.colors)}}function pt(gt,Tt){if(1&gt&&(b.TgZ(0,"tui-hosted-dropdown",1,2),b._UZ(2,"button",3),b.ALo(3,"async"),b.YNc(4,Q,1,2,"div",4),b.YNc(5,N,1,2,"ng-template",null,5,b.W1O),b.qZA()),2&gt){const ft=Tt.tuiLet,xt=b.MAs(1),Dt=b.MAs(6),Ut=b.oxw();b.Q6J("content",Dt)("tuiDropdownMaxHeight",999),b.xp6(2),b.Q6J("tuiHint",b.lcZ(3,7,Ut.backColorText$))("tuiHintDescribe","")("pseudoActive",xt.open)("focusable",xt.open),b.xp6(2),b.Q6J("ngIf",!Ut.isBlankColor(ft||""))}}class ht{constructor(Tt,ft,xt){this.editor=Tt,this.texts$=ft,this.defaultOptions=xt,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,f.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,q.x)()),this.backColorText$=this.texts$.pipe((0,f.U)(Dt=>Dt.backColor))}isBlankColor(Tt){return Tt===this.defaultOptions.blankColor}}ht.\u0275fac=function(Tt){return new(Tt||ht)(b.Y36(s.$3),b.Y36(L.rf),b.Y36(L.mJ))},ht.\u0275cmp=b.Xpm({type:ht,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(Tt,ft){1&Tt&&(b.YNc(0,pt,7,9,"tui-hosted-dropdown",0),b.ALo(1,"async")),2&Tt&&b.Q6J("tuiLet",b.lcZ(1,1,ft.backgroundColor$))},directives:[nt.L,j.o,at.Ek,et.v,mt.D,it.x,st.t,Et.D,_t.$,ut.O5,$.R,W.e],pipes:[ut.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],ht.prototype,"colors",void 0)},93252:(St,dt,u)=>{u.d(dt,{Xp:()=>g.X,pu:()=>q,Tf:()=>b.T,P_:()=>nt,yj:()=>j.y,y9:()=>at,Un:()=>et.U,dN:()=>_t.d,jP:()=>ut,mK:()=>mt.m,p7:()=>it,hr:()=>st.h,Zv:()=>Et,UT:()=>$.U,XC:()=>Q,w2:()=>N.w,Ur:()=>pt,pH:()=>ht.p,mp:()=>gt,iN:()=>x.i,lT:()=>Tt.l,iA:()=>Dt,YH:()=>Ut.Y,er:()=>ot,_I:()=>x._,__:()=>Z,M8:()=>ft.M,kU:()=>xt,G0:()=>Y.G,_t:()=>ct});var g=u(37924),s=u(12057),L=u(36692),y=u(72002),f=u(74788);let q=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiButtonModule,y.TuiHintModule,L.TuiLetModule]]}),R})();var b=u(15587);let nt=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiButtonModule,y.TuiHintModule,y.TuiDataListModule]]}),R})();var j=u(50237);let at=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiButtonModule,y.TuiHintModule]]}),R})();var et=u(18832),mt=u(84985);let it=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiButtonModule,y.TuiHintModule,y.TuiDataListModule]]}),R})();var st=u(62976);let Et=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiButtonModule,y.TuiHintModule]]}),R})();var _t=u(19762);let ut=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiButtonModule,y.TuiHintModule]]}),R})();var $=u(7416),W=u(27050);let Q=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiButtonModule,W.VM,y.TuiHintModule,y.TuiDropdownModule,L.TuiActiveZoneModule,L.TuiLetModule]]}),R})();var N=u(13441);let pt=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiButtonModule,y.TuiHintModule,L.TuiLetModule]]}),R})();var ht=u(95558);let gt=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,W.VM,y.TuiButtonModule,y.TuiHintModule,L.TuiActiveZoneModule,y.TuiDropdownModule,L.TuiLetModule]]}),R})();var Tt=u(28962),ft=u(74549);let xt=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,L.TuiRepeatTimesModule]]}),R})(),Dt=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiDropdownModule,y.TuiButtonModule,y.TuiHintModule,xt]]}),R})();var Ut=u(76965);let ot=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiButtonModule,y.TuiHintModule,L.TuiLetModule]]}),R})();var x=u(22063);let Z=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiHostedDropdownModule,y.TuiHintModule,y.TuiButtonModule,y.TuiDataListModule,L.TuiLetModule]]}),R})();var Y=u(10528);let ct=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({imports:[[s.ez,y.TuiButtonModule,y.TuiHostedDropdownModule,y.TuiDropdownModule,y.TuiHintModule,W.VM,L.TuiActiveZoneModule,L.TuiLetModule]]}),R})()},13441:(St,dt,u)=>{u.d(dt,{w:()=>$});var g=u(40632),s=u(62842),L=u(9112),y=u(88002),f=u(74788),q=u(12057),b=u(40939),nt=u(62939),j=u(76189),at=u(67446),et=u(29070),mt=u(54255),it=u(15491),st=u(219);function Et(W,Q){if(1&W){const N=f.EpF();f.TgZ(0,"div",6),f.TgZ(1,"button",7),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).editor.toggleUnorderedList()}),f.qZA(),f.TgZ(2,"button",8),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).editor.toggleOrderedList()}),f.qZA(),f.TgZ(3,"button",9),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).sinkListItem()}),f.qZA(),f.TgZ(4,"button",10),f.NdJ("click",function(){return f.CHM(N),f.oxw(3).liftListItem()}),f.qZA(),f.qZA()}if(2&W){const N=f.oxw().tuiLet,pt=f.oxw().ngIf;f.xp6(1),f.Q6J("tuiHint",pt.unorderedList)("pseudoActive",!(null==N||!N.unordered)),f.xp6(1),f.Q6J("tuiHint",pt.orderedList)("pseudoActive",!(null==N||!N.ordered)),f.xp6(1),f.Q6J("tuiHint",pt.indent)("disabled",!(null!=N&&N.ordered||null!=N&&N.unordered)),f.xp6(1),f.Q6J("tuiHint",pt.outdent)("disabled",!(null!=N&&N.ordered||null!=N&&N.unordered))}}function _t(W,Q){if(1&W&&(f.TgZ(0,"tui-hosted-dropdown",2,3),f._UZ(2,"button",4),f.YNc(3,Et,5,8,"ng-template",null,5,f.W1O),f.qZA()),2&W){const N=Q.tuiLet,pt=f.MAs(1),ht=f.MAs(4),gt=f.oxw().ngIf;f.Q6J("content",ht),f.xp6(2),f.Q6J("tuiHint",gt.list)("tuiHintDescribe","")("pseudoActive",(null==pt?null:pt.open)||(null==N?null:N.unordered)||(null==N?null:N.ordered)||!1)("focusable",pt.open)}}function ut(W,Q){if(1&W&&(f.ynx(0),f.YNc(1,_t,5,5,"tui-hosted-dropdown",1),f.ALo(2,"async"),f.BQk()),2&W){const N=f.oxw();f.xp6(1),f.Q6J("tuiLet",f.lcZ(2,1,N.listState$))}}let $=(()=>{class W{constructor(N,pt){this.editor=N,this.texts$=pt,this.listState$=(0,L.aj)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,y.U)(([ht,gt])=>({ordered:ht,unordered:gt})))}sinkListItem(){this.editor.sinkListItem()}liftListItem(){this.editor.liftListItem()}}return W.\u0275fac=function(N){return new(N||W)(f.Y36(g.$3),f.Y36(s.rf))},W.\u0275cmp=f.Xpm({type:W,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","disabled","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","disabled","click"]],template:function(N,pt){1&N&&(f.YNc(0,ut,3,3,"ng-container",0),f.ALo(1,"async")),2&N&&f.Q6J("ngIf",f.lcZ(1,1,pt.texts$))},directives:[q.O5,b.L,nt.o,j.v,at.D,et.x,mt.t,it.D,st.$],pipes:[q.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),W})()},95558:(St,dt,u)=>{u.d(dt,{p:()=>gt});var g=u(64762),s=u(40632),L=u(62842),y=u(36692),f=u(88002),q=u(87519),b=u(74788),nt=u(40939),j=u(62939),at=u(33250),et=u(76189),mt=u(67446),it=u(29070),st=u(54255),Et=u(15491),_t=u(219),ut=u(12057),$=u(5451),W=u(17163);function Q(Tt,ft){if(1&Tt&&b._UZ(0,"div",7),2&Tt){const xt=b.oxw(2).tuiLet;b.Udp("background",xt)}}function N(Tt,ft){if(1&Tt){const xt=b.EpF();b.TgZ(0,"tui-palette",8),b.NdJ("selectedColor",function(Ut){return b.CHM(xt),b.oxw(3).setCellColor(Ut)}),b.qZA()}if(2&Tt){const xt=ft.$implicit,Dt=b.oxw(3);b.Q6J("tuiActiveZoneParent",xt)("colors",Dt.colors)}}function pt(Tt,ft){if(1&Tt&&(b.TgZ(0,"tui-hosted-dropdown",2,3),b._UZ(2,"button",4),b.ALo(3,"async"),b.YNc(4,Q,1,2,"div",5),b.YNc(5,N,1,2,"ng-template",null,6,b.W1O),b.qZA()),2&Tt){const xt=ft.tuiLet,Dt=b.MAs(1),Ut=b.MAs(6),ot=b.oxw().tuiLet,x=b.oxw();b.Q6J("content",Ut)("tuiDropdownMaxHeight",999)("canOpen",!!xt),b.xp6(2),b.Q6J("tuiHint",b.lcZ(3,9,x.cellColorText$))("tuiHintDescribe","")("pseudoActive",Dt.open)("focusable",Dt.open)("disabled",!xt),b.xp6(2),b.Q6J("ngIf",!x.isBlankColor(ot||""))}}function ht(Tt,ft){if(1&Tt&&(b.ynx(0),b.YNc(1,pt,7,11,"tui-hosted-dropdown",1),b.ALo(2,"async"),b.BQk()),2&Tt){const xt=b.oxw();b.xp6(1),b.Q6J("tuiLet",b.lcZ(2,1,xt.isActive$))}}class gt{constructor(ft,xt,Dt){this.defaultOptions=ft,this.editor=xt,this.texts$=Dt,this.colors=this.defaultOptions.colors,this.cellColorText$=this.texts$.pipe((0,f.U)(Ut=>Ut.cellColor)),this.isActive$=this.editor.isActive$("table"),this.cellColor$=this.editor.stateChange$.pipe((0,f.U)(()=>this.editor.getCellColor()||this.defaultOptions.blankColor),(0,q.x)())}isBlankColor(ft){return ft===this.defaultOptions.blankColor}setCellColor(ft){this.editor.setCellColor(ft)}}gt.\u0275fac=function(ft){return new(ft||gt)(b.Y36(L.mJ),b.Y36(s.$3),b.Y36(L.rf))},gt.\u0275cmp=b.Xpm({type:gt,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["cellColorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","disabled"],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(ft,xt){1&ft&&(b.YNc(0,ht,3,3,"ng-container",0),b.ALo(1,"async")),2&ft&&b.Q6J("tuiLet",b.lcZ(1,1,xt.cellColor$))},directives:[nt.L,j.o,at.Ek,et.v,mt.D,it.x,st.t,Et.D,_t.$,ut.O5,$.R,W.e],pipes:[ut.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],gt.prototype,"colors",void 0)},28962:(St,dt,u)=>{u.d(dt,{l:()=>_t});var g=u(40632),s=u(62842),L=u(88002),y=u(74788),f=u(62939),q=u(33250),b=u(76189),nt=u(67446),j=u(29070),at=u(54255),et=u(15491),mt=u(219),it=u(74549),st=u(12057);function Et(ut,$){if(1&ut){const W=y.EpF();y.TgZ(0,"tui-table-size-selector",4),y.NdJ("onSelectSize",function(N){return y.CHM(W),y.oxw().addTable(N)}),y.qZA()}}let _t=(()=>{class ut{constructor(W,Q){this.editor=W,this.texts$=Q,this.insertTableText$=this.texts$.pipe((0,L.U)(N=>N.insertTable))}addTable({rows:W,cols:Q}){this.editor.enter();const N=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(N),this.editor.insertTable(W,Q)}}return ut.\u0275fac=function(W){return new(W||ut)(y.Y36(g.$3),y.Y36(s.rf))},ut.\u0275cmp=y.Xpm({type:ut,selectors:[["tui-table-create"]],decls:6,vars:6,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable"],["tableDropdown",""],[3,"onSelectSize"]],template:function(W,Q){if(1&W&&(y.TgZ(0,"tui-hosted-dropdown",0,1),y._UZ(2,"button",2),y.ALo(3,"async"),y.qZA(),y.YNc(4,Et,1,0,"ng-template",null,3,y.W1O)),2&W){const N=y.MAs(1),pt=y.MAs(5);y.Q6J("content",pt),y.xp6(2),y.Q6J("tuiHint",y.lcZ(3,4,Q.insertTableText$))("tuiHintDescribe","")("focusable",N.open)}},directives:[f.o,q.Ek,b.v,nt.D,j.x,at.t,et.D,mt.$,it.M],pipes:[st.Ov],encapsulation:2,changeDetection:0}),ut})()},76965:(St,dt,u)=>{u.d(dt,{Y:()=>ut});var g=u(40632),s=u(62842),L=u(88002),y=u(87519),f=u(74788),q=u(40939),b=u(12057),nt=u(76189),j=u(67446),at=u(29070),et=u(54255),mt=u(15491),it=u(219);function st($,W){if(1&$){const Q=f.EpF();f.TgZ(0,"button",2),f.NdJ("click",function(){f.CHM(Q);const pt=f.oxw().tuiLet,ht=f.oxw();return pt.mergeCells?ht.mergeCells():ht.splitCell()}),f.qZA()}if(2&$){const Q=W.ngIf,N=f.oxw().tuiLet;f.Q6J("icon",N.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",N.mergeCells?Q.mergeCells:Q.splitCells)("tuiHintDescribe","")("focusable",!1)("disabled",!N.mergeCells&&!N.splitCells)}}function Et($,W){if(1&$&&(f.ynx(0),f.YNc(1,st,1,5,"button",1),f.ALo(2,"async"),f.BQk()),2&$){const Q=f.oxw();f.xp6(1),f.Q6J("ngIf",f.lcZ(2,1,Q.texts$))}}const _t=function($,W){return{mergeCells:$,splitCells:W}};let ut=(()=>{class ${constructor(Q,N){this.editor=Q,this.texts$=N,this.canMergeCells$=this.editor.stateChange$.pipe((0,L.U)(()=>this.editor.canMergeCells()),(0,y.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,L.U)(()=>this.editor.canSplitCells()),(0,y.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}}return $.\u0275fac=function(Q){return new(Q||$)(f.Y36(g.$3),f.Y36(s.rf))},$.\u0275cmp=f.Xpm({type:$,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(Q,N){1&Q&&(f.YNc(0,Et,3,3,"ng-container",0),f.ALo(1,"async"),f.ALo(2,"async")),2&Q&&f.Q6J("tuiLet",f.WLB(5,_t,f.lcZ(1,1,N.canMergeCells$),f.lcZ(2,3,N.canSplitCells$)))},directives:[q.L,b.O5,nt.v,j.D,at.x,et.t,mt.D,it.$],pipes:[b.Ov],encapsulation:2,changeDetection:0}),$})()},22063:(St,dt,u)=>{u.d(dt,{i:()=>N,_:()=>pt});var g=u(40632),s=u(62842),L=u(88002),y=u(74788),f=u(40939),q=u(62939),b=u(76189),nt=u(67446),j=u(29070),at=u(54255),et=u(15491),mt=u(219),it=u(20933),st=u(12057),Et=u(89786),_t=u(35065);function ut(ht,gt){if(1&ht&&(y.TgZ(0,"tui-hosted-dropdown",2,3),y._UZ(2,"button",4),y.ALo(3,"async"),y.qZA()),2&ht){const Tt=gt.tuiLet,ft=y.MAs(1),xt=y.oxw(),Dt=y.MAs(3);y.Q6J("content",Dt)("canOpen",!!Tt),y.xp6(2),y.Q6J("tuiHint",y.lcZ(3,6,xt.rowsColumnsManagingText$))("tuiHintDescribe","")("focusable",ft.open)("disabled",!Tt)}}function $(ht,gt){if(1&ht){const Tt=y.EpF();y.TgZ(0,"button",7),y.NdJ("click",function(){const Dt=y.CHM(Tt).index,Ut=y.oxw().index;return y.oxw(2).onTableOption(2*Ut+Dt)}),y._uU(1),y.qZA()}if(2&ht){const Tt=gt.$implicit;y.xp6(1),y.hij(" ",Tt," ")}}function W(ht,gt){if(1&ht&&(y.TgZ(0,"tui-opt-group"),y.YNc(1,$,2,1,"button",6),y.qZA()),2&ht){const Tt=gt.$implicit;y.xp6(1),y.Q6J("ngForOf",Tt)}}function Q(ht,gt){if(1&ht&&(y.TgZ(0,"tui-data-list"),y.YNc(1,W,2,1,"tui-opt-group",5),y.ALo(2,"async"),y.qZA()),2&ht){const Tt=y.oxw();y.xp6(1),y.Q6J("ngForOf",y.lcZ(2,1,Tt.tableCommandTexts$))}}var N=(()=>{return(ht=N||(N={}))[ht.InsertColumnBefore=0]="InsertColumnBefore",ht[ht.InsertColumnAfter=1]="InsertColumnAfter",ht[ht.InsertRowBefore=2]="InsertRowBefore",ht[ht.InsertRowAfter=3]="InsertRowAfter",ht[ht.DeleteColumn=4]="DeleteColumn",ht[ht.DeleteRow=5]="DeleteRow",N;var ht})();let pt=(()=>{class ht{constructor(Tt,ft,xt){this.editor=Tt,this.texts$=ft,this.tableCommandTexts$=xt,this.commandsRegistry={[N.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[N.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[N.InsertRowAfter]:()=>this.editor.addRowAfter(),[N.InsertRowBefore]:()=>this.editor.addRowBefore(),[N.DeleteColumn]:()=>this.editor.deleteColumn(),[N.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,L.U)(Dt=>Dt.rowsColumnsManaging))}onTableOption(Tt){this.commandsRegistry[Tt]()}}return ht.\u0275fac=function(Tt){return new(Tt||ht)(y.Y36(g.$3),y.Y36(s.rf),y.Y36(s.$i))},ht.\u0275cmp=y.Xpm({type:ht,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled"],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(Tt,ft){1&Tt&&(y.YNc(0,ut,4,8,"tui-hosted-dropdown",0),y.ALo(1,"async"),y.YNc(2,Q,3,3,"ng-template",null,1,y.W1O)),2&Tt&&y.Q6J("tuiLet",y.lcZ(1,1,ft.isActive$))},directives:[f.L,q.o,b.v,nt.D,j.x,at.t,et.D,mt.$,it.q,st.sg,Et.R,_t.v],pipes:[st.Ov],encapsulation:2,changeDetection:0}),ht})()},74549:(St,dt,u)=>{u.d(dt,{M:()=>at});var g=u(74788),s=u(62579),L=u(72002),y=u(36097);function f(et,mt){if(1&et){const it=g.EpF();g.TgZ(0,"div",4),g.NdJ("mouseenter",function(Et){const ut=g.CHM(it).$implicit,$=g.oxw().$implicit;return g.oxw().updateCurrentSize(ut+1,$+1,Et)})("click",function(){return g.CHM(it),g.oxw(2).onClick()}),g.qZA()}if(2&et){const it=mt.$implicit,st=g.oxw().$implicit,Et=g.oxw();g.ekj("t-cell_hovered",Et.tableSelectHovered(it,st))}}function q(et,mt){if(1&et&&(g.TgZ(0,"div",2),g.YNc(1,f,1,2,"div",3),g.qZA()),2&et){const it=g.oxw();g.xp6(1),g.Q6J("tuiRepeatTimesOf",it.rowsNumber)}}let at=(()=>{class et{constructor(it){this.windowRef=it,this.onSelectSize=new g.vpe,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(it,st){return it<this.tableSize.rows&&st<this.tableSize.cols}updateCurrentSize(it,st,Et){(0,L.tuiGetViewportWidth)(this.windowRef)-Et.clientX>70&&(this.tableSize={rows:it,cols:st})}onClick(){this.onSelectSize.emit(this.tableSize)}}return et.\u0275fac=function(it){return new(it||et)(g.Y36(s.m9))},et.\u0275cmp=g.Xpm({type:et,selectors:[["tui-table-size-selector"]],outputs:{onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(it,st){1&it&&(g.YNc(0,q,2,1,"div",0),g.TgZ(1,"div",1),g._uU(2),g.qZA()),2&it&&(g.Q6J("tuiRepeatTimesOf",st.columnsNumber),g.xp6(2),g.AsE("",st.tableSize.cols,"\xd7",st.tableSize.rows,""))},directives:[y.X],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),et})()},10528:(St,dt,u)=>{u.d(dt,{G:()=>pt});var g=u(64762),s=u(40632),L=u(62842),y=u(36692),f=u(88002),q=u(87519),b=u(74788),nt=u(40939),j=u(62939),at=u(33250),et=u(76189),mt=u(67446),it=u(29070),st=u(54255),Et=u(15491),_t=u(219),ut=u(5451),$=u(17163),W=u(12057);function Q(ht,gt){if(1&ht){const Tt=b.EpF();b.TgZ(0,"tui-palette",6),b.NdJ("selectedColor",function(xt){return b.CHM(Tt),b.oxw(2).editor.setFontColor(xt)}),b.qZA()}if(2&ht){const Tt=gt.$implicit,ft=b.oxw(2);b.Q6J("tuiActiveZoneParent",Tt)("colors",ft.colors)}}function N(ht,gt){if(1&ht&&(b.TgZ(0,"tui-hosted-dropdown",1,2),b._UZ(2,"button",3),b.ALo(3,"async"),b._UZ(4,"div",4),b.YNc(5,Q,1,2,"ng-template",null,5,b.W1O),b.qZA()),2&ht){const Tt=gt.tuiLet,ft=b.MAs(1),xt=b.MAs(6),Dt=b.oxw();b.Q6J("content",xt)("tuiDropdownMaxHeight",999),b.xp6(2),b.Q6J("tuiHint",b.lcZ(3,8,Dt.foreColorText$))("tuiHintDescribe","")("pseudoActive",ft.open)("focusable",ft.open),b.xp6(2),b.Udp("background",Tt)}}class pt{constructor(gt,Tt,ft){this.defaultOptions=gt,this.editor=Tt,this.texts$=ft,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,f.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,q.x)()),this.foreColorText$=this.texts$.pipe((0,f.U)(xt=>xt.foreColor))}}pt.\u0275fac=function(gt){return new(gt||pt)(b.Y36(L.mJ),b.Y36(s.$3),b.Y36(L.rf))},pt.\u0275cmp=b.Xpm({type:pt,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(gt,Tt){1&gt&&(b.YNc(0,N,7,10,"tui-hosted-dropdown",0),b.ALo(1,"async")),2&gt&&b.Q6J("tuiLet",b.lcZ(1,1,Tt.fontColor$))},directives:[nt.L,j.o,at.Ek,et.v,mt.D,it.x,st.t,Et.D,_t.$,ut.R,$.e],pipes:[W.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,g.gn)([(0,y.tuiDefaultProp)()],pt.prototype,"colors",void 0)},17406:(St,dt,u)=>{u.d(dt,{M6:()=>g.M,yB:()=>nt,Bp:()=>j.B});var g=u(4997),s=u(12057),L=u(71115),y=u(93252),f=u(36692),q=u(72002),b=u(74788);let nt=(()=>{class at{}return at.\u0275fac=function(mt){return new(mt||at)},at.\u0275mod=b.oAB({type:at}),at.\u0275inj=b.cJS({imports:[[s.ez,q.TuiHintModule,f.TuiFocusableModule,q.TuiButtonModule,q.TuiHostedDropdownModule,L.F,y.er,y.mp,y.__,y.iA,y.p7,y.Zv,y.pu,y.Ur,y._t,y.XC,y.P_,y.y9,f.TuiItemModule,y.jP]]}),at})();var j=u(13044)},13044:(St,dt,u)=>{u.d(dt,{B:()=>L});var g=u(74788),s=u(36692);let L=(()=>{class y{constructor(q){this.elementRef=q}get toolsContainers(){return Array.from(this.elementRef.nativeElement.querySelectorAll("[tuiItem]"))}onHorizontalNavigation(q){const{toolsContainers:b}=this,nt=b.findIndex(s.tuiIsNativeFocusedIn),at=b[(0,s.tuiClamp)(nt+(q?-1:1),0,b.length-1)],et=q?this.findPreviousTool(at):this.findNextTool(at);et&&et.focus()}findFirstFocusableTool(q=!1){const b=q?this.toolsContainers.slice().reverse():this.toolsContainers;for(const nt of b){const j=(0,s.tuiIsNativeMouseFocusable)(nt)?nt:(0,s.tuiGetClosestFocusable)({initial:nt,root:nt,keyboard:!1});if(j)return j}return null}findPreviousTool(q){return(0,s.tuiIsNativeMouseFocusable)(q)?q:(0,s.tuiGetClosestFocusable)({initial:q,root:q,keyboard:!1})||(0,s.tuiGetClosestFocusable)({initial:q,root:this.elementRef.nativeElement,previous:!0,keyboard:!1})}findNextTool(q){return(0,s.tuiIsNativeMouseFocusable)(q)?q:(0,s.tuiGetClosestFocusable)({initial:q,root:this.elementRef.nativeElement,keyboard:!1})}}return y.\u0275fac=function(q){return new(q||y)(g.Y36(g.SBq))},y.\u0275dir=g.lG2({type:y,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(q,b){1&q&&g.NdJ("keydown.arrowRight.prevent",function(){return b.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return b.onHorizontalNavigation(!0)})}}),y})()},4997:(St,dt,u)=>{u.d(dt,{M:()=>O});var g=u(64762),s=u(74788),L=u(19074),y=u(40632),f=u(48699),q=u(62842),b=u(36692),nt=u(15257),j=u(13044),at=u(12057),et=u(48893),mt=u(76189),it=u(82707),st=u(67446),Et=u(29070),_t=u(54255),ut=u(15491),$=u(219),W=u(84985),Q=u(62976),N=u(37924),pt=u(13441),ht=u(62939),gt=u(45050),Tt=u(10528),ft=u(7416),xt=u(15587),Dt=u(50237),Ut=u(18832),ot=u(19762),x=u(28962),Z=u(22063),Y=u(76965),ct=u(95558);const R=["dropdown"];function V(P,H){1&P&&s.GkF(0)}function tt(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",7),s.NdJ("click",function(){return s.CHM(k),s.oxw(2).undo()}),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(k),s.oxw(2).redo()}),s.qZA(),s.qZA()}if(2&P){const k=s.oxw().ngIf,X=s.oxw();s.xp6(1),s.Q6J("tuiHint",k.undo)("tuiHintDescribe","")("disabled",X.undoDisabled)("focusable",!1),s.xp6(1),s.Q6J("tuiHint",k.redo)("tuiHintDescribe","")("disabled",X.redoDisabled)("focusable",!1)}}function Ot(P,H){1&P&&(s.TgZ(0,"div",6),s._UZ(1,"tui-font-size",9),s.qZA())}function It(P,H){if(1&P&&s._UZ(0,"tui-font-style",15),2&P){const k=s.oxw(3);s.Q6J("enabledTools",k.toolsSet)}}function Ft(P,H){1&P&&s._UZ(0,"tui-align-content",9)}function $t(P,H){1&P&&s._UZ(0,"tui-list-configs",9)}function Jt(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"button",16,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(3).toggleQuote()}),s.qZA()}if(2&P){const k=s.oxw(2).ngIf,X=s.oxw();s.Q6J("tuiHint",k.quote)("tuiHintDescribe","")("pseudoActive",X.blockquote)("disabled",X.unorderedList||X.orderedList)("focusable",!1)}}function Be(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"tui-edit-link",22,23),s.NdJ("addLink",function(yt){s.CHM(k),s.oxw();const Pt=s.MAs(1);return s.oxw(3).onLink(Pt,yt)})("removeLink",function(){s.CHM(k),s.oxw();const yt=s.MAs(1);return s.oxw(3).onLink(yt)}),s.qZA()}}function be(P,H){if(1&P&&(s.TgZ(0,"tui-hosted-dropdown",18,19),s._UZ(2,"button",20,17),s.YNc(4,Be,2,0,"ng-template",null,21,s.W1O),s.qZA()),2&P){const k=s.MAs(1),X=s.MAs(5),yt=s.oxw(2).ngIf,Pt=s.oxw();s.Q6J("canOpen",!Pt.a)("content",X),s.xp6(2),s.Q6J("tuiHint",yt.link)("tuiHintDescribe","")("pseudoActive",k.open||Pt.a)("focusable",k.open)}}function Ae(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"button",24,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(3).onAttach()}),s.qZA()}if(2&P){const k=s.oxw(2).ngIf;s.Q6J("tuiHint",k.attach)("tuiHintDescribe","")("focusable",!1)}}function Ce(P,H){if(1&P&&(s.TgZ(0,"div",6),s.YNc(1,It,1,1,"tui-font-style",10),s.YNc(2,Ft,1,0,"tui-align-content",11),s.YNc(3,$t,1,0,"tui-list-configs",11),s.YNc(4,Jt,2,5,"button",12),s.YNc(5,be,6,6,"tui-hosted-dropdown",13),s.YNc(6,Ae,2,3,"button",14),s.qZA()),2&P){const k=s.oxw(2);s.xp6(1),s.Q6J("ngIf",k.formatEnabled),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Align)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.List)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Quote)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Link)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Attach))}}function Gt(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"button",27,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(3).toggleSubscript()}),s.qZA()}if(2&P){const k=s.oxw(2).ngIf,X=s.oxw();s.Q6J("tuiHint",k.subscript)("tuiHintDescribe","")("pseudoActive",X.subscript)("focusable",!1)}}function pe(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"button",28,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(3).toggleSuperscript()}),s.qZA()}if(2&P){const k=s.oxw(2).ngIf,X=s.oxw();s.Q6J("tuiHint",k.superscript)("tuiHintDescribe","")("pseudoActive",X.superscript)("focusable",!1)}}function he(P,H){if(1&P&&(s.TgZ(0,"div",6),s.YNc(1,Gt,2,4,"button",25),s.YNc(2,pe,2,4,"button",26),s.qZA()),2&P){const k=s.oxw(2);s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Sub)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Sup))}}function oe(P,H){if(1&P&&s._UZ(0,"tui-text-color",30),2&P){const k=s.oxw(3);s.Q6J("colors",k.colors)}}function Ne(P,H){if(1&P&&s._UZ(0,"tui-highlight-color",30),2&P){const k=s.oxw(3);s.Q6J("colors",k.colors)}}function Xt(P,H){if(1&P&&(s.TgZ(0,"div",6),s.YNc(1,oe,1,1,"tui-text-color",29),s.YNc(2,Ne,1,1,"tui-highlight-color",29),s.qZA()),2&P){const k=s.oxw(2);s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Color)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Hilite))}}function Zt(P,H){1&P&&s._UZ(0,"tui-code",9)}function Ee(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"button",34,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(3).onTeX()}),s.qZA()}if(2&P){const k=s.oxw(2).ngIf;s.Q6J("tuiHint",k.tex)("tuiHintDescribe","")("focusable",!1)}}function le(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"div",35),s.TgZ(1,"button",36,17),s.NdJ("click",function(){return s.CHM(k),s.MAs(4).click()}),s.qZA(),s.TgZ(3,"input",37,38),s.NdJ("change",function(){s.CHM(k);const yt=s.MAs(4);return s.oxw(3).onImage(yt)}),s.qZA(),s.qZA()}if(2&P){const k=s.oxw(2).ngIf;s.xp6(1),s.Q6J("tuiHint",k.image)("tuiHintDescribe","")("focusable",!1),s.xp6(2),s.Q6J("tuiFocusable",!1)}}function me(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"button",39,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(3).insertHorizontalRule()}),s.qZA()}if(2&P){const k=s.oxw(2).ngIf;s.Q6J("tuiHint",k.insertHorizontalRule)("tuiHintDescribe","")("focusable",!1)}}function Se(P,H){if(1&P&&(s.TgZ(0,"div",6),s.YNc(1,Zt,1,0,"tui-code",11),s.YNc(2,Ee,2,3,"button",31),s.YNc(3,le,5,4,"div",32),s.YNc(4,me,2,3,"button",33),s.qZA()),2&P){const k=s.oxw(2);s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Code)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Tex)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Img)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.HR))}}function Ie(P,H){if(1&P){const k=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",40,17),s.NdJ("click",function(){return s.CHM(k),s.oxw(2).removeFormat()}),s.qZA(),s.qZA()}if(2&P){const k=s.oxw().ngIf;s.xp6(1),s.Q6J("tuiHint",k.clear)("tuiHintDescribe","")("focusable",!1)}}function ee(P,H){1&P&&(s.TgZ(0,"div",6),s._UZ(1,"tui-details",41),s._UZ(2,"tui-details-remove",41),s.qZA())}function te(P,H){1&P&&(s.TgZ(0,"div",6),s._UZ(1,"tui-editor-group-tool",41),s.qZA())}function fe(P,H){if(1&P&&(s.TgZ(0,"div",6),s._UZ(1,"tui-table-create",41),s._UZ(2,"tui-table-row-column-manager",41),s._UZ(3,"tui-table-merge-cells",41),s._UZ(4,"tui-table-cell-color",30),s.qZA()),2&P){const k=s.oxw(2);s.xp6(4),s.Q6J("colors",k.colors)}}function z(P,H){if(1&P&&(s.TgZ(0,"section",4),s.YNc(1,tt,3,8,"div",5),s.YNc(2,Ot,2,0,"div",5),s.YNc(3,Ce,7,6,"div",5),s.YNc(4,he,3,2,"div",5),s.YNc(5,Xt,3,2,"div",5),s.YNc(6,Se,5,4,"div",5),s.YNc(7,Ie,3,3,"div",5),s.YNc(8,ee,3,0,"div",5),s.YNc(9,te,2,0,"div",5),s.YNc(10,fe,5,1,"div",5),s.TgZ(11,"div",6),s.Hsn(12),s.qZA(),s.qZA()),2&P){const k=s.oxw();s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Undo)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Size)),s.xp6(1),s.Q6J("ngIf",k.firstBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Sub)||k.enabled(k.TuiEditorTool.Sup)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Color)||k.enabled(k.TuiEditorTool.Hilite)),s.xp6(1),s.Q6J("ngIf",k.secondBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Clear)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Details)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Group)),s.xp6(1),s.Q6J("ngIf",k.enabled(k.TuiEditorTool.Table))}}class O{constructor(H,k,X,yt,Pt){this.elementRef=H,this.editor=k,this.imageLoader=X,this.texts$=yt,this.defaultOptions=Pt,this.dropdowns=b.EMPTY_QUERY,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new s.vpe,this.texClicked=new s.vpe,this.attachClicked=new s.vpe,this.TuiEditorTool=f._,this.toolsSet=new Set(L.Db)}set tools(H){this.toolsSet=new Set(H)}get focused(){return(0,b.tuiIsNativeFocusedIn)(this.elementRef.nativeElement)||!!this.dropdowns.find(({nativeElement:H})=>(0,b.tuiIsNativeFocusedIn)(H))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(f._.Bold)||this.enabled(f._.Italic)||this.enabled(f._.Underline)||this.enabled(f._.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(f._.Align)||this.enabled(f._.List)||this.enabled(f._.Quote)||this.enabled(f._.Link)||this.enabled(f._.Attach)}get secondBigBlockEnabled(){return this.enabled(f._.Code)||this.enabled(f._.Tex)||this.enabled(f._.Img)||this.enabled(f._.HR)}onMouseDown(H,k){k.closest("button")||(H.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage(H){var k;const X=null===(k=H.files)||void 0===k?void 0:k[0];H.value="",X&&this.imageLoader(X).pipe((0,nt.q)(1)).subscribe(yt=>{this.addImage(yt)})}onAttach(){this.attachClicked.emit()}onTeX(){this.texClicked.emit()}onLink(H,k){H.open=!1,k&&(this.editor.toggleLink(k),this.editor.selectClosest())}enabled(H){return this.toolsSet.has(H)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage(H){this.editor.setImage(H)}focusFirst(){var H;const k=null===(H=this.navigationManager)||void 0===H?void 0:H.findFirstFocusableTool();k&&k.focus()}focusLast(){var H;const k=null===(H=this.navigationManager)||void 0===H?void 0:H.findFirstFocusableTool(!0);k&&k.focus()}}O.\u0275fac=function(H){return new(H||O)(s.Y36(s.SBq,8),s.Y36(y.$3),s.Y36(q.p7),s.Y36(q.rf),s.Y36(q.mJ))},O.\u0275cmp=s.Xpm({type:O,selectors:[["tui-toolbar"]],viewQuery:function(H,k){if(1&H&&(s.Gf(j.B,5),s.Gf(R,5,s.SBq)),2&H){let X;s.iGM(X=s.CRH())&&(k.navigationManager=X.first),s.iGM(X=s.CRH())&&(k.dropdowns=X)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function(H,k){1&H&&s.NdJ("mousedown",function(yt){return k.onMouseDown(yt,yt.target)}),2&H&&s.ekj("_disabled",k.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",attachClicked:"attachClicked"},ngContentSelectors:["*"],decls:7,vars:8,consts:[[1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiItem","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiItem","",1,"t-tool","t-wrapper"],["tuiItem","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiItem","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click"],["button",""],["tuiItem","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiItem","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImgLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-tool","t-tool_margin"]],template:function(H,k){1&H&&(s.F$t(),s._UZ(0,"button",0),s.YNc(1,V,1,0,"ng-container",1),s.ALo(2,"async"),s.TgZ(3,"div",2),s.NdJ("focus",function(){return k.onTopFocus()}),s.qZA(),s.TgZ(4,"div",2),s.NdJ("focus",function(){return k.onBottomFocus()}),s.qZA(),s.YNc(5,z,13,10,"section",3),s.ALo(6,"async")),2&H&&(s.xp6(1),s.Q6J("ngIf",s.lcZ(2,4,k.editor.stateChange$)),s.xp6(2),s.Q6J("tuiFocusable",k.focusable),s.xp6(1),s.Q6J("tuiFocusable",k.focusable),s.xp6(1),s.Q6J("ngIf",s.lcZ(6,6,k.texts$)))},directives:[at.O5,et.t,j.B,mt.v,it.w,st.D,Et.x,_t.t,ut.D,$.$,W.m,Q.h,N.X,pt.w,ht.o,gt.l,Tt.G,ft.U,xt.T,Dt.y,Ut.U,ot.d,x.l,Z._,Y.Y,ct.p],pipes:[at.Ov],styles:['.t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:"";display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}button.t-tool[_ngcontent-%COMP%]:hover, .t-tool[_ngcontent-%COMP%]     button:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:none;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-color-edit{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),(0,g.gn)([(0,b.tuiDefaultProp)()],O.prototype,"colors",void 0),(0,g.gn)([(0,b.tuiDefaultProp)()],O.prototype,"disabled",void 0),(0,g.gn)([(0,b.tuiDefaultProp)(function(P){return!P.includes(f._.Tex)&&!P.includes(f._.Attach)},"Attach and TeX are not yet implemented in Editor")],O.prototype,"tools",null)},19074:(St,dt,u)=>{u.d(dt,{hK:()=>s,sw:()=>g,Db:()=>y,RR:()=>f});const g=new Map([["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),s="rgb(51, 51, 51)";var L=u(48699);const y=[L._.Undo,L._.Size,L._.Bold,L._.Italic,L._.Underline,L._.Align,L._.List,L._.Quote,L._.Link,L._.Color,L._.Hilite,L._.Clear,L._.Strikethrough,L._.Code,L._.Img,L._.HR,L._.Sup,L._.Sub,L._.Table,L._.Details];function f(q){return[{px:13,name:q.small},{px:15,name:q.normal},{px:17,name:q.large},{px:24,family:"var(--tui-font-heading)",name:q.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:q.title,headingLevel:1,weight:"bold"}]}},60153:(St,dt,u)=>{u.d(dt,{Z:()=>s});var g=u(74788);let s=(()=>{class L{constructor(){this.imagePreview=new g.vpe}click(f){f instanceof HTMLImageElement&&this.imagePreview.emit(f)}}return L.\u0275fac=function(f){return new(f||L)},L.\u0275dir=g.lG2({type:L,selectors:[["tui-editor-socket","imagePreview",""]],hostAttrs:[1,"_preview-image"],hostBindings:function(f,q){1&f&&g.NdJ("click",function(nt){return q.click(nt.target)})},outputs:{imagePreview:"imagePreview"}}),L})()},40632:(St,dt,u)=>{u.d(dt,{Zj:()=>g.Z,BN:()=>L,JU:()=>y.J,mJ:()=>f,$3:()=>q.$});var g=u(60153),s=u(74788);let L=(()=>{class b{}return b.\u0275fac=function(j){return new(j||b)},b.\u0275mod=s.oAB({type:b}),b.\u0275inj=s.cJS({}),b})();var y=u(74982);let f=(()=>{class b{}return b.\u0275fac=function(j){return new(j||b)},b.\u0275mod=s.oAB({type:b}),b.\u0275inj=s.cJS({}),b})();var q=u(17804)},74982:(St,dt,u)=>{u.d(dt,{J:()=>q});var g=u(74788),s=u(62842),L=u(36692),y=u(46782),f=u(17804);let q=(()=>{class b{constructor(j,at,et,mt,it,st){this.elementRef=j,this.renderer=at,this.editor=et,this.editorContainer=mt,this.editorLoaded$=it,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,this.editorLoaded$.pipe((0,y.R)(st)).subscribe(()=>{this.renderer.appendChild(this.elementRef.nativeElement,this.editorContainer)})}set value(j){j!==this.editor.html&&this.editor.setValue(j)}set editable(j){this.editor.editable=j}}return b.\u0275fac=function(j){return new(j||b)(g.Y36(g.SBq),g.Y36(g.Qsj),g.Y36(f.$),g.Y36(s.Y1),g.Y36(s.ZW),g.Y36(L.TuiDestroyService))},b.\u0275dir=g.lG2({type:b,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[g._Bn([L.TuiDestroyService])]}),b})()},17804:(St,dt,u)=>{u.d(dt,{$:()=>at});var g=u(79765),s=u(74788);let L=(()=>{class et{constructor(){this.stateChange$=new g.xQ,this.valueChange$=new g.xQ}}return et.\u0275fac=function(it){return new(it||et)},et.\u0275dir=s.lG2({type:et}),et})();var y=u(62842),f=u(37631),q=u(39761),b=u(88002),nt=u(87519);let at=(()=>{class et extends L{constructor(it){super(),this.editorRef=it,this.editorRef.subscribe(st=>{this.editor=st,st.on("transaction",()=>{this.stateChange$.next()}),st.on("update",()=>{const Et=st.getHTML(),ut=function(et){return Array.isArray(et)&&1===et.length&&!et[0].hasOwnProperty("content")}(st.getJSON().content)?"":Et;this.valueChange$.next(ut)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(it){this.editor.setEditable(it)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||"rgb(51, 51, 51)"}getBackgroundColor(){var it;return(null===(it=this.editor)||void 0===it?void 0:it.getAttributes("textStyle").backgroundColor)||"rgb(51, 51, 51)"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}onAlign(it){this.editor.chain().focus().setTextAlign(it).run()}setImage(it){this.editor.chain().focus().first(({commands:st})=>[()=>{var Et;return(null===(Et=st.setEditableImage)||void 0===Et?void 0:Et.call(st,{src:it}))||!1},()=>st.setImage({src:it})]).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(it){this.editor.chain().focus().setFontColor(it).run()}setBackgroundColor(it){this.editor.chain().focus().setBackgroundColor(it).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(it){return this.editor.isActive(it)}isActive$(it){return this.stateChange$.pipe((0,q.O)(null),(0,b.U)(()=>this.isActive(it)),(0,nt.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(it,st){this.editor.chain().focus().insertTable({cols:it,rows:st}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(it){this.editor.chain().focus().setHeading({level:it}).run()}setParagraph(it){this.editor.chain().focus().setParagraph().run(),it&&this.editor.chain().setMark("textStyle",it).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(it){this.editor.commands.setTextSelection(it)}toggleLink(it){this.editor.chain().focus().toggleLink({href:it}).run()}setLink(it){this.editor.chain().focus().setLink({href:it}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}focus(){this.editor.chain().focus().run()}setValue(it){this.editor.commands.setContent(it)}destroy(){this.editor.destroy()}setCellColor(it){this.editor.chain().focus().setCellBackground(it).run()}selectClosest(){const it=this.editor.state.selection.anchor,{schema:st,doc:Et}=this.editor.state,_t=(0,f.Yz)(Et.resolve(it),st.marks.link);_t&&this.editor.chain().setTextSelection(_t).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}setGroup(){this.editor.commands.setGroup()}removeGroup(){this.editor.commands.removeGroup()}}return et.\u0275fac=function(it){return new(it||et)(s.LFG(y.ZW))},et.\u0275prov=s.Yz7({token:et,factory:et.\u0275fac}),et})()},48699:(St,dt,u)=>{u.d(dt,{_:()=>g});var g=(()=>{return(s=g||(g={})).Undo="undo",s.Size="fontSize",s.Bold="bold",s.Italic="italic",s.Underline="underline",s.Strikethrough="strikeThrough",s.Align="justify",s.List="list",s.Quote="quote",s.Color="foreColor",s.Hilite="hiliteColor",s.Clear="clear",s.Link="link",s.Attach="attach",s.Tex="tex",s.Code="code",s.Img="image",s.HR="insertHorizontalRule",s.Sup="superscript",s.Sub="subscript",s.Table="insertTable",s.MergeCells="mergeCells",s.SplitCells="splitCells",s.RowsColumnsManaging="rowsColumnsManaging",s.Details="details",s.Group="group",g;var s})()},15736:(St,dt,u)=>{u.r(dt),u.d(dt,{BackgroundColor:()=>L}),u(74634);const L=u(40256).Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:y})=>y?{style:`background-color: ${y}`}:{},parseHTML:({style:y})=>y.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:y=>({chain:f})=>f().setMark("textStyle",{backgroundColor:y}).run(),unsetBackgroundColor:()=>({chain:y})=>y().setMark("textStyle",{backgroundColor:null}).run()})})},52658:(St,dt,u)=>{u.r(dt),u.d(dt,{FontColor:()=>L}),u(74634);const L=u(40256).Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:y})=>y?{style:`color: ${y}`}:{},parseHTML:({style:y})=>y.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:y=>({chain:f})=>f().setMark("textStyle",{fontColor:y}).run(),unsetFontColor:()=>({chain:y})=>y().setMark("textStyle",{fontColor:null}).run()})})},9492:(St,dt,u)=>{u.r(dt),u.d(dt,{TuiFontSize:()=>L}),u(74634);const L=u(40256).Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:y})=>y.fontSize,renderHTML:({fontSize:y})=>y?{style:`font-size: ${y}`}:{}}}}]},addCommands:()=>({setFontSize:y=>({chain:f})=>f().setMark("textStyle",{fontSize:y}).run(),unsetFontSize:()=>({chain:y})=>y().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})})},54920:(St,dt,u)=>{u.r(dt),u.d(dt,{TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>L,createGroupExtension:()=>y});var g=u(37631),s=u(40256);const L={groupNodeClass:"tui-group-node",groupPointerNodeClass:"tui-group-pointer",nested:!0,draggable:!0,createOnEnter:!1},y=(f={})=>{const{draggable:q,nested:b,groupNodeClass:nt,groupPointerNodeClass:j,createOnEnter:at}=Object.assign(Object.assign({},L),f);return s.Node.create({name:"group",draggable:q,group:"block",content:b?"block+":"block",parseHTML:()=>[{tag:'div[data-type="group"]'}],renderHTML:({HTMLAttributes:et})=>["div",(0,s.mergeAttributes)(et,{"data-type":"group"}),0],addNodeView:()=>()=>{const et=document.createElement("div"),mt=document.createElement("div");if(et.classList.add(nt),mt.setAttribute("data-type","group"),q){const it=document.createElement("div");it.classList.add(j),it.innerHTML="",it.contentEditable="false",et.append(it,mt)}else et.append(mt);return{dom:et,contentDOM:mt}},addCommands(){return{setGroup:()=>({commands:et,state:mt})=>{this.editor.chain().focus().run();const it=(0,g.Ap)(mt,""),Et=`<div data-type="group">${it.trim().startsWith("<p>")?it:`<p>${it}</p>`}</div>`;return et.insertContent(Et)},removeGroup:()=>({state:et,dispatch:mt})=>(0,g.yU)(et,mt,this.name)}},addKeyboardShortcuts(){return at?{Enter:()=>this.editor.commands.setGroup()}:{}}})}},25039:(St,dt,u)=>{u.r(dt),u.d(dt,{TUI_EDITOR_MAX_IMAGE_WIDTH:()=>j,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>nt,TuiImageEditorComponent:()=>at,TuiImageEditorModule:()=>Et,createImageEditorExtension:()=>st});var g=u(12057),s=u(74788),L=u(40400),y=u(36692),f=u(66682),q=u(46782),b=u(60015);const nt=new s.OlP("[TUI_EDITOR_MIN_IMAGE_WIDTH]: Min size of resizable image inside editor",{factory:()=>100}),j=new s.OlP("[TUI_EDITOR_MAX_IMAGE_WIDTH]: Max size of resizable image inside editor",{factory:()=>1/0});let at=(()=>{class _t extends L.d{constructor($,W,Q,N){super(),this.minWidth=$,this.maxWidth=W,this.documentRef=Q,this.destroy$=N,this._width=0,(0,f.T)((0,y.tuiTypedFromEvent)(this.documentRef,"touchend"),(0,y.tuiTypedFromEvent)(this.documentRef,"mouseup")).pipe((0,q.R)(N)).subscribe(()=>this.updateAttributes({width:this.width}))}get attrs(){var $;return(null===($=this.node)||void 0===$?void 0:$.attrs)||{src:""}}get src(){return this.attrs.src}get width(){return this._width||this.attrs.width||0}get alt(){return this.attrs.alt||""}get title(){return this.attrs.title||""}onHorizontalDrag([$],W){this._width=Math.max(this.minWidth,Math.min(this.maxWidth,this.width+W*$))}}return _t.\u0275fac=function($){return new($||_t)(s.Y36(nt),s.Y36(j),s.Y36(g.K0),s.Y36(y.TuiDestroyService))},_t.\u0275cmp=s.Xpm({type:_t,selectors:[["tui-image-editor"]],features:[s._Bn([y.TuiDestroyService]),s.qOj],decls:3,vars:8,consts:[[3,"src","width","alt","title"],[1,"t-border","t-border_right",3,"tuiPan"],[1,"t-border","t-border_left",3,"tuiPan"]],template:function($,W){1&$&&(s._UZ(0,"img",0),s.TgZ(1,"span",1),s.NdJ("tuiPan",function(N){return W.onHorizontalDrag(N,1)}),s.qZA(),s.TgZ(2,"span",2),s.NdJ("tuiPan",function(N){return W.onHorizontalDrag(N,-1)}),s.qZA()),2&$&&(s.Udp("min-width",W.minWidth,"px")("max-width",W.maxWidth,"px"),s.Q6J("src",W.src,s.LSH)("width",W.width)("alt",W.alt)("title",W.title))},directives:[b.g],styles:['[_nghost-%COMP%]{position:relative;display:inline-block}[_nghost-%COMP%]:hover   .t-border[_ngcontent-%COMP%]:after{opacity:1}.t-border[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;display:flex;width:.75rem;cursor:col-resize;justify-content:center;align-items:center}.t-border_left[_ngcontent-%COMP%]{left:0}.t-border_right[_ngcontent-%COMP%]{right:0}.t-border[_ngcontent-%COMP%]:after{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;content:"";width:50%;height:33%;box-sizing:border-box;border-radius:var(--tui-radius-m);background:var(--tui-base-08);border:1px solid var(--tui-base-03);opacity:0}'],changeDetection:0}),_t})();var et=u(40256);const mt=[{tag:'img[data-type="image-editor"]'}],it={src:{default:"",keepOnSplit:!1},width:{default:300,keepOnSplit:!1},alt:{default:"",keepOnSplit:!1},title:{default:"",keepOnSplit:!1}},st=_t=>et.Node.create({name:"imageEditor",group:"block",atom:!0,draggable:!0,parseHTML:()=>mt,addAttributes:()=>it,renderHTML:({HTMLAttributes:ut})=>["img",(0,et.mergeAttributes)(ut,{"data-type":"image-editor"})],addNodeView:()=>(0,L.x)(at,{injector:_t}),addCommands(){return{setEditableImage:ut=>({commands:$})=>$.insertContent({type:this.name,attrs:ut})}}});let Et=(()=>{class _t{}return _t.\u0275fac=function($){return new($||_t)},_t.\u0275mod=s.oAB({type:_t}),_t.\u0275inj=s.cJS({imports:[[g.ez,y.TuiPanModule]]}),_t})()},12177:(St,dt,u)=>{function s(y){return y.isActive("bulletList")||y.isActive("orderedList")}u.r(dt),u.d(dt,{TuiTabExtension:()=>L,tuiIsOrderedOrBulletList:()=>s});const L=u(40256).Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>s(this.editor)?null:this.editor.commands.insertContent("\t")}}})},80726:(St,dt,u)=>{u.r(dt),u.d(dt,{StarterKit:()=>Zn});var g=u(40256);const s=/^\s*>\s$/,L=g.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:D}){return["blockquote",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{setBlockquote:()=>({commands:D})=>D.wrapIn(this.name),toggleBlockquote:()=>({commands:D})=>D.toggleWrap(this.name),unsetBlockquote:()=>({commands:D})=>D.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,g.wrappingInputRule)({find:s,type:this.type})]}}),y=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,f=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,q=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,b=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,nt=g.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:D=>"normal"!==D.style.fontWeight&&null},{style:"font-weight",getAttrs:D=>/^(bold(er)?|[5-9]\d{2,})$/.test(D)&&null}],renderHTML({HTMLAttributes:D}){return["strong",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{setBold:()=>({commands:D})=>D.setMark(this.name),toggleBold:()=>({commands:D})=>D.toggleMark(this.name),unsetBold:()=>({commands:D})=>D.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,g.markInputRule)({find:y,type:this.type}),(0,g.markInputRule)({find:q,type:this.type})]},addPasteRules(){return[(0,g.markPasteRule)({find:f,type:this.type}),(0,g.markPasteRule)({find:b,type:this.type})]}}),j=/^\s*([-+*])\s$/,at=g.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:D}){return["ul",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{toggleBulletList:()=>({commands:D})=>D.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[(0,g.wrappingInputRule)({find:j,type:this.type})]}}),et=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,mt=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,it=g.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:D}){return["code",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{setCode:()=>({commands:D})=>D.setMark(this.name),toggleCode:()=>({commands:D})=>D.toggleMark(this.name),unsetCode:()=>({commands:D})=>D.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,g.markInputRule)({find:et,type:this.type})]},addPasteRules(){return[(0,g.markPasteRule)({find:mt,type:this.type})]}});var st=u(35917),Et=u(38480);const _t=Object.create(null);class ut{constructor(a,_,T){this.$anchor=a,this.$head=_,this.ranges=T||[new $(a.min(_),a.max(_))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let a=this.ranges;for(let _=0;_<a.length;_++)if(a[_].$from.pos!=a[_].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(a,_=st.p2.empty){let T=_.content.lastChild,S=null;for(let vt=0;vt<_.openEnd;vt++)S=T,T=T.lastChild;let J=a.steps.length,G=this.ranges;for(let vt=0;vt<G.length;vt++){let{$from:At,$to:Ht}=G[vt],Wt=a.mapping.slice(J);a.replaceRange(Wt.map(At.pos),Wt.map(Ht.pos),vt?st.p2.empty:_),0==vt&&Dt(a,J,(T?T.isInline:S&&S.isTextblock)?-1:1)}}replaceWith(a,_){let T=a.steps.length,S=this.ranges;for(let J=0;J<S.length;J++){let{$from:G,$to:vt}=S[J],At=a.mapping.slice(T),Ht=At.map(G.pos),Wt=At.map(vt.pos);J?a.deleteRange(Ht,Wt):(a.replaceRangeWith(Ht,Wt,_),Dt(a,T,_.isInline?-1:1))}}static findFrom(a,_,T=!1){let S=a.parent.inlineContent?new N(a):xt(a.node(0),a.parent,a.pos,a.index(),_,T);if(S)return S;for(let J=a.depth-1;J>=0;J--){let G=_<0?xt(a.node(0),a.node(J),a.before(J+1),a.index(J),_,T):xt(a.node(0),a.node(J),a.after(J+1),a.index(J)+1,_,T);if(G)return G}return null}static near(a,_=1){return this.findFrom(a,_)||this.findFrom(a,-_)||new Tt(a.node(0))}static atStart(a){return xt(a,a,0,0,1)||new Tt(a)}static atEnd(a){return xt(a,a,a.content.size,a.childCount,-1)||new Tt(a)}static fromJSON(a,_){if(!_||!_.type)throw new RangeError("Invalid input for Selection.fromJSON");let T=_t[_.type];if(!T)throw new RangeError(`No selection type ${_.type} defined`);return T.fromJSON(a,_)}static jsonID(a,_){if(a in _t)throw new RangeError("Duplicate use of selection JSON ID "+a);return _t[a]=_,_.prototype.jsonID=a,_}getBookmark(){return N.between(this.$anchor,this.$head).getBookmark()}}ut.prototype.visible=!0;class ${constructor(a,_){this.$from=a,this.$to=_}}let W=!1;function Q(D){!W&&!D.parent.inlineContent&&(W=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+D.parent.type.name+")"))}class N extends ut{constructor(a,_=a){Q(a),Q(_),super(a,_)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(a,_){let T=a.resolve(_.map(this.head));if(!T.parent.inlineContent)return ut.near(T);let S=a.resolve(_.map(this.anchor));return new N(S.parent.inlineContent?S:T,T)}replace(a,_=st.p2.empty){if(super.replace(a,_),_==st.p2.empty){let T=this.$from.marksAcross(this.$to);T&&a.ensureMarks(T)}}eq(a){return a instanceof N&&a.anchor==this.anchor&&a.head==this.head}getBookmark(){return new pt(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(a,_){if("number"!=typeof _.anchor||"number"!=typeof _.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new N(a.resolve(_.anchor),a.resolve(_.head))}static create(a,_,T=_){let S=a.resolve(_);return new this(S,T==_?S:a.resolve(T))}static between(a,_,T){let S=a.pos-_.pos;if((!T||S)&&(T=S>=0?1:-1),!_.parent.inlineContent){let J=ut.findFrom(_,T,!0)||ut.findFrom(_,-T,!0);if(!J)return ut.near(_,T);_=J.$head}return a.parent.inlineContent||(0==S||(a=(ut.findFrom(a,-T,!0)||ut.findFrom(a,T,!0)).$anchor).pos<_.pos!=S<0)&&(a=_),new N(a,_)}}ut.jsonID("text",N);class pt{constructor(a,_){this.anchor=a,this.head=_}map(a){return new pt(a.map(this.anchor),a.map(this.head))}resolve(a){return N.between(a.resolve(this.anchor),a.resolve(this.head))}}class ht extends ut{constructor(a){let _=a.nodeAfter,T=a.node(0).resolve(a.pos+_.nodeSize);super(a,T),this.node=_}map(a,_){let{deleted:T,pos:S}=_.mapResult(this.anchor),J=a.resolve(S);return T?ut.near(J):new ht(J)}content(){return new st.p2(st.HY.from(this.node),0,0)}eq(a){return a instanceof ht&&a.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new gt(this.anchor)}static fromJSON(a,_){if("number"!=typeof _.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ht(a.resolve(_.anchor))}static create(a,_){return new ht(a.resolve(_))}static isSelectable(a){return!a.isText&&!1!==a.type.spec.selectable}}ht.prototype.visible=!1,ut.jsonID("node",ht);class gt{constructor(a){this.anchor=a}map(a){let{deleted:_,pos:T}=a.mapResult(this.anchor);return _?new pt(T,T):new gt(T)}resolve(a){let _=a.resolve(this.anchor),T=_.nodeAfter;return T&&ht.isSelectable(T)?new ht(_):ut.near(_)}}class Tt extends ut{constructor(a){super(a.resolve(0),a.resolve(a.content.size))}replace(a,_=st.p2.empty){if(_==st.p2.empty){a.delete(0,a.doc.content.size);let T=ut.atStart(a.doc);T.eq(a.selection)||a.setSelection(T)}else super.replace(a,_)}toJSON(){return{type:"all"}}static fromJSON(a){return new Tt(a)}map(a){return new Tt(a)}eq(a){return a instanceof Tt}getBookmark(){return ft}}ut.jsonID("all",Tt);const ft={map(){return this},resolve:D=>new Tt(D)};function xt(D,a,_,T,S,J=!1){if(a.inlineContent)return N.create(D,_);for(let G=T-(S>0?0:1);S>0?G<a.childCount:G>=0;G+=S){let vt=a.child(G);if(vt.isAtom){if(!J&&ht.isSelectable(vt))return ht.create(D,_-(S<0?vt.nodeSize:0))}else{let At=xt(D,vt,_+S,S<0?vt.childCount:0,S,J);if(At)return At}_+=vt.nodeSize*S}return null}function Dt(D,a,_){let T=D.steps.length-1;if(T<a)return;let G,S=D.steps[T];(S instanceof Et.Pu||S instanceof Et.FC)&&(D.mapping.maps[T].forEach((vt,At,Ht,Wt)=>{null==G&&(G=Wt)}),D.setSelection(ut.near(D.doc.resolve(G),_)))}function Y(D,a){return a&&D?D.bind(a):D}class ct{constructor(a,_,T){this.name=a,this.init=Y(_.init,T),this.apply=Y(_.apply,T)}}function Ot(D,a,_){for(let T in D){let S=D[T];S instanceof Function?S=S.bind(a):"handleDOMEvents"==T&&(S=Ot(S,a,{})),_[T]=S}return _}new ct("doc",{init:D=>D.doc||D.schema.topNodeType.createAndFill(),apply:D=>D.doc}),new ct("selection",{init:(D,a)=>D.selection||ut.atStart(a.doc),apply:D=>D.selection}),new ct("storedMarks",{init:D=>D.storedMarks||null,apply:(D,a,_,T)=>T.selection.$cursor?D.storedMarks:null}),new ct("scrollToSelection",{init:()=>0,apply:(D,a)=>D.scrolledIntoView?a+1:a});class It{constructor(a){this.spec=a,this.props={},a.props&&Ot(a.props,this,this.props),this.key=a.key?a.key.key:$t("plugin")}getState(a){return a[this.key]}}const Ft=Object.create(null);function $t(D){return D in Ft?D+"$"+ ++Ft[D]:(Ft[D]=0,D+"$")}class Jt{constructor(a="key"){this.key=$t(a)}get(a){return a.config.pluginsByKey[this.key]}getState(a){return a[this.key]}}const Be=/^```([a-z]+)?[\s\n]$/,be=/^~~~([a-z]+)?[\s\n]$/,Ae=g.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:D=>{var a;const{languageClassPrefix:_}=this.options;return[...(null===(a=D.firstElementChild)||void 0===a?void 0:a.classList)||[]].filter(G=>G.startsWith(_)).map(G=>G.replace(_,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:D,HTMLAttributes:a}){return["pre",(0,g.mergeAttributes)(this.options.HTMLAttributes,a),["code",{class:D.attrs.language?this.options.languageClassPrefix+D.attrs.language:null},0]]},addCommands(){return{setCodeBlock:D=>({commands:a})=>a.setNode(this.name,D),toggleCodeBlock:D=>({commands:a})=>a.toggleNode(this.name,"paragraph",D)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:D,$anchor:a}=this.editor.state.selection;return!(!D||a.parent.type.name!==this.name)&&!(1!==a.pos&&a.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:D})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:a}=D,{selection:_}=a,{$from:T,empty:S}=_;if(!S||T.parent.type!==this.type)return!1;const J=T.parentOffset===T.parent.nodeSize-2,G=T.parent.textContent.endsWith("\n\n");return!(!J||!G)&&D.chain().command(({tr:vt})=>(vt.delete(T.pos-2,T.pos),!0)).exitCode().run()},ArrowDown:({editor:D})=>{if(!this.options.exitOnArrowDown)return!1;const{state:a}=D,{selection:_,doc:T}=a,{$from:S,empty:J}=_;if(!J||S.parent.type!==this.type||S.parentOffset!==S.parent.nodeSize-2)return!1;const vt=S.after();return void 0!==vt&&!T.nodeAt(vt)&&D.commands.exitCode()}}},addInputRules(){return[(0,g.textblockTypeInputRule)({find:Be,type:this.type,getAttributes:D=>({language:D[1]})}),(0,g.textblockTypeInputRule)({find:be,type:this.type,getAttributes:D=>({language:D[1]})})]},addProseMirrorPlugins(){return[new It({key:new Jt("codeBlockVSCodeHandler"),props:{handlePaste:(D,a)=>{if(!a.clipboardData||this.editor.isActive(this.type.name))return!1;const _=a.clipboardData.getData("text/plain"),T=a.clipboardData.getData("vscode-editor-data"),S=T?JSON.parse(T):void 0,J=null==S?void 0:S.mode;if(!_||!J)return!1;const{tr:G}=D.state;return G.replaceSelectionWith(this.type.create({language:J})),G.setSelection(N.near(G.doc.resolve(Math.max(0,G.selection.from-2)))),G.insertText(_.replace(/\r\n?/g,"\n")),G.setMeta("paste",!0),D.dispatch(G),!0}}})]}}),Ce=g.Node.create({name:"doc",topNode:!0,content:"block+"});var Gt=u(62463);function pe(D={}){return new Gt.Sy({view:a=>new he(a,D)})}class he{constructor(a,_){this.editorView=a,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=_.width||1,this.color=_.color||"black",this.class=_.class,this.handlers=["dragover","dragend","drop","dragleave"].map(T=>{let S=J=>{this[T](J)};return a.dom.addEventListener(T,S),{name:T,handler:S}})}destroy(){this.handlers.forEach(({name:a,handler:_})=>this.editorView.dom.removeEventListener(a,_))}update(a,_){null!=this.cursorPos&&_.doc!=a.state.doc&&(this.cursorPos>a.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(a){a!=this.cursorPos&&(this.cursorPos=a,null==a?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let _,a=this.editorView.state.doc.resolve(this.cursorPos);if(!a.parent.inlineContent){let G=a.nodeBefore,vt=a.nodeAfter;if(G||vt){let At=this.editorView.nodeDOM(this.cursorPos-(G?G.nodeSize:0)).getBoundingClientRect(),Ht=G?At.bottom:At.top;G&&vt&&(Ht=(Ht+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),_={left:At.left,right:At.right,top:Ht-this.width/2,bottom:Ht+this.width/2}}}if(!_){let G=this.editorView.coordsAtPos(this.cursorPos);_={left:G.left-this.width/2,right:G.left+this.width/2,top:G.top,bottom:G.bottom}}let S,J,T=this.editorView.dom.offsetParent;if(this.element||(this.element=T.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!T||T==document.body&&"static"==getComputedStyle(T).position)S=-pageXOffset,J=-pageYOffset;else{let G=T.getBoundingClientRect();S=G.left-T.scrollLeft,J=G.top-T.scrollTop}this.element.style.left=_.left-S+"px",this.element.style.top=_.top-J+"px",this.element.style.width=_.right-_.left+"px",this.element.style.height=_.bottom-_.top+"px"}scheduleRemoval(a){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),a)}dragover(a){if(!this.editorView.editable)return;let _=this.editorView.posAtCoords({left:a.clientX,top:a.clientY}),T=_&&_.inside>=0&&this.editorView.state.doc.nodeAt(_.inside),S=T&&T.type.spec.disableDropCursor,J="function"==typeof S?S(this.editorView,_):S;if(_&&!J){let G=_.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(G=(0,Et.nj)(this.editorView.state.doc,G,this.editorView.dragging.slice),null==G))return this.setCursor(null);this.setCursor(G),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(a){(a.target==this.editorView.dom||!this.editorView.dom.contains(a.relatedTarget))&&this.setCursor(null)}}const oe=g.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[pe(this.options)]}});var Ne=u(13903),Xt=u(43594);class Zt extends Gt.Y1{constructor(a){super(a,a)}map(a,_){let T=a.resolve(_.map(this.head));return Zt.valid(T)?new Zt(T):Gt.Y1.near(T)}content(){return st.p2.empty}eq(a){return a instanceof Zt&&a.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(a,_){if("number"!=typeof _.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new Zt(a.resolve(_.pos))}getBookmark(){return new Ee(this.anchor)}static valid(a){let _=a.parent;if(_.isTextblock||!function(D){for(let a=D.depth;a>=0;a--){let _=D.index(a),T=D.node(a);if(0!=_)for(let S=T.child(_-1);;S=S.lastChild){if(0==S.childCount&&!S.inlineContent||S.isAtom||S.type.spec.isolating)return!0;if(S.inlineContent)return!1}else if(T.type.spec.isolating)return!0}return!0}(a)||!function(D){for(let a=D.depth;a>=0;a--){let _=D.indexAfter(a),T=D.node(a);if(_!=T.childCount)for(let S=T.child(_);;S=S.firstChild){if(0==S.childCount&&!S.inlineContent||S.isAtom||S.type.spec.isolating)return!0;if(S.inlineContent)return!1}else if(T.type.spec.isolating)return!0}return!0}(a))return!1;let T=_.type.spec.allowGapCursor;if(null!=T)return T;let S=_.contentMatchAt(a.index()).defaultType;return S&&S.isTextblock}static findGapCursorFrom(a,_,T=!1){t:for(;;){if(!T&&Zt.valid(a))return a;let S=a.pos,J=null;for(let G=a.depth;;G--){let vt=a.node(G);if(_>0?a.indexAfter(G)<vt.childCount:a.index(G)>0){J=vt.child(_>0?a.indexAfter(G):a.index(G)-1);break}if(0==G)return null;S+=_;let At=a.doc.resolve(S);if(Zt.valid(At))return At}for(;;){let G=_>0?J.firstChild:J.lastChild;if(!G){if(J.isAtom&&!J.isText&&!Gt.qv.isSelectable(J)){a=a.doc.resolve(S+J.nodeSize*_),T=!1;continue t}break}J=G,S+=_;let vt=a.doc.resolve(S);if(Zt.valid(vt))return vt}return null}}}Zt.prototype.visible=!1,Zt.findFrom=Zt.findGapCursorFrom,Gt.Y1.jsonID("gapcursor",Zt);class Ee{constructor(a){this.pos=a}map(a){return new Ee(a.map(this.pos))}resolve(a){let _=a.resolve(this.pos);return Zt.valid(_)?new Zt(_):Gt.Y1.near(_)}}const Ie=(0,Ne.$)({ArrowLeft:ee("horiz",-1),ArrowRight:ee("horiz",1),ArrowUp:ee("vert",-1),ArrowDown:ee("vert",1)});function ee(D,a){const _="vert"==D?a>0?"down":"up":a>0?"right":"left";return function(T,S,J){let G=T.selection,vt=a>0?G.$to:G.$from,At=G.empty;if(G instanceof Gt.Bs){if(!J.endOfTextblock(_)||0==vt.depth)return!1;At=!1,vt=T.doc.resolve(a>0?vt.after():vt.before())}let Ht=Zt.findGapCursorFrom(vt,a,At);return!!Ht&&(S&&S(T.tr.setSelection(new Zt(Ht))),!0)}}function te(D,a,_){if(!D||!D.editable)return!1;let T=D.state.doc.resolve(a);if(!Zt.valid(T))return!1;let S=D.posAtCoords({left:_.clientX,top:_.clientY});return!(S&&S.inside>-1&&Gt.qv.isSelectable(D.state.doc.nodeAt(S.inside))||(D.dispatch(D.state.tr.setSelection(new Zt(T))),0))}function fe(D,a){if("insertCompositionText"!=a.inputType||!(D.state.selection instanceof Zt))return!1;let{$from:_}=D.state.selection,T=_.parent.contentMatchAt(_.index()).findWrapping(D.state.schema.nodes.text);if(!T)return!1;let S=st.HY.empty;for(let G=T.length-1;G>=0;G--)S=st.HY.from(T[G].createAndFill(null,S));let J=D.state.tr.replace(_.pos,_.pos,new st.p2(S,0,0));return J.setSelection(Gt.Bs.near(J.doc.resolve(_.pos+1))),D.dispatch(J),!1}function z(D){if(!(D.selection instanceof Zt))return null;let a=document.createElement("div");return a.className="ProseMirror-gapcursor",Xt.EH.create(D.doc,[Xt.p.widget(D.selection.head,a,{key:"gapcursor"})])}const v=g.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new Gt.Sy({props:{decorations:z,createSelectionBetween:(D,a,_)=>a.pos==_.pos&&Zt.valid(_)?new Zt(_):null,handleClick:te,handleKeyDown:Ie,handleDOMEvents:{beforeinput:fe}}})],extendNodeSchema(D){var a;return{allowGapCursor:null!==(a=(0,g.callOrReturn)((0,g.getExtensionField)(D,"allowGapCursor",{name:D.name,options:D.options,storage:D.storage})))&&void 0!==a?a:null}}}),O=g.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:D}){return["br",(0,g.mergeAttributes)(this.options.HTMLAttributes,D)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:D,chain:a,state:_,editor:T})=>D.first([()=>D.exitCode(),()=>D.command(()=>{const{selection:S,storedMarks:J}=_;if(S.$from.parent.type.spec.isolating)return!1;const{keepMarks:G}=this.options,{splittableMarks:vt}=T.extensionManager,At=J||S.$to.parentOffset&&S.$from.marks();return a().insertContent({type:this.name}).command(({tr:Ht,dispatch:Wt})=>{if(Wt&&At&&G){const zt=At.filter(Vt=>vt.includes(Vt.type.name));Ht.ensureMarks(zt)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),I=g.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(D=>({tag:`h${D}`,attrs:{level:D}}))},renderHTML({node:D,HTMLAttributes:a}){return[`h${this.options.levels.includes(D.attrs.level)?D.attrs.level:this.options.levels[0]}`,(0,g.mergeAttributes)(this.options.HTMLAttributes,a),0]},addCommands(){return{setHeading:D=>({commands:a})=>!!this.options.levels.includes(D.level)&&a.setNode(this.name,D),toggleHeading:D=>({commands:a})=>!!this.options.levels.includes(D.level)&&a.toggleNode(this.name,"paragraph",D)}},addKeyboardShortcuts(){return this.options.levels.reduce((D,a)=>Me(Bt({},D),{[`Mod-Alt-${a}`]:()=>this.editor.commands.toggleHeading({level:a})}),{})},addInputRules(){return this.options.levels.map(D=>(0,g.textblockTypeInputRule)({find:new RegExp(`^(#{1,${D}})\\s$`),type:this.type,getAttributes:{level:D}}))}});var P=200,H=function(){};H.prototype.append=function(a){return a.length?(a=H.from(a),!this.length&&a||a.length<P&&this.leafAppend(a)||this.length<P&&a.leafPrepend(this)||this.appendInner(a)):this},H.prototype.prepend=function(a){return a.length?H.from(a).append(this):this},H.prototype.appendInner=function(a){return new X(this,a)},H.prototype.slice=function(a,_){return void 0===a&&(a=0),void 0===_&&(_=this.length),a>=_?H.empty:this.sliceInner(Math.max(0,a),Math.min(this.length,_))},H.prototype.get=function(a){if(!(a<0||a>=this.length))return this.getInner(a)},H.prototype.forEach=function(a,_,T){void 0===_&&(_=0),void 0===T&&(T=this.length),_<=T?this.forEachInner(a,_,T,0):this.forEachInvertedInner(a,_,T,0)},H.prototype.map=function(a,_,T){void 0===_&&(_=0),void 0===T&&(T=this.length);var S=[];return this.forEach(function(J,G){return S.push(a(J,G))},_,T),S},H.from=function(a){return a instanceof H?a:a&&a.length?new k(a):H.empty};var k=function(D){function a(T){D.call(this),this.values=T}D&&(a.__proto__=D),(a.prototype=Object.create(D&&D.prototype)).constructor=a;var _={length:{configurable:!0},depth:{configurable:!0}};return a.prototype.flatten=function(){return this.values},a.prototype.sliceInner=function(S,J){return 0==S&&J==this.length?this:new a(this.values.slice(S,J))},a.prototype.getInner=function(S){return this.values[S]},a.prototype.forEachInner=function(S,J,G,vt){for(var At=J;At<G;At++)if(!1===S(this.values[At],vt+At))return!1},a.prototype.forEachInvertedInner=function(S,J,G,vt){for(var At=J-1;At>=G;At--)if(!1===S(this.values[At],vt+At))return!1},a.prototype.leafAppend=function(S){if(this.length+S.length<=P)return new a(this.values.concat(S.flatten()))},a.prototype.leafPrepend=function(S){if(this.length+S.length<=P)return new a(S.flatten().concat(this.values))},_.length.get=function(){return this.values.length},_.depth.get=function(){return 0},Object.defineProperties(a.prototype,_),a}(H);H.empty=new k([]);var X=function(D){function a(_,T){D.call(this),this.left=_,this.right=T,this.length=_.length+T.length,this.depth=Math.max(_.depth,T.depth)+1}return D&&(a.__proto__=D),(a.prototype=Object.create(D&&D.prototype)).constructor=a,a.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},a.prototype.getInner=function(T){return T<this.left.length?this.left.get(T):this.right.get(T-this.left.length)},a.prototype.forEachInner=function(T,S,J,G){var vt=this.left.length;if(S<vt&&!1===this.left.forEachInner(T,S,Math.min(J,vt),G)||J>vt&&!1===this.right.forEachInner(T,Math.max(S-vt,0),Math.min(this.length,J)-vt,G+vt))return!1},a.prototype.forEachInvertedInner=function(T,S,J,G){var vt=this.left.length;if(S>vt&&!1===this.right.forEachInvertedInner(T,S-vt,Math.max(J,vt)-vt,G+vt)||J<vt&&!1===this.left.forEachInvertedInner(T,Math.min(S,vt),J,G))return!1},a.prototype.sliceInner=function(T,S){if(0==T&&S==this.length)return this;var J=this.left.length;return S<=J?this.left.slice(T,S):T>=J?this.right.slice(T-J,S-J):this.left.slice(T,J).append(this.right.slice(0,S-J))},a.prototype.leafAppend=function(T){var S=this.right.leafAppend(T);if(S)return new a(this.left,S)},a.prototype.leafPrepend=function(T){var S=this.left.leafPrepend(T);if(S)return new a(S,this.right)},a.prototype.appendInner=function(T){return this.left.depth>=Math.max(this.right.depth,T.depth)+1?new a(this.left,new a(this.right,T)):new a(this,T)},a}(H);const Pt=H;class wt{constructor(a,_){this.items=a,this.eventCount=_}popEvent(a,_){if(0==this.eventCount)return null;let S,J,T=this.items.length;for(;;T--)if(this.items.get(T-1).selection){--T;break}_&&(S=this.remapping(T,this.items.length),J=S.maps.length);let vt,At,G=a.tr,Ht=[],Wt=[];return this.items.forEach((zt,Vt)=>{if(!zt.step)return S||(S=this.remapping(T,Vt+1),J=S.maps.length),J--,void Wt.push(zt);if(S){Wt.push(new l(zt.map));let Te,Yt=zt.step.map(S.slice(J));Yt&&G.maybeStep(Yt).doc&&(Te=G.mapping.maps[G.mapping.maps.length-1],Ht.push(new l(Te,void 0,void 0,Ht.length+Wt.length))),J--,Te&&S.appendMap(Te,J)}else G.maybeStep(zt.step);return zt.selection?(vt=S?zt.selection.map(S.slice(J)):zt.selection,At=new wt(this.items.slice(0,T).append(Wt.reverse().concat(Ht)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:At,transform:G,selection:vt}}addTransform(a,_,T,S){let J=[],G=this.eventCount,vt=this.items,At=!S&&vt.length?vt.get(vt.length-1):null;for(let Wt=0;Wt<a.steps.length;Wt++){let Yt,zt=a.steps[Wt].invert(a.docs[Wt]),Vt=new l(a.mapping.maps[Wt],zt,_);(Yt=At&&At.merge(Vt))&&(Vt=Yt,Wt?J.pop():vt=vt.slice(0,vt.length-1)),J.push(Vt),_&&(G++,_=void 0),S||(At=Vt)}let Ht=G-T.depth;return Ht>m&&(vt=function(D,a){let _;return D.forEach((T,S)=>{if(T.selection&&0==a--)return _=S,!1}),D.slice(_)}(vt,Ht),G-=Ht),new wt(vt.append(J),G)}remapping(a,_){let T=new Et.vs;return this.items.forEach((S,J)=>{T.appendMap(S.map,null!=S.mirrorOffset&&J-S.mirrorOffset>=a?T.maps.length-S.mirrorOffset:void 0)},a,_),T}addMaps(a){return 0==this.eventCount?this:new wt(this.items.append(a.map(_=>new l(_))),this.eventCount)}rebased(a,_){if(!this.eventCount)return this;let T=[],S=Math.max(0,this.items.length-_),J=a.mapping,G=a.steps.length,vt=this.eventCount;this.items.forEach(Vt=>{Vt.selection&&vt--},S);let At=_;this.items.forEach(Vt=>{let Yt=J.getMirror(--At);if(null==Yt)return;G=Math.min(G,Yt);let Te=J.maps[Yt];if(Vt.step){let Ke=a.steps[Yt].invert(a.docs[Yt]),ve=Vt.selection&&Vt.selection.map(J.slice(At+1,Yt));ve&&vt++,T.push(new l(Te,Ke,ve))}else T.push(new l(Te))},S);let Ht=[];for(let Vt=_;Vt<G;Vt++)Ht.push(new l(J.maps[Vt]));let Wt=this.items.slice(0,S).append(Ht).append(T),zt=new wt(Wt,vt);return zt.emptyItemCount()>500&&(zt=zt.compress(this.items.length-T.length)),zt}emptyItemCount(){let a=0;return this.items.forEach(_=>{_.step||a++}),a}compress(a=this.items.length){let _=this.remapping(0,a),T=_.maps.length,S=[],J=0;return this.items.forEach((G,vt)=>{if(vt>=a)S.push(G),G.selection&&J++;else if(G.step){let At=G.step.map(_.slice(T)),Ht=At&&At.getMap();if(T--,Ht&&_.appendMap(Ht,T),At){let Wt=G.selection&&G.selection.map(_.slice(T));Wt&&J++;let Vt,zt=new l(Ht.invert(),At,Wt),Yt=S.length-1;(Vt=S.length&&S[Yt].merge(zt))?S[Yt]=Vt:S.push(zt)}}else G.map&&T--},this.items.length,0),new wt(Pt.from(S.reverse()),J)}}wt.empty=new wt(Pt.empty,0);class l{constructor(a,_,T,S){this.map=a,this.step=_,this.selection=T,this.mirrorOffset=S}merge(a){if(this.step&&a.step&&!a.selection){let _=a.step.merge(this.step);if(_)return new l(_.getMap().invert(),_,this.selection)}}}class d{constructor(a,_,T,S){this.done=a,this.undone=_,this.prevRanges=T,this.prevTime=S}}const m=20;function F(D){let a=[];return D.forEach((_,T,S,J)=>a.push(S,J)),a}function lt(D,a){if(!D)return null;let _=[];for(let T=0;T<D.length;T+=2){let S=a.map(D[T],1),J=a.map(D[T+1],-1);S<=J&&_.push(S,J)}return _}function Ct(D,a,_,T){let S=ne(a),J=ae.get(a).spec.config,G=(T?D.undone:D.done).popEvent(a,S);if(!G)return;let vt=G.selection.resolve(G.transform.doc),At=(T?D.done:D.undone).addTransform(G.transform,a.selection.getBookmark(),J,S),Ht=new d(T?At:G.remaining,T?G.remaining:At,null,0);_(G.transform.setSelection(vt).setMeta(ae,{redo:T,historyState:Ht}).scrollIntoView())}let Rt=!1,Nt=null;function ne(D){let a=D.plugins;if(Nt!=a){Rt=!1,Nt=a;for(let _=0;_<a.length;_++)if(a[_].spec.historyPreserveItems){Rt=!0;break}}return Rt}const ae=new Gt.H$("history"),Bn=new Gt.H$("closeHistory");function He(D={}){return new Gt.Sy({key:ae,state:{init:()=>new d(wt.empty,wt.empty,null,0),apply:(a,_,T)=>function(D,a,_,T){let J,S=_.getMeta(ae);if(S)return S.historyState;_.getMeta(Bn)&&(D=new d(D.done,D.undone,null,0));let G=_.getMeta("appendedTransaction");if(0==_.steps.length)return D;if(G&&G.getMeta(ae))return G.getMeta(ae).redo?new d(D.done.addTransform(_,void 0,T,ne(a)),D.undone,F(_.mapping.maps[_.steps.length-1]),D.prevTime):new d(D.done,D.undone.addTransform(_,void 0,T,ne(a)),null,D.prevTime);if(!1===_.getMeta("addToHistory")||G&&!1===G.getMeta("addToHistory"))return(J=_.getMeta("rebased"))?new d(D.done.rebased(_,J),D.undone.rebased(_,J),lt(D.prevRanges,_.mapping),D.prevTime):new d(D.done.addMaps(_.mapping.maps),D.undone.addMaps(_.mapping.maps),lt(D.prevRanges,_.mapping),D.prevTime);{let vt=0==D.prevTime||!G&&(D.prevTime<(_.time||0)-T.newGroupDelay||!function(D,a){if(!a)return!1;if(!D.docChanged)return!0;let _=!1;return D.mapping.maps[0].forEach((T,S)=>{for(let J=0;J<a.length;J+=2)T<=a[J+1]&&S>=a[J]&&(_=!0)}),_}(_,D.prevRanges)),At=G?lt(D.prevRanges,_.mapping):F(_.mapping.maps[_.steps.length-1]);return new d(D.done.addTransform(_,vt?a.selection.getBookmark():void 0,T,ne(a)),wt.empty,At,_.time)}}(_,T,a,D)},config:D={depth:D.depth||100,newGroupDelay:D.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(a,_){let T=_.inputType,S="historyUndo"==T?Nn:"historyRedo"==T?dn:null;return!!S&&(_.preventDefault(),S(a.state,a.dispatch))}}}})}const Nn=(D,a)=>{let _=ae.getState(D);return!(!_||0==_.done.eventCount||(a&&Ct(_,D,a,!1),0))},dn=(D,a)=>{let _=ae.getState(D);return!(!_||0==_.undone.eventCount||(a&&Ct(_,D,a,!0),0))},qe=g.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:D,dispatch:a})=>Nn(D,a),redo:()=>({state:D,dispatch:a})=>dn(D,a)}),addProseMirrorPlugins(){return[He(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Ue=Object.create(null);class Qt{constructor(a,_,T){this.$anchor=a,this.$head=_,this.ranges=T||[new ke(a.min(_),a.max(_))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let a=this.ranges;for(let _=0;_<a.length;_++)if(a[_].$from.pos!=a[_].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(a,_=st.p2.empty){let T=_.content.lastChild,S=null;for(let vt=0;vt<_.openEnd;vt++)S=T,T=T.lastChild;let J=a.steps.length,G=this.ranges;for(let vt=0;vt<G.length;vt++){let{$from:At,$to:Ht}=G[vt],Wt=a.mapping.slice(J);a.replaceRange(Wt.map(At.pos),Wt.map(Ht.pos),vt?st.p2.empty:_),0==vt&&je(a,J,(T?T.isInline:S&&S.isTextblock)?-1:1)}}replaceWith(a,_){let T=a.steps.length,S=this.ranges;for(let J=0;J<S.length;J++){let{$from:G,$to:vt}=S[J],At=a.mapping.slice(T),Ht=At.map(G.pos),Wt=At.map(vt.pos);J?a.deleteRange(Ht,Wt):(a.replaceRangeWith(Ht,Wt,_),je(a,T,_.isInline?-1:1))}}static findFrom(a,_,T=!1){let S=a.parent.inlineContent?new ce(a):we(a.node(0),a.parent,a.pos,a.index(),_,T);if(S)return S;for(let J=a.depth-1;J>=0;J--){let G=_<0?we(a.node(0),a.node(J),a.before(J+1),a.index(J),_,T):we(a.node(0),a.node(J),a.after(J+1),a.index(J)+1,_,T);if(G)return G}return null}static near(a,_=1){return this.findFrom(a,_)||this.findFrom(a,-_)||new ye(a.node(0))}static atStart(a){return we(a,a,0,0,1)||new ye(a)}static atEnd(a){return we(a,a,a.content.size,a.childCount,-1)||new ye(a)}static fromJSON(a,_){if(!_||!_.type)throw new RangeError("Invalid input for Selection.fromJSON");let T=Ue[_.type];if(!T)throw new RangeError(`No selection type ${_.type} defined`);return T.fromJSON(a,_)}static jsonID(a,_){if(a in Ue)throw new RangeError("Duplicate use of selection JSON ID "+a);return Ue[a]=_,_.prototype.jsonID=a,_}getBookmark(){return ce.between(this.$anchor,this.$head).getBookmark()}}Qt.prototype.visible=!0;class ke{constructor(a,_){this.$from=a,this.$to=_}}let Mn=!1;function Cn(D){!Mn&&!D.parent.inlineContent&&(Mn=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+D.parent.type.name+")"))}class ce extends Qt{constructor(a,_=a){Cn(a),Cn(_),super(a,_)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(a,_){let T=a.resolve(_.map(this.head));if(!T.parent.inlineContent)return Qt.near(T);let S=a.resolve(_.map(this.anchor));return new ce(S.parent.inlineContent?S:T,T)}replace(a,_=st.p2.empty){if(super.replace(a,_),_==st.p2.empty){let T=this.$from.marksAcross(this.$to);T&&a.ensureMarks(T)}}eq(a){return a instanceof ce&&a.anchor==this.anchor&&a.head==this.head}getBookmark(){return new tn(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(a,_){if("number"!=typeof _.anchor||"number"!=typeof _.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new ce(a.resolve(_.anchor),a.resolve(_.head))}static create(a,_,T=_){let S=a.resolve(_);return new this(S,T==_?S:a.resolve(T))}static between(a,_,T){let S=a.pos-_.pos;if((!T||S)&&(T=S>=0?1:-1),!_.parent.inlineContent){let J=Qt.findFrom(_,T,!0)||Qt.findFrom(_,-T,!0);if(!J)return Qt.near(_,T);_=J.$head}return a.parent.inlineContent||(0==S||(a=(Qt.findFrom(a,-T,!0)||Qt.findFrom(a,T,!0)).$anchor).pos<_.pos!=S<0)&&(a=_),new ce(a,_)}}Qt.jsonID("text",ce);class tn{constructor(a,_){this.anchor=a,this.head=_}map(a){return new tn(a.map(this.anchor),a.map(this.head))}resolve(a){return ce.between(a.resolve(this.anchor),a.resolve(this.head))}}class _e extends Qt{constructor(a){let _=a.nodeAfter,T=a.node(0).resolve(a.pos+_.nodeSize);super(a,T),this.node=_}map(a,_){let{deleted:T,pos:S}=_.mapResult(this.anchor),J=a.resolve(S);return T?Qt.near(J):new _e(J)}content(){return new st.p2(st.HY.from(this.node),0,0)}eq(a){return a instanceof _e&&a.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new En(this.anchor)}static fromJSON(a,_){if("number"!=typeof _.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new _e(a.resolve(_.anchor))}static create(a,_){return new _e(a.resolve(_))}static isSelectable(a){return!a.isText&&!1!==a.type.spec.selectable}}_e.prototype.visible=!1,Qt.jsonID("node",_e);class En{constructor(a){this.anchor=a}map(a){let{deleted:_,pos:T}=a.mapResult(this.anchor);return _?new tn(T,T):new En(T)}resolve(a){let _=a.resolve(this.anchor),T=_.nodeAfter;return T&&_e.isSelectable(T)?new _e(_):Qt.near(_)}}class ye extends Qt{constructor(a){super(a.resolve(0),a.resolve(a.content.size))}replace(a,_=st.p2.empty){if(_==st.p2.empty){a.delete(0,a.doc.content.size);let T=Qt.atStart(a.doc);T.eq(a.selection)||a.setSelection(T)}else super.replace(a,_)}toJSON(){return{type:"all"}}static fromJSON(a){return new ye(a)}map(a){return new ye(a)}eq(a){return a instanceof ye}getBookmark(){return Hn}}Qt.jsonID("all",ye);const Hn={map(){return this},resolve:D=>new ye(D)};function we(D,a,_,T,S,J=!1){if(a.inlineContent)return ce.create(D,_);for(let G=T-(S>0?0:1);S>0?G<a.childCount:G>=0;G+=S){let vt=a.child(G);if(vt.isAtom){if(!J&&_e.isSelectable(vt))return _e.create(D,_-(S<0?vt.nodeSize:0))}else{let At=we(D,vt,_+S,S<0?vt.childCount:0,S,J);if(At)return At}_+=vt.nodeSize*S}return null}function je(D,a,_){let T=D.steps.length-1;if(T<a)return;let G,S=D.steps[T];(S instanceof Et.Pu||S instanceof Et.FC)&&(D.mapping.maps[T].forEach((vt,At,Ht,Wt)=>{null==G&&(G=Wt)}),D.setSelection(Qt.near(D.doc.resolve(G),_)))}function yn(D,a){return a&&D?D.bind(a):D}class Re{constructor(a,_,T){this.name=a,this.init=yn(_.init,T),this.apply=yn(_.apply,T)}}new Re("doc",{init:D=>D.doc||D.schema.topNodeType.createAndFill(),apply:D=>D.doc}),new Re("selection",{init:(D,a)=>D.selection||Qt.atStart(a.doc),apply:D=>D.selection}),new Re("storedMarks",{init:D=>D.storedMarks||null,apply:(D,a,_,T)=>T.selection.$cursor?D.storedMarks:null}),new Re("scrollToSelection",{init:()=>0,apply:(D,a)=>D.scrolledIntoView?a+1:a}),Object.create(null);const to=g.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:D}){return["hr",(0,g.mergeAttributes)(this.options.HTMLAttributes,D)]},addCommands(){return{setHorizontalRule:()=>({chain:D})=>D().insertContent({type:this.name}).command(({tr:a,dispatch:_})=>{var T;if(_){const{$to:S}=a.selection,J=S.end();if(S.nodeAfter)a.setSelection(ce.create(a.doc,S.pos));else{const G=null===(T=S.parent.type.contentMatch.defaultType)||void 0===T?void 0:T.create();G&&(a.insert(J,G),a.setSelection(ce.create(a.doc,J)))}a.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,g.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),bn=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,pn=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,Un=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Fn=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,eo=g.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:D=>"normal"!==D.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:D}){return["em",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{setItalic:()=>({commands:D})=>D.setMark(this.name),toggleItalic:()=>({commands:D})=>D.toggleMark(this.name),unsetItalic:()=>({commands:D})=>D.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,g.markInputRule)({find:bn,type:this.type}),(0,g.markInputRule)({find:Un,type:this.type})]},addPasteRules(){return[(0,g.markPasteRule)({find:pn,type:this.type}),(0,g.markPasteRule)({find:Fn,type:this.type})]}}),no=g.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:D}){return["li",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Wn=/^(\d+)\.\s$/,Dn=g.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:D=>D.hasAttribute("start")?parseInt(D.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:D}){const T=D,{start:a}=T,_=zo(T,["start"]);return 1===a?["ol",(0,g.mergeAttributes)(this.options.HTMLAttributes,_),0]:["ol",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{toggleOrderedList:()=>({commands:D})=>D.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[(0,g.wrappingInputRule)({find:Wn,type:this.type,getAttributes:D=>({start:+D[1]}),joinPredicate:(D,a)=>a.childCount+a.attrs.start===+D[1]})]}}),zn=g.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:D}){return["p",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{setParagraph:()=>({commands:D})=>D.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Pn=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,ze=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Kn=g.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:D=>!!D.includes("line-through")&&{}}],renderHTML({HTMLAttributes:D}){return["s",(0,g.mergeAttributes)(this.options.HTMLAttributes,D),0]},addCommands(){return{setStrike:()=>({commands:D})=>D.setMark(this.name),toggleStrike:()=>({commands:D})=>D.toggleMark(this.name),unsetStrike:()=>({commands:D})=>D.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,g.markInputRule)({find:Pn,type:this.type})]},addPasteRules(){return[(0,g.markPasteRule)({find:ze,type:this.type})]}}),Jn=g.Node.create({name:"text",group:"inline"}),Zn=g.Extension.create({name:"starterKit",addExtensions(){var D,a,_,T,S,J,G,vt,At,Ht,Wt,zt,Vt,Yt,Te,Ke,ve,An,Sn,In,Ge,kn,hn,on,fn,mn,Je,rn,sn,ln,wn,Pe,$n,Ze,Vn,Yn;const qt=[];return!1!==(null===(D=this.options)||void 0===D?void 0:D.blockquote)&&qt.push(L.configure(null===(a=this.options)||void 0===a?void 0:a.blockquote)),!1!==(null===(_=this.options)||void 0===_?void 0:_.bold)&&qt.push(nt.configure(null===(T=this.options)||void 0===T?void 0:T.bold)),!1!==(null===(S=this.options)||void 0===S?void 0:S.bulletList)&&qt.push(at.configure(null===(J=this.options)||void 0===J?void 0:J.bulletList)),!1!==(null===(G=this.options)||void 0===G?void 0:G.code)&&qt.push(it.configure(null===(vt=this.options)||void 0===vt?void 0:vt.code)),!1!==(null===(At=this.options)||void 0===At?void 0:At.codeBlock)&&qt.push(Ae.configure(null===(Ht=this.options)||void 0===Ht?void 0:Ht.codeBlock)),!1!==(null===(Wt=this.options)||void 0===Wt?void 0:Wt.document)&&qt.push(Ce.configure(null===(zt=this.options)||void 0===zt?void 0:zt.document)),!1!==(null===(Vt=this.options)||void 0===Vt?void 0:Vt.dropcursor)&&qt.push(oe.configure(null===(Yt=this.options)||void 0===Yt?void 0:Yt.dropcursor)),!1!==(null===(Te=this.options)||void 0===Te?void 0:Te.gapcursor)&&qt.push(v.configure(null===(Ke=this.options)||void 0===Ke?void 0:Ke.gapcursor)),!1!==(null===(ve=this.options)||void 0===ve?void 0:ve.hardBreak)&&qt.push(O.configure(null===(An=this.options)||void 0===An?void 0:An.hardBreak)),!1!==(null===(Sn=this.options)||void 0===Sn?void 0:Sn.heading)&&qt.push(I.configure(null===(In=this.options)||void 0===In?void 0:In.heading)),!1!==(null===(Ge=this.options)||void 0===Ge?void 0:Ge.history)&&qt.push(qe.configure(null===(kn=this.options)||void 0===kn?void 0:kn.history)),!1!==(null===(hn=this.options)||void 0===hn?void 0:hn.horizontalRule)&&qt.push(to.configure(null===(on=this.options)||void 0===on?void 0:on.horizontalRule)),!1!==(null===(fn=this.options)||void 0===fn?void 0:fn.italic)&&qt.push(eo.configure(null===(mn=this.options)||void 0===mn?void 0:mn.italic)),!1!==(null===(Je=this.options)||void 0===Je?void 0:Je.listItem)&&qt.push(no.configure(null===(rn=this.options)||void 0===rn?void 0:rn.listItem)),!1!==(null===(sn=this.options)||void 0===sn?void 0:sn.orderedList)&&qt.push(Dn.configure(null===(ln=this.options)||void 0===ln?void 0:ln.orderedList)),!1!==(null===(wn=this.options)||void 0===wn?void 0:wn.paragraph)&&qt.push(zn.configure(null===(Pe=this.options)||void 0===Pe?void 0:Pe.paragraph)),!1!==(null===($n=this.options)||void 0===$n?void 0:$n.strike)&&qt.push(Kn.configure(null===(Ze=this.options)||void 0===Ze?void 0:Ze.strike)),!1!==(null===(Vn=this.options)||void 0===Vn?void 0:Vn.text)&&qt.push(Jn.configure(null===(Yn=this.options)||void 0===Yn?void 0:Yn.text)),qt}})},51919:(St,dt,u)=>{u.r(dt),u.d(dt,{TableCellBackground:()=>s});const s=u(40256).Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:L})=>L?{style:`background: ${L}`}:null,parseHTML:({style:L})=>L.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:L=>({chain:y})=>y().updateAttributes("tableCell",{background:L}).updateAttributes("tableHeader",{background:L}).run(),unsetCellBackground:()=>({chain:L})=>L().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})})},88806:(St,dt,u)=>{u.d(dt,{v:()=>s});var g=u(74788);class s{constructor(y,f,q){const b=f.get(g.z2F),j=f.get(g._Vd).resolveComponentFactory(y);this.componentRef=j.create(f,[]),this.updateProps(q),b.attachView(this.componentRef.hostView)}get instance(){return this.componentRef.instance}get elementRef(){return this.componentRef.injector.get(g.SBq)}get dom(){return this.elementRef.nativeElement}updateProps(y){Object.entries(y).forEach(([f,q])=>{this.instance[f]=q})}detectChanges(){this.componentRef.changeDetectorRef.detectChanges()}destroy(){this.componentRef.destroy()}}},40400:(St,dt,u)=>{u.d(dt,{d:()=>y,x:()=>q});var g=u(12057),s=u(40256),L=u(88806);class y{}class f extends s.NodeView{constructor(){super(...arguments),this.contentDOMElement=null}mount(){const nt=this.options.injector,j=nt.get(g.K0);this.renderer=new L.v(this.component,nt,{editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(et={})=>this.updateAttributes(et),deleteNode:()=>this.deleteNode()}),this.extension.config.draggable&&(this.renderer.elementRef.nativeElement.ondragstart=et=>{this.onDragStart(et)}),this.contentDOMElement=this.node.isLeaf?null:j.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit",this.renderer.detectChanges())}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}update(nt,j){return this.options.update?this.options.update(nt,j):nt.type===this.node.type&&(nt===this.node&&this.decorations===j||(this.node=nt,this.decorations=j,this.renderer.updateProps({node:nt,decorations:j}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy()}maybeMoveContentDOM(){const nt=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&nt&&!nt.contains(this.contentDOMElement)&&nt.appendChild(this.contentDOMElement)}}const q=(b,nt)=>j=>new f(b,j,nt)},70224:(St,dt,u)=>{u.r(dt),u.d(dt,{BackgroundColor:()=>pt.BackgroundColor,EDITOR_BLANK_COLOR:()=>Q.hK,FontColor:()=>gt.FontColor,INITIALIZATION_TIPTAP_CONTAINER:()=>Y.Y1,LAZY_EDITOR_EXTENSIONS:()=>Y.F4,LAZY_TIPTAP_EDITOR:()=>Y.bG,StarterKit:()=>Ut.StarterKit,TIPTAP_EDITOR:()=>Y.ZW,TUI_EDITOR_CODE_OPTIONS:()=>Y.Mr,TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES:()=>Y.dj,TUI_EDITOR_CONTENT_PROCESSOR:()=>Y.F1,TUI_EDITOR_DEFAULT_OPTIONS:()=>Y.HG,TUI_EDITOR_EXTENSIONS:()=>Y.Wf,TUI_EDITOR_FONT_OPTIONS:()=>Y.UN,TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>ft.TUI_EDITOR_GROUP_DEFAULT_OPTIONS,TUI_EDITOR_MAX_IMAGE_WIDTH:()=>xt.TUI_EDITOR_MAX_IMAGE_WIDTH,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>xt.TUI_EDITOR_MIN_IMAGE_WIDTH,TUI_EDITOR_OPTIONS:()=>Y.mJ,TUI_EDITOR_PROVIDERS:()=>it.m,TUI_EDITOR_TABLE_COMMANDS:()=>Y.$i,TUI_EDITOR_TOOLBAR_TEXTS:()=>Y.rf,TUI_IMAGE_LOADER:()=>Y.p7,TableCellBackground:()=>ot.TableCellBackground,TuiAlignContentComponent:()=>W.Xp,TuiAlignContentModule:()=>W.pu,TuiCodeComponent:()=>W.Tf,TuiCodeModule:()=>W.P_,TuiColorEditComponent:()=>g.hR,TuiColorEditModule:()=>g.TD,TuiColorPickerComponent:()=>g.$v,TuiColorPickerModule:()=>g.H9,TuiColorSelectorComponent:()=>g.sV,TuiColorSelectorModule:()=>g.wl,TuiComponentRenderer:()=>x.v,TuiDetailsComponent:()=>W.yj,TuiDetailsModule:()=>W.y9,TuiDetailsRemoveComponent:()=>W.Un,TuiEditLinkComponent:()=>s.l,TuiEditLinkModule:()=>s.F,TuiEditorComponent:()=>L.a,TuiEditorGroupToolComponent:()=>W.dN,TuiEditorImagePreviewDirective:()=>j.Zj,TuiEditorImagePreviewModule:()=>j.BN,TuiEditorModule:()=>mt,TuiEditorPortalDirective:()=>st.A,TuiEditorPortalHostComponent:()=>_t.d,TuiEditorPortalService:()=>Et.Y,TuiEditorSocketComponent:()=>f.D,TuiEditorSocketModule:()=>b,TuiEditorTool:()=>N._,TuiEditorToolGroup:()=>W.jP,TuiFlatPickerComponent:()=>g.Jd,TuiFlatPickerModule:()=>g.ui,TuiFontSize:()=>Tt.TuiFontSize,TuiFontSizeComponent:()=>W.mK,TuiFontSizeModule:()=>W.p7,TuiFontStyleComponent:()=>W.hr,TuiFontStyleModule:()=>W.Zv,TuiHighlightColorComponent:()=>W.UT,TuiHighlightColorModule:()=>W.XC,TuiImageEditorComponent:()=>xt.TuiImageEditorComponent,TuiImageEditorModule:()=>xt.TuiImageEditorModule,TuiInputColorComponent:()=>ut.j,TuiInputColorModule:()=>$,TuiLinearMultiPickerComponent:()=>g.es,TuiLinearMultiPickerModule:()=>g.GU,TuiLinearPickerComponent:()=>g.P,TuiLinearPickerModule:()=>g.g7,TuiListConfigsComponent:()=>W.w2,TuiListConfigsModule:()=>W.Ur,TuiNodeViewNgComponent:()=>Z.d,TuiNodeViewRenderer:()=>Z.x,TuiPaletteComponent:()=>g.Rh,TuiPaletteModule:()=>g.VM,TuiTabExtension:()=>Dt.TuiTabExtension,TuiTableCellColorComponent:()=>W.pH,TuiTableCellColorModule:()=>W.mp,TuiTableCommands:()=>W.iN,TuiTableCreateComponent:()=>W.lT,TuiTableCreateModule:()=>W.iA,TuiTableMergeCellsComponent:()=>W.YH,TuiTableMergeCellsModule:()=>W.er,TuiTableRowColumnManagerComponent:()=>W._I,TuiTableRowColumnManagerModule:()=>W.__,TuiTableSizeSelectorComponent:()=>W.M8,TuiTableSizeSelectorModule:()=>W.kU,TuiTextColorComponent:()=>W.G0,TuiTextColorModule:()=>W._t,TuiTiptapEditorDirective:()=>j.JU,TuiTiptapEditorModule:()=>j.mJ,TuiTiptapEditorService:()=>j.$3,TuiToolbarComponent:()=>nt.M6,TuiToolbarModule:()=>nt.yB,TuiToolbarNavigationManagerDirective:()=>nt.Bp,createGroupExtension:()=>ft.createGroupExtension,createImageEditorExtension:()=>xt.createImageEditorExtension,defaultEditorColors:()=>Q.sw,defaultEditorExtensions:()=>ht,defaultEditorTools:()=>Q.Db,tuiDefaultFontOptionsHandler:()=>Q.RR,tuiDeleteNode:()=>ct.yU,tuiEditorOptionsProvider:()=>Y.Uv,tuiGetElementPoint:()=>ct.Ws,tuiGetGradientData:()=>ct.U5,tuiGetMarkRange:()=>ct.Yz,tuiGetSelectedContent:()=>ct.Ap,tuiInsertHtml:()=>ct.Xd,tuiInsertText:()=>ct.Oi,tuiIsOrderedOrBulletList:()=>Dt.tuiIsOrderedOrBulletList,tuiIsSafeLinkRange:()=>ct.nC,tuiIsSelectionIn:()=>ct.i0,tuiLegacyEditorConverter:()=>ct.Er,tuiParseGradient:()=>ct._N,tuiToGradient:()=>ct.CH});var g=u(27050),s=u(71115),L=u(69303),y=u(12057),f=u(20179),q=u(74788);let b=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=q.oAB({type:R}),R.\u0275inj=q.cJS({}),R})();var nt=u(17406),j=u(40632),at=u(36692),et=u(72002);let mt=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=q.oAB({type:R}),R.\u0275inj=q.cJS({imports:[[y.ez,nt.yB,et.TuiWrapperModule,et.TuiScrollbarModule,s.F,at.TuiActiveZoneModule,et.TuiDropdownModule,j.mJ,b,at.TuiLetModule]]}),R})();var it=u(79089),st=u(1433),Et=u(73825),_t=u(9872),ut=u(19769);let $=(()=>{class R{}return R.\u0275fac=function(tt){return new(tt||R)},R.\u0275mod=q.oAB({type:R}),R.\u0275inj=q.cJS({imports:[[y.ez,et.TuiPrimitiveTextfieldModule,et.TuiTextfieldControllerModule,et.TuiHostedDropdownModule,g.wl,at.TuiActiveZoneModule]]}),R})();var W=u(93252),Q=u(19074),N=u(48699),pt=u(15736);const ht=[Promise.resolve().then(u.bind(u,80726)).then(({StarterKit:R})=>R).then(R=>R.configure({heading:{levels:[1,2]}})),u.e(45861).then(u.bind(u,45861)).then(({default:R})=>R.configure({types:["heading","paragraph"]})),Promise.resolve().then(u.bind(u,74634)).then(({default:R})=>R),u.e(77008).then(u.bind(u,77008)).then(({default:R})=>R),u.e(91347).then(u.bind(u,91347)).then(({default:R})=>R),u.e(35609).then(u.bind(u,35609)).then(({default:R})=>R),Promise.resolve().then(u.bind(u,52658)).then(({FontColor:R})=>R),u.e(12955).then(u.bind(u,12955)).then(({default:R})=>R.configure({inline:!0})),u.e(63658).then(u.bind(u,63658)).then(({default:R})=>R.configure({openOnClick:!1})),Promise.resolve().then(u.bind(u,15736)).then(({BackgroundColor:R})=>R),u.e(88729).then(u.bind(u,88729)).then(({default:R})=>R.configure({resizable:!0,lastColumnResizable:!1})),u.e(72219).then(u.bind(u,72219)).then(({default:R})=>R),u.e(74096).then(u.bind(u,74096)).then(({default:R})=>R),u.e(53107).then(u.bind(u,53107)).then(({TableHeader:R})=>R),Promise.resolve().then(u.bind(u,12177)).then(({TuiTabExtension:R})=>R),Promise.resolve().then(u.bind(u,51919)).then(({TableCellBackground:R})=>R),u.e(44312).then(u.bind(u,44312)).then(({TuiDetailsContent:R})=>R),u.e(44312).then(u.bind(u,44312)).then(({TuiDetails:R})=>R),u.e(44312).then(u.bind(u,44312)).then(({TuiSummary:R})=>R),Promise.resolve().then(u.bind(u,9492)).then(({TuiFontSize:R})=>R)];var gt=u(52658),Tt=u(9492),ft=u(54920),xt=u(25039),Dt=u(12177),Ut=u(80726),ot=u(51919),x=u(88806),Z=u(40400),Y=u(62842),ct=u(37631)},62141:(St,dt,u)=>{u.d(dt,{i:()=>at});var g=u(12057),s=u(74788),L=u(37631),y=u(36692),f=u(18891),q=u(43190),b=u(88002),nt=u(46782),j=u(39761);let at=(()=>{class et extends f.y{constructor(it,{nativeElement:st},Et){const _t=(0,y.tuiTypedFromEvent)(st,"mousedown").pipe((0,y.tuiPreventDefault)(),(0,q.w)(ut=>{const $=(0,y.tuiTypedFromEvent)(Et,"mousemove").pipe((0,b.U)(({clientX:W,clientY:Q})=>(0,L.Ws)(W,Q,st)),(0,nt.R)((0,y.tuiTypedFromEvent)(Et,"mouseup")));return ut.target===st?$.pipe((0,j.O)((0,L.Ws)(ut.clientX,ut.clientY,st))):$}),(0,nt.R)(it));super(ut=>_t.subscribe(ut))}}return et.\u0275fac=function(it){return new(it||et)(s.LFG(y.TuiDestroyService),s.LFG(s.SBq),s.LFG(g.K0))},et.\u0275prov=s.Yz7({token:et,factory:et.\u0275fac}),et})()},62842:(St,dt,u)=>{u.d(dt,{Y1:()=>pt,F4:()=>L,bG:()=>N,ZW:()=>Q,Mr:()=>st,dj:()=>et,F1:()=>j,HG:()=>f,Wf:()=>s,UN:()=>Et,mJ:()=>q,$i:()=>it,rf:()=>mt,p7:()=>$,Uv:()=>b});var g=u(74788);const s=new g.OlP("[TUI_EDITOR_EXTENSIONS]: Extensions for editor"),L=new g.OlP("[LAZY_EDITOR_EXTENSIONS]: lazy extensions");var y=u(19074);const f={colors:y.sw,blankColor:y.hK,fontOptions:y.RR},q=new g.OlP("[TUI_EDITOR_OPTIONS]: Default Editor colors",{factory:()=>f});function b(ht){return{provide:q,useValue:Object.assign(Object.assign({},f),ht)}}var nt=u(54487);const j=new g.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]: Content value processor for tui-editor",{factory:()=>nt.y});var at=u(72773);const et=new g.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]: tui-color-selector i18n",{factory:()=>["Solid color","Gradient"]}),mt=new g.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]: tui-editor-toolbar i18n",{factory:(0,at.vv)("toolbarTools")}),it=new g.OlP("[TUI_EDITOR_TABLE_COMMANDS]: tui-editor-toolbar table i18n",{factory:(0,at.vv)("editorTableCommands")}),st=new g.OlP("[TUI_EDITOR_CODE_OPTIONS]: tui-editor-toolbar codes options",{factory:(0,at.vv)("editorCodeOptions")}),Et=new g.OlP("[TUI_EDITOR_FONT_OPTIONS]: tui-editor-toolbar font options",{factory:(0,at.vv)("editorFontOptions")});var _t=u(36692),ut=u(88002);const $=new g.OlP("[TUI_IMAGE_LOADER]: Image loader handler",{factory:()=>ht=>{const gt=new FileReader;return gt.readAsDataURL(ht),(0,_t.tuiTypedFromEvent)(gt,"load").pipe((0,ut.U)(()=>String(gt.result)))}});var W=u(82298);const Q=new g.OlP("[TIPTAP_EDITOR]: Token for Tiptap Editor"),N=new g.OlP("[LAZY_TIPTAP_EDITOR]: Lazy loaded Editor",{factory:()=>{const ht=new W.t(1);return Promise.resolve().then(u.bind(u,40256)).then(gt=>ht.next(gt.Editor)),ht}}),pt=new g.OlP("[INITIALIZATION_TIPTAP_CONTAINER]: The container in which the tip-tap editor is initialized")},37631:(St,dt,u)=>{function g(ot,x,Z){const Y=ot.selection.$anchor;for(let ct=Y.depth;ct>0;ct--)if(Y.node(ct).type.name===Z)return x&&x(ot.tr.delete(Y.before(ct),Y.after(ct)).scrollIntoView()),!0;return!1}u.d(dt,{yU:()=>g,Ws:()=>L,U5:()=>y,Yz:()=>b,Ap:()=>j,Xd:()=>at,Oi:()=>et,nC:()=>Dt,i0:()=>mt,Er:()=>it,_N:()=>ft,CH:()=>Ut});var s=u(36692);function L(ot,x,Z){const{left:Y,top:ct,width:R,height:V}=Z.getBoundingClientRect();return[(0,s.tuiClamp)(ot-Y,0,R)/R,(0,s.tuiClamp)(x-ct,0,V)/V]}function y(ot){return ot.slice(0,Math.max(0,ot.length-1)).replace("linear-gradient(","")}function q(ot,x,Z={}){return ot.find(({attrs:Y,type:ct})=>ct===x&&function(ot,x){const Z=Object.keys(x);return!Z.length||!!Z.filter(Y=>x[Y]===ot[Y]).length}(Y,Z))||null}function b(ot,x,Z={}){if(!ot||!x)return null;const{node:Y,offset:ct}=ot.parent.childAfter(ot.parentOffset);if(!Y)return null;const R=q(Y.marks,x,Z);if(!R)return null;let V=ot.index(),tt=ot.start()+ct,Ot=V+1,It=tt+Y.nodeSize;for(q(Y.marks,x,Z);V>0&&R.isInSet(ot.parent.child(V-1).marks);)V-=1,tt-=ot.parent.child(V).nodeSize;for(;Ot<ot.parent.childCount&&q(ot.parent.child(Ot).marks,x,Z);)It+=ot.parent.child(Ot).nodeSize,Ot+=1;return{from:tt,to:It}}var nt=u(40256);function j(ot,x){const Z=null!=x?x:ot.selection.$head.parent.textContent,Y=ot.doc.cut(ot.selection.from,ot.selection.to);return Y.content.size?(0,nt.getHTMLFromFragment)(Y.content,ot.schema):Z}function at(ot,x){if(ot.queryCommandSupported("insertHTML"))return void ot.execCommand("insertHTML",!1,x);const Z=ot.getSelection();if(!Z)throw new s.TuiDocumentSelectionException;ot.execCommand("ms-beginUndoUnit");const Y=Z.getRangeAt(0),ct=Y.createContextualFragment(x);Y.deleteContents(),Y.insertNode(ct),ot.execCommand("ms-endUndoUnit")}function et(ot,x){if(ot.queryCommandSupported("insertText"))return void ot.execCommand("insertText",!1,x);const Z=ot.getSelection();if(!Z)throw new s.TuiDocumentSelectionException;ot.execCommand("ms-beginUndoUnit");const Y=Z.getRangeAt(0);Y.deleteContents(),Y.insertNode(ot.createTextNode(x)),ot.execCommand("ms-endUndoUnit")}function mt({anchorNode:ot,focusNode:x},Z){return!!ot&&!!x&&(0,s.tuiIsNodeIn)(ot,Z)&&(0,s.tuiIsNodeIn)(x,Z)}function it(ot){const x=(new DOMParser).parseFromString(ot,"text/html");return st(x.body),x.body.innerHTML}function st(ot){for(const x of Array.from(ot.children))if(x.children.length&&st(x),"FONT"===x.tagName)if(x.hasAttribute("size"))switch(x.getAttribute("size")){case"6":Et("h1",x);break;case"5":Et("h2",x);break;case"4":_t("17px",x);break;case"3":_t("15px",x);break;case"2":_t("13px",x)}else x.hasAttribute("color")&&ut(x)}function Et(ot,x){var Z,Y,ct,R,V,tt,Ot,It,Ft;const $t=document.createElement(ot);if($t.innerHTML=x.innerHTML,"P"===(null===(Z=x.parentElement)||void 0===Z?void 0:Z.tagName)){const Jt=null===(ct=null===(Y=x.parentElement)||void 0===Y?void 0:Y.parentElement)||void 0===ct?void 0:ct.insertBefore($t,x.parentElement);null===(R=x.parentElement)||void 0===R||R.removeChild(x),(null==Jt?void 0:Jt.nextSibling)&&!(null===(tt=null===(V=null==Jt?void 0:Jt.nextSibling)||void 0===V?void 0:V.textContent)||void 0===tt?void 0:tt.trim())&&(null===(It=null===(Ot=Jt.nextSibling)||void 0===Ot?void 0:Ot.parentElement)||void 0===It||It.removeChild(Jt.nextSibling))}else null===(Ft=x.parentElement)||void 0===Ft||Ft.replaceChild($t,x)}function _t(ot,x){var Z;const Y=document.createElement("p"),ct=document.createElement("span");ct.setAttribute("style",`font-size: ${ot}`),ct.innerHTML=x.innerHTML,Y.append(ct),null===(Z=x.parentElement)||void 0===Z||Z.replaceChild("P"===x.parentElement.tagName?ct:Y,x)}function ut(ot){var x;const Z=document.createElement("span");Z.setAttribute("style",`color: ${ot.getAttribute("color")}`),Z.innerHTML=ot.innerHTML,null===(x=ot.parentElement)||void 0===x||x.replaceChild(Z,ot)}const Tt=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function ft(ot){const x=new RegExp(Tt.join(""),"gi"),Z=ot.startsWith("to")||ot.match(/^\d/)?ot.slice(Math.max(0,ot.indexOf(",")+1)).trim():ot,Y=ot.startsWith("to")?ot.split(",")[0]:"to bottom";let ct=[],R=x.exec(Z);for(;null!==R;)ct=ct.concat({color:R[1],position:xt(R[2],ct.length)}),R=x.exec(Z);return ct=ct.filter(({color:V})=>V.startsWith("#")||V.startsWith("rgb")),{stops:ct,side:Y}}function xt(ot,x){const Z=1===x?"100%":`${x}%`;return(null==ot?void 0:ot.includes("%"))?ot:Z}function Dt(ot){var x;return ot.endOffset-ot.startOffset>0||0!==ot.startOffset&&ot.endOffset!==((null===(x=ot.endContainer.nodeValue)||void 0===x?void 0:x.length)||0)}function Ut({stops:ot,side:x}){return`linear-gradient(${x}, ${ot.map(({color:Z,position:Y})=>`rgba(${(0,s.tuiParseColor)(Z).join(", ")}) ${Y}`).join(", ")})`}},13903:(St,dt,u)=>{u.d(dt,{$:()=>ut,h:()=>_t});for(var g={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},L="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),f=("undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)),q="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),b=f||L&&+L[1]<57,nt=0;nt<10;nt++)g[48+nt]=g[96+nt]=String(nt);for(nt=1;nt<=24;nt++)g[nt+111]="F"+nt;for(nt=65;nt<=90;nt++)g[nt]=String.fromCharCode(nt+32),s[nt]=String.fromCharCode(nt);for(var j in g)s.hasOwnProperty(j)||(s[j]=g[j]);var et=u(62463);const mt="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function it($){let N,pt,ht,gt,W=$.split(/-(?!$)/),Q=W[W.length-1];"Space"==Q&&(Q=" ");for(let Tt=0;Tt<W.length-1;Tt++){let ft=W[Tt];if(/^(cmd|meta|m)$/i.test(ft))gt=!0;else if(/^a(lt)?$/i.test(ft))N=!0;else if(/^(c|ctrl|control)$/i.test(ft))pt=!0;else if(/^s(hift)?$/i.test(ft))ht=!0;else{if(!/^mod$/i.test(ft))throw new Error("Unrecognized modifier name: "+ft);mt?gt=!0:pt=!0}}return N&&(Q="Alt-"+Q),pt&&(Q="Ctrl-"+Q),gt&&(Q="Meta-"+Q),ht&&(Q="Shift-"+Q),Q}function Et($,W,Q){return W.altKey&&($="Alt-"+$),W.ctrlKey&&($="Ctrl-"+$),W.metaKey&&($="Meta-"+$),!1!==Q&&W.shiftKey&&($="Shift-"+$),$}function _t($){return new et.Sy({props:{handleKeyDown:ut($)}})}function ut($){let W=function($){let W=Object.create(null);for(let Q in $)W[it(Q)]=$[Q];return W}($);return function(Q,N){let gt,pt=function($){var Q=!(b&&($.ctrlKey||$.altKey||$.metaKey)||q&&$.shiftKey&&$.key&&1==$.key.length||"Unidentified"==$.key)&&$.key||($.shiftKey?s:g)[$.keyCode]||$.key||"Unidentified";return"Esc"==Q&&(Q="Escape"),"Del"==Q&&(Q="Delete"),"Left"==Q&&(Q="ArrowLeft"),"Up"==Q&&(Q="ArrowUp"),"Right"==Q&&(Q="ArrowRight"),"Down"==Q&&(Q="ArrowDown"),Q}(N),ht=1==pt.length&&" "!=pt,Tt=W[Et(pt,N,!ht)];if(Tt&&Tt(Q.state,Q.dispatch,Q))return!0;if(ht&&(N.shiftKey||N.altKey||N.metaKey||pt.charCodeAt(0)>127)&&(gt=g[N.keyCode])&&gt!=pt){let ft=W[Et(gt,N,!0)];if(ft&&ft(Q.state,Q.dispatch,Q))return!0}else if(ht&&N.shiftKey){let ft=W[Et(pt,N,!0)];if(ft&&ft(Q.state,Q.dispatch,Q))return!0}return!1}}},35917:(St,dt,u)=>{function g(w){this.content=w}u.d(dt,{aw:()=>le,PW:()=>Pt,HY:()=>f,vc:()=>j,ZU:()=>Xt,NB:()=>ot,Ts:()=>Dt,e4:()=>at,V_:()=>Zt,p2:()=>et}),g.prototype={constructor:g,find:function(w){for(var l=0;l<this.content.length;l+=2)if(this.content[l]===w)return l;return-1},get:function(w){var l=this.find(w);return-1==l?void 0:this.content[l+1]},update:function(w,l,d){var m=d&&d!=w?this.remove(d):this,E=m.find(w),A=m.content.slice();return-1==E?A.push(d||w,l):(A[E+1]=l,d&&(A[E]=d)),new g(A)},remove:function(w){var l=this.find(w);if(-1==l)return this;var d=this.content.slice();return d.splice(l,2),new g(d)},addToStart:function(w,l){return new g([w,l].concat(this.remove(w).content))},addToEnd:function(w,l){var d=this.remove(w).content.slice();return d.push(w,l),new g(d)},addBefore:function(w,l,d){var m=this.remove(l),E=m.content.slice(),A=m.find(w);return E.splice(-1==A?E.length:A,0,l,d),new g(E)},forEach:function(w){for(var l=0;l<this.content.length;l+=2)w(this.content[l],this.content[l+1])},prepend:function(w){return(w=g.from(w)).size?new g(w.content.concat(this.subtract(w).content)):this},append:function(w){return(w=g.from(w)).size?new g(this.subtract(w).content.concat(w.content)):this},subtract:function(w){var l=this;w=g.from(w);for(var d=0;d<w.content.length;d+=2)l=l.remove(w.content[d]);return l},toObject:function(){var w={};return this.forEach(function(l,d){w[l]=d}),w},get size(){return this.content.length>>1}},g.from=function(w){if(w instanceof g)return w;var l=[];if(w)for(var d in w)l.push(d,w[d]);return new g(l)};const s=g;function L(w,l,d){for(let m=0;;m++){if(m==w.childCount||m==l.childCount)return w.childCount==l.childCount?null:d;let E=w.child(m),A=l.child(m);if(E!=A){if(!E.sameMarkup(A))return d;if(E.isText&&E.text!=A.text){for(let F=0;E.text[F]==A.text[F];F++)d++;return d}if(E.content.size||A.content.size){let F=L(E.content,A.content,d+1);if(null!=F)return F}d+=E.nodeSize}else d+=E.nodeSize}}function y(w,l,d,m){for(let E=w.childCount,A=l.childCount;;){if(0==E||0==A)return E==A?null:{a:d,b:m};let F=w.child(--E),lt=l.child(--A),Ct=F.nodeSize;if(F!=lt){if(!F.sameMarkup(lt))return{a:d,b:m};if(F.isText&&F.text!=lt.text){let Rt=0,Nt=Math.min(F.text.length,lt.text.length);for(;Rt<Nt&&F.text[F.text.length-Rt-1]==lt.text[lt.text.length-Rt-1];)Rt++,d--,m--;return{a:d,b:m}}if(F.content.size||lt.content.size){let Rt=y(F.content,lt.content,d-1,m-1);if(Rt)return Rt}d-=Ct,m-=Ct}else d-=Ct,m-=Ct}}class f{constructor(l,d){if(this.content=l,this.size=d||0,null==d)for(let m=0;m<l.length;m++)this.size+=l[m].nodeSize}nodesBetween(l,d,m,E=0,A){for(let F=0,lt=0;lt<d;F++){let Ct=this.content[F],Rt=lt+Ct.nodeSize;if(Rt>l&&!1!==m(Ct,E+lt,A||null,F)&&Ct.content.size){let Nt=lt+1;Ct.nodesBetween(Math.max(0,l-Nt),Math.min(Ct.content.size,d-Nt),m,E+Nt)}lt=Rt}}descendants(l){this.nodesBetween(0,this.size,l)}textBetween(l,d,m,E){let A="",F=!0;return this.nodesBetween(l,d,(lt,Ct)=>{lt.isText?(A+=lt.text.slice(Math.max(l,Ct)-Ct,d-Ct),F=!m):lt.isLeaf?(E?A+="function"==typeof E?E(lt):E:lt.type.spec.leafText&&(A+=lt.type.spec.leafText(lt)),F=!m):!F&&lt.isBlock&&(A+=m,F=!0)},0),A}append(l){if(!l.size)return this;if(!this.size)return l;let d=this.lastChild,m=l.firstChild,E=this.content.slice(),A=0;for(d.isText&&d.sameMarkup(m)&&(E[E.length-1]=d.withText(d.text+m.text),A=1);A<l.content.length;A++)E.push(l.content[A]);return new f(E,this.size+l.size)}cut(l,d=this.size){if(0==l&&d==this.size)return this;let m=[],E=0;if(d>l)for(let A=0,F=0;F<d;A++){let lt=this.content[A],Ct=F+lt.nodeSize;Ct>l&&((F<l||Ct>d)&&(lt=lt.isText?lt.cut(Math.max(0,l-F),Math.min(lt.text.length,d-F)):lt.cut(Math.max(0,l-F-1),Math.min(lt.content.size,d-F-1))),m.push(lt),E+=lt.nodeSize),F=Ct}return new f(m,E)}cutByIndex(l,d){return l==d?f.empty:0==l&&d==this.content.length?this:new f(this.content.slice(l,d))}replaceChild(l,d){let m=this.content[l];if(m==d)return this;let E=this.content.slice(),A=this.size+d.nodeSize-m.nodeSize;return E[l]=d,new f(E,A)}addToStart(l){return new f([l].concat(this.content),this.size+l.nodeSize)}addToEnd(l){return new f(this.content.concat(l),this.size+l.nodeSize)}eq(l){if(this.content.length!=l.content.length)return!1;for(let d=0;d<this.content.length;d++)if(!this.content[d].eq(l.content[d]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(l){let d=this.content[l];if(!d)throw new RangeError("Index "+l+" out of range for "+this);return d}maybeChild(l){return this.content[l]||null}forEach(l){for(let d=0,m=0;d<this.content.length;d++){let E=this.content[d];l(E,m,d),m+=E.nodeSize}}findDiffStart(l,d=0){return L(this,l,d)}findDiffEnd(l,d=this.size,m=l.size){return y(this,l,d,m)}findIndex(l,d=-1){if(0==l)return b(0,l);if(l==this.size)return b(this.content.length,l);if(l>this.size||l<0)throw new RangeError(`Position ${l} outside of fragment (${this})`);for(let m=0,E=0;;m++){let F=E+this.child(m).nodeSize;if(F>=l)return F==l||d>0?b(m+1,F):b(m,E);E=F}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(l=>l.toJSON()):null}static fromJSON(l,d){if(!d)return f.empty;if(!Array.isArray(d))throw new RangeError("Invalid input for Fragment.fromJSON");return new f(d.map(l.nodeFromJSON))}static fromArray(l){if(!l.length)return f.empty;let d,m=0;for(let E=0;E<l.length;E++){let A=l[E];m+=A.nodeSize,E&&A.isText&&l[E-1].sameMarkup(A)?(d||(d=l.slice(0,E)),d[d.length-1]=A.withText(d[d.length-1].text+A.text)):d&&d.push(A)}return new f(d||l,m)}static from(l){if(!l)return f.empty;if(l instanceof f)return l;if(Array.isArray(l))return this.fromArray(l);if(l.attrs)return new f([l],l.nodeSize);throw new RangeError("Can not convert "+l+" to a Fragment"+(l.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}f.empty=new f([],0);const q={index:0,offset:0};function b(w,l){return q.index=w,q.offset=l,q}function nt(w,l){if(w===l)return!0;if(!w||"object"!=typeof w||!l||"object"!=typeof l)return!1;let d=Array.isArray(w);if(Array.isArray(l)!=d)return!1;if(d){if(w.length!=l.length)return!1;for(let m=0;m<w.length;m++)if(!nt(w[m],l[m]))return!1}else{for(let m in w)if(!(m in l)||!nt(w[m],l[m]))return!1;for(let m in l)if(!(m in w))return!1}return!0}let j=(()=>{class w{constructor(d,m){this.type=d,this.attrs=m}addToSet(d){let m,E=!1;for(let A=0;A<d.length;A++){let F=d[A];if(this.eq(F))return d;if(this.type.excludes(F.type))m||(m=d.slice(0,A));else{if(F.type.excludes(this.type))return d;!E&&F.type.rank>this.type.rank&&(m||(m=d.slice(0,A)),m.push(this),E=!0),m&&m.push(F)}}return m||(m=d.slice()),E||m.push(this),m}removeFromSet(d){for(let m=0;m<d.length;m++)if(this.eq(d[m]))return d.slice(0,m).concat(d.slice(m+1));return d}isInSet(d){for(let m=0;m<d.length;m++)if(this.eq(d[m]))return!0;return!1}eq(d){return this==d||this.type==d.type&&nt(this.attrs,d.attrs)}toJSON(){let d={type:this.type.name};for(let m in this.attrs){d.attrs=this.attrs;break}return d}static fromJSON(d,m){if(!m)throw new RangeError("Invalid input for Mark.fromJSON");let E=d.marks[m.type];if(!E)throw new RangeError(`There is no mark type ${m.type} in this schema`);return E.create(m.attrs)}static sameSet(d,m){if(d==m)return!0;if(d.length!=m.length)return!1;for(let E=0;E<d.length;E++)if(!d[E].eq(m[E]))return!1;return!0}static setFrom(d){if(!d||Array.isArray(d)&&0==d.length)return w.none;if(d instanceof w)return[d];let m=d.slice();return m.sort((E,A)=>E.type.rank-A.type.rank),m}}return w.none=[],w})();class at extends Error{}class et{constructor(l,d,m){this.content=l,this.openStart=d,this.openEnd=m}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(l,d){let m=it(this.content,l+this.openStart,d);return m&&new et(m,this.openStart,this.openEnd)}removeBetween(l,d){return new et(mt(this.content,l+this.openStart,d+this.openStart),this.openStart,this.openEnd)}eq(l){return this.content.eq(l.content)&&this.openStart==l.openStart&&this.openEnd==l.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let l={content:this.content.toJSON()};return this.openStart>0&&(l.openStart=this.openStart),this.openEnd>0&&(l.openEnd=this.openEnd),l}static fromJSON(l,d){if(!d)return et.empty;let m=d.openStart||0,E=d.openEnd||0;if("number"!=typeof m||"number"!=typeof E)throw new RangeError("Invalid input for Slice.fromJSON");return new et(f.fromJSON(l,d.content),m,E)}static maxOpen(l,d=!0){let m=0,E=0;for(let A=l.firstChild;A&&!A.isLeaf&&(d||!A.type.spec.isolating);A=A.firstChild)m++;for(let A=l.lastChild;A&&!A.isLeaf&&(d||!A.type.spec.isolating);A=A.lastChild)E++;return new et(l,m,E)}}function mt(w,l,d){let{index:m,offset:E}=w.findIndex(l),A=w.maybeChild(m),{index:F,offset:lt}=w.findIndex(d);if(E==l||A.isText){if(lt!=d&&!w.child(F).isText)throw new RangeError("Removing non-flat range");return w.cut(0,l).append(w.cut(d))}if(m!=F)throw new RangeError("Removing non-flat range");return w.replaceChild(m,A.copy(mt(A.content,l-E-1,d-E-1)))}function it(w,l,d,m){let{index:E,offset:A}=w.findIndex(l),F=w.maybeChild(E);if(A==l||F.isText)return m&&!m.canReplace(E,E,d)?null:w.cut(0,l).append(d).append(w.cut(l));let lt=it(F.content,l-A-1,d);return lt&&w.replaceChild(E,F.copy(lt))}function st(w,l,d){if(d.openStart>w.depth)throw new at("Inserted content deeper than insertion position");if(w.depth-d.openStart!=l.depth-d.openEnd)throw new at("Inconsistent open depths");return Et(w,l,d,0)}function Et(w,l,d,m){let E=w.index(m),A=w.node(m);if(E==l.index(m)&&m<w.depth-d.openStart){let F=Et(w,l,d,m+1);return A.copy(A.content.replaceChild(E,F))}if(d.content.size){if(d.openStart||d.openEnd||w.depth!=m||l.depth!=m){let{start:F,end:lt}=function(w,l){let d=l.depth-w.openStart,E=l.node(d).copy(w.content);for(let A=d-1;A>=0;A--)E=l.node(A).copy(f.from(E));return{start:E.resolveNoCache(w.openStart+d),end:E.resolveNoCache(E.content.size-w.openEnd-d)}}(d,w);return Q(A,N(w,F,lt,l,m))}{let F=w.parent,lt=F.content;return Q(F,lt.cut(0,w.parentOffset).append(d.content).append(lt.cut(l.parentOffset)))}}return Q(A,pt(w,l,m))}function _t(w,l){if(!l.type.compatibleContent(w.type))throw new at("Cannot join "+l.type.name+" onto "+w.type.name)}function ut(w,l,d){let m=w.node(d);return _t(m,l.node(d)),m}function $(w,l){let d=l.length-1;d>=0&&w.isText&&w.sameMarkup(l[d])?l[d]=w.withText(l[d].text+w.text):l.push(w)}function W(w,l,d,m){let E=(l||w).node(d),A=0,F=l?l.index(d):E.childCount;w&&(A=w.index(d),w.depth>d?A++:w.textOffset&&($(w.nodeAfter,m),A++));for(let lt=A;lt<F;lt++)$(E.child(lt),m);l&&l.depth==d&&l.textOffset&&$(l.nodeBefore,m)}function Q(w,l){if(!w.type.validContent(l))throw new at("Invalid content for node "+w.type.name);return w.copy(l)}function N(w,l,d,m,E){let A=w.depth>E&&ut(w,l,E+1),F=m.depth>E&&ut(d,m,E+1),lt=[];return W(null,w,E,lt),A&&F&&l.index(E)==d.index(E)?(_t(A,F),$(Q(A,N(w,l,d,m,E+1)),lt)):(A&&$(Q(A,pt(w,l,E+1)),lt),W(l,d,E,lt),F&&$(Q(F,pt(d,m,E+1)),lt)),W(m,null,E,lt),new f(lt)}function pt(w,l,d){let m=[];return W(null,w,d,m),w.depth>d&&$(Q(ut(w,l,d+1),pt(w,l,d+1)),m),W(l,null,d,m),new f(m)}et.empty=new et(f.empty,0,0);class gt{constructor(l,d,m){this.pos=l,this.path=d,this.parentOffset=m,this.depth=d.length/3-1}resolveDepth(l){return null==l?this.depth:l<0?this.depth+l:l}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(l){return this.path[3*this.resolveDepth(l)]}index(l){return this.path[3*this.resolveDepth(l)+1]}indexAfter(l){return l=this.resolveDepth(l),this.index(l)+(l!=this.depth||this.textOffset?1:0)}start(l){return 0==(l=this.resolveDepth(l))?0:this.path[3*l-1]+1}end(l){return l=this.resolveDepth(l),this.start(l)+this.node(l).content.size}before(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position before the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]}after(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position after the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]+this.path[3*l].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let l=this.parent,d=this.index(this.depth);if(d==l.childCount)return null;let m=this.pos-this.path[this.path.length-1],E=l.child(d);return m?l.child(d).cut(m):E}get nodeBefore(){let l=this.index(this.depth),d=this.pos-this.path[this.path.length-1];return d?this.parent.child(l).cut(0,d):0==l?null:this.parent.child(l-1)}posAtIndex(l,d){d=this.resolveDepth(d);let m=this.path[3*d],E=0==d?0:this.path[3*d-1]+1;for(let A=0;A<l;A++)E+=m.child(A).nodeSize;return E}marks(){let l=this.parent,d=this.index();if(0==l.content.size)return j.none;if(this.textOffset)return l.child(d).marks;let m=l.maybeChild(d-1),E=l.maybeChild(d);if(!m){let lt=m;m=E,E=lt}let A=m.marks;for(var F=0;F<A.length;F++)!1===A[F].type.spec.inclusive&&(!E||!A[F].isInSet(E.marks))&&(A=A[F--].removeFromSet(A));return A}marksAcross(l){let d=this.parent.maybeChild(this.index());if(!d||!d.isInline)return null;let m=d.marks,E=l.parent.maybeChild(l.index());for(var A=0;A<m.length;A++)!1===m[A].type.spec.inclusive&&(!E||!m[A].isInSet(E.marks))&&(m=m[A--].removeFromSet(m));return m}sharedDepth(l){for(let d=this.depth;d>0;d--)if(this.start(d)<=l&&this.end(d)>=l)return d;return 0}blockRange(l=this,d){if(l.pos<this.pos)return l.blockRange(this);for(let m=this.depth-(this.parent.inlineContent||this.pos==l.pos?1:0);m>=0;m--)if(l.pos<=this.end(m)&&(!d||d(this.node(m))))return new Dt(this,l,m);return null}sameParent(l){return this.pos-this.parentOffset==l.pos-l.parentOffset}max(l){return l.pos>this.pos?l:this}min(l){return l.pos<this.pos?l:this}toString(){let l="";for(let d=1;d<=this.depth;d++)l+=(l?"/":"")+this.node(d).type.name+"_"+this.index(d-1);return l+":"+this.parentOffset}static resolve(l,d){if(!(d>=0&&d<=l.content.size))throw new RangeError("Position "+d+" out of range");let m=[],E=0,A=d;for(let F=l;;){let{index:lt,offset:Ct}=F.content.findIndex(A),Rt=A-Ct;if(m.push(F,lt,E+Ct),!Rt||(F=F.child(lt),F.isText))break;A=Rt-1,E+=Ct+1}return new gt(d,m,A)}static resolveCached(l,d){for(let E=0;E<Tt.length;E++){let A=Tt[E];if(A.pos==d&&A.doc==l)return A}let m=Tt[ft]=gt.resolve(l,d);return ft=(ft+1)%xt,m}}let Tt=[],ft=0,xt=12;class Dt{constructor(l,d,m){this.$from=l,this.$to=d,this.depth=m}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Ut=Object.create(null);class ot{constructor(l,d,m,E=j.none){this.type=l,this.attrs=d,this.marks=E,this.content=m||f.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(l){return this.content.child(l)}maybeChild(l){return this.content.maybeChild(l)}forEach(l){this.content.forEach(l)}nodesBetween(l,d,m,E=0){this.content.nodesBetween(l,d,m,E,this)}descendants(l){this.nodesBetween(0,this.content.size,l)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(l,d,m,E){return this.content.textBetween(l,d,m,E)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(l){return this==l||this.sameMarkup(l)&&this.content.eq(l.content)}sameMarkup(l){return this.hasMarkup(l.type,l.attrs,l.marks)}hasMarkup(l,d,m){return this.type==l&&nt(this.attrs,d||l.defaultAttrs||Ut)&&j.sameSet(this.marks,m||j.none)}copy(l=null){return l==this.content?this:new ot(this.type,this.attrs,l,this.marks)}mark(l){return l==this.marks?this:new ot(this.type,this.attrs,this.content,l)}cut(l,d=this.content.size){return 0==l&&d==this.content.size?this:this.copy(this.content.cut(l,d))}slice(l,d=this.content.size,m=!1){if(l==d)return et.empty;let E=this.resolve(l),A=this.resolve(d),F=m?0:E.sharedDepth(d),lt=E.start(F),Rt=E.node(F).content.cut(E.pos-lt,A.pos-lt);return new et(Rt,E.depth-F,A.depth-F)}replace(l,d,m){return st(this.resolve(l),this.resolve(d),m)}nodeAt(l){for(let d=this;;){let{index:m,offset:E}=d.content.findIndex(l);if(d=d.maybeChild(m),!d)return null;if(E==l||d.isText)return d;l-=E+1}}childAfter(l){let{index:d,offset:m}=this.content.findIndex(l);return{node:this.content.maybeChild(d),index:d,offset:m}}childBefore(l){if(0==l)return{node:null,index:0,offset:0};let{index:d,offset:m}=this.content.findIndex(l);if(m<l)return{node:this.content.child(d),index:d,offset:m};let E=this.content.child(d-1);return{node:E,index:d-1,offset:m-E.nodeSize}}resolve(l){return gt.resolveCached(this,l)}resolveNoCache(l){return gt.resolve(this,l)}rangeHasMark(l,d,m){let E=!1;return d>l&&this.nodesBetween(l,d,A=>(m.isInSet(A.marks)&&(E=!0),!E)),E}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let l=this.type.name;return this.content.size&&(l+="("+this.content.toStringInner()+")"),Z(this.marks,l)}contentMatchAt(l){let d=this.type.contentMatch.matchFragment(this.content,0,l);if(!d)throw new Error("Called contentMatchAt on a node with invalid content");return d}canReplace(l,d,m=f.empty,E=0,A=m.childCount){let F=this.contentMatchAt(l).matchFragment(m,E,A),lt=F&&F.matchFragment(this.content,d);if(!lt||!lt.validEnd)return!1;for(let Ct=E;Ct<A;Ct++)if(!this.type.allowsMarks(m.child(Ct).marks))return!1;return!0}canReplaceWith(l,d,m,E){if(E&&!this.type.allowsMarks(E))return!1;let A=this.contentMatchAt(l).matchType(m),F=A&&A.matchFragment(this.content,d);return!!F&&F.validEnd}canAppend(l){return l.content.size?this.canReplace(this.childCount,this.childCount,l.content):this.type.compatibleContent(l.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let l=j.none;for(let d=0;d<this.marks.length;d++)l=this.marks[d].addToSet(l);if(!j.sameSet(l,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(d=>d.type.name)}`);this.content.forEach(d=>d.check())}toJSON(){let l={type:this.type.name};for(let d in this.attrs){l.attrs=this.attrs;break}return this.content.size&&(l.content=this.content.toJSON()),this.marks.length&&(l.marks=this.marks.map(d=>d.toJSON())),l}static fromJSON(l,d){if(!d)throw new RangeError("Invalid input for Node.fromJSON");let m=null;if(d.marks){if(!Array.isArray(d.marks))throw new RangeError("Invalid mark data for Node.fromJSON");m=d.marks.map(l.markFromJSON)}if("text"==d.type){if("string"!=typeof d.text)throw new RangeError("Invalid text node in JSON");return l.text(d.text,m)}let E=f.fromJSON(l,d.content);return l.nodeType(d.type).create(d.attrs,E,m)}}ot.prototype.text=void 0;class x extends ot{constructor(l,d,m,E){if(super(l,d,null,E),!m)throw new RangeError("Empty text nodes are not allowed");this.text=m}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Z(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(l,d){return this.text.slice(l,d)}get nodeSize(){return this.text.length}mark(l){return l==this.marks?this:new x(this.type,this.attrs,this.text,l)}withText(l){return l==this.text?this:new x(this.type,this.attrs,l,this.marks)}cut(l=0,d=this.text.length){return 0==l&&d==this.text.length?this:this.withText(this.text.slice(l,d))}eq(l){return this.sameMarkup(l)&&this.text==l.text}toJSON(){let l=super.toJSON();return l.text=this.text,l}}function Z(w,l){for(let d=w.length-1;d>=0;d--)l=w[d].type.name+"("+l+")";return l}class Y{constructor(l){this.validEnd=l,this.next=[],this.wrapCache=[]}static parse(l,d){let m=new ct(l,d);if(null==m.next)return Y.empty;let E=R(m);m.next&&m.err("Unexpected trailing text");let A=function(w){let l=Object.create(null);return function d(m){let E=[];m.forEach(F=>{w[F].forEach(({term:lt,to:Ct})=>{if(!lt)return;let Rt;for(let Nt=0;Nt<E.length;Nt++)E[Nt][0]==lt&&(Rt=E[Nt][1]);be(w,Ct).forEach(Nt=>{Rt||E.push([lt,Rt=[]]),-1==Rt.indexOf(Nt)&&Rt.push(Nt)})})});let A=l[m.join(",")]=new Y(m.indexOf(w.length-1)>-1);for(let F=0;F<E.length;F++){let lt=E[F][1].sort(Be);A.next.push({type:E[F][0],next:l[lt.join(",")]||d(lt)})}return A}(be(w,0))}(function(w){let l=[[]];return E(function A(F,lt){if("choice"==F.type)return F.exprs.reduce((Ct,Rt)=>Ct.concat(A(Rt,lt)),[]);if("seq"!=F.type){if("star"==F.type){let Ct=d();return m(lt,Ct),E(A(F.expr,Ct),Ct),[m(Ct)]}if("plus"==F.type){let Ct=d();return E(A(F.expr,lt),Ct),E(A(F.expr,Ct),Ct),[m(Ct)]}if("opt"==F.type)return[m(lt)].concat(A(F.expr,lt));if("range"==F.type){let Ct=lt;for(let Rt=0;Rt<F.min;Rt++){let Nt=d();E(A(F.expr,Ct),Nt),Ct=Nt}if(-1==F.max)E(A(F.expr,Ct),Ct);else for(let Rt=F.min;Rt<F.max;Rt++){let Nt=d();m(Ct,Nt),E(A(F.expr,Ct),Nt),Ct=Nt}return[m(Ct)]}if("name"==F.type)return[m(lt,void 0,F.value)];throw new Error("Unknown expr type")}for(let Ct=0;;Ct++){let Rt=A(F.exprs[Ct],lt);if(Ct==F.exprs.length-1)return Rt;E(Rt,lt=d())}}(w,0),d()),l;function d(){return l.push([])-1}function m(F,lt,Ct){let Rt={term:Ct,to:lt};return l[F].push(Rt),Rt}function E(F,lt){F.forEach(Ct=>Ct.to=lt)}}(E));return function(w,l){for(let d=0,m=[w];d<m.length;d++){let E=m[d],A=!E.validEnd,F=[];for(let lt=0;lt<E.next.length;lt++){let{type:Ct,next:Rt}=E.next[lt];F.push(Ct.name),A&&!(Ct.isText||Ct.hasRequiredAttrs())&&(A=!1),-1==m.indexOf(Rt)&&m.push(Rt)}A&&l.err("Only non-generatable nodes ("+F.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(A,m),A}matchType(l){for(let d=0;d<this.next.length;d++)if(this.next[d].type==l)return this.next[d].next;return null}matchFragment(l,d=0,m=l.childCount){let E=this;for(let A=d;E&&A<m;A++)E=E.matchType(l.child(A).type);return E}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let l=0;l<this.next.length;l++){let{type:d}=this.next[l];if(!d.isText&&!d.hasRequiredAttrs())return d}return null}compatible(l){for(let d=0;d<this.next.length;d++)for(let m=0;m<l.next.length;m++)if(this.next[d].type==l.next[m].type)return!0;return!1}fillBefore(l,d=!1,m=0){let E=[this];return function A(F,lt){let Ct=F.matchFragment(l,m);if(Ct&&(!d||Ct.validEnd))return f.from(lt.map(Rt=>Rt.createAndFill()));for(let Rt=0;Rt<F.next.length;Rt++){let{type:Nt,next:ne}=F.next[Rt];if(!Nt.isText&&!Nt.hasRequiredAttrs()&&-1==E.indexOf(ne)){E.push(ne);let Ye=A(ne,lt.concat(Nt));if(Ye)return Ye}}return null}(this,[])}findWrapping(l){for(let m=0;m<this.wrapCache.length;m+=2)if(this.wrapCache[m]==l)return this.wrapCache[m+1];let d=this.computeWrapping(l);return this.wrapCache.push(l,d),d}computeWrapping(l){let d=Object.create(null),m=[{match:this,type:null,via:null}];for(;m.length;){let E=m.shift(),A=E.match;if(A.matchType(l)){let F=[];for(let lt=E;lt.type;lt=lt.via)F.push(lt.type);return F.reverse()}for(let F=0;F<A.next.length;F++){let{type:lt,next:Ct}=A.next[F];!lt.isLeaf&&!lt.hasRequiredAttrs()&&!(lt.name in d)&&(!E.type||Ct.validEnd)&&(m.push({match:lt.contentMatch,type:lt,via:E}),d[lt.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(l){if(l>=this.next.length)throw new RangeError(`There's no ${l}th edge in this content match`);return this.next[l]}toString(){let l=[];return function d(m){l.push(m);for(let E=0;E<m.next.length;E++)-1==l.indexOf(m.next[E].next)&&d(m.next[E].next)}(this),l.map((m,E)=>{let A=E+(m.validEnd?"*":" ")+" ";for(let F=0;F<m.next.length;F++)A+=(F?", ":"")+m.next[F].type.name+"->"+l.indexOf(m.next[F].next);return A}).join("\n")}}Y.empty=new Y(!0);class ct{constructor(l,d){this.string=l,this.nodeTypes=d,this.inline=null,this.pos=0,this.tokens=l.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(l){return this.next==l&&(this.pos++||!0)}err(l){throw new SyntaxError(l+" (in content expression '"+this.string+"')")}}function R(w){let l=[];do{l.push(V(w))}while(w.eat("|"));return 1==l.length?l[0]:{type:"choice",exprs:l}}function V(w){let l=[];do{l.push(tt(w))}while(w.next&&")"!=w.next&&"|"!=w.next);return 1==l.length?l[0]:{type:"seq",exprs:l}}function tt(w){let l=function(w){if(w.eat("(")){let l=R(w);return w.eat(")")||w.err("Missing closing paren"),l}if(!/\W/.test(w.next)){let l=function(w,l){let d=w.nodeTypes,m=d[l];if(m)return[m];let E=[];for(let A in d){let F=d[A];F.groups.indexOf(l)>-1&&E.push(F)}return 0==E.length&&w.err("No node type or group '"+l+"' found"),E}(w,w.next).map(d=>(null==w.inline?w.inline=d.isInline:w.inline!=d.isInline&&w.err("Mixing inline and block content"),{type:"name",value:d}));return w.pos++,1==l.length?l[0]:{type:"choice",exprs:l}}w.err("Unexpected token '"+w.next+"'")}(w);for(;;)if(w.eat("+"))l={type:"plus",expr:l};else if(w.eat("*"))l={type:"star",expr:l};else if(w.eat("?"))l={type:"opt",expr:l};else{if(!w.eat("{"))break;l=It(w,l)}return l}function Ot(w){/\D/.test(w.next)&&w.err("Expected number, got '"+w.next+"'");let l=Number(w.next);return w.pos++,l}function It(w,l){let d=Ot(w),m=d;return w.eat(",")&&(m="}"!=w.next?Ot(w):-1),w.eat("}")||w.err("Unclosed braced range"),{type:"range",min:d,max:m,expr:l}}function Be(w,l){return l-w}function be(w,l){let d=[];return function m(E){let A=w[E];if(1==A.length&&!A[0].term)return m(A[0].to);d.push(E);for(let F=0;F<A.length;F++){let{term:lt,to:Ct}=A[F];!lt&&-1==d.indexOf(Ct)&&m(Ct)}}(l),d.sort(Be)}function Gt(w){let l=Object.create(null);for(let d in w){let m=w[d];if(!m.hasDefault)return null;l[d]=m.default}return l}function pe(w,l){let d=Object.create(null);for(let m in w){let E=l&&l[m];if(void 0===E){let A=w[m];if(!A.hasDefault)throw new RangeError("No value supplied for attribute "+m);E=A.default}d[m]=E}return d}function he(w){let l=Object.create(null);if(w)for(let d in w)l[d]=new Ne(w[d]);return l}class oe{constructor(l,d,m){this.name=l,this.schema=d,this.spec=m,this.markSet=null,this.groups=m.group?m.group.split(" "):[],this.attrs=he(m.attrs),this.defaultAttrs=Gt(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(m.inline||"text"==l),this.isText="text"==l}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Y.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let l in this.attrs)if(this.attrs[l].isRequired)return!0;return!1}compatibleContent(l){return this==l||this.contentMatch.compatible(l.contentMatch)}computeAttrs(l){return!l&&this.defaultAttrs?this.defaultAttrs:pe(this.attrs,l)}create(l=null,d,m){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ot(this,this.computeAttrs(l),f.from(d),j.setFrom(m))}createChecked(l=null,d,m){if(d=f.from(d),!this.validContent(d))throw new RangeError("Invalid content for node "+this.name);return new ot(this,this.computeAttrs(l),d,j.setFrom(m))}createAndFill(l=null,d,m){if(l=this.computeAttrs(l),(d=f.from(d)).size){let F=this.contentMatch.fillBefore(d);if(!F)return null;d=F.append(d)}let E=this.contentMatch.matchFragment(d),A=E&&E.fillBefore(f.empty,!0);return A?new ot(this,l,d.append(A),j.setFrom(m)):null}validContent(l){let d=this.contentMatch.matchFragment(l);if(!d||!d.validEnd)return!1;for(let m=0;m<l.childCount;m++)if(!this.allowsMarks(l.child(m).marks))return!1;return!0}allowsMarkType(l){return null==this.markSet||this.markSet.indexOf(l)>-1}allowsMarks(l){if(null==this.markSet)return!0;for(let d=0;d<l.length;d++)if(!this.allowsMarkType(l[d].type))return!1;return!0}allowedMarks(l){if(null==this.markSet)return l;let d;for(let m=0;m<l.length;m++)this.allowsMarkType(l[m].type)?d&&d.push(l[m]):d||(d=l.slice(0,m));return d?d.length?d:j.none:l}static compile(l,d){let m=Object.create(null);l.forEach((A,F)=>m[A]=new oe(A,d,F));let E=d.spec.topNode||"doc";if(!m[E])throw new RangeError("Schema is missing its top node type ('"+E+"')");if(!m.text)throw new RangeError("Every schema needs a 'text' type");for(let A in m.text.attrs)throw new RangeError("The text node type should not have attributes");return m}}class Ne{constructor(l){this.hasDefault=Object.prototype.hasOwnProperty.call(l,"default"),this.default=l.default}get isRequired(){return!this.hasDefault}}class Xt{constructor(l,d,m,E){this.name=l,this.rank=d,this.schema=m,this.spec=E,this.attrs=he(E.attrs),this.excluded=null;let A=Gt(this.attrs);this.instance=A?new j(this,A):null}create(l=null){return!l&&this.instance?this.instance:new j(this,pe(this.attrs,l))}static compile(l,d){let m=Object.create(null),E=0;return l.forEach((A,F)=>m[A]=new Xt(A,E++,d,F)),m}removeFromSet(l){for(var d=0;d<l.length;d++)l[d].type==this&&(l=l.slice(0,d).concat(l.slice(d+1)),d--);return l}isInSet(l){for(let d=0;d<l.length;d++)if(l[d].type==this)return l[d]}excludes(l){return this.excluded.indexOf(l)>-1}}class Zt{constructor(l){this.cached=Object.create(null),this.spec={nodes:s.from(l.nodes),marks:s.from(l.marks||{}),topNode:l.topNode},this.nodes=oe.compile(this.spec.nodes,this),this.marks=Xt.compile(this.spec.marks,this);let d=Object.create(null);for(let m in this.nodes){if(m in this.marks)throw new RangeError(m+" can not be both a node and a mark");let E=this.nodes[m],A=E.spec.content||"",F=E.spec.marks;E.contentMatch=d[A]||(d[A]=Y.parse(A,this.nodes)),E.inlineContent=E.contentMatch.inlineContent,E.markSet="_"==F?null:F?Ee(this,F.split(" ")):""!=F&&E.inlineContent?null:[]}for(let m in this.marks){let E=this.marks[m],A=E.spec.excludes;E.excluded=null==A?[E]:""==A?[]:Ee(this,A.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(l,d=null,m,E){if("string"==typeof l)l=this.nodeType(l);else{if(!(l instanceof oe))throw new RangeError("Invalid node type: "+l);if(l.schema!=this)throw new RangeError("Node type from different schema used ("+l.name+")")}return l.createChecked(d,m,E)}text(l,d){let m=this.nodes.text;return new x(m,m.defaultAttrs,l,j.setFrom(d))}mark(l,d){return"string"==typeof l&&(l=this.marks[l]),l.create(d)}nodeFromJSON(l){return ot.fromJSON(this,l)}markFromJSON(l){return j.fromJSON(this,l)}nodeType(l){let d=this.nodes[l];if(!d)throw new RangeError("Unknown node type: "+l);return d}}function Ee(w,l){let d=[];for(let m=0;m<l.length;m++){let E=l[m],A=w.marks[E],F=A;if(A)d.push(A);else for(let lt in w.marks){let Ct=w.marks[lt];("_"==E||Ct.spec.group&&Ct.spec.group.split(" ").indexOf(E)>-1)&&d.push(F=Ct)}if(!F)throw new SyntaxError("Unknown mark type: '"+l[m]+"'")}return d}class le{constructor(l,d){this.schema=l,this.rules=d,this.tags=[],this.styles=[],d.forEach(m=>{m.tag?this.tags.push(m):m.style&&this.styles.push(m)}),this.normalizeLists=!this.tags.some(m=>{if(!/^(ul|ol)\b/.test(m.tag)||!m.node)return!1;let E=l.nodes[m.node];return E.contentMatch.matchType(E)})}parse(l,d={}){let m=new O(this,d,!1);return m.addAll(l,d.from,d.to),m.finish()}parseSlice(l,d={}){let m=new O(this,d,!0);return m.addAll(l,d.from,d.to),et.maxOpen(m.finish())}matchTag(l,d,m){for(let E=m?this.tags.indexOf(m)+1:0;E<this.tags.length;E++){let A=this.tags[E];if(P(l,A.tag)&&(void 0===A.namespace||l.namespaceURI==A.namespace)&&(!A.context||d.matchesContext(A.context))){if(A.getAttrs){let F=A.getAttrs(l);if(!1===F)continue;A.attrs=F||void 0}return A}}}matchStyle(l,d,m,E){for(let A=E?this.styles.indexOf(E)+1:0;A<this.styles.length;A++){let F=this.styles[A],lt=F.style;if(!(0!=lt.indexOf(l)||F.context&&!m.matchesContext(F.context)||lt.length>l.length&&(61!=lt.charCodeAt(l.length)||lt.slice(l.length+1)!=d))){if(F.getAttrs){let Ct=F.getAttrs(d);if(!1===Ct)continue;F.attrs=Ct||void 0}return F}}}static schemaRules(l){let d=[];function m(E){let A=null==E.priority?50:E.priority,F=0;for(;F<d.length;F++){let lt=d[F];if((null==lt.priority?50:lt.priority)<A)break}d.splice(F,0,E)}for(let E in l.marks){let A=l.marks[E].spec.parseDOM;A&&A.forEach(F=>{m(F=k(F)),F.mark=E})}for(let E in l.nodes){let A=l.nodes[E].spec.parseDOM;A&&A.forEach(F=>{m(F=k(F)),F.node=E})}return d}static fromSchema(l){return l.cached.domParser||(l.cached.domParser=new le(l,le.schemaRules(l)))}}const me={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Se={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ie={ol:!0,ul:!0};function z(w,l,d){return null!=l?(l?1:0)|("full"===l?2:0):w&&"pre"==w.whitespace?3:-5&d}class v{constructor(l,d,m,E,A,F,lt){this.type=l,this.attrs=d,this.marks=m,this.pendingMarks=E,this.solid=A,this.options=lt,this.content=[],this.activeMarks=j.none,this.stashMarks=[],this.match=F||(4&lt?null:l.contentMatch)}findWrapping(l){if(!this.match){if(!this.type)return[];let d=this.type.contentMatch.fillBefore(f.from(l));if(!d){let E,m=this.type.contentMatch;return(E=m.findWrapping(l.type))?(this.match=m,E):null}this.match=this.type.contentMatch.matchFragment(d)}return this.match.findWrapping(l.type)}finish(l){if(!(1&this.options)){let E,m=this.content[this.content.length-1];if(m&&m.isText&&(E=/[ \t\r\n\u000c]+$/.exec(m.text))){let A=m;m.text.length==E[0].length?this.content.pop():this.content[this.content.length-1]=A.withText(A.text.slice(0,A.text.length-E[0].length))}}let d=f.from(this.content);return!l&&this.match&&(d=d.append(this.match.fillBefore(f.empty,!0))),this.type?this.type.create(this.attrs,d,this.marks):d}popFromStashMark(l){for(let d=this.stashMarks.length-1;d>=0;d--)if(l.eq(this.stashMarks[d]))return this.stashMarks.splice(d,1)[0]}applyPending(l){for(let d=0,m=this.pendingMarks;d<m.length;d++){let E=m[d];(this.type?this.type.allowsMarkType(E.type):X(E.type,l))&&!E.isInSet(this.activeMarks)&&(this.activeMarks=E.addToSet(this.activeMarks),this.pendingMarks=E.removeFromSet(this.pendingMarks))}}inlineContext(l){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:l.parentNode&&!me.hasOwnProperty(l.parentNode.nodeName.toLowerCase())}}class O{constructor(l,d,m){this.parser=l,this.options=d,this.isOpen=m,this.open=0;let A,E=d.topNode,F=z(null,d.preserveWhitespace,0)|(m?4:0);A=E?new v(E.type,E.attrs,j.none,j.none,!0,d.topMatch||E.type.contentMatch,F):new v(m?null:l.schema.topNodeType,null,j.none,j.none,!0,null,F),this.nodes=[A],this.find=d.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(l){if(3==l.nodeType)this.addTextNode(l);else if(1==l.nodeType){let d=l.getAttribute("style"),m=d?this.readStyles(function(w){let d,l=/\s*([\w-]+)\s*:\s*([^;]+)/g,m=[];for(;d=l.exec(w);)m.push(d[1],d[2].trim());return m}(d)):null,E=this.top;if(null!=m)for(let A=0;A<m.length;A++)this.addPendingMark(m[A]);if(this.addElement(l),null!=m)for(let A=0;A<m.length;A++)this.removePendingMark(m[A],E)}}addTextNode(l){let d=l.nodeValue,m=this.top;if(2&m.options||m.inlineContext(l)||/[^ \t\r\n\u000c]/.test(d)){if(1&m.options)d=2&m.options?d.replace(/\r\n?/g,"\n"):d.replace(/\r?\n|\r/g," ");else if(d=d.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(d)&&this.open==this.nodes.length-1){let E=m.content[m.content.length-1],A=l.previousSibling;(!E||A&&"BR"==A.nodeName||E.isText&&/[ \t\r\n\u000c]$/.test(E.text))&&(d=d.slice(1))}d&&this.insertNode(this.parser.schema.text(d)),this.findInText(l)}else this.findInside(l)}addElement(l,d){let E,m=l.nodeName.toLowerCase();Ie.hasOwnProperty(m)&&this.parser.normalizeLists&&function(w){for(let l=w.firstChild,d=null;l;l=l.nextSibling){let m=1==l.nodeType?l.nodeName.toLowerCase():null;m&&Ie.hasOwnProperty(m)&&d?(d.appendChild(l),l=d):"li"==m?d=l:m&&(d=null)}}(l);let A=this.options.ruleFromNode&&this.options.ruleFromNode(l)||(E=this.parser.matchTag(l,this,d));if(A?A.ignore:Se.hasOwnProperty(m))this.findInside(l),this.ignoreFallback(l);else if(!A||A.skip||A.closeParent){A&&A.closeParent?this.open=Math.max(0,this.open-1):A&&A.skip.nodeType&&(l=A.skip);let F,lt=this.top,Ct=this.needsBlock;if(me.hasOwnProperty(m))F=!0,lt.type||(this.needsBlock=!0);else if(!l.firstChild)return void this.leafFallback(l);this.addAll(l),F&&this.sync(lt),this.needsBlock=Ct}else this.addElementByRule(l,A,!1===A.consuming?E:void 0)}leafFallback(l){"BR"==l.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(l.ownerDocument.createTextNode("\n"))}ignoreFallback(l){"BR"==l.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(l){let d=j.none;t:for(let m=0;m<l.length;m+=2)for(let E;;){let A=this.parser.matchStyle(l[m],l[m+1],this,E);if(!A)continue t;if(A.ignore)return null;if(d=this.parser.schema.marks[A.mark].create(A.attrs).addToSet(d),!1!==A.consuming)break;E=A}return d}addElementByRule(l,d,m){let E,A,F;d.node?(A=this.parser.schema.nodes[d.node],A.isLeaf?this.insertNode(A.create(d.attrs))||this.leafFallback(l):E=this.enter(A,d.attrs||null,d.preserveWhitespace)):(F=this.parser.schema.marks[d.mark].create(d.attrs),this.addPendingMark(F));let lt=this.top;if(A&&A.isLeaf)this.findInside(l);else if(m)this.addElement(l,m);else if(d.getContent)this.findInside(l),d.getContent(l,this.parser.schema).forEach(Ct=>this.insertNode(Ct));else{let Ct=l;"string"==typeof d.contentElement?Ct=l.querySelector(d.contentElement):"function"==typeof d.contentElement?Ct=d.contentElement(l):d.contentElement&&(Ct=d.contentElement),this.findAround(l,Ct,!0),this.addAll(Ct)}E&&this.sync(lt)&&this.open--,F&&this.removePendingMark(F,lt)}addAll(l,d,m){let E=d||0;for(let A=d?l.childNodes[d]:l.firstChild,F=null==m?null:l.childNodes[m];A!=F;A=A.nextSibling,++E)this.findAtPoint(l,E),this.addDOM(A);this.findAtPoint(l,E)}findPlace(l){let d,m;for(let E=this.open;E>=0;E--){let A=this.nodes[E],F=A.findWrapping(l);if(F&&(!d||d.length>F.length)&&(d=F,m=A,!F.length)||A.solid)break}if(!d)return!1;this.sync(m);for(let E=0;E<d.length;E++)this.enterInner(d[E],null,!1);return!0}insertNode(l){if(l.isInline&&this.needsBlock&&!this.top.type){let d=this.textblockFromContext();d&&this.enterInner(d)}if(this.findPlace(l)){this.closeExtra();let d=this.top;d.applyPending(l.type),d.match&&(d.match=d.match.matchType(l.type));let m=d.activeMarks;for(let E=0;E<l.marks.length;E++)(!d.type||d.type.allowsMarkType(l.marks[E].type))&&(m=l.marks[E].addToSet(m));return d.content.push(l.mark(m)),!0}return!1}enter(l,d,m){let E=this.findPlace(l.create(d));return E&&this.enterInner(l,d,!0,m),E}enterInner(l,d=null,m=!1,E){this.closeExtra();let A=this.top;A.applyPending(l),A.match=A.match&&A.match.matchType(l);let F=z(l,E,A.options);4&A.options&&0==A.content.length&&(F|=4),this.nodes.push(new v(l,d,A.activeMarks,A.pendingMarks,m,null,F)),this.open++}closeExtra(l=!1){let d=this.nodes.length-1;if(d>this.open){for(;d>this.open;d--)this.nodes[d-1].content.push(this.nodes[d].finish(l));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(l){for(let d=this.open;d>=0;d--)if(this.nodes[d]==l)return this.open=d,!0;return!1}get currentPos(){this.closeExtra();let l=0;for(let d=this.open;d>=0;d--){let m=this.nodes[d].content;for(let E=m.length-1;E>=0;E--)l+=m[E].nodeSize;d&&l++}return l}findAtPoint(l,d){if(this.find)for(let m=0;m<this.find.length;m++)this.find[m].node==l&&this.find[m].offset==d&&(this.find[m].pos=this.currentPos)}findInside(l){if(this.find)for(let d=0;d<this.find.length;d++)null==this.find[d].pos&&1==l.nodeType&&l.contains(this.find[d].node)&&(this.find[d].pos=this.currentPos)}findAround(l,d,m){if(l!=d&&this.find)for(let E=0;E<this.find.length;E++)null==this.find[E].pos&&1==l.nodeType&&l.contains(this.find[E].node)&&d.compareDocumentPosition(this.find[E].node)&(m?2:4)&&(this.find[E].pos=this.currentPos)}findInText(l){if(this.find)for(let d=0;d<this.find.length;d++)this.find[d].node==l&&(this.find[d].pos=this.currentPos-(l.nodeValue.length-this.find[d].offset))}matchesContext(l){if(l.indexOf("|")>-1)return l.split(/\s*\|\s*/).some(this.matchesContext,this);let d=l.split("/"),m=this.options.context,E=!(this.isOpen||m&&m.parent.type!=this.nodes[0].type),A=(E?0:1)-(m?m.depth+1:0),F=(lt,Ct)=>{for(;lt>=0;lt--){let Rt=d[lt];if(""==Rt){if(lt==d.length-1||0==lt)continue;for(;Ct>=A;Ct--)if(F(lt-1,Ct))return!0;return!1}{let Nt=Ct>0||0==Ct&&E?this.nodes[Ct].type:m&&Ct>=A?m.node(Ct-A).type:null;if(!Nt||Nt.name!=Rt&&-1==Nt.groups.indexOf(Rt))return!1;Ct--}}return!0};return F(d.length-1,this.open)}textblockFromContext(){let l=this.options.context;if(l)for(let d=l.depth;d>=0;d--){let m=l.node(d).contentMatchAt(l.indexAfter(d)).defaultType;if(m&&m.isTextblock&&m.defaultAttrs)return m}for(let d in this.parser.schema.nodes){let m=this.parser.schema.nodes[d];if(m.isTextblock&&m.defaultAttrs)return m}}addPendingMark(l){let d=function(w,l){for(let d=0;d<l.length;d++)if(w.eq(l[d]))return l[d]}(l,this.top.pendingMarks);d&&this.top.stashMarks.push(d),this.top.pendingMarks=l.addToSet(this.top.pendingMarks)}removePendingMark(l,d){for(let m=this.open;m>=0;m--){let E=this.nodes[m];if(E.pendingMarks.lastIndexOf(l)>-1)E.pendingMarks=l.removeFromSet(E.pendingMarks);else{E.activeMarks=l.removeFromSet(E.activeMarks);let F=E.popFromStashMark(l);F&&E.type&&E.type.allowsMarkType(F.type)&&(E.activeMarks=F.addToSet(E.activeMarks))}if(E==d)break}}}function P(w,l){return(w.matches||w.msMatchesSelector||w.webkitMatchesSelector||w.mozMatchesSelector).call(w,l)}function k(w){let l={};for(let d in w)l[d]=w[d];return l}function X(w,l){let d=l.schema.nodes;for(let m in d){let E=d[m];if(!E.allowsMarkType(w))continue;let A=[],F=lt=>{A.push(lt);for(let Ct=0;Ct<lt.edgeCount;Ct++){let{type:Rt,next:Nt}=lt.edge(Ct);if(Rt==l||A.indexOf(Nt)<0&&F(Nt))return!0}};if(F(E.contentMatch))return!0}}class Pt{constructor(l,d){this.nodes=l,this.marks=d}serializeFragment(l,d={},m){m||(m=wt(d).createDocumentFragment());let E=m,A=[];return l.forEach(F=>{if(A.length||F.marks.length){let lt=0,Ct=0;for(;lt<A.length&&Ct<F.marks.length;){let Rt=F.marks[Ct];if(this.marks[Rt.type.name]){if(!Rt.eq(A[lt][0])||!1===Rt.type.spec.spanning)break;lt++,Ct++}else Ct++}for(;lt<A.length;)E=A.pop()[1];for(;Ct<F.marks.length;){let Rt=F.marks[Ct++],Nt=this.serializeMark(Rt,F.isInline,d);Nt&&(A.push([Rt,E]),E.appendChild(Nt.dom),E=Nt.contentDOM||Nt.dom)}}E.appendChild(this.serializeNodeInner(F,d))}),m}serializeNodeInner(l,d){let{dom:m,contentDOM:E}=Pt.renderSpec(wt(d),this.nodes[l.type.name](l));if(E){if(l.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(l.content,d,E)}return m}serializeNode(l,d={}){let m=this.serializeNodeInner(l,d);for(let E=l.marks.length-1;E>=0;E--){let A=this.serializeMark(l.marks[E],l.isInline,d);A&&((A.contentDOM||A.dom).appendChild(m),m=A.dom)}return m}serializeMark(l,d,m={}){let E=this.marks[l.type.name];return E&&Pt.renderSpec(wt(m),E(l,d))}static renderSpec(l,d,m=null){if("string"==typeof d)return{dom:l.createTextNode(d)};if(null!=d.nodeType)return{dom:d};if(d.dom&&null!=d.dom.nodeType)return d;let E=d[0],A=E.indexOf(" ");A>0&&(m=E.slice(0,A),E=E.slice(A+1));let F,lt=m?l.createElementNS(m,E):l.createElement(E),Ct=d[1],Rt=1;if(Ct&&"object"==typeof Ct&&null==Ct.nodeType&&!Array.isArray(Ct)){Rt=2;for(let Nt in Ct)if(null!=Ct[Nt]){let ne=Nt.indexOf(" ");ne>0?lt.setAttributeNS(Nt.slice(0,ne),Nt.slice(ne+1),Ct[Nt]):lt.setAttribute(Nt,Ct[Nt])}}for(let Nt=Rt;Nt<d.length;Nt++){let ne=d[Nt];if(0===ne){if(Nt<d.length-1||Nt>Rt)throw new RangeError("Content hole must be the only child of its parent node");return{dom:lt,contentDOM:lt}}{let{dom:Ye,contentDOM:ae}=Pt.renderSpec(l,ne,m);if(lt.appendChild(Ye),ae){if(F)throw new RangeError("Multiple content holes");F=ae}}}return{dom:lt,contentDOM:F}}static fromSchema(l){return l.cached.domSerializer||(l.cached.domSerializer=new Pt(this.nodesFromSchema(l),this.marksFromSchema(l)))}static nodesFromSchema(l){let d=kt(l.nodes);return d.text||(d.text=m=>m.text),d}static marksFromSchema(l){return kt(l.marks)}}function kt(w){let l={};for(let d in w){let m=w[d].spec.toDOM;m&&(l[d]=m)}return l}function wt(w){return w.document||window.document}},62463:(St,dt,u)=>{u.d(dt,{C1:()=>mt,yy:()=>gt,qv:()=>at,Sy:()=>ft,H$:()=>Ut,Y1:()=>y,xm:()=>f,Bs:()=>nt});var g=u(35917),s=u(38480);const L=Object.create(null);class y{constructor(x,Z,Y){this.$anchor=x,this.$head=Z,this.ranges=Y||[new f(x.min(Z),x.max(Z))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let x=this.ranges;for(let Z=0;Z<x.length;Z++)if(x[Z].$from.pos!=x[Z].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(x,Z=g.p2.empty){let Y=Z.content.lastChild,ct=null;for(let tt=0;tt<Z.openEnd;tt++)ct=Y,Y=Y.lastChild;let R=x.steps.length,V=this.ranges;for(let tt=0;tt<V.length;tt++){let{$from:Ot,$to:It}=V[tt],Ft=x.mapping.slice(R);x.replaceRange(Ft.map(Ot.pos),Ft.map(It.pos),tt?g.p2.empty:Z),0==tt&&Et(x,R,(Y?Y.isInline:ct&&ct.isTextblock)?-1:1)}}replaceWith(x,Z){let Y=x.steps.length,ct=this.ranges;for(let R=0;R<ct.length;R++){let{$from:V,$to:tt}=ct[R],Ot=x.mapping.slice(Y),It=Ot.map(V.pos),Ft=Ot.map(tt.pos);R?x.deleteRange(It,Ft):(x.replaceRangeWith(It,Ft,Z),Et(x,Y,Z.isInline?-1:1))}}static findFrom(x,Z,Y=!1){let ct=x.parent.inlineContent?new nt(x):st(x.node(0),x.parent,x.pos,x.index(),Z,Y);if(ct)return ct;for(let R=x.depth-1;R>=0;R--){let V=Z<0?st(x.node(0),x.node(R),x.before(R+1),x.index(R),Z,Y):st(x.node(0),x.node(R),x.after(R+1),x.index(R)+1,Z,Y);if(V)return V}return null}static near(x,Z=1){return this.findFrom(x,Z)||this.findFrom(x,-Z)||new mt(x.node(0))}static atStart(x){return st(x,x,0,0,1)||new mt(x)}static atEnd(x){return st(x,x,x.content.size,x.childCount,-1)||new mt(x)}static fromJSON(x,Z){if(!Z||!Z.type)throw new RangeError("Invalid input for Selection.fromJSON");let Y=L[Z.type];if(!Y)throw new RangeError(`No selection type ${Z.type} defined`);return Y.fromJSON(x,Z)}static jsonID(x,Z){if(x in L)throw new RangeError("Duplicate use of selection JSON ID "+x);return L[x]=Z,Z.prototype.jsonID=x,Z}getBookmark(){return nt.between(this.$anchor,this.$head).getBookmark()}}y.prototype.visible=!0;class f{constructor(x,Z){this.$from=x,this.$to=Z}}let q=!1;function b(ot){!q&&!ot.parent.inlineContent&&(q=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+ot.parent.type.name+")"))}class nt extends y{constructor(x,Z=x){b(x),b(Z),super(x,Z)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(x,Z){let Y=x.resolve(Z.map(this.head));if(!Y.parent.inlineContent)return y.near(Y);let ct=x.resolve(Z.map(this.anchor));return new nt(ct.parent.inlineContent?ct:Y,Y)}replace(x,Z=g.p2.empty){if(super.replace(x,Z),Z==g.p2.empty){let Y=this.$from.marksAcross(this.$to);Y&&x.ensureMarks(Y)}}eq(x){return x instanceof nt&&x.anchor==this.anchor&&x.head==this.head}getBookmark(){return new j(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(x,Z){if("number"!=typeof Z.anchor||"number"!=typeof Z.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new nt(x.resolve(Z.anchor),x.resolve(Z.head))}static create(x,Z,Y=Z){let ct=x.resolve(Z);return new this(ct,Y==Z?ct:x.resolve(Y))}static between(x,Z,Y){let ct=x.pos-Z.pos;if((!Y||ct)&&(Y=ct>=0?1:-1),!Z.parent.inlineContent){let R=y.findFrom(Z,Y,!0)||y.findFrom(Z,-Y,!0);if(!R)return y.near(Z,Y);Z=R.$head}return x.parent.inlineContent||(0==ct||(x=(y.findFrom(x,-Y,!0)||y.findFrom(x,Y,!0)).$anchor).pos<Z.pos!=ct<0)&&(x=Z),new nt(x,Z)}}y.jsonID("text",nt);class j{constructor(x,Z){this.anchor=x,this.head=Z}map(x){return new j(x.map(this.anchor),x.map(this.head))}resolve(x){return nt.between(x.resolve(this.anchor),x.resolve(this.head))}}class at extends y{constructor(x){let Z=x.nodeAfter,Y=x.node(0).resolve(x.pos+Z.nodeSize);super(x,Y),this.node=Z}map(x,Z){let{deleted:Y,pos:ct}=Z.mapResult(this.anchor),R=x.resolve(ct);return Y?y.near(R):new at(R)}content(){return new g.p2(g.HY.from(this.node),0,0)}eq(x){return x instanceof at&&x.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new et(this.anchor)}static fromJSON(x,Z){if("number"!=typeof Z.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new at(x.resolve(Z.anchor))}static create(x,Z){return new at(x.resolve(Z))}static isSelectable(x){return!x.isText&&!1!==x.type.spec.selectable}}at.prototype.visible=!1,y.jsonID("node",at);class et{constructor(x){this.anchor=x}map(x){let{deleted:Z,pos:Y}=x.mapResult(this.anchor);return Z?new j(Y,Y):new et(Y)}resolve(x){let Z=x.resolve(this.anchor),Y=Z.nodeAfter;return Y&&at.isSelectable(Y)?new at(Z):y.near(Z)}}class mt extends y{constructor(x){super(x.resolve(0),x.resolve(x.content.size))}replace(x,Z=g.p2.empty){if(Z==g.p2.empty){x.delete(0,x.doc.content.size);let Y=y.atStart(x.doc);Y.eq(x.selection)||x.setSelection(Y)}else super.replace(x,Z)}toJSON(){return{type:"all"}}static fromJSON(x){return new mt(x)}map(x){return new mt(x)}eq(x){return x instanceof mt}getBookmark(){return it}}y.jsonID("all",mt);const it={map(){return this},resolve:ot=>new mt(ot)};function st(ot,x,Z,Y,ct,R=!1){if(x.inlineContent)return nt.create(ot,Z);for(let V=Y-(ct>0?0:1);ct>0?V<x.childCount:V>=0;V+=ct){let tt=x.child(V);if(tt.isAtom){if(!R&&at.isSelectable(tt))return at.create(ot,Z-(ct<0?tt.nodeSize:0))}else{let Ot=st(ot,tt,Z+ct,ct<0?tt.childCount:0,ct,R);if(Ot)return Ot}Z+=tt.nodeSize*ct}return null}function Et(ot,x,Z){let Y=ot.steps.length-1;if(Y<x)return;let V,ct=ot.steps[Y];(ct instanceof s.Pu||ct instanceof s.FC)&&(ot.mapping.maps[Y].forEach((tt,Ot,It,Ft)=>{null==V&&(V=Ft)}),ot.setSelection(y.near(ot.doc.resolve(V),Z)))}class W extends s.wx{constructor(x){super(x.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=x.selection,this.storedMarks=x.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(x){if(x.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=x,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(x){return this.storedMarks=x,this.updated|=2,this}ensureMarks(x){return g.vc.sameSet(this.storedMarks||this.selection.$from.marks(),x)||this.setStoredMarks(x),this}addStoredMark(x){return this.ensureMarks(x.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(x){return this.ensureMarks(x.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(x,Z){super.addStep(x,Z),this.updated=-3&this.updated,this.storedMarks=null}setTime(x){return this.time=x,this}replaceSelection(x){return this.selection.replace(this,x),this}replaceSelectionWith(x,Z=!0){let Y=this.selection;return Z&&(x=x.mark(this.storedMarks||(Y.empty?Y.$from.marks():Y.$from.marksAcross(Y.$to)||g.vc.none))),Y.replaceWith(this,x),this}deleteSelection(){return this.selection.replace(this),this}insertText(x,Z,Y){let ct=this.doc.type.schema;if(null==Z)return x?this.replaceSelectionWith(ct.text(x),!0):this.deleteSelection();{if(null==Y&&(Y=Z),Y=null==Y?Z:Y,!x)return this.deleteRange(Z,Y);let R=this.storedMarks;if(!R){let V=this.doc.resolve(Z);R=Y==Z?V.marks():V.marksAcross(this.doc.resolve(Y))}return this.replaceRangeWith(Z,Y,ct.text(x,R)),this.selection.empty||this.setSelection(y.near(this.selection.$to)),this}}setMeta(x,Z){return this.meta["string"==typeof x?x:x.key]=Z,this}getMeta(x){return this.meta["string"==typeof x?x:x.key]}get isGeneric(){for(let x in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Q(ot,x){return x&&ot?ot.bind(x):ot}class N{constructor(x,Z,Y){this.name=x,this.init=Q(Z.init,Y),this.apply=Q(Z.apply,Y)}}const pt=[new N("doc",{init:ot=>ot.doc||ot.schema.topNodeType.createAndFill(),apply:ot=>ot.doc}),new N("selection",{init:(ot,x)=>ot.selection||y.atStart(x.doc),apply:ot=>ot.selection}),new N("storedMarks",{init:ot=>ot.storedMarks||null,apply:(ot,x,Z,Y)=>Y.selection.$cursor?ot.storedMarks:null}),new N("scrollToSelection",{init:()=>0,apply:(ot,x)=>ot.scrolledIntoView?x+1:x})];class ht{constructor(x,Z){this.schema=x,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=pt.slice(),Z&&Z.forEach(Y=>{if(this.pluginsByKey[Y.key])throw new RangeError("Adding different instances of a keyed plugin ("+Y.key+")");this.plugins.push(Y),this.pluginsByKey[Y.key]=Y,Y.spec.state&&this.fields.push(new N(Y.key,Y.spec.state,Y))})}}class gt{constructor(x){this.config=x}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(x){return this.applyTransaction(x).state}filterTransaction(x,Z=-1){for(let Y=0;Y<this.config.plugins.length;Y++)if(Y!=Z){let ct=this.config.plugins[Y];if(ct.spec.filterTransaction&&!ct.spec.filterTransaction.call(ct,x,this))return!1}return!0}applyTransaction(x){if(!this.filterTransaction(x))return{state:this,transactions:[]};let Z=[x],Y=this.applyInner(x),ct=null;for(;;){let R=!1;for(let V=0;V<this.config.plugins.length;V++){let tt=this.config.plugins[V];if(tt.spec.appendTransaction){let Ot=ct?ct[V].n:0,It=ct?ct[V].state:this,Ft=Ot<Z.length&&tt.spec.appendTransaction.call(tt,Ot?Z.slice(Ot):Z,It,Y);if(Ft&&Y.filterTransaction(Ft,V)){if(Ft.setMeta("appendedTransaction",x),!ct){ct=[];for(let $t=0;$t<this.config.plugins.length;$t++)ct.push($t<V?{state:Y,n:Z.length}:{state:this,n:0})}Z.push(Ft),Y=Y.applyInner(Ft),R=!0}ct&&(ct[V]={state:Y,n:Z.length})}}if(!R)return{state:Y,transactions:Z}}}applyInner(x){if(!x.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let Z=new gt(this.config),Y=this.config.fields;for(let ct=0;ct<Y.length;ct++){let R=Y[ct];Z[R.name]=R.apply(x,this[R.name],this,Z)}return Z}get tr(){return new W(this)}static create(x){let Z=new ht(x.doc?x.doc.type.schema:x.schema,x.plugins),Y=new gt(Z);for(let ct=0;ct<Z.fields.length;ct++)Y[Z.fields[ct].name]=Z.fields[ct].init(x,Y);return Y}reconfigure(x){let Z=new ht(this.schema,x.plugins),Y=Z.fields,ct=new gt(Z);for(let R=0;R<Y.length;R++){let V=Y[R].name;ct[V]=this.hasOwnProperty(V)?this[V]:Y[R].init(x,ct)}return ct}toJSON(x){let Z={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(Z.storedMarks=this.storedMarks.map(Y=>Y.toJSON())),x&&"object"==typeof x)for(let Y in x){if("doc"==Y||"selection"==Y)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let ct=x[Y],R=ct.spec.state;R&&R.toJSON&&(Z[Y]=R.toJSON.call(ct,this[ct.key]))}return Z}static fromJSON(x,Z,Y){if(!Z)throw new RangeError("Invalid input for EditorState.fromJSON");if(!x.schema)throw new RangeError("Required config field 'schema' missing");let ct=new ht(x.schema,x.plugins),R=new gt(ct);return ct.fields.forEach(V=>{if("doc"==V.name)R.doc=g.NB.fromJSON(x.schema,Z.doc);else if("selection"==V.name)R.selection=y.fromJSON(R.doc,Z.selection);else if("storedMarks"==V.name)Z.storedMarks&&(R.storedMarks=Z.storedMarks.map(x.schema.markFromJSON));else{if(Y)for(let tt in Y){let Ot=Y[tt],It=Ot.spec.state;if(Ot.key==V.name&&It&&It.fromJSON&&Object.prototype.hasOwnProperty.call(Z,tt))return void(R[V.name]=It.fromJSON.call(Ot,x,Z[tt],R))}R[V.name]=V.init(x,R)}}),R}}function Tt(ot,x,Z){for(let Y in ot){let ct=ot[Y];ct instanceof Function?ct=ct.bind(x):"handleDOMEvents"==Y&&(ct=Tt(ct,x,{})),Z[Y]=ct}return Z}class ft{constructor(x){this.spec=x,this.props={},x.props&&Tt(x.props,this,this.props),this.key=x.key?x.key.key:Dt("plugin")}getState(x){return x[this.key]}}const xt=Object.create(null);function Dt(ot){return ot in xt?ot+"$"+ ++xt[ot]:(xt[ot]=0,ot+"$")}class Ut{constructor(x="key"){this.key=Dt(x)}get(x){return x.config.pluginsByKey[this.key]}getState(x){return x[this.key]}}},38480:(St,dt,u)=>{u.d(dt,{vs:()=>it,FC:()=>N,Pu:()=>Q,wx:()=>fe,Mn:()=>It,Ax:()=>tt,nj:()=>be,nd:()=>Ut,k9:()=>xt,dR:()=>Ae});var g=u(35917);const L=Math.pow(2,16);function y(z,v){return z+v*L}function f(z){return 65535&z}class et{constructor(v,O,I){this.pos=v,this.delInfo=O,this.recover=I}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class mt{constructor(v,O=!1){if(this.ranges=v,this.inverted=O,!v.length&&mt.empty)return mt.empty}recover(v){let O=0,I=f(v);if(!this.inverted)for(let P=0;P<I;P++)O+=this.ranges[3*P+2]-this.ranges[3*P+1];return this.ranges[3*I]+O+((z=v)-(65535&z))/L;var z}mapResult(v,O=1){return this._map(v,O,!1)}map(v,O=1){return this._map(v,O,!0)}_map(v,O,I){let P=0,H=this.inverted?2:1,k=this.inverted?1:2;for(let X=0;X<this.ranges.length;X+=3){let yt=this.ranges[X]-(this.inverted?P:0);if(yt>v)break;let Pt=this.ranges[X+H],kt=this.ranges[X+k],wt=yt+Pt;if(v<=wt){let l=yt+P+((Pt?v==yt?-1:v==wt?1:O:O)<0?0:kt);if(I)return l;let d=v==(O<0?yt:wt)?null:y(X/3,v-yt),m=v==yt?2:v==wt?1:4;return(O<0?v!=yt:v!=wt)&&(m|=8),new et(l,m,d)}P+=kt-Pt}return I?v+P:new et(v+P,0,null)}touches(v,O){let I=0,P=f(O),H=this.inverted?2:1,k=this.inverted?1:2;for(let X=0;X<this.ranges.length;X+=3){let yt=this.ranges[X]-(this.inverted?I:0);if(yt>v)break;let Pt=this.ranges[X+H];if(v<=yt+Pt&&X==3*P)return!0;I+=this.ranges[X+k]-Pt}return!1}forEach(v){let O=this.inverted?2:1,I=this.inverted?1:2;for(let P=0,H=0;P<this.ranges.length;P+=3){let k=this.ranges[P],X=k-(this.inverted?H:0),yt=k+(this.inverted?0:H),Pt=this.ranges[P+O],kt=this.ranges[P+I];v(X,X+Pt,yt,yt+kt),H+=kt-Pt}}invert(){return new mt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(v){return 0==v?mt.empty:new mt(v<0?[0,-v,0]:[0,0,v])}}mt.empty=new mt([]);class it{constructor(v=[],O,I=0,P=v.length){this.maps=v,this.mirror=O,this.from=I,this.to=P}slice(v=0,O=this.maps.length){return new it(this.maps,this.mirror,v,O)}copy(){return new it(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(v,O){this.to=this.maps.push(v),null!=O&&this.setMirror(this.maps.length-1,O)}appendMapping(v){for(let O=0,I=this.maps.length;O<v.maps.length;O++){let P=v.getMirror(O);this.appendMap(v.maps[O],null!=P&&P<O?I+P:void 0)}}getMirror(v){if(this.mirror)for(let O=0;O<this.mirror.length;O++)if(this.mirror[O]==v)return this.mirror[O+(O%2?-1:1)]}setMirror(v,O){this.mirror||(this.mirror=[]),this.mirror.push(v,O)}appendMappingInverted(v){for(let O=v.maps.length-1,I=this.maps.length+v.maps.length;O>=0;O--){let P=v.getMirror(O);this.appendMap(v.maps[O].invert(),null!=P&&P>O?I-P-1:void 0)}}invert(){let v=new it;return v.appendMappingInverted(this),v}map(v,O=1){if(this.mirror)return this._map(v,O,!0);for(let I=this.from;I<this.to;I++)v=this.maps[I].map(v,O);return v}mapResult(v,O=1){return this._map(v,O,!1)}_map(v,O,I){let P=0;for(let H=this.from;H<this.to;H++){let X=this.maps[H].mapResult(v,O);if(null!=X.recover){let yt=this.getMirror(H);if(null!=yt&&yt>H&&yt<this.to){H=yt,v=this.maps[yt].recover(X.recover);continue}}P|=X.delInfo,v=X.pos}return I?v:new et(v,P,null)}}const st=Object.create(null);class Et{getMap(){return mt.empty}merge(v){return null}static fromJSON(v,O){if(!O||!O.stepType)throw new RangeError("Invalid input for Step.fromJSON");let I=st[O.stepType];if(!I)throw new RangeError(`No step type ${O.stepType} defined`);return I.fromJSON(v,O)}static jsonID(v,O){if(v in st)throw new RangeError("Duplicate use of step JSON ID "+v);return st[v]=O,O.prototype.jsonID=v,O}}class _t{constructor(v,O){this.doc=v,this.failed=O}static ok(v){return new _t(v,null)}static fail(v){return new _t(null,v)}static fromReplace(v,O,I,P){try{return _t.ok(v.replace(O,I,P))}catch(H){if(H instanceof g.e4)return _t.fail(H.message);throw H}}}function ut(z,v,O){let I=[];for(let P=0;P<z.childCount;P++){let H=z.child(P);H.content.size&&(H=H.copy(ut(H.content,v,H))),H.isInline&&(H=v(H,O,P)),I.push(H)}return g.HY.fromArray(I)}class $ extends Et{constructor(v,O,I){super(),this.from=v,this.to=O,this.mark=I}apply(v){let O=v.slice(this.from,this.to),I=v.resolve(this.from),P=I.node(I.sharedDepth(this.to)),H=new g.p2(ut(O.content,(k,X)=>k.isAtom&&X.type.allowsMarkType(this.mark.type)?k.mark(this.mark.addToSet(k.marks)):k,P),O.openStart,O.openEnd);return _t.fromReplace(v,this.from,this.to,H)}invert(){return new W(this.from,this.to,this.mark)}map(v){let O=v.mapResult(this.from,1),I=v.mapResult(this.to,-1);return O.deleted&&I.deleted||O.pos>=I.pos?null:new $(O.pos,I.pos,this.mark)}merge(v){return v instanceof $&&v.mark.eq(this.mark)&&this.from<=v.to&&this.to>=v.from?new $(Math.min(this.from,v.from),Math.max(this.to,v.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(v,O){if("number"!=typeof O.from||"number"!=typeof O.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new $(O.from,O.to,v.markFromJSON(O.mark))}}Et.jsonID("addMark",$);class W extends Et{constructor(v,O,I){super(),this.from=v,this.to=O,this.mark=I}apply(v){let O=v.slice(this.from,this.to),I=new g.p2(ut(O.content,P=>P.mark(this.mark.removeFromSet(P.marks)),v),O.openStart,O.openEnd);return _t.fromReplace(v,this.from,this.to,I)}invert(){return new $(this.from,this.to,this.mark)}map(v){let O=v.mapResult(this.from,1),I=v.mapResult(this.to,-1);return O.deleted&&I.deleted||O.pos>=I.pos?null:new W(O.pos,I.pos,this.mark)}merge(v){return v instanceof W&&v.mark.eq(this.mark)&&this.from<=v.to&&this.to>=v.from?new W(Math.min(this.from,v.from),Math.max(this.to,v.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(v,O){if("number"!=typeof O.from||"number"!=typeof O.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new W(O.from,O.to,v.markFromJSON(O.mark))}}Et.jsonID("removeMark",W);class Q extends Et{constructor(v,O,I,P=!1){super(),this.from=v,this.to=O,this.slice=I,this.structure=P}apply(v){return this.structure&&pt(v,this.from,this.to)?_t.fail("Structure replace would overwrite content"):_t.fromReplace(v,this.from,this.to,this.slice)}getMap(){return new mt([this.from,this.to-this.from,this.slice.size])}invert(v){return new Q(this.from,this.from+this.slice.size,v.slice(this.from,this.to))}map(v){let O=v.mapResult(this.from,1),I=v.mapResult(this.to,-1);return O.deletedAcross&&I.deletedAcross?null:new Q(O.pos,Math.max(O.pos,I.pos),this.slice)}merge(v){if(!(v instanceof Q)||v.structure||this.structure)return null;if(this.from+this.slice.size!=v.from||this.slice.openEnd||v.slice.openStart){if(v.to!=this.from||this.slice.openStart||v.slice.openEnd)return null;{let O=this.slice.size+v.slice.size==0?g.p2.empty:new g.p2(v.slice.content.append(this.slice.content),v.slice.openStart,this.slice.openEnd);return new Q(v.from,this.to,O,this.structure)}}{let O=this.slice.size+v.slice.size==0?g.p2.empty:new g.p2(this.slice.content.append(v.slice.content),this.slice.openStart,v.slice.openEnd);return new Q(this.from,this.to+(v.to-v.from),O,this.structure)}}toJSON(){let v={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(v.slice=this.slice.toJSON()),this.structure&&(v.structure=!0),v}static fromJSON(v,O){if("number"!=typeof O.from||"number"!=typeof O.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Q(O.from,O.to,g.p2.fromJSON(v,O.slice),!!O.structure)}}Et.jsonID("replace",Q);class N extends Et{constructor(v,O,I,P,H,k,X=!1){super(),this.from=v,this.to=O,this.gapFrom=I,this.gapTo=P,this.slice=H,this.insert=k,this.structure=X}apply(v){if(this.structure&&(pt(v,this.from,this.gapFrom)||pt(v,this.gapTo,this.to)))return _t.fail("Structure gap-replace would overwrite content");let O=v.slice(this.gapFrom,this.gapTo);if(O.openStart||O.openEnd)return _t.fail("Gap is not a flat range");let I=this.slice.insertAt(this.insert,O.content);return I?_t.fromReplace(v,this.from,this.to,I):_t.fail("Content does not fit in gap")}getMap(){return new mt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(v){let O=this.gapTo-this.gapFrom;return new N(this.from,this.from+this.slice.size+O,this.from+this.insert,this.from+this.insert+O,v.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(v){let O=v.mapResult(this.from,1),I=v.mapResult(this.to,-1),P=v.map(this.gapFrom,-1),H=v.map(this.gapTo,1);return O.deletedAcross&&I.deletedAcross||P<O.pos||H>I.pos?null:new N(O.pos,I.pos,P,H,this.slice,this.insert,this.structure)}toJSON(){let v={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(v.slice=this.slice.toJSON()),this.structure&&(v.structure=!0),v}static fromJSON(v,O){if("number"!=typeof O.from||"number"!=typeof O.to||"number"!=typeof O.gapFrom||"number"!=typeof O.gapTo||"number"!=typeof O.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new N(O.from,O.to,O.gapFrom,O.gapTo,g.p2.fromJSON(v,O.slice),O.insert,!!O.structure)}}function pt(z,v,O){let I=z.resolve(v),P=O-v,H=I.depth;for(;P>0&&H>0&&I.indexAfter(H)==I.node(H).childCount;)H--,P--;if(P>0){let k=I.node(H).maybeChild(I.indexAfter(H));for(;P>0;){if(!k||k.isLeaf)return!0;k=k.firstChild,P--}}return!1}function ft(z,v,O){return(0==v||z.canReplace(v,z.childCount))&&(O==z.childCount||z.canReplace(0,O))}function xt(z){let O=z.parent.content.cutByIndex(z.startIndex,z.endIndex);for(let I=z.depth;;--I){let P=z.$from.node(I),H=z.$from.index(I),k=z.$to.indexAfter(I);if(I<z.depth&&P.canReplace(H,k,O))return I;if(0==I||P.type.spec.isolating||!ft(P,H,k))break}return null}function Ut(z,v,O=null,I=z){let P=function(z,v){let{parent:O,startIndex:I,endIndex:P}=z,H=O.contentMatchAt(I).findWrapping(v);return H&&O.canReplaceWith(I,P,H.length?H[0]:v)?H:null}(z,v),H=P&&function(z,v){let{parent:O,startIndex:I,endIndex:P}=z,H=O.child(I),k=v.contentMatch.findWrapping(H.type);if(!k)return null;let yt=(k.length?k[k.length-1]:v).contentMatch;for(let Pt=I;yt&&Pt<P;Pt++)yt=yt.matchType(O.child(Pt).type);return yt&&yt.validEnd?k:null}(I,v);return H?P.map(ot).concat({type:v,attrs:O}).concat(H.map(ot)):null}function ot(z){return{type:z,attrs:null}}function tt(z,v,O=1,I){let P=z.resolve(v),H=P.depth-O,k=I&&I[I.length-1]||P.parent;if(H<0||P.parent.type.spec.isolating||!P.parent.canReplace(P.index(),P.parent.childCount)||!k.type.validContent(P.parent.content.cutByIndex(P.index(),P.parent.childCount)))return!1;for(let Pt=P.depth-1,kt=O-2;Pt>H;Pt--,kt--){let wt=P.node(Pt),w=P.index(Pt);if(wt.type.spec.isolating)return!1;let l=wt.content.cutByIndex(w,wt.childCount),d=I&&I[kt]||wt;if(d!=wt&&(l=l.replaceChild(0,d.type.create(d.attrs))),!wt.canReplace(w+1,wt.childCount)||!d.type.validContent(l))return!1}let X=P.indexAfter(H),yt=I&&I[0];return P.node(H).canReplaceWith(X,X,yt?yt.type:P.node(H+1).type)}function It(z,v){let O=z.resolve(v),I=O.index();return function(z,v){return!(!z||!v||z.isLeaf||!z.canAppend(v))}(O.nodeBefore,O.nodeAfter)&&O.parent.canReplace(I,I+1)}function be(z,v,O){let I=z.resolve(v);if(!O.content.size)return v;let P=O.content;for(let H=0;H<O.openStart;H++)P=P.firstChild.content;for(let H=1;H<=(0==O.openStart&&O.size?2:1);H++)for(let k=I.depth;k>=0;k--){let X=k==I.depth?0:I.pos<=(I.start(k+1)+I.end(k+1))/2?-1:1,yt=I.index(k)+(X>0?1:0),Pt=I.node(k),kt=!1;if(1==H)kt=Pt.canReplace(yt,yt,P);else{let wt=Pt.contentMatchAt(yt).findWrapping(P.firstChild.type);kt=wt&&Pt.canReplaceWith(yt,yt,wt[0])}if(kt)return 0==X?I.pos:X<0?I.before(k+1):I.after(k+1)}return null}function Ae(z,v,O=v,I=g.p2.empty){if(v==O&&!I.size)return null;let P=z.resolve(v),H=z.resolve(O);return Ce(P,H,I)?new Q(v,O,I):new Gt(P,H,I).fit()}function Ce(z,v,O){return!O.openStart&&!O.openEnd&&z.start()==v.start()&&z.parent.canReplace(z.index(),v.index(),O.content)}Et.jsonID("replaceAround",N);class Gt{constructor(v,O,I){this.$from=v,this.$to=O,this.unplaced=I,this.frontier=[],this.placed=g.HY.empty;for(let P=0;P<=v.depth;P++){let H=v.node(P);this.frontier.push({type:H.type,match:H.contentMatchAt(v.indexAfter(P))})}for(let P=v.depth;P>0;P--)this.placed=g.HY.from(v.node(P).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let Pt=this.findFittable();Pt?this.placeNodes(Pt):this.openMore()||this.dropNode()}let v=this.mustMoveInline(),O=this.placed.size-this.depth-this.$from.depth,I=this.$from,P=this.close(v<0?this.$to:I.doc.resolve(v));if(!P)return null;let H=this.placed,k=I.depth,X=P.depth;for(;k&&X&&1==H.childCount;)H=H.firstChild.content,k--,X--;let yt=new g.p2(H,k,X);return v>-1?new N(I.pos,v,this.$to.pos,this.$to.end(),yt,O):yt.size||I.pos!=this.$to.pos?new Q(I.pos,P.pos,yt):null}findFittable(){for(let v=1;v<=2;v++)for(let O=this.unplaced.openStart;O>=0;O--){let I,P=null;O?(P=oe(this.unplaced.content,O-1).firstChild,I=P.content):I=this.unplaced.content;let H=I.firstChild;for(let k=this.depth;k>=0;k--){let Pt,{type:X,match:yt}=this.frontier[k],kt=null;if(1==v&&(H?yt.matchType(H.type)||(kt=yt.fillBefore(g.HY.from(H),!1)):P&&X.compatibleContent(P.type)))return{sliceDepth:O,frontierDepth:k,parent:P,inject:kt};if(2==v&&H&&(Pt=yt.findWrapping(H.type)))return{sliceDepth:O,frontierDepth:k,parent:P,wrap:Pt};if(P&&yt.matchType(P.type))break}}}openMore(){let{content:v,openStart:O,openEnd:I}=this.unplaced,P=oe(v,O);return!(!P.childCount||P.firstChild.isLeaf||(this.unplaced=new g.p2(v,O+1,Math.max(I,P.size+O>=v.size-I?O+1:0)),0))}dropNode(){let{content:v,openStart:O,openEnd:I}=this.unplaced,P=oe(v,O);if(P.childCount<=1&&O>0){let H=v.size-O<=O+P.size;this.unplaced=new g.p2(pe(v,O-1,1),O-1,H?O-1:I)}else this.unplaced=new g.p2(pe(v,O,1),O,I)}placeNodes({sliceDepth:v,frontierDepth:O,parent:I,inject:P,wrap:H}){for(;this.depth>O;)this.closeFrontierNode();if(H)for(let m=0;m<H.length;m++)this.openFrontierNode(H[m]);let k=this.unplaced,X=I?I.content:k.content,yt=k.openStart-v,Pt=0,kt=[],{match:wt,type:w}=this.frontier[O];if(P){for(let m=0;m<P.childCount;m++)kt.push(P.child(m));wt=wt.matchFragment(P)}let l=X.size+v-(k.content.size-k.openEnd);for(;Pt<X.childCount;){let m=X.child(Pt),E=wt.matchType(m.type);if(!E)break;Pt++,(Pt>1||0==yt||m.content.size)&&(wt=E,kt.push(Ne(m.mark(w.allowedMarks(m.marks)),1==Pt?yt:0,Pt==X.childCount?l:-1)))}let d=Pt==X.childCount;d||(l=-1),this.placed=he(this.placed,O,g.HY.from(kt)),this.frontier[O].match=wt,d&&l<0&&I&&I.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,E=X;m<l;m++){let A=E.lastChild;this.frontier.push({type:A.type,match:A.contentMatchAt(A.childCount)}),E=A.content}this.unplaced=d?0==v?g.p2.empty:new g.p2(pe(k.content,v-1,1),v-1,l<0?k.openEnd:v-1):new g.p2(pe(k.content,v,Pt),k.openStart,k.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let O,v=this.frontier[this.depth];if(!v.type.isTextblock||!Xt(this.$to,this.$to.depth,v.type,v.match,!1)||this.$to.depth==this.depth&&(O=this.findCloseLevel(this.$to))&&O.depth==this.depth)return-1;let{depth:I}=this.$to,P=this.$to.after(I);for(;I>1&&P==this.$to.end(--I);)++P;return P}findCloseLevel(v){t:for(let O=Math.min(this.depth,v.depth);O>=0;O--){let{match:I,type:P}=this.frontier[O],H=O<v.depth&&v.end(O+1)==v.pos+(v.depth-(O+1)),k=Xt(v,O,P,I,H);if(k){for(let X=O-1;X>=0;X--){let{match:yt,type:Pt}=this.frontier[X],kt=Xt(v,X,Pt,yt,!0);if(!kt||kt.childCount)continue t}return{depth:O,fit:k,move:H?v.doc.resolve(v.after(O+1)):v}}}}close(v){let O=this.findCloseLevel(v);if(!O)return null;for(;this.depth>O.depth;)this.closeFrontierNode();O.fit.childCount&&(this.placed=he(this.placed,O.depth,O.fit)),v=O.move;for(let I=O.depth+1;I<=v.depth;I++){let P=v.node(I),H=P.type.contentMatch.fillBefore(P.content,!0,v.index(I));this.openFrontierNode(P.type,P.attrs,H)}return v}openFrontierNode(v,O=null,I){let P=this.frontier[this.depth];P.match=P.match.matchType(v),this.placed=he(this.placed,this.depth,g.HY.from(v.create(O,I))),this.frontier.push({type:v,match:v.contentMatch})}closeFrontierNode(){let O=this.frontier.pop().match.fillBefore(g.HY.empty,!0);O.childCount&&(this.placed=he(this.placed,this.frontier.length,O))}}function pe(z,v,O){return 0==v?z.cutByIndex(O,z.childCount):z.replaceChild(0,z.firstChild.copy(pe(z.firstChild.content,v-1,O)))}function he(z,v,O){return 0==v?z.append(O):z.replaceChild(z.childCount-1,z.lastChild.copy(he(z.lastChild.content,v-1,O)))}function oe(z,v){for(let O=0;O<v;O++)z=z.firstChild.content;return z}function Ne(z,v,O){if(v<=0)return z;let I=z.content;return v>1&&(I=I.replaceChild(0,Ne(I.firstChild,v-1,1==I.childCount?O-1:0))),v>0&&(I=z.type.contentMatch.fillBefore(I).append(I),O<=0&&(I=I.append(z.type.contentMatch.matchFragment(I).fillBefore(g.HY.empty,!0)))),z.copy(I)}function Xt(z,v,O,I,P){let H=z.node(v),k=P?z.indexAfter(v):z.index(v);if(k==H.childCount&&!O.compatibleContent(H.type))return null;let X=I.fillBefore(H.content,!0,k);return X&&!function(z,v,O){for(let I=O;I<v.childCount;I++)if(!z.allowsMarks(v.child(I).marks))return!0;return!1}(O,H.content,k)?X:null}function Ee(z){return z.spec.defining||z.spec.definingForContent}function me(z,v,O,I,P){if(v<O){let H=z.firstChild;z=z.replaceChild(0,H.copy(me(H.content,v+1,O,I,H)))}if(v>I){let H=P.contentMatchAt(0),k=H.fillBefore(z).append(z);z=k.append(H.matchFragment(k).fillBefore(g.HY.empty,!0))}return z}function ee(z,v){let O=[];for(let P=Math.min(z.depth,v.depth);P>=0;P--){let H=z.start(P);if(H<z.pos-(z.depth-P)||v.end(P)>v.pos+(v.depth-P)||z.node(P).type.spec.isolating||v.node(P).type.spec.isolating)break;(H==v.start(P)||P==z.depth&&P==v.depth&&z.parent.inlineContent&&v.parent.inlineContent&&P&&v.start(P-1)==H-1)&&O.push(P)}return O}let te=class extends Error{};te=function z(v){let O=Error.call(this,v);return O.__proto__=z.prototype,O},(te.prototype=Object.create(Error.prototype)).constructor=te,te.prototype.name="TransformError";class fe{constructor(v){this.doc=v,this.steps=[],this.docs=[],this.mapping=new it}get before(){return this.docs.length?this.docs[0]:this.doc}step(v){let O=this.maybeStep(v);if(O.failed)throw new te(O.failed);return this}maybeStep(v){let O=v.apply(this.doc);return O.failed||this.addStep(v,O.doc),O}get docChanged(){return this.steps.length>0}addStep(v,O){this.docs.push(this.doc),this.steps.push(v),this.mapping.appendMap(v.getMap()),this.doc=O}replace(v,O=v,I=g.p2.empty){let P=Ae(this.doc,v,O,I);return P&&this.step(P),this}replaceWith(v,O,I){return this.replace(v,O,new g.p2(g.HY.from(I),0,0))}delete(v,O){return this.replace(v,O,g.p2.empty)}insert(v,O){return this.replaceWith(v,v,O)}replaceRange(v,O,I){return function(z,v,O,I){if(!I.size)return z.deleteRange(v,O);let P=z.doc.resolve(v),H=z.doc.resolve(O);if(Ce(P,H,I))return z.step(new Q(v,O,I));let k=ee(P,z.doc.resolve(O));0==k[k.length-1]&&k.pop();let X=-(P.depth+1);k.unshift(X);for(let w=P.depth,l=P.pos-1;w>0;w--,l--){let d=P.node(w).type.spec;if(d.defining||d.definingAsContext||d.isolating)break;k.indexOf(w)>-1?X=w:P.before(w)==l&&k.splice(1,0,-w)}let yt=k.indexOf(X),Pt=[],kt=I.openStart;for(let w=I.content,l=0;;l++){let d=w.firstChild;if(Pt.push(d),l==I.openStart)break;w=d.content}for(let w=kt-1;w>=0;w--){let l=Pt[w].type,d=Ee(l);if(d&&P.node(yt).type!=l)kt=w;else if(d||!l.isTextblock)break}for(let w=I.openStart;w>=0;w--){let l=(w+kt+1)%(I.openStart+1),d=Pt[l];if(d)for(let m=0;m<k.length;m++){let E=k[(m+yt)%k.length],A=!0;E<0&&(A=!1,E=-E);let F=P.node(E-1),lt=P.index(E-1);if(F.canReplaceWith(lt,lt,d.type,d.marks))return z.replace(P.before(E),A?H.after(E):O,new g.p2(me(I.content,0,I.openStart,l),l,I.openEnd))}}let wt=z.steps.length;for(let w=k.length-1;w>=0&&(z.replace(v,O,I),!(z.steps.length>wt));w--){let l=k[w];l<0||(v=P.before(l),O=H.after(l))}}(this,v,O,I),this}replaceRangeWith(v,O,I){return function(z,v,O,I){if(!I.isInline&&v==O&&z.doc.resolve(v).parent.content.size){let P=function(z,v,O){let I=z.resolve(v);if(I.parent.canReplaceWith(I.index(),I.index(),O))return v;if(0==I.parentOffset)for(let P=I.depth-1;P>=0;P--){let H=I.index(P);if(I.node(P).canReplaceWith(H,H,O))return I.before(P+1);if(H>0)return null}if(I.parentOffset==I.parent.content.size)for(let P=I.depth-1;P>=0;P--){let H=I.indexAfter(P);if(I.node(P).canReplaceWith(H,H,O))return I.after(P+1);if(H<I.node(P).childCount)return null}return null}(z.doc,v,I.type);null!=P&&(v=O=P)}z.replaceRange(v,O,new g.p2(g.HY.from(I),0,0))}(this,v,O,I),this}deleteRange(v,O){return function(z,v,O){let I=z.doc.resolve(v),P=z.doc.resolve(O),H=ee(I,P);for(let k=0;k<H.length;k++){let X=H[k],yt=k==H.length-1;if(yt&&0==X||I.node(X).type.contentMatch.validEnd)return z.delete(I.start(X),P.end(X));if(X>0&&(yt||I.node(X-1).canReplace(I.index(X-1),P.indexAfter(X-1))))return z.delete(I.before(X),P.after(X))}for(let k=1;k<=I.depth&&k<=P.depth;k++)if(v-I.start(k)==I.depth-k&&O>I.end(k)&&P.end(k)-O!=P.depth-k)return z.delete(I.before(k),O);z.delete(v,O)}(this,v,O),this}lift(v,O){return function(z,v,O){let{$from:I,$to:P,depth:H}=v,k=I.before(H+1),X=P.after(H+1),yt=k,Pt=X,kt=g.HY.empty,wt=0;for(let d=H,m=!1;d>O;d--)m||I.index(d)>0?(m=!0,kt=g.HY.from(I.node(d).copy(kt)),wt++):yt--;let w=g.HY.empty,l=0;for(let d=H,m=!1;d>O;d--)m||P.after(d+1)<P.end(d)?(m=!0,w=g.HY.from(P.node(d).copy(w)),l++):Pt++;z.step(new N(yt,Pt,k,X,new g.p2(kt.append(w),wt,l),kt.size-wt,!0))}(this,v,O),this}join(v,O=1){return function(z,v,O){let I=new Q(v-O,v+O,g.p2.empty,!0);z.step(I)}(this,v,O),this}wrap(v,O){return function(z,v,O){let I=g.HY.empty;for(let k=O.length-1;k>=0;k--){if(I.size){let X=O[k].type.contentMatch.matchFragment(I);if(!X||!X.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}I=g.HY.from(O[k].type.create(O[k].attrs,I))}let P=v.start,H=v.end;z.step(new N(P,H,P,H,new g.p2(I,0,0),O.length,!0))}(this,v,O),this}setBlockType(v,O=v,I,P=null){return function(z,v,O,I,P){if(!I.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let H=z.steps.length;z.doc.nodesBetween(v,O,(k,X)=>{if(k.isTextblock&&!k.hasMarkup(I,P)&&function(z,v,O){let I=z.resolve(v),P=I.index();return I.parent.canReplaceWith(P,P+1,O)}(z.doc,z.mapping.slice(H).map(X),I)){z.clearIncompatible(z.mapping.slice(H).map(X,1),I);let yt=z.mapping.slice(H),Pt=yt.map(X,1),kt=yt.map(X+k.nodeSize,1);return z.step(new N(Pt,kt,Pt+1,kt-1,new g.p2(g.HY.from(I.create(P,null,k.marks)),0,0),1,!0)),!1}})}(this,v,O,I,P),this}setNodeMarkup(v,O,I=null,P=[]){return function(z,v,O,I,P){let H=z.doc.nodeAt(v);if(!H)throw new RangeError("No node at given position");O||(O=H.type);let k=O.create(I,null,P||H.marks);if(H.isLeaf)return z.replaceWith(v,v+H.nodeSize,k);if(!O.validContent(H.content))throw new RangeError("Invalid content for node type "+O.name);z.step(new N(v,v+H.nodeSize,v+1,v+H.nodeSize-1,new g.p2(g.HY.from(k),0,0),1,!0))}(this,v,O,I,P),this}split(v,O=1,I){return function(z,v,O=1,I){let P=z.doc.resolve(v),H=g.HY.empty,k=g.HY.empty;for(let X=P.depth,yt=P.depth-O,Pt=O-1;X>yt;X--,Pt--){H=g.HY.from(P.node(X).copy(H));let kt=I&&I[Pt];k=g.HY.from(kt?kt.type.create(kt.attrs,k):P.node(X).copy(k))}z.step(new Q(v,v,new g.p2(H.append(k),O,O),!0))}(this,v,O,I),this}addMark(v,O,I){return function(z,v,O,I){let k,X,P=[],H=[];z.doc.nodesBetween(v,O,(yt,Pt,kt)=>{if(!yt.isInline)return;let wt=yt.marks;if(!I.isInSet(wt)&&kt.type.allowsMarkType(I.type)){let w=Math.max(Pt,v),l=Math.min(Pt+yt.nodeSize,O),d=I.addToSet(wt);for(let m=0;m<wt.length;m++)wt[m].isInSet(d)||(k&&k.to==w&&k.mark.eq(wt[m])?k.to=l:P.push(k=new W(w,l,wt[m])));X&&X.to==w?X.to=l:H.push(X=new $(w,l,I))}}),P.forEach(yt=>z.step(yt)),H.forEach(yt=>z.step(yt))}(this,v,O,I),this}removeMark(v,O,I){return function(z,v,O,I){let P=[],H=0;z.doc.nodesBetween(v,O,(k,X)=>{if(!k.isInline)return;H++;let yt=null;if(I instanceof g.ZU){let kt,Pt=k.marks;for(;kt=I.isInSet(Pt);)(yt||(yt=[])).push(kt),Pt=kt.removeFromSet(Pt)}else I?I.isInSet(k.marks)&&(yt=[I]):yt=k.marks;if(yt&&yt.length){let Pt=Math.min(X+k.nodeSize,O);for(let kt=0;kt<yt.length;kt++){let w,wt=yt[kt];for(let l=0;l<P.length;l++){let d=P[l];d.step==H-1&&wt.eq(P[l].style)&&(w=d)}w?(w.to=Pt,w.step=H):P.push({style:wt,from:Math.max(X,v),to:Pt,step:H})}}}),P.forEach(k=>z.step(new W(k.from,k.to,k.style)))}(this,v,O,I),this}clearIncompatible(v,O,I){return function(z,v,O,I=O.contentMatch){let P=z.doc.nodeAt(v),H=[],k=v+1;for(let X=0;X<P.childCount;X++){let yt=P.child(X),Pt=k+yt.nodeSize,kt=I.matchType(yt.type);if(kt){I=kt;for(let wt=0;wt<yt.marks.length;wt++)O.allowsMarkType(yt.marks[wt].type)||z.step(new W(k,Pt,yt.marks[wt]))}else H.push(new Q(k,Pt,g.p2.empty));k=Pt}if(!I.validEnd){let X=I.fillBefore(g.HY.empty,!0);z.replace(k,k,new g.p2(X,0,0))}for(let X=H.length-1;X>=0;X--)z.step(H[X])}(this,v,O,I),this}}},43594:(St,dt,u)=>{u.d(dt,{p:()=>Oe,EH:()=>re,tk:()=>Io});var g=u(62463),s=u(35917),L=u(38480);const y="undefined"!=typeof navigator?navigator:null,f="undefined"!=typeof document?document:null,q=y&&y.userAgent||"",b=/Edge\/(\d+)/.exec(q),nt=/MSIE \d/.exec(q),j=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(q),at=!!(nt||j||b),et=nt?document.documentMode:j?+j[1]:b?+b[1]:0,mt=!at&&/gecko\/(\d+)/i.test(q);mt&&/Firefox\/(\d+)/.exec(q);const it=!at&&/Chrome\/(\d+)/.exec(q),st=!!it,Et=it?+it[1]:0,_t=!at&&!!y&&/Apple Computer/.test(y.vendor),ut=_t&&(/Mobile\/\w+/.test(q)||!!y&&y.maxTouchPoints>2),$=ut||!!y&&/Mac/.test(y.platform),W=/Android \d/.test(q),Q=!!f&&"webkitFontSmoothing"in f.documentElement.style,N=Q?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,pt=function(n){for(var t=0;;t++)if(!(n=n.previousSibling))return t},ht=function(n){let t=n.assignedSlot||n.parentNode;return t&&11==t.nodeType?t.host:t};let gt=null;const Tt=function(n,t,e){let o=gt||(gt=document.createRange());return o.setEnd(n,null==e?n.nodeValue.length:e),o.setStart(n,t||0),o},ft=function(n,t,e,o){return e&&(Dt(n,t,e,o,-1)||Dt(n,t,e,o,1))},xt=/^(img|br|input|textarea|hr)$/i;function Dt(n,t,e,o,i){for(;;){if(n==e&&t==o)return!0;if(t==(i<0?0:Ut(n))){let r=n.parentNode;if(!r||1!=r.nodeType||x(n)||xt.test(n.nodeName)||"false"==n.contentEditable)return!1;t=pt(n)+(i<0?0:1),n=r}else{if(1!=n.nodeType)return!1;if("false"==(n=n.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?Ut(n):0}}}function Ut(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function x(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const Z=function(n){let t=n.isCollapsed;return t&&st&&n.rangeCount&&!n.getRangeAt(0).collapsed&&(t=!1),t};function Y(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function ct(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function R(n,t){return"number"==typeof n?n:n[t]}function V(n){let t=n.getBoundingClientRect();return{left:t.left,right:t.left+n.clientWidth*(t.width/n.offsetWidth||1),top:t.top,bottom:t.top+n.clientHeight*(t.height/n.offsetHeight||1)}}function tt(n,t,e){let o=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,r=n.dom.ownerDocument;for(let c=e||n.dom;c;c=ht(c)){if(1!=c.nodeType)continue;let p=c,h=p==r.body,C=h?ct(r):V(p),M=0,B=0;if(t.top<C.top+R(o,"top")?B=-(C.top-t.top+R(i,"top")):t.bottom>C.bottom-R(o,"bottom")&&(B=t.bottom-C.bottom+R(i,"bottom")),t.left<C.left+R(o,"left")?M=-(C.left-t.left+R(i,"left")):t.right>C.right-R(o,"right")&&(M=t.right-C.right+R(i,"right")),M||B)if(h)r.defaultView.scrollBy(M,B);else{let U=p.scrollLeft,K=p.scrollTop;B&&(p.scrollTop+=B),M&&(p.scrollLeft+=M);let rt=p.scrollLeft-U,Mt=p.scrollTop-K;t={left:t.left-rt,top:t.top-Mt,right:t.right-rt,bottom:t.bottom-Mt}}if(h)break}}function It(n){let t=[],e=n.ownerDocument;for(let o=n;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),n!=e);o=ht(o));return t}function $t(n,t){for(let e=0;e<n.length;e++){let{dom:o,top:i,left:r}=n[e];o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=r&&(o.scrollLeft=r)}}let Jt=null;function be(n,t){let e,i,o=2e8,r=0,c=t.top,p=t.top;for(let h=n.firstChild,C=0;h;h=h.nextSibling,C++){let M;if(1==h.nodeType)M=h.getClientRects();else{if(3!=h.nodeType)continue;M=Tt(h).getClientRects()}for(let B=0;B<M.length;B++){let U=M[B];if(U.top<=c&&U.bottom>=p){c=Math.max(U.bottom,c),p=Math.min(U.top,p);let K=U.left>t.left?U.left-t.left:U.right<t.left?t.left-U.right:0;if(K<o){e=h,o=K,i=K&&3==e.nodeType?{left:U.right<t.left?U.right:U.left,top:t.top}:t,1==h.nodeType&&K&&(r=C+(t.left>=(U.left+U.right)/2?1:0));continue}}!e&&(t.left>=U.right&&t.top>=U.top||t.left>=U.left&&t.top>=U.bottom)&&(r=C+1)}}return e&&3==e.nodeType?function(n,t){let e=n.nodeValue.length,o=document.createRange();for(let i=0;i<e;i++){o.setEnd(n,i+1),o.setStart(n,i);let r=Xt(o,1);if(r.top!=r.bottom&&Ce(t,r))return{node:n,offset:i+(t.left>=(r.left+r.right)/2?1:0)}}return{node:n,offset:0}}(e,i):!e||o&&1==e.nodeType?{node:n,offset:r}:be(e,i)}function Ce(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function oe(n,t,e){let o=n.childNodes.length;if(o&&e.top<e.bottom)for(let i=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-e.top)/(e.bottom-e.top))-2)),r=i;;){let c=n.childNodes[r];if(1==c.nodeType){let p=c.getClientRects();for(let h=0;h<p.length;h++){let C=p[h];if(Ce(t,C))return oe(c,t,C)}}if((r=(r+1)%o)==i)break}return n}function Ne(n,t){let o,e=n.dom.ownerDocument,i=0;if(e.caretPositionFromPoint)try{let h=e.caretPositionFromPoint(t.left,t.top);h&&({offsetNode:o,offset:i}=h)}catch(h){}if(!o&&e.caretRangeFromPoint){let h=e.caretRangeFromPoint(t.left,t.top);h&&({startContainer:o,startOffset:i}=h)}let c,r=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top);if(!r||!n.dom.contains(1!=r.nodeType?r.parentNode:r)){let h=n.dom.getBoundingClientRect();if(!Ce(t,h)||(r=oe(n.dom,t,h),!r))return null}if(_t)for(let h=r;o&&h;h=ht(h))h.draggable&&(o=void 0);if(r=function(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}(r,t),o){if(mt&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length),i<o.childNodes.length)){let C,h=o.childNodes[i];"IMG"==h.nodeName&&(C=h.getBoundingClientRect()).right<=t.left&&C.bottom>t.top&&i++}o==n.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?c=n.state.doc.content.size:(0==i||1!=o.nodeType||"BR"!=o.childNodes[i-1].nodeName)&&(c=function(n,t,e,o){let i=-1;for(let r=t;r!=n.dom;){let c=n.docView.nearestDesc(r,!0);if(!c)return null;if(c.node.isBlock&&c.parent){let p=c.dom.getBoundingClientRect();if(p.left>o.left||p.top>o.top)i=c.posBefore;else{if(!(p.right<o.left||p.bottom<o.top))break;i=c.posAfter}}r=c.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,1)}(n,o,i,t))}null==c&&(c=function(n,t,e){let{node:o,offset:i}=be(t,e),r=-1;if(1==o.nodeType&&!o.firstChild){let c=o.getBoundingClientRect();r=c.left!=c.right&&e.left>(c.left+c.right)/2?1:-1}return n.docView.posFromDOM(o,i,r)}(n,r,t));let p=n.docView.nearestDesc(r,!0);return{pos:c,inside:p?p.posAtStart-p.border:-1}}function Xt(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const Zt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Ee(n,t,e){let{node:o,offset:i,atom:r}=n.docView.domFromPos(t,e<0?-1:1),c=Q||mt;if(3==o.nodeType){if(!c||!Zt.test(o.nodeValue)&&(e<0?i:i!=o.nodeValue.length)){let h=i,C=i,M=e<0?1:-1;return e<0&&!i?(C++,M=-1):e>=0&&i==o.nodeValue.length?(h--,M=1):e<0?h--:C++,le(Xt(Tt(o,h,C),M),M<0)}{let h=Xt(Tt(o,i,i),e);if(mt&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){let C=Xt(Tt(o,i-1,i-1),-1);if(C.top==h.top){let M=Xt(Tt(o,i,i+1),-1);if(M.top!=h.top)return le(M,M.left<C.left)}}return h}}if(!n.state.doc.resolve(t-(r||0)).parent.inlineContent){if(null==r&&i&&(e<0||i==Ut(o))){let h=o.childNodes[i-1];if(1==h.nodeType)return me(h.getBoundingClientRect(),!1)}if(null==r&&i<Ut(o)){let h=o.childNodes[i];if(1==h.nodeType)return me(h.getBoundingClientRect(),!0)}return me(o.getBoundingClientRect(),e>=0)}if(null==r&&i&&(e<0||i==Ut(o))){let h=o.childNodes[i-1],C=3==h.nodeType?Tt(h,Ut(h)-(c?0:1)):1!=h.nodeType||"BR"==h.nodeName&&h.nextSibling?null:h;if(C)return le(Xt(C,1),!1)}if(null==r&&i<Ut(o)){let h=o.childNodes[i];for(;h.pmViewDesc&&h.pmViewDesc.ignoreForCoords;)h=h.nextSibling;let C=h?3==h.nodeType?Tt(h,0,c?0:1):1==h.nodeType?h:null:null;if(C)return le(Xt(C,-1),!0)}return le(Xt(3==o.nodeType?Tt(o):o,-e),e>=0)}function le(n,t){if(0==n.width)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function me(n,t){if(0==n.height)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Se(n,t,e){let o=n.state,i=n.root.activeElement;o!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{o!=t&&n.updateState(o),i!=n.dom&&i&&i.focus()}}const ee=/[\u0590-\u08ac]/;let fe=null,z=null,v=!1;class X{constructor(t,e,o,i){this.parent=t,this.children=e,this.dom=o,this.contentDOM=i,this.dirty=0,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,o=this.posAtStart;;e++){let i=this.children[e];if(i==t)return o;o+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,o){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(o<0){let r,c;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(c=r.pmViewDesc)||c.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(c)+c.size:this.posAtStart}{let r,c;if(t==this.contentDOM)r=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.nextSibling}for(;r&&(!(c=r.pmViewDesc)||c.parent!=this);)r=r.nextSibling;return r?this.posBeforeChild(c):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>pt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!1;break}if(r.previousSibling)break}if(null==i&&e==t.childNodes.length)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!0;break}if(r.nextSibling)break}}return(null==i?o>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let o=!0,i=t;i;i=i.parentNode){let c,r=this.getDesc(i);if(r&&(!e||r.node)){if(!o||!(c=r.nodeDOM)||(1==c.nodeType?c.contains(1==t.nodeType?t:t.parentNode):c==t))return r;o=!1}}}getDesc(t){let e=t.pmViewDesc;for(let o=e;o;o=o.parent)if(o==this)return e}posFromDOM(t,e,o){for(let i=t;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(t,e,o)}return-1}descAt(t){for(let e=0,o=0;e<this.children.length;e++){let i=this.children[e],r=o+i.size;if(o==t&&r!=o){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<r)return i.descAt(t-o-i.border);o=r}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r,o=0,i=0;for(let r=0;o<this.children.length;o++){let c=this.children[o],p=r+c.size;if(p>t||c instanceof d){i=t-r;break}r=p}if(i)return this.children[o].domFromPos(i-this.children[o].border,e);for(;o&&!(r=this.children[o-1]).size&&r instanceof yt&&r.side>=0;o--);if(e<=0){let r,c=!0;for(;r=o?this.children[o-1]:null,r&&r.dom.parentNode!=this.contentDOM;o--,c=!1);return r&&e&&c&&!r.border&&!r.domAtom?r.domFromPos(r.size,e):{node:this.contentDOM,offset:r?pt(r.dom)+1:0}}{let r,c=!0;for(;r=o<this.children.length?this.children[o]:null,r&&r.dom.parentNode!=this.contentDOM;o++,c=!1);return r&&c&&!r.border&&!r.domAtom?r.domFromPos(0,e):{node:this.contentDOM,offset:r?pt(r.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,o=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let c=o,p=0;;p++){let h=this.children[p],C=c+h.size;if(-1==i&&t<=C){let M=c+h.border;if(t>=M&&e<=C-h.border&&h.node&&h.contentDOM&&this.contentDOM.contains(h.contentDOM))return h.parseRange(t,e,M);t=c;for(let B=p;B>0;B--){let U=this.children[B-1];if(U.size&&U.dom.parentNode==this.contentDOM&&!U.emptyChildAt(1)){i=pt(U.dom)+1;break}t-=U.size}-1==i&&(i=0)}if(i>-1&&(C>e||p==this.children.length-1)){e=C;for(let M=p+1;M<this.children.length;M++){let B=this.children[M];if(B.size&&B.dom.parentNode==this.contentDOM&&!B.emptyChildAt(-1)){r=pt(B.dom);break}e+=B.size}-1==r&&(r=this.contentDOM.childNodes.length);break}c=C}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:o}=this.domFromPos(t,0);if(1!=e.nodeType||o==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[o]}setSelection(t,e,o,i=!1){let r=Math.min(t,e),c=Math.max(t,e);for(let U=0,K=0;U<this.children.length;U++){let rt=this.children[U],Mt=K+rt.size;if(r>K&&c<Mt)return rt.setSelection(t-K-rt.border,e-K-rt.border,o,i);K=Mt}let p=this.domFromPos(t,t?-1:1),h=e==t?p:this.domFromPos(e,e?-1:1),C=o.getSelection(),M=!1;if((mt||_t)&&t==e){let{node:U,offset:K}=p;if(3==U.nodeType){if(M=!(!K||"\n"!=U.nodeValue[K-1]),M&&K==U.nodeValue.length)for(let Mt,rt=U;rt;rt=rt.parentNode){if(Mt=rt.nextSibling){"BR"==Mt.nodeName&&(p=h={node:Mt.parentNode,offset:pt(Mt)+1});break}let bt=rt.pmViewDesc;if(bt&&bt.node&&bt.node.isBlock)break}}else{let rt=U.childNodes[K-1];M=rt&&("BR"==rt.nodeName||"false"==rt.contentEditable)}}if(mt&&C.focusNode&&C.focusNode!=h.node&&1==C.focusNode.nodeType){let U=C.focusNode.childNodes[C.focusOffset];U&&"false"==U.contentEditable&&(i=!0)}if(!(i||M&&_t)&&ft(p.node,p.offset,C.anchorNode,C.anchorOffset)&&ft(h.node,h.offset,C.focusNode,C.focusOffset))return;let B=!1;if((C.extend||t==e)&&!M){C.collapse(p.node,p.offset);try{t!=e&&C.extend(h.node,h.offset),B=!0}catch(U){if(!(U instanceof DOMException))throw U}}if(!B){if(t>e){let K=p;p=h,h=K}let U=document.createRange();U.setEnd(h.node,h.offset),U.setStart(p.node,p.offset),C.removeAllRanges(),C.addRange(U)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let o=0,i=0;i<this.children.length;i++){let r=this.children[i],c=o+r.size;if(o==c?t<=c&&e>=o:t<c&&e>o){let p=o+r.border,h=c-r.border;if(t>=p&&e<=h)return this.dirty=t==o||e==c?2:1,void(t!=p||e!=h||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-p,e-p):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}o=c}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let o=1==t?2:1;e.dirty<o&&(e.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class yt extends X{constructor(t,e,o,i){let r,c=e.type.toDOM;if("function"==typeof c&&(c=c(o,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!e.type.spec.raw){if(1!=c.nodeType){let p=document.createElement("span");p.appendChild(c),c=p}c.contentEditable="false",c.classList.add("ProseMirror-widget")}super(t,[],c,null),this.widget=e,this.widget=e,r=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Pt extends X{constructor(t,e,o,i){super(t,[],e,null),this.textDOM=o,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class kt extends X{constructor(t,e,o,i){super(t,[],o,i),this.mark=e}static create(t,e,o,i){let r=i.nodeViews[e.type.name],c=r&&r(e,i,o);return(!c||!c.dom)&&(c=s.PW.renderSpec(document,e.type.spec.toDOM(e,o))),new kt(t,e,c.dom,c.contentDOM||c.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}}slice(t,e,o){let i=kt.create(this.parent,this.mark,!0,o),r=this.children,c=this.size;e<c&&(r=qe(r,e,c,o)),t>0&&(r=qe(r,0,t,o));for(let p=0;p<r.length;p++)r[p].parent=i;return i.children=r,i}}class wt extends X{constructor(t,e,o,i,r,c,p,h,C){super(t,[],r,c),this.node=e,this.outerDeco=o,this.innerDeco=i,this.nodeDOM=p,c&&this.updateChildren(h,C)}static create(t,e,o,i,r,c){let h,p=r.nodeViews[e.type.name],C=p&&p(e,r,()=>h?h.parent?h.parent.posBeforeChild(h):void 0:c,o,i),M=C&&C.dom,B=C&&C.contentDOM;if(e.isText)if(M){if(3!=M.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else M=document.createTextNode(e.text);else M||({dom:M,contentDOM:B}=s.PW.renderSpec(document,e.type.spec.toDOM(e)));!B&&!e.isText&&"BR"!=M.nodeName&&(M.hasAttribute("contenteditable")||(M.contentEditable="false"),e.type.spec.draggable&&(M.draggable=!0));let U=M;return M=Nt(M,o,e),C?h=new m(t,e,o,i,M,B||null,U,C,r,c+1):e.isText?new l(t,e,o,i,M,U,r):new wt(t,e,o,i,M,B||null,U,r,c+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let o=this.children[e];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>s.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,o){return 0==this.dirty&&t.eq(this.node)&&ne(e,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let o=this.node.inlineContent,i=e,r=t.composing?this.localCompositionInfo(t,e):null,c=r&&r.pos>-1?r:null,p=r&&r.pos<0,h=new ae(this,c&&c.node);(function(n,t,e,o){let i=t.locals(n),r=0;if(0==i.length){for(let C=0;C<n.childCount;C++){let M=n.child(C);o(M,i,t.forChild(r,M),C),r+=M.nodeSize}return}let c=0,p=[],h=null;for(let C=0;;){if(c<i.length&&i[c].to==r){let Mt,rt=i[c++];for(;c<i.length&&i[c].to==r;)(Mt||(Mt=[rt])).push(i[c++]);if(Mt){Mt.sort(He);for(let bt=0;bt<Mt.length;bt++)e(Mt[bt],C,!!h)}else e(rt,C,!!h)}let M,B;if(h)B=-1,M=h,h=null;else{if(!(C<n.childCount))break;B=C,M=n.child(C++)}for(let rt=0;rt<p.length;rt++)p[rt].to<=r&&p.splice(rt--,1);for(;c<i.length&&i[c].from<=r&&i[c].to>r;)p.push(i[c++]);let U=r+M.nodeSize;if(M.isText){let rt=U;c<i.length&&i[c].from<rt&&(rt=i[c].from);for(let Mt=0;Mt<p.length;Mt++)p[Mt].to<rt&&(rt=p[Mt].to);rt<U&&(h=M.cut(rt-r),M=M.cut(0,rt-r),U=rt,B=-1)}o(M,M.isInline&&!M.isLeaf?p.filter(rt=>!rt.inline):p.slice(),t.forChild(r,M),B),r=U}})(this.node,this.innerDeco,(C,M,B)=>{C.spec.marks?h.syncToMarks(C.spec.marks,o,t):C.type.side>=0&&!B&&h.syncToMarks(M==this.node.childCount?s.vc.none:this.node.child(M).marks,o,t),h.placeWidget(C,t,i)},(C,M,B,U)=>{let K;h.syncToMarks(C.marks,o,t),h.findNodeMatch(C,M,B,U)||p&&t.state.selection.from>i&&t.state.selection.to<i+C.nodeSize&&(K=h.findIndexWithChild(r.node))>-1&&h.updateNodeAt(C,M,B,K,t)||h.updateNextNode(C,M,B,t,U)||h.addNode(C,M,B,t,i),i+=C.nodeSize}),h.syncToMarks([],o,t),this.node.isTextblock&&h.addTextblockHacks(),h.destroyRest(),(h.changed||2==this.dirty)&&(c&&this.protectLocalComposition(t,c),E(this.contentDOM,this.children,t),ut&&function(n){if("UL"==n.nodeName||"OL"==n.nodeName){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n),n.style.cssText=t}}(this.dom))}localCompositionInfo(t,e){let{from:o,to:i}=t.state.selection;if(!(t.state.selection instanceof g.Bs)||o<e||i>e+this.node.content.size)return null;let r=t.domSelection(),c=function(n,t){for(;;){if(3==n.nodeType)return n;if(1==n.nodeType&&t>0){if(n.childNodes.length>t&&3==n.childNodes[t].nodeType)return n.childNodes[t];t=Ut(n=n.childNodes[t-1])}else{if(!(1==n.nodeType&&t<n.childNodes.length))return null;n=n.childNodes[t],t=0}}}(r.focusNode,r.focusOffset);if(!c||!this.dom.contains(c.parentNode))return null;if(this.node.inlineContent){let p=c.nodeValue,h=function(n,t,e,o){for(let i=0,r=0;i<n.childCount&&r<=o;){let c=n.child(i++),p=r;if(r+=c.nodeSize,!c.isText)continue;let h=c.text;for(;i<n.childCount;){let C=n.child(i++);if(r+=C.nodeSize,!C.isText)break;h+=C.text}if(r>=e){let C=p<o?h.lastIndexOf(t,o-p-1):-1;if(C>=0&&C+t.length+p>=e)return p+C;if(e==o&&h.length>=o+t.length-p&&h.slice(o-p,o-p+t.length)==t)return o}}return-1}(this.node.content,p,o-e,i-e);return h<0?null:{node:c,pos:h,text:p}}return{node:c,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:o,text:i}){if(this.getDesc(e))return;let r=e;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let c=new Pt(this,r,e,i);t.input.compositionNodes.push(c),this.children=qe(this.children,o,o+i.length,t,c)}update(t,e,o,i){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,o,i),0))}updateInner(t,e,o,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(ne(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=Ct(this.dom,this.nodeDOM,lt(this.outerDeco,this.node,e),lt(t,this.node,e)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function w(n,t,e,o,i){return Nt(o,t,n),new wt(void 0,n,t,e,o,o,o,i,0)}class l extends wt{constructor(t,e,o,i,r,c,p){super(t,e,o,i,r,null,c,p,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,o,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,o){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,o)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,o){let i=this.node.cut(t,e),r=document.createTextNode(i.text);return new l(this.parent,i,this.outerDeco,this.innerDeco,r,r,o)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(0==t||e==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class d extends X{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class m extends wt{constructor(t,e,o,i,r,c,p,h,C,M){super(t,e,o,i,r,c,p,C,M),this.spec=h}update(t,e,o,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(t,e,o);return r&&this.updateInner(t,e,o,i),r}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,o,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,o,i){this.spec.setSelection?this.spec.setSelection(t,e,o):super.setSelection(t,e,o,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function E(n,t,e){let o=n.firstChild,i=!1;for(let r=0;r<t.length;r++){let c=t[r],p=c.dom;if(p.parentNode==n){for(;p!=o;)o=Ye(o),i=!0;o=o.nextSibling}else i=!0,n.insertBefore(p,o);if(c instanceof kt){let h=o?o.previousSibling:n.lastChild;E(c.contentDOM,c.children,e),o=h?h.nextSibling:n.firstChild}}for(;o;)o=Ye(o),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const A=function(n){n&&(this.nodeName=n)};A.prototype=Object.create(null);const F=[new A];function lt(n,t,e){if(0==n.length)return F;let o=e?F[0]:new A,i=[o];for(let r=0;r<n.length;r++){let c=n[r].type.attrs;if(c){c.nodeName&&i.push(o=new A(c.nodeName));for(let p in c){let h=c[p];null!=h&&(e&&1==i.length&&i.push(o=new A(t.isInline?"span":"div")),"class"==p?o.class=(o.class?o.class+" ":"")+h:"style"==p?o.style=(o.style?o.style+";":"")+h:"nodeName"!=p&&(o[p]=h))}}}return i}function Ct(n,t,e,o){if(e==F&&o==F)return t;let i=t;for(let r=0;r<o.length;r++){let c=o[r],p=e[r];if(r){let h;p&&p.nodeName==c.nodeName&&i!=n&&(h=i.parentNode)&&h.nodeName.toLowerCase()==c.nodeName||(h=document.createElement(c.nodeName),h.pmIsDeco=!0,h.appendChild(i),p=F[0]),i=h}Rt(i,p||F[0],c)}return i}function Rt(n,t,e){for(let o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&!(o in e)&&n.removeAttribute(o);for(let o in e)"class"!=o&&"style"!=o&&"nodeName"!=o&&e[o]!=t[o]&&n.setAttribute(o,e[o]);if(t.class!=e.class){let o=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let r=0;r<o.length;r++)-1==i.indexOf(o[r])&&n.classList.remove(o[r]);for(let r=0;r<i.length;r++)-1==o.indexOf(i[r])&&n.classList.add(i[r]);0==n.classList.length&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let i,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=o.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Nt(n,t,e){return Ct(n,n,F,lt(t,e,1!=n.nodeType))}function ne(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function Ye(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class ae{constructor(t,e){this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(n,t){let e=t,o=e.children.length,i=n.childCount,r=new Map,c=[];t:for(;i>0;){let p;for(;;)if(o){let C=e.children[o-1];if(!(C instanceof kt)){p=C,o--;break}e=C,o=C.children.length}else{if(e==t)break t;o=e.parent.children.indexOf(e),e=e.parent}let h=p.node;if(h){if(h!=n.child(i-1))break;--i,r.set(p,i),c.push(p)}}return{index:i,matched:r,matches:c.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let o=t;o<e;o++)this.top.children[o].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,o){let i=0,r=this.stack.length>>1,c=Math.min(r,t.length);for(;i<c&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let p=-1;for(let h=this.index;h<Math.min(this.index+3,this.top.children.length);h++)if(this.top.children[h].matchesMark(t[r])){p=h;break}if(p>-1)p>this.index&&(this.changed=!0,this.destroyBetween(this.index,p)),this.top=this.top.children[this.index];else{let h=kt.create(this.top,t[r],e,o);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,r++}}findNodeMatch(t,e,o,i){let c,r=-1;if(i>=this.preMatch.index&&(c=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&c.matchesNode(t,e,o))r=this.top.children.indexOf(c,this.index);else for(let p=this.index,h=Math.min(this.top.children.length,p+5);p<h;p++){let C=this.top.children[p];if(C.matchesNode(t,e,o)&&!this.preMatch.matched.has(C)){r=p;break}}return!(r<0||(this.destroyBetween(this.index,r),this.index++,0))}updateNodeAt(t,e,o,i,r){let c=this.top.children[i];return 3==c.dirty&&c.dom==c.contentDOM&&(c.dirty=2),!!c.update(t,e,o,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let o=t.pmViewDesc;if(o)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==o)return i;return-1}t=e}}updateNextNode(t,e,o,i,r){for(let c=this.index;c<this.top.children.length;c++){let p=this.top.children[c];if(p instanceof wt){let h=this.preMatch.matched.get(p);if(null!=h&&h!=r)return!1;let C=p.dom;if((!this.lock||!(C==this.lock||1==C.nodeType&&C.contains(this.lock.parentNode))||t.isText&&p.node&&p.node.isText&&p.nodeDOM.nodeValue==t.text&&3!=p.dirty&&ne(e,p.outerDeco))&&p.update(t,e,o,i))return this.destroyBetween(this.index,c),p.dom!=C&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,o,i,r){this.top.children.splice(this.index++,0,wt.create(this.top,t,e,o,i,r)),this.changed=!0}placeWidget(t,e,o){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let r=new yt(this.top,t,e,o);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof kt;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof l)||/\n$/.test(t.node.text))&&((_t||st)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);"IMG"==t&&(o.className="ProseMirror-separator",o.alt=""),"BR"==t&&(o.className="ProseMirror-trailingBreak");let i=new d(this.top,[],o,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}}function He(n,t){return n.type.side-t.type.side}function qe(n,t,e,o,i){let r=[];for(let c=0,p=0;c<n.length;c++){let h=n[c],C=p,M=p+=h.size;C>=e||M<=t?r.push(h):(C<t&&r.push(h.slice(0,t-C,o)),i&&(r.push(i),i=void 0),M>e&&r.push(h.slice(e-C,h.size,o)))}return r}function Ue(n,t=null){let e=n.domSelection(),o=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),r=i&&0==i.size,c=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(c<0)return null;let h,C,p=o.resolve(c);if(Z(e)){for(h=p;i&&!i.node;)i=i.parent;let M=i.node;if(i&&M.isAtom&&g.qv.isSelectable(M)&&i.parent&&(!M.isInline||!function(n,t,e){for(let o=0==t,i=t==Ut(n);o||i;){if(n==e)return!0;let r=pt(n);if(!(n=n.parentNode))return!1;o=o&&0==r,i=i&&r==Ut(n)}}(e.focusNode,e.focusOffset,i.dom))){let B=i.posBefore;C=new g.qv(c==B?p:o.resolve(B))}}else{let M=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(M<0)return null;h=o.resolve(M)}return C||(C=we(n,h,p,"pointer"==t||n.state.selection.head<p.pos&&!r?1:-1)),C}function Qt(n){return n.editable?n.hasFocus():en(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function ke(n,t=!1){let e=n.state.selection;if(ye(n,e),Qt(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&st){let o=n.domSelection(),i=n.domObserver.currentSelection;if(o.anchorNode&&i.anchorNode&&ft(o.anchorNode,o.anchorOffset,i.anchorNode,i.anchorOffset))return n.input.mouseDown.delayedSelectionSync=!0,void n.domObserver.setCurSelection()}if(n.domObserver.disconnectSelection(),n.cursorWrapper)!function(n){let t=n.domSelection(),e=document.createRange(),o=n.cursorWrapper.dom,i="IMG"==o.nodeName;i?e.setEnd(o.parentNode,pt(o)+1):e.setEnd(o,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&at&&et<=11&&(o.disabled=!0,o.disabled=!1)}(n);else{let r,c,{anchor:o,head:i}=e;Mn&&!(e instanceof g.Bs)&&(e.$from.parent.inlineContent||(r=Cn(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(c=Cn(n,e.to))),n.docView.setSelection(o,i,n.root,t),Mn&&(r&&tn(r),c&&tn(c)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelection(),o=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=o||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Qt(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Mn=_t||st&&Et<63;function Cn(n,t){let{node:e,offset:o}=n.docView.domFromPos(t,0),i=o<e.childNodes.length?e.childNodes[o]:null,r=o?e.childNodes[o-1]:null;if(_t&&i&&"false"==i.contentEditable)return ce(i);if(!(i&&"false"!=i.contentEditable||r&&"false"!=r.contentEditable)){if(i)return ce(i);if(r)return ce(r)}}function ce(n){return n.contentEditable="true",_t&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function tn(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function ye(n,t){if(t instanceof g.qv){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(Hn(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else Hn(n)}function Hn(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function we(n,t,e,o){return n.someProp("createSelectionBetween",i=>i(n,t,e))||g.Bs.between(t,e,o)}function je(n){return(!n.editable||n.root.activeElement==n.dom)&&en(n)}function en(n){let t=n.domSelection();if(!t.anchorNode)return!1;try{return n.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function Fe(n,t){let{$anchor:e,$head:o}=n.selection,i=t>0?e.max(o):e.min(o),r=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return r&&g.Y1.findFrom(r,t)}function ie(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function yn(n,t,e){let o=n.state.selection;if(!(o instanceof g.Bs)){if(o instanceof g.qv&&o.node.isInline)return ie(n,new g.Bs(t>0?o.$to:o.$from));{let i=Fe(n.state,t);return!!i&&ie(n,i)}}if(!o.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=Fe(n.state,t);return!!(i&&i instanceof g.qv)&&ie(n,i)}if(!($&&e.indexOf("m")>-1)){let c,i=o.$head,r=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!r||r.isText)return!1;let p=t<0?i.pos-r.nodeSize:i.pos;return!!(r.isAtom||(c=n.docView.descAt(p))&&!c.contentDOM)&&(g.qv.isSelectable(r)?ie(n,new g.qv(t<0?n.state.doc.resolve(i.pos-r.nodeSize):i)):!!Q&&ie(n,new g.Bs(n.state.doc.resolve(t<0?p:p+r.nodeSize))))}}function Re(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function nn(n){let t=n.pmViewDesc;return t&&0==t.size&&(n.nextSibling||"BR"!=n.nodeName)}function Qe(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let i,r,c=!1;for(mt&&1==e.nodeType&&o<Re(e)&&nn(e.childNodes[o])&&(c=!0);;)if(o>0){if(1!=e.nodeType)break;{let p=e.childNodes[o-1];if(nn(p))i=e,r=--o;else{if(3!=p.nodeType)break;e=p,o=e.nodeValue.length}}}else{if(ge(e))break;{let p=e.previousSibling;for(;p&&nn(p);)i=e.parentNode,r=pt(p),p=p.previousSibling;if(p)e=p,o=Re(e);else{if(e=e.parentNode,e==n.dom)break;o=0}}}c?On(n,t,e,o):i&&On(n,t,i,r)}function Le(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let r,c,i=Re(e);for(;;)if(o<i){if(1!=e.nodeType)break;if(!nn(e.childNodes[o]))break;r=e,c=++o}else{if(ge(e))break;{let p=e.nextSibling;for(;p&&nn(p);)r=p.parentNode,c=pt(p)+1,p=p.nextSibling;if(p)e=p,o=0,i=Re(e);else{if(e=e.parentNode,e==n.dom)break;o=i=0}}}r&&On(n,t,r,c)}function ge(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function On(n,t,e,o){if(Z(t)){let r=document.createRange();r.setEnd(e,o),r.setStart(e,o),t.removeAllRanges(),t.addRange(r)}else t.extend&&t.extend(e,o);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&ke(n)},50)}function We(n,t,e){let o=n.state.selection;if(o instanceof g.Bs&&!o.empty||e.indexOf("s")>-1||$&&e.indexOf("m")>-1)return!1;let{$from:i,$to:r}=o;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let c=Fe(n.state,t);if(c&&c instanceof g.qv)return ie(n,c)}if(!i.parent.inlineContent){let c=t<0?i:r,p=o instanceof g.C1?g.Y1.near(c,t):g.Y1.findFrom(c,t);return!!p&&ie(n,p)}return!1}function xn(n,t){if(!(n.state.selection instanceof g.Bs))return!0;let{$head:e,$anchor:o,empty:i}=n.state.selection;if(!e.sameParent(o))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let r=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(r&&!r.isText){let c=n.state.tr;return t<0?c.delete(e.pos-r.nodeSize,e.pos):c.delete(e.pos,e.pos+r.nodeSize),n.dispatch(c),!0}return!1}function qn(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function Un(n,t){let e=[],{content:o,openStart:i,openEnd:r}=t;for(;i>1&&r>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,r--;let K=o.firstChild;e.push(K.type.name,K.attrs!=K.type.defaultAttrs?K.attrs:null),o=K.content}let c=n.someProp("clipboardSerializer")||s.PW.fromSchema(n.state.schema),p=Zn(),h=p.createElement("div");h.appendChild(c.serializeFragment(o,{document:p}));let M,C=h.firstChild,B=0;for(;C&&1==C.nodeType&&(M=Kn[C.nodeName.toLowerCase()]);){for(let K=M.length-1;K>=0;K--){let rt=p.createElement(M[K]);for(;h.firstChild;)rt.appendChild(h.firstChild);h.appendChild(rt),B++}C=h.firstChild}return C&&1==C.nodeType&&C.setAttribute("data-pm-slice",`${i} ${r}${B?` -${B}`:""} ${JSON.stringify(e)}`),{dom:h,text:n.someProp("clipboardTextSerializer",K=>K(t))||t.content.textBetween(0,t.content.size,"\n\n")}}function Fn(n,t,e,o,i){let c,p,r=i.parent.type.spec.code;if(!e&&!t)return null;let h=t&&(o||r||!e);if(h){if(n.someProp("transformPastedText",U=>{t=U(t,r||o)}),r)return t?new s.p2(s.HY.from(n.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):s.p2.empty;let B=n.someProp("clipboardTextParser",U=>U(t,i,o));if(B)p=B;else{let U=i.marks(),{schema:K}=n.state,rt=s.PW.fromSchema(K);c=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(Mt=>{let bt=c.appendChild(document.createElement("p"));Mt&&bt.appendChild(rt.serializeNode(K.text(Mt,U)))})}}else n.someProp("transformPastedHTML",B=>{e=B(e)}),c=function(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let i,e=Zn().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(n);if((i=o&&Kn[o[1].toLowerCase()])&&(n=i.map(r=>"<"+r+">").join("")+n+i.map(r=>"</"+r+">").reverse().join("")),e.innerHTML=n,i)for(let r=0;r<i.length;r++)e=e.querySelector(i[r])||e;return e}(e),Q&&function(n){let t=n.querySelectorAll(st?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let o=t[e];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),o)}}(c);let C=c&&c.querySelector("[data-pm-slice]"),M=C&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(C.getAttribute("data-pm-slice")||"");if(M&&M[3])for(let B=+M[3];B>0&&c.firstChild;B--)c=c.firstChild;if(p||(p=(n.someProp("clipboardParser")||n.someProp("domParser")||s.aw.fromSchema(n.state.schema)).parseSlice(c,{preserveWhitespace:!(!h&&!M),context:i,ruleFromNode:U=>"BR"!=U.nodeName||U.nextSibling||!U.parentNode||eo.test(U.parentNode.nodeName)?null:{ignore:!0}})),M)p=function(n,t){if(!n.size)return n;let o,e=n.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(p){return n}let{content:i,openStart:r,openEnd:c}=n;for(let p=o.length-2;p>=0;p-=2){let h=e.nodes[o[p]];if(!h||h.hasRequiredAttrs())break;i=s.HY.from(h.create(o[p+1],i)),r++,c++}return new s.p2(i,r,c)}(ze(p,+M[1],+M[2]),M[4]);else if(p=s.p2.maxOpen(function(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let r,i=t.node(e).contentMatchAt(t.index(e)),c=[];if(n.forEach(p=>{if(!c)return;let C,h=i.findWrapping(p.type);if(!h)return c=null;if(C=c.length&&r.length&&Dn(h,r,p,c[c.length-1],0))c[c.length-1]=C;else{c.length&&(c[c.length-1]=zn(c[c.length-1],r.length));let M=Wn(p,h);c.push(M),i=i.matchType(M.type),r=h}}),c)return s.HY.from(c)}return n}(p.content,i),!0),p.openStart||p.openEnd){let B=0,U=0;for(let K=p.content.firstChild;B<p.openStart&&!K.type.spec.isolating;B++,K=K.firstChild);for(let K=p.content.lastChild;U<p.openEnd&&!K.type.spec.isolating;U++,K=K.lastChild);p=ze(p,B,U)}return n.someProp("transformPasted",B=>{p=B(p)}),p}const eo=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Wn(n,t,e=0){for(let o=t.length-1;o>=e;o--)n=t[o].create(null,s.HY.from(n));return n}function Dn(n,t,e,o,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let r=Dn(n,t,e,o.lastChild,i+1);if(r)return o.copy(o.content.replaceChild(o.childCount-1,r));if(o.contentMatchAt(o.childCount).matchType(i==n.length-1?e.type:n[i+1]))return o.copy(o.content.append(s.HY.from(Wn(e,n,i+1))))}}function zn(n,t){if(0==t)return n;let e=n.content.replaceChild(n.childCount-1,zn(n.lastChild,t-1)),o=n.contentMatchAt(n.childCount).fillBefore(s.HY.empty,!0);return n.copy(e.append(o))}function Pn(n,t,e,o,i,r){let c=t<0?n.firstChild:n.lastChild,p=c.content;return i<o-1&&(p=Pn(p,t,e,o,i+1,r)),i>=e&&(p=t<0?c.contentMatchAt(0).fillBefore(p,n.childCount>1||r<=i).append(p):p.append(c.contentMatchAt(c.childCount).fillBefore(s.HY.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,c.copy(p))}function ze(n,t,e){return t<n.openStart&&(n=new s.p2(Pn(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new s.p2(Pn(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const Kn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Jn=null;function Zn(){return Jn||(Jn=document.implementation.createHTMLDocument("title"))}const T={};let S={};class J{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function vt(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function Ht(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=o=>Wt(n,o))})}function Wt(n,t){return n.someProp("handleDOMEvents",e=>{let o=e[t.type];return!!o&&(o(n,t)||t.defaultPrevented)})}function zt(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function Yt(n){return{left:n.clientX,top:n.clientY}}function Ke(n,t,e,o,i){if(-1==o)return!1;let r=n.state.doc.resolve(o);for(let c=r.depth+1;c>0;c--)if(n.someProp(t,p=>c>r.depth?p(n,e,r.nodeAfter,r.before(c),i,!0):p(n,e,r.node(c),r.before(c),i,!1)))return!0;return!1}function ve(n,t,e){n.focused||n.focus();let o=n.state.tr.setSelection(t);"pointer"==e&&o.setMeta("pointer",!0),n.dispatch(o)}function Ge(n,t,e,o){return Ke(n,"handleDoubleClickOn",t,e,o)||n.someProp("handleDoubleClick",i=>i(n,t,o))}function kn(n,t,e,o){return Ke(n,"handleTripleClickOn",t,e,o)||n.someProp("handleTripleClick",i=>i(n,t,o))||function(n,t,e){if(0!=e.button)return!1;let o=n.state.doc;if(-1==t)return!!o.inlineContent&&(ve(n,g.Bs.create(o,0,o.content.size),"pointer"),!0);let i=o.resolve(t);for(let r=i.depth+1;r>0;r--){let c=r>i.depth?i.nodeAfter:i.node(r),p=i.before(r);if(c.inlineContent)ve(n,g.Bs.create(o,p+1,p+1+c.content.size),"pointer");else{if(!g.qv.isSelectable(c))continue;ve(n,g.qv.create(o,p),"pointer")}return!0}}(n,e,o)}function on(n){return Pe(n)}S.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=16==e.keyCode||e.shiftKey,!Je(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!W||!st||13!=e.keyCode))if(229!=e.keyCode&&n.domObserver.forceFlush(),!ut||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)n.someProp("handleKeyDown",o=>o(n,e))||function(n,t){let e=t.keyCode,o=function(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}(t);return 8==e||$&&72==e&&"c"==o?xn(n,-1)||Qe(n):46==e||$&&68==e&&"c"==o?xn(n,1)||Le(n):13==e||27==e||(37==e||$&&66==e&&"c"==o?yn(n,-1,o)||Qe(n):39==e||$&&70==e&&"c"==o?yn(n,1,o)||Le(n):38==e||$&&80==e&&"c"==o?We(n,-1,o)||Qe(n):40==e||$&&78==e&&"c"==o?function(n){if(!_t||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelection();if(t&&1==t.nodeType&&0==e&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;qn(n,o,"true"),setTimeout(()=>qn(n,o,"false"),20)}return!1}(n)||We(n,1,o)||Le(n):o==($?"m":"c")&&(66==e||73==e||89==e||90==e))}(n,e)?e.preventDefault():vt(n,"key");else{let o=Date.now();n.input.lastIOSEnter=o,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==o&&(n.someProp("handleKeyDown",i=>i(n,Y(13,"Enter"))),n.input.lastIOSEnter=0)},200)}},S.keyup=(n,t)=>{16==t.keyCode&&(n.input.shiftKey=!1)},S.keypress=(n,t)=>{let e=t;if(Je(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||$&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e)))return void e.preventDefault();let o=n.state.selection;if(!(o instanceof g.Bs&&o.$from.sameParent(o.$to))){let i=String.fromCharCode(e.charCode);n.someProp("handleTextInput",r=>r(n,o.$from.pos,o.$to.pos,i))||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};const fn=$?"metaKey":"ctrlKey";T.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let o=on(n),i=Date.now(),r="singleClick";i-n.input.lastClick.time<500&&function(n,t){let e=t.x-n.clientX,o=t.y-n.clientY;return e*e+o*o<100}(e,n.input.lastClick)&&!e[fn]&&("singleClick"==n.input.lastClick.type?r="doubleClick":"doubleClick"==n.input.lastClick.type&&(r="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:r};let c=n.posAtCoords(Yt(e));!c||("singleClick"==r?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new mn(n,c,e,!!o)):("doubleClick"==r?Ge:kn)(n,c.pos,c.inside,e)?e.preventDefault():vt(n,"pointer"))};class mn{constructor(t,e,o,i){let r,c;if(this.view=t,this.pos=e,this.event=o,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[fn],this.allowDefault=o.shiftKey,e.inside>-1)r=t.state.doc.nodeAt(e.inside),c=e.inside;else{let M=t.state.doc.resolve(e.pos);r=M.parent,c=M.depth?M.before():0}const p=i?null:o.target,h=p?t.docView.nearestDesc(p,!0):null;this.target=h?h.dom:null;let{selection:C}=t.state;(0==o.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||C instanceof g.qv&&C.from<=c&&C.to>c)&&(this.mightDrag={node:r,pos:c,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!mt||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),vt(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ke(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Yt(t))),this.allowDefault||!e?vt(this.view,"pointer"):function(n,t,e,o,i){return Ke(n,"handleClickOn",t,e,o)||n.someProp("handleClick",r=>r(n,t,o))||(i?function(n,t){if(-1==t)return!1;let o,i,e=n.state.selection;e instanceof g.qv&&(o=e.node);let r=n.state.doc.resolve(t);for(let c=r.depth+1;c>0;c--){let p=c>r.depth?r.nodeAfter:r.node(c);if(g.qv.isSelectable(p)){i=o&&e.$from.depth>0&&c>=e.$from.depth&&r.before(e.$from.depth+1)==e.$from.pos?r.before(e.$from.depth):r.before(c);break}}return null!=i&&(ve(n,g.qv.create(n.state.doc,i),"pointer"),!0)}(n,e):function(n,t){if(-1==t)return!1;let e=n.state.doc.resolve(t),o=e.nodeAfter;return!!(o&&o.isAtom&&g.qv.isSelectable(o))&&(ve(n,new g.qv(e),"pointer"),!0)}(n,e))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||_t&&this.mightDrag&&!this.mightDrag.node.isAtom||st&&!(this.view.state.selection instanceof g.Bs)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(ve(this.view,g.Y1.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):vt(this.view,"pointer")}move(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),vt(this.view,"pointer"),0==t.buttons&&this.done()}}function Je(n,t){return!!n.composing||!!(_t&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500)&&(n.input.compositionEndedAt=-2e8,!0)}T.touchdown=n=>{on(n),vt(n,"pointer")},T.contextmenu=n=>on(n);const rn=W?5e3:-1;function sn(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>Pe(n),t))}function ln(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=function(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function Pe(n,t=!1){if(!(W&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),ln(n),t||n.docView&&n.docView.dirty){let e=Ue(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}S.compositionstart=S.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(o=>!1===o.type.spec.inclusive)))n.markCursor=n.state.storedMarks||e.marks(),Pe(n,!0),n.markCursor=null;else if(Pe(n),mt&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let o=n.domSelection();for(let i=o.focusNode,r=o.focusOffset;i&&1==i.nodeType&&0!=r;){let c=r<0?i.lastChild:i.childNodes[r-1];if(!c)break;if(3==c.nodeType){o.collapse(c,c.nodeValue.length);break}i=c,r=-1}}n.input.composing=!0}sn(n,rn)},S.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,sn(n,20))};const Ze=at&&et<15||ut&&N<604;function qt(n,t,e,o){let i=Fn(n,t,e,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",p=>p(n,o,i||s.p2.empty)))return!0;if(!i)return!1;let r=function(n){return 0==n.openStart&&0==n.openEnd&&1==n.content.childCount?n.content.firstChild:null}(i),c=r?n.state.tr.replaceSelectionWith(r,n.input.shiftKey):n.state.tr.replaceSelection(i);return n.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}T.copy=S.cut=(n,t)=>{let e=t,o=n.state.selection,i="cut"==e.type;if(o.empty)return;let r=Ze?null:e.clipboardData,c=o.content(),{dom:p,text:h}=Un(n,c);r?(e.preventDefault(),r.clearData(),r.setData("text/html",p.innerHTML),r.setData("text/plain",h)):function(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}(n,p),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},S.paste=(n,t)=>{let e=t;if(n.composing&&!W)return;let o=Ze?null:e.clipboardData;o&&qt(n,o.getData("text/plain"),o.getData("text/html"),e)?e.preventDefault():function(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,o=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout(()=>{n.focus(),o.parentNode&&o.parentNode.removeChild(o),e?qt(n,o.value,null,t):qt(n,o.textContent,o.innerHTML,t)},50)}(n,e)};class Lo{constructor(t,e){this.slice=t,this.move=e}}const Co=$?"altKey":"ctrlKey";T.dragstart=(n,t)=>{let e=t,o=n.input.mouseDown;if(o&&o.done(),!e.dataTransfer)return;let i=n.state.selection,r=i.empty?null:n.posAtCoords(Yt(e));if(!(r&&r.pos>=i.from&&r.pos<=(i instanceof g.qv?i.to-1:i.to)))if(o&&o.mightDrag)n.dispatch(n.state.tr.setSelection(g.qv.create(n.state.doc,o.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){let C=n.docView.nearestDesc(e.target,!0);C&&C.node.type.spec.draggable&&C!=n.docView&&n.dispatch(n.state.tr.setSelection(g.qv.create(n.state.doc,C.posBefore)))}let c=n.state.selection.content(),{dom:p,text:h}=Un(n,c);e.dataTransfer.clearData(),e.dataTransfer.setData(Ze?"Text":"text/html",p.innerHTML),e.dataTransfer.effectAllowed="copyMove",Ze||e.dataTransfer.setData("text/plain",h),n.dragging=new Lo(c,!e[Co])},T.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},S.dragover=S.dragenter=(n,t)=>t.preventDefault(),S.drop=(n,t)=>{let e=t,o=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(Yt(e));if(!i)return;let r=n.state.doc.resolve(i.pos);if(!r)return;let c=o&&o.slice;c?n.someProp("transformPasted",rt=>{c=rt(c)}):c=Fn(n,e.dataTransfer.getData(Ze?"Text":"text/plain"),Ze?null:e.dataTransfer.getData("text/html"),!1,r);let p=!(!o||e[Co]);if(n.someProp("handleDrop",rt=>rt(n,e,c||s.p2.empty,p)))return void e.preventDefault();if(!c)return;e.preventDefault();let h=c?(0,L.nj)(n.state.doc,r.pos,c):r.pos;null==h&&(h=r.pos);let C=n.state.tr;p&&C.deleteSelection();let M=C.mapping.map(h),B=0==c.openStart&&0==c.openEnd&&1==c.content.childCount,U=C.doc;if(B?C.replaceRangeWith(M,M,c.content.firstChild):C.replaceRange(M,M,c),C.doc.eq(U))return;let K=C.doc.resolve(M);if(B&&g.qv.isSelectable(c.content.firstChild)&&K.nodeAfter&&K.nodeAfter.sameMarkup(c.content.firstChild))C.setSelection(new g.qv(K));else{let rt=C.mapping.map(h);C.mapping.maps[C.mapping.maps.length-1].forEach((Mt,bt,Lt,jt)=>rt=jt),C.setSelection(we(n,K,C.doc.resolve(rt)))}n.focus(),n.dispatch(C.setMeta("uiEvent","drop"))},T.focus=n=>{n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelection())&&ke(n)},20))},T.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},T.beforeinput=(n,t)=>{if(st&&W&&"deleteContentBackward"==t.inputType){n.domObserver.flushSoon();let{domChangeCount:o}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=o||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",r=>r(n,Y(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in S)T[n]=S[n];function jn(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class ho{constructor(t,e){this.toDOM=t,this.spec=e||an,this.side=this.spec.side||0}map(t,e,o,i){let{pos:r,deleted:c}=t.mapResult(e.from+i,this.side<0?-1:1);return c?null:new Oe(r-o,r-o,this)}valid(){return!0}eq(t){return this==t||t instanceof ho&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&jn(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Xe{constructor(t,e){this.attrs=t,this.spec=e||an}map(t,e,o,i){let r=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-o,c=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-o;return r>=c?null:new Oe(r,c,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Xe&&jn(this.attrs,t.attrs)&&jn(this.spec,t.spec)}static is(t){return t.type instanceof Xe}destroy(){}}class oo{constructor(t,e){this.attrs=t,this.spec=e||an}map(t,e,o,i){let r=t.mapResult(e.from+i,1);if(r.deleted)return null;let c=t.mapResult(e.to+i,-1);return c.deleted||c.pos<=r.pos?null:new Oe(r.pos-o,c.pos-o,this)}valid(t,e){let r,{index:o,offset:i}=t.content.findIndex(e.from);return i==e.from&&!(r=t.child(o)).isText&&i+r.nodeSize==e.to}eq(t){return this==t||t instanceof oo&&jn(this.attrs,t.attrs)&&jn(this.spec,t.spec)}destroy(){}}class Oe{constructor(t,e,o){this.from=t,this.to=e,this.type=o}copy(t,e){return new Oe(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,o){return this.type.map(t,this,e,o)}static widget(t,e,o){return new Oe(t,t,new ho(e,o))}static inline(t,e,o,i){return new Oe(t,e,new Xe(o,i))}static node(t,e,o,i){return new Oe(t,e,new oo(o,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Xe}}const _n=[],an={};class re{constructor(t,e){this.local=t.length?t:_n,this.children=e.length?e:_n}static create(t,e){return e.length?Gn(e,t,0,an):se}find(t,e,o){let i=[];return this.findInner(null==t?0:t,null==e?1e9:e,i,0,o),i}findInner(t,e,o,i,r){for(let c=0;c<this.local.length;c++){let p=this.local[c];p.from<=e&&p.to>=t&&(!r||r(p.spec))&&o.push(p.copy(p.from+i,p.to+i))}for(let c=0;c<this.children.length;c+=3)if(this.children[c]<e&&this.children[c+1]>t){let p=this.children[c]+1;this.children[c+2].findInner(t-p,e-p,o,i+p,r)}}map(t,e,o){return this==se||0==t.maps.length?this:this.mapInner(t,e,0,0,o||an)}mapInner(t,e,o,i,r){let c;for(let p=0;p<this.local.length;p++){let h=this.local[p].map(t,o,i);h&&h.type.valid(e,h)?(c||(c=[])).push(h):r.onRemove&&r.onRemove(this.local[p].spec)}return this.children.length?function(n,t,e,o,i,r,c){let p=n.slice(),h=(M,B,U,K)=>{for(let rt=0;rt<p.length;rt+=3){let bt,Mt=p[rt+1];if(Mt<0||M>Mt+r)continue;let Lt=p[rt]+r;B>=Lt?p[rt+1]=M<=Lt?-2:-1:U>=i&&(bt=K-U-(B-M))&&(p[rt]+=bt,p[rt+1]+=bt)}};for(let M=0;M<e.maps.length;M++)e.maps[M].forEach(h);let C=!1;for(let M=0;M<p.length;M+=3)if(p[M+1]<0){if(-2==p[M+1]){C=!0,p[M+1]=-1;continue}let B=e.map(n[M]+r),U=B-i;if(U<0||U>=o.content.size){C=!0;continue}let rt=e.map(n[M+1]+r,-1)-i,{index:Mt,offset:bt}=o.content.findIndex(U),Lt=o.maybeChild(Mt);if(Lt&&bt==U&&bt+Lt.nodeSize==rt){let jt=p[M+2].mapInner(e,Lt,B+1,n[M]+r+1,c);jt!=se?(p[M]=U,p[M+1]=rt,p[M+2]=jt):(p[M+1]=-2,C=!0)}else C=!0}if(C){let M=function(n,t,e,o,i,r,c){function p(h,C){for(let M=0;M<h.local.length;M++){let B=h.local[M].map(o,i,C);B?e.push(B):c.onRemove&&c.onRemove(h.local[M].spec)}for(let M=0;M<h.children.length;M+=3)p(h.children[M+2],h.children[M]+C+1)}for(let h=0;h<n.length;h+=3)-1==n[h+1]&&p(n[h+2],t[h]+r+1);return e}(p,n,t,e,i,r,c),B=Gn(M,o,0,c);t=B.local;for(let U=0;U<p.length;U+=3)p[U+1]<0&&(p.splice(U,3),U-=3);for(let U=0,K=0;U<B.children.length;U+=3){let rt=B.children[U];for(;K<p.length&&p[K]<rt;)K+=3;p.splice(K,0,B.children[U],B.children[U+1],B.children[U+2])}}return new re(t.sort(cn),p)}(this.children,c||[],t,e,o,i,r):c?new re(c.sort(cn),_n):se}add(t,e){return e.length?this==se?re.create(t,e):this.addInner(t,e,0):this}addInner(t,e,o){let i,r=0;t.forEach((p,h)=>{let M,C=h+o;if(M=ro(e,p,C)){for(i||(i=this.children.slice());r<i.length&&i[r]<h;)r+=3;i[r]==h?i[r+2]=i[r+2].addInner(p,M,C+1):i.splice(r,0,h,h+p.nodeSize,Gn(M,p,C+1,an)),r+=3}});let c=Qn(r?so(e):e,-o);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||c.splice(p--,1);return new re(c.length?this.local.concat(c).sort(cn):this.local,i||this.children)}remove(t){return 0==t.length||this==se?this:this.removeInner(t,0)}removeInner(t,e){let o=this.children,i=this.local;for(let r=0;r<o.length;r+=3){let c,p=o[r]+e,h=o[r+1]+e;for(let B,M=0;M<t.length;M++)(B=t[M])&&B.from>p&&B.to<h&&(t[M]=null,(c||(c=[])).push(B));if(!c)continue;o==this.children&&(o=this.children.slice());let C=o[r+2].removeInner(c,p+1);C!=se?o[r+2]=C:(o.splice(r,3),r-=3)}if(i.length)for(let c,r=0;r<t.length;r++)if(c=t[r])for(let p=0;p<i.length;p++)i[p].eq(c,e)&&(i==this.local&&(i=this.local.slice()),i.splice(p--,1));return o==this.children&&i==this.local?this:i.length||o.length?new re(i,o):se}forChild(t,e){if(this==se)return this;if(e.isLeaf)return re.empty;let o,i;for(let p=0;p<this.children.length;p+=3)if(this.children[p]>=t){this.children[p]==t&&(o=this.children[p+2]);break}let r=t+1,c=r+e.content.size;for(let p=0;p<this.local.length;p++){let h=this.local[p];if(h.from<c&&h.to>r&&h.type instanceof Xe){let C=Math.max(r,h.from)-r,M=Math.min(c,h.to)-r;C<M&&(i||(i=[])).push(h.copy(C,M))}}if(i){let p=new re(i.sort(cn),_n);return o?new $e([p,o]):p}return o||se}eq(t){if(this==t)return!0;if(!(t instanceof re)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return lo(this.localsInner(t))}localsInner(t){if(this==se)return _n;if(t.inlineContent||!this.local.some(Xe.is))return this.local;let e=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof Xe||e.push(this.local[o]);return e}}re.empty=new re([],[]),re.removeOverlap=lo;const se=re.empty;class $e{constructor(t){this.members=t}map(t,e){const o=this.members.map(i=>i.map(t,e,an));return $e.from(o)}forChild(t,e){if(e.isLeaf)return re.empty;let o=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(t,e);r!=se&&(r instanceof $e?o=o.concat(r.members):o.push(r))}return $e.from(o)}eq(t){if(!(t instanceof $e)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,o=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(t);if(r.length)if(e){o&&(e=e.slice(),o=!1);for(let c=0;c<r.length;c++)e.push(r[c])}else e=r}return e?lo(o?e:e.sort(cn)):_n}static from(t){switch(t.length){case 0:return se;case 1:return t[0];default:return new $e(t)}}}function Qn(n,t){if(!t||!n.length)return n;let e=[];for(let o=0;o<n.length;o++){let i=n[o];e.push(new Oe(i.from+t,i.to+t,i.type))}return e}function ro(n,t,e){if(t.isLeaf)return null;let o=e+t.nodeSize,i=null;for(let c,r=0;r<n.length;r++)(c=n[r])&&c.from>e&&c.to<o&&((i||(i=[])).push(c),n[r]=null);return i}function so(n){let t=[];for(let e=0;e<n.length;e++)null!=n[e]&&t.push(n[e]);return t}function Gn(n,t,e,o){let i=[],r=!1;t.forEach((p,h)=>{let C=ro(n,p,h+e);if(C){r=!0;let M=Gn(C,p,e+h+1,o);M!=se&&i.push(h,h+p.nodeSize,M)}});let c=Qn(r?so(n):n,-e).sort(cn);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||(o.onRemove&&o.onRemove(c[p].spec),c.splice(p--,1));return c.length||i.length?new re(c,i):se}function cn(n,t){return n.from-t.from||n.to-t.to}function lo(n){let t=n;for(let e=0;e<t.length-1;e++){let o=t[e];if(o.from!=o.to)for(let i=e+1;i<t.length;i++){let r=t[i];if(r.from!=o.from){r.from<o.to&&(t==n&&(t=n.slice()),t[e]=o.copy(o.from,r.from),mo(t,i,o.copy(r.from,o.to)));break}r.to!=o.to&&(t==n&&(t=n.slice()),t[i]=r.copy(r.from,o.to),mo(t,i+1,r.copy(o.to,r.to)))}}return t}function mo(n,t,e){for(;t<n.length&&cn(e,n[t])>0;)t++;n.splice(t,0,e)}function ao(n){let t=[];return n.someProp("decorations",e=>{let o=e(n.state);o&&o!=se&&t.push(o)}),n.cursorWrapper&&t.push(re.create(n.state.doc,[n.cursorWrapper.deco])),$e.from(t)}const Eo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},yo=at&&et<=11;class Xn{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Oo{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Xn,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let i=0;i<o.length;i++)this.queue.push(o[i]);at&&et<=11&&o.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),yo&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Eo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(je(this.view)){if(this.suppressingSelectionUpdates)return ke(this.view);if(at&&et<=11&&!this.view.state.selection.empty){let t=this.view.domSelection();if(t.focusNode&&ft(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(t){if(0==t.rangeCount)return!0;let e=t.getRangeAt(0).commonAncestorContainer,o=this.view.docView.nearestDesc(e);return o&&o.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let e=this.view.domSelection(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&je(this.view)&&!this.ignoreSelectionChange(e),i=-1,r=-1,c=!1,p=[];if(this.view.editable)for(let h=0;h<t.length;h++){let C=this.registerMutation(t[h],p);C&&(i=i<0?C.from:Math.min(C.from,i),r=r<0?C.to:Math.max(C.to,r),C.typeOver&&(c=!0))}if(mt&&p.length>1){let h=p.filter(C=>"BR"==C.nodeName);if(2==h.length){let C=h[0],M=h[1];C.parentNode&&C.parentNode.parentNode==M.parentNode?M.remove():C.remove()}}(i>-1||o)&&(i>-1&&(this.view.docView.markDirty(i,r),_o||(_o=!0,"normal"==getComputedStyle(this.view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(i,r,c,p),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||ke(this.view),this.currentSelection.set(e))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(o==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if("childList"==t.type){for(let M=0;M<t.addedNodes.length;M++)e.push(t.addedNodes[M]);if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let i=t.previousSibling,r=t.nextSibling;if(at&&et<=11&&t.addedNodes.length)for(let M=0;M<t.addedNodes.length;M++){let{previousSibling:B,nextSibling:U}=t.addedNodes[M];(!B||Array.prototype.indexOf.call(t.addedNodes,B)<0)&&(i=B),(!U||Array.prototype.indexOf.call(t.addedNodes,U)<0)&&(r=U)}let c=i&&i.parentNode==t.target?pt(i)+1:0,p=o.localPosFromDOM(t.target,c,-1),h=r&&r.parentNode==t.target?pt(r):t.target.childNodes.length;return{from:p,to:o.localPosFromDOM(t.target,h,1)}}return"attributes"==t.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let _o=!1;function Do(n){let t=n.pmViewDesc;if(t)return t.parseRule();if("BR"==n.nodeName&&n.parentNode){if(_t&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(n.parentNode.lastChild==n||_t&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function co(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:we(n,t.resolve(e.anchor),t.resolve(e.head))}function po(n,t,e){let o=n.depth,i=t?n.end():n.pos;for(;o>0&&(t||n.indexAfter(o)==n.node(o).childCount);)o--,i++,t=!1;if(e){let r=n.node(o).maybeChild(n.indexAfter(o));for(;r&&!r.isLeaf;)r=r.firstChild,i++}return i}class Io{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new J,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(vo),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=go(this),Ln(this),this.nodeViews=To(this),this.docView=w(this.state.doc,Rn(this),ao(this),this.dom,this),this.domObserver=new Oo(this,(o,i,r,c)=>function(n,t,e,o,i){if(t<0){let Kt=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,Tn=Ue(n,Kt);if(Tn&&!n.state.selection.eq(Tn)){let Ro=n.state.tr.setSelection(Tn);"pointer"==Kt?Ro.setMeta("pointer",!0):"key"==Kt&&Ro.scrollIntoView(),n.dispatch(Ro)}return}let r=n.state.doc.resolve(t),c=r.sharedDepth(e);t=r.before(c+1),e=n.state.doc.resolve(e).after(c+1);let p=n.state.selection,h=function(n,t,e){let C,{node:o,fromOffset:i,toOffset:r,from:c,to:p}=n.docView.parseRange(t,e),h=n.domSelection(),M=h.anchorNode;if(M&&n.dom.contains(1==M.nodeType?M:M.parentNode)&&(C=[{node:M,offset:h.anchorOffset}],Z(h)||C.push({node:h.focusNode,offset:h.focusOffset})),st&&8===n.input.lastKeyCode)for(let bt=r;bt>i;bt--){let Lt=o.childNodes[bt-1],jt=Lt.pmViewDesc;if("BR"==Lt.nodeName&&!jt){r=bt;break}if(!jt||jt.size)break}let B=n.state.doc,U=n.someProp("domParser")||s.aw.fromSchema(n.state.schema),K=B.resolve(c),rt=null,Mt=U.parse(o,{topNode:K.parent,topMatch:K.parent.contentMatchAt(K.index()),topOpen:!0,from:i,to:r,preserveWhitespace:"pre"!=K.parent.type.whitespace||"full",findPositions:C,ruleFromNode:Do,context:K});if(C&&null!=C[0].pos){let bt=C[0].pos,Lt=C[1]&&C[1].pos;null==Lt&&(Lt=bt),rt={anchor:bt+c,head:Lt+c}}return{doc:Mt,sel:rt,from:c,to:p}}(n,t,e);if(st&&n.cursorWrapper&&h.sel&&h.sel.anchor==n.cursorWrapper.deco.from){let Kt=n.cursorWrapper.deco.type.toDOM.nextSibling,Tn=Kt&&Kt.nodeValue?Kt.nodeValue.length:1;h.sel={anchor:h.sel.anchor+Tn,head:h.sel.anchor+Tn}}let B,U,C=n.state.doc,M=C.slice(h.from,h.to);8===n.input.lastKeyCode&&Date.now()-100<n.input.lastKeyCodeTime?(B=n.state.selection.to,U="end"):(B=n.state.selection.from,U="start"),n.input.lastKeyCode=null;let K=function(n,t,e,o,i){let r=n.findDiffStart(t,e);if(null==r)return null;let{a:c,b:p}=n.findDiffEnd(t,e+n.size,e+t.size);return"end"==i&&(o-=c+Math.max(0,r-Math.min(c,p))-r),c<r&&n.size<t.size?(r-=o<=r&&o>=c?r-o:0,p=r+(p-c),c=r):p<r&&(r-=o<=r&&o>=p?r-o:0,c=r+(c-p),p=r),{start:r,endA:c,endB:p}}(M.content,h.doc.content,h.from,B,U);if((ut&&n.input.lastIOSEnter>Date.now()-225||W)&&i.some(Kt=>"DIV"==Kt.nodeName||"P"==Kt.nodeName)&&(!K||K.endA>=K.endB)&&n.someProp("handleKeyDown",Kt=>Kt(n,Y(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(!K){if(!(o&&p instanceof g.Bs&&!p.empty&&p.$head.sameParent(p.$anchor))||n.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let Kt=co(n,n.state.doc,h.sel);Kt&&!Kt.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(Kt))}return}K={start:p.from,endA:p.to,endB:p.to}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&K.start==K.endB&&n.state.selection instanceof g.Bs&&(K.start>n.state.selection.from&&K.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?K.start=n.state.selection.from:K.endA<n.state.selection.to&&K.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(K.endB+=n.state.selection.to-K.endA,K.endA=n.state.selection.to)),at&&et<=11&&K.endB==K.start+1&&K.endA==K.start&&K.start>h.from&&" \xa0"==h.doc.textBetween(K.start-h.from-1,K.start-h.from+1)&&(K.start--,K.endA--,K.endB--);let jt,rt=h.doc.resolveNoCache(K.start-h.from),Mt=h.doc.resolveNoCache(K.endB-h.from),bt=C.resolve(K.start),Lt=rt.sameParent(Mt)&&rt.parent.inlineContent&&bt.end()>=K.endA;if((ut&&n.input.lastIOSEnter>Date.now()-225&&(!Lt||i.some(Kt=>"DIV"==Kt.nodeName||"P"==Kt.nodeName))||!Lt&&rt.pos<h.doc.content.size&&(jt=g.Y1.findFrom(h.doc.resolve(rt.pos+1),1,!0))&&jt.head==Mt.pos)&&n.someProp("handleKeyDown",Kt=>Kt(n,Y(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(n.state.selection.anchor>K.start&&function(n,t,e,o,i){if(!o.parent.isTextblock||e-t<=i.pos-o.pos||po(o,!0,!1)<i.pos)return!1;let r=n.resolve(t);if(r.parentOffset<r.parent.content.size||!r.parent.isTextblock)return!1;let c=n.resolve(po(r,!0,!0));return!(!c.parent.isTextblock||c.pos>e||po(c,!0,!1)<e)&&o.parent.content.cut(o.parentOffset).eq(c.parent.content)}(C,K.start,K.endA,rt,Mt)&&n.someProp("handleKeyDown",Kt=>Kt(n,Y(8,"Backspace"))))return void(W&&st&&n.domObserver.suppressSelectionUpdates());st&&W&&K.endB==K.start&&(n.input.lastAndroidDelete=Date.now()),W&&!Lt&&rt.start()!=Mt.start()&&0==Mt.parentOffset&&rt.depth==Mt.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==K.endA&&(K.endB-=2,Mt=h.doc.resolveNoCache(K.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(Kt){return Kt(n,Y(13,"Enter"))})},20));let ue,gn,Ve,de=K.start,xe=K.endA;if(Lt)if(rt.pos==Mt.pos)at&&et<=11&&0==rt.parentOffset&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>ke(n),20)),ue=n.state.tr.delete(de,xe),gn=C.resolve(K.start).marksAcross(C.resolve(K.endA));else if(K.endA==K.endB&&(Ve=function(n,t){let c,p,h,e=n.firstChild.marks,o=t.firstChild.marks,i=e,r=o;for(let M=0;M<o.length;M++)i=o[M].removeFromSet(i);for(let M=0;M<e.length;M++)r=e[M].removeFromSet(r);if(1==i.length&&0==r.length)p=i[0],c="add",h=M=>M.mark(p.addToSet(M.marks));else{if(0!=i.length||1!=r.length)return null;p=r[0],c="remove",h=M=>M.mark(p.removeFromSet(M.marks))}let C=[];for(let M=0;M<t.childCount;M++)C.push(h(t.child(M)));if(s.HY.from(C).eq(n))return{mark:p,type:c}}(rt.parent.content.cut(rt.parentOffset,Mt.parentOffset),bt.parent.content.cut(bt.parentOffset,K.endA-bt.start()))))ue=n.state.tr,"add"==Ve.type?ue.addMark(de,xe,Ve.mark):ue.removeMark(de,xe,Ve.mark);else if(rt.parent.child(rt.index()).isText&&rt.index()==Mt.index()-(Mt.textOffset?0:1)){let Kt=rt.parent.textBetween(rt.parentOffset,Mt.parentOffset);if(n.someProp("handleTextInput",Tn=>Tn(n,de,xe,Kt)))return;ue=n.state.tr.insertText(Kt,de,xe)}if(ue||(ue=n.state.tr.replace(de,xe,h.doc.slice(K.start-h.from,K.endB-h.from))),h.sel){let Kt=co(n,ue.doc,h.sel);Kt&&!(st&&W&&n.composing&&Kt.empty&&(K.start!=K.endB||n.input.lastAndroidDelete<Date.now()-100)&&(Kt.head==de||Kt.head==ue.mapping.map(xe)-1)||at&&Kt.empty&&Kt.head==de)&&ue.setSelection(Kt)}gn&&ue.ensureMarks(gn),n.dispatch(ue.scrollIntoView())}(this,o,i,r,c)),this.domObserver.start(),function(n){for(let t in T){let e=T[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=o=>{zt(n,o)&&!Wt(n,o)&&(n.editable||!(o.type in S))&&e(n,o)})}_t&&n.dom.addEventListener("input",()=>null),Ht(n)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Ht(this),this._props=t,t.plugins&&(t.plugins.forEach(vo),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)}setProps(t){let e={};for(let o in this._props)e[o]=this._props[o];e.state=this.state;for(let o in t)e[o]=t[o];this.update(e)}updateState(t){this.updateStateInner(t,this.state.plugins!=t.plugins)}updateStateInner(t,e){let o=this.state,i=!1,r=!1;if(t.storedMarks&&this.composing&&(ln(this),r=!0),this.state=t,e){let B=To(this);(function(n,t){let e=0,o=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)o++;return e!=o})(B,this.nodeViews)&&(this.nodeViews=B,i=!0),Ht(this)}this.editable=go(this),Ln(this);let c=ao(this),p=Rn(this),h=e?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",C=i||!this.docView.matchesNode(t.doc,p,c);(C||!t.selection.eq(o.selection))&&(r=!0);let M="preserve"==h&&r&&null==this.dom.style.overflowAnchor&&function(n){let o,i,t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top);for(let r=(t.left+t.right)/2,c=e+1;c<Math.min(innerHeight,t.bottom);c+=5){let p=n.root.elementFromPoint(r,c);if(!p||p==n.dom||!n.dom.contains(p))continue;let h=p.getBoundingClientRect();if(h.top>=e-20){o=p,i=h.top;break}}return{refDOM:o,refTop:i,stack:It(n.dom)}}(this);if(r){this.domObserver.stop();let B=C&&(at||st)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&function(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}(o.selection,t.selection);if(C){let U=st?this.trackWrites=this.domSelection().focusNode:null;(i||!this.docView.update(t.doc,p,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=w(t.doc,p,c,this.dom,this)),U&&!this.trackWrites&&(B=!0)}B||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelection();return ft(t.node,t.offset,e.anchorNode,e.anchorOffset)}(this))?ke(this,B):(ye(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==h)this.dom.scrollTop=0;else if("to selection"==h){let B=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",U=>U(this)))if(t.selection instanceof g.qv){let U=this.docView.domAfterPos(t.selection.from);1==U.nodeType&&tt(this,U.getBoundingClientRect(),B)}else tt(this,this.coordsAtPos(t.selection.head,1),B)}else M&&function({refDOM:n,refTop:t,stack:e}){let o=n?n.getBoundingClientRect().top:0;$t(e,0==o?0:o-t)}(M)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let o=this.pluginViews[e];o.update&&o.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let o=this.directPlugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let o=this.state.plugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}}someProp(t,e){let i,o=this._props&&this._props[t];if(null!=o&&(i=e?e(o):o))return i;for(let c=0;c<this.directPlugins.length;c++){let p=this.directPlugins[c].props[t];if(null!=p&&(i=e?e(p):p))return i}let r=this.state.plugins;if(r)for(let c=0;c<r.length;c++){let p=r[c].props[t];if(null!=p&&(i=e?e(p):p))return i}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(n){if(n.setActive)return n.setActive();if(Jt)return n.focus(Jt);let t=It(n);n.focus(null==Jt?{get preventScroll(){return Jt={preventScroll:!0},!0}}:void 0),Jt||(Jt=!1,$t(t,0))}(this.dom),ke(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e;return t||document}posAtCoords(t){return Ne(this,t)}coordsAtPos(t,e=1){return Ee(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,o=-1){let i=this.docView.posFromDOM(t,e,o);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return function(n,t,e){return fe==t&&z==e?v:(fe=t,z=e,v="up"==e||"down"==e?function(n,t,e){let o=t.selection,i="up"==e?o.$from:o.$to;return Se(n,t,()=>{let{node:r}=n.docView.domFromPos(i.pos,"up"==e?-1:1);for(;;){let p=n.docView.nearestDesc(r,!0);if(!p)break;if(p.node.isBlock){r=p.dom;break}r=p.dom.parentNode}let c=Ee(n,i.pos,1);for(let p=r.firstChild;p;p=p.nextSibling){let h;if(1==p.nodeType)h=p.getClientRects();else{if(3!=p.nodeType)continue;h=Tt(p,0,p.nodeValue.length).getClientRects()}for(let C=0;C<h.length;C++){let M=h[C];if(M.bottom>M.top+1&&("up"==e?c.top-M.top>2*(M.bottom-c.top):M.bottom-c.bottom>2*(c.bottom-M.top)))return!1}}return!0})}(n,t,e):function(n,t,e){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let i=o.parentOffset,r=!i,c=i==o.parent.content.size,p=n.domSelection();return ee.test(o.parent.textContent)&&p.modify?Se(n,t,()=>{let h=p.getRangeAt(0),C=p.focusNode,M=p.focusOffset,B=p.caretBidiLevel;p.modify("move",e,"character");let K=!(o.depth?n.docView.domAfterPos(o.before()):n.dom).contains(1==p.focusNode.nodeType?p.focusNode:p.focusNode.parentNode)||C==p.focusNode&&M==p.focusOffset;return p.removeAllRanges(),p.addRange(h),null!=B&&(p.caretBidiLevel=B),K}):"left"==e||"backward"==e?r:c}(n,t,e))}(this,e||this.state,t)}destroy(){!this.docView||(function(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ao(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(n,t){!Wt(n,t)&&T[t.type]&&(n.editable||!(t.type in S))&&T[t.type](n,t)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelection(){return this.root.getSelection()}}function Rn(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if("function"==typeof e&&(e=e(n.state)),e)for(let o in e)"class"==o&&(t.class+=" "+e[o]),"style"==o?t.style=(t.style?t.style+";":"")+e[o]:!t[o]&&"contenteditable"!=o&&"nodeName"!=o&&(t[o]=String(e[o]))}),[Oe.node(0,n.state.doc.content.size,t)]}function Ln(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:Oe.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function go(n){return!n.someProp("editable",t=>!1===t(n.state))}function To(n){let t=Object.create(null);function e(o){for(let i in o)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=o[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function vo(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);
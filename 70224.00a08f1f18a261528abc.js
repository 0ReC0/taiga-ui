"use strict";var Yo=Object.defineProperty,Vo=Object.defineProperties,jo=Object.getOwnPropertyDescriptors,Xn=Object.getOwnPropertySymbols,Ko=Object.prototype.hasOwnProperty,Jo=Object.prototype.propertyIsEnumerable,Zo=(It,pt,c)=>pt in It?Yo(It,pt,{enumerable:!0,configurable:!0,writable:!0,value:c}):It[pt]=c,wt=(It,pt)=>{for(var c in pt||(pt={}))Ko.call(pt,c)&&Zo(It,c,pt[c]);if(Xn)for(var c of Xn(pt))Jo.call(pt,c)&&Zo(It,c,pt[c]);return It},Oe=(It,pt)=>Vo(It,jo(pt)),$o=(It,pt)=>{var c={};for(var C in It)Ko.call(It,C)&&pt.indexOf(C)<0&&(c[C]=It[C]);if(null!=It&&Xn)for(var C of Xn(It))pt.indexOf(C)<0&&Jo.call(It,C)&&(c[C]=It[C]);return c};(self.webpackChunk_taiga_ui_components=self.webpackChunk_taiga_ui_components||[]).push([[70224],{40256:(It,pt,c)=>{c.r(pt),c.d(pt,{CommandManager:()=>Vt,Editor:()=>Io,Extension:()=>zt,InputRule:()=>P,Mark:()=>Ze,Node:()=>vn,NodeView:()=>Fo,PasteRule:()=>A,Tracker:()=>Qn,callOrReturn:()=>I,combineTransactionSteps:()=>En,defaultBlockAt:()=>mn,escapeForRegEx:()=>zo,extensions:()=>An,findChildren:()=>uo,findChildrenInRange:()=>po,findParentNode:()=>_n,findParentNodeClosestToPos:()=>cn,generateHTML:()=>ho,generateJSON:()=>fo,generateText:()=>mo,getAttributes:()=>gn,getChangedRanges:()=>Wn,getDebugJSON:()=>zn,getExtensionField:()=>St,getHTMLFromFragment:()=>dn,getMarkAttributes:()=>On,getMarkRange:()=>He,getMarkType:()=>pe,getMarksBetween:()=>Tn,getNodeAttributes:()=>Un,getNodeType:()=>j,getSchema:()=>Be,getText:()=>yn,getTextBetween:()=>Jt,getTextContentFromNodes:()=>g,getTextSerializersFromSchema:()=>Kt,inputRulesPlugin:()=>_t,isActive:()=>Kn,isList:()=>qe,isMarkActive:()=>un,isNodeActive:()=>ze,isNodeEmpty:()=>Jn,isNodeSelection:()=>tn,isTextSelection:()=>Se,markInputRule:()=>So,markPasteRule:()=>Wo,mergeAttributes:()=>m,nodeInputRule:()=>ko,nodePasteRule:()=>wo,pasteRulesPlugin:()=>rt,posToDOMRect:()=>go,textInputRule:()=>Ro,textPasteRule:()=>jn,textblockTypeInputRule:()=>Vn,wrappingInputRule:()=>Lo});var C=c(62463),i=c(43594),w=c(13903),x=c(35917),T=c(38480);const Q=(p,a)=>!p.selection.empty&&(a&&a(p.tr.deleteSelection().scrollIntoView()),!0),D=(p,a,u)=>{let{$cursor:f}=p.selection;if(!f||(u?!u.endOfTextblock("backward",p):f.parentOffset>0))return!1;let y=ct(f);if(!y){let t=f.blockRange(),n=t&&(0,T.k9)(t);return null!=n&&(a&&a(p.tr.lift(t,n).scrollIntoView()),!0)}let e=y.nodeBefore;if(!e.type.spec.isolating&&Ot(p,y,a))return!0;if(0==f.parent.content.size&&(G(e,"end")||C.qv.isSelectable(e))){let t=(0,T.dR)(p.doc,f.before(),f.after(),x.p2.empty);if(t&&t.slice.size<t.to-t.from){if(a){let n=p.tr.step(t);n.setSelection(G(e,"end")?C.Y1.findFrom(n.doc.resolve(n.mapping.map(y.pos,-1)),-1):C.qv.create(n.doc,y.pos-e.nodeSize)),a(n.scrollIntoView())}return!0}}return!(!e.isAtom||y.depth!=f.depth-1||(a&&a(p.tr.delete(y.pos-e.nodeSize,y.pos).scrollIntoView()),0))};function G(p,a,u=!1){for(let f=p;f;f="start"==a?f.firstChild:f.lastChild){if(f.isTextblock)return!0;if(u&&1!=f.childCount)return!1}return!1}const $=(p,a,u)=>{let{$head:f,empty:y}=p.selection,e=f;if(!y)return!1;if(f.parent.isTextblock){if(u?!u.endOfTextblock("backward",p):f.parentOffset>0)return!1;e=ct(f)}let t=e&&e.nodeBefore;return!(!t||!C.qv.isSelectable(t)||(a&&a(p.tr.setSelection(C.qv.create(p.doc,e.pos-t.nodeSize)).scrollIntoView()),0))};function ct(p){if(!p.parent.type.spec.isolating)for(let a=p.depth-1;a>=0;a--){if(p.index(a)>0)return p.doc.resolve(p.before(a+1));if(p.node(a).type.spec.isolating)break}return null}const X=(p,a,u)=>{let{$cursor:f}=p.selection;if(!f||(u?!u.endOfTextblock("forward",p):f.parentOffset<f.parent.content.size))return!1;let y=ot(f);if(!y)return!1;let e=y.nodeAfter;if(Ot(p,y,a))return!0;if(0==f.parent.content.size&&(G(e,"start")||C.qv.isSelectable(e))){let t=(0,T.dR)(p.doc,f.before(),f.after(),x.p2.empty);if(t&&t.slice.size<t.to-t.from){if(a){let n=p.tr.step(t);n.setSelection(G(e,"start")?C.Y1.findFrom(n.doc.resolve(n.mapping.map(y.pos)),1):C.qv.create(n.doc,n.mapping.map(y.pos))),a(n.scrollIntoView())}return!0}}return!(!e.isAtom||y.depth!=f.depth-1||(a&&a(p.tr.delete(y.pos,y.pos+e.nodeSize).scrollIntoView()),0))},gt=(p,a,u)=>{let{$head:f,empty:y}=p.selection,e=f;if(!y)return!1;if(f.parent.isTextblock){if(u?!u.endOfTextblock("forward",p):f.parentOffset<f.parent.content.size)return!1;e=ot(f)}let t=e&&e.nodeAfter;return!(!t||!C.qv.isSelectable(t)||(a&&a(p.tr.setSelection(C.qv.create(p.doc,e.pos)).scrollIntoView()),0))};function ot(p){if(!p.parent.type.spec.isolating)for(let a=p.depth-1;a>=0;a--){let u=p.node(a);if(p.index(a)+1<u.childCount)return p.doc.resolve(p.after(a+1));if(u.type.spec.isolating)break}return null}const Tt=(p,a)=>{let{$head:u,$anchor:f}=p.selection;return!(!u.parent.type.spec.code||!u.sameParent(f)||(a&&a(p.tr.insertText("\n").scrollIntoView()),0))};function Z(p){for(let a=0;a<p.edgeCount;a++){let{type:u}=p.edge(a);if(u.isTextblock&&!u.hasRequiredAttrs())return u}return null}const U=(p,a)=>{let{$head:u,$anchor:f}=p.selection;if(!u.parent.type.spec.code||!u.sameParent(f))return!1;let y=u.node(-1),e=u.indexAfter(-1),t=Z(y.contentMatchAt(e));if(!t||!y.canReplaceWith(e,e,t))return!1;if(a){let n=u.after(),o=p.tr.replaceWith(n,n,t.createAndFill());o.setSelection(C.Y1.near(o.doc.resolve(n),1)),a(o.scrollIntoView())}return!0},V=(p,a)=>{let u=p.selection,{$from:f,$to:y}=u;if(u instanceof C.C1||f.parent.inlineContent||y.parent.inlineContent)return!1;let e=Z(y.parent.contentMatchAt(y.indexAfter()));if(!e||!e.isTextblock)return!1;if(a){let t=(!f.parentOffset&&y.index()<y.parent.childCount?f:y).pos,n=p.tr.insert(t,e.createAndFill());n.setSelection(C.Bs.create(n.doc,t+1)),a(n.scrollIntoView())}return!0},H=(p,a)=>{let{$cursor:u}=p.selection;if(!u||u.parent.content.size)return!1;if(u.depth>1&&u.after()!=u.end(-1)){let e=u.before();if((0,T.Ax)(p.doc,e))return a&&a(p.tr.split(e).scrollIntoView()),!0}let f=u.blockRange(),y=f&&(0,T.k9)(f);return null!=y&&(a&&a(p.tr.lift(f,y).scrollIntoView()),!0)};function Ot(p,a,u){let e,t,f=a.nodeBefore,y=a.nodeAfter;if(f.type.spec.isolating||y.type.spec.isolating)return!1;if(function(p,a,u){let f=a.nodeBefore,y=a.nodeAfter,e=a.index();return!(!(f&&y&&f.type.compatibleContent(y.type))||(!f.content.size&&a.parent.canReplace(e-1,e)?(u&&u(p.tr.delete(a.pos-f.nodeSize,a.pos).scrollIntoView()),0):!a.parent.canReplace(e,e+1)||!y.isTextblock&&!(0,T.Mn)(p.doc,a.pos)||(u&&u(p.tr.clearIncompatible(a.pos,f.type,f.contentMatchAt(f.childCount)).join(a.pos).scrollIntoView()),0)))}(p,a,u))return!0;let n=a.parent.canReplace(a.index(),a.index()+1);if(n&&(e=(t=f.contentMatchAt(f.childCount)).findWrapping(y.type))&&t.matchType(e[0]||y.type).validEnd){if(u){let h=a.pos+y.nodeSize,_=x.HY.empty;for(let L=e.length-1;L>=0;L--)_=x.HY.from(e[L].create(null,_));_=x.HY.from(f.copy(_));let E=p.tr.step(new T.FC(a.pos-1,h,a.pos,h,new x.p2(_,1,0),e.length,!0)),R=h+2*e.length;(0,T.Mn)(E.doc,R)&&E.join(R),u(E.scrollIntoView())}return!0}let o=C.Y1.findFrom(a,1),s=o&&o.$from.blockRange(o.$to),l=s&&(0,T.k9)(s);if(null!=l&&l>=a.depth)return u&&u(p.tr.lift(s,l).scrollIntoView()),!0;if(n&&G(y,"start",!0)&&G(f,"end")){let h=f,_=[];for(;_.push(h),!h.isTextblock;)h=h.lastChild;let E=y,R=1;for(;!E.isTextblock;E=E.firstChild)R++;if(h.canReplace(h.childCount,h.childCount,E.content)){if(u){let L=x.HY.empty;for(let st=_.length-1;st>=0;st--)L=x.HY.from(_[st].copy(L));u(p.tr.step(new T.FC(a.pos-_.length,a.pos+y.nodeSize,a.pos+R,a.pos+y.nodeSize-R,new x.p2(L,_.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Pt(p){return function(a,u){let f=a.selection,y=p<0?f.$from:f.$to,e=y.depth;for(;y.node(e).isInline;){if(!e)return!1;e--}return!!y.node(e).isTextblock&&(u&&u(a.tr.setSelection(C.Bs.create(a.doc,p<0?y.start(e):y.end(e)))),!0)}}const Bt=Pt(-1),tt=Pt(1);function F(p,a=null){return function(u,f){let{from:y,to:e}=u.selection,t=!1;return u.doc.nodesBetween(y,e,(n,o)=>{if(t)return!1;if(n.isTextblock&&!n.hasMarkup(p,a))if(n.type==p)t=!0;else{let s=u.doc.resolve(o),l=s.index();t=s.parent.canReplaceWith(l,l+1,p)}}),!!t&&(f&&f(u.tr.setBlockType(y,e,p,a).scrollIntoView()),!0)}}function q(...p){return function(a,u,f){for(let y=0;y<p.length;y++)if(p[y](a,u,f))return!0;return!1}}let xt=q(Q,D,$),kt=q(Q,X,gt);const Rt={Enter:q(Tt,V,H,(p,a)=>{let{$from:u,$to:f}=p.selection;if(p.selection instanceof C.qv&&p.selection.node.isBlock)return!(!u.parentOffset||!(0,T.Ax)(p.doc,u.pos)||(a&&a(p.tr.split(u.pos).scrollIntoView()),0));if(!u.parent.isBlock)return!1;if(a){let y=f.parentOffset==f.parent.content.size,e=p.tr;(p.selection instanceof C.Bs||p.selection instanceof C.C1)&&e.deleteSelection();let t=0==u.depth?null:Z(u.node(-1).contentMatchAt(u.indexAfter(-1))),n=y&&t?[{type:t}]:void 0,o=(0,T.Ax)(e.doc,e.mapping.map(u.pos),1,n);if(!n&&!o&&(0,T.Ax)(e.doc,e.mapping.map(u.pos),1,t?[{type:t}]:void 0)&&(t&&(n=[{type:t}]),o=!0),o&&(e.split(e.mapping.map(u.pos),1,n),!y&&!u.parentOffset&&u.parent.type!=t)){let s=e.mapping.map(u.before()),l=e.doc.resolve(s);t&&u.node(-1).canReplaceWith(l.index(),l.index()+1,t)&&e.setNodeMarkup(e.mapping.map(u.before()),t)}a(e.scrollIntoView())}return!0}),"Mod-Enter":U,Backspace:xt,"Mod-Backspace":xt,"Shift-Backspace":xt,Delete:kt,"Mod-Delete":kt,"Mod-a":(p,a)=>(a&&a(p.tr.setSelection(new C.C1(p.doc))),!0)},$t={"Ctrl-h":Rt.Backspace,"Alt-Backspace":Rt["Mod-Backspace"],"Ctrl-d":Rt.Delete,"Ctrl-Alt-Backspace":Rt["Mod-Delete"],"Alt-Delete":Rt["Mod-Delete"],"Alt-d":Rt["Mod-Delete"],"Ctrl-a":Bt,"Ctrl-e":tt};for(let p in Rt)$t[p]=Rt[p];function ge(p){const{state:a,transaction:u}=p;let{selection:f}=u,{doc:y}=u,{storedMarks:e}=u;return Oe(wt({},a),{apply:a.apply.bind(a),applyTransaction:a.applyTransaction.bind(a),filterTransaction:a.filterTransaction,plugins:a.plugins,schema:a.schema,reconfigure:a.reconfigure.bind(a),toJSON:a.toJSON.bind(a),get storedMarks(){return e},get selection(){return f},get doc(){return y},get tr(){return f=u.selection,y=u.doc,e=u.storedMarks,u}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class Vt{constructor(a){this.editor=a.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=a.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:a,editor:u,state:f}=this,{view:y}=u,{tr:e}=f,t=this.buildProps(e);return Object.fromEntries(Object.entries(a).map(([n,o])=>[n,(...l)=>{const h=o(...l)(t);return!e.getMeta("preventDispatch")&&!this.hasCustomState&&y.dispatch(e),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(a,u=!0){const{rawCommands:f,editor:y,state:e}=this,{view:t}=y,n=[],o=!!a,s=a||e.tr,h=Oe(wt({},Object.fromEntries(Object.entries(f).map(([_,E])=>[_,(...L)=>{const Y=this.buildProps(s,u),st=E(...L)(Y);return n.push(st),h}]))),{run:()=>(!o&&u&&!s.getMeta("preventDispatch")&&!this.hasCustomState&&t.dispatch(s),n.every(_=>!0===_))});return h}createCan(a){const{rawCommands:u,state:f}=this,e=a||f.tr,t=this.buildProps(e,!1),n=Object.fromEntries(Object.entries(u).map(([o,s])=>[o,(...l)=>s(...l)(Oe(wt({},t),{dispatch:void 0}))]));return Oe(wt({},n),{chain:()=>this.createChain(e,!1)})}buildProps(a,u=!0){const{rawCommands:f,editor:y,state:e}=this,{view:t}=y;e.storedMarks&&a.setStoredMarks(e.storedMarks);const n={tr:a,editor:y,view:t,state:ge({state:e,transaction:a}),dispatch:u?()=>{}:void 0,chain:()=>this.createChain(a),can:()=>this.createCan(a),get commands(){return Object.fromEntries(Object.entries(f).map(([o,s])=>[o,(...l)=>s(...l)(n)]))}};return n}}function St(p,a,u){return void 0===p.config[a]&&p.parent?St(p.parent,a,u):"function"==typeof p.config[a]?p.config[a].bind(Oe(wt({},u),{parent:p.parent?St(p.parent,a,u):null})):p.config[a]}function Gt(p){return{baseExtensions:p.filter(y=>"extension"===y.type),nodeExtensions:p.filter(y=>"node"===y.type),markExtensions:p.filter(y=>"mark"===y.type)}}function qt(p){const a=[],{nodeExtensions:u,markExtensions:f}=Gt(p),y=[...u,...f],e={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return p.forEach(t=>{const o=St(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage});o&&o().forEach(l=>{l.types.forEach(h=>{Object.entries(l.attributes).forEach(([_,E])=>{a.push({type:h,name:_,attribute:wt(wt({},e),E)})})})})}),y.forEach(t=>{const o=St(t,"addAttributes",{name:t.name,options:t.options,storage:t.storage});if(!o)return;const s=o();Object.entries(s).forEach(([l,h])=>{const _=wt(wt({},e),h);(null==h?void 0:h.isRequired)&&void 0===(null==h?void 0:h.default)&&delete _.default,a.push({type:t.name,name:l,attribute:_})})}),a}function j(p,a){if("string"==typeof p){if(!a.nodes[p])throw Error(`There is no node type named '${p}'. Maybe you forgot to add the extension?`);return a.nodes[p]}return p}function m(...p){return p.filter(a=>!!a).reduce((a,u)=>{const f=wt({},a);return Object.entries(u).forEach(([y,e])=>{f[y]=f[y]?"class"===y?[f[y],e].join(" "):"style"===y?[f[y],e].join("; "):e:e}),f},{})}function v(p,a){return a.filter(u=>u.attribute.rendered).map(u=>u.attribute.renderHTML?u.attribute.renderHTML(p.attrs)||{}:{[u.name]:p.attrs[u.name]}).reduce((u,f)=>m(u,f),{})}function M(p){return"function"==typeof p}function I(p,a,...u){return M(p)?a?p.bind(a)(...u):p(...u):p}function yt(p,a){return p.style?p:Oe(wt({},p),{getAttrs:u=>{const f=p.getAttrs?p.getAttrs(u):p.attrs;if(!1===f)return!1;const y=a.reduce((e,t)=>{const n=t.attribute.parseHTML?t.attribute.parseHTML(u):function(p){return"string"!=typeof p?p:p.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(p):"true"===p||"false"!==p&&p}(u.getAttribute(t.name));return null==n?e:Oe(wt({},e),{[t.name]:n})},{});return wt(wt({},f),y)}})}function Dt(p){return Object.fromEntries(Object.entries(p).filter(([a,u])=>("attrs"!==a||!function(p={}){return 0===Object.keys(p).length&&p.constructor===Object}(u))&&null!=u))}function S(p){var a;const u=qt(p),{nodeExtensions:f,markExtensions:y}=Gt(p),e=null===(a=f.find(o=>St(o,"topNode")))||void 0===a?void 0:a.name,t=Object.fromEntries(f.map(o=>{const s=u.filter(Y=>Y.type===o.name),l={name:o.name,options:o.options,storage:o.storage},h=p.reduce((Y,st)=>{const mt=St(st,"extendNodeSchema",l);return wt(wt({},Y),mt?mt(o):{})},{}),_=Dt(Oe(wt({},h),{content:I(St(o,"content",l)),marks:I(St(o,"marks",l)),group:I(St(o,"group",l)),inline:I(St(o,"inline",l)),atom:I(St(o,"atom",l)),selectable:I(St(o,"selectable",l)),draggable:I(St(o,"draggable",l)),code:I(St(o,"code",l)),defining:I(St(o,"defining",l)),isolating:I(St(o,"isolating",l)),attrs:Object.fromEntries(s.map(Y=>{var st;return[Y.name,{default:null===(st=null==Y?void 0:Y.attribute)||void 0===st?void 0:st.default}]}))})),E=I(St(o,"parseHTML",l));E&&(_.parseDOM=E.map(Y=>yt(Y,s)));const R=St(o,"renderHTML",l);R&&(_.toDOM=Y=>R({node:Y,HTMLAttributes:v(Y,s)}));const L=St(o,"renderText",l);return L&&(_.toText=L),[o.name,_]})),n=Object.fromEntries(y.map(o=>{const s=u.filter(L=>L.type===o.name),l={name:o.name,options:o.options,storage:o.storage},h=p.reduce((L,Y)=>{const st=St(Y,"extendMarkSchema",l);return wt(wt({},L),st?st(o):{})},{}),_=Dt(Oe(wt({},h),{inclusive:I(St(o,"inclusive",l)),excludes:I(St(o,"excludes",l)),group:I(St(o,"group",l)),spanning:I(St(o,"spanning",l)),code:I(St(o,"code",l)),attrs:Object.fromEntries(s.map(L=>{var Y;return[L.name,{default:null===(Y=null==L?void 0:L.attribute)||void 0===Y?void 0:Y.default}]}))})),E=I(St(o,"parseHTML",l));E&&(_.parseDOM=E.map(L=>yt(L,s)));const R=St(o,"renderHTML",l);return R&&(_.toDOM=L=>R({mark:L,HTMLAttributes:v(L,s)})),[o.name,_]}));return new x.V_({topNode:e,nodes:t,marks:n})}function r(p,a){return a.nodes[p]||a.marks[p]||null}function d(p,a){return Array.isArray(a)?a.some(u=>("string"==typeof u?u:u.name)===p.name):a}const g=(p,a=500)=>{let u="";const f=p.parentOffset;return p.parent.nodesBetween(Math.max(0,f-a),f,(y,e,t,n)=>{var o,s;u+=((null===(s=(o=y.type.spec).toText)||void 0===s?void 0:s.call(o,{node:y,pos:e,parent:t,index:n}))||y.textContent||"%leaf%").slice(0,Math.max(0,f-e))}),u};function O(p){return"[object RegExp]"===Object.prototype.toString.call(p)}class P{constructor(a){this.find=a.find,this.handler=a.handler}}function nt(p){var a;const{editor:u,from:f,to:y,text:e,rules:t,plugin:n}=p,{view:o}=u;if(o.composing)return!1;const s=o.state.doc.resolve(f);if(s.parent.type.spec.code||(null===(a=s.nodeBefore||s.nodeAfter)||void 0===a?void 0:a.marks.find(_=>_.type.spec.code)))return!1;let l=!1;const h=g(s)+e;return t.forEach(_=>{if(l)return;const E=((p,a)=>{if(O(a))return a.exec(p);const u=a(p);if(!u)return null;const f=[];return f.push(u.text),f.index=u.index,f.input=p,f.data=u.data,u.replaceWith&&(u.text.includes(u.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),f.push(u.replaceWith)),f})(h,_.find);if(!E)return;const R=o.state.tr,L=ge({state:o.state,transaction:R}),Y={from:f-(E[0].length-e.length),to:y},{commands:st,chain:mt,can:At}=new Vt({editor:u,state:L});null===_.handler({state:L,range:Y,match:E,commands:st,chain:mt,can:At})||!R.steps.length||(R.setMeta(n,{transform:R,from:f,to:y,text:e}),o.dispatch(R),l=!0)}),l}function _t(p){const{editor:a,rules:u}=p,f=new C.Sy({state:{init:()=>null,apply:(y,e)=>y.getMeta(f)||(y.selectionSet||y.docChanged?null:e)},props:{handleTextInput:(y,e,t,n)=>nt({editor:a,from:e,to:t,text:n,rules:u,plugin:f}),handleDOMEvents:{compositionend:y=>(setTimeout(()=>{const{$cursor:e}=y.state.selection;e&&nt({editor:a,from:e.pos,to:e.pos,text:"",rules:u,plugin:f})}),!1)},handleKeyDown(y,e){if("Enter"!==e.key)return!1;const{$cursor:t}=y.state.selection;return!!t&&nt({editor:a,from:t.pos,to:t.pos,text:"\n",rules:u,plugin:f})}},isInputRules:!0});return f}class A{constructor(a){this.find=a.find,this.handler=a.handler}}function rt(p){const{editor:a,rules:u}=p;let f=null,y=!1,e=!1;return u.map(n=>new C.Sy({view(o){const s=l=>{var h;f=(null===(h=o.dom.parentElement)||void 0===h?void 0:h.contains(l.target))?o.dom.parentElement:null};return window.addEventListener("dragstart",s),{destroy(){window.removeEventListener("dragstart",s)}}},props:{handleDOMEvents:{drop:o=>(e=f===o.dom.parentElement,!1),paste:(o,s)=>{var l;const h=null===(l=s.clipboardData)||void 0===l?void 0:l.getData("text/html");return y=!!(null==h?void 0:h.includes("data-pm-slice")),!1}}},appendTransaction:(o,s,l)=>{const h=o[0],_="paste"===h.getMeta("uiEvent")&&!y,E="drop"===h.getMeta("uiEvent")&&!e;if(!_&&!E)return;const R=s.doc.content.findDiffStart(l.doc.content),L=s.doc.content.findDiffEnd(l.doc.content);if(!function(p){return"number"==typeof p}(R)||!L||R===L.b)return;const Y=l.tr,st=ge({state:l,transaction:Y});return function(p){const{editor:a,state:u,from:f,to:y,rule:e}=p,{commands:t,chain:n,can:o}=new Vt({editor:a,state:u}),s=[];return u.doc.nodesBetween(f,y,(h,_)=>{if(!h.isTextblock||h.type.spec.code)return;const E=Math.max(f,_),R=Math.min(y,_+h.content.size);((p,a)=>{if(O(a))return[...p.matchAll(a)];const u=a(p);return u?u.map(f=>{const y=[];return y.push(f.text),y.index=f.index,y.input=p,y.data=f.data,f.replaceWith&&(f.text.includes(f.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),y.push(f.replaceWith)),y}):[]})(h.textBetween(E-_,R-_,void 0,"\ufffc"),e.find).forEach(st=>{if(void 0===st.index)return;const mt=E+st.index+1,At=mt+st[0].length,Nt={from:u.tr.mapping.map(mt),to:u.tr.mapping.map(At)},Ut=e.handler({state:u,range:Nt,match:st,commands:t,chain:n,can:o});s.push(Ut)})}),s.every(h=>null!==h)}({editor:a,state:st,from:Math.max(R-1,0),to:L.b-1,rule:n})&&Y.steps.length?Y:void 0}}))}class Et{constructor(a,u){this.splittableMarks=[],this.editor=u,this.extensions=Et.resolve(a),this.schema=S(this.extensions),this.extensions.forEach(f=>{var y;this.editor.extensionStorage[f.name]=f.storage;const e={name:f.name,options:f.options,storage:f.storage,editor:this.editor,type:r(f.name,this.schema)};"mark"===f.type&&(null===(y=I(St(f,"keepOnSplit",e)))||void 0===y||y)&&this.splittableMarks.push(f.name);const t=St(f,"onBeforeCreate",e);t&&this.editor.on("beforeCreate",t);const n=St(f,"onCreate",e);n&&this.editor.on("create",n);const o=St(f,"onUpdate",e);o&&this.editor.on("update",o);const s=St(f,"onSelectionUpdate",e);s&&this.editor.on("selectionUpdate",s);const l=St(f,"onTransaction",e);l&&this.editor.on("transaction",l);const h=St(f,"onFocus",e);h&&this.editor.on("focus",h);const _=St(f,"onBlur",e);_&&this.editor.on("blur",_);const E=St(f,"onDestroy",e);E&&this.editor.on("destroy",E)})}static resolve(a){const u=Et.sort(Et.flatten(a)),f=function(p){const a=p.filter((u,f)=>p.indexOf(u)!==f);return[...new Set(a)]}(u.map(y=>y.name));return f.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${f.map(y=>`'${y}'`).join(", ")}]. This can lead to issues.`),u}static flatten(a){return a.map(u=>{const y=St(u,"addExtensions",{name:u.name,options:u.options,storage:u.storage});return y?[u,...this.flatten(y())]:u}).flat(10)}static sort(a){return a.sort((f,y)=>{const e=St(f,"priority")||100,t=St(y,"priority")||100;return e>t?-1:e<t?1:0})}get commands(){return this.extensions.reduce((a,u)=>{const y=St(u,"addCommands",{name:u.name,options:u.options,storage:u.storage,editor:this.editor,type:r(u.name,this.schema)});return y?wt(wt({},a),y()):a},{})}get plugins(){const{editor:a}=this,u=Et.sort([...this.extensions].reverse()),f=[],y=[],e=u.map(t=>{const n={name:t.name,options:t.options,storage:t.storage,editor:a,type:r(t.name,this.schema)},o=[],s=St(t,"addKeyboardShortcuts",n);let l={};if("mark"===t.type&&t.config.exitable&&(l.ArrowRight=()=>Ze.handleExit({editor:a,mark:t})),s){const L=Object.fromEntries(Object.entries(s()).map(([Y,st])=>[Y,()=>st({editor:a})]));l=wt(wt({},l),L)}const h=(0,w.h)(l);o.push(h);const _=St(t,"addInputRules",n);d(t,a.options.enableInputRules)&&_&&f.push(..._());const E=St(t,"addPasteRules",n);d(t,a.options.enablePasteRules)&&E&&y.push(...E());const R=St(t,"addProseMirrorPlugins",n);if(R){const L=R();o.push(...L)}return o}).flat();return[_t({editor:a,rules:f}),...rt({editor:a,rules:y}),...e]}get attributes(){return qt(this.extensions)}get nodeViews(){const{editor:a}=this,{nodeExtensions:u}=Gt(this.extensions);return Object.fromEntries(u.filter(f=>!!St(f,"addNodeView")).map(f=>{const y=this.attributes.filter(o=>o.type===f.name),e={name:f.name,options:f.options,storage:f.storage,editor:a,type:j(f.name,this.schema)},t=St(f,"addNodeView",e);return t?[f.name,(o,s,l,h)=>{const _=v(o,y);return t()({editor:a,node:o,getPos:l,decorations:h,HTMLAttributes:_,extension:f})}]:[]}))}}function Ht(p){return"Object"===function(p){return Object.prototype.toString.call(p).slice(8,-1)}(p)&&p.constructor===Object&&Object.getPrototypeOf(p)===Object.prototype}function Ft(p,a){const u=wt({},p);return Ht(p)&&Ht(a)&&Object.keys(a).forEach(f=>{Ht(a[f])?f in p?u[f]=Ft(p[f],a[f]):Object.assign(u,{[f]:a[f]}):Object.assign(u,{[f]:a[f]})}),u}class zt{constructor(a={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=wt(wt({},this.config),a),this.name=this.config.name,a.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=I(St(this,"addOptions",{name:this.name}))),this.storage=I(St(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(a={}){return new zt(a)}configure(a={}){const u=this.extend();return u.options=Ft(this.options,a),u.storage=I(St(u,"addStorage",{name:u.name,options:u.options})),u}extend(a={}){const u=new zt(a);return u.parent=this,this.child=u,u.name=a.name?a.name:u.parent.name,a.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${u.name}".`),u.options=I(St(u,"addOptions",{name:u.name})),u.storage=I(St(u,"addStorage",{name:u.name,options:u.options})),u}}function Jt(p,a,u){const{from:f,to:y}=a,{blockSeparator:e="\n\n",textSerializers:t={}}=u||{};let n="",o=!0;return p.nodesBetween(f,y,(s,l,h,_)=>{var E;const R=null==t?void 0:t[s.type.name];R?(s.isBlock&&!o&&(n+=e,o=!0),h&&(n+=R({node:s,pos:l,parent:h,index:_,range:a}))):s.isText?(n+=null===(E=null==s?void 0:s.text)||void 0===E?void 0:E.slice(Math.max(f,l)-l,y-l),o=!1):s.isBlock&&!o&&(n+=e,o=!0)}),n}function Kt(p){return Object.fromEntries(Object.entries(p.nodes).filter(([,a])=>a.spec.toText).map(([a,u])=>[a,u.spec.toText]))}const jt=zt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new C.Sy({key:new C.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:p}=this,{state:a,schema:u}=p,{doc:f,selection:y}=a,{ranges:e}=y;return Jt(f,{from:Math.min(...e.map(l=>l.$from.pos)),to:Math.max(...e.map(l=>l.$to.pos))},{textSerializers:Kt(u)})}}})]}});function Ie(p,a,u={strict:!0}){const f=Object.keys(a);return!f.length||f.every(y=>u.strict?a[y]===p[y]:O(a[y])?a[y].test(p[y]):a[y]===p[y])}function Ne(p,a,u={}){return p.find(f=>f.type===a&&Ie(f.attrs,u))}function Qe(p,a,u={}){return!!Ne(p,a,u)}function He(p,a,u={}){if(!p||!a)return;let f=p.parent.childAfter(p.parentOffset);if(p.parentOffset===f.offset&&0!==f.offset&&(f=p.parent.childBefore(p.parentOffset)),!f.node)return;const y=Ne([...f.node.marks],a,u);if(!y)return;let e=f.index,t=p.start()+f.offset,n=e+1,o=t+f.node.nodeSize;for(Ne([...f.node.marks],a,u);e>0&&y.isInSet(p.parent.child(e-1).marks);)e-=1,t-=p.parent.child(e).nodeSize;for(;n<p.parent.childCount&&Qe([...p.parent.child(n).marks],a,u);)o+=p.parent.child(n).nodeSize,n+=1;return{from:t,to:o}}function pe(p,a){if("string"==typeof p){if(!a.marks[p])throw Error(`There is no mark type named '${p}'. Maybe you forgot to add the extension?`);return a.marks[p]}return p}function Se(p){return p instanceof C.Bs}function re(p=0,a=0,u=0){return Math.min(Math.max(p,a),u)}function Ue(p,a=null){if(!a)return null;const u=C.Y1.atStart(p),f=C.Y1.atEnd(p);if("start"===a||!0===a)return u;if("end"===a)return f;const y=u.from,e=f.to;return"all"===a?C.Bs.create(p,re(0,y,e),re(p.content.size,y,e)):C.Bs.create(p,re(a,y,e),re(a,y,e))}function ke(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function fn(p){const a=`<body>${p}</body>`;return(new window.DOMParser).parseFromString(a,"text/html").body}function ln(p,a,u){if(u=wt({slice:!0,parseOptions:{}},u),"object"==typeof p&&null!==p)try{return Array.isArray(p)?x.HY.fromArray(p.map(f=>a.nodeFromJSON(f))):a.nodeFromJSON(p)}catch(f){return console.warn("[tiptap warn]: Invalid content.","Passed value:",p,"Error:",f),ln("",a,u)}if("string"==typeof p){const f=x.aw.fromSchema(a);return u.slice?f.parseSlice(fn(p),u.parseOptions).content:f.parse(fn(p),u.parseOptions)}return ln("",a,u)}function Ln(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function ze(p,a,u={}){const{from:f,to:y,empty:e}=p.selection,t=a?j(a,p.schema):null,n=[];p.doc.nodesBetween(f,y,(h,_)=>{if(h.isText)return;const E=Math.max(f,_),R=Math.min(y,_+h.nodeSize);n.push({node:h,from:E,to:R})});const o=y-f,s=n.filter(h=>!t||t.name===h.node.type.name).filter(h=>Ie(h.node.attrs,u,{strict:!1}));return e?!!s.length:s.reduce((h,_)=>h+_.to-_.from,0)>=o}function an(p,a){return a.nodes[p]?"node":a.marks[p]?"mark":null}function Mn(p,a){const u="string"==typeof a?[a]:a;return Object.keys(p).reduce((f,y)=>(u.includes(y)||(f[y]=p[y]),f),{})}function we(p,a,u={}){return ln(p,a,{slice:!1,parseOptions:u})}function En(p,a){const u=new T.wx(p);return a.forEach(f=>{f.steps.forEach(y=>{u.step(y)})}),u}function mn(p){for(let a=0;a<p.edgeCount;a+=1){const{type:u}=p.edge(a);if(u.isTextblock&&!u.hasRequiredAttrs())return u}return null}function uo(p,a){const u=[];return p.descendants((f,y)=>{a(f)&&u.push({node:f,pos:y})}),u}function po(p,a,u){const f=[];return p.nodesBetween(a.from,a.to,(y,e)=>{u(y)&&f.push({node:y,pos:e})}),f}function cn(p,a){for(let u=p.depth;u>0;u-=1){const f=p.node(u);if(a(f))return{pos:u>0?p.before(u):0,start:p.start(u),depth:u,node:f}}}function _n(p){return a=>cn(a.$from,p)}function dn(p,a){const u=x.PW.fromSchema(a).serializeFragment(p),y=document.implementation.createHTMLDocument().createElement("div");return y.appendChild(u),y.innerHTML}function Be(p){return S(Et.resolve(p))}function ho(p,a){const u=Be(a);return dn(x.NB.fromJSON(u,p).content,u)}function fo(p,a){const u=Be(a),f=fn(p);return x.aw.fromSchema(u).parse(f).toJSON()}function yn(p,a){return Jt(p,{from:0,to:p.content.size},a)}function mo(p,a,u){const{blockSeparator:f="\n\n",textSerializers:y={}}=u||{},e=Be(a);return yn(x.NB.fromJSON(e,p),{blockSeparator:f,textSerializers:wt(wt({},y),Kt(e))})}function On(p,a){const u=pe(a,p.schema),{from:f,to:y,empty:e}=p.selection,t=[];e?(p.storedMarks&&t.push(...p.storedMarks),t.push(...p.selection.$head.marks())):p.doc.nodesBetween(f,y,o=>{t.push(...o.marks)});const n=t.find(o=>o.type.name===u.name);return n?wt({},n.attrs):{}}function Un(p,a){const u=j(a,p.schema),{from:f,to:y}=p.selection,e=[];p.doc.nodesBetween(f,y,n=>{e.push(n)});const t=e.reverse().find(n=>n.type.name===u.name);return t?wt({},t.attrs):{}}function gn(p,a){const u=an("string"==typeof a?a:a.name,p.schema);return"node"===u?Un(p,a):"mark"===u?On(p,a):{}}function Wn(p){const{mapping:a,steps:u}=p,f=[];return a.maps.forEach((y,e)=>{const t=[];if(y.ranges.length)y.forEach((n,o)=>{t.push({from:n,to:o})});else{const{from:n,to:o}=u[e];if(void 0===n||void 0===o)return;t.push({from:n,to:o})}t.forEach(({from:n,to:o})=>{const s=a.slice(e).map(n,-1),l=a.slice(e).map(o),h=a.invert().map(s,-1),_=a.invert().map(l);f.push({oldRange:{from:h,to:_},newRange:{from:s,to:l}})})}),function(p){const a=function(p,a=JSON.stringify){const u={};return p.filter(f=>{const y=a(f);return!Object.prototype.hasOwnProperty.call(u,y)&&(u[y]=!0)})}(p);return 1===a.length?a:a.filter((u,f)=>!a.filter((e,t)=>t!==f).some(e=>u.oldRange.from>=e.oldRange.from&&u.oldRange.to<=e.oldRange.to&&u.newRange.from>=e.newRange.from&&u.newRange.to<=e.newRange.to))}(f)}function zn(p,a=0){const f=p.type===p.type.schema.topNodeType?0:1,y=a,e=y+p.nodeSize,t=p.marks.map(s=>{const l={type:s.type.name};return Object.keys(s.attrs).length&&(l.attrs=wt({},s.attrs)),l}),n=wt({},p.attrs),o={type:p.type.name,from:y,to:e};return Object.keys(n).length&&(o.attrs=n),t.length&&(o.marks=t),p.content.childCount&&(o.content=[],p.forEach((s,l)=>{var h;null===(h=o.content)||void 0===h||h.push(zn(s,a+l+f))})),p.text&&(o.text=p.text),o}function Tn(p,a,u){const f=[];return p===a?u.resolve(p).marks().forEach(y=>{const t=He(u.resolve(p-1),y.type);!t||f.push(wt({mark:y},t))}):u.nodesBetween(p,a,(y,e)=>{f.push(...y.marks.map(t=>({from:e,to:e+y.nodeSize,mark:t})))}),f}function un(p,a,u={}){const{empty:f,ranges:y}=p.selection,e=a?pe(a,p.schema):null;if(f)return!!(p.storedMarks||p.selection.$from.marks()).filter(h=>!e||e.name===h.type.name).find(h=>Ie(h.attrs,u,{strict:!1}));let t=0;const n=[];if(y.forEach(({$from:h,$to:_})=>{const E=h.pos,R=_.pos;p.doc.nodesBetween(E,R,(L,Y)=>{if(!L.isText&&!L.marks.length)return;const st=Math.max(E,Y),mt=Math.min(R,Y+L.nodeSize);t+=mt-st,n.push(...L.marks.map(Nt=>({mark:Nt,from:st,to:mt})))})}),0===t)return!1;const o=n.filter(h=>!e||e.name===h.mark.type.name).filter(h=>Ie(h.mark.attrs,u,{strict:!1})).reduce((h,_)=>h+_.to-_.from,0),s=n.filter(h=>!e||h.mark.type!==e&&h.mark.type.excludes(e)).reduce((h,_)=>h+_.to-_.from,0);return(o>0?o+s:o)>=t}function Kn(p,a,u={}){if(!a)return ze(p,null,u)||un(p,null,u);const f=an(a,p.schema);return"node"===f?ze(p,a,u):"mark"===f&&un(p,a,u)}function qe(p,a){const{nodeExtensions:u}=Gt(a),f=u.find(t=>t.name===p);if(!f)return!1;const e=I(St(f,"group",{name:f.name,options:f.options,storage:f.storage}));return"string"==typeof e&&e.split(" ").includes("list")}function Jn(p){var a;const u=null===(a=p.type.createAndFill())||void 0===a?void 0:a.toJSON(),f=p.toJSON();return JSON.stringify(u)===JSON.stringify(f)}function tn(p){return p instanceof C.qv}function go(p,a,u){const y=p.state.doc.content.size,e=re(a,0,y),t=re(u,0,y),n=p.coordsAtPos(e),o=p.coordsAtPos(t,-1),s=Math.min(n.top,o.top),l=Math.max(n.bottom,o.bottom),h=Math.min(n.left,o.left),_=Math.max(n.right,o.right),st={top:s,bottom:l,left:h,right:_,width:_-h,height:l-s,x:h,y:s};return Oe(wt({},st),{toJSON:()=>st})}function en(p,a,u){return Object.fromEntries(Object.entries(u).filter(([f])=>{const y=p.find(e=>e.type===a&&e.name===f);return!!y&&y.attribute.keepOnSplit}))}function ye(p,a){const u=p.storedMarks||p.selection.$to.parentOffset&&p.selection.$from.marks();if(u){const f=u.filter(y=>null==a?void 0:a.includes(y.type.name));p.tr.ensureMarks(f)}}const oe=(p,a)=>{const u=_n(t=>t.type===a)(p.selection);if(!u)return!0;const f=p.doc.resolve(Math.max(0,u.pos-1)).before(u.depth);if(void 0===f)return!0;const y=p.doc.nodeAt(f);return u.node.type===(null==y?void 0:y.type)&&(0,T.Mn)(p.doc,u.pos)&&p.join(u.pos),!0},se=(p,a)=>{const u=_n(t=>t.type===a)(p.selection);if(!u)return!0;const f=p.doc.resolve(u.start).after(u.depth);if(void 0===f)return!0;const y=p.doc.nodeAt(f);return u.node.type===(null==y?void 0:y.type)&&(0,T.Mn)(p.doc,f)&&p.join(f),!0};var Pn=Object.freeze({__proto__:null,blur:()=>({editor:p,view:a})=>(requestAnimationFrame(()=>{var u;p.isDestroyed||(a.dom.blur(),null===(u=null==window?void 0:window.getSelection())||void 0===u||u.removeAllRanges())}),!0),clearContent:(p=!1)=>({commands:a})=>a.setContent("",p),clearNodes:()=>({state:p,tr:a,dispatch:u})=>{const{selection:f}=a,{ranges:y}=f;return u&&y.forEach(({$from:e,$to:t})=>{p.doc.nodesBetween(e.pos,t.pos,(n,o)=>{if(n.type.isText)return;const{doc:s,mapping:l}=a,h=s.resolve(l.map(o)),_=s.resolve(l.map(o+n.nodeSize)),E=h.blockRange(_);if(!E)return;const R=(0,T.k9)(E);if(n.type.isTextblock){const{defaultType:L}=h.parent.contentMatchAt(h.index());a.setNodeMarkup(E.start,L)}(R||0===R)&&a.lift(E,R)})}),!0},command:p=>a=>p(a),createParagraphNear:()=>({state:p,dispatch:a})=>V(p,a),deleteNode:p=>({tr:a,state:u,dispatch:f})=>{const y=j(p,u.schema),e=a.selection.$anchor;for(let t=e.depth;t>0;t-=1)if(e.node(t).type===y){if(f){const o=e.before(t),s=e.after(t);a.delete(o,s).scrollIntoView()}return!0}return!1},deleteRange:p=>({tr:a,dispatch:u})=>{const{from:f,to:y}=p;return u&&a.delete(f,y),!0},deleteSelection:()=>({state:p,dispatch:a})=>Q(p,a),enter:()=>({commands:p})=>p.keyboardShortcut("Enter"),exitCode:()=>({state:p,dispatch:a})=>U(p,a),extendMarkRange:(p,a={})=>({tr:u,state:f,dispatch:y})=>{const e=pe(p,f.schema),{doc:t,selection:n}=u,{$from:o,from:s,to:l}=n;if(y){const h=He(o,e,a);if(h&&h.from<=s&&h.to>=l){const _=C.Bs.create(t,h.from,h.to);u.setSelection(_)}}return!0},first:p=>a=>{const u="function"==typeof p?p(a):p;for(let f=0;f<u.length;f+=1)if(u[f](a))return!0;return!1},focus:(p=null,a={})=>({editor:u,view:f,tr:y,dispatch:e})=>{a=wt({scrollIntoView:!0},a);const t=()=>{ke()&&f.dom.focus(),requestAnimationFrame(()=>{u.isDestroyed||(f.focus(),(null==a?void 0:a.scrollIntoView)&&u.commands.scrollIntoView())})};if(f.hasFocus()&&null===p||!1===p)return!0;if(e&&null===p&&!Se(u.state.selection))return t(),!0;const n=Ue(y.doc,p)||u.state.selection,o=u.state.selection.eq(n);return e&&(o||y.setSelection(n),o&&y.storedMarks&&y.setStoredMarks(y.storedMarks),t()),!0},forEach:(p,a)=>u=>p.every((f,y)=>a(f,Oe(wt({},u),{index:y}))),insertContent:(p,a)=>({tr:u,commands:f})=>f.insertContentAt({from:u.selection.from,to:u.selection.to},p,a),insertContentAt:(p,a,u)=>({tr:f,dispatch:y,editor:e})=>{if(y){u=wt({parseOptions:{},updateSelection:!0},u);const t=ln(a,e.schema,{parseOptions:wt({preserveWhitespace:"full"},u.parseOptions)});if("<>"===t.toString())return!0;let{from:n,to:o}="number"==typeof p?{from:p,to:p}:p,s=!0,l=!0;if(((p=>p.toString().startsWith("<"))(t)?t:[t]).forEach(_=>{_.check(),s=!!s&&_.isText&&0===_.marks.length,l=!!l&&_.isBlock}),n===o&&l){const{parent:_}=f.doc.resolve(n);_.isTextblock&&!_.type.spec.code&&!_.childCount&&(n-=1,o+=1)}s?f.insertText(a,n,o):f.replaceWith(n,o,t),u.updateSelection&&function(p,a,u){const f=p.steps.length-1;if(f<a)return;const y=p.steps[f];if(!(y instanceof T.Pu||y instanceof T.FC))return;let t=0;p.mapping.maps[f].forEach((n,o,s,l)=>{0===t&&(t=l)}),p.setSelection(C.Y1.near(p.doc.resolve(t),-1))}(f,f.steps.length-1)}return!0},joinBackward:()=>({state:p,dispatch:a})=>D(p,a),joinForward:()=>({state:p,dispatch:a})=>X(p,a),keyboardShortcut:p=>({editor:a,view:u,tr:f,dispatch:y})=>{const e=function(p){const a=p.split(/-(?!$)/);let f,y,e,t,u=a[a.length-1];"Space"===u&&(u=" ");for(let n=0;n<a.length-1;n+=1){const o=a[n];if(/^(cmd|meta|m)$/i.test(o))t=!0;else if(/^a(lt)?$/i.test(o))f=!0;else if(/^(c|ctrl|control)$/i.test(o))y=!0;else if(/^s(hift)?$/i.test(o))e=!0;else{if(!/^mod$/i.test(o))throw new Error(`Unrecognized modifier name: ${o}`);ke()||Ln()?t=!0:y=!0}}return f&&(u=`Alt-${u}`),y&&(u=`Ctrl-${u}`),t&&(u=`Meta-${u}`),e&&(u=`Shift-${u}`),u}(p).split(/-(?!$)/),t=e.find(s=>!["Alt","Ctrl","Meta","Shift"].includes(s)),n=new KeyboardEvent("keydown",{key:"Space"===t?" ":t,altKey:e.includes("Alt"),ctrlKey:e.includes("Ctrl"),metaKey:e.includes("Meta"),shiftKey:e.includes("Shift"),bubbles:!0,cancelable:!0}),o=a.captureTransaction(()=>{u.someProp("handleKeyDown",s=>s(u,n))});return null==o||o.steps.forEach(s=>{const l=s.map(f.mapping);l&&y&&f.maybeStep(l)}),!0},lift:(p,a={})=>({state:u,dispatch:f})=>!!ze(u,j(p,u.schema),a)&&((p,a)=>{let{$from:u,$to:f}=p.selection,y=u.blockRange(f),e=y&&(0,T.k9)(y);return null!=e&&(a&&a(p.tr.lift(y,e).scrollIntoView()),!0)})(u,f),liftEmptyBlock:()=>({state:p,dispatch:a})=>H(p,a),liftListItem:p=>({state:a,dispatch:u})=>function(p){return function(a,u){let{$from:f,$to:y}=a.selection,e=f.blockRange(y,t=>t.childCount>0&&t.firstChild.type==p);return!!e&&(!u||(f.node(e.depth-1).type==p?function(p,a,u,f){let y=p.tr,e=f.end,t=f.$to.end(f.depth);e<t&&(y.step(new T.FC(e-1,t,e,t,new x.p2(x.HY.from(u.create(null,f.parent.copy())),1,0),1,!0)),f=new x.Ts(y.doc.resolve(f.$from.pos),y.doc.resolve(t),f.depth));const n=(0,T.k9)(f);if(null==n)return!1;y.lift(f,n);let o=y.mapping.map(e,-1)-1;return(0,T.Mn)(y.doc,o)&&y.join(o),a(y.scrollIntoView()),!0}(a,u,p,e):function(p,a,u){let f=p.tr,y=u.parent;for(let E=u.end,R=u.endIndex-1,L=u.startIndex;R>L;R--)E-=y.child(R).nodeSize,f.delete(E-1,E+1);let e=f.doc.resolve(u.start),t=e.nodeAfter;if(f.mapping.map(u.end)!=u.start+e.nodeAfter.nodeSize)return!1;let n=0==u.startIndex,o=u.endIndex==y.childCount,s=e.node(-1),l=e.index(-1);if(!s.canReplace(l+(n?0:1),l+1,t.content.append(o?x.HY.empty:x.HY.from(y))))return!1;let h=e.pos,_=h+t.nodeSize;return f.step(new T.FC(h-(n?1:0),_+(o?1:0),h+1,_-1,new x.p2((n?x.HY.empty:x.HY.from(y.copy(x.HY.empty))).append(o?x.HY.empty:x.HY.from(y.copy(x.HY.empty))),n?0:1,o?0:1),n?0:1)),a(f.scrollIntoView()),!0}(a,u,e)))}}(j(p,a.schema))(a,u),newlineInCode:()=>({state:p,dispatch:a})=>Tt(p,a),resetAttributes:(p,a)=>({tr:u,state:f,dispatch:y})=>{let e=null,t=null;const n=an("string"==typeof p?p:p.name,f.schema);return!!n&&("node"===n&&(e=j(p,f.schema)),"mark"===n&&(t=pe(p,f.schema)),y&&u.selection.ranges.forEach(o=>{f.doc.nodesBetween(o.$from.pos,o.$to.pos,(s,l)=>{e&&e===s.type&&u.setNodeMarkup(l,void 0,Mn(s.attrs,a)),t&&s.marks.length&&s.marks.forEach(h=>{t===h.type&&u.addMark(l,l+s.nodeSize,t.create(Mn(h.attrs,a)))})})}),!0)},scrollIntoView:()=>({tr:p,dispatch:a})=>(a&&p.scrollIntoView(),!0),selectAll:()=>({tr:p,commands:a})=>a.setTextSelection({from:0,to:p.doc.content.size}),selectNodeBackward:()=>({state:p,dispatch:a})=>$(p,a),selectNodeForward:()=>({state:p,dispatch:a})=>gt(p,a),selectParentNode:()=>({state:p,dispatch:a})=>((p,a)=>{let y,{$from:u,to:f}=p.selection,e=u.sharedDepth(f);return 0!=e&&(y=u.before(e),a&&a(p.tr.setSelection(C.qv.create(p.doc,y))),!0)})(p,a),selectTextblockEnd:()=>({state:p,dispatch:a})=>tt(p,a),selectTextblockStart:()=>({state:p,dispatch:a})=>Bt(p,a),setContent:(p,a=!1,u={})=>({tr:f,editor:y,dispatch:e})=>{const{doc:t}=f,n=we(p,y.schema,u);return e&&f.replaceWith(0,t.content.size,n).setMeta("preventUpdate",!a),!0},setMark:(p,a={})=>({tr:u,state:f,dispatch:y})=>{const{selection:e}=u,{empty:t,ranges:n}=e,o=pe(p,f.schema);if(y)if(t){const s=On(f,o);u.addStoredMark(o.create(wt(wt({},s),a)))}else n.forEach(s=>{const l=s.$from.pos,h=s.$to.pos;f.doc.nodesBetween(l,h,(_,E)=>{const R=Math.max(E,l),L=Math.min(E+_.nodeSize,h);_.marks.find(st=>st.type===o)?_.marks.forEach(st=>{o===st.type&&u.addMark(R,L,o.create(wt(wt({},st.attrs),a)))}):u.addMark(R,L,o.create(a))})});return function(p,a,u){var f;const{selection:y}=a;let e=null;if(Se(y)&&(e=y.$cursor),e){const n=null!==(f=p.storedMarks)&&void 0!==f?f:e.marks();return!!u.isInSet(n)||!n.some(o=>o.type.excludes(u))}const{ranges:t}=y;return t.some(({$from:n,$to:o})=>{let s=0===n.depth&&p.doc.inlineContent&&p.doc.type.allowsMarkType(u);return p.doc.nodesBetween(n.pos,o.pos,(l,h,_)=>{if(s)return!1;if(l.isInline){const E=!_||_.type.allowsMarkType(u),R=!!u.isInSet(l.marks)||!l.marks.some(L=>L.type.excludes(u));s=E&&R}return!s}),s})}(f,u,o)},setMeta:(p,a)=>({tr:u})=>(u.setMeta(p,a),!0),setNode:(p,a={})=>({state:u,dispatch:f,chain:y})=>{const e=j(p,u.schema);return e.isTextblock?y().command(({commands:t})=>!!F(e,a)(u)||t.clearNodes()).command(({state:t})=>F(e,a)(t,f)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:p=>({tr:a,dispatch:u})=>{if(u){const{doc:f}=a,y=re(p,0,f.content.size),e=C.qv.create(f,y);a.setSelection(e)}return!0},setTextSelection:p=>({tr:a,dispatch:u})=>{if(u){const{doc:f}=a,{from:y,to:e}="number"==typeof p?{from:p,to:p}:p,t=C.Bs.atStart(f).from,n=C.Bs.atEnd(f).to,o=re(y,t,n),s=re(e,t,n),l=C.Bs.create(f,o,s);a.setSelection(l)}return!0},sinkListItem:p=>({state:a,dispatch:u})=>function(p){return function(a,u){let{$from:f,$to:y}=a.selection,e=f.blockRange(y,s=>s.childCount>0&&s.firstChild.type==p);if(!e)return!1;let t=e.startIndex;if(0==t)return!1;let n=e.parent,o=n.child(t-1);if(o.type!=p)return!1;if(u){let s=o.lastChild&&o.lastChild.type==n.type,l=x.HY.from(s?p.create():null),h=new x.p2(x.HY.from(p.create(null,x.HY.from(n.type.create(null,l)))),s?3:1,0),_=e.start,E=e.end;u(a.tr.step(new T.FC(_-(s?3:1),E,_,E,h,1,!0)).scrollIntoView())}return!0}}(j(p,a.schema))(a,u),splitBlock:({keepMarks:p=!0}={})=>({tr:a,state:u,dispatch:f,editor:y})=>{const{selection:e,doc:t}=a,{$from:n,$to:o}=e,l=en(y.extensionManager.attributes,n.node().type.name,n.node().attrs);if(e instanceof C.qv&&e.node.isBlock)return!(!n.parentOffset||!(0,T.Ax)(t,n.pos)||(f&&(p&&ye(u,y.extensionManager.splittableMarks),a.split(n.pos).scrollIntoView()),0));if(!n.parent.isBlock)return!1;if(f){const h=o.parentOffset===o.parent.content.size;e instanceof C.Bs&&a.deleteSelection();const _=0===n.depth?void 0:mn(n.node(-1).contentMatchAt(n.indexAfter(-1)));let E=h&&_?[{type:_,attrs:l}]:void 0,R=(0,T.Ax)(a.doc,a.mapping.map(n.pos),1,E);if(!E&&!R&&(0,T.Ax)(a.doc,a.mapping.map(n.pos),1,_?[{type:_}]:void 0)&&(R=!0,E=_?[{type:_,attrs:l}]:void 0),R&&(a.split(a.mapping.map(n.pos),1,E),_&&!h&&!n.parentOffset&&n.parent.type!==_)){const L=a.mapping.map(n.before()),Y=a.doc.resolve(L);n.node(-1).canReplaceWith(Y.index(),Y.index()+1,_)&&a.setNodeMarkup(a.mapping.map(n.before()),_)}p&&ye(u,y.extensionManager.splittableMarks),a.scrollIntoView()}return!0},splitListItem:p=>({tr:a,state:u,dispatch:f,editor:y})=>{var e;const t=j(p,u.schema),{$from:n,$to:o}=u.selection,s=u.selection.node;if(s&&s.isBlock||n.depth<2||!n.sameParent(o))return!1;const l=n.node(-1);if(l.type!==t)return!1;const h=y.extensionManager.attributes;if(0===n.parent.content.size&&n.node(-1).childCount===n.indexAfter(-1)){if(2===n.depth||n.node(-3).type!==t||n.index(-2)!==n.node(-2).childCount-1)return!1;if(f){let Y=x.HY.empty;const st=n.index(-1)?1:n.index(-2)?2:3;for(let ae=n.depth-st;ae>=n.depth-3;ae-=1)Y=x.HY.from(n.node(ae).copy(Y));const mt=n.indexAfter(-1)<n.node(-2).childCount?1:n.indexAfter(-2)<n.node(-3).childCount?2:3,At=en(h,n.node().type.name,n.node().attrs),Nt=(null===(e=t.contentMatch.defaultType)||void 0===e?void 0:e.createAndFill(At))||void 0;Y=Y.append(x.HY.from(t.createAndFill(null,Nt)||void 0));const Ut=n.before(n.depth-(st-1));a.replace(Ut,n.after(-mt),new x.p2(Y,4-st,0));let Yt=-1;a.doc.nodesBetween(Ut,a.doc.content.size,(ae,Pe)=>{if(Yt>-1)return!1;ae.isTextblock&&0===ae.content.size&&(Yt=Pe+1)}),Yt>-1&&a.setSelection(C.Bs.near(a.doc.resolve(Yt))),a.scrollIntoView()}return!0}const _=o.pos===n.end()?l.contentMatchAt(0).defaultType:null,E=en(h,l.type.name,l.attrs),R=en(h,n.node().type.name,n.node().attrs);a.delete(n.pos,o.pos);const L=_?[{type:t,attrs:E},{type:_,attrs:R}]:[{type:t,attrs:E}];return!!(0,T.Ax)(a.doc,n.pos,2)&&(f&&a.split(n.pos,2,L).scrollIntoView(),!0)},toggleList:(p,a)=>({editor:u,tr:f,state:y,dispatch:e,chain:t,commands:n,can:o})=>{const{extensions:s}=u.extensionManager,l=j(p,y.schema),h=j(a,y.schema),{selection:_}=y,{$from:E,$to:R}=_,L=E.blockRange(R);if(!L)return!1;const Y=_n(st=>qe(st.type.name,s))(_);if(L.depth>=1&&Y&&L.depth-Y.depth<=1){if(Y.node.type===l)return n.liftListItem(h);if(qe(Y.node.type.name,s)&&l.validContent(Y.node.content)&&e)return t().command(()=>(f.setNodeMarkup(Y.pos,l),!0)).command(()=>oe(f,l)).command(()=>se(f,l)).run()}return t().command(()=>!!o().wrapInList(l)||n.clearNodes()).wrapInList(l).command(()=>oe(f,l)).command(()=>se(f,l)).run()},toggleMark:(p,a={},u={})=>({state:f,commands:y})=>{const{extendEmptyMarkRange:e=!1}=u,t=pe(p,f.schema);return un(f,t,a)?y.unsetMark(t,{extendEmptyMarkRange:e}):y.setMark(t,a)},toggleNode:(p,a,u={})=>({state:f,commands:y})=>{const e=j(p,f.schema),t=j(a,f.schema);return ze(f,e,u)?y.setNode(t):y.setNode(e,u)},toggleWrap:(p,a={})=>({state:u,commands:f})=>{const y=j(p,u.schema);return ze(u,y,a)?f.lift(y):f.wrapIn(y,a)},undoInputRule:()=>({state:p,dispatch:a})=>{const u=p.plugins;for(let f=0;f<u.length;f+=1){const y=u[f];let e;if(y.spec.isInputRules&&(e=y.getState(p))){if(a){const t=p.tr,n=e.transform;for(let o=n.steps.length-1;o>=0;o-=1)t.step(n.steps[o].invert(n.docs[o]));if(e.text){const o=t.doc.resolve(e.from).marks();t.replaceWith(e.from,e.to,p.schema.text(e.text,o))}else t.delete(e.from,e.to)}return!0}}return!1},unsetAllMarks:()=>({tr:p,dispatch:a})=>{const{selection:u}=p,{empty:f,ranges:y}=u;return f||a&&y.forEach(e=>{p.removeMark(e.$from.pos,e.$to.pos)}),!0},unsetMark:(p,a={})=>({tr:u,state:f,dispatch:y})=>{var e;const{extendEmptyMarkRange:t=!1}=a,{selection:n}=u,o=pe(p,f.schema),{$from:s,empty:l,ranges:h}=n;if(!y)return!0;if(l&&t){let{from:_,to:E}=n;const R=null===(e=s.marks().find(Y=>Y.type===o))||void 0===e?void 0:e.attrs,L=He(s,o,R);L&&(_=L.from,E=L.to),u.removeMark(_,E,o)}else h.forEach(_=>{u.removeMark(_.$from.pos,_.$to.pos,o)});return u.removeStoredMark(o),!0},updateAttributes:(p,a={})=>({tr:u,state:f,dispatch:y})=>{let e=null,t=null;const n=an("string"==typeof p?p:p.name,f.schema);return!!n&&("node"===n&&(e=j(p,f.schema)),"mark"===n&&(t=pe(p,f.schema)),y&&u.selection.ranges.forEach(o=>{const s=o.$from.pos,l=o.$to.pos;f.doc.nodesBetween(s,l,(h,_)=>{e&&e===h.type&&u.setNodeMarkup(_,void 0,wt(wt({},h.attrs),a)),t&&h.marks.length&&h.marks.forEach(E=>{if(t===E.type){const R=Math.max(_,s),L=Math.min(_+h.nodeSize,l);u.addMark(R,L,t.create(wt(wt({},E.attrs),a)))}})})}),!0)},wrapIn:(p,a={})=>({state:u,dispatch:f})=>function(p,a=null){return function(u,f){let{$from:y,$to:e}=u.selection,t=y.blockRange(e),n=t&&(0,T.nd)(t,p,a);return!!n&&(f&&f(u.tr.wrap(t,n).scrollIntoView()),!0)}}(j(p,u.schema),a)(u,f),wrapInList:(p,a={})=>({state:u,dispatch:f})=>function(p,a=null){return function(u,f){let{$from:y,$to:e}=u.selection,t=y.blockRange(e),n=!1,o=t;if(!t)return!1;if(t.depth>=2&&y.node(t.depth-1).type.compatibleContent(p)&&0==t.startIndex){if(0==y.index(t.depth-1))return!1;let l=u.doc.resolve(t.start-2);o=new x.Ts(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new x.Ts(y,u.doc.resolve(e.end(t.depth)),t.depth)),n=!0}let s=(0,T.nd)(o,p,a,t);return!!s&&(f&&f(function(p,a,u,f,y){let e=x.HY.empty;for(let l=u.length-1;l>=0;l--)e=x.HY.from(u[l].type.create(u[l].attrs,e));p.step(new T.FC(a.start-(f?2:0),a.end,a.start,a.end,new x.p2(e,0,0),u.length,!0));let t=0;for(let l=0;l<u.length;l++)u[l].type==y&&(t=l+1);let n=u.length-t,o=a.start+u.length-(f?2:0),s=a.parent;for(let l=a.startIndex,h=a.endIndex,_=!0;l<h;l++,_=!1)!_&&(0,T.Ax)(p.doc,o,n)&&(p.split(o,n),o+=2*n),o+=s.child(l).nodeSize;return p}(u.tr,t,s,n,p).scrollIntoView()),!0)}}(j(p,u.schema),a)(u,f)});const Oo=zt.create({name:"commands",addCommands:()=>wt({},Pn)}),xo=zt.create({name:"editable",addProseMirrorPlugins(){return[new C.Sy({key:new C.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),bo=zt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:p}=this;return[new C.Sy({key:new C.H$("focusEvents"),props:{handleDOMEvents:{focus:(a,u)=>{p.isFocused=!0;const f=p.state.tr.setMeta("focus",{event:u}).setMeta("addToHistory",!1);return a.dispatch(f),!1},blur:(a,u)=>{p.isFocused=!1;const f=p.state.tr.setMeta("blur",{event:u}).setMeta("addToHistory",!1);return a.dispatch(f),!1}}}})]}}),Do=zt.create({name:"keymap",addKeyboardShortcuts(){const p=()=>this.editor.commands.first(({commands:t})=>[()=>t.undoInputRule(),()=>t.command(({tr:n})=>{const{selection:o,doc:s}=n,{empty:l,$anchor:h}=o,{pos:_,parent:E}=h,R=C.Y1.atStart(s).from===_;return!(!(l&&R&&E.type.isTextblock)||E.textContent.length)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]),a=()=>this.editor.commands.first(({commands:t})=>[()=>t.deleteSelection(),()=>t.joinForward(),()=>t.selectNodeForward()]),f={Enter:()=>this.editor.commands.first(({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:p,"Mod-Backspace":p,"Shift-Backspace":p,Delete:a,"Mod-Delete":a,"Mod-a":()=>this.editor.commands.selectAll()},y=wt({},f),e=Oe(wt({},f),{"Ctrl-h":p,"Alt-Backspace":p,"Ctrl-d":a,"Ctrl-Alt-Backspace":a,"Alt-Delete":a,"Alt-d":a,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return ke()||Ln()?e:y},addProseMirrorPlugins(){return[new C.Sy({key:new C.H$("clearDocument"),appendTransaction:(p,a,u)=>{if(!p.some(R=>R.docChanged)||a.doc.eq(u.doc))return;const{empty:y,from:e,to:t}=a.selection,n=C.Y1.atStart(a.doc).from,o=C.Y1.atEnd(a.doc).to,s=e===n&&t===o,l=0===u.doc.textBetween(0,u.doc.content.size," "," ").length;if(y||!s||!l)return;const h=u.tr,_=ge({state:u,transaction:h}),{commands:E}=new Vt({editor:this.editor,state:_});return E.clearNodes(),h.steps.length?h:void 0}})]}}),Yn=zt.create({name:"tabindex",addProseMirrorPlugins(){return[new C.Sy({key:new C.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var An=Object.freeze({__proto__:null,ClipboardTextSerializer:jt,Commands:Oo,Editable:xo,FocusEvents:bo,Keymap:Do,Tabindex:Yn});class Io extends class{constructor(){this.callbacks={}}on(a,u){return this.callbacks[a]||(this.callbacks[a]=[]),this.callbacks[a].push(u),this}emit(a,...u){const f=this.callbacks[a];return f&&f.forEach(y=>y.apply(this,u)),this}off(a,u){const f=this.callbacks[a];return f&&(u?this.callbacks[a]=f.filter(y=>y!==u):delete this.callbacks[a]),this}removeAllListeners(){this.callbacks={}}}{constructor(a={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(a),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(p,a){const u=document.querySelector("style[data-tiptap-style]");if(null!==u)return u;const f=document.createElement("style");return a&&f.setAttribute("nonce",a),f.setAttribute("data-tiptap-style",""),f.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',document.getElementsByTagName("head")[0].appendChild(f),f}(0,this.options.injectNonce))}setOptions(a={}){this.options=wt(wt({},this.options),a),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(a){this.setOptions({editable:a}),this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(a,u){const f=M(u)?u(a,[...this.state.plugins]):[...this.state.plugins,a],y=this.state.reconfigure({plugins:f});this.view.updateState(y)}unregisterPlugin(a){if(this.isDestroyed)return;const u="string"==typeof a?`${a}$`:a.key,f=this.state.reconfigure({plugins:this.state.plugins.filter(y=>!y.key.startsWith(u))});this.view.updateState(f)}createExtensionManager(){const u=[...this.options.enableCoreExtensions?Object.values(An):[],...this.options.extensions].filter(f=>["extension","node","mark"].includes(null==f?void 0:f.type));this.extensionManager=new Et(u,this)}createCommandManager(){this.commandManager=new Vt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const a=we(this.options.content,this.schema,this.options.parseOptions),u=Ue(a,this.options.autofocus);this.view=new i.tk(this.options.element,Oe(wt({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:C.yy.create({doc:a,selection:u||void 0})}));const f=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(f),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(a){this.isCapturingTransaction=!0,a(),this.isCapturingTransaction=!1;const u=this.capturedTransaction;return this.capturedTransaction=null,u}dispatchTransaction(a){if(this.isCapturingTransaction)return this.capturedTransaction?void a.steps.forEach(t=>{var n;return null===(n=this.capturedTransaction)||void 0===n?void 0:n.step(t)}):void(this.capturedTransaction=a);const u=this.state.apply(a),f=!this.state.selection.eq(u.selection);this.view.updateState(u),this.emit("transaction",{editor:this,transaction:a}),f&&this.emit("selectionUpdate",{editor:this,transaction:a});const y=a.getMeta("focus"),e=a.getMeta("blur");y&&this.emit("focus",{editor:this,event:y.event,transaction:a}),e&&this.emit("blur",{editor:this,event:e.event,transaction:a}),a.docChanged&&!a.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:a})}getAttributes(a){return gn(this.state,a)}isActive(a,u){return Kn(this.state,"string"==typeof a?a:null,"string"==typeof a?u:a)}getJSON(){return this.state.doc.toJSON()}getHTML(){return dn(this.state.doc.content,this.schema)}getText(a){const{blockSeparator:u="\n\n",textSerializers:f={}}=a||{};return yn(this.state.doc,{blockSeparator:u,textSerializers:wt(wt({},f),Kt(this.schema))})}get isEmpty(){return Jn(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var a;return!(null===(a=this.view)||void 0===a?void 0:a.docView)}}function So(p){return new P({find:p.find,handler:({state:a,range:u,match:f})=>{const y=I(p.getAttributes,void 0,f);if(!1===y||null===y)return null;const{tr:e}=a,t=f[f.length-1],n=f[0];let o=u.to;if(t){const s=n.search(/\S/),l=u.from+n.indexOf(t),h=l+t.length;if(Tn(u.from,u.to,a.doc).filter(E=>E.mark.type.excluded.find(L=>L===p.type&&L!==E.mark.type)).filter(E=>E.to>l).length)return null;h<u.to&&e.delete(h,u.to),l>u.from&&e.delete(u.from+s,l),o=u.from+s+t.length,e.addMark(u.from+s,o,p.type.create(y||{})),e.removeStoredMark(p.type)}}})}function ko(p){return new P({find:p.find,handler:({state:a,range:u,match:f})=>{const y=I(p.getAttributes,void 0,f)||{},{tr:e}=a,t=u.from;let n=u.to;if(f[1]){let s=t+f[0].lastIndexOf(f[1]);s>n?s=n:n=s+f[1].length,e.insertText(f[0][f[0].length-1],t+f[0].length-1),e.replaceWith(s,n,p.type.create(y))}else f[0]&&e.replaceWith(t,n,p.type.create(y))}})}function Vn(p){return new P({find:p.find,handler:({state:a,range:u,match:f})=>{const y=a.doc.resolve(u.from),e=I(p.getAttributes,void 0,f)||{};if(!y.node(-1).canReplaceWith(y.index(-1),y.indexAfter(-1),p.type))return null;a.tr.delete(u.from,u.to).setBlockType(u.from,u.from,p.type,e)}})}function Ro(p){return new P({find:p.find,handler:({state:a,range:u,match:f})=>{let y=p.replace,e=u.from;const t=u.to;if(f[1]){const n=f[0].lastIndexOf(f[1]);y+=f[0].slice(n+f[1].length),e+=n;const o=e-t;o>0&&(y=f[0].slice(n-o,n)+y,e=t)}a.tr.insertText(y,e,t)}})}function Lo(p){return new P({find:p.find,handler:({state:a,range:u,match:f})=>{const y=I(p.getAttributes,void 0,f)||{},e=a.tr.delete(u.from,u.to),n=e.doc.resolve(u.from).blockRange(),o=n&&(0,T.nd)(n,p.type,y);if(!o)return null;e.wrap(n,o);const s=e.doc.resolve(u.from-1).nodeBefore;s&&s.type===p.type&&(0,T.Mn)(e.doc,u.from-1)&&(!p.joinPredicate||p.joinPredicate(f,s))&&e.join(u.from-1)}})}class Ze{constructor(a={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=wt(wt({},this.config),a),this.name=this.config.name,a.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=I(St(this,"addOptions",{name:this.name}))),this.storage=I(St(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(a={}){return new Ze(a)}configure(a={}){const u=this.extend();return u.options=Ft(this.options,a),u.storage=I(St(u,"addStorage",{name:u.name,options:u.options})),u}extend(a={}){const u=new Ze(a);return u.parent=this,this.child=u,u.name=a.name?a.name:u.parent.name,a.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${u.name}".`),u.options=I(St(u,"addOptions",{name:u.name})),u.storage=I(St(u,"addStorage",{name:u.name,options:u.options})),u}static handleExit({editor:a,mark:u}){const{tr:f}=a.state,y=a.state.selection.$from;if(y.pos===y.end()){const t=y.marks();if(!t.find(s=>(null==s?void 0:s.type.name)===u.name))return!1;const o=t.find(s=>(null==s?void 0:s.type.name)===u.name);return o&&f.removeStoredMark(o),f.insertText(" ",y.pos),a.view.dispatch(f),!0}return!1}}class vn{constructor(a={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=wt(wt({},this.config),a),this.name=this.config.name,a.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=I(St(this,"addOptions",{name:this.name}))),this.storage=I(St(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(a={}){return new vn(a)}configure(a={}){const u=this.extend();return u.options=Ft(this.options,a),u.storage=I(St(u,"addStorage",{name:u.name,options:u.options})),u}extend(a={}){const u=new vn(a);return u.parent=this,this.child=u,u.name=a.name?a.name:u.parent.name,a.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${u.name}".`),u.options=I(St(u,"addOptions",{name:u.name})),u.storage=I(St(u,"addStorage",{name:u.name,options:u.options})),u}}class Fo{constructor(a,u,f){this.isDragging=!1,this.component=a,this.editor=u.editor,this.options=wt({stopEvent:null,ignoreMutation:null},f),this.extension=u.extension,this.node=u.node,this.decorations=u.decorations,this.getPos=u.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(a){var u,f,y,e,t,n,o;const{view:s}=this.editor,l=a.target,h=3===l.nodeType?null===(u=l.parentElement)||void 0===u?void 0:u.closest("[data-drag-handle]"):l.closest("[data-drag-handle]");if(!this.dom||(null===(f=this.contentDOM)||void 0===f?void 0:f.contains(l))||!h)return;let _=0,E=0;if(this.dom!==h){const Y=this.dom.getBoundingClientRect(),st=h.getBoundingClientRect(),mt=null!==(y=a.offsetX)&&void 0!==y?y:null===(e=a.nativeEvent)||void 0===e?void 0:e.offsetX,At=null!==(t=a.offsetY)&&void 0!==t?t:null===(n=a.nativeEvent)||void 0===n?void 0:n.offsetY;_=st.x-Y.x+mt,E=st.y-Y.y+At}null===(o=a.dataTransfer)||void 0===o||o.setDragImage(this.dom,_,E);const R=C.qv.create(s.state.doc,this.getPos()),L=s.state.tr.setSelection(R);s.dispatch(L)}stopEvent(a){var u;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:a});const f=a.target;if(!this.dom.contains(f)||(null===(u=this.contentDOM)||void 0===u?void 0:u.contains(f)))return!1;const e="drop"===a.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(f.tagName)||f.isContentEditable)&&!e)return!0;const{isEditable:n}=this.editor,{isDragging:o}=this,s=!!this.node.type.spec.draggable,l=C.qv.isSelectable(this.node),h="copy"===a.type,_="paste"===a.type,E="cut"===a.type,R="mousedown"===a.type,L=a.type.startsWith("drag");if(!s&&l&&L&&a.preventDefault(),s&&L&&!o)return a.preventDefault(),!1;if(s&&n&&!o&&R){const Y=f.closest("[data-drag-handle]");Y&&(this.dom===Y||this.dom.contains(Y))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(o||e||h||_||E||R&&l)}ignoreMutation(a){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:a}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===a.type||this.dom.contains(a.target)&&"childList"===a.type&&ke()&&this.editor.isFocused&&[...Array.from(a.addedNodes),...Array.from(a.removedNodes)].every(f=>f.isContentEditable)||(this.contentDOM!==a.target||"attributes"!==a.type)&&this.contentDOM.contains(a.target))))}updateAttributes(a){this.editor.commands.command(({tr:u})=>{const f=this.getPos();return u.setNodeMarkup(f,void 0,wt(wt({},this.node.attrs),a)),!0})}deleteNode(){const a=this.getPos();this.editor.commands.deleteRange({from:a,to:a+this.node.nodeSize})}}function Wo(p){return new A({find:p.find,handler:({state:a,range:u,match:f})=>{const y=I(p.getAttributes,void 0,f);if(!1===y||null===y)return null;const{tr:e}=a,t=f[f.length-1],n=f[0];let o=u.to;if(t){const s=n.search(/\S/),l=u.from+n.indexOf(t),h=l+t.length;if(Tn(u.from,u.to,a.doc).filter(E=>E.mark.type.excluded.find(L=>L===p.type&&L!==E.mark.type)).filter(E=>E.to>l).length)return null;h<u.to&&e.delete(h,u.to),l>u.from&&e.delete(u.from+s,l),o=u.from+s+t.length,e.addMark(u.from+s,o,p.type.create(y||{})),e.removeStoredMark(p.type)}}})}function zo(p){return p.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function wo(p){return new A({find:p.find,handler({match:a,chain:u,range:f}){const y=I(p.getAttributes,void 0,a);if(!1===y||null===y)return null;a.input&&u().deleteRange(f).insertContentAt(f.from,{type:p.type.name,attrs:y})}})}function jn(p){return new A({find:p.find,handler:({state:a,range:u,match:f})=>{let y=p.replace,e=u.from;const t=u.to;if(f[1]){const n=f[0].lastIndexOf(f[1]);y+=f[0].slice(n+f[1].length),e+=n;const o=e-t;o>0&&(y=f[0].slice(n-o,n)+y,e=t)}a.tr.insertText(y,e,t)}})}class Qn{constructor(a){this.transaction=a,this.currentStep=this.transaction.steps.length}map(a){let u=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((y,e)=>{const t=e.getMap().mapResult(y);return t.deleted&&(u=!0),t.pos},a),deleted:u}}}},74634:(It,pt,c)=>{c.r(pt),c.d(pt,{TextStyle:()=>i,default:()=>i});var C=c(40256);const i=C.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:w=>!!w.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:w}){return["span",(0,C.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:w,commands:x})=>{const T=(0,C.getMarkAttributes)(w,this.type);return!!Object.entries(T).some(([,D])=>!!D)||x.unsetMark(this.name)}}}})},97019:(It,pt,c)=>{c.d(pt,{h:()=>Ct});var C=c(64762),i=c(74788),w=c(36692),x=c(50170),T=c(1414),Q=c(10200),D=c(33250),G=c(68874),$=c(23738),ct=c(52219),X=c(12057),gt=c(65009),ot=c(10383),dt=c(20933),Mt=c(35065),vt=c(63060),Tt=c(62733),Z=c(48214),U=c(11189),V=c(91030);function H(lt,Ot){if(1&lt&&(i.TgZ(0,"button",6),i._uU(1),i.qZA()),2&lt){const Pt=Ot.$implicit;i.Q6J("value",Pt),i.xp6(1),i.hij(" ",Pt," ")}}function ht(lt,Ot){if(1&lt&&(i.TgZ(0,"tui-data-list"),i.YNc(1,H,2,2,"button",5),i.qZA()),2&lt){const Pt=i.oxw();i.xp6(1),i.Q6J("ngForOf",Pt.modes)}}function at(lt,Ot){if(1&lt){const Pt=i.EpF();i.TgZ(0,"tui-primitive-textfield",7),i.NdJ("valueChange",function(tt){return i.CHM(Pt),i.oxw().onHexChange(tt)}),i._UZ(1,"input",8),i.qZA()}if(2&lt){const Pt=i.oxw();i.Q6J("textMask",Pt.hexMask)("tuiTextfieldLabelOutside",!0)("value",Pt.hex)}}function ft(lt,Ot){if(1&lt){const Pt=i.EpF();i.TgZ(0,"tui-input-count",9),i.NdJ("ngModelChange",function(tt){i.CHM(Pt);const b=i.oxw();return b.onRgbChange(tt,b.color[1],b.color[2],b.color[3])}),i.qZA(),i.TgZ(1,"tui-input-count",9),i.NdJ("ngModelChange",function(tt){i.CHM(Pt);const b=i.oxw();return b.onRgbChange(b.color[0],tt,b.color[2],b.color[3])}),i.qZA(),i.TgZ(2,"tui-input-count",9),i.NdJ("ngModelChange",function(tt){i.CHM(Pt);const b=i.oxw();return b.onRgbChange(b.color[0],b.color[1],tt,b.color[3])}),i.qZA()}if(2&lt){const Pt=i.oxw();i.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Pt.color[0]),i.xp6(1),i.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Pt.color[1]),i.xp6(1),i.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Pt.color[2])}}class Ct{constructor(){this.color=[0,0,0,1],this.colorChange=new i.vpe,this.hexMask={mask:({length:Ot})=>Array.from({length:Ot},()=>/\d|[a-f]|[A-F]/),guide:!1},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return(0,w.tuiRgbToHex)(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(Ot){if(6!==Ot.length)return;const Pt=(0,w.tuiHexToRgb)(Ot);this.updateColor([Pt[0],Pt[1],Pt[2],this.color[3]])}onRgbChange(...Ot){this.updateColor(Ot)}updateColor(Ot){this.color=Ot,this.colorChange.emit(Ot)}}Ct.\u0275fac=function(Ot){return new(Ot||Ct)},Ct.\u0275cmp=i.Xpm({type:Ct,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:6,vars:8,consts:[["tuiTextfieldSize","m","tuiDropdownAlign","left","tuiDropdownLimitWidth","min",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],[4,"tuiDataList"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["postfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"],["size","xs","tuiOption","",3,"value",4,"ngFor","ngForOf"],["size","xs","tuiOption","",3,"value"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange"],["tuiTextfield","","maxlength","6"],["tuiTextfieldSize","m",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"]],template:function(Ot,Pt){if(1&Ot&&(i.TgZ(0,"tui-select",0),i.NdJ("ngModelChange",function(tt){return Pt.mode=tt}),i.YNc(1,ht,2,1,"tui-data-list",1),i.qZA(),i.YNc(2,at,2,3,"tui-primitive-textfield",2),i.YNc(3,ft,3,12,"ng-template",null,3,i.W1O),i.TgZ(5,"tui-input-count",4),i.NdJ("ngModelChange",function(tt){return Pt.onRgbChange(Pt.color[0],Pt.color[1],Pt.color[2],tt/100)}),i.qZA()),2&Ot){const Bt=i.MAs(4);i.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",Pt.mode),i.xp6(2),i.Q6J("ngIf",Pt.isHex)("ngIfElse",Bt),i.xp6(3),i.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",100)("ngModel",Pt.opacity)}},directives:[x.u,T.O,Q.s,D.Ek,G.x,$.JJ,$.On,ct.g,X.O5,gt.E,ot.a,dt.q,X.sg,Mt.v,vt.y,Tt.B,Z.n,U.h,V.M],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:4.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}"],changeDetection:0}),(0,C.gn)([(0,w.tuiDefaultProp)()],Ct.prototype,"color",void 0)},49289:(It,pt,c)=>{c.d(pt,{$:()=>D});var C=c(64762),i=c(74788),w=c(91211),x=c(36692),T=c(71424),Q=c(65720);class D{constructor($){this.sanitizer=$,this.colorChange=new i.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color($){if(this.currentColor.every((ot,dt)=>ot===$[dt])&&$[3]===this.opacity)return;const[ct,X,gt]=(0,x.tuiRgbToHsv)($[0],$[1],$[2]);this.opacity=$[3],this.hue=ct/360,this.point=[X,1-gt/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${(0,x.tuiHsvToRgb)(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange($){this.point=$,this.updateColor()}onHueChange($){this.hue=$,this.updateColor()}onOpacityChange($){this.opacity=(0,x.tuiRound)($,2),this.updateColor()}getCurrentColor($,ct){return(0,x.tuiHsvToRgb)(360*$,ct[0],255*(1-ct[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}D.\u0275fac=function($){return new($||D)(i.Y36(w.H7))},D.\u0275cmp=i.Xpm({type:D,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function($,ct){1&$&&(i.TgZ(0,"tui-flat-picker",0),i.NdJ("valueChange",function(gt){return ct.onPointChange(gt)}),i.qZA(),i.TgZ(1,"div",1),i.TgZ(2,"tui-linear-picker",2),i.NdJ("valueChange",function(gt){return ct.onHueChange(gt)}),i.qZA(),i.qZA(),i.TgZ(3,"div",3),i.TgZ(4,"tui-linear-picker",4),i.NdJ("valueChange",function(gt){return ct.onOpacityChange(gt)}),i.qZA(),i.qZA()),2&$&&(i.Udp("background-color",ct.base),i.Q6J("value",ct.point),i.xp6(2),i.Q6J("value",ct.hue),i.xp6(1),i.Udp("background",ct.gradient),i.xp6(1),i.Q6J("value",ct.opacity))},directives:[T.J,Q.P],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(rgba(0,0,0,0),#000000),linear-gradient(to right,#ffffff,rgba(255,255,255,0));margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:#ff0000}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],D.prototype,"color",null),(0,C.gn)([x.tuiPure],D.prototype,"getCurrentColor",null)},23999:(It,pt,c)=>{c.d(pt,{s:()=>ut});var C=c(64762),i=c(74788),w=c(91211),x=c(62842),T=c(37631),Q=c(36692),D=c(62939),G=c(76189),$=c(12057),ct=c(49289),X=c(34880),gt=c(20933),ot=c(35065),dt=c(49472),Mt=c(67446),vt=c(29070),Tt=c(54255),Z=c(15491),U=c(219),V=c(97019),H=c(39607),ht=c(5451);function at(B,z){if(1&B&&i._UZ(0,"tui-svg",9),2&B){i.oxw();const q=i.MAs(1);i.ekj("t-arrow_rotated",q.open)}}function ft(B,z){1&B&&i._UZ(0,"tui-svg",14)}function Ct(B,z){if(1&B){const q=i.EpF();i.TgZ(0,"button",12),i.NdJ("keydown.enter.prevent",function(){const Rt=i.CHM(q).$implicit,$t=i.oxw(2),Zt=i.MAs(1);return $t.onModeSelect(Rt,Zt)})("keydown.space.prevent",function(){const Rt=i.CHM(q).$implicit,$t=i.oxw(2),Zt=i.MAs(1);return $t.onModeSelect(Rt,Zt)})("click",function(){const Rt=i.CHM(q).$implicit,$t=i.oxw(2),Zt=i.MAs(1);return $t.onModeSelect(Rt,Zt)}),i._uU(1),i.YNc(2,ft,1,0,"tui-svg",13),i.qZA()}if(2&B){const q=z.$implicit,xt=i.oxw(2);i.uIk("aria-checked",xt.isModeActive(q)),i.xp6(1),i.hij(" ",q," "),i.xp6(1),i.Q6J("ngIf",xt.isModeActive(q))}}function lt(B,z){if(1&B&&(i.TgZ(0,"tui-data-list",10),i.YNc(1,Ct,3,3,"button",11),i.qZA()),2&B){const q=i.oxw();i.xp6(1),i.Q6J("ngForOf",q.modes)}}function Ot(B,z){if(1&B){const q=i.EpF();i.TgZ(0,"button",20),i.NdJ("click",function(){const Rt=i.CHM(q).$implicit;return i.oxw(2).onDirectionChange(Rt)}),i.qZA()}if(2&B){const q=z.$implicit,xt=i.oxw(2);i.ekj("t-direction_active",xt.isDirectionActive(q)),i.Q6J("icon",xt.getIcon(q))("tuiHint",q)("tuiHintDescribe","")}}function Pt(B,z){if(1&B){const q=i.EpF();i.ynx(0),i._UZ(1,"hr",15),i.TgZ(2,"div",16),i.TgZ(3,"tui-linear-multi-picker",17),i.NdJ("valueChange",function(kt){return i.CHM(q),i.oxw().onStopsChange(kt)})("indexChange",function(kt){return i.CHM(q),i.oxw().onIndexChange(kt)}),i.qZA(),i.qZA(),i.TgZ(4,"div",18),i.YNc(5,Ot,1,5,"button",19),i.qZA(),i.BQk()}if(2&B){const q=i.oxw();i.xp6(2),i.Udp("background",q.gradient),i.xp6(1),i.Q6J("value",q.stopsKeys),i.xp6(2),i.Q6J("ngForOf",q.buttons)}}function Bt(B,z){if(1&B){const q=i.EpF();i.TgZ(0,"tui-color-edit",21),i.NdJ("colorChange",function(kt){return i.CHM(q),i.oxw().onColorChange(kt)}),i.qZA()}if(2&B){const q=i.oxw();i.Q6J("color",q.color)}}function tt(B,z){if(1&B){const q=i.EpF();i.TgZ(0,"tui-palette",22),i.NdJ("selectedColor",function(kt){return i.CHM(q),i.oxw().onPalettePick(kt)}),i.qZA()}if(2&B){const q=i.oxw();i.Q6J("colors",q.palette)}}const b=[0,0,0,0],F=[[0,[0,0,0,1]],[1,[255,255,255,1]]],J={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};class ut{constructor(z,q){this.sanitizer=z,this.modes=q,this.stops=new Map(F),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new i.vpe,this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(z){this.parse(z)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(z){return J[z]}isModeActive(z){return this.currentMode===z}isDirectionActive(z){return this.direction===z}onPalettePick(z){this.updateColor(z)}onDirectionChange(z){this.direction=z,this.updateColor(this.getGradient(z))}onModeSelect(z,q){this.currentMode=z,q.open=!1,this.updateColor(z===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(z){this.currentStop=this.stopsKeys[z]}onColorChange(z){this.isGradient?(this.stops.set(this.currentStop,z),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${z.join(", ")})`)}onStopsChange(z){const q=this.stopsKeys.find(kt=>!z.includes(kt)),xt=z.find(kt=>!this.stopsKeys.includes(kt));void 0===q&&void 0!==xt&&this.addStop(xt),void 0!==q&&void 0===xt&&this.removeStop(q),void 0!==q&&void 0!==xt&&this.replaceStop(q,xt),this.updateColor(this.getGradient(this.direction))}getStopsKeys(z){return Array.from(z.keys())}filterPalette(z,q){const xt=new Map(z);return xt.forEach((kt,Rt)=>{(kt.startsWith("linear-gradient")&&!q||!kt.startsWith("linear-gradient")&&q)&&xt.delete(Rt)}),xt}updateColor(z){this.colorChange.emit(z)}getGradient(z){return`linear-gradient(${z}, ${[...this.stopsKeys].sort().map(q=>`rgba(${this.getStop(q).join(", ")}) ${100*q}%`).join(", ")})`}getStop(z){return this.stops.get(z)||b}addStop(z){const q=this.stopsKeys.reduce((xt,kt)=>Math.abs(kt-z)<Math.abs(xt-z)?kt:xt,this.stopsKeys[0]);this.stops.set(z,this.getStop(q)),this.stops=new Map(this.stops),this.currentStop=z}removeStop(z){this.stops.delete(z),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(z,q){const xt=this.getStop(z);this.currentStop=q,this.stops=new Map(this.stopsKeys.map(kt=>kt===z?[q,xt]:[kt,this.getStop(kt)]))}parse(z){z.startsWith("linear-gradient")?this.parseGradient(z):this.parseColor(z)}parseGradient(z){if(z===this.getGradient(this.direction))return;const q=(0,T._N)((0,T.U5)(z));this.currentMode=this.modes[1],this.direction=q.side,this.currentStop=0,this.stops=new Map(q.stops.length?q.stops.map(({color:xt,position:kt})=>[parseFloat(kt)/100,(0,Q.tuiParseColor)(xt)]):F)}parseColor(z){this.currentMode=this.modes[0],this.currentStop=0,this.color=(0,Q.tuiParseColor)(z)}}ut.\u0275fac=function(z){return new(z||ut)(i.Y36(w.H7),i.Y36(x.dj))},ut.\u0275cmp=i.Xpm({type:ut,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["tuiButton","","appearance","","size","s","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],["src","tuiIconChevronDown",1,"t-arrow"],["role","menu",1,"t-menu"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click",4,"ngFor","ngForOf"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click"],["src","tuiIconCheck","class","t-checkmark",4,"ngIf"],["src","tuiIconCheck",1,"t-checkmark"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","valueChange","indexChange"],[1,"t-buttons"],["tuiIconButton","","type","button","size","xs","appearance","","class","t-direction",3,"t-direction_active","icon","tuiHint","tuiHintDescribe","click",4,"ngFor","ngForOf"],["tuiIconButton","","type","button","size","xs","appearance","",1,"t-direction",3,"icon","tuiHint","tuiHintDescribe","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(z,q){if(1&z&&(i.TgZ(0,"tui-hosted-dropdown",0,1),i.TgZ(2,"button",2),i._uU(3),i.qZA(),i.YNc(4,at,1,2,"ng-template",null,3,i.W1O),i.YNc(6,lt,2,1,"ng-template",null,4,i.W1O),i.qZA(),i.YNc(8,Pt,6,4,"ng-container",5),i.TgZ(9,"tui-color-picker",6),i.NdJ("colorChange",function(kt){return q.onColorChange(kt)}),i.qZA(),i.YNc(10,Bt,1,1,"tui-color-edit",7),i.YNc(11,tt,1,1,"tui-palette",8)),2&z){const xt=i.MAs(5),kt=i.MAs(7);i.Q6J("content",kt),i.xp6(2),i.Q6J("iconRight",xt),i.xp6(1),i.hij(" ",q.currentMode," "),i.xp6(5),i.Q6J("ngIf",q.isGradient),i.xp6(1),i.Q6J("color",q.currentColor),i.xp6(1),i.Q6J("ngIf",!q.isGradient),i.xp6(1),i.Q6J("ngIf",q.palette.size)}},directives:[D.o,G.v,$.O5,ct.$,X.P,gt.q,$.sg,ot.v,dt.e,Mt.D,vt.x,Tt.t,Z.D,U.$,V.h,H.g,ht.R],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:21.25rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,C.gn)([(0,Q.tuiDefaultProp)()],ut.prototype,"colors",void 0),(0,C.gn)([(0,Q.tuiRequiredSetter)()],ut.prototype,"colorSetter",null),(0,C.gn)([Q.tuiPure],ut.prototype,"getStopsKeys",null),(0,C.gn)([Q.tuiPure],ut.prototype,"filterPalette",null)},71424:(It,pt,c)=>{c.d(pt,{J:()=>T});var C=c(64762),i=c(74788),w=c(62141),x=c(36692);class T{constructor(D){this.value=[0,0],this.valueChange=new i.vpe,D.subscribe(G=>{this.value=G,this.valueChange.emit([G[0],G[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}T.\u0275fac=function(D){return new(D||T)(i.Y36(w.i))},T.\u0275cmp=i.Xpm({type:T,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[i._Bn([x.TuiDestroyService,w.i])],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(D,G){1&D&&i._UZ(0,"div",0),2&D&&i.Udp("left",G.left,"%")("top",G.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],T.prototype,"value",void 0)},27050:(It,pt,c)=>{c.d(pt,{hR:()=>C.h,TD:()=>D,$v:()=>G.$,H9:()=>X,sV:()=>gt.s,wl:()=>vt,Jd:()=>Tt.J,ui:()=>$,es:()=>Z.e,GU:()=>dt,P:()=>U.P,g7:()=>ct,Rh:()=>V.R,VM:()=>Mt});var C=c(97019),i=c(12057),w=c(23738),x=c(72002),T=c(31748),Q=c(74788);let D=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez,w.u5,T.TextMaskModule,T.TuiValueAccessorModule,T.TuiSelectModule,x.TuiPrimitiveTextfieldModule,x.TuiTextfieldControllerModule,x.TuiDropdownModule,T.TuiInputCountModule,x.TuiDataListModule]]}),H})();var G=c(49289);let $=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez]]}),H})(),ct=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez]]}),H})(),X=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez,$,ct]]}),H})();var gt=c(23999),ot=c(36692);let dt=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez]]}),H})(),Mt=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez,x.TuiHintModule]]}),H})(),vt=(()=>{class H{}return H.\u0275fac=function(at){return new(at||H)},H.\u0275mod=Q.oAB({type:H}),H.\u0275inj=Q.cJS({imports:[[i.ez,x.TuiButtonModule,x.TuiHostedDropdownModule,X,dt,x.TuiHintModule,x.TuiSvgModule,x.TuiDataListModule,ot.TuiActiveZoneModule,D,x.TuiGroupModule,Mt]]}),H})();var Tt=c(71424),Z=c(49472),U=c(65720),V=c(5451)},49472:(It,pt,c)=>{c.d(pt,{e:()=>D});var C=c(64762),i=c(74788),w=c(62141),x=c(36692),T=c(12057);function Q(G,$){if(1&G){const ct=i.EpF();i.TgZ(0,"div",1),i.NdJ("mousedown",function(){const ot=i.CHM(ct).index;return i.oxw().onMouseDown(ot)})("dblclick",function(){const ot=i.CHM(ct).index;return i.oxw().onClick(ot)}),i.qZA()}2&G&&i.Udp("left",100*$.$implicit,"%")}class D{constructor($){this.value=[0,1],this.valueChange=new i.vpe,this.indexChange=new i.vpe,this.index=NaN,$.subscribe(([ct])=>{this.onPicker(ct)})}onMouseUp(){this.index=NaN}onMouseDown($){this.updateIndex($)}onClick($){this.value.length>2&&this.updateValue(this.value.filter((ct,X)=>X!==$))}onPicker($){isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((ct,X)=>ct===$&&X!==this.index)&&this.updateValue(this.value.map((ct,X)=>X===this.index?$:ct))}updateIndex($){this.index=$,this.indexChange.emit($)}updateValue($){this.value=$,this.valueChange.emit($)}}D.\u0275fac=function($){return new($||D)(i.Y36(w.i))},D.\u0275cmp=i.Xpm({type:D,selectors:[["tui-linear-multi-picker"]],hostBindings:function($,ct){1&$&&i.NdJ("mouseup",function(){return ct.onMouseUp()},!1,i.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},features:[i._Bn([x.TuiDestroyService,w.i])],decls:1,vars:1,consts:[["class","t-circle",3,"left","mousedown","dblclick",4,"ngFor","ngForOf"],[1,"t-circle",3,"mousedown","dblclick"]],template:function($,ct){1&$&&i.YNc(0,Q,1,2,"div",0),2&$&&i.Q6J("ngForOf",ct.value)},directives:[T.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],D.prototype,"value",void 0)},65720:(It,pt,c)=>{c.d(pt,{P:()=>T});var C=c(64762),i=c(74788),w=c(62141),x=c(36692);class T{constructor(D){this.value=0,this.valueChange=new i.vpe,D.subscribe(([G])=>{this.value=G,this.valueChange.emit(G)})}get left(){return 100*this.value}}T.\u0275fac=function(D){return new(D||T)(i.Y36(w.i))},T.\u0275cmp=i.Xpm({type:T,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[i._Bn([x.TuiDestroyService,w.i])],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(D,G){1&D&&i._UZ(0,"div",0),2&D&&i.Udp("left",G.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],T.prototype,"value",void 0)},5451:(It,pt,c)=>{c.d(pt,{R:()=>X});var C=c(64762),i=c(74788),w=c(36692),x=c(12057),T=c(67446),Q=c(29070),D=c(54255),G=c(15491),$=c(219);function ct(gt,ot){if(1&gt){const dt=i.EpF();i.TgZ(0,"button",1),i.NdJ("click",function(){const Tt=i.CHM(dt).$implicit;return i.oxw().selectedColor.emit(Tt.value)}),i.qZA()}if(2&gt){const dt=ot.$implicit;i.Udp("background",dt.value),i.Q6J("tuiHint",dt.key)("tuiHintDescribe",dt.key)("id",dt.key)}}class X{constructor(){this.colors=new Map,this.selectedColor=new i.vpe}}X.\u0275fac=function(ot){return new(ot||X)},X.\u0275cmp=i.Xpm({type:X,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:3,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintDescribe","id","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintDescribe","id","click"]],template:function(ot,dt){1&ot&&(i.YNc(0,ct,1,5,"button",0),i.ALo(1,"keyvalue")),2&ot&&i.Q6J("ngForOf",i.lcZ(1,1,dt.colors))},directives:[x.sg,T.D,Q.x,D.t,G.D,$.$],pipes:[x.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),(0,C.gn)([(0,w.tuiDefaultProp)()],X.prototype,"colors",void 0)},45050:(It,pt,c)=>{c.d(pt,{l:()=>Mt});var C=c(12057),i=c(74788),w=c(36692),x=c(87623),T=c(20986),Q=c(23738),D=c(34880),G=c(76189),$=c(66596);function ct(vt,Tt){if(1&vt){const Z=i.EpF();i.ynx(0),i.TgZ(1,"label",2),i._uU(2," URL "),i.TgZ(3,"span",3),i._uU(4),i.TgZ(5,"tui-input-inline",4),i.NdJ("ngModelChange",function(V){return i.CHM(Z),i.oxw().onChange(V)})("keydown.prevent.enter",function(){return i.CHM(Z),i.oxw().onSave()})("keydown.backspace",function(){return i.CHM(Z),i.oxw().onBackspace()}),i._uU(6," example.com "),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"tui-svg",5),i.NdJ("click",function(){return i.CHM(Z),i.oxw().onClear()}),i.qZA(),i.TgZ(8,"button",6),i.NdJ("click",function(){return i.CHM(Z),i.oxw().onSave()}),i.qZA(),i.BQk()}if(2&vt){const Z=i.oxw();i.xp6(4),i.hij(" ",Z.prefix," "),i.xp6(1),i.ekj("t-input_filled",Z.hasUrl),i.Q6J("ngModel",Z.url),i.xp6(2),i.ekj("t-cleaner_hidden",!Z.hasUrl)}}function X(vt,Tt){if(1&vt){const Z=i.EpF();i.TgZ(0,"a",7),i._uU(1),i.qZA(),i.TgZ(2,"button",8),i.NdJ("click",function(){return i.CHM(Z),i.oxw().onEdit()}),i.qZA(),i.TgZ(3,"button",9),i.NdJ("click",function(){return i.CHM(Z),i.oxw().onRemove()}),i.qZA()}if(2&vt){const Z=i.oxw();i.Q6J("href",Z.href,i.LSH),i.xp6(1),i.hij(" ",Z.shortUrl," ")}}let Mt=(()=>{class vt{constructor(Z){this.documentRef=Z,this.addLink=new i.vpe,this.removeLink=new i.vpe,this.url=this.makeUrl(),this.edit=!this.url,this.prefix="http://"}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get shortUrl(){return this.url.length<60?this.url:`${this.url.slice(0,Math.max(0,40))}...${this.url.slice(this.url.length-10)}`}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.makeUrl())}onMouseDown(Z){(0,w.tuiIsElement)(Z.target)&&!Z.target.matches("a, button, input")&&Z.preventDefault()}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix="http://")}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange(Z){this.url=this.removePrefix(Z)}onClear(){this.url=""}makeUrl(){const Z=this.documentRef.getSelection();return Z?this.getHref(Z):""}getHref({focusNode:Z}){if(!(null==Z?void 0:Z.parentElement))return"";const U=Z.parentElement.closest("a");return U?this.removePrefix(U.getAttribute("href")||""):this.url}removePrefix(Z){return Z.startsWith("http://")?(this.prefix="http://",Z.replace("http://","")):Z.startsWith("https://")?(this.prefix="https://",Z.replace("https://","")):Z}}return vt.\u0275fac=function(Z){return new(Z||vt)(i.Y36(C.K0))},vt.\u0275cmp=i.Xpm({type:vt,selectors:[["tui-edit-link"]],hostBindings:function(Z,U){1&Z&&i.NdJ("selectionchange",function(){return U.onSelectionChange()},!1,i.evT)("mousedown",function(H){return U.onMouseDown(H)})},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["view",""],[1,"t-label"],[1,"t-url"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","keydown.prevent.enter","keydown.backspace"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiLink","","target","_blank",1,"t-link",3,"href"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEditLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconTrashLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"]],template:function(Z,U){if(1&Z&&(i.YNc(0,ct,9,6,"ng-container",0),i.YNc(1,X,4,2,"ng-template",null,1,i.W1O)),2&Z){const V=i.MAs(2);i.Q6J("ngIf",U.edit)("ngIfElse",V)}},directives:[C.O5,x.l,T.k,Q.JJ,Q.On,D.P,G.v,$.V],styles:["[_nghost-%COMP%]{display:flex;height:var(--tui-height-l);align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02)}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),vt})()},71115:(It,pt,c)=>{c.d(pt,{l:()=>C.l,F:()=>G});var C=c(45050),i=c(12057),w=c(23738),x=c(36692),T=c(72002),Q=c(31748),D=c(74788);let G=(()=>{class ${}return $.\u0275fac=function(X){return new(X||$)},$.\u0275mod=D.oAB({type:$}),$.\u0275inj=D.cJS({imports:[[i.ez,w.u5,x.TuiAutoFocusModule,T.TuiButtonModule,T.TuiSvgModule,T.TuiLinkModule,Q.TuiInputInlineModule]]}),$})()},20179:(It,pt,c)=>{c.d(pt,{D:()=>w});var C=c(74788),i=c(72002);let w=(()=>{class x{constructor(Q,D,G,$){this.elementRef=Q,this.renderer=D,this.sanitizer=G,this.tuiSanitizer=$}set content(Q){this.renderer.setProperty(this.elementRef.nativeElement,"innerHTML",this.tuiSanitizer?this.tuiSanitizer.sanitize(C.q3G.HTML,Q.replace(/colwidth/g,"width")):this.sanitizer.sanitize(C.q3G.HTML,Q))}}return x.\u0275fac=function(Q){return new(Q||x)(C.Y36(C.SBq),C.Y36(C.Qsj),C.Y36(C.Tiy),C.Y36(i.TUI_SANITIZER,8))},x.\u0275cmp=C.Xpm({type:x,selectors:[["tui-editor-socket"]],hostAttrs:[1,"tui-editor-socket"],inputs:{content:"content"},decls:0,vars:0,template:function(Q,D){},styles:['.tui-editor-socket{display:block;margin:0;overflow:hidden;color:var(--tui-text-01);font:var(--tui-font-text-m)}.tui-editor-socket._preview-image img{cursor:pointer}.tui-editor-socket h1,.tui-editor-socket h2,.tui-editor-socket h3,.tui-editor-socket h4,.tui-editor-socket h5,.tui-editor-socket h6{word-break:break-word;line-height:normal}.tui-editor-socket .ProseMirror{min-height:5.375rem;padding:0 1rem;outline:none;white-space:pre-wrap}.tui-editor-socket p:empty:after{content:" ";white-space:pre}.tui-editor-socket p:first-child{margin-top:0}.tui-editor-socket ul,.tui-editor-socket ol{list-style-type:none;margin:1rem 1rem 1rem 1.5rem;padding:0}.tui-editor-socket li{margin:1rem 0}.tui-editor-socket li p{display:inline-block;margin:0 auto}.tui-editor-socket ul>li:before{content:"";display:inline-block;width:.5rem;height:.5rem;border-radius:100%;margin:.5rem .875rem .0625rem -1.375rem;background-color:var(--tui-primary);vertical-align:top;box-sizing:border-box}.tui-editor-socket li ul>li:before{background:none;border:.125rem solid var(--tui-primary)}.tui-editor-socket li ul>li>ul>li:before{background:var(--tui-primary);border-radius:0;width:.375rem;height:.375rem}.tui-editor-socket ol{counter-reset:counter}.tui-editor-socket ol>li:before{content:counter(counter) ".";width:1.5rem;margin:0 .75rem 0 -1.5rem;counter-increment:counter;color:var(--tui-base-05);vertical-align:top}.tui-editor-socket pre{white-space:pre-wrap;word-break:break-word;border-radius:.25rem;margin:1rem 0;padding:.75rem 1rem;font-family:Courier,monospace;color:var(--tui-text-02);background:var(--tui-base-02)}.tui-editor-socket code{box-shadow:none}.tui-editor-socket pre+pre{margin-top:-1.8125rem;padding-top:0}.tui-editor-socket blockquote{margin:1.25rem 0 1.25rem 1.5rem;padding-left:1.0625rem;border-left:1px solid var(--tui-base-04)}.tui-editor-socket p{margin:1rem 0}.tui-editor-socket a{color:var(--tui-link);text-decoration:none;outline:none}.tui-editor-socket a:hover{color:var(--tui-link-hover);text-decoration:underline}.tui-editor-socket a:active{color:var(--tui-primary-active)}.tui-editor-socket hr{border:none;border-top:1px solid var(--tui-base-03);margin:1rem 0}.tui-editor-socket table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.tui-editor-socket table td{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word}.tui-editor-socket table th{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word;font-weight:bold;text-align:left;background-color:var(--tui-base-02);min-height:2rem}.tui-editor-socket table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tui-editor-socket table td>*{margin-top:0;margin-bottom:0}.tui-editor-socket table th>*{margin-top:0;margin-bottom:0}.tui-editor-socket .resize-cursor{cursor:ew-resize;cursor:col-resize}.tui-editor-socket table .tableWrapper{overflow-x:auto}.tui-editor-socket .selectedCell:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--tui-selection);pointer-events:none}.tui-editor-socket font[face="Courier New"]{display:inline-block;padding:.25rem .5rem;border-radius:.25rem;background-color:#ecf1f7;word-break:break-word}.tui-editor-socket details{width:100%;border:1px solid var(--tui-base-04);border-radius:var(--tui-radius-l)}.tui-editor-socket summary{display:flex;align-items:center;min-height:3.5rem;width:100%;padding:0 1.25rem;box-sizing:border-box;border-radius:var(--tui-radius-l);pointer-events:none}.tui-editor-socket summary p{min-width:1px;margin:0}.tui-editor-socket summary::-webkit-details-marker{display:none}.tui-editor-socket details[open] summary{border-radius:var(--tui-radius-l) var(--tui-radius-l) 0 0}.tui-editor-socket div[data-type=details-content]{padding:1.25rem;min-height:3rem;border:1px solid var(--tui-base-04);border-width:1px 0 0}.tui-editor-socket .details-wrapper{position:relative;display:flex}.tui-editor-socket .details-arrow{position:absolute;top:1.5rem;right:1.25rem;height:.575rem;width:.575rem;border:1px solid var(--tui-base-06);border-width:0 2px 2px 0;transform:rotate(45deg);transition:var(--tui-duration, .3s);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;padding:0;background:none;cursor:pointer}.tui-editor-socket .details-wrapper_rendered .details-arrow{pointer-events:none}.tui-editor-socket .details-wrapper_rendered summary{transition:transform var(--tui-duration, .3s);cursor:pointer;pointer-events:auto}.tui-editor-socket .details-wrapper_rendered summary:hover{background:var(--tui-base-02)}.tui-editor-socket details[open]+.details-arrow{top:1.75rem;transform:rotate(225deg)}.t-editor-placeholder:before{content:attr(data-placeholder);float:left;color:var(--tui-base-05);pointer-events:none;height:0}.tui-group-node{display:flex;flex-direction:row}.tui-group-node:hover>.tui-group-pointer{pointer-events:auto;opacity:1}.tui-group-pointer{opacity:0;min-height:.8125rem;max-height:.8125rem;min-width:.8125rem;max-width:.8125rem;margin:.3125rem .3125rem 0 0;cursor:-webkit-grab;cursor:grab;background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="black" /></svg>\');background-repeat:no-repeat;background-size:contain;background-position:center}[data-mode=onDark] .tui-group-pointer{background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="white" /></svg>\')}\n'],encapsulation:2,changeDetection:0}),x})()},69303:(It,pt,c)=>{c.d(pt,{a:()=>ut});var C=c(64762),i=c(12057),w=c(74788),x=c(23738),T=c(17406),Q=c(19074),D=c(40632),G=c(62842),$=c(37631),ct=c(36692),X=c(79089),gt=c(40939),ot=c(2697),dt=c(17163),Mt=c(3881),vt=c(1433),Tt=c(9872),Z=c(4997),U=c(33250),V=c(26072),H=c(9829),ht=c(82886),at=c(39088),ft=c(20179),Ct=c(74982),lt=c(45050);function Ot(B,z){if(1&B&&(w.TgZ(0,"tui-toolbar",9),w.Hsn(1,1),w.qZA()),2&B){const q=w.oxw(2);w.Q6J("tools",q.tools)("disabled",!q.interactive)}}function Pt(B,z){if(1&B&&(w.TgZ(0,"div",10),w._uU(1),w.qZA()),2&B){const q=w.oxw(2);w.xp6(1),w.hij(" ",q.exampleText," ")}}function Bt(B,z){if(1&B){const q=w.EpF();w.TgZ(0,"div",11),w.TgZ(1,"tui-editor-socket",12),w.NdJ("valueChange",function(kt){return w.CHM(q),w.oxw(2).onModelChange(kt)})("stateChange",function(){return 0}),w.qZA(),w.qZA()}if(2&B){w.oxw();const q=w.MAs(9),xt=w.oxw();w.Q6J("tuiDropdownSelection",xt.dropdownSelectionHandler)("tuiDropdown",q),w.xp6(1),w.Q6J("value",xt.value)("editable",xt.interactive)}}function tt(B,z){if(1&B){const q=w.EpF();w.TgZ(0,"tui-edit-link",13),w.NdJ("addLink",function(kt){return w.CHM(q),w.oxw(2).addLink(kt)})("removeLink",function(){return w.CHM(q),w.oxw(2).removeLink()}),w.qZA()}}function b(B,z){if(1&B){const q=w.EpF();w.TgZ(0,"div",1),w.NdJ("tuiActiveZoneChange",function(kt){return w.CHM(q),w.oxw().onActiveZone(kt)}),w.TgZ(1,"div",2),w.YNc(2,Ot,2,2,"tui-toolbar",3),w.TgZ(3,"div",4),w.Hsn(4),w.qZA(),w.YNc(5,Pt,2,1,"div",5),w.qZA(),w.TgZ(6,"tui-scrollbar",6),w.YNc(7,Bt,2,4,"div",7),w.YNc(8,tt,1,0,"ng-template",null,8,w.W1O),w._UZ(10,"tui-editor-portal-host"),w.qZA(),w.qZA()}if(2&B){const q=z.tuiLet,xt=w.oxw();w.Q6J("readOnly",xt.readOnly)("disabled",xt.disabled)("focus",xt.computedFocused)("hover",xt.pseudoHover)("invalid",xt.computedInvalid),w.xp6(2),w.Q6J("ngIf",q),w.xp6(1),w.ekj("t-placeholder_raised",xt.placeholderRaised),w.xp6(2),w.Q6J("ngIf",xt.hasExampleText),w.xp6(2),w.Q6J("ngIf",q)}}const F=["*",[["tools"]]];class ut extends ct.AbstractTuiControl{constructor(z,q,xt,kt,Rt,$t){super(z,q),this.editorLoaded$=xt,this.editorService=kt,this.contentProcessor=Rt,this.documentRef=$t,this.exampleText="",this.tools=Q.Db,this.focused=!1,this.isSelectionLink=Zt=>this.currentFocusedNodeIsAnchor(Zt)&&(0,$.nC)(Zt)}get nativeFocusableElement(){var z;return this.computedDisabled?null:(null===(z=this.element)||void 0===z?void 0:z.nativeElement)||null}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:ct.ALWAYS_FALSE_HANDLER}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}writeValue(z){var q;const xt=this.contentProcessor(z||"");super.writeValue(xt),xt!==z&&(null===(q=this.control)||void 0===q||q.setValue(xt))}onActiveZone(z){this.focused=z,this.updateFocused(z)}onModelChange(z){this.updateValue(z)}addLink(z){var q,xt;null===(q=this.editor)||void 0===q||q.selectClosest(),null===(xt=this.editor)||void 0===xt||xt.setLink(z)}removeLink(){var z;null===(z=this.editor)||void 0===z||z.unsetLink()}ngOnDestroy(){var z;null===(z=this.editor)||void 0===z||z.destroy()}getFallbackValue(){return""}currentFocusedNodeIsAnchor(z){var q,xt,kt;return!!(null===(xt=null===(q=z.startContainer.parentElement)||void 0===q?void 0:q.closest("a"))||void 0===xt?void 0:xt.contains((null===(kt=this.documentRef.getSelection())||void 0===kt?void 0:kt.focusNode)||null))}get hasValue(){return!!this.value}}ut.\u0275fac=function(z){return new(z||ut)(w.Y36(x.a5,10),w.Y36(w.sBO),w.Y36(G.ZW),w.Y36(D.$3),w.Y36(G.F1),w.Y36(i.K0))},ut.\u0275cmp=w.Xpm({type:ut,selectors:[["tui-editor"]],viewQuery:function(z,q){if(1&z&&(w.Gf(D.JU,5,w.SBq),w.Gf(T.M6,5)),2&z){let xt;w.iGM(xt=w.CRH())&&(q.element=xt.first),w.iGM(xt=w.CRH())&&(q.toolbar=xt.first)}},inputs:{exampleText:"exampleText",tools:"tools"},features:[w._Bn([(0,ct.tuiAsFocusableItemAccessor)(ut),X.m]),w.qOj],ngContentSelectors:["*","tools"],decls:2,vars:3,consts:[["tuiWrapper","","appearance","textfield","class","t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange",4,"tuiLet"],["tuiWrapper","","appearance","textfield",1,"t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],[3,"tools","disabled",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","",1,"t-scrollbar"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown",4,"ngIf"],["dropdown",""],[3,"tools","disabled"],[1,"t-example-text"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown"],["tuiTiptapEditor","","spellcheck","false",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange"],[3,"addLink","removeLink"]],template:function(z,q){1&z&&(w.F$t(F),w.YNc(0,b,11,10,"div",0),w.ALo(1,"async")),2&z&&w.Q6J("tuiLet",w.lcZ(1,1,q.editorLoaded$))},directives:[gt.L,ot.o,dt.e,i.O5,Mt.I,vt.A,Tt.d,Z.M,U.Ek,V.t,H.V,ht.A,at.y,ft.D,Ct.J,lt.l],pipes:[i.Ov],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m);border-radius:var(--tui-radius-m)}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:10rem;cursor:text;overflow:hidden;flex-direction:column;border-radius:inherit}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);position:absolute;left:1rem;margin-top:1rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem)}[data-size=m][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}[data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], [data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size=l][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font-size:.9375rem}[data-size=l][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[data-mode=onDark][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size=m][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens: none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-placeholder_raised[_ngcontent-%COMP%]{width:110%}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;max-height:inherit;border-top:1.625rem solid transparent;border-bottom:1px solid transparent;box-sizing:border-box}"],changeDetection:0}),(0,C.gn)([(0,ct.tuiDefaultProp)()],ut.prototype,"exampleText",void 0),(0,C.gn)([(0,ct.tuiDefaultProp)()],ut.prototype,"tools",void 0)},79089:(It,pt,c)=>{c.d(pt,{m:()=>ct});var C=c(74788),i=c(40632),w=c(62842),x=c(82298),T=c(9112),Q=c(15257),D=c(88002),G=c(47349),$=c(73825);const ct=[{provide:w.F4,deps:[w.Wf],useFactory:X=>{const gt=new x.t(1);return Promise.all(X).then(ot=>gt.next(ot)),gt}},{provide:w.Y1,deps:[C.Qsj],useFactory:X=>X.createElement("div")},{provide:w.ZW,deps:[w.Y1,w.F4,w.bG],useFactory:(X,gt,ot)=>(0,T.aj)([ot,gt]).pipe((0,Q.q)(1),(0,D.U)(([dt,Mt])=>new dt({element:X,extensions:Mt})),(0,G.d)({bufferSize:1,refCount:!0}))},i.$3,$.Y]},9872:(It,pt,c)=>{c.d(pt,{d:()=>w});var C=c(36692),i=c(74788);let w=(()=>{class x extends C.AbstractTuiPortalHostComponent{}return x.\u0275fac=function(){let T;return function(D){return(T||(T=i.n5z(x)))(D||x)}}(),x.\u0275cmp=i.Xpm({type:x,selectors:[["tui-editor-portal-host"]],features:[i._Bn([{provide:C.AbstractTuiPortalService,useExisting:C.TuiDropdownPortalService},{provide:C.AbstractTuiPortalHostComponent,useExisting:x}]),i.qOj],decls:2,vars:0,consts:[["viewContainer",""]],template:function(Q,D){1&Q&&i.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),x})()},1433:(It,pt,c)=>{c.d(pt,{A:()=>x});var C=c(36692),i=c(73825),w=c(74788);let x=(()=>{class T{}return T.\u0275fac=function(D){return new(D||T)},T.\u0275dir=w.lG2({type:T,selectors:[["","tuiEditorPortal",""]],features:[w._Bn([{provide:C.TuiDropdownPortalService,useExisting:i.Y}])]}),T})()},73825:(It,pt,c)=>{c.d(pt,{Y:()=>w});var C=c(36692),i=c(74788);let w=(()=>{class x extends C.AbstractTuiPortalService{}return x.\u0275fac=function(){let T;return function(D){return(T||(T=i.n5z(x)))(D||x)}}(),x.\u0275prov=i.Yz7({token:x,factory:x.\u0275fac}),x})()},19769:(It,pt,c)=>{c.d(pt,{j:()=>Tt});var C=c(64762),i=c(74788),w=c(23738),x=c(91211),T=c(37631),Q=c(36692),D=c(72002),G=c(62939),$=c(63060),ct=c(62733),X=c(3729),gt=c(23999),ot=c(17163);function dt(Z,U){if(1&Z&&i._UZ(0,"div",4),2&Z){const V=i.oxw();i.Udp("background",V.background)}}function Mt(Z,U){if(1&Z){const V=i.EpF();i.TgZ(0,"tui-color-selector",5),i.NdJ("colorChange",function(ht){return i.CHM(V),i.oxw().onValueChange(ht)}),i.qZA()}if(2&Z){const V=U.$implicit,H=i.oxw();i.Q6J("tuiActiveZoneParent",V)("colors",H.colors)("color",H.value)}}class Tt extends Q.AbstractTuiControl{constructor(U,V,H){super(U,V),this.domSanitizer=H,this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onValueChange(U){this.updateValue(U)}onFocused(U){this.updateFocused(U)}getFallbackValue(){return"#000000"}sanitize(U,V){return U.startsWith("linear-gradient(")?V.bypassSecurityTrustStyle((0,T.CH)((0,T._N)((0,T.U5)(U)))):U}}Tt.\u0275fac=function(U){return new(U||Tt)(i.Y36(w.a5,10),i.Y36(i.sBO),i.Y36(x.H7))},Tt.\u0275cmp=i.Xpm({type:Tt,selectors:[["tui-input-color"]],viewQuery:function(U,V){if(1&U&&(i.Gf(D.TuiPrimitiveTextfieldComponent,5),i.Gf(D.TuiHostedDropdownComponent,5)),2&U){let H;i.iGM(H=i.CRH())&&(V.textfield=H.first),i.iGM(H=i.CRH())&&(V.dropdown=H.first)}},hostBindings:function(U,V){1&U&&i.NdJ("click",function(){return V.onClick()})},inputs:{colors:"colors"},features:[i._Bn([],[(0,D.tuiDropdownOptionsProvider)({maxHeight:600})]),i.qOj],ngContentSelectors:["*"],decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"tuiTextfieldIconLeft","pseudoFocus","pseudoHover","pseudoActive","invalid","focusable","nativeId","disabled","readOnly","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"tuiActiveZoneParent","colors","color","colorChange"]],template:function(U,V){if(1&U&&(i.F$t(),i.TgZ(0,"tui-hosted-dropdown",0),i.NdJ("openChange",function(ht){return V.open=ht}),i.TgZ(1,"tui-primitive-textfield",1),i.NdJ("valueChange",function(ht){return V.onValueChange(ht)})("focusedChange",function(ht){return V.onFocused(ht)}),i.Hsn(2),i.qZA(),i.qZA(),i.YNc(3,dt,1,2,"ng-template",null,2,i.W1O),i.YNc(5,Mt,1,3,"ng-template",null,3,i.W1O)),2&U){const H=i.MAs(4),ht=i.MAs(6);i.Q6J("content",ht)("open",V.open),i.xp6(1),i.Q6J("tuiTextfieldIconLeft",H)("pseudoFocus",V.computedFocused)("pseudoHover",V.pseudoHover)("pseudoActive",V.pseudoActive)("invalid",V.computedInvalid)("focusable",V.focusable)("nativeId",V.nativeId)("disabled",V.disabled)("readOnly",V.readOnly)("value",V.value)}},directives:[G.o,$.y,ct.B,X.aR,gt.s,ot.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem}"],changeDetection:0}),(0,C.gn)([(0,Q.tuiDefaultProp)()],Tt.prototype,"colors",void 0),(0,C.gn)([Q.tuiPure],Tt.prototype,"sanitize",null)},37924:(It,pt,c)=>{c.d(pt,{X:()=>Z});var C=c(40632),i=c(62842),w=c(9112),x=c(88002),T=c(74788),Q=c(12057),D=c(40939),G=c(62939),$=c(76189),ct=c(67446),X=c(29070),gt=c(54255),ot=c(15491),dt=c(219);function Mt(U,V){if(1&U){const H=T.EpF();T.TgZ(0,"div",6),T.TgZ(1,"button",7),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).editor.onAlign("left")}),T.qZA(),T.TgZ(2,"button",8),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).editor.onAlign("center")}),T.qZA(),T.TgZ(3,"button",9),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).editor.onAlign("right")}),T.qZA(),T.TgZ(4,"button",10),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).editor.onAlign("justify")}),T.qZA(),T.qZA()}if(2&U){const H=T.oxw().tuiLet,ht=T.oxw().ngIf;T.xp6(1),T.Q6J("pseudoActive",!(null==H||!H.left))("tuiHint",ht.justifyLeft),T.xp6(1),T.Q6J("pseudoActive",!(null==H||!H.center))("tuiHint",ht.justifyCenter),T.xp6(1),T.Q6J("pseudoActive",!(null==H||!H.right))("tuiHint",ht.justifyRight),T.xp6(1),T.Q6J("pseudoActive",!(null==H||!H.justify))("tuiHint",ht.justifyFull)}}function vt(U,V){if(1&U&&(T.TgZ(0,"tui-hosted-dropdown",2,3),T._UZ(2,"button",4),T.YNc(3,Mt,5,8,"ng-template",null,5,T.W1O),T.qZA()),2&U){const H=T.MAs(1),ht=T.MAs(4),at=T.oxw().ngIf;T.Q6J("content",ht),T.xp6(2),T.Q6J("tuiHint",at.justify)("tuiHintDescribe","")("pseudoActive",H.open)("focusable",H.open)}}function Tt(U,V){if(1&U&&(T.ynx(0),T.YNc(1,vt,5,5,"tui-hosted-dropdown",1),T.ALo(2,"async"),T.BQk()),2&U){const H=T.oxw();T.xp6(1),T.Q6J("tuiLet",T.lcZ(2,1,H.alignState$))}}let Z=(()=>{class U{constructor(H,ht){this.editor=H,this.texts$=ht,this.alignState$=(0,w.aj)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,x.U)(([at,ft,Ct,lt])=>({left:at,right:ft,center:Ct,justify:lt})))}}return U.\u0275fac=function(H){return new(H||U)(T.Y36(C.$3),T.Y36(i.rf))},U.\u0275cmp=T.Xpm({type:U,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"]],template:function(H,ht){1&H&&(T.YNc(0,Tt,3,3,"ng-container",0),T.ALo(1,"async")),2&H&&T.Q6J("ngIf",T.lcZ(1,1,ht.texts$))},directives:[Q.O5,D.L,G.o,$.v,ct.D,X.x,gt.t,ot.D,dt.$],pipes:[Q.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),U})()},15587:(It,pt,c)=>{c.d(pt,{T:()=>Z});var C=c(40632),i=c(62842),w=c(88002),x=c(87519),T=c(74788),Q=c(62939),D=c(76189),G=c(67446),$=c(29070),ct=c(54255),X=c(15491),gt=c(219),ot=c(20933),dt=c(12057),Mt=c(35065);function vt(U,V){if(1&U){const H=T.EpF();T.TgZ(0,"button",5),T.NdJ("click",function(){const ft=T.CHM(H).index;return T.oxw(2).onCode(!!ft)}),T._uU(1),T.qZA()}if(2&U){const H=V.$implicit;T.xp6(1),T.hij(" ",H," ")}}function Tt(U,V){if(1&U&&(T.TgZ(0,"tui-data-list"),T.YNc(1,vt,2,1,"button",4),T.ALo(2,"async"),T.qZA()),2&U){const H=T.oxw();T.xp6(1),T.Q6J("ngForOf",T.lcZ(2,1,H.codeOptionsTexts$))}}let Z=(()=>{class U{constructor(H,ht,at){this.editor=H,this.texts$=ht,this.codeOptionsTexts$=at,this.hintText$=this.texts$.pipe((0,w.U)(ft=>ft.code)),this.insideCode$=this.editor.stateChange$.pipe((0,w.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,x.x)())}onCode(H){H?this.editor.toggleCodeBlock():this.editor.toggleCode()}}return U.\u0275fac=function(H){return new(H||U)(T.Y36(C.$3),T.Y36(i.rf),T.Y36(i.Mr))},U.\u0275cmp=T.Xpm({type:U,selectors:[["tui-code"]],decls:7,vars:9,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(H,ht){if(1&H&&(T.TgZ(0,"tui-hosted-dropdown",0,1),T._UZ(2,"button",2),T.ALo(3,"async"),T.ALo(4,"async"),T.YNc(5,Tt,3,3,"ng-template",null,3,T.W1O),T.qZA()),2&H){const at=T.MAs(1),ft=T.MAs(6);T.Q6J("content",ft),T.xp6(2),T.Q6J("tuiHint",T.lcZ(3,5,ht.hintText$))("tuiHintDescribe","")("pseudoActive",at.open||T.lcZ(4,7,ht.insideCode$))("focusable",at.open)}},directives:[Q.o,D.v,G.D,$.x,ct.t,X.D,gt.$,ot.q,dt.sg,Mt.v],pipes:[dt.Ov],encapsulation:2,changeDetection:0}),U})()},18832:(It,pt,c)=>{c.d(pt,{U:()=>dt});var C=c(40632),i=c(62842),w=c(88002),x=c(87519),T=c(74788),Q=c(12057),D=c(76189),G=c(67446),$=c(29070),ct=c(54255),X=c(15491),gt=c(219);function ot(Mt,vt){if(1&Mt){const Tt=T.EpF();T.TgZ(0,"button",1),T.NdJ("click",function(){return T.CHM(Tt),T.oxw().removeDetails()}),T.ALo(1,"async"),T.qZA()}if(2&Mt){const Tt=vt.ngIf,Z=T.oxw();T.Q6J("tuiHint",Tt.removeDetails)("tuiHintDescribe","")("focusable",!1)("disabled",!!T.lcZ(1,4,Z.disabled$))}}let dt=(()=>{class Mt{constructor(Tt,Z){this.editor=Tt,this.texts$=Z,this.disabled$=this.editor.stateChange$.pipe((0,w.U)(()=>!this.editor.isActive("details")),(0,x.x)())}removeDetails(){this.editor.removeDetails()}}return Mt.\u0275fac=function(Tt){return new(Tt||Mt)(T.Y36(C.$3),T.Y36(i.rf))},Mt.\u0275cmp=T.Xpm({type:Mt,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(Tt,Z){1&Tt&&(T.YNc(0,ot,2,6,"button",0),T.ALo(1,"async")),2&Tt&&T.Q6J("ngIf",T.lcZ(1,1,Z.texts$))},directives:[Q.O5,D.v,G.D,$.x,ct.t,X.D,gt.$],pipes:[Q.Ov],encapsulation:2,changeDetection:0}),Mt})()},50237:(It,pt,c)=>{c.d(pt,{y:()=>gt});var C=c(40632),i=c(62842),w=c(74788),x=c(12057),T=c(76189),Q=c(67446),D=c(29070),G=c(54255),$=c(15491),ct=c(219);function X(ot,dt){if(1&ot){const Mt=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){return w.CHM(Mt),w.oxw().setDetails()}),w.qZA()}2&ot&&w.Q6J("tuiHint",dt.ngIf.setDetails)("tuiHintDescribe","")("focusable",!1)}let gt=(()=>{class ot{constructor(Mt,vt){this.editor=Mt,this.texts$=vt}setDetails(){this.editor.setDetails()}}return ot.\u0275fac=function(Mt){return new(Mt||ot)(w.Y36(C.$3),w.Y36(i.rf))},ot.\u0275cmp=w.Xpm({type:ot,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click"]],template:function(Mt,vt){1&Mt&&(w.YNc(0,X,1,3,"button",0),w.ALo(1,"async")),2&Mt&&w.Q6J("ngIf",w.lcZ(1,1,vt.texts$))},directives:[x.O5,T.v,Q.D,D.x,G.t,$.D,ct.$],pipes:[x.Ov],encapsulation:2,changeDetection:0}),ot})()},84985:(It,pt,c)=>{c.d(pt,{m:()=>Z});var C=c(40632),i=c(62842),w=c(36692),x=c(88002),T=c(74788),Q=c(62939),D=c(76189),G=c(67446),$=c(29070),ct=c(54255),X=c(15491),gt=c(219),ot=c(20933),dt=c(12057),Mt=c(35065);function vt(U,V){if(1&U){const H=T.EpF();T.TgZ(0,"button",5),T.NdJ("click",function(){const ft=T.CHM(H).$implicit;return T.oxw(2).onClick(ft)}),T.ALo(1,"lowercase"),T._uU(2),T.qZA()}if(2&U){const H=V.$implicit;T.Udp("font-family",H.family)("font-size",H.px,"px")("font-weight",H.weight),T.uIk("automation-id","tui_font__"+T.lcZ(1,8,H.name||"")),T.xp6(2),T.hij(" ",H.name," ")}}function Tt(U,V){if(1&U&&(T.TgZ(0,"tui-data-list"),T.YNc(1,vt,3,10,"button",4),T.ALo(2,"async"),T.qZA()),2&U){const H=T.oxw();T.xp6(1),T.Q6J("ngForOf",T.lcZ(2,1,H.fontsOptions$))}}let Z=(()=>{class U{constructor(H,ht,at,ft){this.options=H,this.editor=ht,this.texts$=at,this.fontOptionsTexts$=ft,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,x.U)(Ct=>this.options.fontOptions(Ct))),this.fontText$=this.texts$.pipe((0,x.U)(Ct=>Ct.font))}onClick({headingLevel:H,px:ht}){H?this.editor.setHeading(H):this.editor.setParagraph({fontSize:(0,w.tuiPx)(ht||0)})}}return U.\u0275fac=function(H){return new(H||U)(T.Y36(i.mJ),T.Y36(C.$3),T.Y36(i.rf),T.Y36(i.UN))},U.\u0275cmp=T.Xpm({type:U,selectors:[["tui-font-size"]],decls:6,vars:7,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(H,ht){if(1&H&&(T.TgZ(0,"tui-hosted-dropdown",0,1),T._UZ(2,"button",2),T.ALo(3,"async"),T.YNc(4,Tt,3,3,"ng-template",null,3,T.W1O),T.qZA()),2&H){const at=T.MAs(1),ft=T.MAs(5);T.Q6J("content",ft),T.xp6(2),T.Q6J("tuiHint",T.lcZ(3,5,ht.fontText$))("tuiHintDescribe","")("pseudoActive",at.open)("focusable",at.open)}},directives:[Q.o,D.v,G.D,$.x,ct.t,X.D,gt.$,ot.q,dt.sg,Mt.v],pipes:[dt.Ov,dt.i8],encapsulation:2,changeDetection:0}),U})()},62976:(It,pt,c)=>{c.d(pt,{h:()=>at});var C=c(19074),i=c(40632),w=c(48699),x=c(62842),T=c(9112),Q=c(88002),D=c(74788),G=c(12057),$=c(62939),ct=c(76189),X=c(67446),gt=c(29070),ot=c(54255),dt=c(15491),Mt=c(219);function vt(ft,Ct){if(1&ft){const lt=D.EpF();D.TgZ(0,"button",11),D.NdJ("click",function(){return D.CHM(lt),D.oxw(4).editor.toggleBold()}),D.qZA()}if(2&ft){const lt=D.oxw(2).ngIf,Ot=D.oxw().ngIf;D.Q6J("tuiHint",Ot.bold)("pseudoActive",lt.bold)}}function Tt(ft,Ct){if(1&ft){const lt=D.EpF();D.TgZ(0,"button",12),D.NdJ("click",function(){return D.CHM(lt),D.oxw(4).editor.toggleItalic()}),D.qZA()}if(2&ft){const lt=D.oxw(2).ngIf,Ot=D.oxw().ngIf;D.Q6J("tuiHint",Ot.italic)("pseudoActive",lt.italic)}}function Z(ft,Ct){if(1&ft){const lt=D.EpF();D.TgZ(0,"button",13),D.NdJ("click",function(){return D.CHM(lt),D.oxw(4).editor.toggleUnderline()}),D.qZA()}if(2&ft){const lt=D.oxw(2).ngIf,Ot=D.oxw().ngIf;D.Q6J("tuiHint",Ot.underline)("pseudoActive",lt.underline)}}function U(ft,Ct){if(1&ft){const lt=D.EpF();D.TgZ(0,"button",14),D.NdJ("click",function(){return D.CHM(lt),D.oxw(4).editor.toggleStrike()}),D.qZA()}if(2&ft){const lt=D.oxw(2).ngIf,Ot=D.oxw().ngIf;D.Q6J("tuiHint",Ot.strikeThrough)("pseudoActive",lt.strike)}}function V(ft,Ct){if(1&ft&&(D.TgZ(0,"div",6),D.YNc(1,vt,1,2,"button",7),D.YNc(2,Tt,1,2,"button",8),D.YNc(3,Z,1,2,"button",9),D.YNc(4,U,1,2,"button",10),D.qZA()),2&ft){const lt=D.oxw(3);D.xp6(1),D.Q6J("ngIf",lt.isEnabled(lt.TuiEditorTool.Bold)),D.xp6(1),D.Q6J("ngIf",lt.isEnabled(lt.TuiEditorTool.Italic)),D.xp6(1),D.Q6J("ngIf",lt.isEnabled(lt.TuiEditorTool.Underline)),D.xp6(1),D.Q6J("ngIf",lt.isEnabled(lt.TuiEditorTool.Strikethrough))}}function H(ft,Ct){if(1&ft&&(D.TgZ(0,"tui-hosted-dropdown",2,3),D._UZ(2,"button",4),D.YNc(3,V,5,4,"ng-template",null,5,D.W1O),D.qZA()),2&ft){const lt=Ct.ngIf,Ot=D.MAs(1),Pt=D.MAs(4),Bt=D.oxw().ngIf;D.Q6J("content",Pt),D.xp6(2),D.Q6J("tuiHint",Bt.fontStyle)("tuiHintDescribe","")("pseudoActive",Ot.open||lt.bold||lt.italic||lt.underline||lt.strike)("focusable",Ot.open)}}function ht(ft,Ct){if(1&ft&&(D.ynx(0),D.YNc(1,H,5,5,"tui-hosted-dropdown",1),D.ALo(2,"async"),D.BQk()),2&ft){const lt=D.oxw();D.xp6(1),D.Q6J("ngIf",D.lcZ(2,1,lt.fontStyleState$))}}let at=(()=>{class ft{constructor(lt,Ot){this.editor=lt,this.texts$=Ot,this.toolsSet=new Set(C.Db),this.TuiEditorTool=w._,this.fontStyleState$=(0,T.aj)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,Q.U)(([Pt,Bt,tt,b])=>({bold:Pt,italic:Bt,underline:tt,strike:b})))}set enabledTools(lt){this.toolsSet=new Set(lt)}isEnabled(lt){return this.toolsSet.has(lt)}}return ft.\u0275fac=function(lt){return new(lt||ft)(D.Y36(i.$3),D.Y36(x.rf))},ft.\u0275cmp=D.Xpm({type:ft,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"]],template:function(lt,Ot){1&lt&&(D.YNc(0,ht,3,3,"ng-container",0),D.ALo(1,"async")),2&lt&&D.Q6J("ngIf",D.lcZ(1,1,Ot.texts$))},directives:[G.O5,$.o,ct.v,X.D,gt.x,ot.t,dt.D,Mt.$],pipes:[G.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),ft})()},19762:(It,pt,c)=>{c.d(pt,{d:()=>ot});var C=c(40632),i=c(62842),w=c(88002),x=c(87519),T=c(74788),Q=c(76189),D=c(67446),G=c(29070),$=c(54255),ct=c(15491),X=c(219),gt=c(12057);let ot=(()=>{class dt{constructor(vt,Tt){this.editor=vt,this.texts$=Tt,this.insertGroupText$=this.texts$.pipe((0,w.U)(Z=>Z.insertGroup)),this.removeGroupText$=this.texts$.pipe((0,w.U)(Z=>Z.removeGroup)),this.disabled$=this.editor.stateChange$.pipe((0,w.U)(()=>!this.editor.isActive("group")),(0,x.x)())}addGroup(){this.editor.setGroup()}removeGroup(){this.editor.removeGroup()}}return dt.\u0275fac=function(vt){return new(vt||dt)(T.Y36(C.$3),T.Y36(i.rf))},dt.\u0275cmp=T.Xpm({type:dt,selectors:[["tui-editor-group-tool"]],decls:5,vars:13,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconPlusLarge","appearance","icon",3,"focusable","tuiHint","tuiHintDescribe","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconRemoveLarge","appearance","icon",3,"focusable","disabled","tuiHint","tuiHintDescribe","click"]],template:function(vt,Tt){1&vt&&(T.TgZ(0,"button",0),T.NdJ("click",function(){return Tt.addGroup()}),T.ALo(1,"async"),T.qZA(),T.TgZ(2,"button",1),T.NdJ("click",function(){return Tt.removeGroup()}),T.ALo(3,"async"),T.ALo(4,"async"),T.qZA()),2&vt&&(T.Q6J("focusable",!1)("tuiHint",T.lcZ(1,7,Tt.insertGroupText$))("tuiHintDescribe",""),T.xp6(2),T.Q6J("focusable",!1)("disabled",!!T.lcZ(3,9,Tt.disabled$))("tuiHint",T.lcZ(4,11,Tt.removeGroupText$))("tuiHintDescribe",""))},directives:[Q.v,D.D,G.x,$.t,ct.D,X.$],pipes:[gt.Ov],encapsulation:2,changeDetection:0}),dt})()},7416:(It,pt,c)=>{c.d(pt,{U:()=>at});var C=c(64762),i=c(40632),w=c(62842),x=c(36692),T=c(88002),Q=c(87519),D=c(74788),G=c(40939),$=c(62939),ct=c(33250),X=c(76189),gt=c(67446),ot=c(29070),dt=c(54255),Mt=c(15491),vt=c(219),Tt=c(12057),Z=c(5451),U=c(17163);function V(ft,Ct){if(1&ft&&D._UZ(0,"div",6),2&ft){const lt=D.oxw().tuiLet;D.Udp("background",lt)}}function H(ft,Ct){if(1&ft){const lt=D.EpF();D.TgZ(0,"tui-palette",7),D.NdJ("selectedColor",function(Pt){return D.CHM(lt),D.oxw(2).editor.setBackgroundColor(Pt)}),D.qZA()}if(2&ft){const lt=Ct.$implicit,Ot=D.oxw(2);D.Q6J("tuiActiveZoneParent",lt)("colors",Ot.colors)}}function ht(ft,Ct){if(1&ft&&(D.TgZ(0,"tui-hosted-dropdown",1,2),D._UZ(2,"button",3),D.ALo(3,"async"),D.YNc(4,V,1,2,"div",4),D.YNc(5,H,1,2,"ng-template",null,5,D.W1O),D.qZA()),2&ft){const lt=Ct.tuiLet,Ot=D.MAs(1),Pt=D.MAs(6),Bt=D.oxw();D.Q6J("content",Pt)("tuiDropdownMaxHeight",999),D.xp6(2),D.Q6J("tuiHint",D.lcZ(3,7,Bt.backColorText$))("tuiHintDescribe","")("pseudoActive",Ot.open)("focusable",Ot.open),D.xp6(2),D.Q6J("ngIf",!Bt.isBlankColor(lt||""))}}class at{constructor(Ct,lt,Ot){this.editor=Ct,this.texts$=lt,this.defaultOptions=Ot,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,T.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,Q.x)()),this.backColorText$=this.texts$.pipe((0,T.U)(Pt=>Pt.backColor))}isBlankColor(Ct){return Ct===this.defaultOptions.blankColor}}at.\u0275fac=function(Ct){return new(Ct||at)(D.Y36(i.$3),D.Y36(w.rf),D.Y36(w.mJ))},at.\u0275cmp=D.Xpm({type:at,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(Ct,lt){1&Ct&&(D.YNc(0,ht,7,9,"tui-hosted-dropdown",0),D.ALo(1,"async")),2&Ct&&D.Q6J("tuiLet",D.lcZ(1,1,lt.backgroundColor$))},directives:[G.L,$.o,ct.Ek,X.v,gt.D,ot.x,dt.t,Mt.D,vt.$,Tt.O5,Z.R,U.e],pipes:[Tt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],at.prototype,"colors",void 0)},93252:(It,pt,c)=>{c.d(pt,{Xp:()=>C.X,pu:()=>Q,Tf:()=>D.T,P_:()=>G,yj:()=>$.y,y9:()=>ct,Un:()=>X.U,dN:()=>vt.d,jP:()=>Tt,mK:()=>gt.m,p7:()=>ot,hr:()=>dt.h,Zv:()=>Mt,UT:()=>Z.U,XC:()=>V,w2:()=>H.w,Ur:()=>ht,pH:()=>at.p,mp:()=>ft,iN:()=>b.i,lT:()=>Ct.l,iA:()=>Pt,YH:()=>Bt.Y,er:()=>tt,_I:()=>b._,__:()=>F,M8:()=>lt.M,kU:()=>Ot,G0:()=>J.G,_t:()=>ut});var C=c(37924),i=c(12057),w=c(36692),x=c(72002),T=c(74788);let Q=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiButtonModule,x.TuiHintModule,w.TuiLetModule]]}),B})();var D=c(15587);let G=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiButtonModule,x.TuiHintModule,x.TuiDataListModule]]}),B})();var $=c(50237);let ct=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiButtonModule,x.TuiHintModule]]}),B})();var X=c(18832),gt=c(84985);let ot=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiButtonModule,x.TuiHintModule,x.TuiDataListModule]]}),B})();var dt=c(62976);let Mt=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiButtonModule,x.TuiHintModule]]}),B})();var vt=c(19762);let Tt=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiButtonModule,x.TuiHintModule]]}),B})();var Z=c(7416),U=c(27050);let V=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiButtonModule,U.VM,x.TuiHintModule,x.TuiDropdownModule,w.TuiActiveZoneModule,w.TuiLetModule]]}),B})();var H=c(13441);let ht=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiButtonModule,x.TuiHintModule,w.TuiLetModule]]}),B})();var at=c(95558);let ft=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,U.VM,x.TuiButtonModule,x.TuiHintModule,w.TuiActiveZoneModule,x.TuiDropdownModule,w.TuiLetModule]]}),B})();var Ct=c(28962),lt=c(74549);let Ot=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,w.TuiRepeatTimesModule]]}),B})(),Pt=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiDropdownModule,x.TuiButtonModule,x.TuiHintModule,Ot]]}),B})();var Bt=c(76965);let tt=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiButtonModule,x.TuiHintModule,w.TuiLetModule]]}),B})();var b=c(22063);let F=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiHostedDropdownModule,x.TuiHintModule,x.TuiButtonModule,x.TuiDataListModule,w.TuiLetModule]]}),B})();var J=c(10528);let ut=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=T.oAB({type:B}),B.\u0275inj=T.cJS({imports:[[i.ez,x.TuiButtonModule,x.TuiHostedDropdownModule,x.TuiDropdownModule,x.TuiHintModule,U.VM,w.TuiActiveZoneModule,w.TuiLetModule]]}),B})()},13441:(It,pt,c)=>{c.d(pt,{w:()=>Z});var C=c(40632),i=c(62842),w=c(9112),x=c(88002),T=c(74788),Q=c(12057),D=c(40939),G=c(62939),$=c(76189),ct=c(67446),X=c(29070),gt=c(54255),ot=c(15491),dt=c(219);function Mt(U,V){if(1&U){const H=T.EpF();T.TgZ(0,"div",6),T.TgZ(1,"button",7),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).editor.toggleUnorderedList()}),T.qZA(),T.TgZ(2,"button",8),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).editor.toggleOrderedList()}),T.qZA(),T.TgZ(3,"button",9),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).sinkListItem()}),T.qZA(),T.TgZ(4,"button",10),T.NdJ("click",function(){return T.CHM(H),T.oxw(3).liftListItem()}),T.qZA(),T.qZA()}if(2&U){const H=T.oxw().tuiLet,ht=T.oxw().ngIf;T.xp6(1),T.Q6J("tuiHint",ht.unorderedList)("pseudoActive",!(null==H||!H.unordered)),T.xp6(1),T.Q6J("tuiHint",ht.orderedList)("pseudoActive",!(null==H||!H.ordered)),T.xp6(1),T.Q6J("tuiHint",ht.indent)("disabled",!(null!=H&&H.ordered||null!=H&&H.unordered)),T.xp6(1),T.Q6J("tuiHint",ht.outdent)("disabled",!(null!=H&&H.ordered||null!=H&&H.unordered))}}function vt(U,V){if(1&U&&(T.TgZ(0,"tui-hosted-dropdown",2,3),T._UZ(2,"button",4),T.YNc(3,Mt,5,8,"ng-template",null,5,T.W1O),T.qZA()),2&U){const H=V.tuiLet,ht=T.MAs(1),at=T.MAs(4),ft=T.oxw().ngIf;T.Q6J("content",at),T.xp6(2),T.Q6J("tuiHint",ft.list)("tuiHintDescribe","")("pseudoActive",(null==ht?null:ht.open)||(null==H?null:H.unordered)||(null==H?null:H.ordered)||!1)("focusable",ht.open)}}function Tt(U,V){if(1&U&&(T.ynx(0),T.YNc(1,vt,5,5,"tui-hosted-dropdown",1),T.ALo(2,"async"),T.BQk()),2&U){const H=T.oxw();T.xp6(1),T.Q6J("tuiLet",T.lcZ(2,1,H.listState$))}}let Z=(()=>{class U{constructor(H,ht){this.editor=H,this.texts$=ht,this.listState$=(0,w.aj)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,x.U)(([at,ft])=>({ordered:at,unordered:ft})))}sinkListItem(){this.editor.sinkListItem()}liftListItem(){this.editor.liftListItem()}}return U.\u0275fac=function(H){return new(H||U)(T.Y36(C.$3),T.Y36(i.rf))},U.\u0275cmp=T.Xpm({type:U,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","disabled","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","disabled","click"]],template:function(H,ht){1&H&&(T.YNc(0,Tt,3,3,"ng-container",0),T.ALo(1,"async")),2&H&&T.Q6J("ngIf",T.lcZ(1,1,ht.texts$))},directives:[Q.O5,D.L,G.o,$.v,ct.D,X.x,gt.t,ot.D,dt.$],pipes:[Q.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),U})()},95558:(It,pt,c)=>{c.d(pt,{p:()=>ft});var C=c(64762),i=c(40632),w=c(62842),x=c(36692),T=c(88002),Q=c(87519),D=c(74788),G=c(40939),$=c(62939),ct=c(33250),X=c(76189),gt=c(67446),ot=c(29070),dt=c(54255),Mt=c(15491),vt=c(219),Tt=c(12057),Z=c(5451),U=c(17163);function V(Ct,lt){if(1&Ct&&D._UZ(0,"div",7),2&Ct){const Ot=D.oxw(2).tuiLet;D.Udp("background",Ot)}}function H(Ct,lt){if(1&Ct){const Ot=D.EpF();D.TgZ(0,"tui-palette",8),D.NdJ("selectedColor",function(Bt){return D.CHM(Ot),D.oxw(3).setCellColor(Bt)}),D.qZA()}if(2&Ct){const Ot=lt.$implicit,Pt=D.oxw(3);D.Q6J("tuiActiveZoneParent",Ot)("colors",Pt.colors)}}function ht(Ct,lt){if(1&Ct&&(D.TgZ(0,"tui-hosted-dropdown",2,3),D._UZ(2,"button",4),D.ALo(3,"async"),D.YNc(4,V,1,2,"div",5),D.YNc(5,H,1,2,"ng-template",null,6,D.W1O),D.qZA()),2&Ct){const Ot=lt.tuiLet,Pt=D.MAs(1),Bt=D.MAs(6),tt=D.oxw().tuiLet,b=D.oxw();D.Q6J("content",Bt)("tuiDropdownMaxHeight",999)("canOpen",!!Ot),D.xp6(2),D.Q6J("tuiHint",D.lcZ(3,9,b.cellColorText$))("tuiHintDescribe","")("pseudoActive",Pt.open)("focusable",Pt.open)("disabled",!Ot),D.xp6(2),D.Q6J("ngIf",!b.isBlankColor(tt||""))}}function at(Ct,lt){if(1&Ct&&(D.ynx(0),D.YNc(1,ht,7,11,"tui-hosted-dropdown",1),D.ALo(2,"async"),D.BQk()),2&Ct){const Ot=D.oxw();D.xp6(1),D.Q6J("tuiLet",D.lcZ(2,1,Ot.isActive$))}}class ft{constructor(lt,Ot,Pt){this.defaultOptions=lt,this.editor=Ot,this.texts$=Pt,this.colors=this.defaultOptions.colors,this.cellColorText$=this.texts$.pipe((0,T.U)(Bt=>Bt.cellColor)),this.isActive$=this.editor.isActive$("table"),this.cellColor$=this.editor.stateChange$.pipe((0,T.U)(()=>this.editor.getCellColor()||this.defaultOptions.blankColor),(0,Q.x)())}isBlankColor(lt){return lt===this.defaultOptions.blankColor}setCellColor(lt){this.editor.setCellColor(lt)}}ft.\u0275fac=function(lt){return new(lt||ft)(D.Y36(w.mJ),D.Y36(i.$3),D.Y36(w.rf))},ft.\u0275cmp=D.Xpm({type:ft,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["cellColorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","disabled"],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(lt,Ot){1&lt&&(D.YNc(0,at,3,3,"ng-container",0),D.ALo(1,"async")),2&lt&&D.Q6J("tuiLet",D.lcZ(1,1,Ot.cellColor$))},directives:[G.L,$.o,ct.Ek,X.v,gt.D,ot.x,dt.t,Mt.D,vt.$,Tt.O5,Z.R,U.e],pipes:[Tt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],ft.prototype,"colors",void 0)},28962:(It,pt,c)=>{c.d(pt,{l:()=>vt});var C=c(40632),i=c(62842),w=c(88002),x=c(74788),T=c(62939),Q=c(33250),D=c(76189),G=c(67446),$=c(29070),ct=c(54255),X=c(15491),gt=c(219),ot=c(74549),dt=c(12057);function Mt(Tt,Z){if(1&Tt){const U=x.EpF();x.TgZ(0,"tui-table-size-selector",4),x.NdJ("onSelectSize",function(H){return x.CHM(U),x.oxw().addTable(H)}),x.qZA()}}let vt=(()=>{class Tt{constructor(U,V){this.editor=U,this.texts$=V,this.insertTableText$=this.texts$.pipe((0,w.U)(H=>H.insertTable))}addTable({rows:U,cols:V}){this.editor.enter();const H=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(H),this.editor.insertTable(U,V)}}return Tt.\u0275fac=function(U){return new(U||Tt)(x.Y36(C.$3),x.Y36(i.rf))},Tt.\u0275cmp=x.Xpm({type:Tt,selectors:[["tui-table-create"]],decls:6,vars:6,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable"],["tableDropdown",""],[3,"onSelectSize"]],template:function(U,V){if(1&U&&(x.TgZ(0,"tui-hosted-dropdown",0,1),x._UZ(2,"button",2),x.ALo(3,"async"),x.qZA(),x.YNc(4,Mt,1,0,"ng-template",null,3,x.W1O)),2&U){const H=x.MAs(1),ht=x.MAs(5);x.Q6J("content",ht),x.xp6(2),x.Q6J("tuiHint",x.lcZ(3,4,V.insertTableText$))("tuiHintDescribe","")("focusable",H.open)}},directives:[T.o,Q.Ek,D.v,G.D,$.x,ct.t,X.D,gt.$,ot.M],pipes:[dt.Ov],encapsulation:2,changeDetection:0}),Tt})()},76965:(It,pt,c)=>{c.d(pt,{Y:()=>Tt});var C=c(40632),i=c(62842),w=c(88002),x=c(87519),T=c(74788),Q=c(40939),D=c(12057),G=c(76189),$=c(67446),ct=c(29070),X=c(54255),gt=c(15491),ot=c(219);function dt(Z,U){if(1&Z){const V=T.EpF();T.TgZ(0,"button",2),T.NdJ("click",function(){T.CHM(V);const ht=T.oxw().tuiLet,at=T.oxw();return ht.mergeCells?at.mergeCells():at.splitCell()}),T.qZA()}if(2&Z){const V=U.ngIf,H=T.oxw().tuiLet;T.Q6J("icon",H.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",H.mergeCells?V.mergeCells:V.splitCells)("tuiHintDescribe","")("focusable",!1)("disabled",!H.mergeCells&&!H.splitCells)}}function Mt(Z,U){if(1&Z&&(T.ynx(0),T.YNc(1,dt,1,5,"button",1),T.ALo(2,"async"),T.BQk()),2&Z){const V=T.oxw();T.xp6(1),T.Q6J("ngIf",T.lcZ(2,1,V.texts$))}}const vt=function(Z,U){return{mergeCells:Z,splitCells:U}};let Tt=(()=>{class Z{constructor(V,H){this.editor=V,this.texts$=H,this.canMergeCells$=this.editor.stateChange$.pipe((0,w.U)(()=>this.editor.canMergeCells()),(0,x.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,w.U)(()=>this.editor.canSplitCells()),(0,x.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}}return Z.\u0275fac=function(V){return new(V||Z)(T.Y36(C.$3),T.Y36(i.rf))},Z.\u0275cmp=T.Xpm({type:Z,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(V,H){1&V&&(T.YNc(0,Mt,3,3,"ng-container",0),T.ALo(1,"async"),T.ALo(2,"async")),2&V&&T.Q6J("tuiLet",T.WLB(5,vt,T.lcZ(1,1,H.canMergeCells$),T.lcZ(2,3,H.canSplitCells$)))},directives:[Q.L,D.O5,G.v,$.D,ct.x,X.t,gt.D,ot.$],pipes:[D.Ov],encapsulation:2,changeDetection:0}),Z})()},22063:(It,pt,c)=>{c.d(pt,{i:()=>H,_:()=>ht});var C=c(40632),i=c(62842),w=c(88002),x=c(74788),T=c(40939),Q=c(62939),D=c(76189),G=c(67446),$=c(29070),ct=c(54255),X=c(15491),gt=c(219),ot=c(20933),dt=c(12057),Mt=c(89786),vt=c(35065);function Tt(at,ft){if(1&at&&(x.TgZ(0,"tui-hosted-dropdown",2,3),x._UZ(2,"button",4),x.ALo(3,"async"),x.qZA()),2&at){const Ct=ft.tuiLet,lt=x.MAs(1),Ot=x.oxw(),Pt=x.MAs(3);x.Q6J("content",Pt)("canOpen",!!Ct),x.xp6(2),x.Q6J("tuiHint",x.lcZ(3,6,Ot.rowsColumnsManagingText$))("tuiHintDescribe","")("focusable",lt.open)("disabled",!Ct)}}function Z(at,ft){if(1&at){const Ct=x.EpF();x.TgZ(0,"button",7),x.NdJ("click",function(){const Pt=x.CHM(Ct).index,Bt=x.oxw().index;return x.oxw(2).onTableOption(2*Bt+Pt)}),x._uU(1),x.qZA()}if(2&at){const Ct=ft.$implicit;x.xp6(1),x.hij(" ",Ct," ")}}function U(at,ft){if(1&at&&(x.TgZ(0,"tui-opt-group"),x.YNc(1,Z,2,1,"button",6),x.qZA()),2&at){const Ct=ft.$implicit;x.xp6(1),x.Q6J("ngForOf",Ct)}}function V(at,ft){if(1&at&&(x.TgZ(0,"tui-data-list"),x.YNc(1,U,2,1,"tui-opt-group",5),x.ALo(2,"async"),x.qZA()),2&at){const Ct=x.oxw();x.xp6(1),x.Q6J("ngForOf",x.lcZ(2,1,Ct.tableCommandTexts$))}}var H=(()=>{return(at=H||(H={}))[at.InsertColumnBefore=0]="InsertColumnBefore",at[at.InsertColumnAfter=1]="InsertColumnAfter",at[at.InsertRowBefore=2]="InsertRowBefore",at[at.InsertRowAfter=3]="InsertRowAfter",at[at.DeleteColumn=4]="DeleteColumn",at[at.DeleteRow=5]="DeleteRow",H;var at})();let ht=(()=>{class at{constructor(Ct,lt,Ot){this.editor=Ct,this.texts$=lt,this.tableCommandTexts$=Ot,this.commandsRegistry={[H.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[H.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[H.InsertRowAfter]:()=>this.editor.addRowAfter(),[H.InsertRowBefore]:()=>this.editor.addRowBefore(),[H.DeleteColumn]:()=>this.editor.deleteColumn(),[H.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,w.U)(Pt=>Pt.rowsColumnsManaging))}onTableOption(Ct){this.commandsRegistry[Ct]()}}return at.\u0275fac=function(Ct){return new(Ct||at)(x.Y36(C.$3),x.Y36(i.rf),x.Y36(i.$i))},at.\u0275cmp=x.Xpm({type:at,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled"],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(Ct,lt){1&Ct&&(x.YNc(0,Tt,4,8,"tui-hosted-dropdown",0),x.ALo(1,"async"),x.YNc(2,V,3,3,"ng-template",null,1,x.W1O)),2&Ct&&x.Q6J("tuiLet",x.lcZ(1,1,lt.isActive$))},directives:[T.L,Q.o,D.v,G.D,$.x,ct.t,X.D,gt.$,ot.q,dt.sg,Mt.R,vt.v],pipes:[dt.Ov],encapsulation:2,changeDetection:0}),at})()},74549:(It,pt,c)=>{c.d(pt,{M:()=>ct});var C=c(74788),i=c(62579),w=c(72002),x=c(36097);function T(X,gt){if(1&X){const ot=C.EpF();C.TgZ(0,"div",4),C.NdJ("mouseenter",function(Mt){const Tt=C.CHM(ot).$implicit,Z=C.oxw().$implicit;return C.oxw().updateCurrentSize(Tt+1,Z+1,Mt)})("click",function(){return C.CHM(ot),C.oxw(2).onClick()}),C.qZA()}if(2&X){const ot=gt.$implicit,dt=C.oxw().$implicit,Mt=C.oxw();C.ekj("t-cell_hovered",Mt.tableSelectHovered(ot,dt))}}function Q(X,gt){if(1&X&&(C.TgZ(0,"div",2),C.YNc(1,T,1,2,"div",3),C.qZA()),2&X){const ot=C.oxw();C.xp6(1),C.Q6J("tuiRepeatTimesOf",ot.rowsNumber)}}let ct=(()=>{class X{constructor(ot){this.windowRef=ot,this.onSelectSize=new C.vpe,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(ot,dt){return ot<this.tableSize.rows&&dt<this.tableSize.cols}updateCurrentSize(ot,dt,Mt){(0,w.tuiGetViewportWidth)(this.windowRef)-Mt.clientX>70&&(this.tableSize={rows:ot,cols:dt})}onClick(){this.onSelectSize.emit(this.tableSize)}}return X.\u0275fac=function(ot){return new(ot||X)(C.Y36(i.m9))},X.\u0275cmp=C.Xpm({type:X,selectors:[["tui-table-size-selector"]],outputs:{onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(ot,dt){1&ot&&(C.YNc(0,Q,2,1,"div",0),C.TgZ(1,"div",1),C._uU(2),C.qZA()),2&ot&&(C.Q6J("tuiRepeatTimesOf",dt.columnsNumber),C.xp6(2),C.AsE("",dt.tableSize.cols,"\xd7",dt.tableSize.rows,""))},directives:[x.X],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),X})()},10528:(It,pt,c)=>{c.d(pt,{G:()=>ht});var C=c(64762),i=c(40632),w=c(62842),x=c(36692),T=c(88002),Q=c(87519),D=c(74788),G=c(40939),$=c(62939),ct=c(33250),X=c(76189),gt=c(67446),ot=c(29070),dt=c(54255),Mt=c(15491),vt=c(219),Tt=c(5451),Z=c(17163),U=c(12057);function V(at,ft){if(1&at){const Ct=D.EpF();D.TgZ(0,"tui-palette",6),D.NdJ("selectedColor",function(Ot){return D.CHM(Ct),D.oxw(2).editor.setFontColor(Ot)}),D.qZA()}if(2&at){const Ct=ft.$implicit,lt=D.oxw(2);D.Q6J("tuiActiveZoneParent",Ct)("colors",lt.colors)}}function H(at,ft){if(1&at&&(D.TgZ(0,"tui-hosted-dropdown",1,2),D._UZ(2,"button",3),D.ALo(3,"async"),D._UZ(4,"div",4),D.YNc(5,V,1,2,"ng-template",null,5,D.W1O),D.qZA()),2&at){const Ct=ft.tuiLet,lt=D.MAs(1),Ot=D.MAs(6),Pt=D.oxw();D.Q6J("content",Ot)("tuiDropdownMaxHeight",999),D.xp6(2),D.Q6J("tuiHint",D.lcZ(3,8,Pt.foreColorText$))("tuiHintDescribe","")("pseudoActive",lt.open)("focusable",lt.open),D.xp6(2),D.Udp("background",Ct)}}class ht{constructor(ft,Ct,lt){this.defaultOptions=ft,this.editor=Ct,this.texts$=lt,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,T.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,Q.x)()),this.foreColorText$=this.texts$.pipe((0,T.U)(Ot=>Ot.foreColor))}}ht.\u0275fac=function(ft){return new(ft||ht)(D.Y36(w.mJ),D.Y36(i.$3),D.Y36(w.rf))},ht.\u0275cmp=D.Xpm({type:ht,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(ft,Ct){1&ft&&(D.YNc(0,H,7,10,"tui-hosted-dropdown",0),D.ALo(1,"async")),2&ft&&D.Q6J("tuiLet",D.lcZ(1,1,Ct.fontColor$))},directives:[G.L,$.o,ct.Ek,X.v,gt.D,ot.x,dt.t,Mt.D,vt.$,Tt.R,Z.e],pipes:[U.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,C.gn)([(0,x.tuiDefaultProp)()],ht.prototype,"colors",void 0)},17406:(It,pt,c)=>{c.d(pt,{M6:()=>C.M,yB:()=>G,Bp:()=>$.B});var C=c(4997),i=c(12057),w=c(71115),x=c(93252),T=c(36692),Q=c(72002),D=c(74788);let G=(()=>{class ct{}return ct.\u0275fac=function(gt){return new(gt||ct)},ct.\u0275mod=D.oAB({type:ct}),ct.\u0275inj=D.cJS({imports:[[i.ez,Q.TuiHintModule,T.TuiFocusableModule,Q.TuiButtonModule,Q.TuiHostedDropdownModule,w.F,x.er,x.mp,x.__,x.iA,x.p7,x.Zv,x.pu,x.Ur,x._t,x.XC,x.P_,x.y9,T.TuiItemModule,x.jP]]}),ct})();var $=c(13044)},13044:(It,pt,c)=>{c.d(pt,{B:()=>w});var C=c(74788),i=c(36692);let w=(()=>{class x{constructor(Q){this.elementRef=Q}get toolsContainers(){return Array.from(this.elementRef.nativeElement.querySelectorAll("[tuiItem]"))}onHorizontalNavigation(Q){const{toolsContainers:D}=this,G=D.findIndex(i.tuiIsNativeFocusedIn),ct=D[(0,i.tuiClamp)(G+(Q?-1:1),0,D.length-1)],X=Q?this.findPreviousTool(ct):this.findNextTool(ct);X&&X.focus()}findFirstFocusableTool(Q=!1){const D=Q?this.toolsContainers.slice().reverse():this.toolsContainers;for(const G of D){const $=(0,i.tuiIsNativeMouseFocusable)(G)?G:(0,i.tuiGetClosestFocusable)({initial:G,root:G,keyboard:!1});if($)return $}return null}findPreviousTool(Q){return(0,i.tuiIsNativeMouseFocusable)(Q)?Q:(0,i.tuiGetClosestFocusable)({initial:Q,root:Q,keyboard:!1})||(0,i.tuiGetClosestFocusable)({initial:Q,root:this.elementRef.nativeElement,previous:!0,keyboard:!1})}findNextTool(Q){return(0,i.tuiIsNativeMouseFocusable)(Q)?Q:(0,i.tuiGetClosestFocusable)({initial:Q,root:this.elementRef.nativeElement,keyboard:!1})}}return x.\u0275fac=function(Q){return new(Q||x)(C.Y36(C.SBq))},x.\u0275dir=C.lG2({type:x,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(Q,D){1&Q&&C.NdJ("keydown.arrowRight.prevent",function(){return D.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return D.onHorizontalNavigation(!0)})}}),x})()},4997:(It,pt,c)=>{c.d(pt,{M:()=>qt});var C=c(64762),i=c(74788),w=c(19074),x=c(40632),T=c(48699),Q=c(62842),D=c(36692),G=c(15257),$=c(13044),ct=c(12057),X=c(48893),gt=c(76189),ot=c(82707),dt=c(67446),Mt=c(29070),vt=c(54255),Tt=c(15491),Z=c(219),U=c(84985),V=c(62976),H=c(37924),ht=c(13441),at=c(62939),ft=c(45050),Ct=c(10528),lt=c(7416),Ot=c(15587),Pt=c(50237),Bt=c(18832),tt=c(19762),b=c(28962),F=c(22063),J=c(76965),ut=c(95558);const B=["dropdown"];function z(m,v){1&m&&i.GkF(0)}function q(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"div",6),i.TgZ(1,"button",7),i.NdJ("click",function(){return i.CHM(M),i.oxw(2).undo()}),i.qZA(),i.TgZ(2,"button",8),i.NdJ("click",function(){return i.CHM(M),i.oxw(2).redo()}),i.qZA(),i.qZA()}if(2&m){const M=i.oxw().ngIf,I=i.oxw();i.xp6(1),i.Q6J("tuiHint",M.undo)("tuiHintDescribe","")("disabled",I.undoDisabled)("focusable",!1),i.xp6(1),i.Q6J("tuiHint",M.redo)("tuiHintDescribe","")("disabled",I.redoDisabled)("focusable",!1)}}function xt(m,v){1&m&&(i.TgZ(0,"div",6),i._UZ(1,"tui-font-size",9),i.qZA())}function kt(m,v){if(1&m&&i._UZ(0,"tui-font-style",15),2&m){const M=i.oxw(3);i.Q6J("enabledTools",M.toolsSet)}}function Rt(m,v){1&m&&i._UZ(0,"tui-align-content",9)}function $t(m,v){1&m&&i._UZ(0,"tui-list-configs",9)}function Zt(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"button",16,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(3).toggleQuote()}),i.qZA()}if(2&m){const M=i.oxw(2).ngIf,I=i.oxw();i.Q6J("tuiHint",M.quote)("tuiHintDescribe","")("pseudoActive",I.blockquote)("disabled",I.unorderedList||I.orderedList)("focusable",!1)}}function ve(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"tui-edit-link",22,23),i.NdJ("addLink",function(K){i.CHM(M),i.oxw();const it=i.MAs(1);return i.oxw(3).onLink(it,K)})("removeLink",function(){i.CHM(M),i.oxw();const K=i.MAs(1);return i.oxw(3).onLink(K)}),i.qZA()}}function be(m,v){if(1&m&&(i.TgZ(0,"tui-hosted-dropdown",18,19),i._UZ(2,"button",20,17),i.YNc(4,ve,2,0,"ng-template",null,21,i.W1O),i.qZA()),2&m){const M=i.MAs(1),I=i.MAs(5),K=i.oxw(2).ngIf,it=i.oxw();i.Q6J("canOpen",!it.a)("content",I),i.xp6(2),i.Q6J("tuiHint",K.link)("tuiHintDescribe","")("pseudoActive",M.open||it.a)("focusable",M.open)}}function Ae(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"button",24,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(3).onAttach()}),i.qZA()}if(2&m){const M=i.oxw(2).ngIf;i.Q6J("tuiHint",M.attach)("tuiHintDescribe","")("focusable",!1)}}function te(m,v){if(1&m&&(i.TgZ(0,"div",6),i.YNc(1,kt,1,1,"tui-font-style",10),i.YNc(2,Rt,1,0,"tui-align-content",11),i.YNc(3,$t,1,0,"tui-list-configs",11),i.YNc(4,Zt,2,5,"button",12),i.YNc(5,be,6,6,"tui-hosted-dropdown",13),i.YNc(6,Ae,2,3,"button",14),i.qZA()),2&m){const M=i.oxw(2);i.xp6(1),i.Q6J("ngIf",M.formatEnabled),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Align)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.List)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Quote)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Link)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Attach))}}function Ce(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"button",27,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(3).toggleSubscript()}),i.qZA()}if(2&m){const M=i.oxw(2).ngIf,I=i.oxw();i.Q6J("tuiHint",M.subscript)("tuiHintDescribe","")("pseudoActive",I.subscript)("focusable",!1)}}function Xt(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"button",28,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(3).toggleSuperscript()}),i.qZA()}if(2&m){const M=i.oxw(2).ngIf,I=i.oxw();i.Q6J("tuiHint",M.superscript)("tuiHintDescribe","")("pseudoActive",I.superscript)("focusable",!1)}}function ie(m,v){if(1&m&&(i.TgZ(0,"div",6),i.YNc(1,Ce,2,4,"button",25),i.YNc(2,Xt,2,4,"button",26),i.qZA()),2&m){const M=i.oxw(2);i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Sub)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Sup))}}function ee(m,v){if(1&m&&i._UZ(0,"tui-text-color",30),2&m){const M=i.oxw(3);i.Q6J("colors",M.colors)}}function Me(m,v){if(1&m&&i._UZ(0,"tui-highlight-color",30),2&m){const M=i.oxw(3);i.Q6J("colors",M.colors)}}function me(m,v){if(1&m&&(i.TgZ(0,"div",6),i.YNc(1,ee,1,1,"tui-text-color",29),i.YNc(2,Me,1,1,"tui-highlight-color",29),i.qZA()),2&m){const M=i.oxw(2);i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Color)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Hilite))}}function ne(m,v){1&m&&i._UZ(0,"tui-code",9)}function Ee(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"button",34,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(3).onTeX()}),i.qZA()}if(2&m){const M=i.oxw(2).ngIf;i.Q6J("tuiHint",M.tex)("tuiHintDescribe","")("focusable",!1)}}function _e(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"div",35),i.TgZ(1,"button",36,17),i.NdJ("click",function(){return i.CHM(M),i.MAs(4).click()}),i.qZA(),i.TgZ(3,"input",37,38),i.NdJ("change",function(){i.CHM(M);const K=i.MAs(4);return i.oxw(3).onImage(K)}),i.qZA(),i.qZA()}if(2&m){const M=i.oxw(2).ngIf;i.xp6(1),i.Q6J("tuiHint",M.image)("tuiHintDescribe","")("focusable",!1),i.xp6(2),i.Q6J("tuiFocusable",!1)}}function le(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"button",39,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(3).insertHorizontalRule()}),i.qZA()}if(2&m){const M=i.oxw(2).ngIf;i.Q6J("tuiHint",M.insertHorizontalRule)("tuiHintDescribe","")("focusable",!1)}}function xe(m,v){if(1&m&&(i.TgZ(0,"div",6),i.YNc(1,ne,1,0,"tui-code",11),i.YNc(2,Ee,2,3,"button",31),i.YNc(3,_e,5,4,"div",32),i.YNc(4,le,2,3,"button",33),i.qZA()),2&m){const M=i.oxw(2);i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Code)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Tex)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Img)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.HR))}}function ce(m,v){if(1&m){const M=i.EpF();i.TgZ(0,"div",6),i.TgZ(1,"button",40,17),i.NdJ("click",function(){return i.CHM(M),i.oxw(2).removeFormat()}),i.qZA(),i.qZA()}if(2&m){const M=i.oxw().ngIf;i.xp6(1),i.Q6J("tuiHint",M.clear)("tuiHintDescribe","")("focusable",!1)}}function ge(m,v){1&m&&(i.TgZ(0,"div",6),i._UZ(1,"tui-details",41),i._UZ(2,"tui-details-remove",41),i.qZA())}function Vt(m,v){1&m&&(i.TgZ(0,"div",6),i._UZ(1,"tui-editor-group-tool",41),i.qZA())}function de(m,v){if(1&m&&(i.TgZ(0,"div",6),i._UZ(1,"tui-table-create",41),i._UZ(2,"tui-table-row-column-manager",41),i._UZ(3,"tui-table-merge-cells",41),i._UZ(4,"tui-table-cell-color",30),i.qZA()),2&m){const M=i.oxw(2);i.xp6(4),i.Q6J("colors",M.colors)}}function St(m,v){if(1&m&&(i.TgZ(0,"section",4),i.YNc(1,q,3,8,"div",5),i.YNc(2,xt,2,0,"div",5),i.YNc(3,te,7,6,"div",5),i.YNc(4,ie,3,2,"div",5),i.YNc(5,me,3,2,"div",5),i.YNc(6,xe,5,4,"div",5),i.YNc(7,ce,3,3,"div",5),i.YNc(8,ge,3,0,"div",5),i.YNc(9,Vt,2,0,"div",5),i.YNc(10,de,5,1,"div",5),i.TgZ(11,"div",6),i.Hsn(12),i.qZA(),i.qZA()),2&m){const M=i.oxw();i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Undo)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Size)),i.xp6(1),i.Q6J("ngIf",M.firstBigBlockEnabled),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Sub)||M.enabled(M.TuiEditorTool.Sup)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Color)||M.enabled(M.TuiEditorTool.Hilite)),i.xp6(1),i.Q6J("ngIf",M.secondBigBlockEnabled),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Clear)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Details)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Group)),i.xp6(1),i.Q6J("ngIf",M.enabled(M.TuiEditorTool.Table))}}class qt{constructor(v,M,I,K,it){this.elementRef=v,this.editor=M,this.imageLoader=I,this.texts$=K,this.defaultOptions=it,this.dropdowns=D.EMPTY_QUERY,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new i.vpe,this.texClicked=new i.vpe,this.attachClicked=new i.vpe,this.TuiEditorTool=T._,this.toolsSet=new Set(w.Db)}set tools(v){this.toolsSet=new Set(v)}get focused(){return(0,D.tuiIsNativeFocusedIn)(this.elementRef.nativeElement)||!!this.dropdowns.find(({nativeElement:v})=>(0,D.tuiIsNativeFocusedIn)(v))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(T._.Bold)||this.enabled(T._.Italic)||this.enabled(T._.Underline)||this.enabled(T._.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(T._.Align)||this.enabled(T._.List)||this.enabled(T._.Quote)||this.enabled(T._.Link)||this.enabled(T._.Attach)}get secondBigBlockEnabled(){return this.enabled(T._.Code)||this.enabled(T._.Tex)||this.enabled(T._.Img)||this.enabled(T._.HR)}onMouseDown(v,M){M.closest("button")||(v.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage(v){var M;const I=null===(M=v.files)||void 0===M?void 0:M[0];v.value="",I&&this.imageLoader(I).pipe((0,G.q)(1)).subscribe(K=>{this.addImage(K)})}onAttach(){this.attachClicked.emit()}onTeX(){this.texClicked.emit()}onLink(v,M){v.open=!1,M&&(this.editor.toggleLink(M),this.editor.selectClosest())}enabled(v){return this.toolsSet.has(v)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage(v){this.editor.setImage(v)}focusFirst(){var v;const M=null===(v=this.navigationManager)||void 0===v?void 0:v.findFirstFocusableTool();M&&M.focus()}focusLast(){var v;const M=null===(v=this.navigationManager)||void 0===v?void 0:v.findFirstFocusableTool(!0);M&&M.focus()}}qt.\u0275fac=function(v){return new(v||qt)(i.Y36(i.SBq,8),i.Y36(x.$3),i.Y36(Q.p7),i.Y36(Q.rf),i.Y36(Q.mJ))},qt.\u0275cmp=i.Xpm({type:qt,selectors:[["tui-toolbar"]],viewQuery:function(v,M){if(1&v&&(i.Gf($.B,5),i.Gf(B,5,i.SBq)),2&v){let I;i.iGM(I=i.CRH())&&(M.navigationManager=I.first),i.iGM(I=i.CRH())&&(M.dropdowns=I)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function(v,M){1&v&&i.NdJ("mousedown",function(K){return M.onMouseDown(K,K.target)}),2&v&&i.ekj("_disabled",M.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",attachClicked:"attachClicked"},ngContentSelectors:["*"],decls:7,vars:8,consts:[[1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiItem","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiItem","",1,"t-tool","t-wrapper"],["tuiItem","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiItem","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click"],["button",""],["tuiItem","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiItem","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImgLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-tool","t-tool_margin"]],template:function(v,M){1&v&&(i.F$t(),i._UZ(0,"button",0),i.YNc(1,z,1,0,"ng-container",1),i.ALo(2,"async"),i.TgZ(3,"div",2),i.NdJ("focus",function(){return M.onTopFocus()}),i.qZA(),i.TgZ(4,"div",2),i.NdJ("focus",function(){return M.onBottomFocus()}),i.qZA(),i.YNc(5,St,13,10,"section",3),i.ALo(6,"async")),2&v&&(i.xp6(1),i.Q6J("ngIf",i.lcZ(2,4,M.editor.stateChange$)),i.xp6(2),i.Q6J("tuiFocusable",M.focusable),i.xp6(1),i.Q6J("tuiFocusable",M.focusable),i.xp6(1),i.Q6J("ngIf",i.lcZ(6,6,M.texts$)))},directives:[ct.O5,X.t,$.B,gt.v,ot.w,dt.D,Mt.x,vt.t,Tt.D,Z.$,U.m,V.h,H.X,ht.w,at.o,ft.l,Ct.G,lt.U,Ot.T,Pt.y,Bt.U,tt.d,b.l,F._,J.Y,ut.p],pipes:[ct.Ov],styles:['.t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:"";display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}button.t-tool[_ngcontent-%COMP%]:hover, .t-tool[_ngcontent-%COMP%]     button:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:none;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-color-edit{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),(0,C.gn)([(0,D.tuiDefaultProp)()],qt.prototype,"colors",void 0),(0,C.gn)([(0,D.tuiDefaultProp)()],qt.prototype,"disabled",void 0),(0,C.gn)([(0,D.tuiDefaultProp)(function(m){return!m.includes(T._.Tex)&&!m.includes(T._.Attach)},"Attach and TeX are not yet implemented in Editor")],qt.prototype,"tools",null)},19074:(It,pt,c)=>{c.d(pt,{hK:()=>i,sw:()=>C,Db:()=>x,RR:()=>T});const C=new Map([["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),i="rgb(51, 51, 51)";var w=c(48699);const x=[w._.Undo,w._.Size,w._.Bold,w._.Italic,w._.Underline,w._.Align,w._.List,w._.Quote,w._.Link,w._.Color,w._.Hilite,w._.Clear,w._.Strikethrough,w._.Code,w._.Img,w._.HR,w._.Sup,w._.Sub,w._.Table,w._.Details];function T(Q){return[{px:13,name:Q.small},{px:15,name:Q.normal},{px:17,name:Q.large},{px:24,family:"var(--tui-font-heading)",name:Q.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:Q.title,headingLevel:1,weight:"bold"}]}},60153:(It,pt,c)=>{c.d(pt,{Z:()=>i});var C=c(74788);let i=(()=>{class w{constructor(){this.imagePreview=new C.vpe}click(T){T instanceof HTMLImageElement&&this.imagePreview.emit(T)}}return w.\u0275fac=function(T){return new(T||w)},w.\u0275dir=C.lG2({type:w,selectors:[["tui-editor-socket","imagePreview",""]],hostAttrs:[1,"_preview-image"],hostBindings:function(T,Q){1&T&&C.NdJ("click",function(G){return Q.click(G.target)})},outputs:{imagePreview:"imagePreview"}}),w})()},40632:(It,pt,c)=>{c.d(pt,{Zj:()=>C.Z,BN:()=>w,JU:()=>x.J,mJ:()=>T,$3:()=>Q.$});var C=c(60153),i=c(74788);let w=(()=>{class D{}return D.\u0275fac=function($){return new($||D)},D.\u0275mod=i.oAB({type:D}),D.\u0275inj=i.cJS({}),D})();var x=c(74982);let T=(()=>{class D{}return D.\u0275fac=function($){return new($||D)},D.\u0275mod=i.oAB({type:D}),D.\u0275inj=i.cJS({}),D})();var Q=c(17804)},74982:(It,pt,c)=>{c.d(pt,{J:()=>Q});var C=c(74788),i=c(62842),w=c(36692),x=c(46782),T=c(17804);let Q=(()=>{class D{constructor($,ct,X,gt,ot,dt){this.elementRef=$,this.renderer=ct,this.editor=X,this.editorContainer=gt,this.editorLoaded$=ot,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,this.editorLoaded$.pipe((0,x.R)(dt)).subscribe(()=>{this.renderer.appendChild(this.elementRef.nativeElement,this.editorContainer)})}set value($){$!==this.editor.html&&this.editor.setValue($)}set editable($){this.editor.editable=$}}return D.\u0275fac=function($){return new($||D)(C.Y36(C.SBq),C.Y36(C.Qsj),C.Y36(T.$),C.Y36(i.Y1),C.Y36(i.ZW),C.Y36(w.TuiDestroyService))},D.\u0275dir=C.lG2({type:D,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[C._Bn([w.TuiDestroyService])]}),D})()},17804:(It,pt,c)=>{c.d(pt,{$:()=>ct});var C=c(79765),i=c(74788);let w=(()=>{class X{constructor(){this.stateChange$=new C.xQ,this.valueChange$=new C.xQ}}return X.\u0275fac=function(ot){return new(ot||X)},X.\u0275dir=i.lG2({type:X}),X})();var x=c(62842),T=c(37631),Q=c(39761),D=c(88002),G=c(87519);let ct=(()=>{class X extends w{constructor(ot){super(),this.editorRef=ot,this.editorRef.subscribe(dt=>{this.editor=dt,dt.on("transaction",()=>{this.stateChange$.next()}),dt.on("update",()=>{const Mt=dt.getHTML(),Tt=function(X){return Array.isArray(X)&&1===X.length&&!X[0].hasOwnProperty("content")}(dt.getJSON().content)?"":Mt;this.valueChange$.next(Tt)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(ot){this.editor.setEditable(ot)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||"rgb(51, 51, 51)"}getBackgroundColor(){var ot;return(null===(ot=this.editor)||void 0===ot?void 0:ot.getAttributes("textStyle").backgroundColor)||"rgb(51, 51, 51)"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}onAlign(ot){this.editor.chain().focus().setTextAlign(ot).run()}setImage(ot){this.editor.chain().focus().first(({commands:dt})=>[()=>{var Mt;return(null===(Mt=dt.setEditableImage)||void 0===Mt?void 0:Mt.call(dt,{src:ot}))||!1},()=>dt.setImage({src:ot})]).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(ot){this.editor.chain().focus().setFontColor(ot).run()}setBackgroundColor(ot){this.editor.chain().focus().setBackgroundColor(ot).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(ot){return this.editor.isActive(ot)}isActive$(ot){return this.stateChange$.pipe((0,Q.O)(null),(0,D.U)(()=>this.isActive(ot)),(0,G.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(ot,dt){this.editor.chain().focus().insertTable({cols:ot,rows:dt}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(ot){this.editor.chain().focus().setHeading({level:ot}).run()}setParagraph(ot){this.editor.chain().focus().setParagraph().run(),ot&&this.editor.chain().setMark("textStyle",ot).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(ot){this.editor.commands.setTextSelection(ot)}toggleLink(ot){this.editor.chain().focus().toggleLink({href:ot}).run()}setLink(ot){this.editor.chain().focus().setLink({href:ot}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}focus(){this.editor.chain().focus().run()}setValue(ot){this.editor.commands.setContent(ot)}destroy(){this.editor.destroy()}setCellColor(ot){this.editor.chain().focus().setCellBackground(ot).run()}selectClosest(){const ot=this.editor.state.selection.anchor,{schema:dt,doc:Mt}=this.editor.state,vt=(0,T.Yz)(Mt.resolve(ot),dt.marks.link);vt&&this.editor.chain().setTextSelection(vt).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}setGroup(){this.editor.commands.setGroup()}removeGroup(){this.editor.commands.removeGroup()}}return X.\u0275fac=function(ot){return new(ot||X)(i.LFG(x.ZW))},X.\u0275prov=i.Yz7({token:X,factory:X.\u0275fac}),X})()},48699:(It,pt,c)=>{c.d(pt,{_:()=>C});var C=(()=>{return(i=C||(C={})).Undo="undo",i.Size="fontSize",i.Bold="bold",i.Italic="italic",i.Underline="underline",i.Strikethrough="strikeThrough",i.Align="justify",i.List="list",i.Quote="quote",i.Color="foreColor",i.Hilite="hiliteColor",i.Clear="clear",i.Link="link",i.Attach="attach",i.Tex="tex",i.Code="code",i.Img="image",i.HR="insertHorizontalRule",i.Sup="superscript",i.Sub="subscript",i.Table="insertTable",i.MergeCells="mergeCells",i.SplitCells="splitCells",i.RowsColumnsManaging="rowsColumnsManaging",i.Details="details",i.Group="group",C;var i})()},15736:(It,pt,c)=>{c.r(pt),c.d(pt,{BackgroundColor:()=>w}),c(74634);const w=c(40256).Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:x})=>x?{style:`background-color: ${x}`}:{},parseHTML:({style:x})=>x.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:x=>({chain:T})=>T().setMark("textStyle",{backgroundColor:x}).run(),unsetBackgroundColor:()=>({chain:x})=>x().setMark("textStyle",{backgroundColor:null}).run()})})},52658:(It,pt,c)=>{c.r(pt),c.d(pt,{FontColor:()=>w}),c(74634);const w=c(40256).Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:x})=>x?{style:`color: ${x}`}:{},parseHTML:({style:x})=>x.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:x=>({chain:T})=>T().setMark("textStyle",{fontColor:x}).run(),unsetFontColor:()=>({chain:x})=>x().setMark("textStyle",{fontColor:null}).run()})})},9492:(It,pt,c)=>{c.r(pt),c.d(pt,{TuiFontSize:()=>w}),c(74634);const w=c(40256).Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:x})=>x.fontSize,renderHTML:({fontSize:x})=>x?{style:`font-size: ${x}`}:{}}}}]},addCommands:()=>({setFontSize:x=>({chain:T})=>T().setMark("textStyle",{fontSize:x}).run(),unsetFontSize:()=>({chain:x})=>x().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})})},54920:(It,pt,c)=>{c.r(pt),c.d(pt,{TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>w,createGroupExtension:()=>x});var C=c(37631),i=c(40256);const w={groupNodeClass:"tui-group-node",groupPointerNodeClass:"tui-group-pointer",nested:!0,draggable:!0,createOnEnter:!1},x=(T={})=>{const{draggable:Q,nested:D,groupNodeClass:G,groupPointerNodeClass:$,createOnEnter:ct}=Object.assign(Object.assign({},w),T);return i.Node.create({name:"group",draggable:Q,group:"block",content:D?"block+":"block",parseHTML:()=>[{tag:'div[data-type="group"]'}],renderHTML:({HTMLAttributes:X})=>["div",(0,i.mergeAttributes)(X,{"data-type":"group"}),0],addNodeView:()=>()=>{const X=document.createElement("div"),gt=document.createElement("div");if(X.classList.add(G),gt.setAttribute("data-type","group"),Q){const ot=document.createElement("div");ot.classList.add($),ot.innerHTML="",ot.contentEditable="false",X.append(ot,gt)}else X.append(gt);return{dom:X,contentDOM:gt}},addCommands(){return{setGroup:()=>({commands:X,state:gt})=>{this.editor.chain().focus().run();const ot=(0,C.Ap)(gt,""),Mt=`<div data-type="group">${ot.trim().startsWith("<p>")?ot:`<p>${ot}</p>`}</div>`;return X.insertContent(Mt)},removeGroup:()=>({state:X,dispatch:gt})=>(0,C.yU)(X,gt,this.name)}},addKeyboardShortcuts(){return ct?{Enter:()=>this.editor.commands.setGroup()}:{}}})}},25039:(It,pt,c)=>{c.r(pt),c.d(pt,{TUI_EDITOR_MAX_IMAGE_WIDTH:()=>$,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>G,TuiImageEditorComponent:()=>ct,TuiImageEditorModule:()=>Mt,createImageEditorExtension:()=>dt});var C=c(12057),i=c(74788),w=c(40400),x=c(36692),T=c(66682),Q=c(46782),D=c(60015);const G=new i.OlP("[TUI_EDITOR_MIN_IMAGE_WIDTH]: Min size of resizable image inside editor",{factory:()=>100}),$=new i.OlP("[TUI_EDITOR_MAX_IMAGE_WIDTH]: Max size of resizable image inside editor",{factory:()=>1/0});let ct=(()=>{class vt extends w.d{constructor(Z,U,V,H){super(),this.minWidth=Z,this.maxWidth=U,this.documentRef=V,this.destroy$=H,this._width=0,(0,T.T)((0,x.tuiTypedFromEvent)(this.documentRef,"touchend"),(0,x.tuiTypedFromEvent)(this.documentRef,"mouseup")).pipe((0,Q.R)(H)).subscribe(()=>this.updateAttributes({width:this.width}))}get attrs(){var Z;return(null===(Z=this.node)||void 0===Z?void 0:Z.attrs)||{src:""}}get src(){return this.attrs.src}get width(){return this._width||this.attrs.width||0}get alt(){return this.attrs.alt||""}get title(){return this.attrs.title||""}onHorizontalDrag([Z],U){this._width=Math.max(this.minWidth,Math.min(this.maxWidth,this.width+U*Z))}}return vt.\u0275fac=function(Z){return new(Z||vt)(i.Y36(G),i.Y36($),i.Y36(C.K0),i.Y36(x.TuiDestroyService))},vt.\u0275cmp=i.Xpm({type:vt,selectors:[["tui-image-editor"]],features:[i._Bn([x.TuiDestroyService]),i.qOj],decls:3,vars:8,consts:[[3,"src","width","alt","title"],[1,"t-border","t-border_right",3,"tuiPan"],[1,"t-border","t-border_left",3,"tuiPan"]],template:function(Z,U){1&Z&&(i._UZ(0,"img",0),i.TgZ(1,"span",1),i.NdJ("tuiPan",function(H){return U.onHorizontalDrag(H,1)}),i.qZA(),i.TgZ(2,"span",2),i.NdJ("tuiPan",function(H){return U.onHorizontalDrag(H,-1)}),i.qZA()),2&Z&&(i.Udp("min-width",U.minWidth,"px")("max-width",U.maxWidth,"px"),i.Q6J("src",U.src,i.LSH)("width",U.width)("alt",U.alt)("title",U.title))},directives:[D.g],styles:['[_nghost-%COMP%]{position:relative;display:inline-block}[_nghost-%COMP%]:hover   .t-border[_ngcontent-%COMP%]:after{opacity:1}.t-border[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;display:flex;width:.75rem;cursor:col-resize;justify-content:center;align-items:center}.t-border_left[_ngcontent-%COMP%]{left:0}.t-border_right[_ngcontent-%COMP%]{right:0}.t-border[_ngcontent-%COMP%]:after{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;content:"";width:50%;height:33%;box-sizing:border-box;border-radius:var(--tui-radius-m);background:var(--tui-base-08);border:1px solid var(--tui-base-03);opacity:0}'],changeDetection:0}),vt})();var X=c(40256);const gt=[{tag:'img[data-type="image-editor"]'}],ot={src:{default:"",keepOnSplit:!1},width:{default:300,keepOnSplit:!1},alt:{default:"",keepOnSplit:!1},title:{default:"",keepOnSplit:!1}},dt=vt=>X.Node.create({name:"imageEditor",group:"block",atom:!0,draggable:!0,parseHTML:()=>gt,addAttributes:()=>ot,renderHTML:({HTMLAttributes:Tt})=>["img",(0,X.mergeAttributes)(Tt,{"data-type":"image-editor"})],addNodeView:()=>(0,w.x)(ct,{injector:vt}),addCommands(){return{setEditableImage:Tt=>({commands:Z})=>Z.insertContent({type:this.name,attrs:Tt})}}});let Mt=(()=>{class vt{}return vt.\u0275fac=function(Z){return new(Z||vt)},vt.\u0275mod=i.oAB({type:vt}),vt.\u0275inj=i.cJS({imports:[[C.ez,x.TuiPanModule]]}),vt})()},12177:(It,pt,c)=>{function i(x){return x.isActive("bulletList")||x.isActive("orderedList")}c.r(pt),c.d(pt,{TuiTabExtension:()=>w,tuiIsOrderedOrBulletList:()=>i});const w=c(40256).Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>i(this.editor)?null:this.editor.commands.insertContent("\t")}}})},75276:(It,pt,c)=>{c.r(pt),c.d(pt,{StarterKit:()=>_t});var C=c(40256);const i=/^\s*>\s$/,w=C.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:k}){return["blockquote",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setBlockquote:()=>({commands:k})=>k.wrapIn(this.name),toggleBlockquote:()=>({commands:k})=>k.toggleWrap(this.name),unsetBlockquote:()=>({commands:k})=>k.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,C.wrappingInputRule)({find:i,type:this.type})]}}),x=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,T=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Q=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,D=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,G=C.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:k=>"normal"!==k.style.fontWeight&&null},{style:"font-weight",getAttrs:k=>/^(bold(er)?|[5-9]\d{2,})$/.test(k)&&null}],renderHTML({HTMLAttributes:k}){return["strong",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setBold:()=>({commands:k})=>k.setMark(this.name),toggleBold:()=>({commands:k})=>k.toggleMark(this.name),unsetBold:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,C.markInputRule)({find:x,type:this.type}),(0,C.markInputRule)({find:Q,type:this.type})]},addPasteRules(){return[(0,C.markPasteRule)({find:T,type:this.type}),(0,C.markPasteRule)({find:D,type:this.type})]}}),$=/^\s*([-+*])\s$/,ct=C.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:k}){return["ul",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{toggleBulletList:()=>({commands:k})=>k.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[(0,C.wrappingInputRule)({find:$,type:this.type})]}}),X=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,gt=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,ot=C.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:k}){return["code",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setCode:()=>({commands:k})=>k.setMark(this.name),toggleCode:()=>({commands:k})=>k.toggleMark(this.name),unsetCode:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,C.markInputRule)({find:X,type:this.type})]},addPasteRules(){return[(0,C.markPasteRule)({find:gt,type:this.type})]}});var dt=c(62463);const Mt=/^```([a-z]+)?[\s\n]$/,vt=/^~~~([a-z]+)?[\s\n]$/,Tt=C.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:k=>{var A;const{languageClassPrefix:W}=this.options;return[...(null===(A=k.firstElementChild)||void 0===A?void 0:A.classList)||[]].filter(Et=>Et.startsWith(W)).map(Et=>Et.replace(W,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:k,HTMLAttributes:A}){return["pre",(0,C.mergeAttributes)(this.options.HTMLAttributes,A),["code",{class:k.attrs.language?this.options.languageClassPrefix+k.attrs.language:null},0]]},addCommands(){return{setCodeBlock:k=>({commands:A})=>A.setNode(this.name,k),toggleCodeBlock:k=>({commands:A})=>A.toggleNode(this.name,"paragraph",k)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:k,$anchor:A}=this.editor.state.selection;return!(!k||A.parent.type.name!==this.name)&&!(1!==A.pos&&A.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:k})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:A}=k,{selection:W}=A,{$from:et,empty:rt}=W;if(!rt||et.parent.type!==this.type)return!1;const bt=et.parentOffset===et.parent.nodeSize-2,Et=et.parent.textContent.endsWith("\n\n");return!(!bt||!Et)&&k.chain().command(({tr:Lt})=>(Lt.delete(et.pos-2,et.pos),!0)).exitCode().run()},ArrowDown:({editor:k})=>{if(!this.options.exitOnArrowDown)return!1;const{state:A}=k,{selection:W,doc:et}=A,{$from:rt,empty:bt}=W;if(!bt||rt.parent.type!==this.type||rt.parentOffset!==rt.parent.nodeSize-2)return!1;const Lt=rt.after();return void 0!==Lt&&!et.nodeAt(Lt)&&k.commands.exitCode()}}},addInputRules(){return[(0,C.textblockTypeInputRule)({find:Mt,type:this.type,getAttributes:k=>({language:k[1]})}),(0,C.textblockTypeInputRule)({find:vt,type:this.type,getAttributes:k=>({language:k[1]})})]},addProseMirrorPlugins(){return[new dt.Sy({key:new dt.H$("codeBlockVSCodeHandler"),props:{handlePaste:(k,A)=>{if(!A.clipboardData||this.editor.isActive(this.type.name))return!1;const W=A.clipboardData.getData("text/plain"),et=A.clipboardData.getData("vscode-editor-data"),rt=et?JSON.parse(et):void 0,bt=null==rt?void 0:rt.mode;if(!W||!bt)return!1;const{tr:Et}=k.state;return Et.replaceSelectionWith(this.type.create({language:bt})),Et.setSelection(dt.Bs.near(Et.doc.resolve(Math.max(0,Et.selection.from-2)))),Et.insertText(W.replace(/\r\n?/g,"\n")),Et.setMeta("paste",!0),k.dispatch(Et),!0}}})]}}),Z=C.Node.create({name:"doc",topNode:!0,content:"block+"});var U=c(38480);function V(k={}){return new dt.Sy({view:A=>new H(A,k)})}class H{constructor(A,W){this.editorView=A,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=W.width||1,this.color=W.color||"black",this.class=W.class,this.handlers=["dragover","dragend","drop","dragleave"].map(et=>{let rt=bt=>{this[et](bt)};return A.dom.addEventListener(et,rt),{name:et,handler:rt}})}destroy(){this.handlers.forEach(({name:A,handler:W})=>this.editorView.dom.removeEventListener(A,W))}update(A,W){null!=this.cursorPos&&W.doc!=A.state.doc&&(this.cursorPos>A.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(A){A!=this.cursorPos&&(this.cursorPos=A,null==A?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let W,A=this.editorView.state.doc.resolve(this.cursorPos);if(!A.parent.inlineContent){let Et=A.nodeBefore,Lt=A.nodeAfter;if(Et||Lt){let Ht=this.editorView.nodeDOM(this.cursorPos-(Et?Et.nodeSize:0)).getBoundingClientRect(),Ft=Et?Ht.bottom:Ht.top;Et&&Lt&&(Ft=(Ft+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),W={left:Ht.left,right:Ht.right,top:Ft-this.width/2,bottom:Ft+this.width/2}}}if(!W){let Et=this.editorView.coordsAtPos(this.cursorPos);W={left:Et.left-this.width/2,right:Et.left+this.width/2,top:Et.top,bottom:Et.bottom}}let rt,bt,et=this.editorView.dom.offsetParent;if(this.element||(this.element=et.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!et||et==document.body&&"static"==getComputedStyle(et).position)rt=-pageXOffset,bt=-pageYOffset;else{let Et=et.getBoundingClientRect();rt=Et.left-et.scrollLeft,bt=Et.top-et.scrollTop}this.element.style.left=W.left-rt+"px",this.element.style.top=W.top-bt+"px",this.element.style.width=W.right-W.left+"px",this.element.style.height=W.bottom-W.top+"px"}scheduleRemoval(A){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),A)}dragover(A){if(!this.editorView.editable)return;let W=this.editorView.posAtCoords({left:A.clientX,top:A.clientY}),et=W&&W.inside>=0&&this.editorView.state.doc.nodeAt(W.inside),rt=et&&et.type.spec.disableDropCursor,bt="function"==typeof rt?rt(this.editorView,W):rt;if(W&&!bt){let Et=W.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(Et=(0,U.nj)(this.editorView.state.doc,Et,this.editorView.dragging.slice),null==Et))return this.setCursor(null);this.setCursor(Et),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(A){(A.target==this.editorView.dom||!this.editorView.dom.contains(A.relatedTarget))&&this.setCursor(null)}}const ht=C.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[V(this.options)]}});var at=c(13903),ft=c(35917),Ct=c(43594);class lt extends dt.Y1{constructor(A){super(A,A)}map(A,W){let et=A.resolve(W.map(this.head));return lt.valid(et)?new lt(et):dt.Y1.near(et)}content(){return ft.p2.empty}eq(A){return A instanceof lt&&A.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(A,W){if("number"!=typeof W.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new lt(A.resolve(W.pos))}getBookmark(){return new Ot(this.anchor)}static valid(A){let W=A.parent;if(W.isTextblock||!function(k){for(let A=k.depth;A>=0;A--){let W=k.index(A),et=k.node(A);if(0!=W)for(let rt=et.child(W-1);;rt=rt.lastChild){if(0==rt.childCount&&!rt.inlineContent||rt.isAtom||rt.type.spec.isolating)return!0;if(rt.inlineContent)return!1}else if(et.type.spec.isolating)return!0}return!0}(A)||!function(k){for(let A=k.depth;A>=0;A--){let W=k.indexAfter(A),et=k.node(A);if(W!=et.childCount)for(let rt=et.child(W);;rt=rt.firstChild){if(0==rt.childCount&&!rt.inlineContent||rt.isAtom||rt.type.spec.isolating)return!0;if(rt.inlineContent)return!1}else if(et.type.spec.isolating)return!0}return!0}(A))return!1;let et=W.type.spec.allowGapCursor;if(null!=et)return et;let rt=W.contentMatchAt(A.index()).defaultType;return rt&&rt.isTextblock}static findGapCursorFrom(A,W,et=!1){t:for(;;){if(!et&&lt.valid(A))return A;let rt=A.pos,bt=null;for(let Et=A.depth;;Et--){let Lt=A.node(Et);if(W>0?A.indexAfter(Et)<Lt.childCount:A.index(Et)>0){bt=Lt.child(W>0?A.indexAfter(Et):A.index(Et)-1);break}if(0==Et)return null;rt+=W;let Ht=A.doc.resolve(rt);if(lt.valid(Ht))return Ht}for(;;){let Et=W>0?bt.firstChild:bt.lastChild;if(!Et){if(bt.isAtom&&!bt.isText&&!dt.qv.isSelectable(bt)){A=A.doc.resolve(rt+bt.nodeSize*W),et=!1;continue t}break}bt=Et,rt+=W;let Lt=A.doc.resolve(rt);if(lt.valid(Lt))return Lt}return null}}}lt.prototype.visible=!1,lt.findFrom=lt.findGapCursorFrom,dt.Y1.jsonID("gapcursor",lt);class Ot{constructor(A){this.pos=A}map(A){return new Ot(A.map(this.pos))}resolve(A){let W=A.resolve(this.pos);return lt.valid(W)?new lt(W):dt.Y1.near(W)}}const b=(0,at.$)({ArrowLeft:F("horiz",-1),ArrowRight:F("horiz",1),ArrowUp:F("vert",-1),ArrowDown:F("vert",1)});function F(k,A){const W="vert"==k?A>0?"down":"up":A>0?"right":"left";return function(et,rt,bt){let Et=et.selection,Lt=A>0?Et.$to:Et.$from,Ht=Et.empty;if(Et instanceof dt.Bs){if(!bt.endOfTextblock(W)||0==Lt.depth)return!1;Ht=!1,Lt=et.doc.resolve(A>0?Lt.after():Lt.before())}let Ft=lt.findGapCursorFrom(Lt,A,Ht);return!!Ft&&(rt&&rt(et.tr.setSelection(new lt(Ft))),!0)}}function J(k,A,W){if(!k||!k.editable)return!1;let et=k.state.doc.resolve(A);if(!lt.valid(et))return!1;let rt=k.posAtCoords({left:W.clientX,top:W.clientY});return!(rt&&rt.inside>-1&&dt.qv.isSelectable(k.state.doc.nodeAt(rt.inside))||(k.dispatch(k.state.tr.setSelection(new lt(et))),0))}function ut(k,A){if("insertCompositionText"!=A.inputType||!(k.state.selection instanceof lt))return!1;let{$from:W}=k.state.selection,et=W.parent.contentMatchAt(W.index()).findWrapping(k.state.schema.nodes.text);if(!et)return!1;let rt=ft.HY.empty;for(let Et=et.length-1;Et>=0;Et--)rt=ft.HY.from(et[Et].createAndFill(null,rt));let bt=k.state.tr.replace(W.pos,W.pos,new ft.p2(rt,0,0));return bt.setSelection(dt.Bs.near(bt.doc.resolve(W.pos+1))),k.dispatch(bt),!1}function B(k){if(!(k.selection instanceof lt))return null;let A=document.createElement("div");return A.className="ProseMirror-gapcursor",Ct.EH.create(k.doc,[Ct.p.widget(k.selection.head,A,{key:"gapcursor"})])}const z=C.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new dt.Sy({props:{decorations:B,createSelectionBetween:(k,A,W)=>A.pos==W.pos&&lt.valid(W)?new lt(W):null,handleClick:J,handleKeyDown:b,handleDOMEvents:{beforeinput:ut}}})],extendNodeSchema(k){var A;return{allowGapCursor:null!==(A=(0,C.callOrReturn)((0,C.getExtensionField)(k,"allowGapCursor",{name:k.name,options:k.options,storage:k.storage})))&&void 0!==A?A:null}}}),q=C.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:k}){return["br",(0,C.mergeAttributes)(this.options.HTMLAttributes,k)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:k,chain:A,state:W,editor:et})=>k.first([()=>k.exitCode(),()=>k.command(()=>{const{selection:rt,storedMarks:bt}=W;if(rt.$from.parent.type.spec.isolating)return!1;const{keepMarks:Et}=this.options,{splittableMarks:Lt}=et.extensionManager,Ht=bt||rt.$to.parentOffset&&rt.$from.marks();return A().insertContent({type:this.name}).command(({tr:Ft,dispatch:zt})=>{if(zt&&Ht&&Et){const Jt=Ht.filter(Kt=>Lt.includes(Kt.type.name));Ft.ensureMarks(Jt)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),xt=C.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(k=>({tag:`h${k}`,attrs:{level:k}}))},renderHTML({node:k,HTMLAttributes:A}){return[`h${this.options.levels.includes(k.attrs.level)?k.attrs.level:this.options.levels[0]}`,(0,C.mergeAttributes)(this.options.HTMLAttributes,A),0]},addCommands(){return{setHeading:k=>({commands:A})=>!!this.options.levels.includes(k.level)&&A.setNode(this.name,k),toggleHeading:k=>({commands:A})=>!!this.options.levels.includes(k.level)&&A.toggleNode(this.name,"paragraph",k)}},addKeyboardShortcuts(){return this.options.levels.reduce((k,A)=>Oe(wt({},k),{[`Mod-Alt-${A}`]:()=>this.editor.commands.toggleHeading({level:A})}),{})},addInputRules(){return this.options.levels.map(k=>(0,C.textblockTypeInputRule)({find:new RegExp(`^(#{1,${k}})\\s$`),type:this.type,getAttributes:{level:k}}))}});var Rt=function(){};Rt.prototype.append=function(A){return A.length?(A=Rt.from(A),!this.length&&A||A.length<200&&this.leafAppend(A)||this.length<200&&A.leafPrepend(this)||this.appendInner(A)):this},Rt.prototype.prepend=function(A){return A.length?Rt.from(A).append(this):this},Rt.prototype.appendInner=function(A){return new Zt(this,A)},Rt.prototype.slice=function(A,W){return void 0===A&&(A=0),void 0===W&&(W=this.length),A>=W?Rt.empty:this.sliceInner(Math.max(0,A),Math.min(this.length,W))},Rt.prototype.get=function(A){if(!(A<0||A>=this.length))return this.getInner(A)},Rt.prototype.forEach=function(A,W,et){void 0===W&&(W=0),void 0===et&&(et=this.length),W<=et?this.forEachInner(A,W,et,0):this.forEachInvertedInner(A,W,et,0)},Rt.prototype.map=function(A,W,et){void 0===W&&(W=0),void 0===et&&(et=this.length);var rt=[];return this.forEach(function(bt,Et){return rt.push(A(bt,Et))},W,et),rt},Rt.from=function(A){return A instanceof Rt?A:A&&A.length?new $t(A):Rt.empty};var $t=function(k){function A(et){k.call(this),this.values=et}k&&(A.__proto__=k),(A.prototype=Object.create(k&&k.prototype)).constructor=A;var W={length:{configurable:!0},depth:{configurable:!0}};return A.prototype.flatten=function(){return this.values},A.prototype.sliceInner=function(rt,bt){return 0==rt&&bt==this.length?this:new A(this.values.slice(rt,bt))},A.prototype.getInner=function(rt){return this.values[rt]},A.prototype.forEachInner=function(rt,bt,Et,Lt){for(var Ht=bt;Ht<Et;Ht++)if(!1===rt(this.values[Ht],Lt+Ht))return!1},A.prototype.forEachInvertedInner=function(rt,bt,Et,Lt){for(var Ht=bt-1;Ht>=Et;Ht--)if(!1===rt(this.values[Ht],Lt+Ht))return!1},A.prototype.leafAppend=function(rt){if(this.length+rt.length<=200)return new A(this.values.concat(rt.flatten()))},A.prototype.leafPrepend=function(rt){if(this.length+rt.length<=200)return new A(rt.flatten().concat(this.values))},W.length.get=function(){return this.values.length},W.depth.get=function(){return 0},Object.defineProperties(A.prototype,W),A}(Rt);Rt.empty=new $t([]);var Zt=function(k){function A(W,et){k.call(this),this.left=W,this.right=et,this.length=W.length+et.length,this.depth=Math.max(W.depth,et.depth)+1}return k&&(A.__proto__=k),(A.prototype=Object.create(k&&k.prototype)).constructor=A,A.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},A.prototype.getInner=function(et){return et<this.left.length?this.left.get(et):this.right.get(et-this.left.length)},A.prototype.forEachInner=function(et,rt,bt,Et){var Lt=this.left.length;if(rt<Lt&&!1===this.left.forEachInner(et,rt,Math.min(bt,Lt),Et)||bt>Lt&&!1===this.right.forEachInner(et,Math.max(rt-Lt,0),Math.min(this.length,bt)-Lt,Et+Lt))return!1},A.prototype.forEachInvertedInner=function(et,rt,bt,Et){var Lt=this.left.length;if(rt>Lt&&!1===this.right.forEachInvertedInner(et,rt-Lt,Math.max(bt,Lt)-Lt,Et+Lt)||bt<Lt&&!1===this.left.forEachInvertedInner(et,Math.min(rt,Lt),bt,Et))return!1},A.prototype.sliceInner=function(et,rt){if(0==et&&rt==this.length)return this;var bt=this.left.length;return rt<=bt?this.left.slice(et,rt):et>=bt?this.right.slice(et-bt,rt-bt):this.left.slice(et,bt).append(this.right.slice(0,rt-bt))},A.prototype.leafAppend=function(et){var rt=this.right.leafAppend(et);if(rt)return new A(this.left,rt)},A.prototype.leafPrepend=function(et){var rt=this.left.leafPrepend(et);if(rt)return new A(rt,this.right)},A.prototype.appendInner=function(et){return this.left.depth>=Math.max(this.right.depth,et.depth)+1?new A(this.left,new A(this.right,et)):new A(this,et)},A}(Rt);const be=Rt;class te{constructor(A,W){this.items=A,this.eventCount=W}popEvent(A,W){if(0==this.eventCount)return null;let rt,bt,et=this.items.length;for(;;et--)if(this.items.get(et-1).selection){--et;break}W&&(rt=this.remapping(et,this.items.length),bt=rt.maps.length);let Lt,Ht,Et=A.tr,Ft=[],zt=[];return this.items.forEach((Jt,Kt)=>{if(!Jt.step)return rt||(rt=this.remapping(et,Kt+1),bt=rt.maps.length),bt--,void zt.push(Jt);if(rt){zt.push(new Xt(Jt.map));let Te,jt=Jt.step.map(rt.slice(bt));jt&&Et.maybeStep(jt).doc&&(Te=Et.mapping.maps[Et.mapping.maps.length-1],Ft.push(new Xt(Te,void 0,void 0,Ft.length+zt.length))),bt--,Te&&rt.appendMap(Te,bt)}else Et.maybeStep(Jt.step);return Jt.selection?(Lt=rt?Jt.selection.map(rt.slice(bt)):Jt.selection,Ht=new te(this.items.slice(0,et).append(zt.reverse().concat(Ft)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:Ht,transform:Et,selection:Lt}}addTransform(A,W,et,rt){let bt=[],Et=this.eventCount,Lt=this.items,Ht=!rt&&Lt.length?Lt.get(Lt.length-1):null;for(let zt=0;zt<A.steps.length;zt++){let jt,Jt=A.steps[zt].invert(A.docs[zt]),Kt=new Xt(A.mapping.maps[zt],Jt,W);(jt=Ht&&Ht.merge(Kt))&&(Kt=jt,zt?bt.pop():Lt=Lt.slice(0,Lt.length-1)),bt.push(Kt),W&&(Et++,W=void 0),rt||(Ht=Kt)}let Ft=Et-et.depth;return Ft>ee&&(Lt=function(k,A){let W;return k.forEach((et,rt)=>{if(et.selection&&0==A--)return W=rt,!1}),k.slice(W)}(Lt,Ft),Et-=Ft),new te(Lt.append(bt),Et)}remapping(A,W){let et=new U.vs;return this.items.forEach((rt,bt)=>{et.appendMap(rt.map,null!=rt.mirrorOffset&&bt-rt.mirrorOffset>=A?et.maps.length-rt.mirrorOffset:void 0)},A,W),et}addMaps(A){return 0==this.eventCount?this:new te(this.items.append(A.map(W=>new Xt(W))),this.eventCount)}rebased(A,W){if(!this.eventCount)return this;let et=[],rt=Math.max(0,this.items.length-W),bt=A.mapping,Et=A.steps.length,Lt=this.eventCount;this.items.forEach(Kt=>{Kt.selection&&Lt--},rt);let Ht=W;this.items.forEach(Kt=>{let jt=bt.getMirror(--Ht);if(null==jt)return;Et=Math.min(Et,jt);let Te=bt.maps[jt];if(Kt.step){let ue=A.steps[jt].invert(A.docs[jt]),Le=Kt.selection&&Kt.selection.map(bt.slice(Ht+1,jt));Le&&Lt++,et.push(new Xt(Te,ue,Le))}else et.push(new Xt(Te))},rt);let Ft=[];for(let Kt=W;Kt<Et;Kt++)Ft.push(new Xt(bt.maps[Kt]));let zt=this.items.slice(0,rt).append(Ft).append(et),Jt=new te(zt,Lt);return Jt.emptyItemCount()>500&&(Jt=Jt.compress(this.items.length-et.length)),Jt}emptyItemCount(){let A=0;return this.items.forEach(W=>{W.step||A++}),A}compress(A=this.items.length){let W=this.remapping(0,A),et=W.maps.length,rt=[],bt=0;return this.items.forEach((Et,Lt)=>{if(Lt>=A)rt.push(Et),Et.selection&&bt++;else if(Et.step){let Ht=Et.step.map(W.slice(et)),Ft=Ht&&Ht.getMap();if(et--,Ft&&W.appendMap(Ft,et),Ht){let zt=Et.selection&&Et.selection.map(W.slice(et));zt&&bt++;let Kt,Jt=new Xt(Ft.invert(),Ht,zt),jt=rt.length-1;(Kt=rt.length&&rt[jt].merge(Jt))?rt[jt]=Kt:rt.push(Jt)}}else Et.map&&et--},this.items.length,0),new te(be.from(rt.reverse()),bt)}}te.empty=new te(be.empty,0);class Xt{constructor(A,W,et,rt){this.map=A,this.step=W,this.selection=et,this.mirrorOffset=rt}merge(A){if(this.step&&A.step&&!A.selection){let W=A.step.merge(this.step);if(W)return new Xt(W.getMap().invert(),W,this.selection)}}}class ie{constructor(A,W,et,rt){this.done=A,this.undone=W,this.prevRanges=et,this.prevTime=rt}}const ee=20;function ne(k){let A=[];return k.forEach((W,et,rt,bt)=>A.push(rt,bt)),A}function Ee(k,A){if(!k)return null;let W=[];for(let et=0;et<k.length;et+=2){let rt=A.map(k[et],1),bt=A.map(k[et+1],-1);rt<=bt&&W.push(rt,bt)}return W}function _e(k,A,W,et){let rt=ce(A),bt=Vt.get(A).spec.config,Et=(et?k.undone:k.done).popEvent(A,rt);if(!Et)return;let Lt=Et.selection.resolve(Et.transform.doc),Ht=(et?k.done:k.undone).addTransform(Et.transform,A.selection.getBookmark(),bt,rt),Ft=new ie(et?Ht:Et.remaining,et?Et.remaining:Ht,null,0);W(Et.transform.setSelection(Lt).setMeta(Vt,{redo:et,historyState:Ft}).scrollIntoView())}let le=!1,xe=null;function ce(k){let A=k.plugins;if(xe!=A){le=!1,xe=A;for(let W=0;W<A.length;W++)if(A[W].spec.historyPreserveItems){le=!0;break}}return le}const Vt=new dt.H$("history"),de=new dt.H$("closeHistory");function St(k={}){return new dt.Sy({key:Vt,state:{init:()=>new ie(te.empty,te.empty,null,0),apply:(A,W,et)=>function(k,A,W,et){let bt,rt=W.getMeta(Vt);if(rt)return rt.historyState;W.getMeta(de)&&(k=new ie(k.done,k.undone,null,0));let Et=W.getMeta("appendedTransaction");if(0==W.steps.length)return k;if(Et&&Et.getMeta(Vt))return Et.getMeta(Vt).redo?new ie(k.done.addTransform(W,void 0,et,ce(A)),k.undone,ne(W.mapping.maps[W.steps.length-1]),k.prevTime):new ie(k.done,k.undone.addTransform(W,void 0,et,ce(A)),null,k.prevTime);if(!1===W.getMeta("addToHistory")||Et&&!1===Et.getMeta("addToHistory"))return(bt=W.getMeta("rebased"))?new ie(k.done.rebased(W,bt),k.undone.rebased(W,bt),Ee(k.prevRanges,W.mapping),k.prevTime):new ie(k.done.addMaps(W.mapping.maps),k.undone.addMaps(W.mapping.maps),Ee(k.prevRanges,W.mapping),k.prevTime);{let Lt=0==k.prevTime||!Et&&(k.prevTime<(W.time||0)-et.newGroupDelay||!function(k,A){if(!A)return!1;if(!k.docChanged)return!0;let W=!1;return k.mapping.maps[0].forEach((et,rt)=>{for(let bt=0;bt<A.length;bt+=2)et<=A[bt+1]&&rt>=A[bt]&&(W=!0)}),W}(W,k.prevRanges)),Ht=Et?Ee(k.prevRanges,W.mapping):ne(W.mapping.maps[W.steps.length-1]);return new ie(k.done.addTransform(W,Lt?A.selection.getBookmark():void 0,et,ce(A)),te.empty,Ht,W.time)}}(W,et,A,k)},config:k={depth:k.depth||100,newGroupDelay:k.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(A,W){let et=W.inputType,rt="historyUndo"==et?Gt:"historyRedo"==et?qt:null;return!!rt&&(W.preventDefault(),rt(A.state,A.dispatch))}}}})}const Gt=(k,A)=>{let W=Vt.getState(k);return!(!W||0==W.done.eventCount||(A&&_e(W,k,A,!1),0))},qt=(k,A)=>{let W=Vt.getState(k);return!(!W||0==W.undone.eventCount||(A&&_e(W,k,A,!0),0))},v=C.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:k,dispatch:A})=>Gt(k,A),redo:()=>({state:k,dispatch:A})=>qt(k,A)}),addProseMirrorPlugins(){return[St(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),M=C.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:k}){return["hr",(0,C.mergeAttributes)(this.options.HTMLAttributes,k)]},addCommands(){return{setHorizontalRule:()=>({chain:k})=>k().insertContent({type:this.name}).command(({tr:A,dispatch:W})=>{var et;if(W){const{$to:rt}=A.selection,bt=rt.end();if(rt.nodeAfter)A.setSelection(dt.Bs.create(A.doc,rt.pos));else{const Et=null===(et=rt.parent.type.contentMatch.defaultType)||void 0===et?void 0:et.create();Et&&(A.insert(bt,Et),A.setSelection(dt.Bs.create(A.doc,bt)))}A.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,C.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),I=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,K=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,it=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,yt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Dt=C.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:k=>"normal"!==k.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:k}){return["em",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setItalic:()=>({commands:k})=>k.setMark(this.name),toggleItalic:()=>({commands:k})=>k.toggleMark(this.name),unsetItalic:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,C.markInputRule)({find:I,type:this.type}),(0,C.markInputRule)({find:it,type:this.type})]},addPasteRules(){return[(0,C.markPasteRule)({find:K,type:this.type}),(0,C.markPasteRule)({find:yt,type:this.type})]}}),S=C.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:k}){return["li",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),r=/^(\d+)\.\s$/,d=C.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:k=>k.hasAttribute("start")?parseInt(k.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:k}){const et=k,{start:A}=et,W=$o(et,["start"]);return 1===A?["ol",(0,C.mergeAttributes)(this.options.HTMLAttributes,W),0]:["ol",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{toggleOrderedList:()=>({commands:k})=>k.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[(0,C.wrappingInputRule)({find:r,type:this.type,getAttributes:k=>({start:+k[1]}),joinPredicate:(k,A)=>A.childCount+A.attrs.start===+k[1]})]}}),g=C.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:k}){return["p",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setParagraph:()=>({commands:k})=>k.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),O=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,P=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,N=C.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:k=>!!k.includes("line-through")&&{}}],renderHTML({HTMLAttributes:k}){return["s",(0,C.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{setStrike:()=>({commands:k})=>k.setMark(this.name),toggleStrike:()=>({commands:k})=>k.toggleMark(this.name),unsetStrike:()=>({commands:k})=>k.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,C.markInputRule)({find:O,type:this.type})]},addPasteRules(){return[(0,C.markPasteRule)({find:P,type:this.type})]}}),nt=C.Node.create({name:"text",group:"inline"}),_t=C.Extension.create({name:"starterKit",addExtensions(){var k,A,W,et,rt,bt,Et,Lt,Ht,Ft,zt,Jt,Kt,jt,Te,ue,Le,$e,We,Ye,rn,sn,Ve,je,Ie,Ne,Qe,He,pe,De,Ge,Se,re,Ue,ke,Xe;const Qt=[];return!1!==(null===(k=this.options)||void 0===k?void 0:k.blockquote)&&Qt.push(w.configure(null===(A=this.options)||void 0===A?void 0:A.blockquote)),!1!==(null===(W=this.options)||void 0===W?void 0:W.bold)&&Qt.push(G.configure(null===(et=this.options)||void 0===et?void 0:et.bold)),!1!==(null===(rt=this.options)||void 0===rt?void 0:rt.bulletList)&&Qt.push(ct.configure(null===(bt=this.options)||void 0===bt?void 0:bt.bulletList)),!1!==(null===(Et=this.options)||void 0===Et?void 0:Et.code)&&Qt.push(ot.configure(null===(Lt=this.options)||void 0===Lt?void 0:Lt.code)),!1!==(null===(Ht=this.options)||void 0===Ht?void 0:Ht.codeBlock)&&Qt.push(Tt.configure(null===(Ft=this.options)||void 0===Ft?void 0:Ft.codeBlock)),!1!==(null===(zt=this.options)||void 0===zt?void 0:zt.document)&&Qt.push(Z.configure(null===(Jt=this.options)||void 0===Jt?void 0:Jt.document)),!1!==(null===(Kt=this.options)||void 0===Kt?void 0:Kt.dropcursor)&&Qt.push(ht.configure(null===(jt=this.options)||void 0===jt?void 0:jt.dropcursor)),!1!==(null===(Te=this.options)||void 0===Te?void 0:Te.gapcursor)&&Qt.push(z.configure(null===(ue=this.options)||void 0===ue?void 0:ue.gapcursor)),!1!==(null===(Le=this.options)||void 0===Le?void 0:Le.hardBreak)&&Qt.push(q.configure(null===($e=this.options)||void 0===$e?void 0:$e.hardBreak)),!1!==(null===(We=this.options)||void 0===We?void 0:We.heading)&&Qt.push(xt.configure(null===(Ye=this.options)||void 0===Ye?void 0:Ye.heading)),!1!==(null===(rn=this.options)||void 0===rn?void 0:rn.history)&&Qt.push(v.configure(null===(sn=this.options)||void 0===sn?void 0:sn.history)),!1!==(null===(Ve=this.options)||void 0===Ve?void 0:Ve.horizontalRule)&&Qt.push(M.configure(null===(je=this.options)||void 0===je?void 0:je.horizontalRule)),!1!==(null===(Ie=this.options)||void 0===Ie?void 0:Ie.italic)&&Qt.push(Dt.configure(null===(Ne=this.options)||void 0===Ne?void 0:Ne.italic)),!1!==(null===(Qe=this.options)||void 0===Qe?void 0:Qe.listItem)&&Qt.push(S.configure(null===(He=this.options)||void 0===He?void 0:He.listItem)),!1!==(null===(pe=this.options)||void 0===pe?void 0:pe.orderedList)&&Qt.push(d.configure(null===(De=this.options)||void 0===De?void 0:De.orderedList)),!1!==(null===(Ge=this.options)||void 0===Ge?void 0:Ge.paragraph)&&Qt.push(g.configure(null===(Se=this.options)||void 0===Se?void 0:Se.paragraph)),!1!==(null===(re=this.options)||void 0===re?void 0:re.strike)&&Qt.push(N.configure(null===(Ue=this.options)||void 0===Ue?void 0:Ue.strike)),!1!==(null===(ke=this.options)||void 0===ke?void 0:ke.text)&&Qt.push(nt.configure(null===(Xe=this.options)||void 0===Xe?void 0:Xe.text)),Qt}})},51919:(It,pt,c)=>{c.r(pt),c.d(pt,{TableCellBackground:()=>i});const i=c(40256).Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:w})=>w?{style:`background: ${w}`}:null,parseHTML:({style:w})=>w.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:w=>({chain:x})=>x().updateAttributes("tableCell",{background:w}).updateAttributes("tableHeader",{background:w}).run(),unsetCellBackground:()=>({chain:w})=>w().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})})},88806:(It,pt,c)=>{c.d(pt,{v:()=>i});var C=c(74788);class i{constructor(x,T,Q){const D=T.get(C.z2F),$=T.get(C._Vd).resolveComponentFactory(x);this.componentRef=$.create(T,[]),this.updateProps(Q),D.attachView(this.componentRef.hostView)}get instance(){return this.componentRef.instance}get elementRef(){return this.componentRef.injector.get(C.SBq)}get dom(){return this.elementRef.nativeElement}updateProps(x){Object.entries(x).forEach(([T,Q])=>{this.instance[T]=Q})}detectChanges(){this.componentRef.changeDetectorRef.detectChanges()}destroy(){this.componentRef.destroy()}}},40400:(It,pt,c)=>{c.d(pt,{d:()=>x,x:()=>Q});var C=c(12057),i=c(40256),w=c(88806);class x{}class T extends i.NodeView{constructor(){super(...arguments),this.contentDOMElement=null}mount(){const G=this.options.injector,$=G.get(C.K0);this.renderer=new w.v(this.component,G,{editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(X={})=>this.updateAttributes(X),deleteNode:()=>this.deleteNode()}),this.extension.config.draggable&&(this.renderer.elementRef.nativeElement.ondragstart=X=>{this.onDragStart(X)}),this.contentDOMElement=this.node.isLeaf?null:$.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit",this.renderer.detectChanges())}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}update(G,$){return this.options.update?this.options.update(G,$):G.type===this.node.type&&(G===this.node&&this.decorations===$||(this.node=G,this.decorations=$,this.renderer.updateProps({node:G,decorations:$}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy()}maybeMoveContentDOM(){const G=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&G&&!G.contains(this.contentDOMElement)&&G.appendChild(this.contentDOMElement)}}const Q=(D,G)=>$=>new T(D,$,G)},70224:(It,pt,c)=>{c.r(pt),c.d(pt,{BackgroundColor:()=>ht.BackgroundColor,EDITOR_BLANK_COLOR:()=>V.hK,FontColor:()=>ft.FontColor,INITIALIZATION_TIPTAP_CONTAINER:()=>J.Y1,LAZY_EDITOR_EXTENSIONS:()=>J.F4,LAZY_TIPTAP_EDITOR:()=>J.bG,StarterKit:()=>Bt.StarterKit,TIPTAP_EDITOR:()=>J.ZW,TUI_EDITOR_CODE_OPTIONS:()=>J.Mr,TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES:()=>J.dj,TUI_EDITOR_CONTENT_PROCESSOR:()=>J.F1,TUI_EDITOR_DEFAULT_OPTIONS:()=>J.HG,TUI_EDITOR_EXTENSIONS:()=>J.Wf,TUI_EDITOR_FONT_OPTIONS:()=>J.UN,TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>lt.TUI_EDITOR_GROUP_DEFAULT_OPTIONS,TUI_EDITOR_MAX_IMAGE_WIDTH:()=>Ot.TUI_EDITOR_MAX_IMAGE_WIDTH,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>Ot.TUI_EDITOR_MIN_IMAGE_WIDTH,TUI_EDITOR_OPTIONS:()=>J.mJ,TUI_EDITOR_PROVIDERS:()=>ot.m,TUI_EDITOR_TABLE_COMMANDS:()=>J.$i,TUI_EDITOR_TOOLBAR_TEXTS:()=>J.rf,TUI_IMAGE_LOADER:()=>J.p7,TableCellBackground:()=>tt.TableCellBackground,TuiAlignContentComponent:()=>U.Xp,TuiAlignContentModule:()=>U.pu,TuiCodeComponent:()=>U.Tf,TuiCodeModule:()=>U.P_,TuiColorEditComponent:()=>C.hR,TuiColorEditModule:()=>C.TD,TuiColorPickerComponent:()=>C.$v,TuiColorPickerModule:()=>C.H9,TuiColorSelectorComponent:()=>C.sV,TuiColorSelectorModule:()=>C.wl,TuiComponentRenderer:()=>b.v,TuiDetailsComponent:()=>U.yj,TuiDetailsModule:()=>U.y9,TuiDetailsRemoveComponent:()=>U.Un,TuiEditLinkComponent:()=>i.l,TuiEditLinkModule:()=>i.F,TuiEditorComponent:()=>w.a,TuiEditorGroupToolComponent:()=>U.dN,TuiEditorImagePreviewDirective:()=>$.Zj,TuiEditorImagePreviewModule:()=>$.BN,TuiEditorModule:()=>gt,TuiEditorPortalDirective:()=>dt.A,TuiEditorPortalHostComponent:()=>vt.d,TuiEditorPortalService:()=>Mt.Y,TuiEditorSocketComponent:()=>T.D,TuiEditorSocketModule:()=>D,TuiEditorTool:()=>H._,TuiEditorToolGroup:()=>U.jP,TuiFlatPickerComponent:()=>C.Jd,TuiFlatPickerModule:()=>C.ui,TuiFontSize:()=>Ct.TuiFontSize,TuiFontSizeComponent:()=>U.mK,TuiFontSizeModule:()=>U.p7,TuiFontStyleComponent:()=>U.hr,TuiFontStyleModule:()=>U.Zv,TuiHighlightColorComponent:()=>U.UT,TuiHighlightColorModule:()=>U.XC,TuiImageEditorComponent:()=>Ot.TuiImageEditorComponent,TuiImageEditorModule:()=>Ot.TuiImageEditorModule,TuiInputColorComponent:()=>Tt.j,TuiInputColorModule:()=>Z,TuiLinearMultiPickerComponent:()=>C.es,TuiLinearMultiPickerModule:()=>C.GU,TuiLinearPickerComponent:()=>C.P,TuiLinearPickerModule:()=>C.g7,TuiListConfigsComponent:()=>U.w2,TuiListConfigsModule:()=>U.Ur,TuiNodeViewNgComponent:()=>F.d,TuiNodeViewRenderer:()=>F.x,TuiPaletteComponent:()=>C.Rh,TuiPaletteModule:()=>C.VM,TuiTabExtension:()=>Pt.TuiTabExtension,TuiTableCellColorComponent:()=>U.pH,TuiTableCellColorModule:()=>U.mp,TuiTableCommands:()=>U.iN,TuiTableCreateComponent:()=>U.lT,TuiTableCreateModule:()=>U.iA,TuiTableMergeCellsComponent:()=>U.YH,TuiTableMergeCellsModule:()=>U.er,TuiTableRowColumnManagerComponent:()=>U._I,TuiTableRowColumnManagerModule:()=>U.__,TuiTableSizeSelectorComponent:()=>U.M8,TuiTableSizeSelectorModule:()=>U.kU,TuiTextColorComponent:()=>U.G0,TuiTextColorModule:()=>U._t,TuiTiptapEditorDirective:()=>$.JU,TuiTiptapEditorModule:()=>$.mJ,TuiTiptapEditorService:()=>$.$3,TuiToolbarComponent:()=>G.M6,TuiToolbarModule:()=>G.yB,TuiToolbarNavigationManagerDirective:()=>G.Bp,createGroupExtension:()=>lt.createGroupExtension,createImageEditorExtension:()=>Ot.createImageEditorExtension,defaultEditorColors:()=>V.sw,defaultEditorExtensions:()=>at,defaultEditorTools:()=>V.Db,tuiDefaultFontOptionsHandler:()=>V.RR,tuiDeleteNode:()=>ut.yU,tuiEditorOptionsProvider:()=>J.Uv,tuiGetElementPoint:()=>ut.Ws,tuiGetGradientData:()=>ut.U5,tuiGetMarkRange:()=>ut.Yz,tuiGetSelectedContent:()=>ut.Ap,tuiInsertHtml:()=>ut.Xd,tuiInsertText:()=>ut.Oi,tuiIsOrderedOrBulletList:()=>Pt.tuiIsOrderedOrBulletList,tuiIsSafeLinkRange:()=>ut.nC,tuiIsSelectionIn:()=>ut.i0,tuiLegacyEditorConverter:()=>ut.Er,tuiParseGradient:()=>ut._N,tuiToGradient:()=>ut.CH});var C=c(27050),i=c(71115),w=c(69303),x=c(12057),T=c(20179),Q=c(74788);let D=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=Q.oAB({type:B}),B.\u0275inj=Q.cJS({}),B})();var G=c(17406),$=c(40632),ct=c(36692),X=c(72002);let gt=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=Q.oAB({type:B}),B.\u0275inj=Q.cJS({imports:[[x.ez,G.yB,X.TuiWrapperModule,X.TuiScrollbarModule,i.F,ct.TuiActiveZoneModule,X.TuiDropdownModule,$.mJ,D,ct.TuiLetModule]]}),B})();var ot=c(79089),dt=c(1433),Mt=c(73825),vt=c(9872),Tt=c(19769);let Z=(()=>{class B{}return B.\u0275fac=function(q){return new(q||B)},B.\u0275mod=Q.oAB({type:B}),B.\u0275inj=Q.cJS({imports:[[x.ez,X.TuiPrimitiveTextfieldModule,X.TuiTextfieldControllerModule,X.TuiHostedDropdownModule,C.wl,ct.TuiActiveZoneModule]]}),B})();var U=c(93252),V=c(19074),H=c(48699),ht=c(15736);const at=[Promise.resolve().then(c.bind(c,75276)).then(({StarterKit:B})=>B).then(B=>B.configure({heading:{levels:[1,2]}})),c.e(45861).then(c.bind(c,45861)).then(({default:B})=>B.configure({types:["heading","paragraph"]})),Promise.resolve().then(c.bind(c,74634)).then(({default:B})=>B),c.e(77008).then(c.bind(c,77008)).then(({default:B})=>B),c.e(91347).then(c.bind(c,91347)).then(({default:B})=>B),c.e(35609).then(c.bind(c,35609)).then(({default:B})=>B),Promise.resolve().then(c.bind(c,52658)).then(({FontColor:B})=>B),c.e(12955).then(c.bind(c,12955)).then(({default:B})=>B.configure({inline:!0})),c.e(63658).then(c.bind(c,63658)).then(({default:B})=>B.configure({openOnClick:!1})),Promise.resolve().then(c.bind(c,15736)).then(({BackgroundColor:B})=>B),c.e(88729).then(c.bind(c,88729)).then(({default:B})=>B.configure({resizable:!0,lastColumnResizable:!1})),c.e(72219).then(c.bind(c,72219)).then(({default:B})=>B),c.e(74096).then(c.bind(c,74096)).then(({default:B})=>B),c.e(53107).then(c.bind(c,53107)).then(({TableHeader:B})=>B),Promise.resolve().then(c.bind(c,12177)).then(({TuiTabExtension:B})=>B),Promise.resolve().then(c.bind(c,51919)).then(({TableCellBackground:B})=>B),c.e(44312).then(c.bind(c,44312)).then(({TuiDetailsContent:B})=>B),c.e(44312).then(c.bind(c,44312)).then(({TuiDetails:B})=>B),c.e(44312).then(c.bind(c,44312)).then(({TuiSummary:B})=>B),Promise.resolve().then(c.bind(c,9492)).then(({TuiFontSize:B})=>B)];var ft=c(52658),Ct=c(9492),lt=c(54920),Ot=c(25039),Pt=c(12177),Bt=c(75276),tt=c(51919),b=c(88806),F=c(40400),J=c(62842),ut=c(37631)},62141:(It,pt,c)=>{c.d(pt,{i:()=>ct});var C=c(12057),i=c(74788),w=c(37631),x=c(36692),T=c(18891),Q=c(43190),D=c(88002),G=c(46782),$=c(39761);let ct=(()=>{class X extends T.y{constructor(ot,{nativeElement:dt},Mt){const vt=(0,x.tuiTypedFromEvent)(dt,"mousedown").pipe((0,x.tuiPreventDefault)(),(0,Q.w)(Tt=>{const Z=(0,x.tuiTypedFromEvent)(Mt,"mousemove").pipe((0,D.U)(({clientX:U,clientY:V})=>(0,w.Ws)(U,V,dt)),(0,G.R)((0,x.tuiTypedFromEvent)(Mt,"mouseup")));return Tt.target===dt?Z.pipe((0,$.O)((0,w.Ws)(Tt.clientX,Tt.clientY,dt))):Z}),(0,G.R)(ot));super(Tt=>vt.subscribe(Tt))}}return X.\u0275fac=function(ot){return new(ot||X)(i.LFG(x.TuiDestroyService),i.LFG(i.SBq),i.LFG(C.K0))},X.\u0275prov=i.Yz7({token:X,factory:X.\u0275fac}),X})()},62842:(It,pt,c)=>{c.d(pt,{Y1:()=>ht,F4:()=>w,bG:()=>H,ZW:()=>V,Mr:()=>dt,dj:()=>X,F1:()=>$,HG:()=>T,Wf:()=>i,UN:()=>Mt,mJ:()=>Q,$i:()=>ot,rf:()=>gt,p7:()=>Z,Uv:()=>D});var C=c(74788);const i=new C.OlP("[TUI_EDITOR_EXTENSIONS]: Extensions for editor"),w=new C.OlP("[LAZY_EDITOR_EXTENSIONS]: lazy extensions");var x=c(19074);const T={colors:x.sw,blankColor:x.hK,fontOptions:x.RR},Q=new C.OlP("[TUI_EDITOR_OPTIONS]: Default Editor colors",{factory:()=>T});function D(at){return{provide:Q,useValue:Object.assign(Object.assign({},T),at)}}var G=c(54487);const $=new C.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]: Content value processor for tui-editor",{factory:()=>G.y});var ct=c(72773);const X=new C.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]: tui-color-selector i18n",{factory:()=>["Solid color","Gradient"]}),gt=new C.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]: tui-editor-toolbar i18n",{factory:(0,ct.vv)("toolbarTools")}),ot=new C.OlP("[TUI_EDITOR_TABLE_COMMANDS]: tui-editor-toolbar table i18n",{factory:(0,ct.vv)("editorTableCommands")}),dt=new C.OlP("[TUI_EDITOR_CODE_OPTIONS]: tui-editor-toolbar codes options",{factory:(0,ct.vv)("editorCodeOptions")}),Mt=new C.OlP("[TUI_EDITOR_FONT_OPTIONS]: tui-editor-toolbar font options",{factory:(0,ct.vv)("editorFontOptions")});var vt=c(36692),Tt=c(88002);const Z=new C.OlP("[TUI_IMAGE_LOADER]: Image loader handler",{factory:()=>at=>{const ft=new FileReader;return ft.readAsDataURL(at),(0,vt.tuiTypedFromEvent)(ft,"load").pipe((0,Tt.U)(()=>String(ft.result)))}});var U=c(82298);const V=new C.OlP("[TIPTAP_EDITOR]: Token for Tiptap Editor"),H=new C.OlP("[LAZY_TIPTAP_EDITOR]: Lazy loaded Editor",{factory:()=>{const at=new U.t(1);return Promise.resolve().then(c.bind(c,40256)).then(ft=>at.next(ft.Editor)),at}}),ht=new C.OlP("[INITIALIZATION_TIPTAP_CONTAINER]: The container in which the tip-tap editor is initialized")},37631:(It,pt,c)=>{function C(tt,b,F){const J=tt.selection.$anchor;for(let ut=J.depth;ut>0;ut--)if(J.node(ut).type.name===F)return b&&b(tt.tr.delete(J.before(ut),J.after(ut)).scrollIntoView()),!0;return!1}c.d(pt,{yU:()=>C,Ws:()=>w,U5:()=>x,Yz:()=>D,Ap:()=>$,Xd:()=>ct,Oi:()=>X,nC:()=>Pt,i0:()=>gt,Er:()=>ot,_N:()=>lt,CH:()=>Bt});var i=c(36692);function w(tt,b,F){const{left:J,top:ut,width:B,height:z}=F.getBoundingClientRect();return[(0,i.tuiClamp)(tt-J,0,B)/B,(0,i.tuiClamp)(b-ut,0,z)/z]}function x(tt){return tt.slice(0,Math.max(0,tt.length-1)).replace("linear-gradient(","")}function Q(tt,b,F={}){return tt.find(({attrs:J,type:ut})=>ut===b&&function(tt,b){const F=Object.keys(b);return!F.length||!!F.filter(J=>b[J]===tt[J]).length}(J,F))||null}function D(tt,b,F={}){if(!tt||!b)return null;const{node:J,offset:ut}=tt.parent.childAfter(tt.parentOffset);if(!J)return null;const B=Q(J.marks,b,F);if(!B)return null;let z=tt.index(),q=tt.start()+ut,xt=z+1,kt=q+J.nodeSize;for(Q(J.marks,b,F);z>0&&B.isInSet(tt.parent.child(z-1).marks);)z-=1,q-=tt.parent.child(z).nodeSize;for(;xt<tt.parent.childCount&&Q(tt.parent.child(xt).marks,b,F);)kt+=tt.parent.child(xt).nodeSize,xt+=1;return{from:q,to:kt}}var G=c(40256);function $(tt,b){const F=null!=b?b:tt.selection.$head.parent.textContent,J=tt.doc.cut(tt.selection.from,tt.selection.to);return J.content.size?(0,G.getHTMLFromFragment)(J.content,tt.schema):F}function ct(tt,b){if(tt.queryCommandSupported("insertHTML"))return void tt.execCommand("insertHTML",!1,b);const F=tt.getSelection();if(!F)throw new i.TuiDocumentSelectionException;tt.execCommand("ms-beginUndoUnit");const J=F.getRangeAt(0),ut=J.createContextualFragment(b);J.deleteContents(),J.insertNode(ut),tt.execCommand("ms-endUndoUnit")}function X(tt,b){if(tt.queryCommandSupported("insertText"))return void tt.execCommand("insertText",!1,b);const F=tt.getSelection();if(!F)throw new i.TuiDocumentSelectionException;tt.execCommand("ms-beginUndoUnit");const J=F.getRangeAt(0);J.deleteContents(),J.insertNode(tt.createTextNode(b)),tt.execCommand("ms-endUndoUnit")}function gt({anchorNode:tt,focusNode:b},F){return!!tt&&!!b&&(0,i.tuiIsNodeIn)(tt,F)&&(0,i.tuiIsNodeIn)(b,F)}function ot(tt){const b=(new DOMParser).parseFromString(tt,"text/html");return dt(b.body),b.body.innerHTML}function dt(tt){for(const b of Array.from(tt.children))if(b.children.length&&dt(b),"FONT"===b.tagName)if(b.hasAttribute("size"))switch(b.getAttribute("size")){case"6":Mt("h1",b);break;case"5":Mt("h2",b);break;case"4":vt("17px",b);break;case"3":vt("15px",b);break;case"2":vt("13px",b)}else b.hasAttribute("color")&&Tt(b)}function Mt(tt,b){var F,J,ut,B,z,q,xt,kt,Rt;const $t=document.createElement(tt);if($t.innerHTML=b.innerHTML,"P"===(null===(F=b.parentElement)||void 0===F?void 0:F.tagName)){const Zt=null===(ut=null===(J=b.parentElement)||void 0===J?void 0:J.parentElement)||void 0===ut?void 0:ut.insertBefore($t,b.parentElement);null===(B=b.parentElement)||void 0===B||B.removeChild(b),(null==Zt?void 0:Zt.nextSibling)&&!(null===(q=null===(z=null==Zt?void 0:Zt.nextSibling)||void 0===z?void 0:z.textContent)||void 0===q?void 0:q.trim())&&(null===(kt=null===(xt=Zt.nextSibling)||void 0===xt?void 0:xt.parentElement)||void 0===kt||kt.removeChild(Zt.nextSibling))}else null===(Rt=b.parentElement)||void 0===Rt||Rt.replaceChild($t,b)}function vt(tt,b){var F;const J=document.createElement("p"),ut=document.createElement("span");ut.setAttribute("style",`font-size: ${tt}`),ut.innerHTML=b.innerHTML,J.append(ut),null===(F=b.parentElement)||void 0===F||F.replaceChild("P"===b.parentElement.tagName?ut:J,b)}function Tt(tt){var b;const F=document.createElement("span");F.setAttribute("style",`color: ${tt.getAttribute("color")}`),F.innerHTML=tt.innerHTML,null===(b=tt.parentElement)||void 0===b||b.replaceChild(F,tt)}const Ct=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function lt(tt){const b=new RegExp(Ct.join(""),"gi"),F=tt.startsWith("to")||tt.match(/^\d/)?tt.slice(Math.max(0,tt.indexOf(",")+1)).trim():tt,J=tt.startsWith("to")?tt.split(",")[0]:"to bottom";let ut=[],B=b.exec(F);for(;null!==B;)ut=ut.concat({color:B[1],position:Ot(B[2],ut.length)}),B=b.exec(F);return ut=ut.filter(({color:z})=>z.startsWith("#")||z.startsWith("rgb")),{stops:ut,side:J}}function Ot(tt,b){const F=1===b?"100%":`${b}%`;return(null==tt?void 0:tt.includes("%"))?tt:F}function Pt(tt){var b;return tt.endOffset-tt.startOffset>0||0!==tt.startOffset&&tt.endOffset!==((null===(b=tt.endContainer.nodeValue)||void 0===b?void 0:b.length)||0)}function Bt({stops:tt,side:b}){return`linear-gradient(${b}, ${tt.map(({color:F,position:J})=>`rgba(${(0,i.tuiParseColor)(F).join(", ")}) ${J}`).join(", ")})`}},13903:(It,pt,c)=>{c.d(pt,{$:()=>Tt,h:()=>vt});for(var C={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},w="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),T=("undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)),Q="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),D=T||w&&+w[1]<57,G=0;G<10;G++)C[48+G]=C[96+G]=String(G);for(G=1;G<=24;G++)C[G+111]="F"+G;for(G=65;G<=90;G++)C[G]=String.fromCharCode(G+32),i[G]=String.fromCharCode(G);for(var $ in C)i.hasOwnProperty($)||(i[$]=C[$]);var X=c(62463);const gt="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function ot(Z){let H,ht,at,ft,U=Z.split(/-(?!$)/),V=U[U.length-1];"Space"==V&&(V=" ");for(let Ct=0;Ct<U.length-1;Ct++){let lt=U[Ct];if(/^(cmd|meta|m)$/i.test(lt))ft=!0;else if(/^a(lt)?$/i.test(lt))H=!0;else if(/^(c|ctrl|control)$/i.test(lt))ht=!0;else if(/^s(hift)?$/i.test(lt))at=!0;else{if(!/^mod$/i.test(lt))throw new Error("Unrecognized modifier name: "+lt);gt?ft=!0:ht=!0}}return H&&(V="Alt-"+V),ht&&(V="Ctrl-"+V),ft&&(V="Meta-"+V),at&&(V="Shift-"+V),V}function Mt(Z,U,V){return U.altKey&&(Z="Alt-"+Z),U.ctrlKey&&(Z="Ctrl-"+Z),U.metaKey&&(Z="Meta-"+Z),!1!==V&&U.shiftKey&&(Z="Shift-"+Z),Z}function vt(Z){return new X.Sy({props:{handleKeyDown:Tt(Z)}})}function Tt(Z){let U=function(Z){let U=Object.create(null);for(let V in Z)U[ot(V)]=Z[V];return U}(Z);return function(V,H){let ft,ht=function(Z){var V=!(D&&(Z.ctrlKey||Z.altKey||Z.metaKey)||Q&&Z.shiftKey&&Z.key&&1==Z.key.length||"Unidentified"==Z.key)&&Z.key||(Z.shiftKey?i:C)[Z.keyCode]||Z.key||"Unidentified";return"Esc"==V&&(V="Escape"),"Del"==V&&(V="Delete"),"Left"==V&&(V="ArrowLeft"),"Up"==V&&(V="ArrowUp"),"Right"==V&&(V="ArrowRight"),"Down"==V&&(V="ArrowDown"),V}(H),at=1==ht.length&&" "!=ht,Ct=U[Mt(ht,H,!at)];if(Ct&&Ct(V.state,V.dispatch,V))return!0;if(at&&(H.shiftKey||H.altKey||H.metaKey||ht.charCodeAt(0)>127)&&(ft=C[H.keyCode])&&ft!=ht){let lt=U[Mt(ft,H,!0)];if(lt&&lt(V.state,V.dispatch,V))return!0}else if(at&&H.shiftKey){let lt=U[Mt(ht,H,!0)];if(lt&&lt(V.state,V.dispatch,V))return!0}return!1}}},35917:(It,pt,c)=>{function C(S){this.content=S}c.d(pt,{aw:()=>_e,PW:()=>it,HY:()=>T,vc:()=>$,ZU:()=>me,NB:()=>tt,Ts:()=>Pt,e4:()=>ct,V_:()=>ne,p2:()=>X}),C.prototype={constructor:C,find:function(S){for(var r=0;r<this.content.length;r+=2)if(this.content[r]===S)return r;return-1},get:function(S){var r=this.find(S);return-1==r?void 0:this.content[r+1]},update:function(S,r,d){var g=d&&d!=S?this.remove(d):this,O=g.find(S),P=g.content.slice();return-1==O?P.push(d||S,r):(P[O+1]=r,d&&(P[O]=d)),new C(P)},remove:function(S){var r=this.find(S);if(-1==r)return this;var d=this.content.slice();return d.splice(r,2),new C(d)},addToStart:function(S,r){return new C([S,r].concat(this.remove(S).content))},addToEnd:function(S,r){var d=this.remove(S).content.slice();return d.push(S,r),new C(d)},addBefore:function(S,r,d){var g=this.remove(r),O=g.content.slice(),P=g.find(S);return O.splice(-1==P?O.length:P,0,r,d),new C(O)},forEach:function(S){for(var r=0;r<this.content.length;r+=2)S(this.content[r],this.content[r+1])},prepend:function(S){return(S=C.from(S)).size?new C(S.content.concat(this.subtract(S).content)):this},append:function(S){return(S=C.from(S)).size?new C(this.subtract(S).content.concat(S.content)):this},subtract:function(S){var r=this;S=C.from(S);for(var d=0;d<S.content.length;d+=2)r=r.remove(S.content[d]);return r},toObject:function(){var S={};return this.forEach(function(r,d){S[r]=d}),S},get size(){return this.content.length>>1}},C.from=function(S){if(S instanceof C)return S;var r=[];if(S)for(var d in S)r.push(d,S[d]);return new C(r)};const i=C;function w(S,r,d){for(let g=0;;g++){if(g==S.childCount||g==r.childCount)return S.childCount==r.childCount?null:d;let O=S.child(g),P=r.child(g);if(O!=P){if(!O.sameMarkup(P))return d;if(O.isText&&O.text!=P.text){for(let N=0;O.text[N]==P.text[N];N++)d++;return d}if(O.content.size||P.content.size){let N=w(O.content,P.content,d+1);if(null!=N)return N}d+=O.nodeSize}else d+=O.nodeSize}}function x(S,r,d,g){for(let O=S.childCount,P=r.childCount;;){if(0==O||0==P)return O==P?null:{a:d,b:g};let N=S.child(--O),nt=r.child(--P),_t=N.nodeSize;if(N!=nt){if(!N.sameMarkup(nt))return{a:d,b:g};if(N.isText&&N.text!=nt.text){let k=0,A=Math.min(N.text.length,nt.text.length);for(;k<A&&N.text[N.text.length-k-1]==nt.text[nt.text.length-k-1];)k++,d--,g--;return{a:d,b:g}}if(N.content.size||nt.content.size){let k=x(N.content,nt.content,d-1,g-1);if(k)return k}d-=_t,g-=_t}else d-=_t,g-=_t}}class T{constructor(r,d){if(this.content=r,this.size=d||0,null==d)for(let g=0;g<r.length;g++)this.size+=r[g].nodeSize}nodesBetween(r,d,g,O=0,P){for(let N=0,nt=0;nt<d;N++){let _t=this.content[N],k=nt+_t.nodeSize;if(k>r&&!1!==g(_t,O+nt,P||null,N)&&_t.content.size){let A=nt+1;_t.nodesBetween(Math.max(0,r-A),Math.min(_t.content.size,d-A),g,O+A)}nt=k}}descendants(r){this.nodesBetween(0,this.size,r)}textBetween(r,d,g,O){let P="",N=!0;return this.nodesBetween(r,d,(nt,_t)=>{nt.isText?(P+=nt.text.slice(Math.max(r,_t)-_t,d-_t),N=!g):nt.isLeaf?(O?P+="function"==typeof O?O(nt):O:nt.type.spec.leafText&&(P+=nt.type.spec.leafText(nt)),N=!g):!N&&nt.isBlock&&(P+=g,N=!0)},0),P}append(r){if(!r.size)return this;if(!this.size)return r;let d=this.lastChild,g=r.firstChild,O=this.content.slice(),P=0;for(d.isText&&d.sameMarkup(g)&&(O[O.length-1]=d.withText(d.text+g.text),P=1);P<r.content.length;P++)O.push(r.content[P]);return new T(O,this.size+r.size)}cut(r,d=this.size){if(0==r&&d==this.size)return this;let g=[],O=0;if(d>r)for(let P=0,N=0;N<d;P++){let nt=this.content[P],_t=N+nt.nodeSize;_t>r&&((N<r||_t>d)&&(nt=nt.isText?nt.cut(Math.max(0,r-N),Math.min(nt.text.length,d-N)):nt.cut(Math.max(0,r-N-1),Math.min(nt.content.size,d-N-1))),g.push(nt),O+=nt.nodeSize),N=_t}return new T(g,O)}cutByIndex(r,d){return r==d?T.empty:0==r&&d==this.content.length?this:new T(this.content.slice(r,d))}replaceChild(r,d){let g=this.content[r];if(g==d)return this;let O=this.content.slice(),P=this.size+d.nodeSize-g.nodeSize;return O[r]=d,new T(O,P)}addToStart(r){return new T([r].concat(this.content),this.size+r.nodeSize)}addToEnd(r){return new T(this.content.concat(r),this.size+r.nodeSize)}eq(r){if(this.content.length!=r.content.length)return!1;for(let d=0;d<this.content.length;d++)if(!this.content[d].eq(r.content[d]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(r){let d=this.content[r];if(!d)throw new RangeError("Index "+r+" out of range for "+this);return d}maybeChild(r){return this.content[r]||null}forEach(r){for(let d=0,g=0;d<this.content.length;d++){let O=this.content[d];r(O,g,d),g+=O.nodeSize}}findDiffStart(r,d=0){return w(this,r,d)}findDiffEnd(r,d=this.size,g=r.size){return x(this,r,d,g)}findIndex(r,d=-1){if(0==r)return D(0,r);if(r==this.size)return D(this.content.length,r);if(r>this.size||r<0)throw new RangeError(`Position ${r} outside of fragment (${this})`);for(let g=0,O=0;;g++){let N=O+this.child(g).nodeSize;if(N>=r)return N==r||d>0?D(g+1,N):D(g,O);O=N}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(r=>r.toJSON()):null}static fromJSON(r,d){if(!d)return T.empty;if(!Array.isArray(d))throw new RangeError("Invalid input for Fragment.fromJSON");return new T(d.map(r.nodeFromJSON))}static fromArray(r){if(!r.length)return T.empty;let d,g=0;for(let O=0;O<r.length;O++){let P=r[O];g+=P.nodeSize,O&&P.isText&&r[O-1].sameMarkup(P)?(d||(d=r.slice(0,O)),d[d.length-1]=P.withText(d[d.length-1].text+P.text)):d&&d.push(P)}return new T(d||r,g)}static from(r){if(!r)return T.empty;if(r instanceof T)return r;if(Array.isArray(r))return this.fromArray(r);if(r.attrs)return new T([r],r.nodeSize);throw new RangeError("Can not convert "+r+" to a Fragment"+(r.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}T.empty=new T([],0);const Q={index:0,offset:0};function D(S,r){return Q.index=S,Q.offset=r,Q}function G(S,r){if(S===r)return!0;if(!S||"object"!=typeof S||!r||"object"!=typeof r)return!1;let d=Array.isArray(S);if(Array.isArray(r)!=d)return!1;if(d){if(S.length!=r.length)return!1;for(let g=0;g<S.length;g++)if(!G(S[g],r[g]))return!1}else{for(let g in S)if(!(g in r)||!G(S[g],r[g]))return!1;for(let g in r)if(!(g in S))return!1}return!0}let $=(()=>{class S{constructor(d,g){this.type=d,this.attrs=g}addToSet(d){let g,O=!1;for(let P=0;P<d.length;P++){let N=d[P];if(this.eq(N))return d;if(this.type.excludes(N.type))g||(g=d.slice(0,P));else{if(N.type.excludes(this.type))return d;!O&&N.type.rank>this.type.rank&&(g||(g=d.slice(0,P)),g.push(this),O=!0),g&&g.push(N)}}return g||(g=d.slice()),O||g.push(this),g}removeFromSet(d){for(let g=0;g<d.length;g++)if(this.eq(d[g]))return d.slice(0,g).concat(d.slice(g+1));return d}isInSet(d){for(let g=0;g<d.length;g++)if(this.eq(d[g]))return!0;return!1}eq(d){return this==d||this.type==d.type&&G(this.attrs,d.attrs)}toJSON(){let d={type:this.type.name};for(let g in this.attrs){d.attrs=this.attrs;break}return d}static fromJSON(d,g){if(!g)throw new RangeError("Invalid input for Mark.fromJSON");let O=d.marks[g.type];if(!O)throw new RangeError(`There is no mark type ${g.type} in this schema`);return O.create(g.attrs)}static sameSet(d,g){if(d==g)return!0;if(d.length!=g.length)return!1;for(let O=0;O<d.length;O++)if(!d[O].eq(g[O]))return!1;return!0}static setFrom(d){if(!d||Array.isArray(d)&&0==d.length)return S.none;if(d instanceof S)return[d];let g=d.slice();return g.sort((O,P)=>O.type.rank-P.type.rank),g}}return S.none=[],S})();class ct extends Error{}class X{constructor(r,d,g){this.content=r,this.openStart=d,this.openEnd=g}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(r,d){let g=ot(this.content,r+this.openStart,d);return g&&new X(g,this.openStart,this.openEnd)}removeBetween(r,d){return new X(gt(this.content,r+this.openStart,d+this.openStart),this.openStart,this.openEnd)}eq(r){return this.content.eq(r.content)&&this.openStart==r.openStart&&this.openEnd==r.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let r={content:this.content.toJSON()};return this.openStart>0&&(r.openStart=this.openStart),this.openEnd>0&&(r.openEnd=this.openEnd),r}static fromJSON(r,d){if(!d)return X.empty;let g=d.openStart||0,O=d.openEnd||0;if("number"!=typeof g||"number"!=typeof O)throw new RangeError("Invalid input for Slice.fromJSON");return new X(T.fromJSON(r,d.content),g,O)}static maxOpen(r,d=!0){let g=0,O=0;for(let P=r.firstChild;P&&!P.isLeaf&&(d||!P.type.spec.isolating);P=P.firstChild)g++;for(let P=r.lastChild;P&&!P.isLeaf&&(d||!P.type.spec.isolating);P=P.lastChild)O++;return new X(r,g,O)}}function gt(S,r,d){let{index:g,offset:O}=S.findIndex(r),P=S.maybeChild(g),{index:N,offset:nt}=S.findIndex(d);if(O==r||P.isText){if(nt!=d&&!S.child(N).isText)throw new RangeError("Removing non-flat range");return S.cut(0,r).append(S.cut(d))}if(g!=N)throw new RangeError("Removing non-flat range");return S.replaceChild(g,P.copy(gt(P.content,r-O-1,d-O-1)))}function ot(S,r,d,g){let{index:O,offset:P}=S.findIndex(r),N=S.maybeChild(O);if(P==r||N.isText)return g&&!g.canReplace(O,O,d)?null:S.cut(0,r).append(d).append(S.cut(r));let nt=ot(N.content,r-P-1,d);return nt&&S.replaceChild(O,N.copy(nt))}function dt(S,r,d){if(d.openStart>S.depth)throw new ct("Inserted content deeper than insertion position");if(S.depth-d.openStart!=r.depth-d.openEnd)throw new ct("Inconsistent open depths");return Mt(S,r,d,0)}function Mt(S,r,d,g){let O=S.index(g),P=S.node(g);if(O==r.index(g)&&g<S.depth-d.openStart){let N=Mt(S,r,d,g+1);return P.copy(P.content.replaceChild(O,N))}if(d.content.size){if(d.openStart||d.openEnd||S.depth!=g||r.depth!=g){let{start:N,end:nt}=function(S,r){let d=r.depth-S.openStart,O=r.node(d).copy(S.content);for(let P=d-1;P>=0;P--)O=r.node(P).copy(T.from(O));return{start:O.resolveNoCache(S.openStart+d),end:O.resolveNoCache(O.content.size-S.openEnd-d)}}(d,S);return V(P,H(S,N,nt,r,g))}{let N=S.parent,nt=N.content;return V(N,nt.cut(0,S.parentOffset).append(d.content).append(nt.cut(r.parentOffset)))}}return V(P,ht(S,r,g))}function vt(S,r){if(!r.type.compatibleContent(S.type))throw new ct("Cannot join "+r.type.name+" onto "+S.type.name)}function Tt(S,r,d){let g=S.node(d);return vt(g,r.node(d)),g}function Z(S,r){let d=r.length-1;d>=0&&S.isText&&S.sameMarkup(r[d])?r[d]=S.withText(r[d].text+S.text):r.push(S)}function U(S,r,d,g){let O=(r||S).node(d),P=0,N=r?r.index(d):O.childCount;S&&(P=S.index(d),S.depth>d?P++:S.textOffset&&(Z(S.nodeAfter,g),P++));for(let nt=P;nt<N;nt++)Z(O.child(nt),g);r&&r.depth==d&&r.textOffset&&Z(r.nodeBefore,g)}function V(S,r){if(!S.type.validContent(r))throw new ct("Invalid content for node "+S.type.name);return S.copy(r)}function H(S,r,d,g,O){let P=S.depth>O&&Tt(S,r,O+1),N=g.depth>O&&Tt(d,g,O+1),nt=[];return U(null,S,O,nt),P&&N&&r.index(O)==d.index(O)?(vt(P,N),Z(V(P,H(S,r,d,g,O+1)),nt)):(P&&Z(V(P,ht(S,r,O+1)),nt),U(r,d,O,nt),N&&Z(V(N,ht(d,g,O+1)),nt)),U(g,null,O,nt),new T(nt)}function ht(S,r,d){let g=[];return U(null,S,d,g),S.depth>d&&Z(V(Tt(S,r,d+1),ht(S,r,d+1)),g),U(r,null,d,g),new T(g)}X.empty=new X(T.empty,0,0);class ft{constructor(r,d,g){this.pos=r,this.path=d,this.parentOffset=g,this.depth=d.length/3-1}resolveDepth(r){return null==r?this.depth:r<0?this.depth+r:r}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(r){return this.path[3*this.resolveDepth(r)]}index(r){return this.path[3*this.resolveDepth(r)+1]}indexAfter(r){return r=this.resolveDepth(r),this.index(r)+(r!=this.depth||this.textOffset?1:0)}start(r){return 0==(r=this.resolveDepth(r))?0:this.path[3*r-1]+1}end(r){return r=this.resolveDepth(r),this.start(r)+this.node(r).content.size}before(r){if(!(r=this.resolveDepth(r)))throw new RangeError("There is no position before the top-level node");return r==this.depth+1?this.pos:this.path[3*r-1]}after(r){if(!(r=this.resolveDepth(r)))throw new RangeError("There is no position after the top-level node");return r==this.depth+1?this.pos:this.path[3*r-1]+this.path[3*r].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let r=this.parent,d=this.index(this.depth);if(d==r.childCount)return null;let g=this.pos-this.path[this.path.length-1],O=r.child(d);return g?r.child(d).cut(g):O}get nodeBefore(){let r=this.index(this.depth),d=this.pos-this.path[this.path.length-1];return d?this.parent.child(r).cut(0,d):0==r?null:this.parent.child(r-1)}posAtIndex(r,d){d=this.resolveDepth(d);let g=this.path[3*d],O=0==d?0:this.path[3*d-1]+1;for(let P=0;P<r;P++)O+=g.child(P).nodeSize;return O}marks(){let r=this.parent,d=this.index();if(0==r.content.size)return $.none;if(this.textOffset)return r.child(d).marks;let g=r.maybeChild(d-1),O=r.maybeChild(d);if(!g){let nt=g;g=O,O=nt}let P=g.marks;for(var N=0;N<P.length;N++)!1===P[N].type.spec.inclusive&&(!O||!P[N].isInSet(O.marks))&&(P=P[N--].removeFromSet(P));return P}marksAcross(r){let d=this.parent.maybeChild(this.index());if(!d||!d.isInline)return null;let g=d.marks,O=r.parent.maybeChild(r.index());for(var P=0;P<g.length;P++)!1===g[P].type.spec.inclusive&&(!O||!g[P].isInSet(O.marks))&&(g=g[P--].removeFromSet(g));return g}sharedDepth(r){for(let d=this.depth;d>0;d--)if(this.start(d)<=r&&this.end(d)>=r)return d;return 0}blockRange(r=this,d){if(r.pos<this.pos)return r.blockRange(this);for(let g=this.depth-(this.parent.inlineContent||this.pos==r.pos?1:0);g>=0;g--)if(r.pos<=this.end(g)&&(!d||d(this.node(g))))return new Pt(this,r,g);return null}sameParent(r){return this.pos-this.parentOffset==r.pos-r.parentOffset}max(r){return r.pos>this.pos?r:this}min(r){return r.pos<this.pos?r:this}toString(){let r="";for(let d=1;d<=this.depth;d++)r+=(r?"/":"")+this.node(d).type.name+"_"+this.index(d-1);return r+":"+this.parentOffset}static resolve(r,d){if(!(d>=0&&d<=r.content.size))throw new RangeError("Position "+d+" out of range");let g=[],O=0,P=d;for(let N=r;;){let{index:nt,offset:_t}=N.content.findIndex(P),k=P-_t;if(g.push(N,nt,O+_t),!k||(N=N.child(nt),N.isText))break;P=k-1,O+=_t+1}return new ft(d,g,P)}static resolveCached(r,d){for(let O=0;O<Ct.length;O++){let P=Ct[O];if(P.pos==d&&P.doc==r)return P}let g=Ct[lt]=ft.resolve(r,d);return lt=(lt+1)%Ot,g}}let Ct=[],lt=0,Ot=12;class Pt{constructor(r,d,g){this.$from=r,this.$to=d,this.depth=g}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Bt=Object.create(null);class tt{constructor(r,d,g,O=$.none){this.type=r,this.attrs=d,this.marks=O,this.content=g||T.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(r){return this.content.child(r)}maybeChild(r){return this.content.maybeChild(r)}forEach(r){this.content.forEach(r)}nodesBetween(r,d,g,O=0){this.content.nodesBetween(r,d,g,O,this)}descendants(r){this.nodesBetween(0,this.content.size,r)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(r,d,g,O){return this.content.textBetween(r,d,g,O)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(r){return this==r||this.sameMarkup(r)&&this.content.eq(r.content)}sameMarkup(r){return this.hasMarkup(r.type,r.attrs,r.marks)}hasMarkup(r,d,g){return this.type==r&&G(this.attrs,d||r.defaultAttrs||Bt)&&$.sameSet(this.marks,g||$.none)}copy(r=null){return r==this.content?this:new tt(this.type,this.attrs,r,this.marks)}mark(r){return r==this.marks?this:new tt(this.type,this.attrs,this.content,r)}cut(r,d=this.content.size){return 0==r&&d==this.content.size?this:this.copy(this.content.cut(r,d))}slice(r,d=this.content.size,g=!1){if(r==d)return X.empty;let O=this.resolve(r),P=this.resolve(d),N=g?0:O.sharedDepth(d),nt=O.start(N),k=O.node(N).content.cut(O.pos-nt,P.pos-nt);return new X(k,O.depth-N,P.depth-N)}replace(r,d,g){return dt(this.resolve(r),this.resolve(d),g)}nodeAt(r){for(let d=this;;){let{index:g,offset:O}=d.content.findIndex(r);if(d=d.maybeChild(g),!d)return null;if(O==r||d.isText)return d;r-=O+1}}childAfter(r){let{index:d,offset:g}=this.content.findIndex(r);return{node:this.content.maybeChild(d),index:d,offset:g}}childBefore(r){if(0==r)return{node:null,index:0,offset:0};let{index:d,offset:g}=this.content.findIndex(r);if(g<r)return{node:this.content.child(d),index:d,offset:g};let O=this.content.child(d-1);return{node:O,index:d-1,offset:g-O.nodeSize}}resolve(r){return ft.resolveCached(this,r)}resolveNoCache(r){return ft.resolve(this,r)}rangeHasMark(r,d,g){let O=!1;return d>r&&this.nodesBetween(r,d,P=>(g.isInSet(P.marks)&&(O=!0),!O)),O}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let r=this.type.name;return this.content.size&&(r+="("+this.content.toStringInner()+")"),F(this.marks,r)}contentMatchAt(r){let d=this.type.contentMatch.matchFragment(this.content,0,r);if(!d)throw new Error("Called contentMatchAt on a node with invalid content");return d}canReplace(r,d,g=T.empty,O=0,P=g.childCount){let N=this.contentMatchAt(r).matchFragment(g,O,P),nt=N&&N.matchFragment(this.content,d);if(!nt||!nt.validEnd)return!1;for(let _t=O;_t<P;_t++)if(!this.type.allowsMarks(g.child(_t).marks))return!1;return!0}canReplaceWith(r,d,g,O){if(O&&!this.type.allowsMarks(O))return!1;let P=this.contentMatchAt(r).matchType(g),N=P&&P.matchFragment(this.content,d);return!!N&&N.validEnd}canAppend(r){return r.content.size?this.canReplace(this.childCount,this.childCount,r.content):this.type.compatibleContent(r.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let r=$.none;for(let d=0;d<this.marks.length;d++)r=this.marks[d].addToSet(r);if(!$.sameSet(r,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(d=>d.type.name)}`);this.content.forEach(d=>d.check())}toJSON(){let r={type:this.type.name};for(let d in this.attrs){r.attrs=this.attrs;break}return this.content.size&&(r.content=this.content.toJSON()),this.marks.length&&(r.marks=this.marks.map(d=>d.toJSON())),r}static fromJSON(r,d){if(!d)throw new RangeError("Invalid input for Node.fromJSON");let g=null;if(d.marks){if(!Array.isArray(d.marks))throw new RangeError("Invalid mark data for Node.fromJSON");g=d.marks.map(r.markFromJSON)}if("text"==d.type){if("string"!=typeof d.text)throw new RangeError("Invalid text node in JSON");return r.text(d.text,g)}let O=T.fromJSON(r,d.content);return r.nodeType(d.type).create(d.attrs,O,g)}}tt.prototype.text=void 0;class b extends tt{constructor(r,d,g,O){if(super(r,d,null,O),!g)throw new RangeError("Empty text nodes are not allowed");this.text=g}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):F(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(r,d){return this.text.slice(r,d)}get nodeSize(){return this.text.length}mark(r){return r==this.marks?this:new b(this.type,this.attrs,this.text,r)}withText(r){return r==this.text?this:new b(this.type,this.attrs,r,this.marks)}cut(r=0,d=this.text.length){return 0==r&&d==this.text.length?this:this.withText(this.text.slice(r,d))}eq(r){return this.sameMarkup(r)&&this.text==r.text}toJSON(){let r=super.toJSON();return r.text=this.text,r}}function F(S,r){for(let d=S.length-1;d>=0;d--)r=S[d].type.name+"("+r+")";return r}class J{constructor(r){this.validEnd=r,this.next=[],this.wrapCache=[]}static parse(r,d){let g=new ut(r,d);if(null==g.next)return J.empty;let O=B(g);g.next&&g.err("Unexpected trailing text");let P=function(S){let r=Object.create(null);return function d(g){let O=[];g.forEach(N=>{S[N].forEach(({term:nt,to:_t})=>{if(!nt)return;let k;for(let A=0;A<O.length;A++)O[A][0]==nt&&(k=O[A][1]);be(S,_t).forEach(A=>{k||O.push([nt,k=[]]),-1==k.indexOf(A)&&k.push(A)})})});let P=r[g.join(",")]=new J(g.indexOf(S.length-1)>-1);for(let N=0;N<O.length;N++){let nt=O[N][1].sort(ve);P.next.push({type:O[N][0],next:r[nt.join(",")]||d(nt)})}return P}(be(S,0))}(function(S){let r=[[]];return O(function P(N,nt){if("choice"==N.type)return N.exprs.reduce((_t,k)=>_t.concat(P(k,nt)),[]);if("seq"!=N.type){if("star"==N.type){let _t=d();return g(nt,_t),O(P(N.expr,_t),_t),[g(_t)]}if("plus"==N.type){let _t=d();return O(P(N.expr,nt),_t),O(P(N.expr,_t),_t),[g(_t)]}if("opt"==N.type)return[g(nt)].concat(P(N.expr,nt));if("range"==N.type){let _t=nt;for(let k=0;k<N.min;k++){let A=d();O(P(N.expr,_t),A),_t=A}if(-1==N.max)O(P(N.expr,_t),_t);else for(let k=N.min;k<N.max;k++){let A=d();g(_t,A),O(P(N.expr,_t),A),_t=A}return[g(_t)]}if("name"==N.type)return[g(nt,void 0,N.value)];throw new Error("Unknown expr type")}for(let _t=0;;_t++){let k=P(N.exprs[_t],nt);if(_t==N.exprs.length-1)return k;O(k,nt=d())}}(S,0),d()),r;function d(){return r.push([])-1}function g(N,nt,_t){let k={term:_t,to:nt};return r[N].push(k),k}function O(N,nt){N.forEach(_t=>_t.to=nt)}}(O));return function(S,r){for(let d=0,g=[S];d<g.length;d++){let O=g[d],P=!O.validEnd,N=[];for(let nt=0;nt<O.next.length;nt++){let{type:_t,next:k}=O.next[nt];N.push(_t.name),P&&!(_t.isText||_t.hasRequiredAttrs())&&(P=!1),-1==g.indexOf(k)&&g.push(k)}P&&r.err("Only non-generatable nodes ("+N.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(P,g),P}matchType(r){for(let d=0;d<this.next.length;d++)if(this.next[d].type==r)return this.next[d].next;return null}matchFragment(r,d=0,g=r.childCount){let O=this;for(let P=d;O&&P<g;P++)O=O.matchType(r.child(P).type);return O}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let r=0;r<this.next.length;r++){let{type:d}=this.next[r];if(!d.isText&&!d.hasRequiredAttrs())return d}return null}compatible(r){for(let d=0;d<this.next.length;d++)for(let g=0;g<r.next.length;g++)if(this.next[d].type==r.next[g].type)return!0;return!1}fillBefore(r,d=!1,g=0){let O=[this];return function P(N,nt){let _t=N.matchFragment(r,g);if(_t&&(!d||_t.validEnd))return T.from(nt.map(k=>k.createAndFill()));for(let k=0;k<N.next.length;k++){let{type:A,next:W}=N.next[k];if(!A.isText&&!A.hasRequiredAttrs()&&-1==O.indexOf(W)){O.push(W);let et=P(W,nt.concat(A));if(et)return et}}return null}(this,[])}findWrapping(r){for(let g=0;g<this.wrapCache.length;g+=2)if(this.wrapCache[g]==r)return this.wrapCache[g+1];let d=this.computeWrapping(r);return this.wrapCache.push(r,d),d}computeWrapping(r){let d=Object.create(null),g=[{match:this,type:null,via:null}];for(;g.length;){let O=g.shift(),P=O.match;if(P.matchType(r)){let N=[];for(let nt=O;nt.type;nt=nt.via)N.push(nt.type);return N.reverse()}for(let N=0;N<P.next.length;N++){let{type:nt,next:_t}=P.next[N];!nt.isLeaf&&!nt.hasRequiredAttrs()&&!(nt.name in d)&&(!O.type||_t.validEnd)&&(g.push({match:nt.contentMatch,type:nt,via:O}),d[nt.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(r){if(r>=this.next.length)throw new RangeError(`There's no ${r}th edge in this content match`);return this.next[r]}toString(){let r=[];return function d(g){r.push(g);for(let O=0;O<g.next.length;O++)-1==r.indexOf(g.next[O].next)&&d(g.next[O].next)}(this),r.map((g,O)=>{let P=O+(g.validEnd?"*":" ")+" ";for(let N=0;N<g.next.length;N++)P+=(N?", ":"")+g.next[N].type.name+"->"+r.indexOf(g.next[N].next);return P}).join("\n")}}J.empty=new J(!0);class ut{constructor(r,d){this.string=r,this.nodeTypes=d,this.inline=null,this.pos=0,this.tokens=r.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(r){return this.next==r&&(this.pos++||!0)}err(r){throw new SyntaxError(r+" (in content expression '"+this.string+"')")}}function B(S){let r=[];do{r.push(z(S))}while(S.eat("|"));return 1==r.length?r[0]:{type:"choice",exprs:r}}function z(S){let r=[];do{r.push(q(S))}while(S.next&&")"!=S.next&&"|"!=S.next);return 1==r.length?r[0]:{type:"seq",exprs:r}}function q(S){let r=function(S){if(S.eat("(")){let r=B(S);return S.eat(")")||S.err("Missing closing paren"),r}if(!/\W/.test(S.next)){let r=function(S,r){let d=S.nodeTypes,g=d[r];if(g)return[g];let O=[];for(let P in d){let N=d[P];N.groups.indexOf(r)>-1&&O.push(N)}return 0==O.length&&S.err("No node type or group '"+r+"' found"),O}(S,S.next).map(d=>(null==S.inline?S.inline=d.isInline:S.inline!=d.isInline&&S.err("Mixing inline and block content"),{type:"name",value:d}));return S.pos++,1==r.length?r[0]:{type:"choice",exprs:r}}S.err("Unexpected token '"+S.next+"'")}(S);for(;;)if(S.eat("+"))r={type:"plus",expr:r};else if(S.eat("*"))r={type:"star",expr:r};else if(S.eat("?"))r={type:"opt",expr:r};else{if(!S.eat("{"))break;r=kt(S,r)}return r}function xt(S){/\D/.test(S.next)&&S.err("Expected number, got '"+S.next+"'");let r=Number(S.next);return S.pos++,r}function kt(S,r){let d=xt(S),g=d;return S.eat(",")&&(g="}"!=S.next?xt(S):-1),S.eat("}")||S.err("Unclosed braced range"),{type:"range",min:d,max:g,expr:r}}function ve(S,r){return r-S}function be(S,r){let d=[];return function g(O){let P=S[O];if(1==P.length&&!P[0].term)return g(P[0].to);d.push(O);for(let N=0;N<P.length;N++){let{term:nt,to:_t}=P[N];!nt&&-1==d.indexOf(_t)&&g(_t)}}(r),d.sort(ve)}function Ce(S){let r=Object.create(null);for(let d in S){let g=S[d];if(!g.hasDefault)return null;r[d]=g.default}return r}function Xt(S,r){let d=Object.create(null);for(let g in S){let O=r&&r[g];if(void 0===O){let P=S[g];if(!P.hasDefault)throw new RangeError("No value supplied for attribute "+g);O=P.default}d[g]=O}return d}function ie(S){let r=Object.create(null);if(S)for(let d in S)r[d]=new Me(S[d]);return r}class ee{constructor(r,d,g){this.name=r,this.schema=d,this.spec=g,this.markSet=null,this.groups=g.group?g.group.split(" "):[],this.attrs=ie(g.attrs),this.defaultAttrs=Ce(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(g.inline||"text"==r),this.isText="text"==r}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==J.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let r in this.attrs)if(this.attrs[r].isRequired)return!0;return!1}compatibleContent(r){return this==r||this.contentMatch.compatible(r.contentMatch)}computeAttrs(r){return!r&&this.defaultAttrs?this.defaultAttrs:Xt(this.attrs,r)}create(r=null,d,g){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new tt(this,this.computeAttrs(r),T.from(d),$.setFrom(g))}createChecked(r=null,d,g){if(d=T.from(d),!this.validContent(d))throw new RangeError("Invalid content for node "+this.name);return new tt(this,this.computeAttrs(r),d,$.setFrom(g))}createAndFill(r=null,d,g){if(r=this.computeAttrs(r),(d=T.from(d)).size){let N=this.contentMatch.fillBefore(d);if(!N)return null;d=N.append(d)}let O=this.contentMatch.matchFragment(d),P=O&&O.fillBefore(T.empty,!0);return P?new tt(this,r,d.append(P),$.setFrom(g)):null}validContent(r){let d=this.contentMatch.matchFragment(r);if(!d||!d.validEnd)return!1;for(let g=0;g<r.childCount;g++)if(!this.allowsMarks(r.child(g).marks))return!1;return!0}allowsMarkType(r){return null==this.markSet||this.markSet.indexOf(r)>-1}allowsMarks(r){if(null==this.markSet)return!0;for(let d=0;d<r.length;d++)if(!this.allowsMarkType(r[d].type))return!1;return!0}allowedMarks(r){if(null==this.markSet)return r;let d;for(let g=0;g<r.length;g++)this.allowsMarkType(r[g].type)?d&&d.push(r[g]):d||(d=r.slice(0,g));return d?d.length?d:$.none:r}static compile(r,d){let g=Object.create(null);r.forEach((P,N)=>g[P]=new ee(P,d,N));let O=d.spec.topNode||"doc";if(!g[O])throw new RangeError("Schema is missing its top node type ('"+O+"')");if(!g.text)throw new RangeError("Every schema needs a 'text' type");for(let P in g.text.attrs)throw new RangeError("The text node type should not have attributes");return g}}class Me{constructor(r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default}get isRequired(){return!this.hasDefault}}class me{constructor(r,d,g,O){this.name=r,this.rank=d,this.schema=g,this.spec=O,this.attrs=ie(O.attrs),this.excluded=null;let P=Ce(this.attrs);this.instance=P?new $(this,P):null}create(r=null){return!r&&this.instance?this.instance:new $(this,Xt(this.attrs,r))}static compile(r,d){let g=Object.create(null),O=0;return r.forEach((P,N)=>g[P]=new me(P,O++,d,N)),g}removeFromSet(r){for(var d=0;d<r.length;d++)r[d].type==this&&(r=r.slice(0,d).concat(r.slice(d+1)),d--);return r}isInSet(r){for(let d=0;d<r.length;d++)if(r[d].type==this)return r[d]}excludes(r){return this.excluded.indexOf(r)>-1}}class ne{constructor(r){this.cached=Object.create(null),this.spec={nodes:i.from(r.nodes),marks:i.from(r.marks||{}),topNode:r.topNode},this.nodes=ee.compile(this.spec.nodes,this),this.marks=me.compile(this.spec.marks,this);let d=Object.create(null);for(let g in this.nodes){if(g in this.marks)throw new RangeError(g+" can not be both a node and a mark");let O=this.nodes[g],P=O.spec.content||"",N=O.spec.marks;O.contentMatch=d[P]||(d[P]=J.parse(P,this.nodes)),O.inlineContent=O.contentMatch.inlineContent,O.markSet="_"==N?null:N?Ee(this,N.split(" ")):""!=N&&O.inlineContent?null:[]}for(let g in this.marks){let O=this.marks[g],P=O.spec.excludes;O.excluded=null==P?[O]:""==P?[]:Ee(this,P.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(r,d=null,g,O){if("string"==typeof r)r=this.nodeType(r);else{if(!(r instanceof ee))throw new RangeError("Invalid node type: "+r);if(r.schema!=this)throw new RangeError("Node type from different schema used ("+r.name+")")}return r.createChecked(d,g,O)}text(r,d){let g=this.nodes.text;return new b(g,g.defaultAttrs,r,$.setFrom(d))}mark(r,d){return"string"==typeof r&&(r=this.marks[r]),r.create(d)}nodeFromJSON(r){return tt.fromJSON(this,r)}markFromJSON(r){return $.fromJSON(this,r)}nodeType(r){let d=this.nodes[r];if(!d)throw new RangeError("Unknown node type: "+r);return d}}function Ee(S,r){let d=[];for(let g=0;g<r.length;g++){let O=r[g],P=S.marks[O],N=P;if(P)d.push(P);else for(let nt in S.marks){let _t=S.marks[nt];("_"==O||_t.spec.group&&_t.spec.group.split(" ").indexOf(O)>-1)&&d.push(N=_t)}if(!N)throw new SyntaxError("Unknown mark type: '"+r[g]+"'")}return d}class _e{constructor(r,d){this.schema=r,this.rules=d,this.tags=[],this.styles=[],d.forEach(g=>{g.tag?this.tags.push(g):g.style&&this.styles.push(g)}),this.normalizeLists=!this.tags.some(g=>{if(!/^(ul|ol)\b/.test(g.tag)||!g.node)return!1;let O=r.nodes[g.node];return O.contentMatch.matchType(O)})}parse(r,d={}){let g=new qt(this,d,!1);return g.addAll(r,d.from,d.to),g.finish()}parseSlice(r,d={}){let g=new qt(this,d,!0);return g.addAll(r,d.from,d.to),X.maxOpen(g.finish())}matchTag(r,d,g){for(let O=g?this.tags.indexOf(g)+1:0;O<this.tags.length;O++){let P=this.tags[O];if(m(r,P.tag)&&(void 0===P.namespace||r.namespaceURI==P.namespace)&&(!P.context||d.matchesContext(P.context))){if(P.getAttrs){let N=P.getAttrs(r);if(!1===N)continue;P.attrs=N||void 0}return P}}}matchStyle(r,d,g,O){for(let P=O?this.styles.indexOf(O)+1:0;P<this.styles.length;P++){let N=this.styles[P],nt=N.style;if(!(0!=nt.indexOf(r)||N.context&&!g.matchesContext(N.context)||nt.length>r.length&&(61!=nt.charCodeAt(r.length)||nt.slice(r.length+1)!=d))){if(N.getAttrs){let _t=N.getAttrs(d);if(!1===_t)continue;N.attrs=_t||void 0}return N}}}static schemaRules(r){let d=[];function g(O){let P=null==O.priority?50:O.priority,N=0;for(;N<d.length;N++){let nt=d[N];if((null==nt.priority?50:nt.priority)<P)break}d.splice(N,0,O)}for(let O in r.marks){let P=r.marks[O].spec.parseDOM;P&&P.forEach(N=>{g(N=M(N)),N.mark=O})}for(let O in r.nodes){let P=r.nodes[O].spec.parseDOM;P&&P.forEach(N=>{g(N=M(N)),N.node=O})}return d}static fromSchema(r){return r.cached.domParser||(r.cached.domParser=new _e(r,_e.schemaRules(r)))}}const le={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},xe={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ce={ol:!0,ul:!0};function St(S,r,d){return null!=r?(r?1:0)|("full"===r?2:0):S&&"pre"==S.whitespace?3:-5&d}class Gt{constructor(r,d,g,O,P,N,nt){this.type=r,this.attrs=d,this.marks=g,this.pendingMarks=O,this.solid=P,this.options=nt,this.content=[],this.activeMarks=$.none,this.stashMarks=[],this.match=N||(4&nt?null:r.contentMatch)}findWrapping(r){if(!this.match){if(!this.type)return[];let d=this.type.contentMatch.fillBefore(T.from(r));if(!d){let O,g=this.type.contentMatch;return(O=g.findWrapping(r.type))?(this.match=g,O):null}this.match=this.type.contentMatch.matchFragment(d)}return this.match.findWrapping(r.type)}finish(r){if(!(1&this.options)){let O,g=this.content[this.content.length-1];if(g&&g.isText&&(O=/[ \t\r\n\u000c]+$/.exec(g.text))){let P=g;g.text.length==O[0].length?this.content.pop():this.content[this.content.length-1]=P.withText(P.text.slice(0,P.text.length-O[0].length))}}let d=T.from(this.content);return!r&&this.match&&(d=d.append(this.match.fillBefore(T.empty,!0))),this.type?this.type.create(this.attrs,d,this.marks):d}popFromStashMark(r){for(let d=this.stashMarks.length-1;d>=0;d--)if(r.eq(this.stashMarks[d]))return this.stashMarks.splice(d,1)[0]}applyPending(r){for(let d=0,g=this.pendingMarks;d<g.length;d++){let O=g[d];(this.type?this.type.allowsMarkType(O.type):I(O.type,r))&&!O.isInSet(this.activeMarks)&&(this.activeMarks=O.addToSet(this.activeMarks),this.pendingMarks=O.removeFromSet(this.pendingMarks))}}inlineContext(r){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:r.parentNode&&!le.hasOwnProperty(r.parentNode.nodeName.toLowerCase())}}class qt{constructor(r,d,g){this.parser=r,this.options=d,this.isOpen=g,this.open=0;let P,O=d.topNode,N=St(null,d.preserveWhitespace,0)|(g?4:0);P=O?new Gt(O.type,O.attrs,$.none,$.none,!0,d.topMatch||O.type.contentMatch,N):new Gt(g?null:r.schema.topNodeType,null,$.none,$.none,!0,null,N),this.nodes=[P],this.find=d.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(r){if(3==r.nodeType)this.addTextNode(r);else if(1==r.nodeType){let d=r.getAttribute("style"),g=d?this.readStyles(function(S){let d,r=/\s*([\w-]+)\s*:\s*([^;]+)/g,g=[];for(;d=r.exec(S);)g.push(d[1],d[2].trim());return g}(d)):null,O=this.top;if(null!=g)for(let P=0;P<g.length;P++)this.addPendingMark(g[P]);if(this.addElement(r),null!=g)for(let P=0;P<g.length;P++)this.removePendingMark(g[P],O)}}addTextNode(r){let d=r.nodeValue,g=this.top;if(2&g.options||g.inlineContext(r)||/[^ \t\r\n\u000c]/.test(d)){if(1&g.options)d=2&g.options?d.replace(/\r\n?/g,"\n"):d.replace(/\r?\n|\r/g," ");else if(d=d.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(d)&&this.open==this.nodes.length-1){let O=g.content[g.content.length-1],P=r.previousSibling;(!O||P&&"BR"==P.nodeName||O.isText&&/[ \t\r\n\u000c]$/.test(O.text))&&(d=d.slice(1))}d&&this.insertNode(this.parser.schema.text(d)),this.findInText(r)}else this.findInside(r)}addElement(r,d){let O,g=r.nodeName.toLowerCase();ce.hasOwnProperty(g)&&this.parser.normalizeLists&&function(S){for(let r=S.firstChild,d=null;r;r=r.nextSibling){let g=1==r.nodeType?r.nodeName.toLowerCase():null;g&&ce.hasOwnProperty(g)&&d?(d.appendChild(r),r=d):"li"==g?d=r:g&&(d=null)}}(r);let P=this.options.ruleFromNode&&this.options.ruleFromNode(r)||(O=this.parser.matchTag(r,this,d));if(P?P.ignore:xe.hasOwnProperty(g))this.findInside(r),this.ignoreFallback(r);else if(!P||P.skip||P.closeParent){P&&P.closeParent?this.open=Math.max(0,this.open-1):P&&P.skip.nodeType&&(r=P.skip);let N,nt=this.top,_t=this.needsBlock;if(le.hasOwnProperty(g))N=!0,nt.type||(this.needsBlock=!0);else if(!r.firstChild)return void this.leafFallback(r);this.addAll(r),N&&this.sync(nt),this.needsBlock=_t}else this.addElementByRule(r,P,!1===P.consuming?O:void 0)}leafFallback(r){"BR"==r.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(r.ownerDocument.createTextNode("\n"))}ignoreFallback(r){"BR"==r.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(r){let d=$.none;t:for(let g=0;g<r.length;g+=2)for(let O;;){let P=this.parser.matchStyle(r[g],r[g+1],this,O);if(!P)continue t;if(P.ignore)return null;if(d=this.parser.schema.marks[P.mark].create(P.attrs).addToSet(d),!1!==P.consuming)break;O=P}return d}addElementByRule(r,d,g){let O,P,N;d.node?(P=this.parser.schema.nodes[d.node],P.isLeaf?this.insertNode(P.create(d.attrs))||this.leafFallback(r):O=this.enter(P,d.attrs||null,d.preserveWhitespace)):(N=this.parser.schema.marks[d.mark].create(d.attrs),this.addPendingMark(N));let nt=this.top;if(P&&P.isLeaf)this.findInside(r);else if(g)this.addElement(r,g);else if(d.getContent)this.findInside(r),d.getContent(r,this.parser.schema).forEach(_t=>this.insertNode(_t));else{let _t=r;"string"==typeof d.contentElement?_t=r.querySelector(d.contentElement):"function"==typeof d.contentElement?_t=d.contentElement(r):d.contentElement&&(_t=d.contentElement),this.findAround(r,_t,!0),this.addAll(_t)}O&&this.sync(nt)&&this.open--,N&&this.removePendingMark(N,nt)}addAll(r,d,g){let O=d||0;for(let P=d?r.childNodes[d]:r.firstChild,N=null==g?null:r.childNodes[g];P!=N;P=P.nextSibling,++O)this.findAtPoint(r,O),this.addDOM(P);this.findAtPoint(r,O)}findPlace(r){let d,g;for(let O=this.open;O>=0;O--){let P=this.nodes[O],N=P.findWrapping(r);if(N&&(!d||d.length>N.length)&&(d=N,g=P,!N.length)||P.solid)break}if(!d)return!1;this.sync(g);for(let O=0;O<d.length;O++)this.enterInner(d[O],null,!1);return!0}insertNode(r){if(r.isInline&&this.needsBlock&&!this.top.type){let d=this.textblockFromContext();d&&this.enterInner(d)}if(this.findPlace(r)){this.closeExtra();let d=this.top;d.applyPending(r.type),d.match&&(d.match=d.match.matchType(r.type));let g=d.activeMarks;for(let O=0;O<r.marks.length;O++)(!d.type||d.type.allowsMarkType(r.marks[O].type))&&(g=r.marks[O].addToSet(g));return d.content.push(r.mark(g)),!0}return!1}enter(r,d,g){let O=this.findPlace(r.create(d));return O&&this.enterInner(r,d,!0,g),O}enterInner(r,d=null,g=!1,O){this.closeExtra();let P=this.top;P.applyPending(r),P.match=P.match&&P.match.matchType(r);let N=St(r,O,P.options);4&P.options&&0==P.content.length&&(N|=4),this.nodes.push(new Gt(r,d,P.activeMarks,P.pendingMarks,g,null,N)),this.open++}closeExtra(r=!1){let d=this.nodes.length-1;if(d>this.open){for(;d>this.open;d--)this.nodes[d-1].content.push(this.nodes[d].finish(r));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(r){for(let d=this.open;d>=0;d--)if(this.nodes[d]==r)return this.open=d,!0;return!1}get currentPos(){this.closeExtra();let r=0;for(let d=this.open;d>=0;d--){let g=this.nodes[d].content;for(let O=g.length-1;O>=0;O--)r+=g[O].nodeSize;d&&r++}return r}findAtPoint(r,d){if(this.find)for(let g=0;g<this.find.length;g++)this.find[g].node==r&&this.find[g].offset==d&&(this.find[g].pos=this.currentPos)}findInside(r){if(this.find)for(let d=0;d<this.find.length;d++)null==this.find[d].pos&&1==r.nodeType&&r.contains(this.find[d].node)&&(this.find[d].pos=this.currentPos)}findAround(r,d,g){if(r!=d&&this.find)for(let O=0;O<this.find.length;O++)null==this.find[O].pos&&1==r.nodeType&&r.contains(this.find[O].node)&&d.compareDocumentPosition(this.find[O].node)&(g?2:4)&&(this.find[O].pos=this.currentPos)}findInText(r){if(this.find)for(let d=0;d<this.find.length;d++)this.find[d].node==r&&(this.find[d].pos=this.currentPos-(r.nodeValue.length-this.find[d].offset))}matchesContext(r){if(r.indexOf("|")>-1)return r.split(/\s*\|\s*/).some(this.matchesContext,this);let d=r.split("/"),g=this.options.context,O=!(this.isOpen||g&&g.parent.type!=this.nodes[0].type),P=(O?0:1)-(g?g.depth+1:0),N=(nt,_t)=>{for(;nt>=0;nt--){let k=d[nt];if(""==k){if(nt==d.length-1||0==nt)continue;for(;_t>=P;_t--)if(N(nt-1,_t))return!0;return!1}{let A=_t>0||0==_t&&O?this.nodes[_t].type:g&&_t>=P?g.node(_t-P).type:null;if(!A||A.name!=k&&-1==A.groups.indexOf(k))return!1;_t--}}return!0};return N(d.length-1,this.open)}textblockFromContext(){let r=this.options.context;if(r)for(let d=r.depth;d>=0;d--){let g=r.node(d).contentMatchAt(r.indexAfter(d)).defaultType;if(g&&g.isTextblock&&g.defaultAttrs)return g}for(let d in this.parser.schema.nodes){let g=this.parser.schema.nodes[d];if(g.isTextblock&&g.defaultAttrs)return g}}addPendingMark(r){let d=function(S,r){for(let d=0;d<r.length;d++)if(S.eq(r[d]))return r[d]}(r,this.top.pendingMarks);d&&this.top.stashMarks.push(d),this.top.pendingMarks=r.addToSet(this.top.pendingMarks)}removePendingMark(r,d){for(let g=this.open;g>=0;g--){let O=this.nodes[g];if(O.pendingMarks.lastIndexOf(r)>-1)O.pendingMarks=r.removeFromSet(O.pendingMarks);else{O.activeMarks=r.removeFromSet(O.activeMarks);let N=O.popFromStashMark(r);N&&O.type&&O.type.allowsMarkType(N.type)&&(O.activeMarks=N.addToSet(O.activeMarks))}if(O==d)break}}}function m(S,r){return(S.matches||S.msMatchesSelector||S.webkitMatchesSelector||S.mozMatchesSelector).call(S,r)}function M(S){let r={};for(let d in S)r[d]=S[d];return r}function I(S,r){let d=r.schema.nodes;for(let g in d){let O=d[g];if(!O.allowsMarkType(S))continue;let P=[],N=nt=>{P.push(nt);for(let _t=0;_t<nt.edgeCount;_t++){let{type:k,next:A}=nt.edge(_t);if(k==r||P.indexOf(A)<0&&N(A))return!0}};if(N(O.contentMatch))return!0}}class it{constructor(r,d){this.nodes=r,this.marks=d}serializeFragment(r,d={},g){g||(g=Dt(d).createDocumentFragment());let O=g,P=[];return r.forEach(N=>{if(P.length||N.marks.length){let nt=0,_t=0;for(;nt<P.length&&_t<N.marks.length;){let k=N.marks[_t];if(this.marks[k.type.name]){if(!k.eq(P[nt][0])||!1===k.type.spec.spanning)break;nt++,_t++}else _t++}for(;nt<P.length;)O=P.pop()[1];for(;_t<N.marks.length;){let k=N.marks[_t++],A=this.serializeMark(k,N.isInline,d);A&&(P.push([k,O]),O.appendChild(A.dom),O=A.contentDOM||A.dom)}}O.appendChild(this.serializeNodeInner(N,d))}),g}serializeNodeInner(r,d){let{dom:g,contentDOM:O}=it.renderSpec(Dt(d),this.nodes[r.type.name](r));if(O){if(r.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(r.content,d,O)}return g}serializeNode(r,d={}){let g=this.serializeNodeInner(r,d);for(let O=r.marks.length-1;O>=0;O--){let P=this.serializeMark(r.marks[O],r.isInline,d);P&&((P.contentDOM||P.dom).appendChild(g),g=P.dom)}return g}serializeMark(r,d,g={}){let O=this.marks[r.type.name];return O&&it.renderSpec(Dt(g),O(r,d))}static renderSpec(r,d,g=null){if("string"==typeof d)return{dom:r.createTextNode(d)};if(null!=d.nodeType)return{dom:d};if(d.dom&&null!=d.dom.nodeType)return d;let O=d[0],P=O.indexOf(" ");P>0&&(g=O.slice(0,P),O=O.slice(P+1));let N,nt=g?r.createElementNS(g,O):r.createElement(O),_t=d[1],k=1;if(_t&&"object"==typeof _t&&null==_t.nodeType&&!Array.isArray(_t)){k=2;for(let A in _t)if(null!=_t[A]){let W=A.indexOf(" ");W>0?nt.setAttributeNS(A.slice(0,W),A.slice(W+1),_t[A]):nt.setAttribute(A,_t[A])}}for(let A=k;A<d.length;A++){let W=d[A];if(0===W){if(A<d.length-1||A>k)throw new RangeError("Content hole must be the only child of its parent node");return{dom:nt,contentDOM:nt}}{let{dom:et,contentDOM:rt}=it.renderSpec(r,W,g);if(nt.appendChild(et),rt){if(N)throw new RangeError("Multiple content holes");N=rt}}}return{dom:nt,contentDOM:N}}static fromSchema(r){return r.cached.domSerializer||(r.cached.domSerializer=new it(this.nodesFromSchema(r),this.marksFromSchema(r)))}static nodesFromSchema(r){let d=yt(r.nodes);return d.text||(d.text=g=>g.text),d}static marksFromSchema(r){return yt(r.marks)}}function yt(S){let r={};for(let d in S){let g=S[d].spec.toDOM;g&&(r[d]=g)}return r}function Dt(S){return S.document||window.document}},62463:(It,pt,c)=>{c.d(pt,{C1:()=>gt,yy:()=>ft,qv:()=>ct,Sy:()=>lt,H$:()=>Bt,Y1:()=>x,xm:()=>T,Bs:()=>G});var C=c(35917),i=c(38480);const w=Object.create(null);class x{constructor(b,F,J){this.$anchor=b,this.$head=F,this.ranges=J||[new T(b.min(F),b.max(F))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let b=this.ranges;for(let F=0;F<b.length;F++)if(b[F].$from.pos!=b[F].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(b,F=C.p2.empty){let J=F.content.lastChild,ut=null;for(let q=0;q<F.openEnd;q++)ut=J,J=J.lastChild;let B=b.steps.length,z=this.ranges;for(let q=0;q<z.length;q++){let{$from:xt,$to:kt}=z[q],Rt=b.mapping.slice(B);b.replaceRange(Rt.map(xt.pos),Rt.map(kt.pos),q?C.p2.empty:F),0==q&&Mt(b,B,(J?J.isInline:ut&&ut.isTextblock)?-1:1)}}replaceWith(b,F){let J=b.steps.length,ut=this.ranges;for(let B=0;B<ut.length;B++){let{$from:z,$to:q}=ut[B],xt=b.mapping.slice(J),kt=xt.map(z.pos),Rt=xt.map(q.pos);B?b.deleteRange(kt,Rt):(b.replaceRangeWith(kt,Rt,F),Mt(b,J,F.isInline?-1:1))}}static findFrom(b,F,J=!1){let ut=b.parent.inlineContent?new G(b):dt(b.node(0),b.parent,b.pos,b.index(),F,J);if(ut)return ut;for(let B=b.depth-1;B>=0;B--){let z=F<0?dt(b.node(0),b.node(B),b.before(B+1),b.index(B),F,J):dt(b.node(0),b.node(B),b.after(B+1),b.index(B)+1,F,J);if(z)return z}return null}static near(b,F=1){return this.findFrom(b,F)||this.findFrom(b,-F)||new gt(b.node(0))}static atStart(b){return dt(b,b,0,0,1)||new gt(b)}static atEnd(b){return dt(b,b,b.content.size,b.childCount,-1)||new gt(b)}static fromJSON(b,F){if(!F||!F.type)throw new RangeError("Invalid input for Selection.fromJSON");let J=w[F.type];if(!J)throw new RangeError(`No selection type ${F.type} defined`);return J.fromJSON(b,F)}static jsonID(b,F){if(b in w)throw new RangeError("Duplicate use of selection JSON ID "+b);return w[b]=F,F.prototype.jsonID=b,F}getBookmark(){return G.between(this.$anchor,this.$head).getBookmark()}}x.prototype.visible=!0;class T{constructor(b,F){this.$from=b,this.$to=F}}let Q=!1;function D(tt){!Q&&!tt.parent.inlineContent&&(Q=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+tt.parent.type.name+")"))}class G extends x{constructor(b,F=b){D(b),D(F),super(b,F)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(b,F){let J=b.resolve(F.map(this.head));if(!J.parent.inlineContent)return x.near(J);let ut=b.resolve(F.map(this.anchor));return new G(ut.parent.inlineContent?ut:J,J)}replace(b,F=C.p2.empty){if(super.replace(b,F),F==C.p2.empty){let J=this.$from.marksAcross(this.$to);J&&b.ensureMarks(J)}}eq(b){return b instanceof G&&b.anchor==this.anchor&&b.head==this.head}getBookmark(){return new $(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(b,F){if("number"!=typeof F.anchor||"number"!=typeof F.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new G(b.resolve(F.anchor),b.resolve(F.head))}static create(b,F,J=F){let ut=b.resolve(F);return new this(ut,J==F?ut:b.resolve(J))}static between(b,F,J){let ut=b.pos-F.pos;if((!J||ut)&&(J=ut>=0?1:-1),!F.parent.inlineContent){let B=x.findFrom(F,J,!0)||x.findFrom(F,-J,!0);if(!B)return x.near(F,J);F=B.$head}return b.parent.inlineContent||(0==ut||(b=(x.findFrom(b,-J,!0)||x.findFrom(b,J,!0)).$anchor).pos<F.pos!=ut<0)&&(b=F),new G(b,F)}}x.jsonID("text",G);class ${constructor(b,F){this.anchor=b,this.head=F}map(b){return new $(b.map(this.anchor),b.map(this.head))}resolve(b){return G.between(b.resolve(this.anchor),b.resolve(this.head))}}class ct extends x{constructor(b){let F=b.nodeAfter,J=b.node(0).resolve(b.pos+F.nodeSize);super(b,J),this.node=F}map(b,F){let{deleted:J,pos:ut}=F.mapResult(this.anchor),B=b.resolve(ut);return J?x.near(B):new ct(B)}content(){return new C.p2(C.HY.from(this.node),0,0)}eq(b){return b instanceof ct&&b.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new X(this.anchor)}static fromJSON(b,F){if("number"!=typeof F.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ct(b.resolve(F.anchor))}static create(b,F){return new ct(b.resolve(F))}static isSelectable(b){return!b.isText&&!1!==b.type.spec.selectable}}ct.prototype.visible=!1,x.jsonID("node",ct);class X{constructor(b){this.anchor=b}map(b){let{deleted:F,pos:J}=b.mapResult(this.anchor);return F?new $(J,J):new X(J)}resolve(b){let F=b.resolve(this.anchor),J=F.nodeAfter;return J&&ct.isSelectable(J)?new ct(F):x.near(F)}}class gt extends x{constructor(b){super(b.resolve(0),b.resolve(b.content.size))}replace(b,F=C.p2.empty){if(F==C.p2.empty){b.delete(0,b.doc.content.size);let J=x.atStart(b.doc);J.eq(b.selection)||b.setSelection(J)}else super.replace(b,F)}toJSON(){return{type:"all"}}static fromJSON(b){return new gt(b)}map(b){return new gt(b)}eq(b){return b instanceof gt}getBookmark(){return ot}}x.jsonID("all",gt);const ot={map(){return this},resolve:tt=>new gt(tt)};function dt(tt,b,F,J,ut,B=!1){if(b.inlineContent)return G.create(tt,F);for(let z=J-(ut>0?0:1);ut>0?z<b.childCount:z>=0;z+=ut){let q=b.child(z);if(q.isAtom){if(!B&&ct.isSelectable(q))return ct.create(tt,F-(ut<0?q.nodeSize:0))}else{let xt=dt(tt,q,F+ut,ut<0?q.childCount:0,ut,B);if(xt)return xt}F+=q.nodeSize*ut}return null}function Mt(tt,b,F){let J=tt.steps.length-1;if(J<b)return;let z,ut=tt.steps[J];(ut instanceof i.Pu||ut instanceof i.FC)&&(tt.mapping.maps[J].forEach((q,xt,kt,Rt)=>{null==z&&(z=Rt)}),tt.setSelection(x.near(tt.doc.resolve(z),F)))}class U extends i.wx{constructor(b){super(b.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=b.selection,this.storedMarks=b.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(b){if(b.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=b,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(b){return this.storedMarks=b,this.updated|=2,this}ensureMarks(b){return C.vc.sameSet(this.storedMarks||this.selection.$from.marks(),b)||this.setStoredMarks(b),this}addStoredMark(b){return this.ensureMarks(b.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(b){return this.ensureMarks(b.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(b,F){super.addStep(b,F),this.updated=-3&this.updated,this.storedMarks=null}setTime(b){return this.time=b,this}replaceSelection(b){return this.selection.replace(this,b),this}replaceSelectionWith(b,F=!0){let J=this.selection;return F&&(b=b.mark(this.storedMarks||(J.empty?J.$from.marks():J.$from.marksAcross(J.$to)||C.vc.none))),J.replaceWith(this,b),this}deleteSelection(){return this.selection.replace(this),this}insertText(b,F,J){let ut=this.doc.type.schema;if(null==F)return b?this.replaceSelectionWith(ut.text(b),!0):this.deleteSelection();{if(null==J&&(J=F),J=null==J?F:J,!b)return this.deleteRange(F,J);let B=this.storedMarks;if(!B){let z=this.doc.resolve(F);B=J==F?z.marks():z.marksAcross(this.doc.resolve(J))}return this.replaceRangeWith(F,J,ut.text(b,B)),this.selection.empty||this.setSelection(x.near(this.selection.$to)),this}}setMeta(b,F){return this.meta["string"==typeof b?b:b.key]=F,this}getMeta(b){return this.meta["string"==typeof b?b:b.key]}get isGeneric(){for(let b in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function V(tt,b){return b&&tt?tt.bind(b):tt}class H{constructor(b,F,J){this.name=b,this.init=V(F.init,J),this.apply=V(F.apply,J)}}const ht=[new H("doc",{init:tt=>tt.doc||tt.schema.topNodeType.createAndFill(),apply:tt=>tt.doc}),new H("selection",{init:(tt,b)=>tt.selection||x.atStart(b.doc),apply:tt=>tt.selection}),new H("storedMarks",{init:tt=>tt.storedMarks||null,apply:(tt,b,F,J)=>J.selection.$cursor?tt.storedMarks:null}),new H("scrollToSelection",{init:()=>0,apply:(tt,b)=>tt.scrolledIntoView?b+1:b})];class at{constructor(b,F){this.schema=b,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ht.slice(),F&&F.forEach(J=>{if(this.pluginsByKey[J.key])throw new RangeError("Adding different instances of a keyed plugin ("+J.key+")");this.plugins.push(J),this.pluginsByKey[J.key]=J,J.spec.state&&this.fields.push(new H(J.key,J.spec.state,J))})}}class ft{constructor(b){this.config=b}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(b){return this.applyTransaction(b).state}filterTransaction(b,F=-1){for(let J=0;J<this.config.plugins.length;J++)if(J!=F){let ut=this.config.plugins[J];if(ut.spec.filterTransaction&&!ut.spec.filterTransaction.call(ut,b,this))return!1}return!0}applyTransaction(b){if(!this.filterTransaction(b))return{state:this,transactions:[]};let F=[b],J=this.applyInner(b),ut=null;for(;;){let B=!1;for(let z=0;z<this.config.plugins.length;z++){let q=this.config.plugins[z];if(q.spec.appendTransaction){let xt=ut?ut[z].n:0,kt=ut?ut[z].state:this,Rt=xt<F.length&&q.spec.appendTransaction.call(q,xt?F.slice(xt):F,kt,J);if(Rt&&J.filterTransaction(Rt,z)){if(Rt.setMeta("appendedTransaction",b),!ut){ut=[];for(let $t=0;$t<this.config.plugins.length;$t++)ut.push($t<z?{state:J,n:F.length}:{state:this,n:0})}F.push(Rt),J=J.applyInner(Rt),B=!0}ut&&(ut[z]={state:J,n:F.length})}}if(!B)return{state:J,transactions:F}}}applyInner(b){if(!b.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let F=new ft(this.config),J=this.config.fields;for(let ut=0;ut<J.length;ut++){let B=J[ut];F[B.name]=B.apply(b,this[B.name],this,F)}return F}get tr(){return new U(this)}static create(b){let F=new at(b.doc?b.doc.type.schema:b.schema,b.plugins),J=new ft(F);for(let ut=0;ut<F.fields.length;ut++)J[F.fields[ut].name]=F.fields[ut].init(b,J);return J}reconfigure(b){let F=new at(this.schema,b.plugins),J=F.fields,ut=new ft(F);for(let B=0;B<J.length;B++){let z=J[B].name;ut[z]=this.hasOwnProperty(z)?this[z]:J[B].init(b,ut)}return ut}toJSON(b){let F={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(F.storedMarks=this.storedMarks.map(J=>J.toJSON())),b&&"object"==typeof b)for(let J in b){if("doc"==J||"selection"==J)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let ut=b[J],B=ut.spec.state;B&&B.toJSON&&(F[J]=B.toJSON.call(ut,this[ut.key]))}return F}static fromJSON(b,F,J){if(!F)throw new RangeError("Invalid input for EditorState.fromJSON");if(!b.schema)throw new RangeError("Required config field 'schema' missing");let ut=new at(b.schema,b.plugins),B=new ft(ut);return ut.fields.forEach(z=>{if("doc"==z.name)B.doc=C.NB.fromJSON(b.schema,F.doc);else if("selection"==z.name)B.selection=x.fromJSON(B.doc,F.selection);else if("storedMarks"==z.name)F.storedMarks&&(B.storedMarks=F.storedMarks.map(b.schema.markFromJSON));else{if(J)for(let q in J){let xt=J[q],kt=xt.spec.state;if(xt.key==z.name&&kt&&kt.fromJSON&&Object.prototype.hasOwnProperty.call(F,q))return void(B[z.name]=kt.fromJSON.call(xt,b,F[q],B))}B[z.name]=z.init(b,B)}}),B}}function Ct(tt,b,F){for(let J in tt){let ut=tt[J];ut instanceof Function?ut=ut.bind(b):"handleDOMEvents"==J&&(ut=Ct(ut,b,{})),F[J]=ut}return F}class lt{constructor(b){this.spec=b,this.props={},b.props&&Ct(b.props,this,this.props),this.key=b.key?b.key.key:Pt("plugin")}getState(b){return b[this.key]}}const Ot=Object.create(null);function Pt(tt){return tt in Ot?tt+"$"+ ++Ot[tt]:(Ot[tt]=0,tt+"$")}class Bt{constructor(b="key"){this.key=Pt(b)}get(b){return b.config.pluginsByKey[this.key]}getState(b){return b[this.key]}}},38480:(It,pt,c)=>{c.d(pt,{vs:()=>ot,FC:()=>at,Pu:()=>ht,wx:()=>qt,Mn:()=>$t,Ax:()=>kt,nj:()=>te,nd:()=>b,k9:()=>Bt,dR:()=>Ce});var C=c(35917);const w=Math.pow(2,16);function x(j,m){return j+m*w}function T(j){return 65535&j}class X{constructor(m,v,M){this.pos=m,this.delInfo=v,this.recover=M}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class gt{constructor(m,v=!1){if(this.ranges=m,this.inverted=v,!m.length&&gt.empty)return gt.empty}recover(m){let v=0,M=T(m);if(!this.inverted)for(let I=0;I<M;I++)v+=this.ranges[3*I+2]-this.ranges[3*I+1];return this.ranges[3*M]+v+((j=m)-(65535&j))/w;var j}mapResult(m,v=1){return this._map(m,v,!1)}map(m,v=1){return this._map(m,v,!0)}_map(m,v,M){let I=0,K=this.inverted?2:1,it=this.inverted?1:2;for(let yt=0;yt<this.ranges.length;yt+=3){let Dt=this.ranges[yt]-(this.inverted?I:0);if(Dt>m)break;let S=this.ranges[yt+K],r=this.ranges[yt+it],d=Dt+S;if(m<=d){let O=Dt+I+((S?m==Dt?-1:m==d?1:v:v)<0?0:r);if(M)return O;let P=m==(v<0?Dt:d)?null:x(yt/3,m-Dt),N=m==Dt?2:m==d?1:4;return(v<0?m!=Dt:m!=d)&&(N|=8),new X(O,N,P)}I+=r-S}return M?m+I:new X(m+I,0,null)}touches(m,v){let M=0,I=T(v),K=this.inverted?2:1,it=this.inverted?1:2;for(let yt=0;yt<this.ranges.length;yt+=3){let Dt=this.ranges[yt]-(this.inverted?M:0);if(Dt>m)break;let S=this.ranges[yt+K];if(m<=Dt+S&&yt==3*I)return!0;M+=this.ranges[yt+it]-S}return!1}forEach(m){let v=this.inverted?2:1,M=this.inverted?1:2;for(let I=0,K=0;I<this.ranges.length;I+=3){let it=this.ranges[I],yt=it-(this.inverted?K:0),Dt=it+(this.inverted?0:K),S=this.ranges[I+v],r=this.ranges[I+M];m(yt,yt+S,Dt,Dt+r),K+=r-S}}invert(){return new gt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(m){return 0==m?gt.empty:new gt(m<0?[0,-m,0]:[0,0,m])}}gt.empty=new gt([]);class ot{constructor(m=[],v,M=0,I=m.length){this.maps=m,this.mirror=v,this.from=M,this.to=I}slice(m=0,v=this.maps.length){return new ot(this.maps,this.mirror,m,v)}copy(){return new ot(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(m,v){this.to=this.maps.push(m),null!=v&&this.setMirror(this.maps.length-1,v)}appendMapping(m){for(let v=0,M=this.maps.length;v<m.maps.length;v++){let I=m.getMirror(v);this.appendMap(m.maps[v],null!=I&&I<v?M+I:void 0)}}getMirror(m){if(this.mirror)for(let v=0;v<this.mirror.length;v++)if(this.mirror[v]==m)return this.mirror[v+(v%2?-1:1)]}setMirror(m,v){this.mirror||(this.mirror=[]),this.mirror.push(m,v)}appendMappingInverted(m){for(let v=m.maps.length-1,M=this.maps.length+m.maps.length;v>=0;v--){let I=m.getMirror(v);this.appendMap(m.maps[v].invert(),null!=I&&I>v?M-I-1:void 0)}}invert(){let m=new ot;return m.appendMappingInverted(this),m}map(m,v=1){if(this.mirror)return this._map(m,v,!0);for(let M=this.from;M<this.to;M++)m=this.maps[M].map(m,v);return m}mapResult(m,v=1){return this._map(m,v,!1)}_map(m,v,M){let I=0;for(let K=this.from;K<this.to;K++){let yt=this.maps[K].mapResult(m,v);if(null!=yt.recover){let Dt=this.getMirror(K);if(null!=Dt&&Dt>K&&Dt<this.to){K=Dt,m=this.maps[Dt].recover(yt.recover);continue}}I|=yt.delInfo,m=yt.pos}return M?m:new X(m,I,null)}}const dt=Object.create(null);class Mt{getMap(){return gt.empty}merge(m){return null}static fromJSON(m,v){if(!v||!v.stepType)throw new RangeError("Invalid input for Step.fromJSON");let M=dt[v.stepType];if(!M)throw new RangeError(`No step type ${v.stepType} defined`);return M.fromJSON(m,v)}static jsonID(m,v){if(m in dt)throw new RangeError("Duplicate use of step JSON ID "+m);return dt[m]=v,v.prototype.jsonID=m,v}}class vt{constructor(m,v){this.doc=m,this.failed=v}static ok(m){return new vt(m,null)}static fail(m){return new vt(null,m)}static fromReplace(m,v,M,I){try{return vt.ok(m.replace(v,M,I))}catch(K){if(K instanceof C.e4)return vt.fail(K.message);throw K}}}function Tt(j,m,v){let M=[];for(let I=0;I<j.childCount;I++){let K=j.child(I);K.content.size&&(K=K.copy(Tt(K.content,m,K))),K.isInline&&(K=m(K,v,I)),M.push(K)}return C.HY.fromArray(M)}class Z extends Mt{constructor(m,v,M){super(),this.from=m,this.to=v,this.mark=M}apply(m){let v=m.slice(this.from,this.to),M=m.resolve(this.from),I=M.node(M.sharedDepth(this.to)),K=new C.p2(Tt(v.content,(it,yt)=>it.isAtom&&yt.type.allowsMarkType(this.mark.type)?it.mark(this.mark.addToSet(it.marks)):it,I),v.openStart,v.openEnd);return vt.fromReplace(m,this.from,this.to,K)}invert(){return new U(this.from,this.to,this.mark)}map(m){let v=m.mapResult(this.from,1),M=m.mapResult(this.to,-1);return v.deleted&&M.deleted||v.pos>=M.pos?null:new Z(v.pos,M.pos,this.mark)}merge(m){return m instanceof Z&&m.mark.eq(this.mark)&&this.from<=m.to&&this.to>=m.from?new Z(Math.min(this.from,m.from),Math.max(this.to,m.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(m,v){if("number"!=typeof v.from||"number"!=typeof v.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Z(v.from,v.to,m.markFromJSON(v.mark))}}Mt.jsonID("addMark",Z);class U extends Mt{constructor(m,v,M){super(),this.from=m,this.to=v,this.mark=M}apply(m){let v=m.slice(this.from,this.to),M=new C.p2(Tt(v.content,I=>I.mark(this.mark.removeFromSet(I.marks)),m),v.openStart,v.openEnd);return vt.fromReplace(m,this.from,this.to,M)}invert(){return new Z(this.from,this.to,this.mark)}map(m){let v=m.mapResult(this.from,1),M=m.mapResult(this.to,-1);return v.deleted&&M.deleted||v.pos>=M.pos?null:new U(v.pos,M.pos,this.mark)}merge(m){return m instanceof U&&m.mark.eq(this.mark)&&this.from<=m.to&&this.to>=m.from?new U(Math.min(this.from,m.from),Math.max(this.to,m.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(m,v){if("number"!=typeof v.from||"number"!=typeof v.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new U(v.from,v.to,m.markFromJSON(v.mark))}}Mt.jsonID("removeMark",U);class V extends Mt{constructor(m,v){super(),this.pos=m,this.mark=v}apply(m){let v=m.nodeAt(this.pos);if(!v)return vt.fail("No node at mark step's position");let M=v.type.create(v.attrs,null,this.mark.addToSet(v.marks));return vt.fromReplace(m,this.pos,this.pos+1,new C.p2(C.HY.from(M),0,v.isLeaf?0:1))}invert(m){let v=m.nodeAt(this.pos);if(v){let M=this.mark.addToSet(v.marks);if(M.length==v.marks.length){for(let I=0;I<v.marks.length;I++)if(!v.marks[I].isInSet(M))return new V(this.pos,v.marks[I]);return new V(this.pos,this.mark)}}return new H(this.pos,this.mark)}map(m){let v=m.mapResult(this.pos,1);return v.deletedAfter?null:new V(v.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(m,v){if("number"!=typeof v.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new V(v.pos,m.markFromJSON(v.mark))}}Mt.jsonID("addNodeMark",V);class H extends Mt{constructor(m,v){super(),this.pos=m,this.mark=v}apply(m){let v=m.nodeAt(this.pos);if(!v)return vt.fail("No node at mark step's position");let M=v.type.create(v.attrs,null,this.mark.removeFromSet(v.marks));return vt.fromReplace(m,this.pos,this.pos+1,new C.p2(C.HY.from(M),0,v.isLeaf?0:1))}invert(m){let v=m.nodeAt(this.pos);return v&&this.mark.isInSet(v.marks)?new V(this.pos,this.mark):this}map(m){let v=m.mapResult(this.pos,1);return v.deletedAfter?null:new H(v.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(m,v){if("number"!=typeof v.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new H(v.pos,m.markFromJSON(v.mark))}}Mt.jsonID("removeNodeMark",H);class ht extends Mt{constructor(m,v,M,I=!1){super(),this.from=m,this.to=v,this.slice=M,this.structure=I}apply(m){return this.structure&&ft(m,this.from,this.to)?vt.fail("Structure replace would overwrite content"):vt.fromReplace(m,this.from,this.to,this.slice)}getMap(){return new gt([this.from,this.to-this.from,this.slice.size])}invert(m){return new ht(this.from,this.from+this.slice.size,m.slice(this.from,this.to))}map(m){let v=m.mapResult(this.from,1),M=m.mapResult(this.to,-1);return v.deletedAcross&&M.deletedAcross?null:new ht(v.pos,Math.max(v.pos,M.pos),this.slice)}merge(m){if(!(m instanceof ht)||m.structure||this.structure)return null;if(this.from+this.slice.size!=m.from||this.slice.openEnd||m.slice.openStart){if(m.to!=this.from||this.slice.openStart||m.slice.openEnd)return null;{let v=this.slice.size+m.slice.size==0?C.p2.empty:new C.p2(m.slice.content.append(this.slice.content),m.slice.openStart,this.slice.openEnd);return new ht(m.from,this.to,v,this.structure)}}{let v=this.slice.size+m.slice.size==0?C.p2.empty:new C.p2(this.slice.content.append(m.slice.content),this.slice.openStart,m.slice.openEnd);return new ht(this.from,this.to+(m.to-m.from),v,this.structure)}}toJSON(){let m={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(m.slice=this.slice.toJSON()),this.structure&&(m.structure=!0),m}static fromJSON(m,v){if("number"!=typeof v.from||"number"!=typeof v.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ht(v.from,v.to,C.p2.fromJSON(m,v.slice),!!v.structure)}}Mt.jsonID("replace",ht);class at extends Mt{constructor(m,v,M,I,K,it,yt=!1){super(),this.from=m,this.to=v,this.gapFrom=M,this.gapTo=I,this.slice=K,this.insert=it,this.structure=yt}apply(m){if(this.structure&&(ft(m,this.from,this.gapFrom)||ft(m,this.gapTo,this.to)))return vt.fail("Structure gap-replace would overwrite content");let v=m.slice(this.gapFrom,this.gapTo);if(v.openStart||v.openEnd)return vt.fail("Gap is not a flat range");let M=this.slice.insertAt(this.insert,v.content);return M?vt.fromReplace(m,this.from,this.to,M):vt.fail("Content does not fit in gap")}getMap(){return new gt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(m){let v=this.gapTo-this.gapFrom;return new at(this.from,this.from+this.slice.size+v,this.from+this.insert,this.from+this.insert+v,m.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(m){let v=m.mapResult(this.from,1),M=m.mapResult(this.to,-1),I=m.map(this.gapFrom,-1),K=m.map(this.gapTo,1);return v.deletedAcross&&M.deletedAcross||I<v.pos||K>M.pos?null:new at(v.pos,M.pos,I,K,this.slice,this.insert,this.structure)}toJSON(){let m={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(m.slice=this.slice.toJSON()),this.structure&&(m.structure=!0),m}static fromJSON(m,v){if("number"!=typeof v.from||"number"!=typeof v.to||"number"!=typeof v.gapFrom||"number"!=typeof v.gapTo||"number"!=typeof v.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new at(v.from,v.to,v.gapFrom,v.gapTo,C.p2.fromJSON(m,v.slice),v.insert,!!v.structure)}}function ft(j,m,v){let M=j.resolve(m),I=v-m,K=M.depth;for(;I>0&&K>0&&M.indexAfter(K)==M.node(K).childCount;)K--,I--;if(I>0){let it=M.node(K).maybeChild(M.indexAfter(K));for(;I>0;){if(!it||it.isLeaf)return!0;it=it.firstChild,I--}}return!1}function Pt(j,m,v){return(0==m||j.canReplace(m,j.childCount))&&(v==j.childCount||j.canReplace(0,v))}function Bt(j){let v=j.parent.content.cutByIndex(j.startIndex,j.endIndex);for(let M=j.depth;;--M){let I=j.$from.node(M),K=j.$from.index(M),it=j.$to.indexAfter(M);if(M<j.depth&&I.canReplace(K,it,v))return M;if(0==M||I.type.spec.isolating||!Pt(I,K,it))break}return null}function b(j,m,v=null,M=j){let I=function(j,m){let{parent:v,startIndex:M,endIndex:I}=j,K=v.contentMatchAt(M).findWrapping(m);return K&&v.canReplaceWith(M,I,K.length?K[0]:m)?K:null}(j,m),K=I&&function(j,m){let{parent:v,startIndex:M,endIndex:I}=j,K=v.child(M),it=m.contentMatch.findWrapping(K.type);if(!it)return null;let Dt=(it.length?it[it.length-1]:m).contentMatch;for(let S=M;Dt&&S<I;S++)Dt=Dt.matchType(v.child(S).type);return Dt&&Dt.validEnd?it:null}(M,m);return K?I.map(F).concat({type:m,attrs:v}).concat(K.map(F)):null}function F(j){return{type:j,attrs:null}}function kt(j,m,v=1,M){let I=j.resolve(m),K=I.depth-v,it=M&&M[M.length-1]||I.parent;if(K<0||I.parent.type.spec.isolating||!I.parent.canReplace(I.index(),I.parent.childCount)||!it.type.validContent(I.parent.content.cutByIndex(I.index(),I.parent.childCount)))return!1;for(let S=I.depth-1,r=v-2;S>K;S--,r--){let d=I.node(S),g=I.index(S);if(d.type.spec.isolating)return!1;let O=d.content.cutByIndex(g,d.childCount),P=M&&M[r]||d;if(P!=d&&(O=O.replaceChild(0,P.type.create(P.attrs))),!d.canReplace(g+1,d.childCount)||!P.type.validContent(O))return!1}let yt=I.indexAfter(K),Dt=M&&M[0];return I.node(K).canReplaceWith(yt,yt,Dt?Dt.type:I.node(K+1).type)}function $t(j,m){let v=j.resolve(m),M=v.index();return function(j,m){return!(!j||!m||j.isLeaf||!j.canAppend(m))}(v.nodeBefore,v.nodeAfter)&&v.parent.canReplace(M,M+1)}function te(j,m,v){let M=j.resolve(m);if(!v.content.size)return m;let I=v.content;for(let K=0;K<v.openStart;K++)I=I.firstChild.content;for(let K=1;K<=(0==v.openStart&&v.size?2:1);K++)for(let it=M.depth;it>=0;it--){let yt=it==M.depth?0:M.pos<=(M.start(it+1)+M.end(it+1))/2?-1:1,Dt=M.index(it)+(yt>0?1:0),S=M.node(it),r=!1;if(1==K)r=S.canReplace(Dt,Dt,I);else{let d=S.contentMatchAt(Dt).findWrapping(I.firstChild.type);r=d&&S.canReplaceWith(Dt,Dt,d[0])}if(r)return 0==yt?M.pos:yt<0?M.before(it+1):M.after(it+1)}return null}function Ce(j,m,v=m,M=C.p2.empty){if(m==v&&!M.size)return null;let I=j.resolve(m),K=j.resolve(v);return Xt(I,K,M)?new ht(m,v,M):new ie(I,K,M).fit()}function Xt(j,m,v){return!v.openStart&&!v.openEnd&&j.start()==m.start()&&j.parent.canReplace(j.index(),m.index(),v.content)}Mt.jsonID("replaceAround",at);class ie{constructor(m,v,M){this.$from=m,this.$to=v,this.unplaced=M,this.frontier=[],this.placed=C.HY.empty;for(let I=0;I<=m.depth;I++){let K=m.node(I);this.frontier.push({type:K.type,match:K.contentMatchAt(m.indexAfter(I))})}for(let I=m.depth;I>0;I--)this.placed=C.HY.from(m.node(I).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let S=this.findFittable();S?this.placeNodes(S):this.openMore()||this.dropNode()}let m=this.mustMoveInline(),v=this.placed.size-this.depth-this.$from.depth,M=this.$from,I=this.close(m<0?this.$to:M.doc.resolve(m));if(!I)return null;let K=this.placed,it=M.depth,yt=I.depth;for(;it&&yt&&1==K.childCount;)K=K.firstChild.content,it--,yt--;let Dt=new C.p2(K,it,yt);return m>-1?new at(M.pos,m,this.$to.pos,this.$to.end(),Dt,v):Dt.size||M.pos!=this.$to.pos?new ht(M.pos,I.pos,Dt):null}findFittable(){for(let m=1;m<=2;m++)for(let v=this.unplaced.openStart;v>=0;v--){let M,I=null;v?(I=me(this.unplaced.content,v-1).firstChild,M=I.content):M=this.unplaced.content;let K=M.firstChild;for(let it=this.depth;it>=0;it--){let S,{type:yt,match:Dt}=this.frontier[it],r=null;if(1==m&&(K?Dt.matchType(K.type)||(r=Dt.fillBefore(C.HY.from(K),!1)):I&&yt.compatibleContent(I.type)))return{sliceDepth:v,frontierDepth:it,parent:I,inject:r};if(2==m&&K&&(S=Dt.findWrapping(K.type)))return{sliceDepth:v,frontierDepth:it,parent:I,wrap:S};if(I&&Dt.matchType(I.type))break}}}openMore(){let{content:m,openStart:v,openEnd:M}=this.unplaced,I=me(m,v);return!(!I.childCount||I.firstChild.isLeaf||(this.unplaced=new C.p2(m,v+1,Math.max(M,I.size+v>=m.size-M?v+1:0)),0))}dropNode(){let{content:m,openStart:v,openEnd:M}=this.unplaced,I=me(m,v);if(I.childCount<=1&&v>0){let K=m.size-v<=v+I.size;this.unplaced=new C.p2(ee(m,v-1,1),v-1,K?v-1:M)}else this.unplaced=new C.p2(ee(m,v,1),v,M)}placeNodes({sliceDepth:m,frontierDepth:v,parent:M,inject:I,wrap:K}){for(;this.depth>v;)this.closeFrontierNode();if(K)for(let N=0;N<K.length;N++)this.openFrontierNode(K[N]);let it=this.unplaced,yt=M?M.content:it.content,Dt=it.openStart-m,S=0,r=[],{match:d,type:g}=this.frontier[v];if(I){for(let N=0;N<I.childCount;N++)r.push(I.child(N));d=d.matchFragment(I)}let O=yt.size+m-(it.content.size-it.openEnd);for(;S<yt.childCount;){let N=yt.child(S),nt=d.matchType(N.type);if(!nt)break;S++,(S>1||0==Dt||N.content.size)&&(d=nt,r.push(ne(N.mark(g.allowedMarks(N.marks)),1==S?Dt:0,S==yt.childCount?O:-1)))}let P=S==yt.childCount;P||(O=-1),this.placed=Me(this.placed,v,C.HY.from(r)),this.frontier[v].match=d,P&&O<0&&M&&M.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let N=0,nt=yt;N<O;N++){let _t=nt.lastChild;this.frontier.push({type:_t.type,match:_t.contentMatchAt(_t.childCount)}),nt=_t.content}this.unplaced=P?0==m?C.p2.empty:new C.p2(ee(it.content,m-1,1),m-1,O<0?it.openEnd:m-1):new C.p2(ee(it.content,m,S),it.openStart,it.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let v,m=this.frontier[this.depth];if(!m.type.isTextblock||!Ee(this.$to,this.$to.depth,m.type,m.match,!1)||this.$to.depth==this.depth&&(v=this.findCloseLevel(this.$to))&&v.depth==this.depth)return-1;let{depth:M}=this.$to,I=this.$to.after(M);for(;M>1&&I==this.$to.end(--M);)++I;return I}findCloseLevel(m){t:for(let v=Math.min(this.depth,m.depth);v>=0;v--){let{match:M,type:I}=this.frontier[v],K=v<m.depth&&m.end(v+1)==m.pos+(m.depth-(v+1)),it=Ee(m,v,I,M,K);if(it){for(let yt=v-1;yt>=0;yt--){let{match:Dt,type:S}=this.frontier[yt],r=Ee(m,yt,S,Dt,!0);if(!r||r.childCount)continue t}return{depth:v,fit:it,move:K?m.doc.resolve(m.after(v+1)):m}}}}close(m){let v=this.findCloseLevel(m);if(!v)return null;for(;this.depth>v.depth;)this.closeFrontierNode();v.fit.childCount&&(this.placed=Me(this.placed,v.depth,v.fit)),m=v.move;for(let M=v.depth+1;M<=m.depth;M++){let I=m.node(M),K=I.type.contentMatch.fillBefore(I.content,!0,m.index(M));this.openFrontierNode(I.type,I.attrs,K)}return m}openFrontierNode(m,v=null,M){let I=this.frontier[this.depth];I.match=I.match.matchType(m),this.placed=Me(this.placed,this.depth,C.HY.from(m.create(v,M))),this.frontier.push({type:m,match:m.contentMatch})}closeFrontierNode(){let v=this.frontier.pop().match.fillBefore(C.HY.empty,!0);v.childCount&&(this.placed=Me(this.placed,this.frontier.length,v))}}function ee(j,m,v){return 0==m?j.cutByIndex(v,j.childCount):j.replaceChild(0,j.firstChild.copy(ee(j.firstChild.content,m-1,v)))}function Me(j,m,v){return 0==m?j.append(v):j.replaceChild(j.childCount-1,j.lastChild.copy(Me(j.lastChild.content,m-1,v)))}function me(j,m){for(let v=0;v<m;v++)j=j.firstChild.content;return j}function ne(j,m,v){if(m<=0)return j;let M=j.content;return m>1&&(M=M.replaceChild(0,ne(M.firstChild,m-1,1==M.childCount?v-1:0))),m>0&&(M=j.type.contentMatch.fillBefore(M).append(M),v<=0&&(M=M.append(j.type.contentMatch.matchFragment(M).fillBefore(C.HY.empty,!0)))),j.copy(M)}function Ee(j,m,v,M,I){let K=j.node(m),it=I?j.indexAfter(m):j.index(m);if(it==K.childCount&&!v.compatibleContent(K.type))return null;let yt=M.fillBefore(K.content,!0,it);return yt&&!function(j,m,v){for(let M=v;M<m.childCount;M++)if(!j.allowsMarks(m.child(M).marks))return!0;return!1}(v,K.content,it)?yt:null}function le(j){return j.spec.defining||j.spec.definingForContent}function ce(j,m,v,M,I){if(m<v){let K=j.firstChild;j=j.replaceChild(0,K.copy(ce(K.content,m+1,v,M,K)))}if(m>M){let K=I.contentMatchAt(0),it=K.fillBefore(j).append(j);j=it.append(K.matchFragment(it).fillBefore(C.HY.empty,!0))}return j}function de(j,m){let v=[];for(let I=Math.min(j.depth,m.depth);I>=0;I--){let K=j.start(I);if(K<j.pos-(j.depth-I)||m.end(I)>m.pos+(m.depth-I)||j.node(I).type.spec.isolating||m.node(I).type.spec.isolating)break;(K==m.start(I)||I==j.depth&&I==m.depth&&j.parent.inlineContent&&m.parent.inlineContent&&I&&m.start(I-1)==K-1)&&v.push(I)}return v}class St extends Mt{constructor(m,v,M){super(),this.pos=m,this.attr=v,this.value=M}apply(m){let v=m.nodeAt(this.pos);if(!v)return vt.fail("No node at attribute step's position");let M=Object.create(null);for(let K in v.attrs)M[K]=v.attrs[K];M[this.attr]=this.value;let I=v.type.create(M,null,v.marks);return vt.fromReplace(m,this.pos,this.pos+1,new C.p2(C.HY.from(I),0,v.isLeaf?0:1))}getMap(){return gt.empty}invert(m){return new St(this.pos,this.attr,m.nodeAt(this.pos).attrs[this.attr])}map(m){let v=m.mapResult(this.pos,1);return v.deletedAfter?null:new St(v.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(m,v){if("number"!=typeof v.pos||"string"!=typeof v.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new St(v.pos,v.attr,v.value)}}Mt.jsonID("attr",St);let Gt=class extends Error{};Gt=function j(m){let v=Error.call(this,m);return v.__proto__=j.prototype,v},(Gt.prototype=Object.create(Error.prototype)).constructor=Gt,Gt.prototype.name="TransformError";class qt{constructor(m){this.doc=m,this.steps=[],this.docs=[],this.mapping=new ot}get before(){return this.docs.length?this.docs[0]:this.doc}step(m){let v=this.maybeStep(m);if(v.failed)throw new Gt(v.failed);return this}maybeStep(m){let v=m.apply(this.doc);return v.failed||this.addStep(m,v.doc),v}get docChanged(){return this.steps.length>0}addStep(m,v){this.docs.push(this.doc),this.steps.push(m),this.mapping.appendMap(m.getMap()),this.doc=v}replace(m,v=m,M=C.p2.empty){let I=Ce(this.doc,m,v,M);return I&&this.step(I),this}replaceWith(m,v,M){return this.replace(m,v,new C.p2(C.HY.from(M),0,0))}delete(m,v){return this.replace(m,v,C.p2.empty)}insert(m,v){return this.replaceWith(m,m,v)}replaceRange(m,v,M){return function(j,m,v,M){if(!M.size)return j.deleteRange(m,v);let I=j.doc.resolve(m),K=j.doc.resolve(v);if(Xt(I,K,M))return j.step(new ht(m,v,M));let it=de(I,j.doc.resolve(v));0==it[it.length-1]&&it.pop();let yt=-(I.depth+1);it.unshift(yt);for(let g=I.depth,O=I.pos-1;g>0;g--,O--){let P=I.node(g).type.spec;if(P.defining||P.definingAsContext||P.isolating)break;it.indexOf(g)>-1?yt=g:I.before(g)==O&&it.splice(1,0,-g)}let Dt=it.indexOf(yt),S=[],r=M.openStart;for(let g=M.content,O=0;;O++){let P=g.firstChild;if(S.push(P),O==M.openStart)break;g=P.content}for(let g=r-1;g>=0;g--){let O=S[g].type,P=le(O);if(P&&I.node(Dt).type!=O)r=g;else if(P||!O.isTextblock)break}for(let g=M.openStart;g>=0;g--){let O=(g+r+1)%(M.openStart+1),P=S[O];if(P)for(let N=0;N<it.length;N++){let nt=it[(N+Dt)%it.length],_t=!0;nt<0&&(_t=!1,nt=-nt);let k=I.node(nt-1),A=I.index(nt-1);if(k.canReplaceWith(A,A,P.type,P.marks))return j.replace(I.before(nt),_t?K.after(nt):v,new C.p2(ce(M.content,0,M.openStart,O),O,M.openEnd))}}let d=j.steps.length;for(let g=it.length-1;g>=0&&(j.replace(m,v,M),!(j.steps.length>d));g--){let O=it[g];O<0||(m=I.before(O),v=K.after(O))}}(this,m,v,M),this}replaceRangeWith(m,v,M){return function(j,m,v,M){if(!M.isInline&&m==v&&j.doc.resolve(m).parent.content.size){let I=function(j,m,v){let M=j.resolve(m);if(M.parent.canReplaceWith(M.index(),M.index(),v))return m;if(0==M.parentOffset)for(let I=M.depth-1;I>=0;I--){let K=M.index(I);if(M.node(I).canReplaceWith(K,K,v))return M.before(I+1);if(K>0)return null}if(M.parentOffset==M.parent.content.size)for(let I=M.depth-1;I>=0;I--){let K=M.indexAfter(I);if(M.node(I).canReplaceWith(K,K,v))return M.after(I+1);if(K<M.node(I).childCount)return null}return null}(j.doc,m,M.type);null!=I&&(m=v=I)}j.replaceRange(m,v,new C.p2(C.HY.from(M),0,0))}(this,m,v,M),this}deleteRange(m,v){return function(j,m,v){let M=j.doc.resolve(m),I=j.doc.resolve(v),K=de(M,I);for(let it=0;it<K.length;it++){let yt=K[it],Dt=it==K.length-1;if(Dt&&0==yt||M.node(yt).type.contentMatch.validEnd)return j.delete(M.start(yt),I.end(yt));if(yt>0&&(Dt||M.node(yt-1).canReplace(M.index(yt-1),I.indexAfter(yt-1))))return j.delete(M.before(yt),I.after(yt))}for(let it=1;it<=M.depth&&it<=I.depth;it++)if(m-M.start(it)==M.depth-it&&v>M.end(it)&&I.end(it)-v!=I.depth-it)return j.delete(M.before(it),v);j.delete(m,v)}(this,m,v),this}lift(m,v){return function(j,m,v){let{$from:M,$to:I,depth:K}=m,it=M.before(K+1),yt=I.after(K+1),Dt=it,S=yt,r=C.HY.empty,d=0;for(let P=K,N=!1;P>v;P--)N||M.index(P)>0?(N=!0,r=C.HY.from(M.node(P).copy(r)),d++):Dt--;let g=C.HY.empty,O=0;for(let P=K,N=!1;P>v;P--)N||I.after(P+1)<I.end(P)?(N=!0,g=C.HY.from(I.node(P).copy(g)),O++):S++;j.step(new at(Dt,S,it,yt,new C.p2(r.append(g),d,O),r.size-d,!0))}(this,m,v),this}join(m,v=1){return function(j,m,v){let M=new ht(m-v,m+v,C.p2.empty,!0);j.step(M)}(this,m,v),this}wrap(m,v){return function(j,m,v){let M=C.HY.empty;for(let it=v.length-1;it>=0;it--){if(M.size){let yt=v[it].type.contentMatch.matchFragment(M);if(!yt||!yt.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}M=C.HY.from(v[it].type.create(v[it].attrs,M))}let I=m.start,K=m.end;j.step(new at(I,K,I,K,new C.p2(M,0,0),v.length,!0))}(this,m,v),this}setBlockType(m,v=m,M,I=null){return function(j,m,v,M,I){if(!M.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let K=j.steps.length;j.doc.nodesBetween(m,v,(it,yt)=>{if(it.isTextblock&&!it.hasMarkup(M,I)&&function(j,m,v){let M=j.resolve(m),I=M.index();return M.parent.canReplaceWith(I,I+1,v)}(j.doc,j.mapping.slice(K).map(yt),M)){j.clearIncompatible(j.mapping.slice(K).map(yt,1),M);let Dt=j.mapping.slice(K),S=Dt.map(yt,1),r=Dt.map(yt+it.nodeSize,1);return j.step(new at(S,r,S+1,r-1,new C.p2(C.HY.from(M.create(I,null,it.marks)),0,0),1,!0)),!1}})}(this,m,v,M,I),this}setNodeMarkup(m,v,M=null,I=[]){return function(j,m,v,M,I){let K=j.doc.nodeAt(m);if(!K)throw new RangeError("No node at given position");v||(v=K.type);let it=v.create(M,null,I||K.marks);if(K.isLeaf)return j.replaceWith(m,m+K.nodeSize,it);if(!v.validContent(K.content))throw new RangeError("Invalid content for node type "+v.name);j.step(new at(m,m+K.nodeSize,m+1,m+K.nodeSize-1,new C.p2(C.HY.from(it),0,0),1,!0))}(this,m,v,M,I),this}setNodeAttribute(m,v,M){return this.step(new St(m,v,M)),this}addNodeMark(m,v){return this.step(new V(m,v)),this}removeNodeMark(m,v){if(!(v instanceof C.vc)){let M=this.doc.nodeAt(m);if(!M)throw new RangeError("No node at position "+m);if(!(v=v.isInSet(M.marks)))return this}return this.step(new H(m,v)),this}split(m,v=1,M){return function(j,m,v=1,M){let I=j.doc.resolve(m),K=C.HY.empty,it=C.HY.empty;for(let yt=I.depth,Dt=I.depth-v,S=v-1;yt>Dt;yt--,S--){K=C.HY.from(I.node(yt).copy(K));let r=M&&M[S];it=C.HY.from(r?r.type.create(r.attrs,it):I.node(yt).copy(it))}j.step(new ht(m,m,new C.p2(K.append(it),v,v),!0))}(this,m,v,M),this}addMark(m,v,M){return function(j,m,v,M){let it,yt,I=[],K=[];j.doc.nodesBetween(m,v,(Dt,S,r)=>{if(!Dt.isInline)return;let d=Dt.marks;if(!M.isInSet(d)&&r.type.allowsMarkType(M.type)){let g=Math.max(S,m),O=Math.min(S+Dt.nodeSize,v),P=M.addToSet(d);for(let N=0;N<d.length;N++)d[N].isInSet(P)||(it&&it.to==g&&it.mark.eq(d[N])?it.to=O:I.push(it=new U(g,O,d[N])));yt&&yt.to==g?yt.to=O:K.push(yt=new Z(g,O,M))}}),I.forEach(Dt=>j.step(Dt)),K.forEach(Dt=>j.step(Dt))}(this,m,v,M),this}removeMark(m,v,M){return function(j,m,v,M){let I=[],K=0;j.doc.nodesBetween(m,v,(it,yt)=>{if(!it.isInline)return;K++;let Dt=null;if(M instanceof C.ZU){let r,S=it.marks;for(;r=M.isInSet(S);)(Dt||(Dt=[])).push(r),S=r.removeFromSet(S)}else M?M.isInSet(it.marks)&&(Dt=[M]):Dt=it.marks;if(Dt&&Dt.length){let S=Math.min(yt+it.nodeSize,v);for(let r=0;r<Dt.length;r++){let g,d=Dt[r];for(let O=0;O<I.length;O++){let P=I[O];P.step==K-1&&d.eq(I[O].style)&&(g=P)}g?(g.to=S,g.step=K):I.push({style:d,from:Math.max(yt,m),to:S,step:K})}}}),I.forEach(it=>j.step(new U(it.from,it.to,it.style)))}(this,m,v,M),this}clearIncompatible(m,v,M){return function(j,m,v,M=v.contentMatch){let I=j.doc.nodeAt(m),K=[],it=m+1;for(let yt=0;yt<I.childCount;yt++){let Dt=I.child(yt),S=it+Dt.nodeSize,r=M.matchType(Dt.type);if(r){M=r;for(let d=0;d<Dt.marks.length;d++)v.allowsMarkType(Dt.marks[d].type)||j.step(new U(it,S,Dt.marks[d]))}else K.push(new ht(it,S,C.p2.empty));it=S}if(!M.validEnd){let yt=M.fillBefore(C.HY.empty,!0);j.replace(it,it,new C.p2(yt,0,0))}for(let yt=K.length-1;yt>=0;yt--)j.step(K[yt])}(this,m,v,M),this}}},43594:(It,pt,c)=>{c.d(pt,{p:()=>ye,EH:()=>oe,tk:()=>wo});var C=c(62463),i=c(35917),w=c(38480);const x=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},T=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let Q=null;const D=function(e,t,n){let o=Q||(Q=document.createRange());return o.setEnd(e,null==n?e.nodeValue.length:n),o.setStart(e,t||0),o},G=function(e,t,n,o){return n&&(ct(e,t,n,o,-1)||ct(e,t,n,o,1))},$=/^(img|br|input|textarea|hr)$/i;function ct(e,t,n,o,s){for(;;){if(e==n&&t==o)return!0;if(t==(s<0?0:X(e))){let l=e.parentNode;if(!l||1!=l.nodeType||ot(e)||$.test(e.nodeName)||"false"==e.contentEditable)return!1;t=x(e)+(s<0?0:1),e=l}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(s<0?-1:0)]).contentEditable)return!1;t=s<0?X(e):0}}}function X(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function ot(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const dt=function(e){return e.focusNode&&G(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Mt(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const Tt="undefined"!=typeof navigator?navigator:null,Z="undefined"!=typeof document?document:null,U=Tt&&Tt.userAgent||"",V=/Edge\/(\d+)/.exec(U),H=/MSIE \d/.exec(U),ht=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(U),at=!!(H||ht||V),ft=H?document.documentMode:ht?+ht[1]:V?+V[1]:0,Ct=!at&&/gecko\/(\d+)/i.test(U);Ct&&/Firefox\/(\d+)/.exec(U);const lt=!at&&/Chrome\/(\d+)/.exec(U),Ot=!!lt,Pt=lt?+lt[1]:0,Bt=!at&&!!Tt&&/Apple Computer/.test(Tt.vendor),tt=Bt&&(/Mobile\/\w+/.test(U)||!!Tt&&Tt.maxTouchPoints>2),b=tt||!!Tt&&/Mac/.test(Tt.platform),F=/Android \d/.test(U),J=!!Z&&"webkitFontSmoothing"in Z.documentElement.style,ut=J?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function B(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function z(e,t){return"number"==typeof e?e:e[t]}function q(e){let t=e.getBoundingClientRect();return{left:t.left,right:t.left+e.clientWidth*(t.width/e.offsetWidth||1),top:t.top,bottom:t.top+e.clientHeight*(t.height/e.offsetHeight||1)}}function xt(e,t,n){let o=e.someProp("scrollThreshold")||0,s=e.someProp("scrollMargin")||5,l=e.dom.ownerDocument;for(let h=n||e.dom;h;h=T(h)){if(1!=h.nodeType)continue;let _=h,E=_==l.body,R=E?B(l):q(_),L=0,Y=0;if(t.top<R.top+z(o,"top")?Y=-(R.top-t.top+z(s,"top")):t.bottom>R.bottom-z(o,"bottom")&&(Y=t.bottom-R.bottom+z(s,"bottom")),t.left<R.left+z(o,"left")?L=-(R.left-t.left+z(s,"left")):t.right>R.right-z(o,"right")&&(L=t.right-R.right+z(s,"right")),L||Y)if(E)l.defaultView.scrollBy(L,Y);else{let st=_.scrollLeft,mt=_.scrollTop;Y&&(_.scrollTop+=Y),L&&(_.scrollLeft+=L);let At=_.scrollLeft-st,Nt=_.scrollTop-mt;t={left:t.left-At,top:t.top-Nt,right:t.right-At,bottom:t.bottom-Nt}}if(E)break}}function Rt(e){let t=[],n=e.ownerDocument;for(let o=e;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),e!=n);o=T(o));return t}function Zt(e,t){for(let n=0;n<e.length;n++){let{dom:o,top:s,left:l}=e[n];o.scrollTop!=s+t&&(o.scrollTop=s+t),o.scrollLeft!=l&&(o.scrollLeft=l)}}let ve=null;function Ae(e,t){let n,s,o=2e8,l=0,h=t.top,_=t.top;for(let E=e.firstChild,R=0;E;E=E.nextSibling,R++){let L;if(1==E.nodeType)L=E.getClientRects();else{if(3!=E.nodeType)continue;L=D(E).getClientRects()}for(let Y=0;Y<L.length;Y++){let st=L[Y];if(st.top<=h&&st.bottom>=_){h=Math.max(st.bottom,h),_=Math.min(st.top,_);let mt=st.left>t.left?st.left-t.left:st.right<t.left?t.left-st.right:0;if(mt<o){n=E,o=mt,s=mt&&3==n.nodeType?{left:st.right<t.left?st.right:st.left,top:t.top}:t,1==E.nodeType&&mt&&(l=R+(t.left>=(st.left+st.right)/2?1:0));continue}}!n&&(t.left>=st.right&&t.top>=st.top||t.left>=st.left&&t.top>=st.bottom)&&(l=R+1)}}return n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,o=document.createRange();for(let s=0;s<n;s++){o.setEnd(e,s+1),o.setStart(e,s);let l=ne(o,1);if(l.top!=l.bottom&&Ce(t,l))return{node:e,offset:s+(t.left>=(l.left+l.right)/2?1:0)}}return{node:e,offset:0}}(n,s):!n||o&&1==n.nodeType?{node:e,offset:l}:Ae(n,s)}function Ce(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Me(e,t,n){let o=e.childNodes.length;if(o&&n.top<n.bottom)for(let s=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-n.top)/(n.bottom-n.top))-2)),l=s;;){let h=e.childNodes[l];if(1==h.nodeType){let _=h.getClientRects();for(let E=0;E<_.length;E++){let R=_[E];if(Ce(t,R))return Me(h,t,R)}}if((l=(l+1)%o)==s)break}return e}function me(e,t){let o,n=e.dom.ownerDocument,s=0;if(n.caretPositionFromPoint)try{let E=n.caretPositionFromPoint(t.left,t.top);E&&({offsetNode:o,offset:s}=E)}catch(E){}if(!o&&n.caretRangeFromPoint){let E=n.caretRangeFromPoint(t.left,t.top);E&&({startContainer:o,startOffset:s}=E)}let h,l=(e.root.elementFromPoint?e.root:n).elementFromPoint(t.left,t.top);if(!l||!e.dom.contains(1!=l.nodeType?l.parentNode:l)){let E=e.dom.getBoundingClientRect();if(!Ce(t,E)||(l=Me(e.dom,t,E),!l))return null}if(Bt)for(let E=l;o&&E;E=T(E))E.draggable&&(o=void 0);if(l=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(l,t),o){if(Ct&&1==o.nodeType&&(s=Math.min(s,o.childNodes.length),s<o.childNodes.length)){let R,E=o.childNodes[s];"IMG"==E.nodeName&&(R=E.getBoundingClientRect()).right<=t.left&&R.bottom>t.top&&s++}o==e.dom&&s==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?h=e.state.doc.content.size:(0==s||1!=o.nodeType||"BR"!=o.childNodes[s-1].nodeName)&&(h=function(e,t,n,o){let s=-1;for(let l=t;l!=e.dom;){let h=e.docView.nearestDesc(l,!0);if(!h)return null;if(h.node.isBlock&&h.parent){let _=h.dom.getBoundingClientRect();if(_.left>o.left||_.top>o.top)s=h.posBefore;else{if(!(_.right<o.left||_.bottom<o.top))break;s=h.posAfter}}l=h.dom.parentNode}return s>-1?s:e.docView.posFromDOM(t,n,1)}(e,o,s,t))}null==h&&(h=function(e,t,n){let{node:o,offset:s}=Ae(t,n),l=-1;if(1==o.nodeType&&!o.firstChild){let h=o.getBoundingClientRect();l=h.left!=h.right&&n.left>(h.left+h.right)/2?1:-1}return e.docView.posFromDOM(o,s,l)}(e,l,t));let _=e.docView.nearestDesc(l,!0);return{pos:h,inside:_?_.posAtStart-_.border:-1}}function ne(e,t){let n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}const Ee=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function _e(e,t,n){let{node:o,offset:s,atom:l}=e.docView.domFromPos(t,n<0?-1:1),h=J||Ct;if(3==o.nodeType){if(!h||!Ee.test(o.nodeValue)&&(n<0?s:s!=o.nodeValue.length)){let E=s,R=s,L=n<0?1:-1;return n<0&&!s?(R++,L=-1):n>=0&&s==o.nodeValue.length?(E--,L=1):n<0?E--:R++,le(ne(D(o,E,R),1),L<0)}{let E=ne(D(o,s,s),n);if(Ct&&s&&/\s/.test(o.nodeValue[s-1])&&s<o.nodeValue.length){let R=ne(D(o,s-1,s-1),-1);if(R.top==E.top){let L=ne(D(o,s,s+1),-1);if(L.top!=E.top)return le(L,L.left<R.left)}}return E}}if(!e.state.doc.resolve(t-(l||0)).parent.inlineContent){if(null==l&&s&&(n<0||s==X(o))){let E=o.childNodes[s-1];if(1==E.nodeType)return xe(E.getBoundingClientRect(),!1)}if(null==l&&s<X(o)){let E=o.childNodes[s];if(1==E.nodeType)return xe(E.getBoundingClientRect(),!0)}return xe(o.getBoundingClientRect(),n>=0)}if(null==l&&s&&(n<0||s==X(o))){let E=o.childNodes[s-1],R=3==E.nodeType?D(E,X(E)-(h?0:1)):1!=E.nodeType||"BR"==E.nodeName&&E.nextSibling?null:E;if(R)return le(ne(R,1),!1)}if(null==l&&s<X(o)){let E=o.childNodes[s];for(;E.pmViewDesc&&E.pmViewDesc.ignoreForCoords;)E=E.nextSibling;let R=E?3==E.nodeType?D(E,0,h?0:1):1==E.nodeType?E:null:null;if(R)return le(ne(R,-1),!0)}return le(ne(3==o.nodeType?D(o):o,-n),n>=0)}function le(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function xe(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function ce(e,t,n){let o=e.state,s=e.root.activeElement;o!=t&&e.updateState(t),s!=e.dom&&e.focus();try{return n()}finally{o!=t&&e.updateState(o),s!=e.dom&&s&&s.focus()}}const Vt=/[\u0590-\u08ac]/;let St=null,Gt=null,qt=!1;class K{constructor(t,n,o,s){this.parent=t,this.children=n,this.dom=o,this.contentDOM=s,this.dirty=0,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,n,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let n=0;n<this.children.length;n++)t+=this.children[n].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let n=0,o=this.posAtStart;;n++){let s=this.children[n];if(s==t)return o;o+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,n,o){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(o<0){let l,h;if(t==this.contentDOM)l=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;l=t.previousSibling}for(;l&&(!(h=l.pmViewDesc)||h.parent!=this);)l=l.previousSibling;return l?this.posBeforeChild(h)+h.size:this.posAtStart}{let l,h;if(t==this.contentDOM)l=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;l=t.nextSibling}for(;l&&(!(h=l.pmViewDesc)||h.parent!=this);)l=l.nextSibling;return l?this.posBeforeChild(h):this.posAtEnd}}let s;if(t==this.dom&&this.contentDOM)s=n>x(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(let l=t;;l=l.parentNode){if(l==this.dom){s=!1;break}if(l.previousSibling)break}if(null==s&&n==t.childNodes.length)for(let l=t;;l=l.parentNode){if(l==this.dom){s=!0;break}if(l.nextSibling)break}}return(null==s?o>0:s)?this.posAtEnd:this.posAtStart}nearestDesc(t,n=!1){for(let o=!0,s=t;s;s=s.parentNode){let h,l=this.getDesc(s);if(l&&(!n||l.node)){if(!o||!(h=l.nodeDOM)||(1==h.nodeType?h.contains(1==t.nodeType?t:t.parentNode):h==t))return l;o=!1}}}getDesc(t){let n=t.pmViewDesc;for(let o=n;o;o=o.parent)if(o==this)return n}posFromDOM(t,n,o){for(let s=t;s;s=s.parentNode){let l=this.getDesc(s);if(l)return l.localPosFromDOM(t,n,o)}return-1}descAt(t){for(let n=0,o=0;n<this.children.length;n++){let s=this.children[n],l=o+s.size;if(o==t&&l!=o){for(;!s.border&&s.children.length;)s=s.children[0];return s}if(t<l)return s.descAt(t-o-s.border);o=l}}domFromPos(t,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let l,o=0,s=0;for(let l=0;o<this.children.length;o++){let h=this.children[o],_=l+h.size;if(_>t||h instanceof g){s=t-l;break}l=_}if(s)return this.children[o].domFromPos(s-this.children[o].border,n);for(;o&&!(l=this.children[o-1]).size&&l instanceof it&&l.side>=0;o--);if(n<=0){let l,h=!0;for(;l=o?this.children[o-1]:null,l&&l.dom.parentNode!=this.contentDOM;o--,h=!1);return l&&n&&h&&!l.border&&!l.domAtom?l.domFromPos(l.size,n):{node:this.contentDOM,offset:l?x(l.dom)+1:0}}{let l,h=!0;for(;l=o<this.children.length?this.children[o]:null,l&&l.dom.parentNode!=this.contentDOM;o++,h=!1);return l&&h&&!l.border&&!l.domAtom?l.domFromPos(0,n):{node:this.contentDOM,offset:l?x(l.dom):this.contentDOM.childNodes.length}}}parseRange(t,n,o=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,l=-1;for(let h=o,_=0;;_++){let E=this.children[_],R=h+E.size;if(-1==s&&t<=R){let L=h+E.border;if(t>=L&&n<=R-E.border&&E.node&&E.contentDOM&&this.contentDOM.contains(E.contentDOM))return E.parseRange(t,n,L);t=h;for(let Y=_;Y>0;Y--){let st=this.children[Y-1];if(st.size&&st.dom.parentNode==this.contentDOM&&!st.emptyChildAt(1)){s=x(st.dom)+1;break}t-=st.size}-1==s&&(s=0)}if(s>-1&&(R>n||_==this.children.length-1)){n=R;for(let L=_+1;L<this.children.length;L++){let Y=this.children[L];if(Y.size&&Y.dom.parentNode==this.contentDOM&&!Y.emptyChildAt(-1)){l=x(Y.dom);break}n+=Y.size}-1==l&&(l=this.contentDOM.childNodes.length);break}h=R}return{node:this.contentDOM,from:t,to:n,fromOffset:s,toOffset:l}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[t<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(t)}domAfterPos(t){let{node:n,offset:o}=this.domFromPos(t,0);if(1!=n.nodeType||o==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[o]}setSelection(t,n,o,s=!1){let l=Math.min(t,n),h=Math.max(t,n);for(let st=0,mt=0;st<this.children.length;st++){let At=this.children[st],Nt=mt+At.size;if(l>mt&&h<Nt)return At.setSelection(t-mt-At.border,n-mt-At.border,o,s);mt=Nt}let _=this.domFromPos(t,t?-1:1),E=n==t?_:this.domFromPos(n,n?-1:1),R=o.getSelection(),L=!1;if((Ct||Bt)&&t==n){let{node:st,offset:mt}=_;if(3==st.nodeType){if(L=!(!mt||"\n"!=st.nodeValue[mt-1]),L&&mt==st.nodeValue.length)for(let Nt,At=st;At;At=At.parentNode){if(Nt=At.nextSibling){"BR"==Nt.nodeName&&(_=E={node:Nt.parentNode,offset:x(Nt)+1});break}let Ut=At.pmViewDesc;if(Ut&&Ut.node&&Ut.node.isBlock)break}}else{let At=st.childNodes[mt-1];L=At&&("BR"==At.nodeName||"false"==At.contentEditable)}}if(Ct&&R.focusNode&&R.focusNode!=E.node&&1==R.focusNode.nodeType){let st=R.focusNode.childNodes[R.focusOffset];st&&"false"==st.contentEditable&&(s=!0)}if(!(s||L&&Bt)&&G(_.node,_.offset,R.anchorNode,R.anchorOffset)&&G(E.node,E.offset,R.focusNode,R.focusOffset))return;let Y=!1;if((R.extend||t==n)&&!L){R.collapse(_.node,_.offset);try{t!=n&&R.extend(E.node,E.offset),Y=!0}catch(st){}}if(!Y){if(t>n){let mt=_;_=E,E=mt}let st=document.createRange();st.setEnd(E.node,E.offset),st.setStart(_.node,_.offset),R.removeAllRanges(),R.addRange(st)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,n){for(let o=0,s=0;s<this.children.length;s++){let l=this.children[s],h=o+l.size;if(o==h?t<=h&&n>=o:t<h&&n>o){let _=o+l.border,E=h-l.border;if(t>=_&&n<=E)return this.dirty=t==o||n==h?2:1,void(t!=_||n!=E||!l.contentLost&&l.dom.parentNode==this.contentDOM?l.markDirty(t-_,n-_):l.dirty=3);l.dirty=l.dom!=l.contentDOM||l.dom.parentNode!=this.contentDOM||l.children.length?3:2}o=h}this.dirty=2}markParentsDirty(){let t=1;for(let n=this.parent;n;n=n.parent,t++){let o=1==t?2:1;n.dirty<o&&(n.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class it extends K{constructor(t,n,o,s){let l,h=n.type.toDOM;if("function"==typeof h&&(h=h(o,()=>l?l.parent?l.parent.posBeforeChild(l):void 0:s)),!n.type.spec.raw){if(1!=h.nodeType){let _=document.createElement("span");_.appendChild(h),h=_}h.contentEditable="false",h.classList.add("ProseMirror-widget")}super(t,[],h,null),this.widget=n,this.widget=n,l=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let n=this.widget.spec.stopEvent;return!!n&&n(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class yt extends K{constructor(t,n,o,s){super(t,[],n,null),this.textDOM=o,this.text=s}get size(){return this.text.length}localPosFromDOM(t,n){return t!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class Dt extends K{constructor(t,n,o,s){super(t,[],o,s),this.mark=n}static create(t,n,o,s){let l=s.nodeViews[n.type.name],h=l&&l(n,s,o);return(!h||!h.dom)&&(h=i.PW.renderSpec(document,n.type.spec.toDOM(n,o))),new Dt(t,n,h.dom,h.contentDOM||h.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,n){if(super.markDirty(t,n),0!=this.dirty){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}}slice(t,n,o){let s=Dt.create(this.parent,this.mark,!0,o),l=this.children,h=this.size;n<h&&(l=Kt(l,n,h,o)),t>0&&(l=Kt(l,0,t,o));for(let _=0;_<l.length;_++)l[_].parent=s;return s.children=l,s}}class S extends K{constructor(t,n,o,s,l,h,_,E,R){super(t,[],l,h),this.node=n,this.outerDeco=o,this.innerDeco=s,this.nodeDOM=_,h&&this.updateChildren(E,R)}static create(t,n,o,s,l,h){let E,_=l.nodeViews[n.type.name],R=_&&_(n,l,()=>E?E.parent?E.parent.posBeforeChild(E):void 0:h,o,s),L=R&&R.dom,Y=R&&R.contentDOM;if(n.isText)if(L){if(3!=L.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else L=document.createTextNode(n.text);else L||({dom:L,contentDOM:Y}=i.PW.renderSpec(document,n.type.spec.toDOM(n)));!Y&&!n.isText&&"BR"!=L.nodeName&&(L.hasAttribute("contenteditable")||(L.contentEditable="false"),n.type.spec.draggable&&(L.draggable=!0));let st=L;return L=W(L,o,n),R?E=new O(t,n,o,s,L,Y||null,st,R,l,h+1):n.isText?new d(t,n,o,s,L,st,l):new S(t,n,o,s,L,Y||null,st,l,h+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let n=this.children.length-1;n>=0;n--){let o=this.children[n];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>i.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,n,o){return 0==this.dirty&&t.eq(this.node)&&et(n,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,n){let o=this.node.inlineContent,s=n,l=t.composing?this.localCompositionInfo(t,n):null,h=l&&l.pos>-1?l:null,_=l&&l.pos<0,E=new bt(this,h&&h.node,t);(function(e,t,n,o){let s=t.locals(e),l=0;if(0==s.length){for(let R=0;R<e.childCount;R++){let L=e.child(R);o(L,s,t.forChild(l,L),R),l+=L.nodeSize}return}let h=0,_=[],E=null;for(let R=0;;){if(h<s.length&&s[h].to==l){let Nt,At=s[h++];for(;h<s.length&&s[h].to==l;)(Nt||(Nt=[At])).push(s[h++]);if(Nt){Nt.sort(Lt);for(let Ut=0;Ut<Nt.length;Ut++)n(Nt[Ut],R,!!E)}else n(At,R,!!E)}let L,Y;if(E)Y=-1,L=E,E=null;else{if(!(R<e.childCount))break;Y=R,L=e.child(R++)}for(let At=0;At<_.length;At++)_[At].to<=l&&_.splice(At--,1);for(;h<s.length&&s[h].from<=l&&s[h].to>l;)_.push(s[h++]);let st=l+L.nodeSize;if(L.isText){let At=st;h<s.length&&s[h].from<At&&(At=s[h].from);for(let Nt=0;Nt<_.length;Nt++)_[Nt].to<At&&(At=_[Nt].to);At<st&&(E=L.cut(At-l),L=L.cut(0,At-l),st=At,Y=-1)}o(L,L.isInline&&!L.isLeaf?_.filter(At=>!At.inline):_.slice(),t.forChild(l,L),Y),l=st}})(this.node,this.innerDeco,(R,L,Y)=>{R.spec.marks?E.syncToMarks(R.spec.marks,o,t):R.type.side>=0&&!Y&&E.syncToMarks(L==this.node.childCount?i.vc.none:this.node.child(L).marks,o,t),E.placeWidget(R,t,s)},(R,L,Y,st)=>{let mt;E.syncToMarks(R.marks,o,t),E.findNodeMatch(R,L,Y,st)||_&&t.state.selection.from>s&&t.state.selection.to<s+R.nodeSize&&(mt=E.findIndexWithChild(l.node))>-1&&E.updateNodeAt(R,L,Y,mt,t)||E.updateNextNode(R,L,Y,t,st)||E.addNode(R,L,Y,t,s),s+=R.nodeSize}),E.syncToMarks([],o,t),this.node.isTextblock&&E.addTextblockHacks(),E.destroyRest(),(E.changed||2==this.dirty)&&(h&&this.protectLocalComposition(t,h),P(this.contentDOM,this.children,t),tt&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e),e.style.cssText=t}}(this.dom))}localCompositionInfo(t,n){let{from:o,to:s}=t.state.selection;if(!(t.state.selection instanceof C.Bs)||o<n||s>n+this.node.content.size)return null;let l=t.domSelectionRange(),h=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=X(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(l.focusNode,l.focusOffset);if(!h||!this.dom.contains(h.parentNode))return null;if(this.node.inlineContent){let _=h.nodeValue,E=function(e,t,n,o){for(let s=0,l=0;s<e.childCount&&l<=o;){let h=e.child(s++),_=l;if(l+=h.nodeSize,!h.isText)continue;let E=h.text;for(;s<e.childCount;){let R=e.child(s++);if(l+=R.nodeSize,!R.isText)break;E+=R.text}if(l>=n){let R=_<o?E.lastIndexOf(t,o-_-1):-1;if(R>=0&&R+t.length+_>=n)return _+R;if(n==o&&E.length>=o+t.length-_&&E.slice(o-_,o-_+t.length)==t)return o}}return-1}(this.node.content,_,o-n,s-n);return E<0?null:{node:h,pos:E,text:_}}return{node:h,pos:-1,text:""}}protectLocalComposition(t,{node:n,pos:o,text:s}){if(this.getDesc(n))return;let l=n;for(;l.parentNode!=this.contentDOM;l=l.parentNode){for(;l.previousSibling;)l.parentNode.removeChild(l.previousSibling);for(;l.nextSibling;)l.parentNode.removeChild(l.nextSibling);l.pmViewDesc&&(l.pmViewDesc=void 0)}let h=new yt(this,l,n,s);t.input.compositionNodes.push(h),this.children=Kt(this.children,o,o+s.length,t,h)}update(t,n,o,s){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,n,o,s),0))}updateInner(t,n,o,s){this.updateOuterDeco(n),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(et(t,this.outerDeco))return;let n=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=k(this.dom,this.nodeDOM,_t(this.outerDeco,this.node,n),_t(t,this.node,n)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function r(e,t,n,o,s){return W(o,t,e),new S(void 0,e,t,n,o,o,o,s,0)}class d extends S{constructor(t,n,o,s,l,h,_){super(t,n,o,s,l,null,h,_,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,n,o,s){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(n),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,n,o){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(t,n,o)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,n,o){let s=this.node.cut(t,n),l=document.createTextNode(s.text);return new d(this.parent,s,this.outerDeco,this.innerDeco,l,l,o)}markDirty(t,n){super.markDirty(t,n),this.dom!=this.nodeDOM&&(0==t||n==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class g extends K{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class O extends S{constructor(t,n,o,s,l,h,_,E,R,L){super(t,n,o,s,l,h,_,R,L),this.spec=E}update(t,n,o,s){if(3==this.dirty)return!1;if(this.spec.update){let l=this.spec.update(t,n,o);return l&&this.updateInner(t,n,o,s),l}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,n,o,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,n,o,s){this.spec.setSelection?this.spec.setSelection(t,n,o):super.setSelection(t,n,o,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function P(e,t,n){let o=e.firstChild,s=!1;for(let l=0;l<t.length;l++){let h=t[l],_=h.dom;if(_.parentNode==e){for(;_!=o;)o=rt(o),s=!0;o=o.nextSibling}else s=!0,e.insertBefore(_,o);if(h instanceof Dt){let E=o?o.previousSibling:e.lastChild;P(h.contentDOM,h.children,n),o=E?E.nextSibling:e.firstChild}}for(;o;)o=rt(o),s=!0;s&&n.trackWrites==e&&(n.trackWrites=null)}const N=function(e){e&&(this.nodeName=e)};N.prototype=Object.create(null);const nt=[new N];function _t(e,t,n){if(0==e.length)return nt;let o=n?nt[0]:new N,s=[o];for(let l=0;l<e.length;l++){let h=e[l].type.attrs;if(h){h.nodeName&&s.push(o=new N(h.nodeName));for(let _ in h){let E=h[_];null!=E&&(n&&1==s.length&&s.push(o=new N(t.isInline?"span":"div")),"class"==_?o.class=(o.class?o.class+" ":"")+E:"style"==_?o.style=(o.style?o.style+";":"")+E:"nodeName"!=_&&(o[_]=E))}}}return s}function k(e,t,n,o){if(n==nt&&o==nt)return t;let s=t;for(let l=0;l<o.length;l++){let h=o[l],_=n[l];if(l){let E;_&&_.nodeName==h.nodeName&&s!=e&&(E=s.parentNode)&&E.nodeName.toLowerCase()==h.nodeName||(E=document.createElement(h.nodeName),E.pmIsDeco=!0,E.appendChild(s),_=nt[0]),s=E}A(s,_||nt[0],h)}return s}function A(e,t,n){for(let o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&!(o in n)&&e.removeAttribute(o);for(let o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){let o=t.class?t.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let l=0;l<o.length;l++)-1==s.indexOf(o[l])&&e.classList.remove(o[l]);for(let l=0;l<s.length;l++)-1==o.indexOf(s[l])&&e.classList.add(s[l]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let s,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;s=o.exec(t.style);)e.style.removeProperty(s[1])}n.style&&(e.style.cssText+=n.style)}}function W(e,t,n){return k(e,e,nt,_t(t,n,1!=e.nodeType))}function et(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function rt(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class bt{constructor(t,n,o){this.lock=n,this.view=o,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(e,t){let n=t,o=n.children.length,s=e.childCount,l=new Map,h=[];t:for(;s>0;){let _;for(;;)if(o){let R=n.children[o-1];if(!(R instanceof Dt)){_=R,o--;break}n=R,o=R.children.length}else{if(n==t)break t;o=n.parent.children.indexOf(n),n=n.parent}let E=_.node;if(E){if(E!=e.child(s-1))break;--s,l.set(_,s),h.push(_)}}return{index:s,matched:l,matches:h.reverse()}}(t.node.content,t)}destroyBetween(t,n){if(t!=n){for(let o=t;o<n;o++)this.top.children[o].destroy();this.top.children.splice(t,n-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,n,o){let s=0,l=this.stack.length>>1,h=Math.min(l,t.length);for(;s<h&&(s==l-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&!1!==t[s].type.spec.spanning;)s++;for(;s<l;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),l--;for(;l<t.length;){this.stack.push(this.top,this.index+1);let _=-1;for(let E=this.index;E<Math.min(this.index+3,this.top.children.length);E++)if(this.top.children[E].matchesMark(t[l])){_=E;break}if(_>-1)_>this.index&&(this.changed=!0,this.destroyBetween(this.index,_)),this.top=this.top.children[this.index];else{let E=Dt.create(this.top,t[l],n,o);this.top.children.splice(this.index,0,E),this.top=E,this.changed=!0}this.index=0,l++}}findNodeMatch(t,n,o,s){let h,l=-1;if(s>=this.preMatch.index&&(h=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&h.matchesNode(t,n,o))l=this.top.children.indexOf(h,this.index);else for(let _=this.index,E=Math.min(this.top.children.length,_+5);_<E;_++){let R=this.top.children[_];if(R.matchesNode(t,n,o)&&!this.preMatch.matched.has(R)){l=_;break}}return!(l<0||(this.destroyBetween(this.index,l),this.index++,0))}updateNodeAt(t,n,o,s,l){let h=this.top.children[s];return 3==h.dirty&&h.dom==h.contentDOM&&(h.dirty=2),!!h.update(t,n,o,l)&&(this.destroyBetween(this.index,s),this.index++,!0)}findIndexWithChild(t){for(;;){let n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let o=t.pmViewDesc;if(o)for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==o)return s;return-1}t=n}}updateNextNode(t,n,o,s,l){for(let h=this.index;h<this.top.children.length;h++){let _=this.top.children[h];if(_ instanceof S){let E=this.preMatch.matched.get(_);if(null!=E&&E!=l)return!1;let R=_.dom;if((!this.lock||!(R==this.lock||1==R.nodeType&&R.contains(this.lock.parentNode))||t.isText&&_.node&&_.node.isText&&_.nodeDOM.nodeValue==t.text&&3!=_.dirty&&et(n,_.outerDeco))&&_.update(t,n,o,s))return this.destroyBetween(this.index,h),_.dom!=R&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,n,o,s,l){this.top.children.splice(this.index++,0,S.create(this.top,t,n,o,s,l)),this.changed=!0}placeWidget(t,n,o){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(!s||!s.matchesWidget(t)||t!=s.widget&&s.widget.type.toDOM.parentNode){let l=new it(this.top,t,n,o);this.top.children.splice(this.index++,0,l),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],n=this.top;for(;t instanceof Dt;)n=t,t=n.children[n.children.length-1];(!t||!(t instanceof d)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Bt||Ot)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(t,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);"IMG"==t&&(o.className="ProseMirror-separator",o.alt=""),"BR"==t&&(o.className="ProseMirror-trailingBreak");let s=new g(this.top,[],o,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}}function Lt(e,t){return e.type.side-t.type.side}function Kt(e,t,n,o,s){let l=[];for(let h=0,_=0;h<e.length;h++){let E=e[h],R=_,L=_+=E.size;R>=n||L<=t?l.push(E):(R<t&&l.push(E.slice(0,t-R,o)),s&&(l.push(s),s=void 0),L>n&&l.push(E.slice(n-R,E.size,o)))}return l}function jt(e,t=null){let n=e.domSelectionRange(),o=e.state.doc;if(!n.focusNode)return null;let s=e.docView.nearestDesc(n.focusNode),l=s&&0==s.size,h=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(h<0)return null;let E,R,_=o.resolve(h);if(dt(n)){for(E=_;s&&!s.node;)s=s.parent;let L=s.node;if(s&&L.isAtom&&C.qv.isSelectable(L)&&s.parent&&(!L.isInline||!function(e,t,n){for(let o=0==t,s=t==X(e);o||s;){if(e==n)return!0;let l=x(e);if(!(e=e.parentNode))return!1;o=o&&0==l,s=s&&l==X(e)}}(n.focusNode,n.focusOffset,s.dom))){let Y=s.posBefore;R=new C.qv(h==Y?_:o.resolve(Y))}}else{let L=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(L<0)return null;E=o.resolve(L)}return R||(R=Ie(e,E,_,"pointer"==t||e.state.selection.head<_.pos&&!l?1:-1)),R}function Te(e){return e.editable?e.hasFocus():Qe(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function ue(e,t=!1){let n=e.state.selection;if(Ve(e,n),Te(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Ot){let o=e.domSelectionRange(),s=e.domObserver.currentSelection;if(o.anchorNode&&s.anchorNode&&G(o.anchorNode,o.anchorOffset,s.anchorNode,s.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange(),o=e.cursorWrapper.dom,s="IMG"==o.nodeName;s?n.setEnd(o.parentNode,x(o)+1):n.setEnd(o,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!s&&!e.state.selection.visible&&at&&ft<=11&&(o.disabled=!0,o.disabled=!1)}(e);else{let l,h,{anchor:o,head:s}=n;Le&&!(n instanceof C.Bs)&&(n.$from.parent.inlineContent||(l=$e(e,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(h=$e(e,n.to))),e.docView.setSelection(o,s,e.root,t),Le&&(l&&Ye(l),h&&Ye(h)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),o=n.anchorNode,s=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(n.anchorNode!=o||n.anchorOffset!=s)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!Te(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const Le=Bt||Ot&&Pt<63;function $e(e,t){let{node:n,offset:o}=e.docView.domFromPos(t,0),s=o<n.childNodes.length?n.childNodes[o]:null,l=o?n.childNodes[o-1]:null;if(Bt&&s&&"false"==s.contentEditable)return We(s);if(!(s&&"false"!=s.contentEditable||l&&"false"!=l.contentEditable)){if(s)return We(s);if(l)return We(l)}}function We(e){return e.contentEditable="true",Bt&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Ye(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Ve(e,t){if(t instanceof C.qv){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(je(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else je(e)}function je(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function Ie(e,t,n,o){return e.someProp("createSelectionBetween",s=>s(e,t,n))||C.Bs.between(t,n,o)}function Ne(e){return!(e.editable&&!e.hasFocus())&&Qe(e)}function Qe(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function pe(e,t){let{$anchor:n,$head:o}=e.selection,s=t>0?n.max(o):n.min(o),l=s.parent.inlineContent?s.depth?e.doc.resolve(t>0?s.after():s.before()):null:s;return l&&C.Y1.findFrom(l,t)}function De(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Ge(e,t,n){let o=e.state.selection;if(!(o instanceof C.Bs)){if(o instanceof C.qv&&o.node.isInline)return De(e,new C.Bs(t>0?o.$to:o.$from));{let s=pe(e.state,t);return!!s&&De(e,s)}}if(!o.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){let s=pe(e.state,t);return!!(s&&s instanceof C.qv)&&De(e,s)}if(!(b&&n.indexOf("m")>-1)){let h,s=o.$head,l=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!l||l.isText)return!1;let _=t<0?s.pos-l.nodeSize:s.pos;return!!(l.isAtom||(h=e.docView.descAt(_))&&!h.contentDOM)&&(C.qv.isSelectable(l)?De(e,new C.qv(t<0?e.state.doc.resolve(s.pos-l.nodeSize):s)):!!J&&De(e,new C.Bs(e.state.doc.resolve(t<0?_:_+l.nodeSize))))}}function Se(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function re(e){let t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function Ue(e){let t=e.domSelectionRange(),n=t.focusNode,o=t.focusOffset;if(!n)return;let s,l,h=!1;for(Ct&&1==n.nodeType&&o<Se(n)&&re(n.childNodes[o])&&(h=!0);;)if(o>0){if(1!=n.nodeType)break;{let _=n.childNodes[o-1];if(re(_))s=n,l=--o;else{if(3!=_.nodeType)break;n=_,o=n.nodeValue.length}}}else{if(Xe(n))break;{let _=n.previousSibling;for(;_&&re(_);)s=n.parentNode,l=x(_),_=_.previousSibling;if(_)n=_,o=Se(n);else{if(n=n.parentNode,n==e.dom)break;o=0}}}h?Qt(e,n,o):s&&Qt(e,s,l)}function ke(e){let t=e.domSelectionRange(),n=t.focusNode,o=t.focusOffset;if(!n)return;let l,h,s=Se(n);for(;;)if(o<s){if(1!=n.nodeType)break;if(!re(n.childNodes[o]))break;l=n,h=++o}else{if(Xe(n))break;{let _=n.nextSibling;for(;_&&re(_);)l=_.parentNode,h=x(_)+1,_=_.nextSibling;if(_)n=_,o=0,s=Se(n);else{if(n=n.parentNode,n==e.dom)break;o=s=0}}}l&&Qt(e,l,h)}function Xe(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Qt(e,t,n){let o=e.domSelection();if(dt(o)){let l=document.createRange();l.setEnd(t,n),l.setStart(t,n),o.removeAllRanges(),o.addRange(l)}else o.extend&&o.extend(t,n);e.domObserver.setCurSelection();let{state:s}=e;setTimeout(()=>{e.state==s&&ue(e)},50)}function Sn(e,t,n){let o=e.state.selection;if(o instanceof C.Bs&&!o.empty||n.indexOf("s")>-1||b&&n.indexOf("m")>-1)return!1;let{$from:s,$to:l}=o;if(!s.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let h=pe(e.state,t);if(h&&h instanceof C.qv)return De(e,h)}if(!s.parent.inlineContent){let h=t<0?s:l,_=o instanceof C.C1?C.Y1.near(h,t):C.Y1.findFrom(h,t);return!!_&&De(e,_)}return!1}function fn(e,t){if(!(e.state.selection instanceof C.Bs))return!0;let{$head:n,$anchor:o,empty:s}=e.state.selection;if(!n.sameParent(o))return!0;if(!s)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let l=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(l&&!l.isText){let h=e.state.tr;return t<0?h.delete(n.pos-l.nodeSize,n.pos):h.delete(n.pos,n.pos+l.nodeSize),e.dispatch(h),!0}return!1}function ln(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function kn(e,t){e.someProp("transformCopied",mt=>{t=mt(t,e)});let n=[],{content:o,openStart:s,openEnd:l}=t;for(;s>1&&l>1&&1==o.childCount&&1==o.firstChild.childCount;){s--,l--;let mt=o.firstChild;n.push(mt.type.name,mt.attrs!=mt.type.defaultAttrs?mt.attrs:null),o=mt.content}let h=e.someProp("clipboardSerializer")||i.PW.fromSchema(e.state.schema),_=Mn(),E=_.createElement("div");E.appendChild(h.serializeFragment(o,{document:_}));let L,R=E.firstChild,Y=0;for(;R&&1==R.nodeType&&(L=Hn[R.nodeName.toLowerCase()]);){for(let mt=L.length-1;mt>=0;mt--){let At=_.createElement(L[mt]);for(;E.firstChild;)At.appendChild(E.firstChild);E.appendChild(At),Y++}R=E.firstChild}return R&&1==R.nodeType&&R.setAttribute("data-pm-slice",`${s} ${l}${Y?` -${Y}`:""} ${JSON.stringify(n)}`),{dom:E,text:e.someProp("clipboardTextSerializer",mt=>mt(t,e))||t.content.textBetween(0,t.content.size,"\n\n")}}function Rn(e,t,n,o,s){let h,_,l=s.parent.type.spec.code;if(!n&&!t)return null;let E=t&&(o||l||!n);if(E){if(e.someProp("transformPastedText",st=>{t=st(t,l||o,e)}),l)return t?new i.p2(i.HY.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):i.p2.empty;let Y=e.someProp("clipboardTextParser",st=>st(t,s,o,e));if(Y)_=Y;else{let st=s.marks(),{schema:mt}=e.state,At=i.PW.fromSchema(mt);h=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(Nt=>{let Ut=h.appendChild(document.createElement("p"));Nt&&Ut.appendChild(At.serializeNode(mt.text(Nt,st)))})}}else e.someProp("transformPastedHTML",Y=>{n=Y(n,e)}),h=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let s,n=Mn().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);if((s=o&&Hn[o[1].toLowerCase()])&&(e=s.map(l=>"<"+l+">").join("")+e+s.map(l=>"</"+l+">").reverse().join("")),n.innerHTML=e,s)for(let l=0;l<s.length;l++)n=n.querySelector(s[l])||n;return n}(n),J&&function(e){let t=e.querySelectorAll(Ot?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let o=t[n];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),o)}}(h);let R=h&&h.querySelector("[data-pm-slice]"),L=R&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(R.getAttribute("data-pm-slice")||"");if(L&&L[3])for(let Y=+L[3];Y>0;Y--){let st=h.firstChild;for(;st&&1!=st.nodeType;)st=st.nextSibling;if(!st)break;h=st}if(_||(_=(e.someProp("clipboardParser")||e.someProp("domParser")||i.aw.fromSchema(e.state.schema)).parseSlice(h,{preserveWhitespace:!(!E&&!L),context:s,ruleFromNode:st=>"BR"!=st.nodeName||st.nextSibling||!st.parentNode||Ln.test(st.parentNode.nodeName)?null:{ignore:!0}})),L)_=function(e,t){if(!e.size)return e;let o,n=e.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(_){return e}let{content:s,openStart:l,openEnd:h}=e;for(let _=o.length-2;_>=0;_-=2){let E=n.nodes[o[_]];if(!E||E.hasRequiredAttrs())break;s=i.HY.from(E.create(o[_+1],s)),l++,h++}return new i.p2(s,l,h)}(Nn(_,+L[1],+L[2]),L[4]);else if(_=i.p2.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let l,s=t.node(n).contentMatchAt(t.index(n)),h=[];if(e.forEach(_=>{if(!h)return;let R,E=s.findWrapping(_.type);if(!E)return h=null;if(R=h.length&&l.length&&ze(E,l,_,h[h.length-1],0))h[h.length-1]=R;else{h.length&&(h[h.length-1]=Bn(h[h.length-1],l.length));let L=wn(_,E);h.push(L),s=s.matchType(L.type),l=E}}),h)return i.HY.from(h)}return e}(_.content,s),!0),_.openStart||_.openEnd){let Y=0,st=0;for(let mt=_.content.firstChild;Y<_.openStart&&!mt.type.spec.isolating;Y++,mt=mt.firstChild);for(let mt=_.content.lastChild;st<_.openEnd&&!mt.type.spec.isolating;st++,mt=mt.lastChild);_=Nn(_,Y,st)}return e.someProp("transformPasted",Y=>{_=Y(_,e)}),_}const Ln=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function wn(e,t,n=0){for(let o=t.length-1;o>=n;o--)e=t[o].create(null,i.HY.from(e));return e}function ze(e,t,n,o,s){if(s<e.length&&s<t.length&&e[s]==t[s]){let l=ze(e,t,n,o.lastChild,s+1);if(l)return o.copy(o.content.replaceChild(o.childCount-1,l));if(o.contentMatchAt(o.childCount).matchType(s==e.length-1?n.type:e[s+1]))return o.copy(o.content.append(i.HY.from(wn(n,e,s+1))))}}function Bn(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,Bn(e.lastChild,t-1)),o=e.contentMatchAt(e.childCount).fillBefore(i.HY.empty,!0);return e.copy(n.append(o))}function Cn(e,t,n,o,s,l){let h=t<0?e.firstChild:e.lastChild,_=h.content;return s<o-1&&(_=Cn(_,t,n,o,s+1,l)),s>=n&&(_=t<0?h.contentMatchAt(0).fillBefore(_,e.childCount>1||l<=s).append(_):_.append(h.contentMatchAt(h.childCount).fillBefore(i.HY.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,h.copy(_))}function Nn(e,t,n){return t<e.openStart&&(e=new i.p2(Cn(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new i.p2(Cn(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const Hn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let an=null;function Mn(){return an||(an=document.implementation.createHTMLDocument("title"))}const he={},fe={},so={touchstart:!0,touchmove:!0};class lo{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function we(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function En(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=o=>mn(e,o))})}function mn(e,t){return e.someProp("handleDOMEvents",n=>{let o=n[t.type];return!!o&&(o(e,t)||t.defaultPrevented)})}function uo(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function cn(e){return{left:e.clientX,top:e.clientY}}function dn(e,t,n,o,s){if(-1==o)return!1;let l=e.state.doc.resolve(o);for(let h=l.depth+1;h>0;h--)if(e.someProp(t,_=>h>l.depth?_(e,n,l.nodeAfter,l.before(h),s,!0):_(e,n,l.node(h),l.before(h),s,!1)))return!0;return!1}function Be(e,t,n){e.focused||e.focus();let o=e.state.tr.setSelection(t);"pointer"==n&&o.setMeta("pointer",!0),e.dispatch(o)}function mo(e,t,n,o){return dn(e,"handleDoubleClickOn",t,n,o)||e.someProp("handleDoubleClick",s=>s(e,t,o))}function On(e,t,n,o){return dn(e,"handleTripleClickOn",t,n,o)||e.someProp("handleTripleClick",s=>s(e,t,o))||function(e,t,n){if(0!=n.button)return!1;let o=e.state.doc;if(-1==t)return!!o.inlineContent&&(Be(e,C.Bs.create(o,0,o.content.size),"pointer"),!0);let s=o.resolve(t);for(let l=s.depth+1;l>0;l--){let h=l>s.depth?s.nodeAfter:s.node(l),_=s.before(l);if(h.inlineContent)Be(e,C.Bs.create(o,_+1,_+1+h.content.size),"pointer");else{if(!C.qv.isSelectable(h))continue;Be(e,C.qv.create(o,_),"pointer")}return!0}}(e,n,o)}function gn(e){return qe(e)}fe.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!Wn(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!F||!Ot||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!tt||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",o=>o(e,n))||function(e,t){let n=t.keyCode,o=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||b&&72==n&&"c"==o?fn(e,-1)||Ue(e):46==n||b&&68==n&&"c"==o?fn(e,1)||ke(e):13==n||27==n||(37==n||b&&66==n&&"c"==o?Ge(e,-1,o)||Ue(e):39==n||b&&70==n&&"c"==o?Ge(e,1,o)||ke(e):38==n||b&&80==n&&"c"==o?Sn(e,-1,o)||Ue(e):40==n||b&&78==n&&"c"==o?function(e){if(!Bt||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;ln(e,o,"true"),setTimeout(()=>ln(e,o,"false"),20)}return!1}(e)||Sn(e,1,o)||ke(e):o==(b?"m":"c")&&(66==n||73==n||89==n||90==n))}(e,n)?n.preventDefault():we(e,"key");else{let o=Date.now();e.input.lastIOSEnter=o,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==o&&(e.someProp("handleKeyDown",s=>s(e,Mt(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},fe.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},fe.keypress=(e,t)=>{let n=t;if(Wn(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||b&&n.metaKey)return;if(e.someProp("handleKeyPress",s=>s(e,n)))return void n.preventDefault();let o=e.state.selection;if(!(o instanceof C.Bs&&o.$from.sameParent(o.$to))){let s=String.fromCharCode(n.charCode);e.someProp("handleTextInput",l=>l(e,o.$from.pos,o.$to.pos,s))||e.dispatch(e.state.tr.insertText(s).scrollIntoView()),n.preventDefault()}};const Fn=b?"metaKey":"ctrlKey";he.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let o=gn(e),s=Date.now(),l="singleClick";s-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,o=t.y-e.clientY;return n*n+o*o<100}(n,e.input.lastClick)&&!n[Fn]&&("singleClick"==e.input.lastClick.type?l="doubleClick":"doubleClick"==e.input.lastClick.type&&(l="tripleClick")),e.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:l};let h=e.posAtCoords(cn(n));!h||("singleClick"==l?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new _o(e,h,n,!!o)):("doubleClick"==l?mo:On)(e,h.pos,h.inside,n)?n.preventDefault():we(e,"pointer"))};class _o{constructor(t,n,o,s){let l,h;if(this.view=t,this.pos=n,this.event=o,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[Fn],this.allowDefault=o.shiftKey,n.inside>-1)l=t.state.doc.nodeAt(n.inside),h=n.inside;else{let L=t.state.doc.resolve(n.pos);l=L.parent,h=L.depth?L.before():0}const _=s?null:o.target,E=_?t.docView.nearestDesc(_,!0):null;this.target=E?E.dom:null;let{selection:R}=t.state;(0==o.button&&l.type.spec.draggable&&!1!==l.type.spec.selectable||R instanceof C.qv&&R.from<=h&&R.to>h)&&(this.mightDrag={node:l,pos:h,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Ct||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),we(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ue(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(cn(t))),this.updateAllowDefault(t),this.allowDefault||!n?we(this.view,"pointer"):function(e,t,n,o,s){return dn(e,"handleClickOn",t,n,o)||e.someProp("handleClick",l=>l(e,t,o))||(s?function(e,t){if(-1==t)return!1;let o,s,n=e.state.selection;n instanceof C.qv&&(o=n.node);let l=e.state.doc.resolve(t);for(let h=l.depth+1;h>0;h--){let _=h>l.depth?l.nodeAfter:l.node(h);if(C.qv.isSelectable(_)){s=o&&n.$from.depth>0&&h>=n.$from.depth&&l.before(n.$from.depth+1)==n.$from.pos?l.before(n.$from.depth):l.before(h);break}}return null!=s&&(Be(e,C.qv.create(e.state.doc,s),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),o=n.nodeAfter;return!!(o&&o.isAtom&&C.qv.isSelectable(o))&&(Be(e,new C.qv(n),"pointer"),!0)}(e,n))}(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Bt&&this.mightDrag&&!this.mightDrag.node.isAtom||Ot&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Be(this.view,C.Y1.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):we(this.view,"pointer")}move(t){this.updateAllowDefault(t),we(this.view,"pointer"),0==t.buttons&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}function Wn(e,t){return!!e.composing||!!(Bt&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}he.touchstart=e=>{e.input.lastTouch=Date.now(),gn(e),we(e,"pointer")},he.touchmove=e=>{e.input.lastTouch=Date.now(),we(e,"pointer")},he.contextmenu=e=>gn(e);const zn=F?5e3:-1;function Tn(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>qe(e),t))}function un(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function qe(e,t=!1){if(!(F&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),un(e),t||e.docView&&e.docView.dirty){let n=jt(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}}fe.compositionstart=fe.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(o=>!1===o.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),qe(e,!0),e.markCursor=null;else if(qe(e),Ct&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let o=e.domSelectionRange();for(let s=o.focusNode,l=o.focusOffset;s&&1==s.nodeType&&0!=l;){let h=l<0?s.lastChild:s.childNodes[l-1];if(!h)break;if(3==h.nodeType){e.domSelection().collapse(h,h.nodeValue.length);break}s=h,l=-1}}e.input.composing=!0}Tn(e,zn)},fe.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,Tn(e,20))};const tn=at&&ft<15||tt&&ut<604;function xn(e,t,n,o){let s=Rn(e,t,n,e.input.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",_=>_(e,o,s||i.p2.empty)))return!0;if(!s)return!1;let l=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(s),h=l?e.state.tr.replaceSelectionWith(l,e.input.shiftKey):e.state.tr.replaceSelection(s);return e.dispatch(h.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}he.copy=fe.cut=(e,t)=>{let n=t,o=e.state.selection,s="cut"==n.type;if(o.empty)return;let l=tn?null:n.clipboardData,h=o.content(),{dom:_,text:E}=kn(e,h);l?(n.preventDefault(),l.clearData(),l.setData("text/html",_.innerHTML),l.setData("text/plain",E)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),s=document.createRange();s.selectNodeContents(t),e.dom.blur(),o.removeAllRanges(),o.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,_),s&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},fe.paste=(e,t)=>{let n=t;if(e.composing&&!F)return;let o=tn?null:n.clipboardData;o&&xn(e,o.getData("text/plain"),o.getData("text/html"),n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,o=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout(()=>{e.focus(),o.parentNode&&o.parentNode.removeChild(o),n?xn(e,o.value,null,t):xn(e,o.textContent,o.innerHTML,t)},50)}(e,n)};class vo{constructor(t,n){this.slice=t,this.move=n}}const Zn=b?"altKey":"ctrlKey";he.dragstart=(e,t)=>{let n=t,o=e.input.mouseDown;if(o&&o.done(),!n.dataTransfer)return;let s=e.state.selection,l=s.empty?null:e.posAtCoords(cn(n));if(!(l&&l.pos>=s.from&&l.pos<=(s instanceof C.qv?s.to-1:s.to)))if(o&&o.mightDrag)e.dispatch(e.state.tr.setSelection(C.qv.create(e.state.doc,o.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let R=e.docView.nearestDesc(n.target,!0);R&&R.node.type.spec.draggable&&R!=e.docView&&e.dispatch(e.state.tr.setSelection(C.qv.create(e.state.doc,R.posBefore)))}let h=e.state.selection.content(),{dom:_,text:E}=kn(e,h);n.dataTransfer.clearData(),n.dataTransfer.setData(tn?"Text":"text/html",_.innerHTML),n.dataTransfer.effectAllowed="copyMove",tn||n.dataTransfer.setData("text/plain",E),e.dragging=new vo(h,!n[Zn])},he.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},fe.dragover=fe.dragenter=(e,t)=>t.preventDefault(),fe.drop=(e,t)=>{let n=t,o=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let s=e.posAtCoords(cn(n));if(!s)return;let l=e.state.doc.resolve(s.pos),h=o&&o.slice;h?e.someProp("transformPasted",At=>{h=At(h,e)}):h=Rn(e,n.dataTransfer.getData(tn?"Text":"text/plain"),tn?null:n.dataTransfer.getData("text/html"),!1,l);let _=!(!o||n[Zn]);if(e.someProp("handleDrop",At=>At(e,n,h||i.p2.empty,_)))return void n.preventDefault();if(!h)return;n.preventDefault();let E=h?(0,w.nj)(e.state.doc,l.pos,h):l.pos;null==E&&(E=l.pos);let R=e.state.tr;_&&R.deleteSelection();let L=R.mapping.map(E),Y=0==h.openStart&&0==h.openEnd&&1==h.content.childCount,st=R.doc;if(Y?R.replaceRangeWith(L,L,h.content.firstChild):R.replaceRange(L,L,h),R.doc.eq(st))return;let mt=R.doc.resolve(L);if(Y&&C.qv.isSelectable(h.content.firstChild)&&mt.nodeAfter&&mt.nodeAfter.sameMarkup(h.content.firstChild))R.setSelection(new C.qv(mt));else{let At=R.mapping.map(E);R.mapping.maps[R.mapping.maps.length-1].forEach((Nt,Ut,Yt,ae)=>At=ae),R.setSelection(Ie(e,mt,R.doc.resolve(At)))}e.focus(),e.dispatch(R.setMeta("uiEvent","drop"))},he.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&ue(e)},20))},he.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},he.beforeinput=(e,t)=>{if(Ot&&F&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:o}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=o||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",l=>l(e,Mt(8,"Backspace")))))return;let{$cursor:s}=e.state.selection;s&&s.pos>0&&e.dispatch(e.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let e in fe)he[e]=fe[e];function pn(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class bn{constructor(t,n){this.toDOM=t,this.spec=n||Ke,this.side=this.spec.side||0}map(t,n,o,s){let{pos:l,deleted:h}=t.mapResult(n.from+s,this.side<0?-1:1);return h?null:new ye(l-o,l-o,this)}valid(){return!0}eq(t){return this==t||t instanceof bn&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&pn(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Fe{constructor(t,n){this.attrs=t,this.spec=n||Ke}map(t,n,o,s){let l=t.map(n.from+s,this.spec.inclusiveStart?-1:1)-o,h=t.map(n.to+s,this.spec.inclusiveEnd?1:-1)-o;return l>=h?null:new ye(l,h,this)}valid(t,n){return n.from<n.to}eq(t){return this==t||t instanceof Fe&&pn(this.attrs,t.attrs)&&pn(this.spec,t.spec)}static is(t){return t.type instanceof Fe}destroy(){}}class en{constructor(t,n){this.attrs=t,this.spec=n||Ke}map(t,n,o,s){let l=t.mapResult(n.from+s,1);if(l.deleted)return null;let h=t.mapResult(n.to+s,-1);return h.deleted||h.pos<=l.pos?null:new ye(l.pos-o,h.pos-o,this)}valid(t,n){let l,{index:o,offset:s}=t.content.findIndex(n.from);return s==n.from&&!(l=t.child(o)).isText&&s+l.nodeSize==n.to}eq(t){return this==t||t instanceof en&&pn(this.attrs,t.attrs)&&pn(this.spec,t.spec)}destroy(){}}class ye{constructor(t,n,o){this.from=t,this.to=n,this.type=o}copy(t,n){return new ye(t,n,this.type)}eq(t,n=0){return this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to}map(t,n,o){return this.type.map(t,this,n,o)}static widget(t,n,o){return new ye(t,t,new bn(n,o))}static inline(t,n,o,s){return new ye(t,n,new Fe(o,s))}static node(t,n,o,s){return new ye(t,n,new en(o,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Fe}}const nn=[],Ke={};class oe{constructor(t,n){this.local=t.length?t:nn,this.children=n.length?n:nn}static create(t,n){return n.length?Dn(n,t,0,Ke):se}find(t,n,o){let s=[];return this.findInner(null==t?0:t,null==n?1e9:n,s,0,o),s}findInner(t,n,o,s,l){for(let h=0;h<this.local.length;h++){let _=this.local[h];_.from<=n&&_.to>=t&&(!l||l(_.spec))&&o.push(_.copy(_.from+s,_.to+s))}for(let h=0;h<this.children.length;h+=3)if(this.children[h]<n&&this.children[h+1]>t){let _=this.children[h]+1;this.children[h+2].findInner(t-_,n-_,o,s+_,l)}}map(t,n,o){return this==se||0==t.maps.length?this:this.mapInner(t,n,0,0,o||Ke)}mapInner(t,n,o,s,l){let h;for(let _=0;_<this.local.length;_++){let E=this.local[_].map(t,o,s);E&&E.type.valid(n,E)?(h||(h=[])).push(E):l.onRemove&&l.onRemove(this.local[_].spec)}return this.children.length?function(e,t,n,o,s,l,h){let _=e.slice();for(let R=0,L=l;R<n.maps.length;R++){let Y=0;n.maps[R].forEach((st,mt,At,Nt)=>{let Ut=Nt-At-(mt-st);for(let Yt=0;Yt<_.length;Yt+=3){let ae=_[Yt+1];if(ae<0||st>ae+L-Y)continue;let Pe=_[Yt]+L-Y;mt>=Pe?_[Yt+1]=st<=Pe?-2:-1:At>=s&&Ut&&(_[Yt]+=Ut,_[Yt+1]+=Ut)}Y+=Ut}),L=n.maps[R].map(L,-1)}let E=!1;for(let R=0;R<_.length;R+=3)if(_[R+1]<0){if(-2==_[R+1]){E=!0,_[R+1]=-1;continue}let L=n.map(e[R]+l),Y=L-s;if(Y<0||Y>=o.content.size){E=!0;continue}let mt=n.map(e[R+1]+l,-1)-s,{index:At,offset:Nt}=o.content.findIndex(Y),Ut=o.maybeChild(At);if(Ut&&Nt==Y&&Nt+Ut.nodeSize==mt){let Yt=_[R+2].mapInner(n,Ut,L+1,e[R]+l+1,h);Yt!=se?(_[R]=Y,_[R+1]=mt,_[R+2]=Yt):(_[R+1]=-2,E=!0)}else E=!0}if(E){let R=function(e,t,n,o,s,l,h){function _(E,R){for(let L=0;L<E.local.length;L++){let Y=E.local[L].map(o,s,R);Y?n.push(Y):h.onRemove&&h.onRemove(E.local[L].spec)}for(let L=0;L<E.children.length;L+=3)_(E.children[L+2],E.children[L]+R+1)}for(let E=0;E<e.length;E+=3)-1==e[E+1]&&_(e[E+2],t[E]+l+1);return n}(_,e,t,n,s,l,h),L=Dn(R,o,0,h);t=L.local;for(let Y=0;Y<_.length;Y+=3)_[Y+1]<0&&(_.splice(Y,3),Y-=3);for(let Y=0,st=0;Y<L.children.length;Y+=3){let mt=L.children[Y];for(;st<_.length&&_[st]<mt;)st+=3;_.splice(st,0,L.children[Y],L.children[Y+1],L.children[Y+2])}}return new oe(t.sort(on),_)}(this.children,h||[],t,n,o,s,l):h?new oe(h.sort(on),nn):se}add(t,n){return n.length?this==se?oe.create(t,n):this.addInner(t,n,0):this}addInner(t,n,o){let s,l=0;t.forEach((_,E)=>{let L,R=E+o;if(L=Mo(n,_,R)){for(s||(s=this.children.slice());l<s.length&&s[l]<E;)l+=3;s[l]==E?s[l+2]=s[l+2].addInner(_,L,R+1):s.splice(l,0,E,E+_.nodeSize,Dn(L,_,R+1,Ke)),l+=3}});let h=Co(l?Eo(n):n,-o);for(let _=0;_<h.length;_++)h[_].type.valid(t,h[_])||h.splice(_--,1);return new oe(h.length?this.local.concat(h).sort(on):this.local,s||this.children)}remove(t){return 0==t.length||this==se?this:this.removeInner(t,0)}removeInner(t,n){let o=this.children,s=this.local;for(let l=0;l<o.length;l+=3){let h,_=o[l]+n,E=o[l+1]+n;for(let Y,L=0;L<t.length;L++)(Y=t[L])&&Y.from>_&&Y.to<E&&(t[L]=null,(h||(h=[])).push(Y));if(!h)continue;o==this.children&&(o=this.children.slice());let R=o[l+2].removeInner(h,_+1);R!=se?o[l+2]=R:(o.splice(l,3),l-=3)}if(s.length)for(let h,l=0;l<t.length;l++)if(h=t[l])for(let _=0;_<s.length;_++)s[_].eq(h,n)&&(s==this.local&&(s=this.local.slice()),s.splice(_--,1));return o==this.children&&s==this.local?this:s.length||o.length?new oe(s,o):se}forChild(t,n){if(this==se)return this;if(n.isLeaf)return oe.empty;let o,s;for(let _=0;_<this.children.length;_+=3)if(this.children[_]>=t){this.children[_]==t&&(o=this.children[_+2]);break}let l=t+1,h=l+n.content.size;for(let _=0;_<this.local.length;_++){let E=this.local[_];if(E.from<h&&E.to>l&&E.type instanceof Fe){let R=Math.max(l,E.from)-l,L=Math.min(h,E.to)-l;R<L&&(s||(s=[])).push(E.copy(R,L))}}if(s){let _=new oe(s.sort(on),nn);return o?new Je([_,o]):_}return o||se}eq(t){if(this==t)return!0;if(!(t instanceof oe)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0}locals(t){return $n(this.localsInner(t))}localsInner(t){if(this==se)return nn;if(t.inlineContent||!this.local.some(Fe.is))return this.local;let n=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof Fe||n.push(this.local[o]);return n}}oe.empty=new oe([],[]),oe.removeOverlap=$n;const se=oe.empty;class Je{constructor(t){this.members=t}map(t,n){const o=this.members.map(s=>s.map(t,n,Ke));return Je.from(o)}forChild(t,n){if(n.isLeaf)return oe.empty;let o=[];for(let s=0;s<this.members.length;s++){let l=this.members[s].forChild(t,n);l!=se&&(l instanceof Je?o=o.concat(l.members):o.push(l))}return Je.from(o)}eq(t){if(!(t instanceof Je)||t.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}locals(t){let n,o=!0;for(let s=0;s<this.members.length;s++){let l=this.members[s].localsInner(t);if(l.length)if(n){o&&(n=n.slice(),o=!1);for(let h=0;h<l.length;h++)n.push(l[h])}else n=l}return n?$n(o?n:n.sort(on)):nn}static from(t){switch(t.length){case 0:return se;case 1:return t[0];default:return new Je(t)}}}function Co(e,t){if(!t||!e.length)return e;let n=[];for(let o=0;o<e.length;o++){let s=e[o];n.push(new ye(s.from+t,s.to+t,s.type))}return n}function Mo(e,t,n){if(t.isLeaf)return null;let o=n+t.nodeSize,s=null;for(let h,l=0;l<e.length;l++)(h=e[l])&&h.from>n&&h.to<o&&((s||(s=[])).push(h),e[l]=null);return s}function Eo(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function Dn(e,t,n,o){let s=[],l=!1;t.forEach((_,E)=>{let R=Mo(e,_,E+n);if(R){l=!0;let L=Dn(R,_,n+E+1,o);L!=se&&s.push(E,E+_.nodeSize,L)}});let h=Co(l?Eo(e):e,-n).sort(on);for(let _=0;_<h.length;_++)h[_].type.valid(t,h[_])||(o.onRemove&&o.onRemove(h[_].spec),h.splice(_--,1));return h.length||s.length?new oe(h,s):se}function on(e,t){return e.from-t.from||e.to-t.to}function $n(e){let t=e;for(let n=0;n<t.length-1;n++){let o=t[n];if(o.from!=o.to)for(let s=n+1;s<t.length;s++){let l=t[s];if(l.from!=o.from){l.from<o.to&&(t==e&&(t=e.slice()),t[n]=o.copy(o.from,l.from),yo(t,s,o.copy(l.from,o.to)));break}l.to!=o.to&&(t==e&&(t=e.slice()),t[s]=l.copy(l.from,o.to),yo(t,s+1,l.copy(o.to,l.to)))}}return t}function yo(e,t,n){for(;t<e.length&&on(n,e[t])>0;)t++;e.splice(t,0,n)}function Pn(e){let t=[];return e.someProp("decorations",n=>{let o=n(e.state);o&&o!=se&&t.push(o)}),e.cursorWrapper&&t.push(oe.create(e.state.doc,[e.cursorWrapper.deco])),Je.from(t)}const Oo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},xo=at&&ft<=11;class bo{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Do{constructor(t,n){this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new bo,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let s=0;s<o.length;s++)this.queue.push(o[s]);at&&ft<=11&&o.some(s=>"childList"==s.type&&s.removedNodes.length||"characterData"==s.type&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),xo&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Oo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Ne(this.view)){if(this.suppressingSelectionUpdates)return ue(this.view);if(at&&ft<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&G(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let o,n=new Set;for(let l=t.focusNode;l;l=T(l))n.add(l);for(let l=t.anchorNode;l;l=T(l))if(n.has(l)){o=l;break}let s=o&&this.view.docView.nearestDesc(o);return s&&s.ignoreMutation({type:"selection",target:3==o.nodeType?o.parentNode:o})?(this.setCurSelection(),!0):void 0}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let n=this.observer?this.observer.takeRecords():[];this.queue.length&&(n=this.queue.concat(n),this.queue.length=0);let o=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(o)&&Ne(t)&&!this.ignoreSelectionChange(o),l=-1,h=-1,_=!1,E=[];if(t.editable)for(let L=0;L<n.length;L++){let Y=this.registerMutation(n[L],E);Y&&(l=l<0?Y.from:Math.min(Y.from,l),h=h<0?Y.to:Math.max(Y.to,h),Y.typeOver&&(_=!0))}if(Ct&&E.length>1){let L=E.filter(Y=>"BR"==Y.nodeName);if(2==L.length){let Y=L[0],st=L[1];Y.parentNode&&Y.parentNode.parentNode==st.parentNode?st.remove():Y.remove()}}let R=null;l<0&&s&&t.input.lastFocus>Date.now()-200&&t.input.lastTouch<Date.now()-300&&dt(o)&&(R=jt(t))&&R.eq(C.Y1.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,ue(t),this.currentSelection.set(o),t.scrollToSelection()):(l>-1||s)&&(l>-1&&(t.docView.markDirty(l,h),function(e){if(!Yn.has(e)&&(Yn.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))){if(e.requiresGeckoHackNode=Ct,An)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),An=!0}}(t)),this.handleDOMChange(l,h,_,E),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(o)||ue(t),this.currentSelection.set(o))}registerMutation(t,n){if(n.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(o==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if("childList"==t.type){for(let L=0;L<t.addedNodes.length;L++)n.push(t.addedNodes[L]);if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let s=t.previousSibling,l=t.nextSibling;if(at&&ft<=11&&t.addedNodes.length)for(let L=0;L<t.addedNodes.length;L++){let{previousSibling:Y,nextSibling:st}=t.addedNodes[L];(!Y||Array.prototype.indexOf.call(t.addedNodes,Y)<0)&&(s=Y),(!st||Array.prototype.indexOf.call(t.addedNodes,st)<0)&&(l=st)}let h=s&&s.parentNode==t.target?x(s)+1:0,_=o.localPosFromDOM(t.target,h,-1),E=l&&l.parentNode==t.target?x(l):t.target.childNodes.length;return{from:_,to:o.localPosFromDOM(t.target,E,1)}}return"attributes"==t.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let Yn=new WeakMap,An=!1;function So(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(Bt&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||Bt&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Vn(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:Ie(e,t.resolve(n.anchor),t.resolve(n.head))}function Ze(e,t,n){let o=e.depth,s=t?e.end():e.pos;for(;o>0&&(t||e.indexAfter(o)==e.node(o).childCount);)o--,s++,t=!1;if(n){let l=e.node(o).maybeChild(e.indexAfter(o));for(;l&&!l.isLeaf;)l=l.firstChild,s++}return s}class wo{constructor(t,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new lo,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(y),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=p(this),Qn(this),this.nodeViews=u(this),this.docView=r(this.state.doc,jn(this),Pn(this),this.dom,this),this.domObserver=new Do(this,(o,s,l,h)=>function(e,t,n,o,s){if(t<0){let Wt=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,In=jt(e,Wt);if(In&&!e.state.selection.eq(In)){let No=e.state.tr.setSelection(In);"pointer"==Wt?No.setMeta("pointer",!0):"key"==Wt&&No.scrollIntoView(),e.dispatch(No)}return}let l=e.state.doc.resolve(t),h=l.sharedDepth(n);t=l.before(h+1),n=e.state.doc.resolve(n).after(h+1);let Y,st,_=e.state.selection,E=function(e,t,n){let R,{node:o,fromOffset:s,toOffset:l,from:h,to:_}=e.docView.parseRange(t,n),E=e.domSelectionRange(),L=E.anchorNode;if(L&&e.dom.contains(1==L.nodeType?L:L.parentNode)&&(R=[{node:L,offset:E.anchorOffset}],dt(E)||R.push({node:E.focusNode,offset:E.focusOffset})),Ot&&8===e.input.lastKeyCode)for(let Ut=l;Ut>s;Ut--){let Yt=o.childNodes[Ut-1],ae=Yt.pmViewDesc;if("BR"==Yt.nodeName&&!ae){l=Ut;break}if(!ae||ae.size)break}let Y=e.state.doc,st=e.someProp("domParser")||i.aw.fromSchema(e.state.schema),mt=Y.resolve(h),At=null,Nt=st.parse(o,{topNode:mt.parent,topMatch:mt.parent.contentMatchAt(mt.index()),topOpen:!0,from:s,to:l,preserveWhitespace:"pre"!=mt.parent.type.whitespace||"full",findPositions:R,ruleFromNode:So,context:mt});if(R&&null!=R[0].pos){let Ut=R[0].pos,Yt=R[1]&&R[1].pos;null==Yt&&(Yt=Ut),At={anchor:Ut+h,head:Yt+h}}return{doc:Nt,sel:At,from:h,to:_}}(e,t,n),R=e.state.doc,L=R.slice(E.from,E.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(Y=e.state.selection.to,st="end"):(Y=e.state.selection.from,st="start"),e.input.lastKeyCode=null;let mt=function(e,t,n,o,s){let l=e.findDiffStart(t,n);if(null==l)return null;let{a:h,b:_}=e.findDiffEnd(t,n+e.size,n+t.size);return"end"==s&&(o-=h+Math.max(0,l-Math.min(h,_))-l),h<l&&e.size<t.size?(l-=o<=l&&o>=h?l-o:0,_=l+(_-h),h=l):_<l&&(l-=o<=l&&o>=_?l-o:0,h=l+(h-_),_=l),{start:l,endA:h,endB:_}}(L.content,E.doc.content,E.from,Y,st);if((tt&&e.input.lastIOSEnter>Date.now()-225||F)&&s.some(Wt=>"DIV"==Wt.nodeName||"P"==Wt.nodeName||"LI"==Wt.nodeName)&&(!mt||mt.endA>=mt.endB)&&e.someProp("handleKeyDown",Wt=>Wt(e,Mt(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!mt){if(!(o&&_ instanceof C.Bs&&!_.empty&&_.$head.sameParent(_.$anchor))||e.composing||E.sel&&E.sel.anchor!=E.sel.head){if(E.sel){let Wt=Vn(e,e.state.doc,E.sel);Wt&&!Wt.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(Wt))}return}mt={start:_.from,endA:_.to,endB:_.to}}if(Ot&&e.cursorWrapper&&E.sel&&E.sel.anchor==e.cursorWrapper.deco.from&&E.sel.head==E.sel.anchor){let Wt=mt.endB-mt.start;E.sel={anchor:E.sel.anchor+Wt,head:E.sel.anchor+Wt}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&mt.start==mt.endB&&e.state.selection instanceof C.Bs&&(mt.start>e.state.selection.from&&mt.start<=e.state.selection.from+2&&e.state.selection.from>=E.from?mt.start=e.state.selection.from:mt.endA<e.state.selection.to&&mt.endA>=e.state.selection.to-2&&e.state.selection.to<=E.to&&(mt.endB+=e.state.selection.to-mt.endA,mt.endA=e.state.selection.to)),at&&ft<=11&&mt.endB==mt.start+1&&mt.endA==mt.start&&mt.start>E.from&&" \xa0"==E.doc.textBetween(mt.start-E.from-1,mt.start-E.from+1)&&(mt.start--,mt.endA--,mt.endB--);let ae,At=E.doc.resolveNoCache(mt.start-E.from),Nt=E.doc.resolveNoCache(mt.endB-E.from),Ut=R.resolve(mt.start),Yt=At.sameParent(Nt)&&At.parent.inlineContent&&Ut.end()>=mt.endA;if((tt&&e.input.lastIOSEnter>Date.now()-225&&(!Yt||s.some(Wt=>"DIV"==Wt.nodeName||"P"==Wt.nodeName))||!Yt&&At.pos<E.doc.content.size&&(ae=C.Y1.findFrom(E.doc.resolve(At.pos+1),1,!0))&&ae.head==Nt.pos)&&e.someProp("handleKeyDown",Wt=>Wt(e,Mt(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>mt.start&&function(e,t,n,o,s){if(!o.parent.isTextblock||n-t<=s.pos-o.pos||Ze(o,!0,!1)<s.pos)return!1;let l=e.resolve(t);if(l.parentOffset<l.parent.content.size||!l.parent.isTextblock)return!1;let h=e.resolve(Ze(l,!0,!0));return!(!h.parent.isTextblock||h.pos>n||Ze(h,!0,!1)<n)&&o.parent.content.cut(o.parentOffset).eq(h.parent.content)}(R,mt.start,mt.endA,At,Nt)&&e.someProp("handleKeyDown",Wt=>Wt(e,Mt(8,"Backspace"))))return void(F&&Ot&&e.domObserver.suppressSelectionUpdates());Ot&&F&&mt.endB==mt.start&&(e.input.lastAndroidDelete=Date.now()),F&&!Yt&&At.start()!=Nt.start()&&0==Nt.parentOffset&&At.depth==Nt.depth&&E.sel&&E.sel.anchor==E.sel.head&&E.sel.head==mt.endA&&(mt.endB-=2,Nt=E.doc.resolveNoCache(mt.endB-E.from),setTimeout(()=>{e.someProp("handleKeyDown",function(Wt){return Wt(e,Mt(13,"Enter"))})},20));let Re,Bo,Gn,Pe=mt.start,hn=mt.endA;if(Yt)if(At.pos==Nt.pos)at&&ft<=11&&0==At.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>ue(e),20)),Re=e.state.tr.delete(Pe,hn),Bo=R.resolve(mt.start).marksAcross(R.resolve(mt.endA));else if(mt.endA==mt.endB&&(Gn=function(e,t){let h,_,E,n=e.firstChild.marks,o=t.firstChild.marks,s=n,l=o;for(let L=0;L<o.length;L++)s=o[L].removeFromSet(s);for(let L=0;L<n.length;L++)l=n[L].removeFromSet(l);if(1==s.length&&0==l.length)_=s[0],h="add",E=L=>L.mark(_.addToSet(L.marks));else{if(0!=s.length||1!=l.length)return null;_=l[0],h="remove",E=L=>L.mark(_.removeFromSet(L.marks))}let R=[];for(let L=0;L<t.childCount;L++)R.push(E(t.child(L)));if(i.HY.from(R).eq(e))return{mark:_,type:h}}(At.parent.content.cut(At.parentOffset,Nt.parentOffset),Ut.parent.content.cut(Ut.parentOffset,mt.endA-Ut.start()))))Re=e.state.tr,"add"==Gn.type?Re.addMark(Pe,hn,Gn.mark):Re.removeMark(Pe,hn,Gn.mark);else if(At.parent.child(At.index()).isText&&At.index()==Nt.index()-(Nt.textOffset?0:1)){let Wt=At.parent.textBetween(At.parentOffset,Nt.parentOffset);if(e.someProp("handleTextInput",In=>In(e,Pe,hn,Wt)))return;Re=e.state.tr.insertText(Wt,Pe,hn)}if(Re||(Re=e.state.tr.replace(Pe,hn,E.doc.slice(mt.start-E.from,mt.endB-E.from))),E.sel){let Wt=Vn(e,Re.doc,E.sel);Wt&&!(Ot&&F&&e.composing&&Wt.empty&&(mt.start!=mt.endB||e.input.lastAndroidDelete<Date.now()-100)&&(Wt.head==Pe||Wt.head==Re.mapping.map(hn)-1)||at&&Wt.empty&&Wt.head==Pe)&&Re.setSelection(Wt)}Bo&&Re.ensureMarks(Bo),e.dispatch(Re.scrollIntoView())}(this,o,s,l,h)),this.domObserver.start(),function(e){for(let t in he){let n=he[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=o=>{uo(e,o)&&!mn(e,o)&&(e.editable||!(o.type in fe))&&n(e,o)},so[t]?{passive:!0}:void 0)}Bt&&e.dom.addEventListener("input",()=>null),En(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let n in t)this._props[n]=t[n];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&En(this);let n=this._props;this._props=t,t.plugins&&(t.plugins.forEach(y),this.directPlugins=t.plugins),this.updateStateInner(t.state,n)}setProps(t){let n={};for(let o in this._props)n[o]=this._props[o];n.state=this.state;for(let o in t)n[o]=t[o];this.update(n)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,n){let o=this.state,s=!1,l=!1;t.storedMarks&&this.composing&&(un(this),l=!0),this.state=t;let h=o.plugins!=t.plugins||this._props.plugins!=n.plugins;if(h||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let st=u(this);(function(e,t){let n=0,o=0;for(let s in e){if(e[s]!=t[s])return!0;n++}for(let s in t)o++;return n!=o})(st,this.nodeViews)&&(this.nodeViews=st,s=!0)}(h||n.handleDOMEvents!=this._props.handleDOMEvents)&&En(this),this.editable=p(this),Qn(this);let _=Pn(this),E=jn(this),R=o.plugins==t.plugins||o.doc.eq(t.doc)?t.scrollToSelection>o.scrollToSelection?"to selection":"preserve":"reset",L=s||!this.docView.matchesNode(t.doc,E,_);(L||!t.selection.eq(o.selection))&&(l=!0);let Y="preserve"==R&&l&&null==this.dom.style.overflowAnchor&&function(e){let o,s,t=e.dom.getBoundingClientRect(),n=Math.max(0,t.top);for(let l=(t.left+t.right)/2,h=n+1;h<Math.min(innerHeight,t.bottom);h+=5){let _=e.root.elementFromPoint(l,h);if(!_||_==e.dom||!e.dom.contains(_))continue;let E=_.getBoundingClientRect();if(E.top>=n-20){o=_,s=E.top;break}}return{refDOM:o,refTop:s,stack:Rt(e.dom)}}(this);if(l){this.domObserver.stop();let st=L&&(at||Ot)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(o.selection,t.selection);if(L){let mt=Ot?this.trackWrites=this.domSelectionRange().focusNode:null;(s||!this.docView.update(t.doc,E,_,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=r(t.doc,E,_,this.dom,this)),mt&&!this.trackWrites&&(st=!0)}st||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return G(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?ue(this,st):(Ve(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),"reset"==R?this.dom.scrollTop=0:"to selection"==R?this.scrollToSelection():Y&&function({refDOM:e,refTop:t,stack:n}){let o=e?e.getBoundingClientRect().top:0;Zt(n,0==o?0:o-t)}(Y)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof C.qv){let n=this.docView.domAfterPos(this.state.selection.from);1==n.nodeType&&xt(this,n.getBoundingClientRect(),t)}else xt(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let n=0;n<this.pluginViews.length;n++){let o=this.pluginViews[n];o.update&&o.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let o=this.directPlugins[n];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let o=this.state.plugins[n];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}}someProp(t,n){let s,o=this._props&&this._props[t];if(null!=o&&(s=n?n(o):o))return s;for(let h=0;h<this.directPlugins.length;h++){let _=this.directPlugins[h].props[t];if(null!=_&&(s=n?n(_):_))return s}let l=this.state.plugins;if(l)for(let h=0;h<l.length;h++){let _=l[h].props[t];if(null!=_&&(s=n?n(_):_))return s}}hasFocus(){if(at){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(ve)return e.focus(ve);let t=Rt(e);e.focus(null==ve?{get preventScroll(){return ve={preventScroll:!0},!0}}:void 0),ve||(ve=!1,Zt(t,0))}(this.dom),ue(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n;return t||document}posAtCoords(t){return me(this,t)}coordsAtPos(t,n=1){return _e(this,t,n)}domAtPos(t,n=0){return this.docView.domFromPos(t,n)}nodeDOM(t){let n=this.docView.descAt(t);return n?n.nodeDOM:null}posAtDOM(t,n,o=-1){let s=this.docView.posFromDOM(t,n,o);if(null==s)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(t,n){return function(e,t,n){return St==t&&Gt==n?qt:(St=t,Gt=n,qt="up"==n||"down"==n?function(e,t,n){let o=t.selection,s="up"==n?o.$from:o.$to;return ce(e,t,()=>{let{node:l}=e.docView.domFromPos(s.pos,"up"==n?-1:1);for(;;){let _=e.docView.nearestDesc(l,!0);if(!_)break;if(_.node.isBlock){l=_.dom;break}l=_.dom.parentNode}let h=_e(e,s.pos,1);for(let _=l.firstChild;_;_=_.nextSibling){let E;if(1==_.nodeType)E=_.getClientRects();else{if(3!=_.nodeType)continue;E=D(_,0,_.nodeValue.length).getClientRects()}for(let R=0;R<E.length;R++){let L=E[R];if(L.bottom>L.top+1&&("up"==n?h.top-L.top>2*(L.bottom-h.top):L.bottom-h.bottom>2*(h.bottom-L.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let s=o.parentOffset,l=!s,h=s==o.parent.content.size,_=e.domSelection();return Vt.test(o.parent.textContent)&&_.modify?ce(e,t,()=>{let{focusNode:E,focusOffset:R,anchorNode:L,anchorOffset:Y}=e.domSelectionRange(),st=_.caretBidiLevel;_.modify("move",n,"character");let mt=o.depth?e.docView.domAfterPos(o.before()):e.dom,{focusNode:At,focusOffset:Nt}=e.domSelectionRange(),Ut=At&&!mt.contains(1==At.nodeType?At:At.parentNode)||E==At&&R==Nt;try{_.collapse(L,Y),E&&(E!=L||R!=Y)&&_.extend&&_.extend(E,R)}catch(Yt){}return null!=st&&(_.caretBidiLevel=st),Ut}):"left"==n||"backward"==n?l:h}(e,t,n))}(this,n||this.state,t)}destroy(){!this.docView||(function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Pn(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(e,t){!mn(e,t)&&he[t.type]&&(e.editable||!(t.type in fe))&&he[t.type](e,t)}(this,t)}dispatch(t){let n=this._props.dispatchTransaction;n?n.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){return Bt&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom?function(e){let t;function n(E){E.preventDefault(),E.stopImmediatePropagation(),t=E.getTargetRanges()[0]}e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0);let o=t.startContainer,s=t.startOffset,l=t.endContainer,h=t.endOffset,_=e.domAtPos(e.state.selection.anchor);return G(_.node,_.offset,l,h)&&([o,s,l,h]=[l,h,o,s]),{anchorNode:o,anchorOffset:s,focusNode:l,focusOffset:h}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function jn(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let o in n)"class"==o&&(t.class+=" "+n[o]),"style"==o?t.style=(t.style?t.style+";":"")+n[o]:!t[o]&&"contenteditable"!=o&&"nodeName"!=o&&(t[o]=String(n[o]))}),[ye.node(0,e.state.doc.content.size,t)]}function Qn(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ye.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function p(e){return!e.someProp("editable",t=>!1===t(e.state))}function u(e){let t=Object.create(null);function n(o){for(let s in o)Object.prototype.hasOwnProperty.call(t,s)||(t[s]=o[s])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function y(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);
"use strict";var Ko=Object.defineProperty,Jo=Object.defineProperties,Zo=Object.getOwnPropertyDescriptors,no=Object.getOwnPropertySymbols,Uo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,zo=(Pt,ct,c)=>ct in Pt?Ko(Pt,ct,{enumerable:!0,configurable:!0,writable:!0,value:c}):Pt[ct]=c,Lt=(Pt,ct)=>{for(var c in ct||(ct={}))Uo.call(ct,c)&&zo(Pt,c,ct[c]);if(no)for(var c of no(ct))Wo.call(ct,c)&&zo(Pt,c,ct[c]);return Pt},fe=(Pt,ct)=>Jo(Pt,Zo(ct)),Fo=(Pt,ct)=>{var c={};for(var m in Pt)Uo.call(Pt,m)&&ct.indexOf(m)<0&&(c[m]=Pt[m]);if(null!=Pt&&no)for(var m of no(Pt))ct.indexOf(m)<0&&Wo.call(Pt,m)&&(c[m]=Pt[m]);return c};(self.webpackChunk_taiga_ui_components=self.webpackChunk_taiga_ui_components||[]).push([[70224],{40256:(Pt,ct,c)=>{c.r(ct),c.d(ct,{CommandManager:()=>Jt,Editor:()=>An,Extension:()=>Wt,InputRule:()=>O,Mark:()=>sn,Node:()=>ln,NodeView:()=>qn,PasteRule:()=>x,Tracker:()=>Io,callOrReturn:()=>V,combineTransactionSteps:()=>Gn,defaultBlockAt:()=>In,escapeForRegEx:()=>eo,extensions:()=>ie,findChildren:()=>vo,findChildrenInRange:()=>Co,findParentNode:()=>on,findParentNodeClosestToPos:()=>Yn,generateHTML:()=>Mo,generateJSON:()=>Xn,generateText:()=>Eo,getAttributes:()=>Qn,getChangedRanges:()=>Oo,getDebugJSON:()=>Sn,getExtensionField:()=>U,getHTMLFromFragment:()=>pn,getMarkAttributes:()=>je,getMarkRange:()=>ye,getMarkType:()=>te,getMarksBetween:()=>kn,getNodeAttributes:()=>Ae,getNodeType:()=>D,getSchema:()=>fn,getText:()=>bn,getTextBetween:()=>Ft,getTextContentFromNodes:()=>f,getTextSerializersFromSchema:()=>Kt,inputRulesPlugin:()=>Tt,isActive:()=>Dn,isList:()=>En,isMarkActive:()=>Fe,isNodeActive:()=>We,isNodeEmpty:()=>Pn,isNodeSelection:()=>bo,isTextSelection:()=>we,markInputRule:()=>Do,markPasteRule:()=>Ao,mergeAttributes:()=>b,nodeInputRule:()=>Bo,pasteRulesPlugin:()=>nt,posToDOMRect:()=>Rn,textInputRule:()=>Ho,textPasteRule:()=>to,textblockTypeInputRule:()=>No,wrappingInputRule:()=>Po});var m=c(62463),s=c(43594),k=c(13903),M=c(35917),h=c(38480);const j=(n,t)=>!n.selection.empty&&(t&&t(n.tr.deleteSelection().scrollIntoView()),!0),y=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("backward",n):o.parentOffset>0))return!1;let i=rt(o);if(!i){let a=o.blockRange(),u=a&&(0,h.k9)(a);return null!=u&&(t&&t(n.tr.lift(a,u).scrollIntoView()),!0)}let r=i.nodeBefore;if(!r.type.spec.isolating&&xt(n,i,t))return!0;if(0==o.parent.content.size&&(X(r,"end")||m.qv.isSelectable(r))){let a=(0,h.dR)(n.doc,o.before(),o.after(),M.p2.empty);if(a&&a.slice.size<a.to-a.from){if(t){let u=n.tr.step(a);u.setSelection(X(r,"end")?m.Y1.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):m.qv.create(u.doc,i.pos-r.nodeSize)),t(u.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos-r.nodeSize,i.pos).scrollIntoView()),0))};function X(n,t,e=!1){for(let o=n;o;o="start"==t?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(e&&1!=o.childCount)return!1}return!1}const $=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):o.parentOffset>0)return!1;r=rt(o)}let a=r&&r.nodeBefore;return!(!a||!m.qv.isSelectable(a)||(t&&t(n.tr.setSelection(m.qv.create(n.doc,r.pos-a.nodeSize)).scrollIntoView()),0))};function rt(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}const G=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size))return!1;let i=et(o);if(!i)return!1;let r=i.nodeAfter;if(xt(n,i,t))return!0;if(0==o.parent.content.size&&(X(r,"start")||m.qv.isSelectable(r))){let a=(0,h.dR)(n.doc,o.before(),o.after(),M.p2.empty);if(a&&a.slice.size<a.to-a.from){if(t){let u=n.tr.step(a);u.setSelection(X(r,"start")?m.Y1.findFrom(u.doc.resolve(u.mapping.map(i.pos)),1):m.qv.create(u.doc,u.mapping.map(i.pos))),t(u.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos,i.pos+r.nodeSize).scrollIntoView()),0))},ut=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size)return!1;r=et(o)}let a=r&&r.nodeAfter;return!(!a||!m.qv.isSelectable(a)||(t&&t(n.tr.setSelection(m.qv.create(n.doc,r.pos)).scrollIntoView()),0))};function et(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const _t=(n,t)=>{let{$head:e,$anchor:o}=n.selection;return!(!e.parent.type.spec.code||!e.sameParent(o)||(t&&t(n.tr.insertText("\n").scrollIntoView()),0))};function K(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const H=(n,t)=>{let{$head:e,$anchor:o}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(o))return!1;let i=e.node(-1),r=e.indexAfter(-1),a=K(i.contentMatchAt(r));if(!a||!i.canReplaceWith(r,r,a))return!1;if(t){let u=e.after(),p=n.tr.replaceWith(u,u,a.createAndFill());p.setSelection(m.Y1.near(p.doc.resolve(u),1)),t(p.scrollIntoView())}return!0},Y=(n,t)=>{let e=n.selection,{$from:o,$to:i}=e;if(e instanceof m.C1||o.parent.inlineContent||i.parent.inlineContent)return!1;let r=K(i.parent.contentMatchAt(i.indexAfter()));if(!r||!r.isTextblock)return!1;if(t){let a=(!o.parentOffset&&i.index()<i.parent.childCount?o:i).pos,u=n.tr.insert(a,r.createAndFill());u.setSelection(m.Bs.create(u.doc,a+1)),t(u.scrollIntoView())}return!0},L=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let r=e.before();if((0,h.Ax)(n.doc,r))return t&&t(n.tr.split(r).scrollIntoView()),!0}let o=e.blockRange(),i=o&&(0,h.k9)(o);return null!=i&&(t&&t(n.tr.lift(o,i).scrollIntoView()),!0)};function xt(n,t,e){let r,a,o=t.nodeBefore,i=t.nodeAfter;if(o.type.spec.isolating||i.type.spec.isolating)return!1;if(function(n,t,e){let o=t.nodeBefore,i=t.nodeAfter,r=t.index();return!(!(o&&i&&o.type.compatibleContent(i.type))||(!o.content.size&&t.parent.canReplace(r-1,r)?(e&&e(n.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(r,r+1)||!i.isTextblock&&!(0,h.Mn)(n.doc,t.pos)||(e&&e(n.tr.clearIncompatible(t.pos,o.type,o.contentMatchAt(o.childCount)).join(t.pos).scrollIntoView()),0)))}(n,t,e))return!0;let u=t.parent.canReplace(t.index(),t.index()+1);if(u&&(r=(a=o.contentMatchAt(o.childCount)).findWrapping(i.type))&&a.matchType(r[0]||i.type).validEnd){if(e){let R=t.pos+i.nodeSize,w=M.HY.empty;for(let mt=r.length-1;mt>=0;mt--)w=M.HY.from(r[mt].create(null,w));w=M.HY.from(o.copy(w));let W=n.tr.step(new h.FC(t.pos-1,R,t.pos,R,new M.p2(w,1,0),r.length,!0)),it=R+2*r.length;(0,h.Mn)(W.doc,it)&&W.join(it),e(W.scrollIntoView())}return!0}let p=m.Y1.findFrom(t,1),T=p&&p.$from.blockRange(p.$to),g=T&&(0,h.k9)(T);if(null!=g&&g>=t.depth)return e&&e(n.tr.lift(T,g).scrollIntoView()),!0;if(u&&X(i,"start",!0)&&X(o,"end")){let R=o,w=[];for(;w.push(R),!R.isTextblock;)R=R.lastChild;let W=i,it=1;for(;!W.isTextblock;W=W.firstChild)it++;if(R.canReplace(R.childCount,R.childCount,W.content)){if(e){let mt=M.HY.empty;for(let Rt=w.length-1;Rt>=0;Rt--)mt=M.HY.from(w[Rt].copy(mt));e(n.tr.step(new h.FC(t.pos-w.length,t.pos+i.nodeSize,t.pos+it,t.pos+i.nodeSize-it,new M.p2(mt,w.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function bt(n){return function(t,e){let o=t.selection,i=n<0?o.$from:o.$to,r=i.depth;for(;i.node(r).isInline;){if(!r)return!1;r--}return!!i.node(r).isTextblock&&(e&&e(t.tr.setSelection(m.Bs.create(t.doc,n<0?i.start(r):i.end(r)))),!0)}}const Bt=bt(-1),tt=bt(1);function z(n,t=null){return function(e,o){let{from:i,to:r}=e.selection,a=!1;return e.doc.nodesBetween(i,r,(u,p)=>{if(a)return!1;if(u.isTextblock&&!u.hasMarkup(n,t))if(u.type==n)a=!0;else{let T=e.doc.resolve(p),g=T.index();a=T.parent.canReplaceWith(g,g+1,n)}}),!!a&&(o&&o(e.tr.setBlockType(i,r,n,t).scrollIntoView()),!0)}}function Q(...n){return function(t,e,o){for(let i=0;i<n.length;i++)if(n[i](t,e,o))return!0;return!1}}let Et=Q(j,y,$),At=Q(j,G,ut);const It={Enter:Q(_t,Y,L,(n,t)=>{let{$from:e,$to:o}=n.selection;if(n.selection instanceof m.qv&&n.selection.node.isBlock)return!(!e.parentOffset||!(0,h.Ax)(n.doc,e.pos)||(t&&t(n.tr.split(e.pos).scrollIntoView()),0));if(!e.parent.isBlock)return!1;if(t){let i=o.parentOffset==o.parent.content.size,r=n.tr;(n.selection instanceof m.Bs||n.selection instanceof m.C1)&&r.deleteSelection();let a=0==e.depth?null:K(e.node(-1).contentMatchAt(e.indexAfter(-1))),u=i&&a?[{type:a}]:void 0,p=(0,h.Ax)(r.doc,r.mapping.map(e.pos),1,u);if(!u&&!p&&(0,h.Ax)(r.doc,r.mapping.map(e.pos),1,a?[{type:a}]:void 0)&&(a&&(u=[{type:a}]),p=!0),p&&(r.split(r.mapping.map(e.pos),1,u),!i&&!e.parentOffset&&e.parent.type!=a)){let T=r.mapping.map(e.before()),g=r.doc.resolve(T);a&&e.node(-1).canReplaceWith(g.index(),g.index()+1,a)&&r.setNodeMarkup(r.mapping.map(e.before()),a)}t(r.scrollIntoView())}return!0}),"Mod-Enter":H,Backspace:Et,"Mod-Backspace":Et,"Shift-Backspace":Et,Delete:At,"Mod-Delete":At,"Mod-a":(n,t)=>(t&&t(n.tr.setSelection(new m.C1(n.doc))),!0)},Zt={"Ctrl-h":It.Backspace,"Alt-Backspace":It["Mod-Backspace"],"Ctrl-d":It.Delete,"Ctrl-Alt-Backspace":It["Mod-Delete"],"Alt-Delete":It["Mod-Delete"],"Alt-d":It["Mod-Delete"],"Ctrl-a":Bt,"Ctrl-e":tt};for(let n in It)Zt[n]=It[n];function se(n){const{state:t,transaction:e}=n;let{selection:o}=e,{doc:i}=e,{storedMarks:r}=e;return fe(Lt({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return r},get selection(){return o},get doc(){return i},get tr(){return o=e.selection,i=e.doc,r=e.storedMarks,e}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class Jt{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:o}=this,{view:i}=e,{tr:r}=o,a=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([u,p])=>[u,(...g)=>{const R=p(...g)(a);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(r),R}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:a}=i,u=[],p=!!t,T=t||r.tr,R=fe(Lt({},Object.fromEntries(Object.entries(o).map(([w,W])=>[w,(...mt)=>{const Ot=this.buildProps(T,e),Rt=W(...mt)(Ot);return u.push(Rt),R}]))),{run:()=>(!p&&e&&!T.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(T),u.every(w=>!0===w))});return R}createCan(t){const{rawCommands:e,state:o}=this,i=void 0,r=t||o.tr,a=this.buildProps(r,i),u=Object.fromEntries(Object.entries(e).map(([p,T])=>[p,(...g)=>T(...g)(fe(Lt({},a),{dispatch:i}))]));return fe(Lt({},u),{chain:()=>this.createChain(r,i)})}buildProps(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:a}=i;r.storedMarks&&t.setStoredMarks(r.storedMarks);const u={tr:t,editor:i,view:a,state:se({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(o).map(([p,T])=>[p,(...g)=>T(...g)(u)]))}};return u}}function U(n,t,e){return void 0===n.config[t]&&n.parent?U(n.parent,t,e):"function"==typeof n.config[t]?n.config[t].bind(fe(Lt({},e),{parent:n.parent?U(n.parent,t,e):null})):n.config[t]}function _(n){return{baseExtensions:n.filter(i=>"extension"===i.type),nodeExtensions:n.filter(i=>"node"===i.type),markExtensions:n.filter(i=>"mark"===i.type)}}function C(n){const t=[],{nodeExtensions:e,markExtensions:o}=_(n),i=[...e,...o],r={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(a=>{const p=U(a,"addGlobalAttributes",{name:a.name,options:a.options,storage:a.storage});p&&p().forEach(g=>{g.types.forEach(R=>{Object.entries(g.attributes).forEach(([w,W])=>{t.push({type:R,name:w,attribute:Lt(Lt({},r),W)})})})})}),i.forEach(a=>{const p=U(a,"addAttributes",{name:a.name,options:a.options,storage:a.storage});if(!p)return;const T=p();Object.entries(T).forEach(([g,R])=>{const w=Lt(Lt({},r),R);R.isRequired&&void 0===R.default&&delete w.default,t.push({type:a.name,name:g,attribute:w})})}),t}function D(n,t){if("string"==typeof n){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}function b(...n){return n.filter(t=>!!t).reduce((t,e)=>{const o=Lt({},t);return Object.entries(e).forEach(([i,r])=>{o[i]=o[i]?"class"===i?[o[i],r].join(" "):"style"===i?[o[i],r].join("; "):r:r}),o},{})}function B(n,t){return t.filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,o)=>b(e,o),{})}function A(n){return"function"==typeof n}function V(n,t,...e){return A(n)?t?n.bind(t)(...e):n(...e):n}function kt(n,t){return n.style?n:fe(Lt({},n),{getAttrs:e=>{const o=n.getAttrs?n.getAttrs(e):n.attrs;if(!1===o)return!1;const i=t.reduce((r,a)=>{const u=a.attribute.parseHTML?a.attribute.parseHTML(e):function(n){return"string"!=typeof n?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):"true"===n||"false"!==n&&n}(e.getAttribute(a.name));return null==u?r:fe(Lt({},r),{[a.name]:u})},{});return Lt(Lt({},o),i)}})}function wt(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>("attrs"!==t||!function(n={}){return 0===Object.keys(n).length&&n.constructor===Object}(e))&&null!=e))}function S(n){var t;const e=C(n),{nodeExtensions:o,markExtensions:i}=_(n),r=null===(t=o.find(p=>U(p,"topNode")))||void 0===t?void 0:t.name,a=Object.fromEntries(o.map(p=>{const T=e.filter(Ot=>Ot.type===p.name),g={name:p.name,options:p.options,storage:p.storage},R=n.reduce((Ot,Rt)=>{const Yt=U(Rt,"extendNodeSchema",g);return Lt(Lt({},Ot),Yt?Yt(p):{})},{}),w=wt(fe(Lt({},R),{content:V(U(p,"content",g)),marks:V(U(p,"marks",g)),group:V(U(p,"group",g)),inline:V(U(p,"inline",g)),atom:V(U(p,"atom",g)),selectable:V(U(p,"selectable",g)),draggable:V(U(p,"draggable",g)),code:V(U(p,"code",g)),defining:V(U(p,"defining",g)),isolating:V(U(p,"isolating",g)),attrs:Object.fromEntries(T.map(Ot=>{var Rt;return[Ot.name,{default:null===(Rt=null==Ot?void 0:Ot.attribute)||void 0===Rt?void 0:Rt.default}]}))})),W=V(U(p,"parseHTML",g));W&&(w.parseDOM=W.map(Ot=>kt(Ot,T)));const it=U(p,"renderHTML",g);it&&(w.toDOM=Ot=>it({node:Ot,HTMLAttributes:B(Ot,T)}));const mt=U(p,"renderText",g);return mt&&(w.toText=mt),[p.name,w]})),u=Object.fromEntries(i.map(p=>{const T=e.filter(mt=>mt.type===p.name),g={name:p.name,options:p.options,storage:p.storage},R=n.reduce((mt,Ot)=>{const Rt=U(Ot,"extendMarkSchema",g);return Lt(Lt({},mt),Rt?Rt(p):{})},{}),w=wt(fe(Lt({},R),{inclusive:V(U(p,"inclusive",g)),excludes:V(U(p,"excludes",g)),group:V(U(p,"group",g)),spanning:V(U(p,"spanning",g)),code:V(U(p,"code",g)),attrs:Object.fromEntries(T.map(mt=>{var Ot;return[mt.name,{default:null===(Ot=null==mt?void 0:mt.attribute)||void 0===Ot?void 0:Ot.default}]}))})),W=V(U(p,"parseHTML",g));W&&(w.parseDOM=W.map(mt=>kt(mt,T)));const it=U(p,"renderHTML",g);return it&&(w.toDOM=mt=>it({mark:mt,HTMLAttributes:B(mt,T)})),[p.name,w]}));return new M.V_({topNode:r,nodes:a,marks:u})}function l(n,t){return t.nodes[n]||t.marks[n]||null}function d(n,t){return Array.isArray(t)?t.some(e=>("string"==typeof e?e:e.name)===n.name):t}const f=(n,t=500)=>{let e="";return n.parent.nodesBetween(Math.max(0,n.parentOffset-t),n.parentOffset,(o,i,r,a)=>{var u,p;e+=(null===(p=(u=o.type.spec).toText)||void 0===p?void 0:p.call(u,{node:o,pos:i,parent:r,index:a}))||o.textContent||"%leaf%"}),e};function v(n){return"[object RegExp]"===Object.prototype.toString.call(n)}class O{constructor(t){this.find=t.find,this.handler=t.handler}}function lt(n){var t;const{editor:e,from:o,to:i,text:r,rules:a,plugin:u}=n,{view:p}=e;if(p.composing)return!1;const T=p.state.doc.resolve(o);if(T.parent.type.spec.code||(null===(t=T.nodeBefore||T.nodeAfter)||void 0===t?void 0:t.marks.find(w=>w.type.spec.code)))return!1;let g=!1;const R=f(T)+r;return a.forEach(w=>{if(g)return;const W=((n,t)=>{if(v(t))return t.exec(n);const e=t(n);if(!e)return null;const o=[];return o.push(e.text),o.index=e.index,o.input=n,o.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(e.replaceWith)),o})(R,w.find);if(!W)return;const it=p.state.tr,mt=se({state:p.state,transaction:it}),Ot={from:o-(W[0].length-r.length),to:i},{commands:Rt,chain:Yt,can:ce}=new Jt({editor:e,state:mt});null===w.handler({state:mt,range:Ot,match:W,commands:Rt,chain:Yt,can:ce})||!it.steps.length||(it.setMeta(u,{transform:it,from:o,to:i,text:r}),p.dispatch(it),g=!0)}),g}function Tt(n){const{editor:t,rules:e}=n,o=new m.Sy({state:{init:()=>null,apply:(i,r)=>i.getMeta(o)||(i.selectionSet||i.docChanged?null:r)},props:{handleTextInput:(i,r,a,u)=>lt({editor:t,from:r,to:a,text:u,rules:e,plugin:o}),handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:r}=i.state.selection;r&&lt({editor:t,from:r.pos,to:r.pos,text:"",rules:e,plugin:o})}),!1)},handleKeyDown(i,r){if("Enter"!==r.key)return!1;const{$cursor:a}=i.state.selection;return!!a&&lt({editor:t,from:a.pos,to:a.pos,text:"\n",rules:e,plugin:o})}},isInputRules:!0});return o}class x{constructor(t){this.find=t.find,this.handler=t.handler}}function nt(n){const{editor:t,rules:e}=n;let o=null,i=!1,r=!1;return e.map(u=>new m.Sy({view(p){const T=g=>{var R;o=(null===(R=p.dom.parentElement)||void 0===R?void 0:R.contains(g.target))?p.dom.parentElement:null};return window.addEventListener("dragstart",T),{destroy(){window.removeEventListener("dragstart",T)}}},props:{handleDOMEvents:{drop:p=>(r=o===p.dom.parentElement,!1),paste:(p,T)=>{var g;const R=null===(g=T.clipboardData)||void 0===g?void 0:g.getData("text/html");return i=!!(null==R?void 0:R.includes("data-pm-slice")),!1}}},appendTransaction:(p,T,g)=>{const R=p[0],w="paste"===R.getMeta("uiEvent")&&!i,W="drop"===R.getMeta("uiEvent")&&!r;if(!w&&!W)return;const it=T.doc.content.findDiffStart(g.doc.content),mt=T.doc.content.findDiffEnd(g.doc.content);if(!function(n){return"number"==typeof n}(it)||!mt||it===mt.b)return;const Ot=g.tr,Rt=se({state:g,transaction:Ot});return function(n){const{editor:t,state:e,from:o,to:i,rule:r}=n,{commands:a,chain:u,can:p}=new Jt({editor:t,state:e}),T=[];return e.doc.nodesBetween(o,i,(R,w)=>{if(!R.isTextblock||R.type.spec.code)return;const W=Math.max(o,w),it=Math.min(i,w+R.content.size);((n,t)=>{if(v(t))return[...n.matchAll(t)];const e=t(n);return e?e.map(o=>{const i=[];return i.push(o.text),i.index=o.index,i.input=n,i.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(o.replaceWith)),i}):[]})(R.textBetween(W-w,it-w,void 0,"\ufffc"),r.find).forEach(Rt=>{if(void 0===Rt.index)return;const Yt=W+Rt.index+1,ce=Yt+Rt[0].length,Te={from:e.tr.mapping.map(Yt),to:e.tr.mapping.map(ce)},de=r.handler({state:e,range:Te,match:Rt,commands:a,chain:u,can:p});T.push(de)})}),T.every(R=>null!==R)}({editor:t,state:Rt,from:Math.max(it-1,0),to:mt.b,rule:u})&&Ot.steps.length?Ot:void 0}}))}class vt{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=vt.resolve(t),this.schema=S(this.extensions),this.extensions.forEach(o=>{var i;this.editor.extensionStorage[o.name]=o.storage;const r={name:o.name,options:o.options,storage:o.storage,editor:this.editor,type:l(o.name,this.schema)};"mark"===o.type&&(null===(i=V(U(o,"keepOnSplit",r)))||void 0===i||i)&&this.splittableMarks.push(o.name);const a=U(o,"onBeforeCreate",r);a&&this.editor.on("beforeCreate",a);const u=U(o,"onCreate",r);u&&this.editor.on("create",u);const p=U(o,"onUpdate",r);p&&this.editor.on("update",p);const T=U(o,"onSelectionUpdate",r);T&&this.editor.on("selectionUpdate",T);const g=U(o,"onTransaction",r);g&&this.editor.on("transaction",g);const R=U(o,"onFocus",r);R&&this.editor.on("focus",R);const w=U(o,"onBlur",r);w&&this.editor.on("blur",w);const W=U(o,"onDestroy",r);W&&this.editor.on("destroy",W)})}static resolve(t){const e=vt.sort(vt.flatten(t)),o=function(n){const t=n.filter((e,o)=>n.indexOf(e)!==o);return[...new Set(t)]}(e.map(i=>i.name));return o.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${o.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(e=>{const i=U(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return i?[e,...this.flatten(i())]:e}).flat(10)}static sort(t){return t.sort((o,i)=>{const r=U(o,"priority")||100,a=U(i,"priority")||100;return r>a?-1:r<a?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const i=U(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:l(e.name,this.schema)});return i?Lt(Lt({},t),i()):t},{})}get plugins(){const{editor:t}=this,e=vt.sort([...this.extensions].reverse()),o=[],i=[],r=e.map(a=>{const u={name:a.name,options:a.options,storage:a.storage,editor:t,type:l(a.name,this.schema)},p=[],T=U(a,"addKeyboardShortcuts",u);if(T){const W=Object.fromEntries(Object.entries(T()).map(([mt,Ot])=>[mt,()=>Ot({editor:t})])),it=(0,k.h)(W);p.push(it)}const g=U(a,"addInputRules",u);d(a,t.options.enableInputRules)&&g&&o.push(...g());const R=U(a,"addPasteRules",u);d(a,t.options.enablePasteRules)&&R&&i.push(...R());const w=U(a,"addProseMirrorPlugins",u);if(w){const W=w();p.push(...W)}return p}).flat();return[Tt({editor:t,rules:o}),...nt({editor:t,rules:i}),...r]}get attributes(){return C(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=_(this.extensions);return Object.fromEntries(e.filter(o=>!!U(o,"addNodeView")).map(o=>{const i=this.attributes.filter(p=>p.type===o.name),r={name:o.name,options:o.options,storage:o.storage,editor:t,type:D(o.name,this.schema)},a=U(o,"addNodeView",r);return a?[o.name,(p,T,g,R)=>{const w=B(p,i);return a()({editor:t,node:p,getPos:g,decorations:R,HTMLAttributes:w,extension:o})}]:[]}))}}function Nt(n){return"Object"===function(n){return Object.prototype.toString.call(n).slice(8,-1)}(n)&&n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Ut(n,t){const e=Lt({},n);return Nt(n)&&Nt(t)&&Object.keys(t).forEach(o=>{Nt(t[o])?o in n?e[o]=Ut(n[o],t[o]):Object.assign(e,{[o]:t[o]}):Object.assign(e,{[o]:t[o]})}),e}class Wt{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Lt(Lt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(U(this,"addOptions",{name:this.name}))),this.storage=V(U(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Wt(t)}configure(t={}){const e=this.extend();return e.options=Ut(this.options,t),e.storage=V(U(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Wt(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=V(U(e,"addOptions",{name:e.name})),e.storage=V(U(e,"addStorage",{name:e.name,options:e.options})),e}}function Ft(n,t,e){const{from:o,to:i}=t,{blockSeparator:r="\n\n",textSerializers:a={}}=e||{};let u="",p=!0;return n.nodesBetween(o,i,(T,g,R,w)=>{var W;const it=null==a?void 0:a[T.type.name];it?(T.isBlock&&!p&&(u+=r,p=!0),R&&(u+=it({node:T,pos:g,parent:R,index:w,range:t}))):T.isText?(u+=null===(W=null==T?void 0:T.text)||void 0===W?void 0:W.slice(Math.max(o,g)-g,i-g),p=!1):T.isBlock&&!p&&(u+=r,p=!0)}),u}function Kt(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const Qt=Wt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new m.Sy({key:new m.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:o,selection:i}=t,{ranges:r}=i;return Ft(o,{from:Math.min(...r.map(g=>g.$from.pos)),to:Math.max(...r.map(g=>g.$to.pos))},{textSerializers:Kt(e)})}}})]}});function De(n,t,e={strict:!0}){const o=Object.keys(t);return!o.length||o.every(i=>e.strict?t[i]===n[i]:v(t[i])?t[i].test(n[i]):t[i]===n[i])}function ke(n,t,e={}){return n.find(o=>o.type===t&&De(o.attrs,e))}function nn(n,t,e={}){return!!ke(n,t,e)}function ye(n,t,e={}){if(!n||!t)return;let o=n.parent.childAfter(n.parentOffset);if(n.parentOffset===o.offset&&0!==o.offset&&(o=n.parent.childBefore(n.parentOffset)),!o.node)return;const i=ke([...o.node.marks],t,e);if(!i)return;let r=o.index,a=n.start()+o.offset,u=r+1,p=a+o.node.nodeSize;for(ke([...o.node.marks],t,e);r>0&&i.isInSet(n.parent.child(r-1).marks);)r-=1,a-=n.parent.child(r).nodeSize;for(;u<n.parent.childCount&&nn([...n.parent.child(u).marks],t,e);)p+=n.parent.child(u).nodeSize,u+=1;return{from:a,to:p}}function te(n,t){if("string"==typeof n){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}function Le(n){return n&&"object"==typeof n&&!Array.isArray(n)&&!function(n){var t;return"class"===(null===(t=n.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(n)}function we(n){return Le(n)&&n instanceof m.Bs}function ue(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function Be(n,t=null){if(!t)return null;const e=m.Y1.atStart(n),o=m.Y1.atEnd(n);if("start"===t||!0===t)return e;if("end"===t)return o;const i=e.from,r=o.to;return"all"===t?m.Bs.create(n,ue(0,i,r),ue(n.content.size,i,r)):m.Bs.create(n,ue(t,i,r),ue(t,i,r))}function $t(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function mn(n){const t=`<body>${n}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function an(n,t,e){if(e=Lt({slice:!0,parseOptions:{}},e),"object"==typeof n&&null!==n)try{return Array.isArray(n)?M.HY.fromArray(n.map(o=>t.nodeFromJSON(o))):t.nodeFromJSON(n)}catch(o){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),an("",t,e)}if("string"==typeof n){const o=M.aw.fromSchema(t);return e.slice?o.parseSlice(mn(n),e.parseOptions).content:o.parse(mn(n),e.parseOptions)}return an("",t,e)}function _n(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function We(n,t,e={}){const{from:o,to:i,empty:r}=n.selection,a=t?D(t,n.schema):null,u=[];n.doc.nodesBetween(o,i,(R,w)=>{if(R.isText)return;const W=Math.max(o,w),it=Math.min(i,w+R.nodeSize);u.push({node:R,from:W,to:it})});const p=i-o,T=u.filter(R=>!a||a.name===R.node.type.name).filter(R=>De(R.node.attrs,e,{strict:!1}));return r?!!T.length:T.reduce((R,w)=>R+w.to-w.from,0)>=p}function cn(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function Kn(n,t){const e="string"==typeof t?[t]:t;return Object.keys(n).reduce((o,i)=>(e.includes(i)||(o[i]=n[i]),o),{})}function Jn(n,t,e={}){return an(n,t,{slice:!1,parseOptions:e})}function je(n,t){const e=te(t,n.schema),{from:o,to:i,empty:r}=n.selection,a=[];r?(n.storedMarks&&a.push(...n.storedMarks),a.push(...n.selection.$head.marks())):n.doc.nodesBetween(o,i,p=>{a.push(...p.marks)});const u=a.find(p=>p.type.name===e.name);return u?Lt({},u.attrs):{}}function dn(n,t,e){return Object.fromEntries(Object.entries(e).filter(([o])=>{const i=n.find(r=>r.type===t&&r.name===o);return!!i&&i.attribute.keepOnSplit}))}function Zn(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const o=e.filter(i=>null==t?void 0:t.includes(i.type.name));n.tr.ensureMarks(o)}}function Yn(n,t){for(let e=n.depth;e>0;e-=1){const o=n.node(e);if(t(o))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:o}}}function on(n){return t=>Yn(t.$from,n)}function En(n,t){const{nodeExtensions:e}=_(t),o=e.find(a=>a.name===n);if(!o)return!1;const r=V(U(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}const yn=(n,t)=>{const e=on(a=>a.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,h.Mn)(n.doc,e.pos)&&n.join(e.pos),!0},xn=(n,t)=>{const e=on(a=>a.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(e.start).after(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,h.Mn)(n.doc,o)&&n.join(o),!0};function Fe(n,t,e={}){const{empty:o,ranges:i}=n.selection,r=t?te(t,n.schema):null;if(o)return!!(n.storedMarks||n.selection.$from.marks()).filter(R=>!r||r.name===R.type.name).find(R=>De(R.attrs,e,{strict:!1}));let a=0;const u=[];if(i.forEach(({$from:R,$to:w})=>{const W=R.pos,it=w.pos;n.doc.nodesBetween(W,it,(mt,Ot)=>{if(!mt.isText&&!mt.marks.length)return;const Rt=Math.max(W,Ot),Yt=Math.min(it,Ot+mt.nodeSize);a+=Yt-Rt,u.push(...mt.marks.map(Te=>({mark:Te,from:Rt,to:Yt})))})}),0===a)return!1;const p=u.filter(R=>!r||r.name===R.mark.type.name).filter(R=>De(R.mark.attrs,e,{strict:!1})).reduce((R,w)=>R+w.to-w.from,0),T=u.filter(R=>!r||R.mark.type!==r&&R.mark.type.excludes(r)).reduce((R,w)=>R+w.to-w.from,0);return(p>0?p+T:p)>=a}var Ne=Object.freeze({__proto__:null,blur:()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),null===(e=null==window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())}),!0),clearContent:(n=!1)=>({commands:t})=>t.setContent("",n),clearNodes:()=>({state:n,tr:t,dispatch:e})=>{const{selection:o}=t,{ranges:i}=o;return e&&i.forEach(({$from:r,$to:a})=>{n.doc.nodesBetween(r.pos,a.pos,(u,p)=>{if(u.type.isText)return;const{doc:T,mapping:g}=t,R=T.resolve(g.map(p)),w=T.resolve(g.map(p+u.nodeSize)),W=R.blockRange(w);if(!W)return;const it=(0,h.k9)(W);if(u.type.isTextblock){const{defaultType:mt}=R.parent.contentMatchAt(R.index());t.setNodeMarkup(W.start,mt)}(it||0===it)&&t.lift(W,it)})}),!0},command:n=>t=>n(t),createParagraphNear:()=>({state:n,dispatch:t})=>Y(n,t),deleteNode:n=>({tr:t,state:e,dispatch:o})=>{const i=D(n,e.schema),r=t.selection.$anchor;for(let a=r.depth;a>0;a-=1)if(r.node(a).type===i){if(o){const p=r.before(a),T=r.after(a);t.delete(p,T).scrollIntoView()}return!0}return!1},deleteRange:n=>({tr:t,dispatch:e})=>{const{from:o,to:i}=n;return e&&t.delete(o,i),!0},deleteSelection:()=>({state:n,dispatch:t})=>j(n,t),enter:()=>({commands:n})=>n.keyboardShortcut("Enter"),exitCode:()=>({state:n,dispatch:t})=>H(n,t),extendMarkRange:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const r=te(n,o.schema),{doc:a,selection:u}=e,{$from:p,from:T,to:g}=u;if(i){const R=ye(p,r,t);if(R&&R.from<=T&&R.to>=g){const w=m.Bs.create(a,R.from,R.to);e.setSelection(w)}}return!0},first:n=>t=>{const e="function"==typeof n?n(t):n;for(let o=0;o<e.length;o+=1)if(e[o](t))return!0;return!1},focus:(n=null,t={})=>({editor:e,view:o,tr:i,dispatch:r})=>{t=Lt({scrollIntoView:!0},t);const a=()=>{$t()&&o.dom.focus(),requestAnimationFrame(()=>{e.isDestroyed||(o.focus(),(null==t?void 0:t.scrollIntoView)&&e.commands.scrollIntoView())})};if(o.hasFocus()&&null===n||!1===n)return!0;if(r&&null===n&&!we(e.state.selection))return a(),!0;const u=Be(e.state.doc,n)||e.state.selection,p=e.state.selection.eq(u);return r&&(p||i.setSelection(u),p&&i.storedMarks&&i.setStoredMarks(i.storedMarks),a()),!0},forEach:(n,t)=>e=>n.every((o,i)=>t(o,fe(Lt({},e),{index:i}))),insertContent:(n,t)=>({tr:e,commands:o})=>o.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),insertContentAt:(n,t,e)=>({tr:o,dispatch:i,editor:r})=>{if(i){e=Lt({parseOptions:{},updateSelection:!0},e);const a=an(t,r.schema,{parseOptions:Lt({preserveWhitespace:"full"},e.parseOptions)});if("<>"===a.toString())return!0;let{from:u,to:p}="number"==typeof n?{from:n,to:n}:n,T=!0,g=!0;if(((n=>n.toString().startsWith("<"))(a)?a:[a]).forEach(w=>{w.check(),T=!!T&&w.isText&&0===w.marks.length,g=!!g&&w.isBlock}),u===p&&g){const{parent:w}=o.doc.resolve(u);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(u-=1,p+=1)}T?o.insertText(t,u,p):o.replaceWith(u,p,a),e.updateSelection&&function(n,t,e){const o=n.steps.length-1;if(o<t)return;const i=n.steps[o];if(!(i instanceof h.Pu||i instanceof h.FC))return;let a=0;n.mapping.maps[o].forEach((u,p,T,g)=>{0===a&&(a=g)}),n.setSelection(m.Y1.near(n.doc.resolve(a),-1))}(o,o.steps.length-1)}return!0},joinBackward:()=>({state:n,dispatch:t})=>y(n,t),joinForward:()=>({state:n,dispatch:t})=>G(n,t),keyboardShortcut:n=>({editor:t,view:e,tr:o,dispatch:i})=>{const r=function(n){const t=n.split(/-(?!$)/);let o,i,r,a,e=t[t.length-1];"Space"===e&&(e=" ");for(let u=0;u<t.length-1;u+=1){const p=t[u];if(/^(cmd|meta|m)$/i.test(p))a=!0;else if(/^a(lt)?$/i.test(p))o=!0;else if(/^(c|ctrl|control)$/i.test(p))i=!0;else if(/^s(hift)?$/i.test(p))r=!0;else{if(!/^mod$/i.test(p))throw new Error(`Unrecognized modifier name: ${p}`);$t()||_n()?a=!0:i=!0}}return o&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),a&&(e=`Meta-${e}`),r&&(e=`Shift-${e}`),e}(n).split(/-(?!$)/),a=r.find(T=>!["Alt","Ctrl","Meta","Shift"].includes(T)),u=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),p=t.captureTransaction(()=>{e.someProp("handleKeyDown",T=>T(e,u))});return null==p||p.steps.forEach(T=>{const g=T.map(o.mapping);g&&i&&o.maybeStep(g)}),!0},lift:(n,t={})=>({state:e,dispatch:o})=>!!We(e,D(n,e.schema),t)&&((n,t)=>{let{$from:e,$to:o}=n.selection,i=e.blockRange(o),r=i&&(0,h.k9)(i);return null!=r&&(t&&t(n.tr.lift(i,r).scrollIntoView()),!0)})(e,o),liftEmptyBlock:()=>({state:n,dispatch:t})=>L(n,t),liftListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,a=>a.childCount>0&&a.firstChild.type==n);return!!r&&(!e||(o.node(r.depth-1).type==n?function(n,t,e,o){let i=n.tr,r=o.end,a=o.$to.end(o.depth);r<a&&(i.step(new h.FC(r-1,a,r,a,new M.p2(M.HY.from(e.create(null,o.parent.copy())),1,0),1,!0)),o=new M.Ts(i.doc.resolve(o.$from.pos),i.doc.resolve(a),o.depth));const u=(0,h.k9)(o);return null!=u&&(t(i.lift(o,u).scrollIntoView()),!0)}(t,e,n,r):function(n,t,e){let o=n.tr,i=e.parent;for(let W=e.end,it=e.endIndex-1,mt=e.startIndex;it>mt;it--)W-=i.child(it).nodeSize,o.delete(W-1,W+1);let r=o.doc.resolve(e.start),a=r.nodeAfter;if(o.mapping.map(e.end)!=e.start+r.nodeAfter.nodeSize)return!1;let u=0==e.startIndex,p=e.endIndex==i.childCount,T=r.node(-1),g=r.index(-1);if(!T.canReplace(g+(u?0:1),g+1,a.content.append(p?M.HY.empty:M.HY.from(i))))return!1;let R=r.pos,w=R+a.nodeSize;return o.step(new h.FC(R-(u?1:0),w+(p?1:0),R+1,w-1,new M.p2((u?M.HY.empty:M.HY.from(i.copy(M.HY.empty))).append(p?M.HY.empty:M.HY.from(i.copy(M.HY.empty))),u?0:1,p?0:1),u?0:1)),t(o.scrollIntoView()),!0}(t,e,r)))}}(D(n,t.schema))(t,e),newlineInCode:()=>({state:n,dispatch:t})=>_t(n,t),resetAttributes:(n,t)=>({tr:e,state:o,dispatch:i})=>{let r=null,a=null;const u=cn("string"==typeof n?n:n.name,o.schema);return!!u&&("node"===u&&(r=D(n,o.schema)),"mark"===u&&(a=te(n,o.schema)),i&&e.selection.ranges.forEach(p=>{o.doc.nodesBetween(p.$from.pos,p.$to.pos,(T,g)=>{r&&r===T.type&&e.setNodeMarkup(g,void 0,Kn(T.attrs,t)),a&&T.marks.length&&T.marks.forEach(R=>{a===R.type&&e.addMark(g,g+T.nodeSize,a.create(Kn(R.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),selectAll:()=>({tr:n,commands:t})=>t.setTextSelection({from:0,to:n.doc.content.size}),selectNodeBackward:()=>({state:n,dispatch:t})=>$(n,t),selectNodeForward:()=>({state:n,dispatch:t})=>ut(n,t),selectParentNode:()=>({state:n,dispatch:t})=>((n,t)=>{let i,{$from:e,to:o}=n.selection,r=e.sharedDepth(o);return 0!=r&&(i=e.before(r),t&&t(n.tr.setSelection(m.qv.create(n.doc,i))),!0)})(n,t),selectTextblockEnd:()=>({state:n,dispatch:t})=>tt(n,t),selectTextblockStart:()=>({state:n,dispatch:t})=>Bt(n,t),setContent:(n,t=!1,e={})=>({tr:o,editor:i,dispatch:r})=>{const{doc:a}=o,u=Jn(n,i.schema,e),p=m.Bs.create(a,0,a.content.size);return r&&o.setSelection(p).replaceSelectionWith(u,!1).setMeta("preventUpdate",!t),!0},setMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const{selection:r}=e,{empty:a,ranges:u}=r,p=te(n,o.schema);if(i)if(a){const T=je(o,p);e.addStoredMark(p.create(Lt(Lt({},T),t)))}else u.forEach(T=>{const g=T.$from.pos,R=T.$to.pos;o.doc.nodesBetween(g,R,(w,W)=>{const it=Math.max(W,g),mt=Math.min(W+w.nodeSize,R);w.marks.find(Rt=>Rt.type===p)?w.marks.forEach(Rt=>{p===Rt.type&&e.addMark(it,mt,p.create(Lt(Lt({},Rt.attrs),t)))}):e.addMark(it,mt,p.create(t))})});return!0},setMeta:(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),setNode:(n,t={})=>({state:e,dispatch:o,chain:i})=>{const r=D(n,e.schema);return r.isTextblock?i().command(({commands:a})=>!!z(r,t)(e)||a.clearNodes()).command(({state:a})=>z(r,t)(a,o)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,i=m.Y1.atStart(o).from,r=m.Y1.atEnd(o).to,a=ue(n,i,r),u=m.qv.create(o,a);t.setSelection(u)}return!0},setTextSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,{from:i,to:r}="number"==typeof n?{from:n,to:n}:n,a=m.Bs.atStart(o).from,u=m.Bs.atEnd(o).to,p=ue(i,a,u),T=ue(r,a,u),g=m.Bs.create(o,p,T);t.setSelection(g)}return!0},sinkListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,T=>T.childCount>0&&T.firstChild.type==n);if(!r)return!1;let a=r.startIndex;if(0==a)return!1;let u=r.parent,p=u.child(a-1);if(p.type!=n)return!1;if(e){let T=p.lastChild&&p.lastChild.type==u.type,g=M.HY.from(T?n.create():null),R=new M.p2(M.HY.from(n.create(null,M.HY.from(u.type.create(null,g)))),T?3:1,0),w=r.start,W=r.end;e(t.tr.step(new h.FC(w-(T?3:1),W,w,W,R,1,!0)).scrollIntoView())}return!0}}(D(n,t.schema))(t,e),splitBlock:({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:o,editor:i})=>{const{selection:r,doc:a}=t,{$from:u,$to:p}=r,g=dn(i.extensionManager.attributes,u.node().type.name,u.node().attrs);if(r instanceof m.qv&&r.node.isBlock)return!(!u.parentOffset||!(0,h.Ax)(a,u.pos)||(o&&(n&&Zn(e,i.extensionManager.splittableMarks),t.split(u.pos).scrollIntoView()),0));if(!u.parent.isBlock)return!1;if(o){const R=p.parentOffset===p.parent.content.size;r instanceof m.Bs&&t.deleteSelection();const w=0===u.depth?void 0:function(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}(u.node(-1).contentMatchAt(u.indexAfter(-1)));let W=R&&w?[{type:w,attrs:g}]:void 0,it=(0,h.Ax)(t.doc,t.mapping.map(u.pos),1,W);if(!W&&!it&&(0,h.Ax)(t.doc,t.mapping.map(u.pos),1,w?[{type:w}]:void 0)&&(it=!0,W=w?[{type:w,attrs:g}]:void 0),it&&(t.split(t.mapping.map(u.pos),1,W),w&&!R&&!u.parentOffset&&u.parent.type!==w)){const mt=t.mapping.map(u.before()),Ot=t.doc.resolve(mt);u.node(-1).canReplaceWith(Ot.index(),Ot.index()+1,w)&&t.setNodeMarkup(t.mapping.map(u.before()),w)}n&&Zn(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:n=>({tr:t,state:e,dispatch:o,editor:i})=>{var r;const a=D(n,e.schema),{$from:u,$to:p}=e.selection,T=e.selection.node;if(T&&T.isBlock||u.depth<2||!u.sameParent(p))return!1;const g=u.node(-1);if(g.type!==a)return!1;const R=i.extensionManager.attributes;if(0===u.parent.content.size&&u.node(-1).childCount===u.indexAfter(-1)){if(2===u.depth||u.node(-3).type!==a||u.index(-2)!==u.node(-2).childCount-1)return!1;if(o){let Ot=M.HY.empty;const Rt=u.index(-1)?1:u.index(-2)?2:3;for(let Ie=u.depth-Rt;Ie>=u.depth-3;Ie-=1)Ot=M.HY.from(u.node(Ie).copy(Ot));const Yt=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,ce=dn(R,u.node().type.name,u.node().attrs),Te=(null===(r=a.contentMatch.defaultType)||void 0===r?void 0:r.createAndFill(ce))||void 0;Ot=Ot.append(M.HY.from(a.createAndFill(null,Te)||void 0));const de=u.before(u.depth-(Rt-1));t.replace(de,u.after(-Yt),new M.p2(Ot,4-Rt,0));let Xe=-1;t.doc.nodesBetween(de,t.doc.content.size,(Ie,Ht)=>{if(Xe>-1)return!1;Ie.isTextblock&&0===Ie.content.size&&(Xe=Ht+1)}),Xe>-1&&t.setSelection(m.Bs.near(t.doc.resolve(Xe))),t.scrollIntoView()}return!0}const w=p.pos===u.end()?g.contentMatchAt(0).defaultType:null,W=dn(R,g.type.name,g.attrs),it=dn(R,u.node().type.name,u.node().attrs);t.delete(u.pos,p.pos);const mt=w?[{type:a,attrs:W},{type:w,attrs:it}]:[{type:a,attrs:W}];return!!(0,h.Ax)(t.doc,u.pos,2)&&(o&&t.split(u.pos,2,mt).scrollIntoView(),!0)},toggleList:(n,t)=>({editor:e,tr:o,state:i,dispatch:r,chain:a,commands:u,can:p})=>{const{extensions:T}=e.extensionManager,g=D(n,i.schema),R=D(t,i.schema),{selection:w}=i,{$from:W,$to:it}=w,mt=W.blockRange(it);if(!mt)return!1;const Ot=on(Rt=>En(Rt.type.name,T))(w);if(mt.depth>=1&&Ot&&mt.depth-Ot.depth<=1){if(Ot.node.type===g)return u.liftListItem(R);if(En(Ot.node.type.name,T)&&g.validContent(Ot.node.content)&&r)return a().command(()=>(o.setNodeMarkup(Ot.pos,g),!0)).command(()=>yn(o,g)).command(()=>xn(o,g)).run()}return a().command(()=>!!p().wrapInList(g)||u.clearNodes()).wrapInList(g).command(()=>yn(o,g)).command(()=>xn(o,g)).run()},toggleMark:(n,t={},e={})=>({state:o,commands:i})=>{const{extendEmptyMarkRange:r=!1}=e,a=te(n,o.schema);return Fe(o,a,t)?i.unsetMark(a,{extendEmptyMarkRange:r}):i.setMark(a,t)},toggleNode:(n,t,e={})=>({state:o,commands:i})=>{const r=D(n,o.schema),a=D(t,o.schema);return We(o,r,e)?i.setNode(a):i.setNode(r,e)},toggleWrap:(n,t={})=>({state:e,commands:o})=>{const i=D(n,e.schema);return We(e,i,t)?o.lift(i):o.wrapIn(i,t)},undoInputRule:()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let o=0;o<e.length;o+=1){const i=e[o];let r;if(i.spec.isInputRules&&(r=i.getState(n))){if(t){const a=n.tr,u=r.transform;for(let p=u.steps.length-1;p>=0;p-=1)a.step(u.steps[p].invert(u.docs[p]));if(r.text){const p=a.doc.resolve(r.from).marks();a.replaceWith(r.from,r.to,n.schema.text(r.text,p))}else a.delete(r.from,r.to)}return!0}}return!1},unsetAllMarks:()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:o,ranges:i}=e;return o||t&&i.forEach(r=>{n.removeMark(r.$from.pos,r.$to.pos)}),!0},unsetMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{var r;const{extendEmptyMarkRange:a=!1}=t,{selection:u}=e,p=te(n,o.schema),{$from:T,empty:g,ranges:R}=u;if(!i)return!0;if(g&&a){let{from:w,to:W}=u;const it=null===(r=T.marks().find(Ot=>Ot.type===p))||void 0===r?void 0:r.attrs,mt=ye(T,p,it);mt&&(w=mt.from,W=mt.to),e.removeMark(w,W,p)}else R.forEach(w=>{e.removeMark(w.$from.pos,w.$to.pos,p)});return e.removeStoredMark(p),!0},updateAttributes:(n,t={})=>({tr:e,state:o,dispatch:i})=>{let r=null,a=null;const u=cn("string"==typeof n?n:n.name,o.schema);return!!u&&("node"===u&&(r=D(n,o.schema)),"mark"===u&&(a=te(n,o.schema)),i&&e.selection.ranges.forEach(p=>{const T=p.$from.pos,g=p.$to.pos;o.doc.nodesBetween(T,g,(R,w)=>{r&&r===R.type&&e.setNodeMarkup(w,void 0,Lt(Lt({},R.attrs),t)),a&&R.marks.length&&R.marks.forEach(W=>{if(a===W.type){const it=Math.max(w,T),mt=Math.min(w+R.nodeSize,g);e.addMark(it,mt,a.create(Lt(Lt({},W.attrs),t)))}})})}),!0)},wrapIn:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,a=i.blockRange(r),u=a&&(0,h.nd)(a,n,t);return!!u&&(o&&o(e.tr.wrap(a,u).scrollIntoView()),!0)}}(D(n,e.schema),t)(e,o),wrapInList:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,a=i.blockRange(r),u=!1,p=a;if(!a)return!1;if(a.depth>=2&&i.node(a.depth-1).type.compatibleContent(n)&&0==a.startIndex){if(0==i.index(a.depth-1))return!1;let g=e.doc.resolve(a.start-2);p=new M.Ts(g,g,a.depth),a.endIndex<a.parent.childCount&&(a=new M.Ts(i,e.doc.resolve(r.end(a.depth)),a.depth)),u=!0}let T=(0,h.nd)(p,n,t,a);return!!T&&(o&&o(function(n,t,e,o,i){let r=M.HY.empty;for(let g=e.length-1;g>=0;g--)r=M.HY.from(e[g].type.create(e[g].attrs,r));n.step(new h.FC(t.start-(o?2:0),t.end,t.start,t.end,new M.p2(r,0,0),e.length,!0));let a=0;for(let g=0;g<e.length;g++)e[g].type==i&&(a=g+1);let u=e.length-a,p=t.start+e.length-(o?2:0),T=t.parent;for(let g=t.startIndex,R=t.endIndex,w=!0;g<R;g++,w=!1)!w&&(0,h.Ax)(n.doc,p,u)&&(n.split(p,u),p+=2*u),p+=T.child(g).nodeSize;return n}(e.tr,a,T,u,n).scrollIntoView()),!0)}}(D(n,e.schema),t)(e,o)});const On=Wt.create({name:"commands",addCommands:()=>Lt({},Ne)}),ge=Wt.create({name:"editable",addProseMirrorPlugins(){return[new m.Sy({key:new m.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ge=Wt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new m.Sy({key:new m.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const o=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1},blur:(t,e)=>{n.isFocused=!1;const o=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1}}}})]}}),Ke=Wt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:u})=>{const{selection:p,doc:T}=u,{empty:g,$anchor:R}=p,{pos:w,parent:W}=R,it=m.Y1.atStart(T).from===w;return!(!(g&&it&&W.type.isTextblock)||W.textContent.length)&&a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.joinForward(),()=>a.selectNodeForward()]),o={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i=Lt({},o),r=fe(Lt({},o),{"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return $t()||_n()?r:i},addProseMirrorPlugins(){return[new m.Sy({key:new m.H$("clearDocument"),appendTransaction:(n,t,e)=>{if(!n.some(it=>it.docChanged)||t.doc.eq(e.doc))return;const{empty:i,from:r,to:a}=t.selection,u=m.Y1.atStart(t.doc).from,p=m.Y1.atEnd(t.doc).to,T=r===u&&a===p,g=0===e.doc.textBetween(0,e.doc.content.size," "," ").length;if(i||!T||!g)return;const R=e.tr,w=se({state:e,transaction:R}),{commands:W}=new Jt({editor:this.editor,state:w});return W.clearNodes(),R.steps.length?R:void 0}})]}}),oe=Wt.create({name:"tabindex",addProseMirrorPlugins(){return[new m.Sy({key:new m.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var ie=Object.freeze({__proto__:null,ClipboardTextSerializer:Qt,Commands:On,Editable:ge,FocusEvents:Ge,Keymap:Ke,Tabindex:oe});function Ae(n,t){const e=D(t,n.schema),{from:o,to:i}=n.selection,r=[];n.doc.nodesBetween(o,i,u=>{r.push(u)});const a=r.reverse().find(u=>u.type.name===e.name);return a?Lt({},a.attrs):{}}function Qn(n,t){const e=cn("string"==typeof t?t:t.name,n.schema);return"node"===e?Ae(n,t):"mark"===e?je(n,t):{}}function pn(n,t){const e=M.PW.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function bn(n,t){return Ft(n,{from:0,to:n.content.size},t)}function Dn(n,t,e={}){if(!t)return We(n,null,e)||Fe(n,null,e);const o=cn(t,n.schema);return"node"===o?We(n,t,e):"mark"===o&&Fe(n,t,e)}function Pn(n){var t;const e=null===(t=n.type.createAndFill())||void 0===t?void 0:t.toJSON(),o=n.toJSON();return JSON.stringify(e)===JSON.stringify(o)}class An extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const o=this.callbacks[t];return o&&o.forEach(i=>i.apply(this,e)),this}off(t,e){const o=this.callbacks[t];return o&&(e?this.callbacks[t]=o.filter(i=>i!==e):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(n,t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute("data-tiptap-style",""),o.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',document.getElementsByTagName("head")[0].appendChild(o),o}(0,this.options.injectNonce))}setOptions(t={}){this.options=Lt(Lt({},this.options),t),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const o=A(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:o});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,o=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(e))});this.view.updateState(o)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(ie):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(null==o?void 0:o.type));this.extensionManager=new vt(e,this)}createCommandManager(){this.commandManager=new Jt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=Jn(this.options.content,this.schema,this.options.parseOptions),e=Be(t,this.options.autofocus);this.view=new s.tk(this.options.element,fe(Lt({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:m.yy.create({doc:t,selection:e||void 0})}));const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(a=>{var u;return null===(u=this.capturedTransaction)||void 0===u?void 0:u.step(a)}):void(this.capturedTransaction=t);const e=this.state.apply(t),o=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),o&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),r=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Qn(this.state,t)}isActive(t,e){return Dn(this.state,"string"==typeof t?t:null,"string"==typeof t?e:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return pn(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:o={}}=t||{};return bn(this.state.doc,{blockSeparator:e,textSerializers:Lt(Lt({},o),Kt(this.schema))})}get isEmpty(){return Pn(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function Gn(n,t){const e=new h.wx(n);return t.forEach(o=>{o.steps.forEach(i=>{e.step(i)})}),e}function In(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function vo(n,t){const e=[];return n.descendants((o,i)=>{t(o)&&e.push({node:o,pos:i})}),e}function Co(n,t,e){const o=[];return n.nodesBetween(t.from,t.to,(i,r)=>{e(i)&&o.push({node:i,pos:r})}),o}function fn(n){return S(vt.resolve(n))}function Mo(n,t){const e=fn(t);return pn(M.NB.fromJSON(e,n).content,e)}function Xn(n,t){const e=fn(t),o=mn(n);return M.aw.fromSchema(e).parse(o).toJSON()}function Eo(n,t,e){const{blockSeparator:o="\n\n",textSerializers:i={}}=e||{},r=fn(t);return bn(M.NB.fromJSON(r,n),{blockSeparator:o,textSerializers:Lt(Lt({},i),Kt(r))})}function Oo(n){const{mapping:t,steps:e}=n,o=[];return t.maps.forEach((i,r)=>{const a=[];if(i.ranges.length)i.forEach((u,p)=>{a.push({from:u,to:p})});else{const{from:u,to:p}=e[r];if(void 0===u||void 0===p)return;a.push({from:u,to:p})}a.forEach(({from:u,to:p})=>{const T=t.slice(r).map(u,-1),g=t.slice(r).map(p),R=t.invert().map(T,-1),w=t.invert().map(g);o.push({oldRange:{from:R,to:w},newRange:{from:T,to:g}})})}),function(n){const t=function(n,t=JSON.stringify){const e={};return n.filter(o=>{const i=t(o);return!Object.prototype.hasOwnProperty.call(e,i)&&(e[i]=!0)})}(n);return 1===t.length?t:t.filter((e,o)=>!t.filter((r,a)=>a!==o).some(r=>e.oldRange.from>=r.oldRange.from&&e.oldRange.to<=r.oldRange.to&&e.newRange.from>=r.newRange.from&&e.newRange.to<=r.newRange.to))}(o)}function Sn(n,t=0){const o=n.type===n.type.schema.topNodeType?0:1,i=t,r=i+n.nodeSize,a=n.marks.map(T=>{const g={type:T.type.name};return Object.keys(T.attrs).length&&(g.attrs=Lt({},T.attrs)),g}),u=Lt({},n.attrs),p={type:n.type.name,from:i,to:r};return Object.keys(u).length&&(p.attrs=u),a.length&&(p.marks=a),n.content.childCount&&(p.content=[],n.forEach((T,g)=>{var R;null===(R=p.content)||void 0===R||R.push(Sn(T,t+g+o))})),n.text&&(p.text=n.text),p}function kn(n,t,e){const o=[];return n===t?e.resolve(n).marks().forEach(i=>{const a=ye(e.resolve(n-1),i.type);!a||o.push(Lt({mark:i},a))}):e.nodesBetween(n,t,(i,r)=>{o.push(...i.marks.map(a=>({from:r,to:r+i.nodeSize,mark:a})))}),o}function bo(n){return Le(n)&&n instanceof m.qv}function Rn(n,t,e){const i=n.state.doc.content.size,r=ue(t,0,i),a=ue(e,0,i),u=n.coordsAtPos(r),p=n.coordsAtPos(a,-1),T=Math.min(u.top,p.top),g=Math.max(u.bottom,p.bottom),R=Math.min(u.left,p.left),w=Math.max(u.right,p.right),Rt={top:T,bottom:g,left:R,right:w,width:w-R,height:g-T,x:R,y:T};return fe(Lt({},Rt),{toJSON:()=>Rt})}function Do(n){return new O({find:n.find,handler:({state:t,range:e,match:o})=>{const i=V(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,a=o[o.length-1],u=o[0];let p=e.to;if(a){const T=u.search(/\S/),g=e.from+u.indexOf(a),R=g+a.length;if(kn(e.from,e.to,t.doc).filter(W=>W.mark.type.excluded.find(mt=>mt===n.type&&mt!==W.mark.type)).filter(W=>W.to>g).length)return null;R<e.to&&r.delete(R,e.to),g>e.from&&r.delete(e.from+T,g),p=e.from+T+a.length,r.addMark(e.from+T,p,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function Bo(n){return new O({find:n.find,handler:({state:t,range:e,match:o})=>{const i=V(n.getAttributes,void 0,o)||{},{tr:r}=t,a=e.from;let u=e.to;if(o[1]){let T=a+o[0].lastIndexOf(o[1]);T>u?T=u:u=T+o[1].length,r.insertText(o[0][o[0].length-1],a+o[0].length-1),r.replaceWith(T,u,n.type.create(i))}else o[0]&&r.replaceWith(a,u,n.type.create(i))}})}function No(n){return new O({find:n.find,handler:({state:t,range:e,match:o})=>{const i=t.doc.resolve(e.from),r=V(n.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,r)}})}function Ho(n){return new O({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const a=e.to;if(o[1]){const u=o[0].lastIndexOf(o[1]);i+=o[0].slice(u+o[1].length),r+=u;const p=r-a;p>0&&(i=o[0].slice(u-p,u)+i,r=a)}t.tr.insertText(i,r,a)}})}function Po(n){return new O({find:n.find,handler:({state:t,range:e,match:o})=>{const i=V(n.getAttributes,void 0,o)||{},r=t.tr.delete(e.from,e.to),u=r.doc.resolve(e.from).blockRange(),p=u&&(0,h.nd)(u,n.type,i);if(!p)return null;r.wrap(u,p);const T=r.doc.resolve(e.from-1).nodeBefore;T&&T.type===n.type&&(0,h.Mn)(r.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(o,T))&&r.join(e.from-1)}})}class sn{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Lt(Lt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(U(this,"addOptions",{name:this.name}))),this.storage=V(U(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new sn(t)}configure(t={}){const e=this.extend();return e.options=Ut(this.options,t),e.storage=V(U(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new sn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=V(U(e,"addOptions",{name:e.name})),e.storage=V(U(e,"addStorage",{name:e.name,options:e.options})),e}}class ln{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Lt(Lt({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(U(this,"addOptions",{name:this.name}))),this.storage=V(U(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ln(t)}configure(t={}){const e=this.extend();return e.options=Ut(this.options,t),e.storage=V(U(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new ln(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=V(U(e,"addOptions",{name:e.name})),e.storage=V(U(e,"addStorage",{name:e.name,options:e.options})),e}}class qn{constructor(t,e,o){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options=Lt({stopEvent:null,ignoreMutation:null},o),this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,o,i,r,a,u,p;const{view:T}=this.editor,g=t.target,R=3===g.nodeType?null===(e=g.parentElement)||void 0===e?void 0:e.closest("[data-drag-handle]"):g.closest("[data-drag-handle]");if(!this.dom||(null===(o=this.contentDOM)||void 0===o?void 0:o.contains(g))||!R)return;let w=0,W=0;if(this.dom!==R){const Ot=this.dom.getBoundingClientRect(),Rt=R.getBoundingClientRect(),Yt=null!==(i=t.offsetX)&&void 0!==i?i:null===(r=t.nativeEvent)||void 0===r?void 0:r.offsetX,ce=null!==(a=t.offsetY)&&void 0!==a?a:null===(u=t.nativeEvent)||void 0===u?void 0:u.offsetY;w=Rt.x-Ot.x+Yt,W=Rt.y-Ot.y+ce}null===(p=t.dataTransfer)||void 0===p||p.setDragImage(this.dom,w,W);const it=m.qv.create(T.state.doc,this.getPos()),mt=T.state.tr.setSelection(it);T.dispatch(mt)}stopEvent(t){var e;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const o=t.target;if(!this.dom.contains(o)||(null===(e=this.contentDOM)||void 0===e?void 0:e.contains(o)))return!1;const r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(o.tagName)||o.isContentEditable)&&!r)return!0;const{isEditable:u}=this.editor,{isDragging:p}=this,T=!!this.node.type.spec.draggable,g=m.qv.isSelectable(this.node),R="copy"===t.type,w="paste"===t.type,W="cut"===t.type,it="mousedown"===t.type,mt=t.type.startsWith("drag");if(!T&&g&&mt&&t.preventDefault(),T&&mt&&!p)return t.preventDefault(),!1;if(T&&u&&!p&&it){const Ot=o.closest("[data-drag-handle]");Ot&&(this.dom===Ot||this.dom.contains(Ot))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(p||r||R||w||W||it&&g)}ignoreMutation(t){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:t}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===t.type||this.dom.contains(t.target)&&"childList"===t.type&&$t()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(o=>o.isContentEditable)||(this.contentDOM!==t.target||"attributes"!==t.type)&&this.contentDOM.contains(t.target))))}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const o=this.getPos();return e.setNodeMarkup(o,void 0,Lt(Lt({},this.node.attrs),t)),!0})}deleteNode(){const t=this.getPos();this.editor.commands.deleteRange({from:t,to:t+this.node.nodeSize})}}function Ao(n){return new x({find:n.find,handler:({state:t,range:e,match:o})=>{const i=V(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,a=o[o.length-1],u=o[0];let p=e.to;if(a){const T=u.search(/\S/),g=e.from+u.indexOf(a),R=g+a.length;if(kn(e.from,e.to,t.doc).filter(W=>W.mark.type.excluded.find(mt=>mt===n.type&&mt!==W.mark.type)).filter(W=>W.to>g).length)return null;R<e.to&&r.delete(R,e.to),g>e.from&&r.delete(e.from+T,g),p=e.from+T+a.length,r.addMark(e.from+T,p,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function to(n){return new x({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const a=e.to;if(o[1]){const u=o[0].lastIndexOf(o[1]);i+=o[0].slice(u+o[1].length),r+=u;const p=r-a;p>0&&(i=o[0].slice(u-p,u)+i,r=a)}t.tr.insertText(i,r,a)}})}class Io{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((i,r)=>{const a=r.getMap().mapResult(i);return a.deleted&&(e=!0),a.pos},t),deleted:e}}}function eo(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}},74634:(Pt,ct,c)=>{c.r(ct),c.d(ct,{TextStyle:()=>s,default:()=>s});var m=c(40256);const s=m.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:k=>!!k.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:k}){return["span",(0,m.mergeAttributes)(this.options.HTMLAttributes,k),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:k,commands:M})=>{const h=(0,m.getMarkAttributes)(k,this.type);return!!Object.entries(h).some(([,y])=>!!y)||M.unsetMark(this.name)}}}})},97019:(Pt,ct,c)=>{c.d(ct,{h:()=>gt});var m=c(64762),s=c(74788),k=c(36692),M=c(50170),h=c(1414),j=c(10200),y=c(33250),X=c(68874),$=c(23738),rt=c(52219),G=c(12057),ut=c(65009),et=c(10383),st=c(20933),Mt=c(35065),ht=c(63060),_t=c(62733),K=c(48214),H=c(11189),Y=c(91030);function L(ot,xt){if(1&ot&&(s.TgZ(0,"button",6),s._uU(1),s.qZA()),2&ot){const bt=xt.$implicit;s.Q6J("value",bt),s.xp6(1),s.hij(" ",bt," ")}}function dt(ot,xt){if(1&ot&&(s.TgZ(0,"tui-data-list"),s.YNc(1,L,2,2,"button",5),s.qZA()),2&ot){const bt=s.oxw();s.xp6(1),s.Q6J("ngForOf",bt.modes)}}function pt(ot,xt){if(1&ot){const bt=s.EpF();s.TgZ(0,"tui-primitive-textfield",7),s.NdJ("valueChange",function(tt){return s.CHM(bt),s.oxw().onHexChange(tt)}),s._UZ(1,"input",8),s.qZA()}if(2&ot){const bt=s.oxw();s.Q6J("textMask",bt.hexMask)("tuiTextfieldLabelOutside",!0)("value",bt.hex)}}function ft(ot,xt){if(1&ot){const bt=s.EpF();s.TgZ(0,"tui-input-count",9),s.NdJ("ngModelChange",function(tt){s.CHM(bt);const E=s.oxw();return E.onRgbChange(tt,E.color[1],E.color[2],E.color[3])}),s.qZA(),s.TgZ(1,"tui-input-count",9),s.NdJ("ngModelChange",function(tt){s.CHM(bt);const E=s.oxw();return E.onRgbChange(E.color[0],tt,E.color[2],E.color[3])}),s.qZA(),s.TgZ(2,"tui-input-count",9),s.NdJ("ngModelChange",function(tt){s.CHM(bt);const E=s.oxw();return E.onRgbChange(E.color[0],E.color[1],tt,E.color[3])}),s.qZA()}if(2&ot){const bt=s.oxw();s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",bt.color[0]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",bt.color[1]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",bt.color[2])}}class gt{constructor(){this.color=[0,0,0,1],this.colorChange=new s.vpe,this.hexMask={mask:({length:xt})=>Array.from({length:xt},()=>/\d|[a-f]|[A-F]/),guide:!1},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return(0,k.tuiRgbToHex)(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(xt){if(6!==xt.length)return;const bt=(0,k.tuiHexToRgb)(xt);this.updateColor([bt[0],bt[1],bt[2],this.color[3]])}onRgbChange(...xt){this.updateColor(xt)}updateColor(xt){this.color=xt,this.colorChange.emit(xt)}}gt.\u0275fac=function(xt){return new(xt||gt)},gt.\u0275cmp=s.Xpm({type:gt,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:6,vars:8,consts:[["tuiTextfieldSize","m","tuiDropdownAlign","left","tuiDropdownLimitWidth","min",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],[4,"tuiDataList"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["postfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"],["size","xs","tuiOption","",3,"value",4,"ngFor","ngForOf"],["size","xs","tuiOption","",3,"value"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange"],["tuiTextfield","","maxlength","6"],["tuiTextfieldSize","m",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"]],template:function(xt,bt){if(1&xt&&(s.TgZ(0,"tui-select",0),s.NdJ("ngModelChange",function(tt){return bt.mode=tt}),s.YNc(1,dt,2,1,"tui-data-list",1),s.qZA(),s.YNc(2,pt,2,3,"tui-primitive-textfield",2),s.YNc(3,ft,3,12,"ng-template",null,3,s.W1O),s.TgZ(5,"tui-input-count",4),s.NdJ("ngModelChange",function(tt){return bt.onRgbChange(bt.color[0],bt.color[1],bt.color[2],tt/100)}),s.qZA()),2&xt){const Bt=s.MAs(4);s.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",bt.mode),s.xp6(2),s.Q6J("ngIf",bt.isHex)("ngIfElse",Bt),s.xp6(3),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",100)("ngModel",bt.opacity)}},directives:[M.u,h.O,j.s,y.Ek,X.x,$.JJ,$.On,rt.g,G.O5,ut.E,et.a,st.q,G.sg,Mt.v,ht.y,_t.B,K.n,H.h,Y.M],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:4.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}"],changeDetection:0}),(0,m.gn)([(0,k.tuiDefaultProp)()],gt.prototype,"color",void 0)},49289:(Pt,ct,c)=>{c.d(ct,{$:()=>y});var m=c(64762),s=c(74788),k=c(91211),M=c(36692),h=c(71424),j=c(65720);class y{constructor($){this.sanitizer=$,this.colorChange=new s.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color($){if(this.currentColor.every((et,st)=>et===$[st])&&$[3]===this.opacity)return;const[rt,G,ut]=(0,M.tuiRgbToHsv)($[0],$[1],$[2]);this.opacity=$[3],this.hue=rt/360,this.point=[G,1-ut/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${(0,M.tuiHsvToRgb)(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange($){this.point=$,this.updateColor()}onHueChange($){this.hue=$,this.updateColor()}onOpacityChange($){this.opacity=(0,M.tuiRound)($,2),this.updateColor()}getCurrentColor($,rt){return(0,M.tuiHsvToRgb)(360*$,rt[0],255*(1-rt[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}y.\u0275fac=function($){return new($||y)(s.Y36(k.H7))},y.\u0275cmp=s.Xpm({type:y,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function($,rt){1&$&&(s.TgZ(0,"tui-flat-picker",0),s.NdJ("valueChange",function(ut){return rt.onPointChange(ut)}),s.qZA(),s.TgZ(1,"div",1),s.TgZ(2,"tui-linear-picker",2),s.NdJ("valueChange",function(ut){return rt.onHueChange(ut)}),s.qZA(),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"tui-linear-picker",4),s.NdJ("valueChange",function(ut){return rt.onOpacityChange(ut)}),s.qZA(),s.qZA()),2&$&&(s.Udp("background-color",rt.base),s.Q6J("value",rt.point),s.xp6(2),s.Q6J("value",rt.hue),s.xp6(1),s.Udp("background",rt.gradient),s.xp6(1),s.Q6J("value",rt.opacity))},directives:[h.J,j.P],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(rgba(0,0,0,0),#000000),linear-gradient(to right,#ffffff,rgba(255,255,255,0));margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:#ff0000}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],y.prototype,"color",null),(0,m.gn)([M.tuiPure],y.prototype,"getCurrentColor",null)},23999:(Pt,ct,c)=>{c.d(ct,{s:()=>at});var m=c(64762),s=c(74788),k=c(91211),M=c(62842),h=c(37631),j=c(36692),y=c(62939),X=c(76189),$=c(12057),rt=c(49289),G=c(34880),ut=c(20933),et=c(35065),st=c(49472),Mt=c(67446),ht=c(29070),_t=c(54255),K=c(15491),H=c(219),Y=c(97019),L=c(39607),dt=c(5451);function pt(I,J){if(1&I&&s._UZ(0,"tui-svg",9),2&I){s.oxw();const Q=s.MAs(1);s.ekj("t-arrow_rotated",Q.open)}}function ft(I,J){1&I&&s._UZ(0,"tui-svg",14)}function gt(I,J){if(1&I){const Q=s.EpF();s.TgZ(0,"button",12),s.NdJ("keydown.enter.prevent",function(){const It=s.CHM(Q).$implicit,Zt=s.oxw(2),zt=s.MAs(1);return Zt.onModeSelect(It,zt)})("keydown.space.prevent",function(){const It=s.CHM(Q).$implicit,Zt=s.oxw(2),zt=s.MAs(1);return Zt.onModeSelect(It,zt)})("click",function(){const It=s.CHM(Q).$implicit,Zt=s.oxw(2),zt=s.MAs(1);return Zt.onModeSelect(It,zt)}),s._uU(1),s.YNc(2,ft,1,0,"tui-svg",13),s.qZA()}if(2&I){const Q=J.$implicit,Et=s.oxw(2);s.uIk("aria-checked",Et.isModeActive(Q)),s.xp6(1),s.hij(" ",Q," "),s.xp6(1),s.Q6J("ngIf",Et.isModeActive(Q))}}function ot(I,J){if(1&I&&(s.TgZ(0,"tui-data-list",10),s.YNc(1,gt,3,3,"button",11),s.qZA()),2&I){const Q=s.oxw();s.xp6(1),s.Q6J("ngForOf",Q.modes)}}function xt(I,J){if(1&I){const Q=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const It=s.CHM(Q).$implicit;return s.oxw(2).onDirectionChange(It)}),s.qZA()}if(2&I){const Q=J.$implicit,Et=s.oxw(2);s.ekj("t-direction_active",Et.isDirectionActive(Q)),s.Q6J("icon",Et.getIcon(Q))("tuiHint",Q)("tuiHintDescribe","")}}function bt(I,J){if(1&I){const Q=s.EpF();s.ynx(0),s._UZ(1,"hr",15),s.TgZ(2,"div",16),s.TgZ(3,"tui-linear-multi-picker",17),s.NdJ("valueChange",function(At){return s.CHM(Q),s.oxw().onStopsChange(At)})("indexChange",function(At){return s.CHM(Q),s.oxw().onIndexChange(At)}),s.qZA(),s.qZA(),s.TgZ(4,"div",18),s.YNc(5,xt,1,5,"button",19),s.qZA(),s.BQk()}if(2&I){const Q=s.oxw();s.xp6(2),s.Udp("background",Q.gradient),s.xp6(1),s.Q6J("value",Q.stopsKeys),s.xp6(2),s.Q6J("ngForOf",Q.buttons)}}function Bt(I,J){if(1&I){const Q=s.EpF();s.TgZ(0,"tui-color-edit",21),s.NdJ("colorChange",function(At){return s.CHM(Q),s.oxw().onColorChange(At)}),s.qZA()}if(2&I){const Q=s.oxw();s.Q6J("color",Q.color)}}function tt(I,J){if(1&I){const Q=s.EpF();s.TgZ(0,"tui-palette",22),s.NdJ("selectedColor",function(At){return s.CHM(Q),s.oxw().onPalettePick(At)}),s.qZA()}if(2&I){const Q=s.oxw();s.Q6J("colors",Q.palette)}}const E=[0,0,0,0],z=[[0,[0,0,0,1]],[1,[255,255,255,1]]],Z={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};class at{constructor(J,Q){this.sanitizer=J,this.modes=Q,this.stops=new Map(z),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new s.vpe,this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(J){this.parse(J)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(J){return Z[J]}isModeActive(J){return this.currentMode===J}isDirectionActive(J){return this.direction===J}onPalettePick(J){this.updateColor(J)}onDirectionChange(J){this.direction=J,this.updateColor(this.getGradient(J))}onModeSelect(J,Q){this.currentMode=J,Q.open=!1,this.updateColor(J===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(J){this.currentStop=this.stopsKeys[J]}onColorChange(J){this.isGradient?(this.stops.set(this.currentStop,J),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${J.join(", ")})`)}onStopsChange(J){const Q=this.stopsKeys.find(At=>!J.includes(At)),Et=J.find(At=>!this.stopsKeys.includes(At));void 0===Q&&void 0!==Et&&this.addStop(Et),void 0!==Q&&void 0===Et&&this.removeStop(Q),void 0!==Q&&void 0!==Et&&this.replaceStop(Q,Et),this.updateColor(this.getGradient(this.direction))}getStopsKeys(J){return Array.from(J.keys())}filterPalette(J,Q){const Et=new Map(J);return Et.forEach((At,It)=>{(At.startsWith("linear-gradient")&&!Q||!At.startsWith("linear-gradient")&&Q)&&Et.delete(It)}),Et}updateColor(J){this.colorChange.emit(J)}getGradient(J){return`linear-gradient(${J}, ${[...this.stopsKeys].sort().map(Q=>`rgba(${this.getStop(Q).join(", ")}) ${100*Q}%`).join(", ")})`}getStop(J){return this.stops.get(J)||E}addStop(J){const Q=this.stopsKeys.reduce((Et,At)=>Math.abs(At-J)<Math.abs(Et-J)?At:Et,this.stopsKeys[0]);this.stops.set(J,this.getStop(Q)),this.stops=new Map(this.stops),this.currentStop=J}removeStop(J){this.stops.delete(J),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(J,Q){const Et=this.getStop(J);this.currentStop=Q,this.stops=new Map(this.stopsKeys.map(At=>At===J?[Q,Et]:[At,this.getStop(At)]))}parse(J){J.startsWith("linear-gradient")?this.parseGradient(J):this.parseColor(J)}parseGradient(J){if(J===this.getGradient(this.direction))return;const Q=(0,h._N)((0,h.U5)(J));this.currentMode=this.modes[1],this.direction=Q.side,this.currentStop=0,this.stops=new Map(Q.stops.length?Q.stops.map(({color:Et,position:At})=>[parseFloat(At)/100,(0,j.tuiParseColor)(Et)]):z)}parseColor(J){this.currentMode=this.modes[0],this.currentStop=0,this.color=(0,j.tuiParseColor)(J)}}at.\u0275fac=function(J){return new(J||at)(s.Y36(k.H7),s.Y36(M.dj))},at.\u0275cmp=s.Xpm({type:at,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["tuiButton","","appearance","","size","s","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],["src","tuiIconChevronDown",1,"t-arrow"],["role","menu",1,"t-menu"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click",4,"ngFor","ngForOf"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click"],["src","tuiIconCheck","class","t-checkmark",4,"ngIf"],["src","tuiIconCheck",1,"t-checkmark"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","valueChange","indexChange"],[1,"t-buttons"],["tuiIconButton","","type","button","size","xs","appearance","","class","t-direction",3,"t-direction_active","icon","tuiHint","tuiHintDescribe","click",4,"ngFor","ngForOf"],["tuiIconButton","","type","button","size","xs","appearance","",1,"t-direction",3,"icon","tuiHint","tuiHintDescribe","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(J,Q){if(1&J&&(s.TgZ(0,"tui-hosted-dropdown",0,1),s.TgZ(2,"button",2),s._uU(3),s.qZA(),s.YNc(4,pt,1,2,"ng-template",null,3,s.W1O),s.YNc(6,ot,2,1,"ng-template",null,4,s.W1O),s.qZA(),s.YNc(8,bt,6,4,"ng-container",5),s.TgZ(9,"tui-color-picker",6),s.NdJ("colorChange",function(At){return Q.onColorChange(At)}),s.qZA(),s.YNc(10,Bt,1,1,"tui-color-edit",7),s.YNc(11,tt,1,1,"tui-palette",8)),2&J){const Et=s.MAs(5),At=s.MAs(7);s.Q6J("content",At),s.xp6(2),s.Q6J("iconRight",Et),s.xp6(1),s.hij(" ",Q.currentMode," "),s.xp6(5),s.Q6J("ngIf",Q.isGradient),s.xp6(1),s.Q6J("color",Q.currentColor),s.xp6(1),s.Q6J("ngIf",!Q.isGradient),s.xp6(1),s.Q6J("ngIf",Q.palette.size)}},directives:[y.o,X.v,$.O5,rt.$,G.P,ut.q,$.sg,et.v,st.e,Mt.D,ht.x,_t.t,K.D,H.$,Y.h,L.g,dt.R],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:21.25rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,m.gn)([(0,j.tuiDefaultProp)()],at.prototype,"colors",void 0),(0,m.gn)([(0,j.tuiRequiredSetter)()],at.prototype,"colorSetter",null),(0,m.gn)([j.tuiPure],at.prototype,"getStopsKeys",null),(0,m.gn)([j.tuiPure],at.prototype,"filterPalette",null)},71424:(Pt,ct,c)=>{c.d(ct,{J:()=>h});var m=c(64762),s=c(74788),k=c(62141),M=c(36692);class h{constructor(y){this.value=[0,0],this.valueChange=new s.vpe,y.subscribe(X=>{this.value=X,this.valueChange.emit([X[0],X[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}h.\u0275fac=function(y){return new(y||h)(s.Y36(k.i))},h.\u0275cmp=s.Xpm({type:h,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([M.TuiDestroyService,k.i])],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(y,X){1&y&&s._UZ(0,"div",0),2&y&&s.Udp("left",X.left,"%")("top",X.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],h.prototype,"value",void 0)},27050:(Pt,ct,c)=>{c.d(ct,{hR:()=>m.h,TD:()=>y,$v:()=>X.$,H9:()=>G,sV:()=>ut.s,wl:()=>ht,Jd:()=>_t.J,ui:()=>$,es:()=>K.e,GU:()=>st,P:()=>H.P,g7:()=>rt,Rh:()=>Y.R,VM:()=>Mt});var m=c(97019),s=c(12057),k=c(23738),M=c(90987),h=c(31748),j=c(74788);let y=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez,k.u5,h.TextMaskModule,h.TuiValueAccessorModule,h.TuiSelectModule,M.TuiPrimitiveTextfieldModule,M.TuiTextfieldControllerModule,M.TuiDropdownModule,h.TuiInputCountModule,M.TuiDataListModule]]}),L})();var X=c(49289);let $=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez]]}),L})(),rt=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez]]}),L})(),G=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez,$,rt]]}),L})();var ut=c(23999),et=c(36692);let st=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez]]}),L})(),Mt=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez,M.TuiHintModule]]}),L})(),ht=(()=>{class L{}return L.\u0275fac=function(pt){return new(pt||L)},L.\u0275mod=j.oAB({type:L}),L.\u0275inj=j.cJS({imports:[[s.ez,M.TuiButtonModule,M.TuiHostedDropdownModule,G,st,M.TuiHintModule,M.TuiSvgModule,M.TuiDataListModule,et.TuiActiveZoneModule,y,M.TuiGroupModule,Mt]]}),L})();var _t=c(71424),K=c(49472),H=c(65720),Y=c(5451)},49472:(Pt,ct,c)=>{c.d(ct,{e:()=>y});var m=c(64762),s=c(74788),k=c(62141),M=c(36692),h=c(12057);function j(X,$){if(1&X){const rt=s.EpF();s.TgZ(0,"div",1),s.NdJ("mousedown",function(){const et=s.CHM(rt).index;return s.oxw().onMouseDown(et)})("dblclick",function(){const et=s.CHM(rt).index;return s.oxw().onClick(et)}),s.qZA()}2&X&&s.Udp("left",100*$.$implicit,"%")}class y{constructor($){this.value=[0,1],this.valueChange=new s.vpe,this.indexChange=new s.vpe,this.index=NaN,$.subscribe(([rt])=>{this.onPicker(rt)})}onMouseUp(){this.index=NaN}onMouseDown($){this.updateIndex($)}onClick($){this.value.length>2&&this.updateValue(this.value.filter((rt,G)=>G!==$))}onPicker($){isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((rt,G)=>rt===$&&G!==this.index)&&this.updateValue(this.value.map((rt,G)=>G===this.index?$:rt))}updateIndex($){this.index=$,this.indexChange.emit($)}updateValue($){this.value=$,this.valueChange.emit($)}}y.\u0275fac=function($){return new($||y)(s.Y36(k.i))},y.\u0275cmp=s.Xpm({type:y,selectors:[["tui-linear-multi-picker"]],hostBindings:function($,rt){1&$&&s.NdJ("mouseup",function(){return rt.onMouseUp()},!1,s.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},features:[s._Bn([M.TuiDestroyService,k.i])],decls:1,vars:1,consts:[["class","t-circle",3,"left","mousedown","dblclick",4,"ngFor","ngForOf"],[1,"t-circle",3,"mousedown","dblclick"]],template:function($,rt){1&$&&s.YNc(0,j,1,2,"div",0),2&$&&s.Q6J("ngForOf",rt.value)},directives:[h.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],y.prototype,"value",void 0)},65720:(Pt,ct,c)=>{c.d(ct,{P:()=>h});var m=c(64762),s=c(74788),k=c(62141),M=c(36692);class h{constructor(y){this.value=0,this.valueChange=new s.vpe,y.subscribe(([X])=>{this.value=X,this.valueChange.emit(X)})}get left(){return 100*this.value}}h.\u0275fac=function(y){return new(y||h)(s.Y36(k.i))},h.\u0275cmp=s.Xpm({type:h,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([M.TuiDestroyService,k.i])],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(y,X){1&y&&s._UZ(0,"div",0),2&y&&s.Udp("left",X.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],h.prototype,"value",void 0)},5451:(Pt,ct,c)=>{c.d(ct,{R:()=>G});var m=c(64762),s=c(74788),k=c(36692),M=c(12057),h=c(67446),j=c(29070),y=c(54255),X=c(15491),$=c(219);function rt(ut,et){if(1&ut){const st=s.EpF();s.TgZ(0,"button",1),s.NdJ("click",function(){const _t=s.CHM(st).$implicit;return s.oxw().selectedColor.emit(_t.value)}),s.qZA()}if(2&ut){const st=et.$implicit;s.Udp("background",st.value),s.Q6J("tuiHint",st.key)("tuiHintDescribe",st.key)("id",st.key)}}class G{constructor(){this.colors=new Map,this.selectedColor=new s.vpe}}G.\u0275fac=function(et){return new(et||G)},G.\u0275cmp=s.Xpm({type:G,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:3,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintDescribe","id","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintDescribe","id","click"]],template:function(et,st){1&et&&(s.YNc(0,rt,1,5,"button",0),s.ALo(1,"keyvalue")),2&et&&s.Q6J("ngForOf",s.lcZ(1,1,st.colors))},directives:[M.sg,h.D,j.x,y.t,X.D,$.$],pipes:[M.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),(0,m.gn)([(0,k.tuiDefaultProp)()],G.prototype,"colors",void 0)},45050:(Pt,ct,c)=>{c.d(ct,{l:()=>Mt});var m=c(12057),s=c(74788),k=c(36692),M=c(87623),h=c(20986),j=c(23738),y=c(34880),X=c(76189),$=c(66596);function rt(ht,_t){if(1&ht){const K=s.EpF();s.ynx(0),s.TgZ(1,"label",2),s._uU(2," URL "),s.TgZ(3,"span",3),s._uU(4),s.TgZ(5,"tui-input-inline",4),s.NdJ("ngModelChange",function(Y){return s.CHM(K),s.oxw().onChange(Y)})("keydown.prevent.enter",function(){return s.CHM(K),s.oxw().onSave()})("keydown.backspace",function(){return s.CHM(K),s.oxw().onBackspace()}),s._uU(6," example.com "),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"tui-svg",5),s.NdJ("click",function(){return s.CHM(K),s.oxw().onClear()}),s.qZA(),s.TgZ(8,"button",6),s.NdJ("click",function(){return s.CHM(K),s.oxw().onSave()}),s.qZA(),s.BQk()}if(2&ht){const K=s.oxw();s.xp6(4),s.hij(" ",K.prefix," "),s.xp6(1),s.ekj("t-input_filled",K.hasUrl),s.Q6J("ngModel",K.url),s.xp6(2),s.ekj("t-cleaner_hidden",!K.hasUrl)}}function G(ht,_t){if(1&ht){const K=s.EpF();s.TgZ(0,"a",7),s._uU(1),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(K),s.oxw().onEdit()}),s.qZA(),s.TgZ(3,"button",9),s.NdJ("click",function(){return s.CHM(K),s.oxw().onRemove()}),s.qZA()}if(2&ht){const K=s.oxw();s.Q6J("href",K.href,s.LSH),s.xp6(1),s.hij(" ",K.shortUrl," ")}}let Mt=(()=>{class ht{constructor(K){this.documentRef=K,this.addLink=new s.vpe,this.removeLink=new s.vpe,this.url=this.makeUrl(),this.edit=!this.url,this.prefix="http://"}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get shortUrl(){return this.url.length<60?this.url:`${this.url.slice(0,Math.max(0,40))}...${this.url.slice(this.url.length-10)}`}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.makeUrl())}onMouseDown(K){(0,k.tuiIsElement)(K.target)&&!K.target.matches("a, button, input")&&K.preventDefault()}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix="http://")}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange(K){this.url=this.removePrefix(K)}onClear(){this.url=""}makeUrl(){const K=this.documentRef.getSelection();return K?this.getHref(K):""}getHref({focusNode:K}){if(!(null==K?void 0:K.parentElement))return"";const H=K.parentElement.closest("a");return H?this.removePrefix(H.getAttribute("href")||""):this.url}removePrefix(K){return K.startsWith("http://")?(this.prefix="http://",K.replace("http://","")):K.startsWith("https://")?(this.prefix="https://",K.replace("https://","")):K}}return ht.\u0275fac=function(K){return new(K||ht)(s.Y36(m.K0))},ht.\u0275cmp=s.Xpm({type:ht,selectors:[["tui-edit-link"]],hostBindings:function(K,H){1&K&&s.NdJ("selectionchange",function(){return H.onSelectionChange()},!1,s.evT)("mousedown",function(L){return H.onMouseDown(L)})},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["view",""],[1,"t-label"],[1,"t-url"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","keydown.prevent.enter","keydown.backspace"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiLink","","target","_blank",1,"t-link",3,"href"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEditLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconTrashLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"]],template:function(K,H){if(1&K&&(s.YNc(0,rt,9,6,"ng-container",0),s.YNc(1,G,4,2,"ng-template",null,1,s.W1O)),2&K){const Y=s.MAs(2);s.Q6J("ngIf",H.edit)("ngIfElse",Y)}},directives:[m.O5,M.l,h.k,j.JJ,j.On,y.P,X.v,$.V],styles:["[_nghost-%COMP%]{display:flex;height:var(--tui-height-l);align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02)}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),ht})()},71115:(Pt,ct,c)=>{c.d(ct,{l:()=>m.l,F:()=>X});var m=c(45050),s=c(12057),k=c(23738),M=c(36692),h=c(90987),j=c(31748),y=c(74788);let X=(()=>{class ${}return $.\u0275fac=function(G){return new(G||$)},$.\u0275mod=y.oAB({type:$}),$.\u0275inj=y.cJS({imports:[[s.ez,k.u5,M.TuiAutoFocusModule,h.TuiButtonModule,h.TuiSvgModule,h.TuiLinkModule,j.TuiInputInlineModule]]}),$})()},20179:(Pt,ct,c)=>{c.d(ct,{D:()=>k});var m=c(74788),s=c(90987);let k=(()=>{class M{constructor(j,y,X,$){this.elementRef=j,this.renderer=y,this.sanitizer=X,this.tuiSanitizer=$}set content(j){this.renderer.setProperty(this.elementRef.nativeElement,"innerHTML",this.tuiSanitizer?this.tuiSanitizer.sanitize(m.q3G.HTML,j.replace(/colwidth/g,"width")):this.sanitizer.sanitize(m.q3G.HTML,j))}}return M.\u0275fac=function(j){return new(j||M)(m.Y36(m.SBq),m.Y36(m.Qsj),m.Y36(m.Tiy),m.Y36(s.TUI_SANITIZER,8))},M.\u0275cmp=m.Xpm({type:M,selectors:[["tui-editor-socket"]],hostAttrs:[1,"tui-editor-socket"],inputs:{content:"content"},decls:0,vars:0,template:function(j,y){},styles:['.tui-editor-socket{display:block;margin:0;overflow:hidden;color:var(--tui-text-01);font:var(--tui-font-text-m)}.tui-editor-socket._preview-image img{cursor:pointer}.tui-editor-socket h1,.tui-editor-socket h2,.tui-editor-socket h3,.tui-editor-socket h4,.tui-editor-socket h5,.tui-editor-socket h6{word-break:break-word;line-height:normal}.tui-editor-socket .ProseMirror{min-height:5.375rem;padding:0 1rem;outline:none;white-space:pre-wrap}.tui-editor-socket p:empty:after{content:" ";white-space:pre}.tui-editor-socket p:first-child{margin-top:0}.tui-editor-socket ul,.tui-editor-socket ol{list-style-type:none;margin:1rem 1rem 1rem 1.5rem;padding:0}.tui-editor-socket li{margin:1rem 0}.tui-editor-socket li p{display:inline-block;margin:0 auto}.tui-editor-socket ul>li:before{content:"";display:inline-block;width:.5rem;height:.5rem;border-radius:100%;margin:.5rem .875rem .0625rem -1.375rem;background-color:var(--tui-primary);vertical-align:top;box-sizing:border-box}.tui-editor-socket li ul>li:before{background:none;border:.125rem solid var(--tui-primary)}.tui-editor-socket li ul>li>ul>li:before{background:var(--tui-primary);border-radius:0;width:.375rem;height:.375rem}.tui-editor-socket ol{counter-reset:counter}.tui-editor-socket ol>li:before{content:counter(counter) ".";width:1.5rem;margin:0 .75rem 0 -1.5rem;counter-increment:counter;color:var(--tui-base-05);vertical-align:top}.tui-editor-socket pre{white-space:pre-wrap;word-break:break-word;border-radius:.25rem;margin:1rem 0;padding:.75rem 1rem;font-family:Courier,monospace;color:var(--tui-text-02);background:var(--tui-base-02)}.tui-editor-socket code{box-shadow:none}.tui-editor-socket pre+pre{margin-top:-1.8125rem;padding-top:0}.tui-editor-socket blockquote{margin:1.25rem 0 1.25rem 1.5rem;padding-left:1.0625rem;border-left:1px solid var(--tui-base-04)}.tui-editor-socket p{margin:1rem 0}.tui-editor-socket a{color:var(--tui-link);text-decoration:none;outline:none}.tui-editor-socket a:hover{color:var(--tui-link-hover);text-decoration:underline}.tui-editor-socket a:active{color:var(--tui-primary-active)}.tui-editor-socket hr{border:none;border-top:1px solid var(--tui-base-03);margin:1rem 0}.tui-editor-socket table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.tui-editor-socket table td{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word}.tui-editor-socket table th{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word;font-weight:bold;text-align:left;background-color:var(--tui-base-02);min-height:2rem}.tui-editor-socket table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tui-editor-socket table td>*{margin-top:0;margin-bottom:0}.tui-editor-socket table th>*{margin-top:0;margin-bottom:0}.tui-editor-socket .resize-cursor{cursor:ew-resize;cursor:col-resize}.tui-editor-socket table .tableWrapper{overflow-x:auto}.tui-editor-socket .selectedCell:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--tui-selection);pointer-events:none}.tui-editor-socket font[face="Courier New"]{display:inline-block;padding:.25rem .5rem;border-radius:.25rem;background-color:#ecf1f7;word-break:break-word}.tui-editor-socket details{width:100%;border:1px solid var(--tui-base-04);border-radius:var(--tui-radius-l)}.tui-editor-socket summary{display:flex;align-items:center;min-height:3.5rem;width:100%;padding:0 1.25rem;box-sizing:border-box;border-radius:var(--tui-radius-l);pointer-events:none}.tui-editor-socket summary p{min-width:1px;margin:0}.tui-editor-socket summary::-webkit-details-marker{display:none}.tui-editor-socket details[open] summary{border-radius:var(--tui-radius-l) var(--tui-radius-l) 0 0}.tui-editor-socket div[data-type=details-content]{padding:1.25rem;min-height:3rem;border:1px solid var(--tui-base-04);border-width:1px 0 0}.tui-editor-socket .details-wrapper{position:relative;display:flex}.tui-editor-socket .details-arrow{position:absolute;top:1.5rem;right:1.25rem;height:.575rem;width:.575rem;border:1px solid var(--tui-base-06);border-width:0 2px 2px 0;transform:rotate(45deg);transition:.3s;transition:var(--tui-duration, .3s);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;padding:0;background:none;cursor:pointer}.tui-editor-socket .details-wrapper_rendered .details-arrow{pointer-events:none}.tui-editor-socket .details-wrapper_rendered summary{transition:transform .3s;transition:transform var(--tui-duration, .3s);cursor:pointer;pointer-events:auto}.tui-editor-socket .details-wrapper_rendered summary:hover{background:var(--tui-base-02)}.tui-editor-socket details[open]+.details-arrow{top:1.75rem;transform:rotate(225deg)}.t-editor-placeholder:before{content:attr(data-placeholder);float:left;color:var(--tui-base-05);pointer-events:none;height:0}.tui-group-node{display:flex;flex-direction:row}.tui-group-node:hover>.tui-group-pointer{pointer-events:auto;opacity:1}.tui-group-pointer{opacity:0;min-height:.8125rem;max-height:.8125rem;min-width:.8125rem;max-width:.8125rem;margin:.3125rem .3125rem 0 0;cursor:-webkit-grab;cursor:grab;background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="black" /></svg>\');background-repeat:no-repeat;background-size:contain;background-position:center}[data-mode=onDark] .tui-group-pointer{background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="white" /></svg>\')}\n'],encapsulation:2,changeDetection:0}),M})()},69303:(Pt,ct,c)=>{c.d(ct,{a:()=>at});var m=c(64762),s=c(12057),k=c(74788),M=c(23738),h=c(17406),j=c(19074),y=c(40632),X=c(62842),$=c(37631),rt=c(36692),G=c(79089),ut=c(40939),et=c(2697),st=c(17163),Mt=c(3881),ht=c(1433),_t=c(9872),K=c(4997),H=c(33250),Y=c(26072),L=c(9829),dt=c(82886),pt=c(39088),ft=c(20179),gt=c(74982),ot=c(45050);function xt(I,J){if(1&I&&(k.TgZ(0,"tui-toolbar",9),k.Hsn(1,1),k.qZA()),2&I){const Q=k.oxw(2);k.Q6J("tools",Q.tools)("disabled",!Q.interactive)}}function bt(I,J){if(1&I&&(k.TgZ(0,"div",10),k._uU(1),k.qZA()),2&I){const Q=k.oxw(2);k.xp6(1),k.hij(" ",Q.exampleText," ")}}function Bt(I,J){if(1&I){const Q=k.EpF();k.TgZ(0,"div",11),k.TgZ(1,"tui-editor-socket",12),k.NdJ("valueChange",function(At){return k.CHM(Q),k.oxw(2).onModelChange(At)})("stateChange",function(){return 0}),k.qZA(),k.qZA()}if(2&I){k.oxw();const Q=k.MAs(9),Et=k.oxw();k.Q6J("tuiDropdownSelection",Et.dropdownSelectionHandler)("tuiDropdown",Q),k.xp6(1),k.Q6J("value",Et.value)("editable",Et.interactive)}}function tt(I,J){if(1&I){const Q=k.EpF();k.TgZ(0,"tui-edit-link",13),k.NdJ("addLink",function(At){return k.CHM(Q),k.oxw(2).addLink(At)})("removeLink",function(){return k.CHM(Q),k.oxw(2).removeLink()}),k.qZA()}}function E(I,J){if(1&I){const Q=k.EpF();k.TgZ(0,"div",1),k.NdJ("tuiActiveZoneChange",function(At){return k.CHM(Q),k.oxw().onActiveZone(At)}),k.TgZ(1,"div",2),k.YNc(2,xt,2,2,"tui-toolbar",3),k.TgZ(3,"div",4),k.Hsn(4),k.qZA(),k.YNc(5,bt,2,1,"div",5),k.qZA(),k.TgZ(6,"tui-scrollbar",6),k.YNc(7,Bt,2,4,"div",7),k.YNc(8,tt,1,0,"ng-template",null,8,k.W1O),k._UZ(10,"tui-editor-portal-host"),k.qZA(),k.qZA()}if(2&I){const Q=J.tuiLet,Et=k.oxw();k.Q6J("readOnly",Et.readOnly)("disabled",Et.disabled)("focus",Et.computedFocused)("hover",Et.pseudoHover)("invalid",Et.computedInvalid),k.xp6(2),k.Q6J("ngIf",Q),k.xp6(1),k.ekj("t-placeholder_raised",Et.placeholderRaised),k.xp6(2),k.Q6J("ngIf",Et.hasExampleText),k.xp6(2),k.Q6J("ngIf",Q)}}const z=["*",[["tools"]]];class at extends rt.AbstractTuiControl{constructor(J,Q,Et,At,It,Zt){super(J,Q),this.editorLoaded$=Et,this.editorService=At,this.contentProcessor=It,this.documentRef=Zt,this.exampleText="",this.tools=j.Db,this.focused=!1,this.isSelectionLink=zt=>this.currentFocusedNodeIsAnchor(zt)&&(0,$.nC)(zt)}get nativeFocusableElement(){var J;return this.computedDisabled?null:(null===(J=this.element)||void 0===J?void 0:J.nativeElement)||null}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:rt.ALWAYS_FALSE_HANDLER}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}writeValue(J){var Q;const Et=this.contentProcessor(J||"");super.writeValue(Et),Et!==J&&(null===(Q=this.control)||void 0===Q||Q.setValue(Et))}onActiveZone(J){this.focused=J,this.updateFocused(J)}onModelChange(J){this.updateValue(J)}addLink(J){var Q,Et;null===(Q=this.editor)||void 0===Q||Q.selectClosest(),null===(Et=this.editor)||void 0===Et||Et.setLink(J)}removeLink(){var J;null===(J=this.editor)||void 0===J||J.unsetLink()}ngOnDestroy(){var J;null===(J=this.editor)||void 0===J||J.destroy()}getFallbackValue(){return""}currentFocusedNodeIsAnchor(J){var Q,Et,At;return!!(null===(Et=null===(Q=J.startContainer.parentElement)||void 0===Q?void 0:Q.closest("a"))||void 0===Et?void 0:Et.contains((null===(At=this.documentRef.getSelection())||void 0===At?void 0:At.focusNode)||null))}get hasValue(){return!!this.value}}at.\u0275fac=function(J){return new(J||at)(k.Y36(M.a5,10),k.Y36(k.sBO),k.Y36(X.ZW),k.Y36(y.$3),k.Y36(X.F1),k.Y36(s.K0))},at.\u0275cmp=k.Xpm({type:at,selectors:[["tui-editor"]],viewQuery:function(J,Q){if(1&J&&(k.Gf(y.JU,5,k.SBq),k.Gf(h.M6,5)),2&J){let Et;k.iGM(Et=k.CRH())&&(Q.element=Et.first),k.iGM(Et=k.CRH())&&(Q.toolbar=Et.first)}},inputs:{exampleText:"exampleText",tools:"tools"},features:[k._Bn([(0,rt.tuiAsFocusableItemAccessor)(at),G.m]),k.qOj],ngContentSelectors:["*","tools"],decls:2,vars:3,consts:[["tuiWrapper","","appearance","textfield","class","t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange",4,"tuiLet"],["tuiWrapper","","appearance","textfield",1,"t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],[3,"tools","disabled",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","",1,"t-scrollbar"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown",4,"ngIf"],["dropdown",""],[3,"tools","disabled"],[1,"t-example-text"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown"],["tuiTiptapEditor","","spellcheck","false",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange"],[3,"addLink","removeLink"]],template:function(J,Q){1&J&&(k.F$t(z),k.YNc(0,E,11,10,"div",0),k.ALo(1,"async")),2&J&&k.Q6J("tuiLet",k.lcZ(1,1,Q.editorLoaded$))},directives:[ut.L,et.o,st.e,s.O5,Mt.I,ht.A,_t.d,K.M,H.Ek,Y.t,L.V,dt.A,pt.y,ft.D,gt.J,ot.l],pipes:[s.Ov],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m);border-radius:var(--tui-radius-m)}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:10rem;cursor:text;overflow:hidden;flex-direction:column;border-radius:inherit}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);position:absolute;left:1rem;margin-top:1rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem)}[data-size=m][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}[data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], [data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size=l][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font-size:.9375rem}[data-size=l][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[data-mode=onDark][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size=m][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens: none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-placeholder_raised[_ngcontent-%COMP%]{width:110%}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;max-height:inherit;border-top:1.625rem solid transparent;border-bottom:1px solid transparent;box-sizing:border-box}"],changeDetection:0}),(0,m.gn)([(0,rt.tuiDefaultProp)()],at.prototype,"exampleText",void 0),(0,m.gn)([(0,rt.tuiDefaultProp)()],at.prototype,"tools",void 0)},79089:(Pt,ct,c)=>{c.d(ct,{m:()=>rt});var m=c(74788),s=c(40632),k=c(62842),M=c(82298),h=c(9112),j=c(15257),y=c(88002),X=c(47349),$=c(73825);const rt=[{provide:k.F4,deps:[k.Wf],useFactory:G=>{const ut=new M.t(1);return Promise.all(G).then(et=>ut.next(et)),ut}},{provide:k.Y1,deps:[m.Qsj],useFactory:G=>G.createElement("div")},{provide:k.ZW,deps:[k.Y1,k.F4,k.bG],useFactory:(G,ut,et)=>(0,h.aj)([et,ut]).pipe((0,j.q)(1),(0,y.U)(([st,Mt])=>new st({element:G,extensions:Mt})),(0,X.d)({bufferSize:1,refCount:!0}))},s.$3,$.Y]},9872:(Pt,ct,c)=>{c.d(ct,{d:()=>k});var m=c(36692),s=c(74788);let k=(()=>{class M extends m.AbstractTuiPortalHostComponent{}return M.\u0275fac=function(){let h;return function(y){return(h||(h=s.n5z(M)))(y||M)}}(),M.\u0275cmp=s.Xpm({type:M,selectors:[["tui-editor-portal-host"]],features:[s._Bn([{provide:m.AbstractTuiPortalService,useExisting:m.TuiDropdownPortalService},{provide:m.AbstractTuiPortalHostComponent,useExisting:M}]),s.qOj],decls:2,vars:0,consts:[["viewContainer",""]],template:function(j,y){1&j&&s.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),M})()},1433:(Pt,ct,c)=>{c.d(ct,{A:()=>M});var m=c(36692),s=c(73825),k=c(74788);let M=(()=>{class h{}return h.\u0275fac=function(y){return new(y||h)},h.\u0275dir=k.lG2({type:h,selectors:[["","tuiEditorPortal",""]],features:[k._Bn([{provide:m.TuiDropdownPortalService,useExisting:s.Y}])]}),h})()},73825:(Pt,ct,c)=>{c.d(ct,{Y:()=>k});var m=c(36692),s=c(74788);let k=(()=>{class M extends m.AbstractTuiPortalService{}return M.\u0275fac=function(){let h;return function(y){return(h||(h=s.n5z(M)))(y||M)}}(),M.\u0275prov=s.Yz7({token:M,factory:M.\u0275fac}),M})()},19769:(Pt,ct,c)=>{c.d(ct,{j:()=>_t});var m=c(64762),s=c(74788),k=c(23738),M=c(91211),h=c(37631),j=c(36692),y=c(90987),X=c(62939),$=c(63060),rt=c(62733),G=c(3729),ut=c(23999),et=c(17163);function st(K,H){if(1&K&&s._UZ(0,"div",4),2&K){const Y=s.oxw();s.Udp("background",Y.background)}}function Mt(K,H){if(1&K){const Y=s.EpF();s.TgZ(0,"tui-color-selector",5),s.NdJ("colorChange",function(dt){return s.CHM(Y),s.oxw().onValueChange(dt)}),s.qZA()}if(2&K){const Y=H.$implicit,L=s.oxw();s.Q6J("tuiActiveZoneParent",Y)("colors",L.colors)("color",L.value)}}class _t extends j.AbstractTuiControl{constructor(H,Y,L){super(H,Y),this.domSanitizer=L,this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onValueChange(H){this.updateValue(H)}onFocused(H){this.updateFocused(H)}getFallbackValue(){return"#000000"}sanitize(H,Y){return H.startsWith("linear-gradient(")?Y.bypassSecurityTrustStyle((0,h.CH)((0,h._N)((0,h.U5)(H)))):H}}_t.\u0275fac=function(H){return new(H||_t)(s.Y36(k.a5,10),s.Y36(s.sBO),s.Y36(M.H7))},_t.\u0275cmp=s.Xpm({type:_t,selectors:[["tui-input-color"]],viewQuery:function(H,Y){if(1&H&&(s.Gf(y.TuiPrimitiveTextfieldComponent,5),s.Gf(y.TuiHostedDropdownComponent,5)),2&H){let L;s.iGM(L=s.CRH())&&(Y.textfield=L.first),s.iGM(L=s.CRH())&&(Y.dropdown=L.first)}},hostBindings:function(H,Y){1&H&&s.NdJ("click",function(){return Y.onClick()})},inputs:{colors:"colors"},features:[s._Bn([],[(0,y.tuiDropdownOptionsProvider)({maxHeight:600})]),s.qOj],ngContentSelectors:["*"],decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"tuiTextfieldIconLeft","pseudoFocus","pseudoHover","pseudoActive","invalid","focusable","nativeId","disabled","readOnly","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"tuiActiveZoneParent","colors","color","colorChange"]],template:function(H,Y){if(1&H&&(s.F$t(),s.TgZ(0,"tui-hosted-dropdown",0),s.NdJ("openChange",function(dt){return Y.open=dt}),s.TgZ(1,"tui-primitive-textfield",1),s.NdJ("valueChange",function(dt){return Y.onValueChange(dt)})("focusedChange",function(dt){return Y.onFocused(dt)}),s.Hsn(2),s.qZA(),s.qZA(),s.YNc(3,st,1,2,"ng-template",null,2,s.W1O),s.YNc(5,Mt,1,3,"ng-template",null,3,s.W1O)),2&H){const L=s.MAs(4),dt=s.MAs(6);s.Q6J("content",dt)("open",Y.open),s.xp6(1),s.Q6J("tuiTextfieldIconLeft",L)("pseudoFocus",Y.computedFocused)("pseudoHover",Y.pseudoHover)("pseudoActive",Y.pseudoActive)("invalid",Y.computedInvalid)("focusable",Y.focusable)("nativeId",Y.nativeId)("disabled",Y.disabled)("readOnly",Y.readOnly)("value",Y.value)}},directives:[X.o,$.y,rt.B,G.aR,ut.s,et.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem}"],changeDetection:0}),(0,m.gn)([(0,j.tuiDefaultProp)()],_t.prototype,"colors",void 0),(0,m.gn)([j.tuiPure],_t.prototype,"sanitize",null)},37924:(Pt,ct,c)=>{c.d(ct,{X:()=>K});var m=c(40632),s=c(62842),k=c(9112),M=c(88002),h=c(74788),j=c(12057),y=c(40939),X=c(62939),$=c(76189),rt=c(67446),G=c(29070),ut=c(54255),et=c(15491),st=c(219);function Mt(H,Y){if(1&H){const L=h.EpF();h.TgZ(0,"div",6),h.TgZ(1,"button",7),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).editor.onAlign("left")}),h.qZA(),h.TgZ(2,"button",8),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).editor.onAlign("center")}),h.qZA(),h.TgZ(3,"button",9),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).editor.onAlign("right")}),h.qZA(),h.TgZ(4,"button",10),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).editor.onAlign("justify")}),h.qZA(),h.qZA()}if(2&H){const L=h.oxw().tuiLet,dt=h.oxw().ngIf;h.xp6(1),h.Q6J("pseudoActive",!(null==L||!L.left))("tuiHint",dt.justifyLeft),h.xp6(1),h.Q6J("pseudoActive",!(null==L||!L.center))("tuiHint",dt.justifyCenter),h.xp6(1),h.Q6J("pseudoActive",!(null==L||!L.right))("tuiHint",dt.justifyRight),h.xp6(1),h.Q6J("pseudoActive",!(null==L||!L.justify))("tuiHint",dt.justifyFull)}}function ht(H,Y){if(1&H&&(h.TgZ(0,"tui-hosted-dropdown",2,3),h._UZ(2,"button",4),h.YNc(3,Mt,5,8,"ng-template",null,5,h.W1O),h.qZA()),2&H){const L=h.MAs(1),dt=h.MAs(4),pt=h.oxw().ngIf;h.Q6J("content",dt),h.xp6(2),h.Q6J("tuiHint",pt.justify)("tuiHintDescribe","")("pseudoActive",L.open)("focusable",L.open)}}function _t(H,Y){if(1&H&&(h.ynx(0),h.YNc(1,ht,5,5,"tui-hosted-dropdown",1),h.ALo(2,"async"),h.BQk()),2&H){const L=h.oxw();h.xp6(1),h.Q6J("tuiLet",h.lcZ(2,1,L.alignState$))}}let K=(()=>{class H{constructor(L,dt){this.editor=L,this.texts$=dt,this.alignState$=(0,k.aj)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,M.U)(([pt,ft,gt,ot])=>({left:pt,right:ft,center:gt,justify:ot})))}}return H.\u0275fac=function(L){return new(L||H)(h.Y36(m.$3),h.Y36(s.rf))},H.\u0275cmp=h.Xpm({type:H,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"]],template:function(L,dt){1&L&&(h.YNc(0,_t,3,3,"ng-container",0),h.ALo(1,"async")),2&L&&h.Q6J("ngIf",h.lcZ(1,1,dt.texts$))},directives:[j.O5,y.L,X.o,$.v,rt.D,G.x,ut.t,et.D,st.$],pipes:[j.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),H})()},15587:(Pt,ct,c)=>{c.d(ct,{T:()=>K});var m=c(40632),s=c(62842),k=c(88002),M=c(87519),h=c(74788),j=c(62939),y=c(76189),X=c(67446),$=c(29070),rt=c(54255),G=c(15491),ut=c(219),et=c(20933),st=c(12057),Mt=c(35065);function ht(H,Y){if(1&H){const L=h.EpF();h.TgZ(0,"button",5),h.NdJ("click",function(){const ft=h.CHM(L).index;return h.oxw(2).onCode(!!ft)}),h._uU(1),h.qZA()}if(2&H){const L=Y.$implicit;h.xp6(1),h.hij(" ",L," ")}}function _t(H,Y){if(1&H&&(h.TgZ(0,"tui-data-list"),h.YNc(1,ht,2,1,"button",4),h.ALo(2,"async"),h.qZA()),2&H){const L=h.oxw();h.xp6(1),h.Q6J("ngForOf",h.lcZ(2,1,L.codeOptionsTexts$))}}let K=(()=>{class H{constructor(L,dt,pt){this.editor=L,this.texts$=dt,this.codeOptionsTexts$=pt,this.hintText$=this.texts$.pipe((0,k.U)(ft=>ft.code)),this.insideCode$=this.editor.stateChange$.pipe((0,k.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,M.x)())}onCode(L){L?this.editor.toggleCodeBlock():this.editor.toggleCode()}}return H.\u0275fac=function(L){return new(L||H)(h.Y36(m.$3),h.Y36(s.rf),h.Y36(s.Mr))},H.\u0275cmp=h.Xpm({type:H,selectors:[["tui-code"]],decls:7,vars:9,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(L,dt){if(1&L&&(h.TgZ(0,"tui-hosted-dropdown",0,1),h._UZ(2,"button",2),h.ALo(3,"async"),h.ALo(4,"async"),h.YNc(5,_t,3,3,"ng-template",null,3,h.W1O),h.qZA()),2&L){const pt=h.MAs(1),ft=h.MAs(6);h.Q6J("content",ft),h.xp6(2),h.Q6J("tuiHint",h.lcZ(3,5,dt.hintText$))("tuiHintDescribe","")("pseudoActive",pt.open||h.lcZ(4,7,dt.insideCode$))("focusable",pt.open)}},directives:[j.o,y.v,X.D,$.x,rt.t,G.D,ut.$,et.q,st.sg,Mt.v],pipes:[st.Ov],encapsulation:2,changeDetection:0}),H})()},18832:(Pt,ct,c)=>{c.d(ct,{U:()=>st});var m=c(40632),s=c(62842),k=c(88002),M=c(87519),h=c(74788),j=c(12057),y=c(76189),X=c(67446),$=c(29070),rt=c(54255),G=c(15491),ut=c(219);function et(Mt,ht){if(1&Mt){const _t=h.EpF();h.TgZ(0,"button",1),h.NdJ("click",function(){return h.CHM(_t),h.oxw().removeDetails()}),h.ALo(1,"async"),h.qZA()}if(2&Mt){const _t=ht.ngIf,K=h.oxw();h.Q6J("tuiHint",_t.removeDetails)("tuiHintDescribe","")("focusable",!1)("disabled",!!h.lcZ(1,4,K.disabled$))}}let st=(()=>{class Mt{constructor(_t,K){this.editor=_t,this.texts$=K,this.disabled$=this.editor.stateChange$.pipe((0,k.U)(()=>!this.editor.isActive("details")),(0,M.x)())}removeDetails(){this.editor.removeDetails()}}return Mt.\u0275fac=function(_t){return new(_t||Mt)(h.Y36(m.$3),h.Y36(s.rf))},Mt.\u0275cmp=h.Xpm({type:Mt,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(_t,K){1&_t&&(h.YNc(0,et,2,6,"button",0),h.ALo(1,"async")),2&_t&&h.Q6J("ngIf",h.lcZ(1,1,K.texts$))},directives:[j.O5,y.v,X.D,$.x,rt.t,G.D,ut.$],pipes:[j.Ov],encapsulation:2,changeDetection:0}),Mt})()},50237:(Pt,ct,c)=>{c.d(ct,{y:()=>ut});var m=c(40632),s=c(62842),k=c(74788),M=c(12057),h=c(76189),j=c(67446),y=c(29070),X=c(54255),$=c(15491),rt=c(219);function G(et,st){if(1&et){const Mt=k.EpF();k.TgZ(0,"button",1),k.NdJ("click",function(){return k.CHM(Mt),k.oxw().setDetails()}),k.qZA()}2&et&&k.Q6J("tuiHint",st.ngIf.setDetails)("tuiHintDescribe","")("focusable",!1)}let ut=(()=>{class et{constructor(Mt,ht){this.editor=Mt,this.texts$=ht}setDetails(){this.editor.setDetails()}}return et.\u0275fac=function(Mt){return new(Mt||et)(k.Y36(m.$3),k.Y36(s.rf))},et.\u0275cmp=k.Xpm({type:et,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click"]],template:function(Mt,ht){1&Mt&&(k.YNc(0,G,1,3,"button",0),k.ALo(1,"async")),2&Mt&&k.Q6J("ngIf",k.lcZ(1,1,ht.texts$))},directives:[M.O5,h.v,j.D,y.x,X.t,$.D,rt.$],pipes:[M.Ov],encapsulation:2,changeDetection:0}),et})()},84985:(Pt,ct,c)=>{c.d(ct,{m:()=>K});var m=c(40632),s=c(62842),k=c(36692),M=c(88002),h=c(74788),j=c(62939),y=c(76189),X=c(67446),$=c(29070),rt=c(54255),G=c(15491),ut=c(219),et=c(20933),st=c(12057),Mt=c(35065);function ht(H,Y){if(1&H){const L=h.EpF();h.TgZ(0,"button",5),h.NdJ("click",function(){const ft=h.CHM(L).$implicit;return h.oxw(2).onClick(ft)}),h.ALo(1,"lowercase"),h._uU(2),h.qZA()}if(2&H){const L=Y.$implicit;h.Udp("font-family",L.family)("font-size",L.px,"px")("font-weight",L.weight),h.uIk("automation-id","tui_font__"+h.lcZ(1,8,L.name||"")),h.xp6(2),h.hij(" ",L.name," ")}}function _t(H,Y){if(1&H&&(h.TgZ(0,"tui-data-list"),h.YNc(1,ht,3,10,"button",4),h.ALo(2,"async"),h.qZA()),2&H){const L=h.oxw();h.xp6(1),h.Q6J("ngForOf",h.lcZ(2,1,L.fontsOptions$))}}let K=(()=>{class H{constructor(L,dt,pt,ft){this.options=L,this.editor=dt,this.texts$=pt,this.fontOptionsTexts$=ft,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,M.U)(gt=>this.options.fontOptions(gt))),this.fontText$=this.texts$.pipe((0,M.U)(gt=>gt.font))}onClick({headingLevel:L,px:dt}){L?this.editor.setHeading(L):this.editor.setParagraph({fontSize:(0,k.tuiPx)(dt||0)})}}return H.\u0275fac=function(L){return new(L||H)(h.Y36(s.mJ),h.Y36(m.$3),h.Y36(s.rf),h.Y36(s.UN))},H.\u0275cmp=h.Xpm({type:H,selectors:[["tui-font-size"]],decls:6,vars:7,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(L,dt){if(1&L&&(h.TgZ(0,"tui-hosted-dropdown",0,1),h._UZ(2,"button",2),h.ALo(3,"async"),h.YNc(4,_t,3,3,"ng-template",null,3,h.W1O),h.qZA()),2&L){const pt=h.MAs(1),ft=h.MAs(5);h.Q6J("content",ft),h.xp6(2),h.Q6J("tuiHint",h.lcZ(3,5,dt.fontText$))("tuiHintDescribe","")("pseudoActive",pt.open)("focusable",pt.open)}},directives:[j.o,y.v,X.D,$.x,rt.t,G.D,ut.$,et.q,st.sg,Mt.v],pipes:[st.Ov,st.i8],encapsulation:2,changeDetection:0}),H})()},62976:(Pt,ct,c)=>{c.d(ct,{h:()=>pt});var m=c(19074),s=c(40632),k=c(48699),M=c(62842),h=c(9112),j=c(88002),y=c(74788),X=c(12057),$=c(62939),rt=c(76189),G=c(67446),ut=c(29070),et=c(54255),st=c(15491),Mt=c(219);function ht(ft,gt){if(1&ft){const ot=y.EpF();y.TgZ(0,"button",11),y.NdJ("click",function(){return y.CHM(ot),y.oxw(4).editor.toggleBold()}),y.qZA()}if(2&ft){const ot=y.oxw(2).ngIf,xt=y.oxw().ngIf;y.Q6J("tuiHint",xt.bold)("pseudoActive",ot.bold)}}function _t(ft,gt){if(1&ft){const ot=y.EpF();y.TgZ(0,"button",12),y.NdJ("click",function(){return y.CHM(ot),y.oxw(4).editor.toggleItalic()}),y.qZA()}if(2&ft){const ot=y.oxw(2).ngIf,xt=y.oxw().ngIf;y.Q6J("tuiHint",xt.italic)("pseudoActive",ot.italic)}}function K(ft,gt){if(1&ft){const ot=y.EpF();y.TgZ(0,"button",13),y.NdJ("click",function(){return y.CHM(ot),y.oxw(4).editor.toggleUnderline()}),y.qZA()}if(2&ft){const ot=y.oxw(2).ngIf,xt=y.oxw().ngIf;y.Q6J("tuiHint",xt.underline)("pseudoActive",ot.underline)}}function H(ft,gt){if(1&ft){const ot=y.EpF();y.TgZ(0,"button",14),y.NdJ("click",function(){return y.CHM(ot),y.oxw(4).editor.toggleStrike()}),y.qZA()}if(2&ft){const ot=y.oxw(2).ngIf,xt=y.oxw().ngIf;y.Q6J("tuiHint",xt.strikeThrough)("pseudoActive",ot.strike)}}function Y(ft,gt){if(1&ft&&(y.TgZ(0,"div",6),y.YNc(1,ht,1,2,"button",7),y.YNc(2,_t,1,2,"button",8),y.YNc(3,K,1,2,"button",9),y.YNc(4,H,1,2,"button",10),y.qZA()),2&ft){const ot=y.oxw(3);y.xp6(1),y.Q6J("ngIf",ot.isEnabled(ot.TuiEditorTool.Bold)),y.xp6(1),y.Q6J("ngIf",ot.isEnabled(ot.TuiEditorTool.Italic)),y.xp6(1),y.Q6J("ngIf",ot.isEnabled(ot.TuiEditorTool.Underline)),y.xp6(1),y.Q6J("ngIf",ot.isEnabled(ot.TuiEditorTool.Strikethrough))}}function L(ft,gt){if(1&ft&&(y.TgZ(0,"tui-hosted-dropdown",2,3),y._UZ(2,"button",4),y.YNc(3,Y,5,4,"ng-template",null,5,y.W1O),y.qZA()),2&ft){const ot=gt.ngIf,xt=y.MAs(1),bt=y.MAs(4),Bt=y.oxw().ngIf;y.Q6J("content",bt),y.xp6(2),y.Q6J("tuiHint",Bt.fontStyle)("tuiHintDescribe","")("pseudoActive",xt.open||ot.bold||ot.italic||ot.underline||ot.strike)("focusable",xt.open)}}function dt(ft,gt){if(1&ft&&(y.ynx(0),y.YNc(1,L,5,5,"tui-hosted-dropdown",1),y.ALo(2,"async"),y.BQk()),2&ft){const ot=y.oxw();y.xp6(1),y.Q6J("ngIf",y.lcZ(2,1,ot.fontStyleState$))}}let pt=(()=>{class ft{constructor(ot,xt){this.editor=ot,this.texts$=xt,this.toolsSet=new Set(m.Db),this.TuiEditorTool=k._,this.fontStyleState$=(0,h.aj)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,j.U)(([bt,Bt,tt,E])=>({bold:bt,italic:Bt,underline:tt,strike:E})))}set enabledTools(ot){this.toolsSet=new Set(ot)}isEnabled(ot){return this.toolsSet.has(ot)}}return ft.\u0275fac=function(ot){return new(ot||ft)(y.Y36(s.$3),y.Y36(M.rf))},ft.\u0275cmp=y.Xpm({type:ft,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"]],template:function(ot,xt){1&ot&&(y.YNc(0,dt,3,3,"ng-container",0),y.ALo(1,"async")),2&ot&&y.Q6J("ngIf",y.lcZ(1,1,xt.texts$))},directives:[X.O5,$.o,rt.v,G.D,ut.x,et.t,st.D,Mt.$],pipes:[X.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),ft})()},19762:(Pt,ct,c)=>{c.d(ct,{d:()=>et});var m=c(40632),s=c(62842),k=c(88002),M=c(87519),h=c(74788),j=c(76189),y=c(67446),X=c(29070),$=c(54255),rt=c(15491),G=c(219),ut=c(12057);let et=(()=>{class st{constructor(ht,_t){this.editor=ht,this.texts$=_t,this.insertGroupText$=this.texts$.pipe((0,k.U)(K=>K.insertGroup)),this.removeGroupText$=this.texts$.pipe((0,k.U)(K=>K.removeGroup)),this.disabled$=this.editor.stateChange$.pipe((0,k.U)(()=>!this.editor.isActive("group")),(0,M.x)())}addGroup(){this.editor.setGroup()}removeGroup(){this.editor.removeGroup()}}return st.\u0275fac=function(ht){return new(ht||st)(h.Y36(m.$3),h.Y36(s.rf))},st.\u0275cmp=h.Xpm({type:st,selectors:[["tui-editor-group-tool"]],decls:5,vars:13,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconPlusLarge","appearance","icon",3,"focusable","tuiHint","tuiHintDescribe","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconRemoveLarge","appearance","icon",3,"focusable","disabled","tuiHint","tuiHintDescribe","click"]],template:function(ht,_t){1&ht&&(h.TgZ(0,"button",0),h.NdJ("click",function(){return _t.addGroup()}),h.ALo(1,"async"),h.qZA(),h.TgZ(2,"button",1),h.NdJ("click",function(){return _t.removeGroup()}),h.ALo(3,"async"),h.ALo(4,"async"),h.qZA()),2&ht&&(h.Q6J("focusable",!1)("tuiHint",h.lcZ(1,7,_t.insertGroupText$))("tuiHintDescribe",""),h.xp6(2),h.Q6J("focusable",!1)("disabled",!!h.lcZ(3,9,_t.disabled$))("tuiHint",h.lcZ(4,11,_t.removeGroupText$))("tuiHintDescribe",""))},directives:[j.v,y.D,X.x,$.t,rt.D,G.$],pipes:[ut.Ov],encapsulation:2,changeDetection:0}),st})()},7416:(Pt,ct,c)=>{c.d(ct,{U:()=>pt});var m=c(64762),s=c(40632),k=c(62842),M=c(36692),h=c(88002),j=c(87519),y=c(74788),X=c(40939),$=c(62939),rt=c(33250),G=c(76189),ut=c(67446),et=c(29070),st=c(54255),Mt=c(15491),ht=c(219),_t=c(12057),K=c(5451),H=c(17163);function Y(ft,gt){if(1&ft&&y._UZ(0,"div",6),2&ft){const ot=y.oxw().tuiLet;y.Udp("background",ot)}}function L(ft,gt){if(1&ft){const ot=y.EpF();y.TgZ(0,"tui-palette",7),y.NdJ("selectedColor",function(bt){return y.CHM(ot),y.oxw(2).editor.setBackgroundColor(bt)}),y.qZA()}if(2&ft){const ot=gt.$implicit,xt=y.oxw(2);y.Q6J("tuiActiveZoneParent",ot)("colors",xt.colors)}}function dt(ft,gt){if(1&ft&&(y.TgZ(0,"tui-hosted-dropdown",1,2),y._UZ(2,"button",3),y.ALo(3,"async"),y.YNc(4,Y,1,2,"div",4),y.YNc(5,L,1,2,"ng-template",null,5,y.W1O),y.qZA()),2&ft){const ot=gt.tuiLet,xt=y.MAs(1),bt=y.MAs(6),Bt=y.oxw();y.Q6J("content",bt)("tuiDropdownMaxHeight",999),y.xp6(2),y.Q6J("tuiHint",y.lcZ(3,7,Bt.backColorText$))("tuiHintDescribe","")("pseudoActive",xt.open)("focusable",xt.open),y.xp6(2),y.Q6J("ngIf",!Bt.isBlankColor(ot||""))}}class pt{constructor(gt,ot,xt){this.editor=gt,this.texts$=ot,this.defaultOptions=xt,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,h.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,j.x)()),this.backColorText$=this.texts$.pipe((0,h.U)(bt=>bt.backColor))}isBlankColor(gt){return gt===this.defaultOptions.blankColor}}pt.\u0275fac=function(gt){return new(gt||pt)(y.Y36(s.$3),y.Y36(k.rf),y.Y36(k.mJ))},pt.\u0275cmp=y.Xpm({type:pt,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(gt,ot){1&gt&&(y.YNc(0,dt,7,9,"tui-hosted-dropdown",0),y.ALo(1,"async")),2&gt&&y.Q6J("tuiLet",y.lcZ(1,1,ot.backgroundColor$))},directives:[X.L,$.o,rt.Ek,G.v,ut.D,et.x,st.t,Mt.D,ht.$,_t.O5,K.R,H.e],pipes:[_t.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],pt.prototype,"colors",void 0)},93252:(Pt,ct,c)=>{c.d(ct,{Xp:()=>m.X,pu:()=>j,Tf:()=>y.T,P_:()=>X,yj:()=>$.y,y9:()=>rt,Un:()=>G.U,dN:()=>ht.d,jP:()=>_t,mK:()=>ut.m,p7:()=>et,hr:()=>st.h,Zv:()=>Mt,UT:()=>K.U,XC:()=>Y,w2:()=>L.w,Ur:()=>dt,pH:()=>pt.p,mp:()=>ft,iN:()=>E.i,lT:()=>gt.l,iA:()=>bt,YH:()=>Bt.Y,er:()=>tt,_I:()=>E._,__:()=>z,M8:()=>ot.M,kU:()=>xt,G0:()=>Z.G,_t:()=>at});var m=c(37924),s=c(12057),k=c(36692),M=c(90987),h=c(74788);let j=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiButtonModule,M.TuiHintModule,k.TuiLetModule]]}),I})();var y=c(15587);let X=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiButtonModule,M.TuiHintModule,M.TuiDataListModule]]}),I})();var $=c(50237);let rt=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiButtonModule,M.TuiHintModule]]}),I})();var G=c(18832),ut=c(84985);let et=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiButtonModule,M.TuiHintModule,M.TuiDataListModule]]}),I})();var st=c(62976);let Mt=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiButtonModule,M.TuiHintModule]]}),I})();var ht=c(19762);let _t=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiButtonModule,M.TuiHintModule]]}),I})();var K=c(7416),H=c(27050);let Y=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiButtonModule,H.VM,M.TuiHintModule,M.TuiDropdownModule,k.TuiActiveZoneModule,k.TuiLetModule]]}),I})();var L=c(13441);let dt=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiButtonModule,M.TuiHintModule,k.TuiLetModule]]}),I})();var pt=c(95558);let ft=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,H.VM,M.TuiButtonModule,M.TuiHintModule,k.TuiActiveZoneModule,M.TuiDropdownModule,k.TuiLetModule]]}),I})();var gt=c(28962),ot=c(74549);let xt=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,k.TuiRepeatTimesModule]]}),I})(),bt=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiDropdownModule,M.TuiButtonModule,M.TuiHintModule,xt]]}),I})();var Bt=c(76965);let tt=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiButtonModule,M.TuiHintModule,k.TuiLetModule]]}),I})();var E=c(22063);let z=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiHostedDropdownModule,M.TuiHintModule,M.TuiButtonModule,M.TuiDataListModule,k.TuiLetModule]]}),I})();var Z=c(10528);let at=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=h.oAB({type:I}),I.\u0275inj=h.cJS({imports:[[s.ez,M.TuiButtonModule,M.TuiHostedDropdownModule,M.TuiDropdownModule,M.TuiHintModule,H.VM,k.TuiActiveZoneModule,k.TuiLetModule]]}),I})()},13441:(Pt,ct,c)=>{c.d(ct,{w:()=>K});var m=c(40632),s=c(62842),k=c(9112),M=c(88002),h=c(74788),j=c(12057),y=c(40939),X=c(62939),$=c(76189),rt=c(67446),G=c(29070),ut=c(54255),et=c(15491),st=c(219);function Mt(H,Y){if(1&H){const L=h.EpF();h.TgZ(0,"div",6),h.TgZ(1,"button",7),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).editor.toggleUnorderedList()}),h.qZA(),h.TgZ(2,"button",8),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).editor.toggleOrderedList()}),h.qZA(),h.TgZ(3,"button",9),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).sinkListItem()}),h.qZA(),h.TgZ(4,"button",10),h.NdJ("click",function(){return h.CHM(L),h.oxw(3).liftListItem()}),h.qZA(),h.qZA()}if(2&H){const L=h.oxw().tuiLet,dt=h.oxw().ngIf;h.xp6(1),h.Q6J("tuiHint",dt.unorderedList)("pseudoActive",!(null==L||!L.unordered)),h.xp6(1),h.Q6J("tuiHint",dt.orderedList)("pseudoActive",!(null==L||!L.ordered)),h.xp6(1),h.Q6J("tuiHint",dt.indent)("disabled",!(null!=L&&L.ordered||null!=L&&L.unordered)),h.xp6(1),h.Q6J("tuiHint",dt.outdent)("disabled",!(null!=L&&L.ordered||null!=L&&L.unordered))}}function ht(H,Y){if(1&H&&(h.TgZ(0,"tui-hosted-dropdown",2,3),h._UZ(2,"button",4),h.YNc(3,Mt,5,8,"ng-template",null,5,h.W1O),h.qZA()),2&H){const L=Y.tuiLet,dt=h.MAs(1),pt=h.MAs(4),ft=h.oxw().ngIf;h.Q6J("content",pt),h.xp6(2),h.Q6J("tuiHint",ft.list)("tuiHintDescribe","")("pseudoActive",(null==dt?null:dt.open)||(null==L?null:L.unordered)||(null==L?null:L.ordered)||!1)("focusable",dt.open)}}function _t(H,Y){if(1&H&&(h.ynx(0),h.YNc(1,ht,5,5,"tui-hosted-dropdown",1),h.ALo(2,"async"),h.BQk()),2&H){const L=h.oxw();h.xp6(1),h.Q6J("tuiLet",h.lcZ(2,1,L.listState$))}}let K=(()=>{class H{constructor(L,dt){this.editor=L,this.texts$=dt,this.listState$=(0,k.aj)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,M.U)(([pt,ft])=>({ordered:pt,unordered:ft})))}sinkListItem(){this.editor.sinkListItem()}liftListItem(){this.editor.liftListItem()}}return H.\u0275fac=function(L){return new(L||H)(h.Y36(m.$3),h.Y36(s.rf))},H.\u0275cmp=h.Xpm({type:H,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","disabled","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","disabled","click"]],template:function(L,dt){1&L&&(h.YNc(0,_t,3,3,"ng-container",0),h.ALo(1,"async")),2&L&&h.Q6J("ngIf",h.lcZ(1,1,dt.texts$))},directives:[j.O5,y.L,X.o,$.v,rt.D,G.x,ut.t,et.D,st.$],pipes:[j.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),H})()},95558:(Pt,ct,c)=>{c.d(ct,{p:()=>ft});var m=c(64762),s=c(40632),k=c(62842),M=c(36692),h=c(88002),j=c(87519),y=c(74788),X=c(40939),$=c(62939),rt=c(33250),G=c(76189),ut=c(67446),et=c(29070),st=c(54255),Mt=c(15491),ht=c(219),_t=c(12057),K=c(5451),H=c(17163);function Y(gt,ot){if(1&gt&&y._UZ(0,"div",7),2&gt){const xt=y.oxw(2).tuiLet;y.Udp("background",xt)}}function L(gt,ot){if(1&gt){const xt=y.EpF();y.TgZ(0,"tui-palette",8),y.NdJ("selectedColor",function(Bt){return y.CHM(xt),y.oxw(3).setCellColor(Bt)}),y.qZA()}if(2&gt){const xt=ot.$implicit,bt=y.oxw(3);y.Q6J("tuiActiveZoneParent",xt)("colors",bt.colors)}}function dt(gt,ot){if(1&gt&&(y.TgZ(0,"tui-hosted-dropdown",2,3),y._UZ(2,"button",4),y.ALo(3,"async"),y.YNc(4,Y,1,2,"div",5),y.YNc(5,L,1,2,"ng-template",null,6,y.W1O),y.qZA()),2&gt){const xt=ot.tuiLet,bt=y.MAs(1),Bt=y.MAs(6),tt=y.oxw().tuiLet,E=y.oxw();y.Q6J("content",Bt)("tuiDropdownMaxHeight",999)("canOpen",!!xt),y.xp6(2),y.Q6J("tuiHint",y.lcZ(3,9,E.cellColorText$))("tuiHintDescribe","")("pseudoActive",bt.open)("focusable",bt.open)("disabled",!xt),y.xp6(2),y.Q6J("ngIf",!E.isBlankColor(tt||""))}}function pt(gt,ot){if(1&gt&&(y.ynx(0),y.YNc(1,dt,7,11,"tui-hosted-dropdown",1),y.ALo(2,"async"),y.BQk()),2&gt){const xt=y.oxw();y.xp6(1),y.Q6J("tuiLet",y.lcZ(2,1,xt.isActive$))}}class ft{constructor(ot,xt,bt){this.defaultOptions=ot,this.editor=xt,this.texts$=bt,this.colors=this.defaultOptions.colors,this.cellColorText$=this.texts$.pipe((0,h.U)(Bt=>Bt.cellColor)),this.isActive$=this.editor.isActive$("table"),this.cellColor$=this.editor.stateChange$.pipe((0,h.U)(()=>this.editor.getCellColor()||this.defaultOptions.blankColor),(0,j.x)())}isBlankColor(ot){return ot===this.defaultOptions.blankColor}setCellColor(ot){this.editor.setCellColor(ot)}}ft.\u0275fac=function(ot){return new(ot||ft)(y.Y36(k.mJ),y.Y36(s.$3),y.Y36(k.rf))},ft.\u0275cmp=y.Xpm({type:ft,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["cellColorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","disabled"],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(ot,xt){1&ot&&(y.YNc(0,pt,3,3,"ng-container",0),y.ALo(1,"async")),2&ot&&y.Q6J("tuiLet",y.lcZ(1,1,xt.cellColor$))},directives:[X.L,$.o,rt.Ek,G.v,ut.D,et.x,st.t,Mt.D,ht.$,_t.O5,K.R,H.e],pipes:[_t.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],ft.prototype,"colors",void 0)},28962:(Pt,ct,c)=>{c.d(ct,{l:()=>ht});var m=c(40632),s=c(62842),k=c(88002),M=c(74788),h=c(62939),j=c(33250),y=c(76189),X=c(67446),$=c(29070),rt=c(54255),G=c(15491),ut=c(219),et=c(74549),st=c(12057);function Mt(_t,K){if(1&_t){const H=M.EpF();M.TgZ(0,"tui-table-size-selector",4),M.NdJ("onSelectSize",function(L){return M.CHM(H),M.oxw().addTable(L)}),M.qZA()}}let ht=(()=>{class _t{constructor(H,Y){this.editor=H,this.texts$=Y,this.insertTableText$=this.texts$.pipe((0,k.U)(L=>L.insertTable))}addTable({rows:H,cols:Y}){this.editor.enter();const L=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(L),this.editor.insertTable(H,Y)}}return _t.\u0275fac=function(H){return new(H||_t)(M.Y36(m.$3),M.Y36(s.rf))},_t.\u0275cmp=M.Xpm({type:_t,selectors:[["tui-table-create"]],decls:6,vars:6,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable"],["tableDropdown",""],[3,"onSelectSize"]],template:function(H,Y){if(1&H&&(M.TgZ(0,"tui-hosted-dropdown",0,1),M._UZ(2,"button",2),M.ALo(3,"async"),M.qZA(),M.YNc(4,Mt,1,0,"ng-template",null,3,M.W1O)),2&H){const L=M.MAs(1),dt=M.MAs(5);M.Q6J("content",dt),M.xp6(2),M.Q6J("tuiHint",M.lcZ(3,4,Y.insertTableText$))("tuiHintDescribe","")("focusable",L.open)}},directives:[h.o,j.Ek,y.v,X.D,$.x,rt.t,G.D,ut.$,et.M],pipes:[st.Ov],encapsulation:2,changeDetection:0}),_t})()},76965:(Pt,ct,c)=>{c.d(ct,{Y:()=>_t});var m=c(40632),s=c(62842),k=c(88002),M=c(87519),h=c(74788),j=c(40939),y=c(12057),X=c(76189),$=c(67446),rt=c(29070),G=c(54255),ut=c(15491),et=c(219);function st(K,H){if(1&K){const Y=h.EpF();h.TgZ(0,"button",2),h.NdJ("click",function(){h.CHM(Y);const dt=h.oxw().tuiLet,pt=h.oxw();return dt.mergeCells?pt.mergeCells():pt.splitCell()}),h.qZA()}if(2&K){const Y=H.ngIf,L=h.oxw().tuiLet;h.Q6J("icon",L.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",L.mergeCells?Y.mergeCells:Y.splitCells)("tuiHintDescribe","")("focusable",!1)("disabled",!L.mergeCells&&!L.splitCells)}}function Mt(K,H){if(1&K&&(h.ynx(0),h.YNc(1,st,1,5,"button",1),h.ALo(2,"async"),h.BQk()),2&K){const Y=h.oxw();h.xp6(1),h.Q6J("ngIf",h.lcZ(2,1,Y.texts$))}}const ht=function(K,H){return{mergeCells:K,splitCells:H}};let _t=(()=>{class K{constructor(Y,L){this.editor=Y,this.texts$=L,this.canMergeCells$=this.editor.stateChange$.pipe((0,k.U)(()=>this.editor.canMergeCells()),(0,M.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,k.U)(()=>this.editor.canSplitCells()),(0,M.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}}return K.\u0275fac=function(Y){return new(Y||K)(h.Y36(m.$3),h.Y36(s.rf))},K.\u0275cmp=h.Xpm({type:K,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(Y,L){1&Y&&(h.YNc(0,Mt,3,3,"ng-container",0),h.ALo(1,"async"),h.ALo(2,"async")),2&Y&&h.Q6J("tuiLet",h.WLB(5,ht,h.lcZ(1,1,L.canMergeCells$),h.lcZ(2,3,L.canSplitCells$)))},directives:[j.L,y.O5,X.v,$.D,rt.x,G.t,ut.D,et.$],pipes:[y.Ov],encapsulation:2,changeDetection:0}),K})()},22063:(Pt,ct,c)=>{c.d(ct,{i:()=>L,_:()=>dt});var m=c(40632),s=c(62842),k=c(88002),M=c(74788),h=c(40939),j=c(62939),y=c(76189),X=c(67446),$=c(29070),rt=c(54255),G=c(15491),ut=c(219),et=c(20933),st=c(12057),Mt=c(89786),ht=c(35065);function _t(pt,ft){if(1&pt&&(M.TgZ(0,"tui-hosted-dropdown",2,3),M._UZ(2,"button",4),M.ALo(3,"async"),M.qZA()),2&pt){const gt=ft.tuiLet,ot=M.MAs(1),xt=M.oxw(),bt=M.MAs(3);M.Q6J("content",bt)("canOpen",!!gt),M.xp6(2),M.Q6J("tuiHint",M.lcZ(3,6,xt.rowsColumnsManagingText$))("tuiHintDescribe","")("focusable",ot.open)("disabled",!gt)}}function K(pt,ft){if(1&pt){const gt=M.EpF();M.TgZ(0,"button",7),M.NdJ("click",function(){const bt=M.CHM(gt).index,Bt=M.oxw().index;return M.oxw(2).onTableOption(2*Bt+bt)}),M._uU(1),M.qZA()}if(2&pt){const gt=ft.$implicit;M.xp6(1),M.hij(" ",gt," ")}}function H(pt,ft){if(1&pt&&(M.TgZ(0,"tui-opt-group"),M.YNc(1,K,2,1,"button",6),M.qZA()),2&pt){const gt=ft.$implicit;M.xp6(1),M.Q6J("ngForOf",gt)}}function Y(pt,ft){if(1&pt&&(M.TgZ(0,"tui-data-list"),M.YNc(1,H,2,1,"tui-opt-group",5),M.ALo(2,"async"),M.qZA()),2&pt){const gt=M.oxw();M.xp6(1),M.Q6J("ngForOf",M.lcZ(2,1,gt.tableCommandTexts$))}}var L=(()=>{return(pt=L||(L={}))[pt.InsertColumnBefore=0]="InsertColumnBefore",pt[pt.InsertColumnAfter=1]="InsertColumnAfter",pt[pt.InsertRowBefore=2]="InsertRowBefore",pt[pt.InsertRowAfter=3]="InsertRowAfter",pt[pt.DeleteColumn=4]="DeleteColumn",pt[pt.DeleteRow=5]="DeleteRow",L;var pt})();let dt=(()=>{class pt{constructor(gt,ot,xt){this.editor=gt,this.texts$=ot,this.tableCommandTexts$=xt,this.commandsRegistry={[L.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[L.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[L.InsertRowAfter]:()=>this.editor.addRowAfter(),[L.InsertRowBefore]:()=>this.editor.addRowBefore(),[L.DeleteColumn]:()=>this.editor.deleteColumn(),[L.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,k.U)(bt=>bt.rowsColumnsManaging))}onTableOption(gt){this.commandsRegistry[gt]()}}return pt.\u0275fac=function(gt){return new(gt||pt)(M.Y36(m.$3),M.Y36(s.rf),M.Y36(s.$i))},pt.\u0275cmp=M.Xpm({type:pt,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled"],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(gt,ot){1&gt&&(M.YNc(0,_t,4,8,"tui-hosted-dropdown",0),M.ALo(1,"async"),M.YNc(2,Y,3,3,"ng-template",null,1,M.W1O)),2&gt&&M.Q6J("tuiLet",M.lcZ(1,1,ot.isActive$))},directives:[h.L,j.o,y.v,X.D,$.x,rt.t,G.D,ut.$,et.q,st.sg,Mt.R,ht.v],pipes:[st.Ov],encapsulation:2,changeDetection:0}),pt})()},74549:(Pt,ct,c)=>{c.d(ct,{M:()=>rt});var m=c(74788),s=c(62579),k=c(90987),M=c(36097);function h(G,ut){if(1&G){const et=m.EpF();m.TgZ(0,"div",4),m.NdJ("mouseenter",function(Mt){const _t=m.CHM(et).$implicit,K=m.oxw().$implicit;return m.oxw().updateCurrentSize(_t+1,K+1,Mt)})("click",function(){return m.CHM(et),m.oxw(2).onClick()}),m.qZA()}if(2&G){const et=ut.$implicit,st=m.oxw().$implicit,Mt=m.oxw();m.ekj("t-cell_hovered",Mt.tableSelectHovered(et,st))}}function j(G,ut){if(1&G&&(m.TgZ(0,"div",2),m.YNc(1,h,1,2,"div",3),m.qZA()),2&G){const et=m.oxw();m.xp6(1),m.Q6J("tuiRepeatTimesOf",et.rowsNumber)}}let rt=(()=>{class G{constructor(et){this.windowRef=et,this.onSelectSize=new m.vpe,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(et,st){return et<this.tableSize.rows&&st<this.tableSize.cols}updateCurrentSize(et,st,Mt){(0,k.tuiGetViewportWidth)(this.windowRef)-Mt.clientX>70&&(this.tableSize={rows:et,cols:st})}onClick(){this.onSelectSize.emit(this.tableSize)}}return G.\u0275fac=function(et){return new(et||G)(m.Y36(s.m9))},G.\u0275cmp=m.Xpm({type:G,selectors:[["tui-table-size-selector"]],outputs:{onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(et,st){1&et&&(m.YNc(0,j,2,1,"div",0),m.TgZ(1,"div",1),m._uU(2),m.qZA()),2&et&&(m.Q6J("tuiRepeatTimesOf",st.columnsNumber),m.xp6(2),m.AsE("",st.tableSize.cols,"\xd7",st.tableSize.rows,""))},directives:[M.X],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),G})()},10528:(Pt,ct,c)=>{c.d(ct,{G:()=>dt});var m=c(64762),s=c(40632),k=c(62842),M=c(36692),h=c(88002),j=c(87519),y=c(74788),X=c(40939),$=c(62939),rt=c(33250),G=c(76189),ut=c(67446),et=c(29070),st=c(54255),Mt=c(15491),ht=c(219),_t=c(5451),K=c(17163),H=c(12057);function Y(pt,ft){if(1&pt){const gt=y.EpF();y.TgZ(0,"tui-palette",6),y.NdJ("selectedColor",function(xt){return y.CHM(gt),y.oxw(2).editor.setFontColor(xt)}),y.qZA()}if(2&pt){const gt=ft.$implicit,ot=y.oxw(2);y.Q6J("tuiActiveZoneParent",gt)("colors",ot.colors)}}function L(pt,ft){if(1&pt&&(y.TgZ(0,"tui-hosted-dropdown",1,2),y._UZ(2,"button",3),y.ALo(3,"async"),y._UZ(4,"div",4),y.YNc(5,Y,1,2,"ng-template",null,5,y.W1O),y.qZA()),2&pt){const gt=ft.tuiLet,ot=y.MAs(1),xt=y.MAs(6),bt=y.oxw();y.Q6J("content",xt)("tuiDropdownMaxHeight",999),y.xp6(2),y.Q6J("tuiHint",y.lcZ(3,8,bt.foreColorText$))("tuiHintDescribe","")("pseudoActive",ot.open)("focusable",ot.open),y.xp6(2),y.Udp("background",gt)}}class dt{constructor(ft,gt,ot){this.defaultOptions=ft,this.editor=gt,this.texts$=ot,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,h.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,j.x)()),this.foreColorText$=this.texts$.pipe((0,h.U)(xt=>xt.foreColor))}}dt.\u0275fac=function(ft){return new(ft||dt)(y.Y36(k.mJ),y.Y36(s.$3),y.Y36(k.rf))},dt.\u0275cmp=y.Xpm({type:dt,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(ft,gt){1&ft&&(y.YNc(0,L,7,10,"tui-hosted-dropdown",0),y.ALo(1,"async")),2&ft&&y.Q6J("tuiLet",y.lcZ(1,1,gt.fontColor$))},directives:[X.L,$.o,rt.Ek,G.v,ut.D,et.x,st.t,Mt.D,ht.$,_t.R,K.e],pipes:[H.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),(0,m.gn)([(0,M.tuiDefaultProp)()],dt.prototype,"colors",void 0)},17406:(Pt,ct,c)=>{c.d(ct,{M6:()=>m.M,yB:()=>X,Bp:()=>$.B});var m=c(4997),s=c(12057),k=c(71115),M=c(93252),h=c(36692),j=c(90987),y=c(74788);let X=(()=>{class rt{}return rt.\u0275fac=function(ut){return new(ut||rt)},rt.\u0275mod=y.oAB({type:rt}),rt.\u0275inj=y.cJS({imports:[[s.ez,j.TuiHintModule,h.TuiFocusableModule,j.TuiButtonModule,j.TuiHostedDropdownModule,k.F,M.er,M.mp,M.__,M.iA,M.p7,M.Zv,M.pu,M.Ur,M._t,M.XC,M.P_,M.y9,h.TuiItemModule,M.jP]]}),rt})();var $=c(13044)},13044:(Pt,ct,c)=>{c.d(ct,{B:()=>k});var m=c(74788),s=c(36692);let k=(()=>{class M{constructor(j){this.elementRef=j}get toolsContainers(){return Array.from(this.elementRef.nativeElement.querySelectorAll("[tuiItem]"))}onHorizontalNavigation(j){const{toolsContainers:y}=this,X=y.findIndex(s.tuiIsNativeFocusedIn),rt=y[(0,s.tuiClamp)(X+(j?-1:1),0,y.length-1)],G=j?this.findPreviousTool(rt):this.findNextTool(rt);G&&G.focus()}findFirstFocusableTool(j=!1){const y=j?this.toolsContainers.slice().reverse():this.toolsContainers;for(const X of y){const $=(0,s.tuiIsNativeMouseFocusable)(X)?X:(0,s.tuiGetClosestFocusable)({initial:X,root:X,keyboard:!1});if($)return $}return null}findPreviousTool(j){return(0,s.tuiIsNativeMouseFocusable)(j)?j:(0,s.tuiGetClosestFocusable)({initial:j,root:j,keyboard:!1})||(0,s.tuiGetClosestFocusable)({initial:j,root:this.elementRef.nativeElement,previous:!0,keyboard:!1})}findNextTool(j){return(0,s.tuiIsNativeMouseFocusable)(j)?j:(0,s.tuiGetClosestFocusable)({initial:j,root:this.elementRef.nativeElement,keyboard:!1})}}return M.\u0275fac=function(j){return new(j||M)(m.Y36(m.SBq))},M.\u0275dir=m.lG2({type:M,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(j,y){1&j&&m.NdJ("keydown.arrowRight.prevent",function(){return y.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return y.onHorizontalNavigation(!0)})}}),M})()},4997:(Pt,ct,c)=>{c.d(ct,{M:()=>C});var m=c(64762),s=c(74788),k=c(19074),M=c(40632),h=c(48699),j=c(62842),y=c(36692),X=c(15257),$=c(13044),rt=c(12057),G=c(48893),ut=c(76189),et=c(82707),st=c(67446),Mt=c(29070),ht=c(54255),_t=c(15491),K=c(219),H=c(84985),Y=c(62976),L=c(37924),dt=c(13441),pt=c(62939),ft=c(45050),gt=c(10528),ot=c(7416),xt=c(15587),bt=c(50237),Bt=c(18832),tt=c(19762),E=c(28962),z=c(22063),Z=c(76965),at=c(95558);const I=["dropdown"];function J(b,B){1&b&&s.GkF(0)}function Q(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",7),s.NdJ("click",function(){return s.CHM(A),s.oxw(2).undo()}),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(A),s.oxw(2).redo()}),s.qZA(),s.qZA()}if(2&b){const A=s.oxw().ngIf,V=s.oxw();s.xp6(1),s.Q6J("tuiHint",A.undo)("tuiHintDescribe","")("disabled",V.undoDisabled)("focusable",!1),s.xp6(1),s.Q6J("tuiHint",A.redo)("tuiHintDescribe","")("disabled",V.redoDisabled)("focusable",!1)}}function Et(b,B){1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-font-size",9),s.qZA())}function At(b,B){if(1&b&&s._UZ(0,"tui-font-style",15),2&b){const A=s.oxw(3);s.Q6J("enabledTools",A.toolsSet)}}function It(b,B){1&b&&s._UZ(0,"tui-align-content",9)}function Zt(b,B){1&b&&s._UZ(0,"tui-list-configs",9)}function zt(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"button",16,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(3).toggleQuote()}),s.qZA()}if(2&b){const A=s.oxw(2).ngIf,V=s.oxw();s.Q6J("tuiHint",A.quote)("tuiHintDescribe","")("pseudoActive",V.blockquote)("disabled",V.unorderedList||V.orderedList)("focusable",!1)}}function xe(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"tui-edit-link",22,23),s.NdJ("addLink",function(Ct){s.CHM(A),s.oxw();const Dt=s.MAs(1);return s.oxw(3).onLink(Dt,Ct)})("removeLink",function(){s.CHM(A),s.oxw();const Ct=s.MAs(1);return s.oxw(3).onLink(Ct)}),s.qZA()}}function me(b,B){if(1&b&&(s.TgZ(0,"tui-hosted-dropdown",18,19),s._UZ(2,"button",20,17),s.YNc(4,xe,2,0,"ng-template",null,21,s.W1O),s.qZA()),2&b){const A=s.MAs(1),V=s.MAs(5),Ct=s.oxw(2).ngIf,Dt=s.oxw();s.Q6J("canOpen",!Dt.a)("content",V),s.xp6(2),s.Q6J("tuiHint",Ct.link)("tuiHintDescribe","")("pseudoActive",A.open||Dt.a)("focusable",A.open)}}function Ce(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"button",24,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(3).onAttach()}),s.qZA()}if(2&b){const A=s.oxw(2).ngIf;s.Q6J("tuiHint",A.attach)("tuiHintDescribe","")("focusable",!1)}}function jt(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,At,1,1,"tui-font-style",10),s.YNc(2,It,1,0,"tui-align-content",11),s.YNc(3,Zt,1,0,"tui-list-configs",11),s.YNc(4,zt,2,5,"button",12),s.YNc(5,me,6,6,"tui-hosted-dropdown",13),s.YNc(6,Ce,2,3,"button",14),s.qZA()),2&b){const A=s.oxw(2);s.xp6(1),s.Q6J("ngIf",A.formatEnabled),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Align)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.List)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Quote)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Link)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Attach))}}function Me(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"button",27,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(3).toggleSubscript()}),s.qZA()}if(2&b){const A=s.oxw(2).ngIf,V=s.oxw();s.Q6J("tuiHint",A.subscript)("tuiHintDescribe","")("pseudoActive",V.subscript)("focusable",!1)}}function Vt(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"button",28,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(3).toggleSuperscript()}),s.qZA()}if(2&b){const A=s.oxw(2).ngIf,V=s.oxw();s.Q6J("tuiHint",A.superscript)("tuiHintDescribe","")("pseudoActive",V.superscript)("focusable",!1)}}function Gt(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,Me,2,4,"button",25),s.YNc(2,Vt,2,4,"button",26),s.qZA()),2&b){const A=s.oxw(2);s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Sub)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Sup))}}function ee(b,B){if(1&b&&s._UZ(0,"tui-text-color",30),2&b){const A=s.oxw(3);s.Q6J("colors",A.colors)}}function Oe(b,B){if(1&b&&s._UZ(0,"tui-highlight-color",30),2&b){const A=s.oxw(3);s.Q6J("colors",A.colors)}}function Xt(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,ee,1,1,"tui-text-color",29),s.YNc(2,Oe,1,1,"tui-highlight-color",29),s.qZA()),2&b){const A=s.oxw(2);s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Color)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Hilite))}}function Ee(b,B){1&b&&s._UZ(0,"tui-code",9)}function _e(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"button",34,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(3).onTeX()}),s.qZA()}if(2&b){const A=s.oxw(2).ngIf;s.Q6J("tuiHint",A.tex)("tuiHintDescribe","")("focusable",!1)}}function ne(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"div",35),s.TgZ(1,"button",36,17),s.NdJ("click",function(){return s.CHM(A),s.MAs(4).click()}),s.qZA(),s.TgZ(3,"input",37,38),s.NdJ("change",function(){s.CHM(A);const Ct=s.MAs(4);return s.oxw(3).onImage(Ct)}),s.qZA(),s.qZA()}if(2&b){const A=s.oxw(2).ngIf;s.xp6(1),s.Q6J("tuiHint",A.image)("tuiHintDescribe","")("focusable",!1),s.xp6(2),s.Q6J("tuiFocusable",!1)}}function re(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"button",39,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(3).insertHorizontalRule()}),s.qZA()}if(2&b){const A=s.oxw(2).ngIf;s.Q6J("tuiHint",A.insertHorizontalRule)("tuiHintDescribe","")("focusable",!1)}}function ve(b,B){if(1&b&&(s.TgZ(0,"div",6),s.YNc(1,Ee,1,0,"tui-code",11),s.YNc(2,_e,2,3,"button",31),s.YNc(3,ne,5,4,"div",32),s.YNc(4,re,2,3,"button",33),s.qZA()),2&b){const A=s.oxw(2);s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Code)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Tex)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Img)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.HR))}}function he(b,B){if(1&b){const A=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",40,17),s.NdJ("click",function(){return s.CHM(A),s.oxw(2).removeFormat()}),s.qZA(),s.qZA()}if(2&b){const A=s.oxw().ngIf;s.xp6(1),s.Q6J("tuiHint",A.clear)("tuiHintDescribe","")("focusable",!1)}}function se(b,B){1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-details",41),s._UZ(2,"tui-details-remove",41),s.qZA())}function Jt(b,B){1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-editor-group-tool",41),s.qZA())}function le(b,B){if(1&b&&(s.TgZ(0,"div",6),s._UZ(1,"tui-table-create",41),s._UZ(2,"tui-table-row-column-manager",41),s._UZ(3,"tui-table-merge-cells",41),s._UZ(4,"tui-table-cell-color",30),s.qZA()),2&b){const A=s.oxw(2);s.xp6(4),s.Q6J("colors",A.colors)}}function U(b,B){if(1&b&&(s.TgZ(0,"section",4),s.YNc(1,Q,3,8,"div",5),s.YNc(2,Et,2,0,"div",5),s.YNc(3,jt,7,6,"div",5),s.YNc(4,Gt,3,2,"div",5),s.YNc(5,Xt,3,2,"div",5),s.YNc(6,ve,5,4,"div",5),s.YNc(7,he,3,3,"div",5),s.YNc(8,se,3,0,"div",5),s.YNc(9,Jt,2,0,"div",5),s.YNc(10,le,5,1,"div",5),s.TgZ(11,"div",6),s.Hsn(12),s.qZA(),s.qZA()),2&b){const A=s.oxw();s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Undo)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Size)),s.xp6(1),s.Q6J("ngIf",A.firstBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Sub)||A.enabled(A.TuiEditorTool.Sup)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Color)||A.enabled(A.TuiEditorTool.Hilite)),s.xp6(1),s.Q6J("ngIf",A.secondBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Clear)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Details)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Group)),s.xp6(1),s.Q6J("ngIf",A.enabled(A.TuiEditorTool.Table))}}class C{constructor(B,A,V,Ct,Dt){this.elementRef=B,this.editor=A,this.imageLoader=V,this.texts$=Ct,this.defaultOptions=Dt,this.dropdowns=y.EMPTY_QUERY,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new s.vpe,this.texClicked=new s.vpe,this.attachClicked=new s.vpe,this.TuiEditorTool=h._,this.toolsSet=new Set(k.Db)}set tools(B){this.toolsSet=new Set(B)}get focused(){return(0,y.tuiIsNativeFocusedIn)(this.elementRef.nativeElement)||!!this.dropdowns.find(({nativeElement:B})=>(0,y.tuiIsNativeFocusedIn)(B))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(h._.Bold)||this.enabled(h._.Italic)||this.enabled(h._.Underline)||this.enabled(h._.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(h._.Align)||this.enabled(h._.List)||this.enabled(h._.Quote)||this.enabled(h._.Link)||this.enabled(h._.Attach)}get secondBigBlockEnabled(){return this.enabled(h._.Code)||this.enabled(h._.Tex)||this.enabled(h._.Img)||this.enabled(h._.HR)}onMouseDown(B,A){A.closest("button")||(B.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage(B){var A;const V=null===(A=B.files)||void 0===A?void 0:A[0];B.value="",V&&this.imageLoader(V).pipe((0,X.q)(1)).subscribe(Ct=>{this.addImage(Ct)})}onAttach(){this.attachClicked.emit()}onTeX(){this.texClicked.emit()}onLink(B,A){B.open=!1,A&&(this.editor.toggleLink(A),this.editor.selectClosest())}enabled(B){return this.toolsSet.has(B)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage(B){this.editor.setImage(B)}focusFirst(){var B;const A=null===(B=this.navigationManager)||void 0===B?void 0:B.findFirstFocusableTool();A&&A.focus()}focusLast(){var B;const A=null===(B=this.navigationManager)||void 0===B?void 0:B.findFirstFocusableTool(!0);A&&A.focus()}}C.\u0275fac=function(B){return new(B||C)(s.Y36(s.SBq,8),s.Y36(M.$3),s.Y36(j.p7),s.Y36(j.rf),s.Y36(j.mJ))},C.\u0275cmp=s.Xpm({type:C,selectors:[["tui-toolbar"]],viewQuery:function(B,A){if(1&B&&(s.Gf($.B,5),s.Gf(I,5,s.SBq)),2&B){let V;s.iGM(V=s.CRH())&&(A.navigationManager=V.first),s.iGM(V=s.CRH())&&(A.dropdowns=V)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function(B,A){1&B&&s.NdJ("mousedown",function(Ct){return A.onMouseDown(Ct,Ct.target)}),2&B&&s.ekj("_disabled",A.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",attachClicked:"attachClicked"},ngContentSelectors:["*"],decls:7,vars:8,consts:[[1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiItem","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiItem","",1,"t-tool","t-wrapper"],["tuiItem","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiItem","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click"],["button",""],["tuiItem","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiItem","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImgLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-tool","t-tool_margin"]],template:function(B,A){1&B&&(s.F$t(),s._UZ(0,"button",0),s.YNc(1,J,1,0,"ng-container",1),s.ALo(2,"async"),s.TgZ(3,"div",2),s.NdJ("focus",function(){return A.onTopFocus()}),s.qZA(),s.TgZ(4,"div",2),s.NdJ("focus",function(){return A.onBottomFocus()}),s.qZA(),s.YNc(5,U,13,10,"section",3),s.ALo(6,"async")),2&B&&(s.xp6(1),s.Q6J("ngIf",s.lcZ(2,4,A.editor.stateChange$)),s.xp6(2),s.Q6J("tuiFocusable",A.focusable),s.xp6(1),s.Q6J("tuiFocusable",A.focusable),s.xp6(1),s.Q6J("ngIf",s.lcZ(6,6,A.texts$)))},directives:[rt.O5,G.t,$.B,ut.v,et.w,st.D,Mt.x,ht.t,_t.D,K.$,H.m,Y.h,L.X,dt.w,pt.o,ft.l,gt.G,ot.U,xt.T,bt.y,Bt.U,tt.d,E.l,z._,Z.Y,at.p],pipes:[rt.Ov],styles:['.t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:"";display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}button.t-tool[_ngcontent-%COMP%]:hover, .t-tool[_ngcontent-%COMP%]     button:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:none;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-color-edit{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),(0,m.gn)([(0,y.tuiDefaultProp)()],C.prototype,"colors",void 0),(0,m.gn)([(0,y.tuiDefaultProp)()],C.prototype,"disabled",void 0),(0,m.gn)([(0,y.tuiDefaultProp)(function(b){return!b.includes(h._.Tex)&&!b.includes(h._.Attach)},"Attach and TeX are not yet implemented in Editor")],C.prototype,"tools",null)},19074:(Pt,ct,c)=>{c.d(ct,{hK:()=>s,sw:()=>m,Db:()=>M,RR:()=>h});const m=new Map([["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),s="rgb(51, 51, 51)";var k=c(48699);const M=[k._.Undo,k._.Size,k._.Bold,k._.Italic,k._.Underline,k._.Align,k._.List,k._.Quote,k._.Link,k._.Color,k._.Hilite,k._.Clear,k._.Strikethrough,k._.Code,k._.Img,k._.HR,k._.Sup,k._.Sub,k._.Table,k._.Details];function h(j){return[{px:13,name:j.small},{px:15,name:j.normal},{px:17,name:j.large},{px:24,family:"var(--tui-font-heading)",name:j.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:j.title,headingLevel:1,weight:"bold"}]}},60153:(Pt,ct,c)=>{c.d(ct,{Z:()=>s});var m=c(74788);let s=(()=>{class k{constructor(){this.imagePreview=new m.vpe}click(h){h instanceof HTMLImageElement&&this.imagePreview.emit(h)}}return k.\u0275fac=function(h){return new(h||k)},k.\u0275dir=m.lG2({type:k,selectors:[["tui-editor-socket","imagePreview",""]],hostAttrs:[1,"_preview-image"],hostBindings:function(h,j){1&h&&m.NdJ("click",function(X){return j.click(X.target)})},outputs:{imagePreview:"imagePreview"}}),k})()},40632:(Pt,ct,c)=>{c.d(ct,{Zj:()=>m.Z,BN:()=>k,JU:()=>M.J,mJ:()=>h,$3:()=>j.$});var m=c(60153),s=c(74788);let k=(()=>{class y{}return y.\u0275fac=function($){return new($||y)},y.\u0275mod=s.oAB({type:y}),y.\u0275inj=s.cJS({}),y})();var M=c(74982);let h=(()=>{class y{}return y.\u0275fac=function($){return new($||y)},y.\u0275mod=s.oAB({type:y}),y.\u0275inj=s.cJS({}),y})();var j=c(17804)},74982:(Pt,ct,c)=>{c.d(ct,{J:()=>j});var m=c(74788),s=c(62842),k=c(36692),M=c(46782),h=c(17804);let j=(()=>{class y{constructor($,rt,G,ut,et,st){this.elementRef=$,this.renderer=rt,this.editor=G,this.editorContainer=ut,this.editorLoaded$=et,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,this.editorLoaded$.pipe((0,M.R)(st)).subscribe(()=>{this.renderer.appendChild(this.elementRef.nativeElement,this.editorContainer)})}set value($){$!==this.editor.html&&this.editor.setValue($)}set editable($){this.editor.editable=$}}return y.\u0275fac=function($){return new($||y)(m.Y36(m.SBq),m.Y36(m.Qsj),m.Y36(h.$),m.Y36(s.Y1),m.Y36(s.ZW),m.Y36(k.TuiDestroyService))},y.\u0275dir=m.lG2({type:y,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[m._Bn([k.TuiDestroyService])]}),y})()},17804:(Pt,ct,c)=>{c.d(ct,{$:()=>rt});var m=c(79765),s=c(74788);let k=(()=>{class G{constructor(){this.stateChange$=new m.xQ,this.valueChange$=new m.xQ}}return G.\u0275fac=function(et){return new(et||G)},G.\u0275dir=s.lG2({type:G}),G})();var M=c(62842),h=c(37631),j=c(39761),y=c(88002),X=c(87519);let rt=(()=>{class G extends k{constructor(et){super(),this.editorRef=et,this.editorRef.subscribe(st=>{this.editor=st,st.on("transaction",()=>{this.stateChange$.next()}),st.on("update",()=>{const Mt=st.getHTML(),_t=function(G){return Array.isArray(G)&&1===G.length&&!G[0].hasOwnProperty("content")}(st.getJSON().content)?"":Mt;this.valueChange$.next(_t)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(et){this.editor.setEditable(et)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||"rgb(51, 51, 51)"}getBackgroundColor(){var et;return(null===(et=this.editor)||void 0===et?void 0:et.getAttributes("textStyle").backgroundColor)||"rgb(51, 51, 51)"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}onAlign(et){this.editor.chain().focus().setTextAlign(et).run()}setImage(et){this.editor.chain().focus().first(({commands:st})=>[()=>{var Mt;return(null===(Mt=st.setEditableImage)||void 0===Mt?void 0:Mt.call(st,{src:et}))||!1},()=>st.setImage({src:et})]).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(et){this.editor.chain().focus().setFontColor(et).run()}setBackgroundColor(et){this.editor.chain().focus().setBackgroundColor(et).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(et){return this.editor.isActive(et)}isActive$(et){return this.stateChange$.pipe((0,j.O)(null),(0,y.U)(()=>this.isActive(et)),(0,X.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(et,st){this.editor.chain().focus().insertTable({cols:et,rows:st}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(et){this.editor.chain().focus().setHeading({level:et}).run()}setParagraph(et){this.editor.chain().focus().setParagraph().run(),et&&this.editor.chain().setMark("textStyle",et).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(et){this.editor.commands.setTextSelection(et)}toggleLink(et){this.editor.chain().focus().toggleLink({href:et}).run()}setLink(et){this.editor.chain().focus().setLink({href:et}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}focus(){this.editor.chain().focus().run()}setValue(et){this.editor.commands.setContent(et)}destroy(){this.editor.destroy()}setCellColor(et){this.editor.chain().focus().setCellBackground(et).run()}selectClosest(){const et=this.editor.state.selection.anchor,{schema:st,doc:Mt}=this.editor.state,ht=(0,h.Yz)(Mt.resolve(et),st.marks.link);ht&&this.editor.chain().setTextSelection(ht).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}setGroup(){this.editor.commands.setGroup()}removeGroup(){this.editor.commands.removeGroup()}}return G.\u0275fac=function(et){return new(et||G)(s.LFG(M.ZW))},G.\u0275prov=s.Yz7({token:G,factory:G.\u0275fac}),G})()},48699:(Pt,ct,c)=>{c.d(ct,{_:()=>m});var m=(()=>{return(s=m||(m={})).Undo="undo",s.Size="fontSize",s.Bold="bold",s.Italic="italic",s.Underline="underline",s.Strikethrough="strikeThrough",s.Align="justify",s.List="list",s.Quote="quote",s.Color="foreColor",s.Hilite="hiliteColor",s.Clear="clear",s.Link="link",s.Attach="attach",s.Tex="tex",s.Code="code",s.Img="image",s.HR="insertHorizontalRule",s.Sup="superscript",s.Sub="subscript",s.Table="insertTable",s.MergeCells="mergeCells",s.SplitCells="splitCells",s.RowsColumnsManaging="rowsColumnsManaging",s.Details="details",s.Group="group",m;var s})()},15736:(Pt,ct,c)=>{c.r(ct),c.d(ct,{BackgroundColor:()=>k}),c(74634);const k=c(40256).Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:M})=>M?{style:`background-color: ${M}`}:{},parseHTML:({style:M})=>M.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:M=>({chain:h})=>h().setMark("textStyle",{backgroundColor:M}).run(),unsetBackgroundColor:()=>({chain:M})=>M().setMark("textStyle",{backgroundColor:null}).run()})})},52658:(Pt,ct,c)=>{c.r(ct),c.d(ct,{FontColor:()=>k}),c(74634);const k=c(40256).Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:M})=>M?{style:`color: ${M}`}:{},parseHTML:({style:M})=>M.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:M=>({chain:h})=>h().setMark("textStyle",{fontColor:M}).run(),unsetFontColor:()=>({chain:M})=>M().setMark("textStyle",{fontColor:null}).run()})})},9492:(Pt,ct,c)=>{c.r(ct),c.d(ct,{TuiFontSize:()=>k}),c(74634);const k=c(40256).Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:M})=>M.fontSize,renderHTML:({fontSize:M})=>M?{style:`font-size: ${M}`}:{}}}}]},addCommands:()=>({setFontSize:M=>({chain:h})=>h().setMark("textStyle",{fontSize:M}).run(),unsetFontSize:()=>({chain:M})=>M().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})})},54920:(Pt,ct,c)=>{c.r(ct),c.d(ct,{TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>k,createGroupExtension:()=>M});var m=c(37631),s=c(40256);const k={groupNodeClass:"tui-group-node",groupPointerNodeClass:"tui-group-pointer",nested:!0,draggable:!0,createOnEnter:!1},M=(h={})=>{const{draggable:j,nested:y,groupNodeClass:X,groupPointerNodeClass:$,createOnEnter:rt}=Object.assign(Object.assign({},k),h);return s.Node.create({name:"group",draggable:j,group:"block",content:y?"block+":"block",parseHTML:()=>[{tag:'div[data-type="group"]'}],renderHTML:({HTMLAttributes:G})=>["div",(0,s.mergeAttributes)(G,{"data-type":"group"}),0],addNodeView:()=>()=>{const G=document.createElement("div"),ut=document.createElement("div");if(G.classList.add(X),ut.setAttribute("data-type","group"),j){const et=document.createElement("div");et.classList.add($),et.innerHTML="",et.contentEditable="false",G.append(et,ut)}else G.append(ut);return{dom:G,contentDOM:ut}},addCommands(){return{setGroup:()=>({commands:G,state:ut})=>{this.editor.chain().focus().run();const et=(0,m.Ap)(ut,""),Mt=`<div data-type="group">${et.trim().startsWith("<p>")?et:`<p>${et}</p>`}</div>`;return G.insertContent(Mt)},removeGroup:()=>({state:G,dispatch:ut})=>(0,m.yU)(G,ut,this.name)}},addKeyboardShortcuts(){return rt?{Enter:()=>this.editor.commands.setGroup()}:{}}})}},25039:(Pt,ct,c)=>{c.r(ct),c.d(ct,{TUI_EDITOR_MAX_IMAGE_WIDTH:()=>$,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>X,TuiImageEditorComponent:()=>rt,TuiImageEditorModule:()=>Mt,createImageEditorExtension:()=>st});var m=c(12057),s=c(74788),k=c(40400),M=c(36692),h=c(66682),j=c(46782),y=c(60015);const X=new s.OlP("[TUI_EDITOR_MIN_IMAGE_WIDTH]: Min size of resizable image inside editor",{factory:()=>100}),$=new s.OlP("[TUI_EDITOR_MAX_IMAGE_WIDTH]: Max size of resizable image inside editor",{factory:()=>1/0});let rt=(()=>{class ht extends k.d{constructor(K,H,Y,L){super(),this.minWidth=K,this.maxWidth=H,this.documentRef=Y,this.destroy$=L,this._width=0,(0,h.T)((0,M.tuiTypedFromEvent)(this.documentRef,"touchend"),(0,M.tuiTypedFromEvent)(this.documentRef,"mouseup")).pipe((0,j.R)(L)).subscribe(()=>this.updateAttributes({width:this.width}))}get attrs(){var K;return(null===(K=this.node)||void 0===K?void 0:K.attrs)||{src:""}}get src(){return this.attrs.src}get width(){return this._width||this.attrs.width||0}get alt(){return this.attrs.alt||""}get title(){return this.attrs.title||""}onHorizontalDrag([K],H){this._width=Math.max(this.minWidth,Math.min(this.maxWidth,this.width+H*K))}}return ht.\u0275fac=function(K){return new(K||ht)(s.Y36(X),s.Y36($),s.Y36(m.K0),s.Y36(M.TuiDestroyService))},ht.\u0275cmp=s.Xpm({type:ht,selectors:[["tui-image-editor"]],features:[s._Bn([M.TuiDestroyService]),s.qOj],decls:3,vars:8,consts:[[3,"src","width","alt","title"],[1,"t-border","t-border_right",3,"tuiPan"],[1,"t-border","t-border_left",3,"tuiPan"]],template:function(K,H){1&K&&(s._UZ(0,"img",0),s.TgZ(1,"span",1),s.NdJ("tuiPan",function(L){return H.onHorizontalDrag(L,1)}),s.qZA(),s.TgZ(2,"span",2),s.NdJ("tuiPan",function(L){return H.onHorizontalDrag(L,-1)}),s.qZA()),2&K&&(s.Udp("min-width",H.minWidth,"px")("max-width",H.maxWidth,"px"),s.Q6J("src",H.src,s.LSH)("width",H.width)("alt",H.alt)("title",H.title))},directives:[y.g],styles:['[_nghost-%COMP%]{position:relative;display:inline-block}[_nghost-%COMP%]:hover   .t-border[_ngcontent-%COMP%]:after{opacity:1}.t-border[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;display:flex;width:.75rem;cursor:col-resize;justify-content:center;align-items:center}.t-border_left[_ngcontent-%COMP%]{left:0}.t-border_right[_ngcontent-%COMP%]{right:0}.t-border[_ngcontent-%COMP%]:after{transition-property:opacity;transition-duration:.3s;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;content:"";width:50%;height:33%;box-sizing:border-box;border-radius:var(--tui-radius-m);background:var(--tui-base-08);border:1px solid var(--tui-base-03);opacity:0}'],changeDetection:0}),ht})();var G=c(40256);const ut=[{tag:'img[data-type="image-editor"]'}],et={src:{default:"",keepOnSplit:!1},width:{default:300,keepOnSplit:!1},alt:{default:"",keepOnSplit:!1},title:{default:"",keepOnSplit:!1}},st=ht=>G.Node.create({name:"imageEditor",group:"block",atom:!0,draggable:!0,parseHTML:()=>ut,addAttributes:()=>et,renderHTML:({HTMLAttributes:_t})=>["img",(0,G.mergeAttributes)(_t,{"data-type":"image-editor"})],addNodeView:()=>(0,k.x)(rt,{injector:ht}),addCommands(){return{setEditableImage:_t=>({commands:K})=>K.insertContent({type:this.name,attrs:_t})}}});let Mt=(()=>{class ht{}return ht.\u0275fac=function(K){return new(K||ht)},ht.\u0275mod=s.oAB({type:ht}),ht.\u0275inj=s.cJS({imports:[[m.ez,M.TuiPanModule]]}),ht})()},12177:(Pt,ct,c)=>{function s(M){return M.isActive("bulletList")||M.isActive("orderedList")}c.r(ct),c.d(ct,{TuiTabExtension:()=>k,tuiIsOrderedOrBulletList:()=>s});const k=c(40256).Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>s(this.editor)?null:this.editor.commands.insertContent("\t")}}})},75276:(Pt,ct,c)=>{c.r(ct),c.d(ct,{StarterKit:()=>Tt});var m=c(40256);const s=/^\s*>\s$/,k=m.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:P}){return["blockquote",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{setBlockquote:()=>({commands:P})=>P.wrapIn(this.name),toggleBlockquote:()=>({commands:P})=>P.toggleWrap(this.name),unsetBlockquote:()=>({commands:P})=>P.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,m.wrappingInputRule)({find:s,type:this.type})]}}),M=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,h=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,j=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,y=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,X=m.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:P=>"normal"!==P.style.fontWeight&&null},{style:"font-weight",getAttrs:P=>/^(bold(er)?|[5-9]\d{2,})$/.test(P)&&null}],renderHTML({HTMLAttributes:P}){return["strong",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{setBold:()=>({commands:P})=>P.setMark(this.name),toggleBold:()=>({commands:P})=>P.toggleMark(this.name),unsetBold:()=>({commands:P})=>P.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,m.markInputRule)({find:M,type:this.type}),(0,m.markInputRule)({find:j,type:this.type})]},addPasteRules(){return[(0,m.markPasteRule)({find:h,type:this.type}),(0,m.markPasteRule)({find:y,type:this.type})]}}),$=/^\s*([-+*])\s$/,rt=m.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:P}){return["ul",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{toggleBulletList:()=>({commands:P})=>P.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[(0,m.wrappingInputRule)({find:$,type:this.type})]}}),G=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,ut=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,et=m.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:P}){return["code",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{setCode:()=>({commands:P})=>P.setMark(this.name),toggleCode:()=>({commands:P})=>P.toggleMark(this.name),unsetCode:()=>({commands:P})=>P.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,m.markInputRule)({find:G,type:this.type})]},addPasteRules(){return[(0,m.markPasteRule)({find:ut,type:this.type})]}});var st=c(62463);const Mt=/^```([a-z]+)?[\s\n]$/,ht=/^~~~([a-z]+)?[\s\n]$/,_t=m.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:P=>{var x;const{languageClassPrefix:F}=this.options;return[...(null===(x=P.firstElementChild)||void 0===x?void 0:x.classList)||[]].filter(vt=>vt.startsWith(F)).map(vt=>vt.replace(F,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:P,HTMLAttributes:x}){return["pre",(0,m.mergeAttributes)(this.options.HTMLAttributes,x),["code",{class:P.attrs.language?this.options.languageClassPrefix+P.attrs.language:null},0]]},addCommands(){return{setCodeBlock:P=>({commands:x})=>x.setNode(this.name,P),toggleCodeBlock:P=>({commands:x})=>x.toggleNode(this.name,"paragraph",P)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:P,$anchor:x}=this.editor.state.selection;return!(!P||x.parent.type.name!==this.name)&&!(1!==x.pos&&x.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:P})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:x}=P,{selection:F}=x,{$from:q,empty:nt}=F;if(!nt||q.parent.type!==this.type)return!1;const yt=q.parentOffset===q.parent.nodeSize-2,vt=q.parent.textContent.endsWith("\n\n");return!(!yt||!vt)&&P.chain().command(({tr:St})=>(St.delete(q.pos-2,q.pos),!0)).exitCode().run()},ArrowDown:({editor:P})=>{if(!this.options.exitOnArrowDown)return!1;const{state:x}=P,{selection:F,doc:q}=x,{$from:nt,empty:yt}=F;if(!yt||nt.parent.type!==this.type||nt.parentOffset!==nt.parent.nodeSize-2)return!1;const St=nt.after();return void 0!==St&&!q.nodeAt(St)&&P.commands.exitCode()}}},addInputRules(){return[(0,m.textblockTypeInputRule)({find:Mt,type:this.type,getAttributes:P=>({language:P[1]})}),(0,m.textblockTypeInputRule)({find:ht,type:this.type,getAttributes:P=>({language:P[1]})})]},addProseMirrorPlugins(){return[new st.Sy({key:new st.H$("codeBlockVSCodeHandler"),props:{handlePaste:(P,x)=>{if(!x.clipboardData||this.editor.isActive(this.type.name))return!1;const F=x.clipboardData.getData("text/plain"),q=x.clipboardData.getData("vscode-editor-data"),nt=q?JSON.parse(q):void 0,yt=null==nt?void 0:nt.mode;if(!F||!yt)return!1;const{tr:vt}=P.state;return vt.replaceSelectionWith(this.type.create({language:yt})),vt.setSelection(st.Bs.near(vt.doc.resolve(Math.max(0,vt.selection.from-2)))),vt.insertText(F.replace(/\r\n?/g,"\n")),vt.setMeta("paste",!0),P.dispatch(vt),!0}}})]}}),K=m.Node.create({name:"doc",topNode:!0,content:"block+"});var H=c(38480);function Y(P={}){return new st.Sy({view:x=>new L(x,P)})}class L{constructor(x,F){this.editorView=x,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=F.width||1,this.color=F.color||"black",this.class=F.class,this.handlers=["dragover","dragend","drop","dragleave"].map(q=>{let nt=yt=>{this[q](yt)};return x.dom.addEventListener(q,nt),{name:q,handler:nt}})}destroy(){this.handlers.forEach(({name:x,handler:F})=>this.editorView.dom.removeEventListener(x,F))}update(x,F){null!=this.cursorPos&&F.doc!=x.state.doc&&(this.cursorPos>x.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(x){x!=this.cursorPos&&(this.cursorPos=x,null==x?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let F,x=this.editorView.state.doc.resolve(this.cursorPos);if(!x.parent.inlineContent){let vt=x.nodeBefore,St=x.nodeAfter;if(vt||St){let Nt=this.editorView.nodeDOM(this.cursorPos-(vt?vt.nodeSize:0)).getBoundingClientRect(),Ut=vt?Nt.bottom:Nt.top;vt&&St&&(Ut=(Ut+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),F={left:Nt.left,right:Nt.right,top:Ut-this.width/2,bottom:Ut+this.width/2}}}if(!F){let vt=this.editorView.coordsAtPos(this.cursorPos);F={left:vt.left-this.width/2,right:vt.left+this.width/2,top:vt.top,bottom:vt.bottom}}let nt,yt,q=this.editorView.dom.offsetParent;if(this.element||(this.element=q.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!q||q==document.body&&"static"==getComputedStyle(q).position)nt=-pageXOffset,yt=-pageYOffset;else{let vt=q.getBoundingClientRect();nt=vt.left-q.scrollLeft,yt=vt.top-q.scrollTop}this.element.style.left=F.left-nt+"px",this.element.style.top=F.top-yt+"px",this.element.style.width=F.right-F.left+"px",this.element.style.height=F.bottom-F.top+"px"}scheduleRemoval(x){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),x)}dragover(x){if(!this.editorView.editable)return;let F=this.editorView.posAtCoords({left:x.clientX,top:x.clientY}),q=F&&F.inside>=0&&this.editorView.state.doc.nodeAt(F.inside),nt=q&&q.type.spec.disableDropCursor,yt="function"==typeof nt?nt(this.editorView,F):nt;if(F&&!yt){let vt=F.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(vt=(0,H.nj)(this.editorView.state.doc,vt,this.editorView.dragging.slice),null==vt))return this.setCursor(null);this.setCursor(vt),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(x){(x.target==this.editorView.dom||!this.editorView.dom.contains(x.relatedTarget))&&this.setCursor(null)}}const dt=m.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[Y(this.options)]}});var pt=c(13903),ft=c(35917),gt=c(43594);class ot extends st.Y1{constructor(x){super(x,x)}map(x,F){let q=x.resolve(F.map(this.head));return ot.valid(q)?new ot(q):st.Y1.near(q)}content(){return ft.p2.empty}eq(x){return x instanceof ot&&x.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(x,F){if("number"!=typeof F.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new ot(x.resolve(F.pos))}getBookmark(){return new xt(this.anchor)}static valid(x){let F=x.parent;if(F.isTextblock||!function(P){for(let x=P.depth;x>=0;x--){let F=P.index(x),q=P.node(x);if(0!=F)for(let nt=q.child(F-1);;nt=nt.lastChild){if(0==nt.childCount&&!nt.inlineContent||nt.isAtom||nt.type.spec.isolating)return!0;if(nt.inlineContent)return!1}else if(q.type.spec.isolating)return!0}return!0}(x)||!function(P){for(let x=P.depth;x>=0;x--){let F=P.indexAfter(x),q=P.node(x);if(F!=q.childCount)for(let nt=q.child(F);;nt=nt.firstChild){if(0==nt.childCount&&!nt.inlineContent||nt.isAtom||nt.type.spec.isolating)return!0;if(nt.inlineContent)return!1}else if(q.type.spec.isolating)return!0}return!0}(x))return!1;let q=F.type.spec.allowGapCursor;if(null!=q)return q;let nt=F.contentMatchAt(x.index()).defaultType;return nt&&nt.isTextblock}static findGapCursorFrom(x,F,q=!1){t:for(;;){if(!q&&ot.valid(x))return x;let nt=x.pos,yt=null;for(let vt=x.depth;;vt--){let St=x.node(vt);if(F>0?x.indexAfter(vt)<St.childCount:x.index(vt)>0){yt=St.child(F>0?x.indexAfter(vt):x.index(vt)-1);break}if(0==vt)return null;nt+=F;let Nt=x.doc.resolve(nt);if(ot.valid(Nt))return Nt}for(;;){let vt=F>0?yt.firstChild:yt.lastChild;if(!vt){if(yt.isAtom&&!yt.isText&&!st.qv.isSelectable(yt)){x=x.doc.resolve(nt+yt.nodeSize*F),q=!1;continue t}break}yt=vt,nt+=F;let St=x.doc.resolve(nt);if(ot.valid(St))return St}return null}}}ot.prototype.visible=!1,ot.findFrom=ot.findGapCursorFrom,st.Y1.jsonID("gapcursor",ot);class xt{constructor(x){this.pos=x}map(x){return new xt(x.map(this.pos))}resolve(x){let F=x.resolve(this.pos);return ot.valid(F)?new ot(F):st.Y1.near(F)}}const E=(0,pt.$)({ArrowLeft:z("horiz",-1),ArrowRight:z("horiz",1),ArrowUp:z("vert",-1),ArrowDown:z("vert",1)});function z(P,x){const F="vert"==P?x>0?"down":"up":x>0?"right":"left";return function(q,nt,yt){let vt=q.selection,St=x>0?vt.$to:vt.$from,Nt=vt.empty;if(vt instanceof st.Bs){if(!yt.endOfTextblock(F)||0==St.depth)return!1;Nt=!1,St=q.doc.resolve(x>0?St.after():St.before())}let Ut=ot.findGapCursorFrom(St,x,Nt);return!!Ut&&(nt&&nt(q.tr.setSelection(new ot(Ut))),!0)}}function Z(P,x,F){if(!P||!P.editable)return!1;let q=P.state.doc.resolve(x);if(!ot.valid(q))return!1;let nt=P.posAtCoords({left:F.clientX,top:F.clientY});return!(nt&&nt.inside>-1&&st.qv.isSelectable(P.state.doc.nodeAt(nt.inside))||(P.dispatch(P.state.tr.setSelection(new ot(q))),0))}function at(P,x){if("insertCompositionText"!=x.inputType||!(P.state.selection instanceof ot))return!1;let{$from:F}=P.state.selection,q=F.parent.contentMatchAt(F.index()).findWrapping(P.state.schema.nodes.text);if(!q)return!1;let nt=ft.HY.empty;for(let vt=q.length-1;vt>=0;vt--)nt=ft.HY.from(q[vt].createAndFill(null,nt));let yt=P.state.tr.replace(F.pos,F.pos,new ft.p2(nt,0,0));return yt.setSelection(st.Bs.near(yt.doc.resolve(F.pos+1))),P.dispatch(yt),!1}function I(P){if(!(P.selection instanceof ot))return null;let x=document.createElement("div");return x.className="ProseMirror-gapcursor",gt.EH.create(P.doc,[gt.p.widget(P.selection.head,x,{key:"gapcursor"})])}const J=m.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new st.Sy({props:{decorations:I,createSelectionBetween:(P,x,F)=>x.pos==F.pos&&ot.valid(F)?new ot(F):null,handleClick:Z,handleKeyDown:E,handleDOMEvents:{beforeinput:at}}})],extendNodeSchema(P){var x;return{allowGapCursor:null!==(x=(0,m.callOrReturn)((0,m.getExtensionField)(P,"allowGapCursor",{name:P.name,options:P.options,storage:P.storage})))&&void 0!==x?x:null}}}),Q=m.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:P}){return["br",(0,m.mergeAttributes)(this.options.HTMLAttributes,P)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:P,chain:x,state:F,editor:q})=>P.first([()=>P.exitCode(),()=>P.command(()=>{const{selection:nt,storedMarks:yt}=F;if(nt.$from.parent.type.spec.isolating)return!1;const{keepMarks:vt}=this.options,{splittableMarks:St}=q.extensionManager,Nt=yt||nt.$to.parentOffset&&nt.$from.marks();return x().insertContent({type:this.name}).command(({tr:Ut,dispatch:Wt})=>{if(Wt&&Nt&&vt){const Ft=Nt.filter(Kt=>St.includes(Kt.type.name));Ut.ensureMarks(Ft)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Et=m.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(P=>({tag:`h${P}`,attrs:{level:P}}))},renderHTML({node:P,HTMLAttributes:x}){return[`h${this.options.levels.includes(P.attrs.level)?P.attrs.level:this.options.levels[0]}`,(0,m.mergeAttributes)(this.options.HTMLAttributes,x),0]},addCommands(){return{setHeading:P=>({commands:x})=>!!this.options.levels.includes(P.level)&&x.setNode(this.name,P),toggleHeading:P=>({commands:x})=>!!this.options.levels.includes(P.level)&&x.toggleNode(this.name,"paragraph",P)}},addKeyboardShortcuts(){return this.options.levels.reduce((P,x)=>fe(Lt({},P),{[`Mod-Alt-${x}`]:()=>this.editor.commands.toggleHeading({level:x})}),{})},addInputRules(){return this.options.levels.map(P=>(0,m.textblockTypeInputRule)({find:new RegExp(`^(#{1,${P}})\\s$`),type:this.type,getAttributes:{level:P}}))}});var It=function(){};It.prototype.append=function(x){return x.length?(x=It.from(x),!this.length&&x||x.length<200&&this.leafAppend(x)||this.length<200&&x.leafPrepend(this)||this.appendInner(x)):this},It.prototype.prepend=function(x){return x.length?It.from(x).append(this):this},It.prototype.appendInner=function(x){return new zt(this,x)},It.prototype.slice=function(x,F){return void 0===x&&(x=0),void 0===F&&(F=this.length),x>=F?It.empty:this.sliceInner(Math.max(0,x),Math.min(this.length,F))},It.prototype.get=function(x){if(!(x<0||x>=this.length))return this.getInner(x)},It.prototype.forEach=function(x,F,q){void 0===F&&(F=0),void 0===q&&(q=this.length),F<=q?this.forEachInner(x,F,q,0):this.forEachInvertedInner(x,F,q,0)},It.prototype.map=function(x,F,q){void 0===F&&(F=0),void 0===q&&(q=this.length);var nt=[];return this.forEach(function(yt,vt){return nt.push(x(yt,vt))},F,q),nt},It.from=function(x){return x instanceof It?x:x&&x.length?new Zt(x):It.empty};var Zt=function(P){function x(q){P.call(this),this.values=q}P&&(x.__proto__=P),(x.prototype=Object.create(P&&P.prototype)).constructor=x;var F={length:{configurable:!0},depth:{configurable:!0}};return x.prototype.flatten=function(){return this.values},x.prototype.sliceInner=function(nt,yt){return 0==nt&&yt==this.length?this:new x(this.values.slice(nt,yt))},x.prototype.getInner=function(nt){return this.values[nt]},x.prototype.forEachInner=function(nt,yt,vt,St){for(var Nt=yt;Nt<vt;Nt++)if(!1===nt(this.values[Nt],St+Nt))return!1},x.prototype.forEachInvertedInner=function(nt,yt,vt,St){for(var Nt=yt-1;Nt>=vt;Nt--)if(!1===nt(this.values[Nt],St+Nt))return!1},x.prototype.leafAppend=function(nt){if(this.length+nt.length<=200)return new x(this.values.concat(nt.flatten()))},x.prototype.leafPrepend=function(nt){if(this.length+nt.length<=200)return new x(nt.flatten().concat(this.values))},F.length.get=function(){return this.values.length},F.depth.get=function(){return 0},Object.defineProperties(x.prototype,F),x}(It);It.empty=new Zt([]);var zt=function(P){function x(F,q){P.call(this),this.left=F,this.right=q,this.length=F.length+q.length,this.depth=Math.max(F.depth,q.depth)+1}return P&&(x.__proto__=P),(x.prototype=Object.create(P&&P.prototype)).constructor=x,x.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},x.prototype.getInner=function(q){return q<this.left.length?this.left.get(q):this.right.get(q-this.left.length)},x.prototype.forEachInner=function(q,nt,yt,vt){var St=this.left.length;if(nt<St&&!1===this.left.forEachInner(q,nt,Math.min(yt,St),vt)||yt>St&&!1===this.right.forEachInner(q,Math.max(nt-St,0),Math.min(this.length,yt)-St,vt+St))return!1},x.prototype.forEachInvertedInner=function(q,nt,yt,vt){var St=this.left.length;if(nt>St&&!1===this.right.forEachInvertedInner(q,nt-St,Math.max(yt,St)-St,vt+St)||yt<St&&!1===this.left.forEachInvertedInner(q,Math.min(nt,St),yt,vt))return!1},x.prototype.sliceInner=function(q,nt){if(0==q&&nt==this.length)return this;var yt=this.left.length;return nt<=yt?this.left.slice(q,nt):q>=yt?this.right.slice(q-yt,nt-yt):this.left.slice(q,yt).append(this.right.slice(0,nt-yt))},x.prototype.leafAppend=function(q){var nt=this.right.leafAppend(q);if(nt)return new x(this.left,nt)},x.prototype.leafPrepend=function(q){var nt=this.left.leafPrepend(q);if(nt)return new x(nt,this.right)},x.prototype.appendInner=function(q){return this.left.depth>=Math.max(this.right.depth,q.depth)+1?new x(this.left,new x(this.right,q)):new x(this,q)},x}(It);const me=It;class jt{constructor(x,F){this.items=x,this.eventCount=F}popEvent(x,F){if(0==this.eventCount)return null;let nt,yt,q=this.items.length;for(;;q--)if(this.items.get(q-1).selection){--q;break}F&&(nt=this.remapping(q,this.items.length),yt=nt.maps.length);let St,Nt,vt=x.tr,Ut=[],Wt=[];return this.items.forEach((Ft,Kt)=>{if(!Ft.step)return nt||(nt=this.remapping(q,Kt+1),yt=nt.maps.length),yt--,void Wt.push(Ft);if(nt){Wt.push(new Vt(Ft.map));let qt,Qt=Ft.step.map(nt.slice(yt));Qt&&vt.maybeStep(Qt).doc&&(qt=vt.mapping.maps[vt.mapping.maps.length-1],Ut.push(new Vt(qt,void 0,void 0,Ut.length+Wt.length))),yt--,qt&&nt.appendMap(qt,yt)}else vt.maybeStep(Ft.step);return Ft.selection?(St=nt?Ft.selection.map(nt.slice(yt)):Ft.selection,Nt=new jt(this.items.slice(0,q).append(Wt.reverse().concat(Ut)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:Nt,transform:vt,selection:St}}addTransform(x,F,q,nt){let yt=[],vt=this.eventCount,St=this.items,Nt=!nt&&St.length?St.get(St.length-1):null;for(let Wt=0;Wt<x.steps.length;Wt++){let Qt,Ft=x.steps[Wt].invert(x.docs[Wt]),Kt=new Vt(x.mapping.maps[Wt],Ft,F);(Qt=Nt&&Nt.merge(Kt))&&(Kt=Qt,Wt?yt.pop():St=St.slice(0,St.length-1)),yt.push(Kt),F&&(vt++,F=void 0),nt||(Nt=Kt)}let Ut=vt-q.depth;return Ut>ee&&(St=function(P,x){let F;return P.forEach((q,nt)=>{if(q.selection&&0==x--)return F=nt,!1}),P.slice(F)}(St,Ut),vt-=Ut),new jt(St.append(yt),vt)}remapping(x,F){let q=new H.vs;return this.items.forEach((nt,yt)=>{q.appendMap(nt.map,null!=nt.mirrorOffset&&yt-nt.mirrorOffset>=x?q.maps.length-nt.mirrorOffset:void 0)},x,F),q}addMaps(x){return 0==this.eventCount?this:new jt(this.items.append(x.map(F=>new Vt(F))),this.eventCount)}rebased(x,F){if(!this.eventCount)return this;let q=[],nt=Math.max(0,this.items.length-F),yt=x.mapping,vt=x.steps.length,St=this.eventCount;this.items.forEach(Kt=>{Kt.selection&&St--},nt);let Nt=F;this.items.forEach(Kt=>{let Qt=yt.getMirror(--Nt);if(null==Qt)return;vt=Math.min(vt,Qt);let qt=yt.maps[Qt];if(Kt.step){let Se=x.steps[Qt].invert(x.docs[Qt]),be=Kt.selection&&Kt.selection.map(yt.slice(Nt+1,Qt));be&&St++,q.push(new Vt(qt,Se,be))}else q.push(new Vt(qt))},nt);let Ut=[];for(let Kt=F;Kt<vt;Kt++)Ut.push(new Vt(yt.maps[Kt]));let Wt=this.items.slice(0,nt).append(Ut).append(q),Ft=new jt(Wt,St);return Ft.emptyItemCount()>500&&(Ft=Ft.compress(this.items.length-q.length)),Ft}emptyItemCount(){let x=0;return this.items.forEach(F=>{F.step||x++}),x}compress(x=this.items.length){let F=this.remapping(0,x),q=F.maps.length,nt=[],yt=0;return this.items.forEach((vt,St)=>{if(St>=x)nt.push(vt),vt.selection&&yt++;else if(vt.step){let Nt=vt.step.map(F.slice(q)),Ut=Nt&&Nt.getMap();if(q--,Ut&&F.appendMap(Ut,q),Nt){let Wt=vt.selection&&vt.selection.map(F.slice(q));Wt&&yt++;let Kt,Ft=new Vt(Ut.invert(),Nt,Wt),Qt=nt.length-1;(Kt=nt.length&&nt[Qt].merge(Ft))?nt[Qt]=Kt:nt.push(Ft)}}else vt.map&&q--},this.items.length,0),new jt(me.from(nt.reverse()),yt)}}jt.empty=new jt(me.empty,0);class Vt{constructor(x,F,q,nt){this.map=x,this.step=F,this.selection=q,this.mirrorOffset=nt}merge(x){if(this.step&&x.step&&!x.selection){let F=x.step.merge(this.step);if(F)return new Vt(F.getMap().invert(),F,this.selection)}}}class Gt{constructor(x,F,q,nt){this.done=x,this.undone=F,this.prevRanges=q,this.prevTime=nt}}const ee=20;function Ee(P){let x=[];return P.forEach((F,q,nt,yt)=>x.push(nt,yt)),x}function _e(P,x){if(!P)return null;let F=[];for(let q=0;q<P.length;q+=2){let nt=x.map(P[q],1),yt=x.map(P[q+1],-1);nt<=yt&&F.push(nt,yt)}return F}function ne(P,x,F,q){let nt=he(x),yt=Jt.get(x).spec.config,vt=(q?P.undone:P.done).popEvent(x,nt);if(!vt)return;let St=vt.selection.resolve(vt.transform.doc),Nt=(q?P.done:P.undone).addTransform(vt.transform,x.selection.getBookmark(),yt,nt),Ut=new Gt(q?Nt:vt.remaining,q?vt.remaining:Nt,null,0);F(vt.transform.setSelection(St).setMeta(Jt,{redo:q,historyState:Ut}).scrollIntoView())}let re=!1,ve=null;function he(P){let x=P.plugins;if(ve!=x){re=!1,ve=x;for(let F=0;F<x.length;F++)if(x[F].spec.historyPreserveItems){re=!0;break}}return re}const Jt=new st.H$("history"),le=new st.H$("closeHistory");function U(P={}){return new st.Sy({key:Jt,state:{init:()=>new Gt(jt.empty,jt.empty,null,0),apply:(x,F,q)=>function(P,x,F,q){let yt,nt=F.getMeta(Jt);if(nt)return nt.historyState;F.getMeta(le)&&(P=new Gt(P.done,P.undone,null,0));let vt=F.getMeta("appendedTransaction");if(0==F.steps.length)return P;if(vt&&vt.getMeta(Jt))return vt.getMeta(Jt).redo?new Gt(P.done.addTransform(F,void 0,q,he(x)),P.undone,Ee(F.mapping.maps[F.steps.length-1]),P.prevTime):new Gt(P.done,P.undone.addTransform(F,void 0,q,he(x)),null,P.prevTime);if(!1===F.getMeta("addToHistory")||vt&&!1===vt.getMeta("addToHistory"))return(yt=F.getMeta("rebased"))?new Gt(P.done.rebased(F,yt),P.undone.rebased(F,yt),_e(P.prevRanges,F.mapping),P.prevTime):new Gt(P.done.addMaps(F.mapping.maps),P.undone.addMaps(F.mapping.maps),_e(P.prevRanges,F.mapping),P.prevTime);{let St=0==P.prevTime||!vt&&(P.prevTime<(F.time||0)-q.newGroupDelay||!function(P,x){if(!x)return!1;if(!P.docChanged)return!0;let F=!1;return P.mapping.maps[0].forEach((q,nt)=>{for(let yt=0;yt<x.length;yt+=2)q<=x[yt+1]&&nt>=x[yt]&&(F=!0)}),F}(F,P.prevRanges)),Nt=vt?_e(P.prevRanges,F.mapping):Ee(F.mapping.maps[F.steps.length-1]);return new Gt(P.done.addTransform(F,St?x.selection.getBookmark():void 0,q,he(x)),jt.empty,Nt,F.time)}}(F,q,x,P)},config:P={depth:P.depth||100,newGroupDelay:P.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(x,F){let q=F.inputType,nt="historyUndo"==q?_:"historyRedo"==q?C:null;return!!nt&&(F.preventDefault(),nt(x.state,x.dispatch))}}}})}const _=(P,x)=>{let F=Jt.getState(P);return!(!F||0==F.done.eventCount||(x&&ne(F,P,x,!1),0))},C=(P,x)=>{let F=Jt.getState(P);return!(!F||0==F.undone.eventCount||(x&&ne(F,P,x,!0),0))},B=m.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:P,dispatch:x})=>_(P,x),redo:()=>({state:P,dispatch:x})=>C(P,x)}),addProseMirrorPlugins(){return[U(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),A=m.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:P}){return["hr",(0,m.mergeAttributes)(this.options.HTMLAttributes,P)]},addCommands(){return{setHorizontalRule:()=>({chain:P})=>P().insertContent({type:this.name}).command(({tr:x,dispatch:F})=>{var q;if(F){const{$to:nt}=x.selection,yt=nt.end();if(nt.nodeAfter)x.setSelection(st.Bs.create(x.doc,nt.pos));else{const vt=null===(q=nt.parent.type.contentMatch.defaultType)||void 0===q?void 0:q.create();vt&&(x.insert(yt,vt),x.setSelection(st.Bs.create(x.doc,yt)))}x.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,m.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),V=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Ct=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,Dt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,kt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,wt=m.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:P=>"normal"!==P.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:P}){return["em",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{setItalic:()=>({commands:P})=>P.setMark(this.name),toggleItalic:()=>({commands:P})=>P.toggleMark(this.name),unsetItalic:()=>({commands:P})=>P.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,m.markInputRule)({find:V,type:this.type}),(0,m.markInputRule)({find:Dt,type:this.type})]},addPasteRules(){return[(0,m.markPasteRule)({find:Ct,type:this.type}),(0,m.markPasteRule)({find:kt,type:this.type})]}}),S=m.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:P}){return["li",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),l=/^(\d+)\.\s$/,d=m.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:P=>P.hasAttribute("start")?parseInt(P.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:P}){const q=P,{start:x}=q,F=Fo(q,["start"]);return 1===x?["ol",(0,m.mergeAttributes)(this.options.HTMLAttributes,F),0]:["ol",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{toggleOrderedList:()=>({commands:P})=>P.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[(0,m.wrappingInputRule)({find:l,type:this.type,getAttributes:P=>({start:+P[1]}),joinPredicate:(P,x)=>x.childCount+x.attrs.start===+P[1]})]}}),f=m.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:P}){return["p",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{setParagraph:()=>({commands:P})=>P.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),v=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,O=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,N=m.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:P=>!!P.includes("line-through")&&{}}],renderHTML({HTMLAttributes:P}){return["s",(0,m.mergeAttributes)(this.options.HTMLAttributes,P),0]},addCommands(){return{setStrike:()=>({commands:P})=>P.setMark(this.name),toggleStrike:()=>({commands:P})=>P.toggleMark(this.name),unsetStrike:()=>({commands:P})=>P.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,m.markInputRule)({find:v,type:this.type})]},addPasteRules(){return[(0,m.markPasteRule)({find:O,type:this.type})]}}),lt=m.Node.create({name:"text",group:"inline"}),Tt=m.Extension.create({name:"starterKit",addExtensions(){var P,x,F,q,nt,yt,vt,St,Nt,Ut,Wt,Ft,Kt,Qt,qt,Se,be,He,Ze,tn,en,$e,Ye,Ue,De,ke,nn,ye,te,Ve,Re,Pe,Le,we,ue,Be;const $t=[];return!1!==(null===(P=this.options)||void 0===P?void 0:P.blockquote)&&$t.push(k.configure(null===(x=this.options)||void 0===x?void 0:x.blockquote)),!1!==(null===(F=this.options)||void 0===F?void 0:F.bold)&&$t.push(X.configure(null===(q=this.options)||void 0===q?void 0:q.bold)),!1!==(null===(nt=this.options)||void 0===nt?void 0:nt.bulletList)&&$t.push(rt.configure(null===(yt=this.options)||void 0===yt?void 0:yt.bulletList)),!1!==(null===(vt=this.options)||void 0===vt?void 0:vt.code)&&$t.push(et.configure(null===(St=this.options)||void 0===St?void 0:St.code)),!1!==(null===(Nt=this.options)||void 0===Nt?void 0:Nt.codeBlock)&&$t.push(_t.configure(null===(Ut=this.options)||void 0===Ut?void 0:Ut.codeBlock)),!1!==(null===(Wt=this.options)||void 0===Wt?void 0:Wt.document)&&$t.push(K.configure(null===(Ft=this.options)||void 0===Ft?void 0:Ft.document)),!1!==(null===(Kt=this.options)||void 0===Kt?void 0:Kt.dropcursor)&&$t.push(dt.configure(null===(Qt=this.options)||void 0===Qt?void 0:Qt.dropcursor)),!1!==(null===(qt=this.options)||void 0===qt?void 0:qt.gapcursor)&&$t.push(J.configure(null===(Se=this.options)||void 0===Se?void 0:Se.gapcursor)),!1!==(null===(be=this.options)||void 0===be?void 0:be.hardBreak)&&$t.push(Q.configure(null===(He=this.options)||void 0===He?void 0:He.hardBreak)),!1!==(null===(Ze=this.options)||void 0===Ze?void 0:Ze.heading)&&$t.push(Et.configure(null===(tn=this.options)||void 0===tn?void 0:tn.heading)),!1!==(null===(en=this.options)||void 0===en?void 0:en.history)&&$t.push(B.configure(null===($e=this.options)||void 0===$e?void 0:$e.history)),!1!==(null===(Ye=this.options)||void 0===Ye?void 0:Ye.horizontalRule)&&$t.push(A.configure(null===(Ue=this.options)||void 0===Ue?void 0:Ue.horizontalRule)),!1!==(null===(De=this.options)||void 0===De?void 0:De.italic)&&$t.push(wt.configure(null===(ke=this.options)||void 0===ke?void 0:ke.italic)),!1!==(null===(nn=this.options)||void 0===nn?void 0:nn.listItem)&&$t.push(S.configure(null===(ye=this.options)||void 0===ye?void 0:ye.listItem)),!1!==(null===(te=this.options)||void 0===te?void 0:te.orderedList)&&$t.push(d.configure(null===(Ve=this.options)||void 0===Ve?void 0:Ve.orderedList)),!1!==(null===(Re=this.options)||void 0===Re?void 0:Re.paragraph)&&$t.push(f.configure(null===(Pe=this.options)||void 0===Pe?void 0:Pe.paragraph)),!1!==(null===(Le=this.options)||void 0===Le?void 0:Le.strike)&&$t.push(N.configure(null===(we=this.options)||void 0===we?void 0:we.strike)),!1!==(null===(ue=this.options)||void 0===ue?void 0:ue.text)&&$t.push(lt.configure(null===(Be=this.options)||void 0===Be?void 0:Be.text)),$t}})},51919:(Pt,ct,c)=>{c.r(ct),c.d(ct,{TableCellBackground:()=>s});const s=c(40256).Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:k})=>k?{style:`background: ${k}`}:null,parseHTML:({style:k})=>k.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:k=>({chain:M})=>M().updateAttributes("tableCell",{background:k}).updateAttributes("tableHeader",{background:k}).run(),unsetCellBackground:()=>({chain:k})=>k().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})})},88806:(Pt,ct,c)=>{c.d(ct,{v:()=>s});var m=c(74788);class s{constructor(M,h,j){const y=h.get(m.z2F),$=h.get(m._Vd).resolveComponentFactory(M);this.componentRef=$.create(h,[]),this.updateProps(j),y.attachView(this.componentRef.hostView)}get instance(){return this.componentRef.instance}get elementRef(){return this.componentRef.injector.get(m.SBq)}get dom(){return this.elementRef.nativeElement}updateProps(M){Object.entries(M).forEach(([h,j])=>{this.instance[h]=j})}detectChanges(){this.componentRef.changeDetectorRef.detectChanges()}destroy(){this.componentRef.destroy()}}},40400:(Pt,ct,c)=>{c.d(ct,{d:()=>M,x:()=>j});var m=c(12057),s=c(40256),k=c(88806);class M{}class h extends s.NodeView{constructor(){super(...arguments),this.contentDOMElement=null}mount(){const X=this.options.injector,$=X.get(m.K0);this.renderer=new k.v(this.component,X,{editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(G={})=>this.updateAttributes(G),deleteNode:()=>this.deleteNode()}),this.extension.config.draggable&&(this.renderer.elementRef.nativeElement.ondragstart=G=>{this.onDragStart(G)}),this.contentDOMElement=this.node.isLeaf?null:$.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit",this.renderer.detectChanges())}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}update(X,$){return this.options.update?this.options.update(X,$):X.type===this.node.type&&(X===this.node&&this.decorations===$||(this.node=X,this.decorations=$,this.renderer.updateProps({node:X,decorations:$}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy()}maybeMoveContentDOM(){const X=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&X&&!X.contains(this.contentDOMElement)&&X.appendChild(this.contentDOMElement)}}const j=(y,X)=>$=>new h(y,$,X)},70224:(Pt,ct,c)=>{c.r(ct),c.d(ct,{BackgroundColor:()=>dt.BackgroundColor,EDITOR_BLANK_COLOR:()=>Y.hK,FontColor:()=>ft.FontColor,INITIALIZATION_TIPTAP_CONTAINER:()=>Z.Y1,LAZY_EDITOR_EXTENSIONS:()=>Z.F4,LAZY_TIPTAP_EDITOR:()=>Z.bG,StarterKit:()=>Bt.StarterKit,TIPTAP_EDITOR:()=>Z.ZW,TUI_EDITOR_CODE_OPTIONS:()=>Z.Mr,TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES:()=>Z.dj,TUI_EDITOR_CONTENT_PROCESSOR:()=>Z.F1,TUI_EDITOR_DEFAULT_OPTIONS:()=>Z.HG,TUI_EDITOR_EXTENSIONS:()=>Z.Wf,TUI_EDITOR_FONT_OPTIONS:()=>Z.UN,TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>ot.TUI_EDITOR_GROUP_DEFAULT_OPTIONS,TUI_EDITOR_MAX_IMAGE_WIDTH:()=>xt.TUI_EDITOR_MAX_IMAGE_WIDTH,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>xt.TUI_EDITOR_MIN_IMAGE_WIDTH,TUI_EDITOR_OPTIONS:()=>Z.mJ,TUI_EDITOR_PROVIDERS:()=>et.m,TUI_EDITOR_TABLE_COMMANDS:()=>Z.$i,TUI_EDITOR_TOOLBAR_TEXTS:()=>Z.rf,TUI_IMAGE_LOADER:()=>Z.p7,TableCellBackground:()=>tt.TableCellBackground,TuiAlignContentComponent:()=>H.Xp,TuiAlignContentModule:()=>H.pu,TuiCodeComponent:()=>H.Tf,TuiCodeModule:()=>H.P_,TuiColorEditComponent:()=>m.hR,TuiColorEditModule:()=>m.TD,TuiColorPickerComponent:()=>m.$v,TuiColorPickerModule:()=>m.H9,TuiColorSelectorComponent:()=>m.sV,TuiColorSelectorModule:()=>m.wl,TuiComponentRenderer:()=>E.v,TuiDetailsComponent:()=>H.yj,TuiDetailsModule:()=>H.y9,TuiDetailsRemoveComponent:()=>H.Un,TuiEditLinkComponent:()=>s.l,TuiEditLinkModule:()=>s.F,TuiEditorComponent:()=>k.a,TuiEditorGroupToolComponent:()=>H.dN,TuiEditorImagePreviewDirective:()=>$.Zj,TuiEditorImagePreviewModule:()=>$.BN,TuiEditorModule:()=>ut,TuiEditorPortalDirective:()=>st.A,TuiEditorPortalHostComponent:()=>ht.d,TuiEditorPortalService:()=>Mt.Y,TuiEditorSocketComponent:()=>h.D,TuiEditorSocketModule:()=>y,TuiEditorTool:()=>L._,TuiEditorToolGroup:()=>H.jP,TuiFlatPickerComponent:()=>m.Jd,TuiFlatPickerModule:()=>m.ui,TuiFontSize:()=>gt.TuiFontSize,TuiFontSizeComponent:()=>H.mK,TuiFontSizeModule:()=>H.p7,TuiFontStyleComponent:()=>H.hr,TuiFontStyleModule:()=>H.Zv,TuiHighlightColorComponent:()=>H.UT,TuiHighlightColorModule:()=>H.XC,TuiImageEditorComponent:()=>xt.TuiImageEditorComponent,TuiImageEditorModule:()=>xt.TuiImageEditorModule,TuiInputColorComponent:()=>_t.j,TuiInputColorModule:()=>K,TuiLinearMultiPickerComponent:()=>m.es,TuiLinearMultiPickerModule:()=>m.GU,TuiLinearPickerComponent:()=>m.P,TuiLinearPickerModule:()=>m.g7,TuiListConfigsComponent:()=>H.w2,TuiListConfigsModule:()=>H.Ur,TuiNodeViewNgComponent:()=>z.d,TuiNodeViewRenderer:()=>z.x,TuiPaletteComponent:()=>m.Rh,TuiPaletteModule:()=>m.VM,TuiTabExtension:()=>bt.TuiTabExtension,TuiTableCellColorComponent:()=>H.pH,TuiTableCellColorModule:()=>H.mp,TuiTableCommands:()=>H.iN,TuiTableCreateComponent:()=>H.lT,TuiTableCreateModule:()=>H.iA,TuiTableMergeCellsComponent:()=>H.YH,TuiTableMergeCellsModule:()=>H.er,TuiTableRowColumnManagerComponent:()=>H._I,TuiTableRowColumnManagerModule:()=>H.__,TuiTableSizeSelectorComponent:()=>H.M8,TuiTableSizeSelectorModule:()=>H.kU,TuiTextColorComponent:()=>H.G0,TuiTextColorModule:()=>H._t,TuiTiptapEditorDirective:()=>$.JU,TuiTiptapEditorModule:()=>$.mJ,TuiTiptapEditorService:()=>$.$3,TuiToolbarComponent:()=>X.M6,TuiToolbarModule:()=>X.yB,TuiToolbarNavigationManagerDirective:()=>X.Bp,createGroupExtension:()=>ot.createGroupExtension,createImageEditorExtension:()=>xt.createImageEditorExtension,defaultEditorColors:()=>Y.sw,defaultEditorExtensions:()=>pt,defaultEditorTools:()=>Y.Db,tuiDefaultFontOptionsHandler:()=>Y.RR,tuiDeleteNode:()=>at.yU,tuiEditorOptionsProvider:()=>Z.Uv,tuiGetElementPoint:()=>at.Ws,tuiGetGradientData:()=>at.U5,tuiGetMarkRange:()=>at.Yz,tuiGetSelectedContent:()=>at.Ap,tuiInsertHtml:()=>at.Xd,tuiInsertText:()=>at.Oi,tuiIsOrderedOrBulletList:()=>bt.tuiIsOrderedOrBulletList,tuiIsSafeLinkRange:()=>at.nC,tuiIsSelectionIn:()=>at.i0,tuiLegacyEditorConverter:()=>at.Er,tuiParseGradient:()=>at._N,tuiToGradient:()=>at.CH});var m=c(27050),s=c(71115),k=c(69303),M=c(12057),h=c(20179),j=c(74788);let y=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=j.oAB({type:I}),I.\u0275inj=j.cJS({}),I})();var X=c(17406),$=c(40632),rt=c(36692),G=c(90987);let ut=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=j.oAB({type:I}),I.\u0275inj=j.cJS({imports:[[M.ez,X.yB,G.TuiWrapperModule,G.TuiScrollbarModule,s.F,rt.TuiActiveZoneModule,G.TuiDropdownModule,$.mJ,y,rt.TuiLetModule]]}),I})();var et=c(79089),st=c(1433),Mt=c(73825),ht=c(9872),_t=c(19769);let K=(()=>{class I{}return I.\u0275fac=function(Q){return new(Q||I)},I.\u0275mod=j.oAB({type:I}),I.\u0275inj=j.cJS({imports:[[M.ez,G.TuiPrimitiveTextfieldModule,G.TuiTextfieldControllerModule,G.TuiHostedDropdownModule,m.wl,rt.TuiActiveZoneModule]]}),I})();var H=c(93252),Y=c(19074),L=c(48699),dt=c(15736);const pt=[Promise.resolve().then(c.bind(c,75276)).then(({StarterKit:I})=>I).then(I=>I.configure({heading:{levels:[1,2]}})),c.e(45861).then(c.bind(c,45861)).then(({default:I})=>I.configure({types:["heading","paragraph"]})),Promise.resolve().then(c.bind(c,74634)).then(({default:I})=>I),c.e(77008).then(c.bind(c,77008)).then(({default:I})=>I),c.e(91347).then(c.bind(c,91347)).then(({default:I})=>I),c.e(35609).then(c.bind(c,35609)).then(({default:I})=>I),Promise.resolve().then(c.bind(c,52658)).then(({FontColor:I})=>I),c.e(12955).then(c.bind(c,12955)).then(({default:I})=>I.configure({inline:!0})),c.e(63658).then(c.bind(c,63658)).then(({default:I})=>I.configure({openOnClick:!1})),Promise.resolve().then(c.bind(c,15736)).then(({BackgroundColor:I})=>I),c.e(88729).then(c.bind(c,88729)).then(({default:I})=>I.configure({resizable:!0,lastColumnResizable:!1})),c.e(72219).then(c.bind(c,72219)).then(({default:I})=>I),c.e(74096).then(c.bind(c,74096)).then(({default:I})=>I),c.e(53107).then(c.bind(c,53107)).then(({TableHeader:I})=>I),Promise.resolve().then(c.bind(c,12177)).then(({TuiTabExtension:I})=>I),Promise.resolve().then(c.bind(c,51919)).then(({TableCellBackground:I})=>I),c.e(44312).then(c.bind(c,44312)).then(({TuiDetailsContent:I})=>I),c.e(44312).then(c.bind(c,44312)).then(({TuiDetails:I})=>I),c.e(44312).then(c.bind(c,44312)).then(({TuiSummary:I})=>I),Promise.resolve().then(c.bind(c,9492)).then(({TuiFontSize:I})=>I)];var ft=c(52658),gt=c(9492),ot=c(54920),xt=c(25039),bt=c(12177),Bt=c(75276),tt=c(51919),E=c(88806),z=c(40400),Z=c(62842),at=c(37631)},62141:(Pt,ct,c)=>{c.d(ct,{i:()=>rt});var m=c(12057),s=c(74788),k=c(37631),M=c(36692),h=c(18891),j=c(43190),y=c(88002),X=c(46782),$=c(39761);let rt=(()=>{class G extends h.y{constructor(et,{nativeElement:st},Mt){const ht=(0,M.tuiTypedFromEvent)(st,"mousedown").pipe((0,M.tuiPreventDefault)(),(0,j.w)(_t=>{const K=(0,M.tuiTypedFromEvent)(Mt,"mousemove").pipe((0,y.U)(({clientX:H,clientY:Y})=>(0,k.Ws)(H,Y,st)),(0,X.R)((0,M.tuiTypedFromEvent)(Mt,"mouseup")));return _t.target===st?K.pipe((0,$.O)((0,k.Ws)(_t.clientX,_t.clientY,st))):K}),(0,X.R)(et));super(_t=>ht.subscribe(_t))}}return G.\u0275fac=function(et){return new(et||G)(s.LFG(M.TuiDestroyService),s.LFG(s.SBq),s.LFG(m.K0))},G.\u0275prov=s.Yz7({token:G,factory:G.\u0275fac}),G})()},62842:(Pt,ct,c)=>{c.d(ct,{Y1:()=>dt,F4:()=>k,bG:()=>L,ZW:()=>Y,Mr:()=>st,dj:()=>G,F1:()=>$,HG:()=>h,Wf:()=>s,UN:()=>Mt,mJ:()=>j,$i:()=>et,rf:()=>ut,p7:()=>K,Uv:()=>y});var m=c(74788);const s=new m.OlP("[TUI_EDITOR_EXTENSIONS]: Extensions for editor"),k=new m.OlP("[LAZY_EDITOR_EXTENSIONS]: lazy extensions");var M=c(19074);const h={colors:M.sw,blankColor:M.hK,fontOptions:M.RR},j=new m.OlP("[TUI_EDITOR_OPTIONS]: Default Editor colors",{factory:()=>h});function y(pt){return{provide:j,useValue:Object.assign(Object.assign({},h),pt)}}var X=c(54487);const $=new m.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]: Content value processor for tui-editor",{factory:()=>X.y});var rt=c(72773);const G=new m.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]: tui-color-selector i18n",{factory:()=>["Solid color","Gradient"]}),ut=new m.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]: tui-editor-toolbar i18n",{factory:(0,rt.vv)("toolbarTools")}),et=new m.OlP("[TUI_EDITOR_TABLE_COMMANDS]: tui-editor-toolbar table i18n",{factory:(0,rt.vv)("editorTableCommands")}),st=new m.OlP("[TUI_EDITOR_CODE_OPTIONS]: tui-editor-toolbar codes options",{factory:(0,rt.vv)("editorCodeOptions")}),Mt=new m.OlP("[TUI_EDITOR_FONT_OPTIONS]: tui-editor-toolbar font options",{factory:(0,rt.vv)("editorFontOptions")});var ht=c(36692),_t=c(88002);const K=new m.OlP("[TUI_IMAGE_LOADER]: Image loader handler",{factory:()=>pt=>{const ft=new FileReader;return ft.readAsDataURL(pt),(0,ht.tuiTypedFromEvent)(ft,"load").pipe((0,_t.U)(()=>String(ft.result)))}});var H=c(82298);const Y=new m.OlP("[TIPTAP_EDITOR]: Token for Tiptap Editor"),L=new m.OlP("[LAZY_TIPTAP_EDITOR]: Lazy loaded Editor",{factory:()=>{const pt=new H.t(1);return Promise.resolve().then(c.bind(c,40256)).then(ft=>pt.next(ft.Editor)),pt}}),dt=new m.OlP("[INITIALIZATION_TIPTAP_CONTAINER]: The container in which the tip-tap editor is initialized")},37631:(Pt,ct,c)=>{function m(tt,E,z){const Z=tt.selection.$anchor;for(let at=Z.depth;at>0;at--)if(Z.node(at).type.name===z)return E&&E(tt.tr.delete(Z.before(at),Z.after(at)).scrollIntoView()),!0;return!1}c.d(ct,{yU:()=>m,Ws:()=>k,U5:()=>M,Yz:()=>y,Ap:()=>$,Xd:()=>rt,Oi:()=>G,nC:()=>bt,i0:()=>ut,Er:()=>et,_N:()=>ot,CH:()=>Bt});var s=c(36692);function k(tt,E,z){const{left:Z,top:at,width:I,height:J}=z.getBoundingClientRect();return[(0,s.tuiClamp)(tt-Z,0,I)/I,(0,s.tuiClamp)(E-at,0,J)/J]}function M(tt){return tt.slice(0,Math.max(0,tt.length-1)).replace("linear-gradient(","")}function j(tt,E,z={}){return tt.find(({attrs:Z,type:at})=>at===E&&function(tt,E){const z=Object.keys(E);return!z.length||!!z.filter(Z=>E[Z]===tt[Z]).length}(Z,z))||null}function y(tt,E,z={}){if(!tt||!E)return null;const{node:Z,offset:at}=tt.parent.childAfter(tt.parentOffset);if(!Z)return null;const I=j(Z.marks,E,z);if(!I)return null;let J=tt.index(),Q=tt.start()+at,Et=J+1,At=Q+Z.nodeSize;for(j(Z.marks,E,z);J>0&&I.isInSet(tt.parent.child(J-1).marks);)J-=1,Q-=tt.parent.child(J).nodeSize;for(;Et<tt.parent.childCount&&j(tt.parent.child(Et).marks,E,z);)At+=tt.parent.child(Et).nodeSize,Et+=1;return{from:Q,to:At}}var X=c(40256);function $(tt,E){const z=null!=E?E:tt.selection.$head.parent.textContent,Z=tt.doc.cut(tt.selection.from,tt.selection.to);return Z.content.size?(0,X.getHTMLFromFragment)(Z.content,tt.schema):z}function rt(tt,E){if(tt.queryCommandSupported("insertHTML"))return void tt.execCommand("insertHTML",!1,E);const z=tt.getSelection();if(!z)throw new s.TuiDocumentSelectionException;tt.execCommand("ms-beginUndoUnit");const Z=z.getRangeAt(0),at=Z.createContextualFragment(E);Z.deleteContents(),Z.insertNode(at),tt.execCommand("ms-endUndoUnit")}function G(tt,E){if(tt.queryCommandSupported("insertText"))return void tt.execCommand("insertText",!1,E);const z=tt.getSelection();if(!z)throw new s.TuiDocumentSelectionException;tt.execCommand("ms-beginUndoUnit");const Z=z.getRangeAt(0);Z.deleteContents(),Z.insertNode(tt.createTextNode(E)),tt.execCommand("ms-endUndoUnit")}function ut({anchorNode:tt,focusNode:E},z){return!!tt&&!!E&&(0,s.tuiIsNodeIn)(tt,z)&&(0,s.tuiIsNodeIn)(E,z)}function et(tt){const E=(new DOMParser).parseFromString(tt,"text/html");return st(E.body),E.body.innerHTML}function st(tt){for(const E of Array.from(tt.children))if(E.children.length&&st(E),"FONT"===E.tagName)if(E.hasAttribute("size"))switch(E.getAttribute("size")){case"6":Mt("h1",E);break;case"5":Mt("h2",E);break;case"4":ht("17px",E);break;case"3":ht("15px",E);break;case"2":ht("13px",E)}else E.hasAttribute("color")&&_t(E)}function Mt(tt,E){var z,Z,at,I,J,Q,Et,At,It;const Zt=document.createElement(tt);if(Zt.innerHTML=E.innerHTML,"P"===(null===(z=E.parentElement)||void 0===z?void 0:z.tagName)){const zt=null===(at=null===(Z=E.parentElement)||void 0===Z?void 0:Z.parentElement)||void 0===at?void 0:at.insertBefore(Zt,E.parentElement);null===(I=E.parentElement)||void 0===I||I.removeChild(E),(null==zt?void 0:zt.nextSibling)&&!(null===(Q=null===(J=null==zt?void 0:zt.nextSibling)||void 0===J?void 0:J.textContent)||void 0===Q?void 0:Q.trim())&&(null===(At=null===(Et=zt.nextSibling)||void 0===Et?void 0:Et.parentElement)||void 0===At||At.removeChild(zt.nextSibling))}else null===(It=E.parentElement)||void 0===It||It.replaceChild(Zt,E)}function ht(tt,E){var z;const Z=document.createElement("p"),at=document.createElement("span");at.setAttribute("style",`font-size: ${tt}`),at.innerHTML=E.innerHTML,Z.append(at),null===(z=E.parentElement)||void 0===z||z.replaceChild("P"===E.parentElement.tagName?at:Z,E)}function _t(tt){var E;const z=document.createElement("span");z.setAttribute("style",`color: ${tt.getAttribute("color")}`),z.innerHTML=tt.innerHTML,null===(E=tt.parentElement)||void 0===E||E.replaceChild(z,tt)}const gt=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function ot(tt){const E=new RegExp(gt.join(""),"gi"),z=tt.startsWith("to")||tt.match(/^\d/)?tt.slice(Math.max(0,tt.indexOf(",")+1)).trim():tt,Z=tt.startsWith("to")?tt.split(",")[0]:"to bottom";let at=[],I=E.exec(z);for(;null!==I;)at=at.concat({color:I[1],position:xt(I[2],at.length)}),I=E.exec(z);return at=at.filter(({color:J})=>J.startsWith("#")||J.startsWith("rgb")),{stops:at,side:Z}}function xt(tt,E){const z=1===E?"100%":`${E}%`;return(null==tt?void 0:tt.includes("%"))?tt:z}function bt(tt){var E;return tt.endOffset-tt.startOffset>0||0!==tt.startOffset&&tt.endOffset!==((null===(E=tt.endContainer.nodeValue)||void 0===E?void 0:E.length)||0)}function Bt({stops:tt,side:E}){return`linear-gradient(${E}, ${tt.map(({color:z,position:Z})=>`rgba(${(0,s.tuiParseColor)(z).join(", ")}) ${Z}`).join(", ")})`}},13903:(Pt,ct,c)=>{c.d(ct,{$:()=>_t,h:()=>ht});for(var m={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},k="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),h=("undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)),j="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),y=h||k&&+k[1]<57,X=0;X<10;X++)m[48+X]=m[96+X]=String(X);for(X=1;X<=24;X++)m[X+111]="F"+X;for(X=65;X<=90;X++)m[X]=String.fromCharCode(X+32),s[X]=String.fromCharCode(X);for(var $ in m)s.hasOwnProperty($)||(s[$]=m[$]);var G=c(62463);const ut="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function et(K){let L,dt,pt,ft,H=K.split(/-(?!$)/),Y=H[H.length-1];"Space"==Y&&(Y=" ");for(let gt=0;gt<H.length-1;gt++){let ot=H[gt];if(/^(cmd|meta|m)$/i.test(ot))ft=!0;else if(/^a(lt)?$/i.test(ot))L=!0;else if(/^(c|ctrl|control)$/i.test(ot))dt=!0;else if(/^s(hift)?$/i.test(ot))pt=!0;else{if(!/^mod$/i.test(ot))throw new Error("Unrecognized modifier name: "+ot);ut?ft=!0:dt=!0}}return L&&(Y="Alt-"+Y),dt&&(Y="Ctrl-"+Y),ft&&(Y="Meta-"+Y),pt&&(Y="Shift-"+Y),Y}function Mt(K,H,Y){return H.altKey&&(K="Alt-"+K),H.ctrlKey&&(K="Ctrl-"+K),H.metaKey&&(K="Meta-"+K),!1!==Y&&H.shiftKey&&(K="Shift-"+K),K}function ht(K){return new G.Sy({props:{handleKeyDown:_t(K)}})}function _t(K){let H=function(K){let H=Object.create(null);for(let Y in K)H[et(Y)]=K[Y];return H}(K);return function(Y,L){let ft,dt=function(K){var Y=!(y&&(K.ctrlKey||K.altKey||K.metaKey)||j&&K.shiftKey&&K.key&&1==K.key.length||"Unidentified"==K.key)&&K.key||(K.shiftKey?s:m)[K.keyCode]||K.key||"Unidentified";return"Esc"==Y&&(Y="Escape"),"Del"==Y&&(Y="Delete"),"Left"==Y&&(Y="ArrowLeft"),"Up"==Y&&(Y="ArrowUp"),"Right"==Y&&(Y="ArrowRight"),"Down"==Y&&(Y="ArrowDown"),Y}(L),pt=1==dt.length&&" "!=dt,gt=H[Mt(dt,L,!pt)];if(gt&&gt(Y.state,Y.dispatch,Y))return!0;if(pt&&(L.shiftKey||L.altKey||L.metaKey||dt.charCodeAt(0)>127)&&(ft=m[L.keyCode])&&ft!=dt){let ot=H[Mt(ft,L,!0)];if(ot&&ot(Y.state,Y.dispatch,Y))return!0}else if(pt&&L.shiftKey){let ot=H[Mt(dt,L,!0)];if(ot&&ot(Y.state,Y.dispatch,Y))return!0}return!1}}},35917:(Pt,ct,c)=>{function m(S){this.content=S}c.d(ct,{aw:()=>ne,PW:()=>Dt,HY:()=>h,vc:()=>$,ZU:()=>Xt,NB:()=>tt,Ts:()=>bt,e4:()=>rt,V_:()=>Ee,p2:()=>G}),m.prototype={constructor:m,find:function(S){for(var l=0;l<this.content.length;l+=2)if(this.content[l]===S)return l;return-1},get:function(S){var l=this.find(S);return-1==l?void 0:this.content[l+1]},update:function(S,l,d){var f=d&&d!=S?this.remove(d):this,v=f.find(S),O=f.content.slice();return-1==v?O.push(d||S,l):(O[v+1]=l,d&&(O[v]=d)),new m(O)},remove:function(S){var l=this.find(S);if(-1==l)return this;var d=this.content.slice();return d.splice(l,2),new m(d)},addToStart:function(S,l){return new m([S,l].concat(this.remove(S).content))},addToEnd:function(S,l){var d=this.remove(S).content.slice();return d.push(S,l),new m(d)},addBefore:function(S,l,d){var f=this.remove(l),v=f.content.slice(),O=f.find(S);return v.splice(-1==O?v.length:O,0,l,d),new m(v)},forEach:function(S){for(var l=0;l<this.content.length;l+=2)S(this.content[l],this.content[l+1])},prepend:function(S){return(S=m.from(S)).size?new m(S.content.concat(this.subtract(S).content)):this},append:function(S){return(S=m.from(S)).size?new m(this.subtract(S).content.concat(S.content)):this},subtract:function(S){var l=this;S=m.from(S);for(var d=0;d<S.content.length;d+=2)l=l.remove(S.content[d]);return l},get size(){return this.content.length>>1}},m.from=function(S){if(S instanceof m)return S;var l=[];if(S)for(var d in S)l.push(d,S[d]);return new m(l)};const s=m;function k(S,l,d){for(let f=0;;f++){if(f==S.childCount||f==l.childCount)return S.childCount==l.childCount?null:d;let v=S.child(f),O=l.child(f);if(v!=O){if(!v.sameMarkup(O))return d;if(v.isText&&v.text!=O.text){for(let N=0;v.text[N]==O.text[N];N++)d++;return d}if(v.content.size||O.content.size){let N=k(v.content,O.content,d+1);if(null!=N)return N}d+=v.nodeSize}else d+=v.nodeSize}}function M(S,l,d,f){for(let v=S.childCount,O=l.childCount;;){if(0==v||0==O)return v==O?null:{a:d,b:f};let N=S.child(--v),lt=l.child(--O),Tt=N.nodeSize;if(N!=lt){if(!N.sameMarkup(lt))return{a:d,b:f};if(N.isText&&N.text!=lt.text){let P=0,x=Math.min(N.text.length,lt.text.length);for(;P<x&&N.text[N.text.length-P-1]==lt.text[lt.text.length-P-1];)P++,d--,f--;return{a:d,b:f}}if(N.content.size||lt.content.size){let P=M(N.content,lt.content,d-1,f-1);if(P)return P}d-=Tt,f-=Tt}else d-=Tt,f-=Tt}}class h{constructor(l,d){if(this.content=l,this.size=d||0,null==d)for(let f=0;f<l.length;f++)this.size+=l[f].nodeSize}nodesBetween(l,d,f,v=0,O){for(let N=0,lt=0;lt<d;N++){let Tt=this.content[N],P=lt+Tt.nodeSize;if(P>l&&!1!==f(Tt,v+lt,O||null,N)&&Tt.content.size){let x=lt+1;Tt.nodesBetween(Math.max(0,l-x),Math.min(Tt.content.size,d-x),f,v+x)}lt=P}}descendants(l){this.nodesBetween(0,this.size,l)}textBetween(l,d,f,v){let O="",N=!0;return this.nodesBetween(l,d,(lt,Tt)=>{lt.isText?(O+=lt.text.slice(Math.max(l,Tt)-Tt,d-Tt),N=!f):lt.isLeaf?(v?O+="function"==typeof v?v(lt):v:lt.type.spec.leafText&&(O+=lt.type.spec.leafText(lt)),N=!f):!N&&lt.isBlock&&(O+=f,N=!0)},0),O}append(l){if(!l.size)return this;if(!this.size)return l;let d=this.lastChild,f=l.firstChild,v=this.content.slice(),O=0;for(d.isText&&d.sameMarkup(f)&&(v[v.length-1]=d.withText(d.text+f.text),O=1);O<l.content.length;O++)v.push(l.content[O]);return new h(v,this.size+l.size)}cut(l,d=this.size){if(0==l&&d==this.size)return this;let f=[],v=0;if(d>l)for(let O=0,N=0;N<d;O++){let lt=this.content[O],Tt=N+lt.nodeSize;Tt>l&&((N<l||Tt>d)&&(lt=lt.isText?lt.cut(Math.max(0,l-N),Math.min(lt.text.length,d-N)):lt.cut(Math.max(0,l-N-1),Math.min(lt.content.size,d-N-1))),f.push(lt),v+=lt.nodeSize),N=Tt}return new h(f,v)}cutByIndex(l,d){return l==d?h.empty:0==l&&d==this.content.length?this:new h(this.content.slice(l,d))}replaceChild(l,d){let f=this.content[l];if(f==d)return this;let v=this.content.slice(),O=this.size+d.nodeSize-f.nodeSize;return v[l]=d,new h(v,O)}addToStart(l){return new h([l].concat(this.content),this.size+l.nodeSize)}addToEnd(l){return new h(this.content.concat(l),this.size+l.nodeSize)}eq(l){if(this.content.length!=l.content.length)return!1;for(let d=0;d<this.content.length;d++)if(!this.content[d].eq(l.content[d]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(l){let d=this.content[l];if(!d)throw new RangeError("Index "+l+" out of range for "+this);return d}maybeChild(l){return this.content[l]||null}forEach(l){for(let d=0,f=0;d<this.content.length;d++){let v=this.content[d];l(v,f,d),f+=v.nodeSize}}findDiffStart(l,d=0){return k(this,l,d)}findDiffEnd(l,d=this.size,f=l.size){return M(this,l,d,f)}findIndex(l,d=-1){if(0==l)return y(0,l);if(l==this.size)return y(this.content.length,l);if(l>this.size||l<0)throw new RangeError(`Position ${l} outside of fragment (${this})`);for(let f=0,v=0;;f++){let N=v+this.child(f).nodeSize;if(N>=l)return N==l||d>0?y(f+1,N):y(f,v);v=N}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(l=>l.toJSON()):null}static fromJSON(l,d){if(!d)return h.empty;if(!Array.isArray(d))throw new RangeError("Invalid input for Fragment.fromJSON");return new h(d.map(l.nodeFromJSON))}static fromArray(l){if(!l.length)return h.empty;let d,f=0;for(let v=0;v<l.length;v++){let O=l[v];f+=O.nodeSize,v&&O.isText&&l[v-1].sameMarkup(O)?(d||(d=l.slice(0,v)),d[d.length-1]=O.withText(d[d.length-1].text+O.text)):d&&d.push(O)}return new h(d||l,f)}static from(l){if(!l)return h.empty;if(l instanceof h)return l;if(Array.isArray(l))return this.fromArray(l);if(l.attrs)return new h([l],l.nodeSize);throw new RangeError("Can not convert "+l+" to a Fragment"+(l.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}h.empty=new h([],0);const j={index:0,offset:0};function y(S,l){return j.index=S,j.offset=l,j}function X(S,l){if(S===l)return!0;if(!S||"object"!=typeof S||!l||"object"!=typeof l)return!1;let d=Array.isArray(S);if(Array.isArray(l)!=d)return!1;if(d){if(S.length!=l.length)return!1;for(let f=0;f<S.length;f++)if(!X(S[f],l[f]))return!1}else{for(let f in S)if(!(f in l)||!X(S[f],l[f]))return!1;for(let f in l)if(!(f in S))return!1}return!0}let $=(()=>{class S{constructor(d,f){this.type=d,this.attrs=f}addToSet(d){let f,v=!1;for(let O=0;O<d.length;O++){let N=d[O];if(this.eq(N))return d;if(this.type.excludes(N.type))f||(f=d.slice(0,O));else{if(N.type.excludes(this.type))return d;!v&&N.type.rank>this.type.rank&&(f||(f=d.slice(0,O)),f.push(this),v=!0),f&&f.push(N)}}return f||(f=d.slice()),v||f.push(this),f}removeFromSet(d){for(let f=0;f<d.length;f++)if(this.eq(d[f]))return d.slice(0,f).concat(d.slice(f+1));return d}isInSet(d){for(let f=0;f<d.length;f++)if(this.eq(d[f]))return!0;return!1}eq(d){return this==d||this.type==d.type&&X(this.attrs,d.attrs)}toJSON(){let d={type:this.type.name};for(let f in this.attrs){d.attrs=this.attrs;break}return d}static fromJSON(d,f){if(!f)throw new RangeError("Invalid input for Mark.fromJSON");let v=d.marks[f.type];if(!v)throw new RangeError(`There is no mark type ${f.type} in this schema`);return v.create(f.attrs)}static sameSet(d,f){if(d==f)return!0;if(d.length!=f.length)return!1;for(let v=0;v<d.length;v++)if(!d[v].eq(f[v]))return!1;return!0}static setFrom(d){if(!d||Array.isArray(d)&&0==d.length)return S.none;if(d instanceof S)return[d];let f=d.slice();return f.sort((v,O)=>v.type.rank-O.type.rank),f}}return S.none=[],S})();class rt extends Error{}class G{constructor(l,d,f){this.content=l,this.openStart=d,this.openEnd=f}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(l,d){let f=et(this.content,l+this.openStart,d);return f&&new G(f,this.openStart,this.openEnd)}removeBetween(l,d){return new G(ut(this.content,l+this.openStart,d+this.openStart),this.openStart,this.openEnd)}eq(l){return this.content.eq(l.content)&&this.openStart==l.openStart&&this.openEnd==l.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let l={content:this.content.toJSON()};return this.openStart>0&&(l.openStart=this.openStart),this.openEnd>0&&(l.openEnd=this.openEnd),l}static fromJSON(l,d){if(!d)return G.empty;let f=d.openStart||0,v=d.openEnd||0;if("number"!=typeof f||"number"!=typeof v)throw new RangeError("Invalid input for Slice.fromJSON");return new G(h.fromJSON(l,d.content),f,v)}static maxOpen(l,d=!0){let f=0,v=0;for(let O=l.firstChild;O&&!O.isLeaf&&(d||!O.type.spec.isolating);O=O.firstChild)f++;for(let O=l.lastChild;O&&!O.isLeaf&&(d||!O.type.spec.isolating);O=O.lastChild)v++;return new G(l,f,v)}}function ut(S,l,d){let{index:f,offset:v}=S.findIndex(l),O=S.maybeChild(f),{index:N,offset:lt}=S.findIndex(d);if(v==l||O.isText){if(lt!=d&&!S.child(N).isText)throw new RangeError("Removing non-flat range");return S.cut(0,l).append(S.cut(d))}if(f!=N)throw new RangeError("Removing non-flat range");return S.replaceChild(f,O.copy(ut(O.content,l-v-1,d-v-1)))}function et(S,l,d,f){let{index:v,offset:O}=S.findIndex(l),N=S.maybeChild(v);if(O==l||N.isText)return f&&!f.canReplace(v,v,d)?null:S.cut(0,l).append(d).append(S.cut(l));let lt=et(N.content,l-O-1,d);return lt&&S.replaceChild(v,N.copy(lt))}function st(S,l,d){if(d.openStart>S.depth)throw new rt("Inserted content deeper than insertion position");if(S.depth-d.openStart!=l.depth-d.openEnd)throw new rt("Inconsistent open depths");return Mt(S,l,d,0)}function Mt(S,l,d,f){let v=S.index(f),O=S.node(f);if(v==l.index(f)&&f<S.depth-d.openStart){let N=Mt(S,l,d,f+1);return O.copy(O.content.replaceChild(v,N))}if(d.content.size){if(d.openStart||d.openEnd||S.depth!=f||l.depth!=f){let{start:N,end:lt}=function(S,l){let d=l.depth-S.openStart,v=l.node(d).copy(S.content);for(let O=d-1;O>=0;O--)v=l.node(O).copy(h.from(v));return{start:v.resolveNoCache(S.openStart+d),end:v.resolveNoCache(v.content.size-S.openEnd-d)}}(d,S);return Y(O,L(S,N,lt,l,f))}{let N=S.parent,lt=N.content;return Y(N,lt.cut(0,S.parentOffset).append(d.content).append(lt.cut(l.parentOffset)))}}return Y(O,dt(S,l,f))}function ht(S,l){if(!l.type.compatibleContent(S.type))throw new rt("Cannot join "+l.type.name+" onto "+S.type.name)}function _t(S,l,d){let f=S.node(d);return ht(f,l.node(d)),f}function K(S,l){let d=l.length-1;d>=0&&S.isText&&S.sameMarkup(l[d])?l[d]=S.withText(l[d].text+S.text):l.push(S)}function H(S,l,d,f){let v=(l||S).node(d),O=0,N=l?l.index(d):v.childCount;S&&(O=S.index(d),S.depth>d?O++:S.textOffset&&(K(S.nodeAfter,f),O++));for(let lt=O;lt<N;lt++)K(v.child(lt),f);l&&l.depth==d&&l.textOffset&&K(l.nodeBefore,f)}function Y(S,l){if(!S.type.validContent(l))throw new rt("Invalid content for node "+S.type.name);return S.copy(l)}function L(S,l,d,f,v){let O=S.depth>v&&_t(S,l,v+1),N=f.depth>v&&_t(d,f,v+1),lt=[];return H(null,S,v,lt),O&&N&&l.index(v)==d.index(v)?(ht(O,N),K(Y(O,L(S,l,d,f,v+1)),lt)):(O&&K(Y(O,dt(S,l,v+1)),lt),H(l,d,v,lt),N&&K(Y(N,dt(d,f,v+1)),lt)),H(f,null,v,lt),new h(lt)}function dt(S,l,d){let f=[];return H(null,S,d,f),S.depth>d&&K(Y(_t(S,l,d+1),dt(S,l,d+1)),f),H(l,null,d,f),new h(f)}G.empty=new G(h.empty,0,0);class ft{constructor(l,d,f){this.pos=l,this.path=d,this.parentOffset=f,this.depth=d.length/3-1}resolveDepth(l){return null==l?this.depth:l<0?this.depth+l:l}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(l){return this.path[3*this.resolveDepth(l)]}index(l){return this.path[3*this.resolveDepth(l)+1]}indexAfter(l){return l=this.resolveDepth(l),this.index(l)+(l!=this.depth||this.textOffset?1:0)}start(l){return 0==(l=this.resolveDepth(l))?0:this.path[3*l-1]+1}end(l){return l=this.resolveDepth(l),this.start(l)+this.node(l).content.size}before(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position before the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]}after(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position after the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]+this.path[3*l].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let l=this.parent,d=this.index(this.depth);if(d==l.childCount)return null;let f=this.pos-this.path[this.path.length-1],v=l.child(d);return f?l.child(d).cut(f):v}get nodeBefore(){let l=this.index(this.depth),d=this.pos-this.path[this.path.length-1];return d?this.parent.child(l).cut(0,d):0==l?null:this.parent.child(l-1)}posAtIndex(l,d){d=this.resolveDepth(d);let f=this.path[3*d],v=0==d?0:this.path[3*d-1]+1;for(let O=0;O<l;O++)v+=f.child(O).nodeSize;return v}marks(){let l=this.parent,d=this.index();if(0==l.content.size)return $.none;if(this.textOffset)return l.child(d).marks;let f=l.maybeChild(d-1),v=l.maybeChild(d);if(!f){let lt=f;f=v,v=lt}let O=f.marks;for(var N=0;N<O.length;N++)!1===O[N].type.spec.inclusive&&(!v||!O[N].isInSet(v.marks))&&(O=O[N--].removeFromSet(O));return O}marksAcross(l){let d=this.parent.maybeChild(this.index());if(!d||!d.isInline)return null;let f=d.marks,v=l.parent.maybeChild(l.index());for(var O=0;O<f.length;O++)!1===f[O].type.spec.inclusive&&(!v||!f[O].isInSet(v.marks))&&(f=f[O--].removeFromSet(f));return f}sharedDepth(l){for(let d=this.depth;d>0;d--)if(this.start(d)<=l&&this.end(d)>=l)return d;return 0}blockRange(l=this,d){if(l.pos<this.pos)return l.blockRange(this);for(let f=this.depth-(this.parent.inlineContent||this.pos==l.pos?1:0);f>=0;f--)if(l.pos<=this.end(f)&&(!d||d(this.node(f))))return new bt(this,l,f);return null}sameParent(l){return this.pos-this.parentOffset==l.pos-l.parentOffset}max(l){return l.pos>this.pos?l:this}min(l){return l.pos<this.pos?l:this}toString(){let l="";for(let d=1;d<=this.depth;d++)l+=(l?"/":"")+this.node(d).type.name+"_"+this.index(d-1);return l+":"+this.parentOffset}static resolve(l,d){if(!(d>=0&&d<=l.content.size))throw new RangeError("Position "+d+" out of range");let f=[],v=0,O=d;for(let N=l;;){let{index:lt,offset:Tt}=N.content.findIndex(O),P=O-Tt;if(f.push(N,lt,v+Tt),!P||(N=N.child(lt),N.isText))break;O=P-1,v+=Tt+1}return new ft(d,f,O)}static resolveCached(l,d){for(let v=0;v<gt.length;v++){let O=gt[v];if(O.pos==d&&O.doc==l)return O}let f=gt[ot]=ft.resolve(l,d);return ot=(ot+1)%xt,f}}let gt=[],ot=0,xt=12;class bt{constructor(l,d,f){this.$from=l,this.$to=d,this.depth=f}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Bt=Object.create(null);class tt{constructor(l,d,f,v=$.none){this.type=l,this.attrs=d,this.marks=v,this.content=f||h.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(l){return this.content.child(l)}maybeChild(l){return this.content.maybeChild(l)}forEach(l){this.content.forEach(l)}nodesBetween(l,d,f,v=0){this.content.nodesBetween(l,d,f,v,this)}descendants(l){this.nodesBetween(0,this.content.size,l)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(l,d,f,v){return this.content.textBetween(l,d,f,v)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(l){return this==l||this.sameMarkup(l)&&this.content.eq(l.content)}sameMarkup(l){return this.hasMarkup(l.type,l.attrs,l.marks)}hasMarkup(l,d,f){return this.type==l&&X(this.attrs,d||l.defaultAttrs||Bt)&&$.sameSet(this.marks,f||$.none)}copy(l=null){return l==this.content?this:new tt(this.type,this.attrs,l,this.marks)}mark(l){return l==this.marks?this:new tt(this.type,this.attrs,this.content,l)}cut(l,d=this.content.size){return 0==l&&d==this.content.size?this:this.copy(this.content.cut(l,d))}slice(l,d=this.content.size,f=!1){if(l==d)return G.empty;let v=this.resolve(l),O=this.resolve(d),N=f?0:v.sharedDepth(d),lt=v.start(N),P=v.node(N).content.cut(v.pos-lt,O.pos-lt);return new G(P,v.depth-N,O.depth-N)}replace(l,d,f){return st(this.resolve(l),this.resolve(d),f)}nodeAt(l){for(let d=this;;){let{index:f,offset:v}=d.content.findIndex(l);if(d=d.maybeChild(f),!d)return null;if(v==l||d.isText)return d;l-=v+1}}childAfter(l){let{index:d,offset:f}=this.content.findIndex(l);return{node:this.content.maybeChild(d),index:d,offset:f}}childBefore(l){if(0==l)return{node:null,index:0,offset:0};let{index:d,offset:f}=this.content.findIndex(l);if(f<l)return{node:this.content.child(d),index:d,offset:f};let v=this.content.child(d-1);return{node:v,index:d-1,offset:f-v.nodeSize}}resolve(l){return ft.resolveCached(this,l)}resolveNoCache(l){return ft.resolve(this,l)}rangeHasMark(l,d,f){let v=!1;return d>l&&this.nodesBetween(l,d,O=>(f.isInSet(O.marks)&&(v=!0),!v)),v}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let l=this.type.name;return this.content.size&&(l+="("+this.content.toStringInner()+")"),z(this.marks,l)}contentMatchAt(l){let d=this.type.contentMatch.matchFragment(this.content,0,l);if(!d)throw new Error("Called contentMatchAt on a node with invalid content");return d}canReplace(l,d,f=h.empty,v=0,O=f.childCount){let N=this.contentMatchAt(l).matchFragment(f,v,O),lt=N&&N.matchFragment(this.content,d);if(!lt||!lt.validEnd)return!1;for(let Tt=v;Tt<O;Tt++)if(!this.type.allowsMarks(f.child(Tt).marks))return!1;return!0}canReplaceWith(l,d,f,v){if(v&&!this.type.allowsMarks(v))return!1;let O=this.contentMatchAt(l).matchType(f),N=O&&O.matchFragment(this.content,d);return!!N&&N.validEnd}canAppend(l){return l.content.size?this.canReplace(this.childCount,this.childCount,l.content):this.type.compatibleContent(l.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let l=$.none;for(let d=0;d<this.marks.length;d++)l=this.marks[d].addToSet(l);if(!$.sameSet(l,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(d=>d.type.name)}`);this.content.forEach(d=>d.check())}toJSON(){let l={type:this.type.name};for(let d in this.attrs){l.attrs=this.attrs;break}return this.content.size&&(l.content=this.content.toJSON()),this.marks.length&&(l.marks=this.marks.map(d=>d.toJSON())),l}static fromJSON(l,d){if(!d)throw new RangeError("Invalid input for Node.fromJSON");let f=null;if(d.marks){if(!Array.isArray(d.marks))throw new RangeError("Invalid mark data for Node.fromJSON");f=d.marks.map(l.markFromJSON)}if("text"==d.type){if("string"!=typeof d.text)throw new RangeError("Invalid text node in JSON");return l.text(d.text,f)}let v=h.fromJSON(l,d.content);return l.nodeType(d.type).create(d.attrs,v,f)}}tt.prototype.text=void 0;class E extends tt{constructor(l,d,f,v){if(super(l,d,null,v),!f)throw new RangeError("Empty text nodes are not allowed");this.text=f}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):z(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(l,d){return this.text.slice(l,d)}get nodeSize(){return this.text.length}mark(l){return l==this.marks?this:new E(this.type,this.attrs,this.text,l)}withText(l){return l==this.text?this:new E(this.type,this.attrs,l,this.marks)}cut(l=0,d=this.text.length){return 0==l&&d==this.text.length?this:this.withText(this.text.slice(l,d))}eq(l){return this.sameMarkup(l)&&this.text==l.text}toJSON(){let l=super.toJSON();return l.text=this.text,l}}function z(S,l){for(let d=S.length-1;d>=0;d--)l=S[d].type.name+"("+l+")";return l}class Z{constructor(l){this.validEnd=l,this.next=[],this.wrapCache=[]}static parse(l,d){let f=new at(l,d);if(null==f.next)return Z.empty;let v=I(f);f.next&&f.err("Unexpected trailing text");let O=function(S){let l=Object.create(null);return function d(f){let v=[];f.forEach(N=>{S[N].forEach(({term:lt,to:Tt})=>{if(!lt)return;let P;for(let x=0;x<v.length;x++)v[x][0]==lt&&(P=v[x][1]);me(S,Tt).forEach(x=>{P||v.push([lt,P=[]]),-1==P.indexOf(x)&&P.push(x)})})});let O=l[f.join(",")]=new Z(f.indexOf(S.length-1)>-1);for(let N=0;N<v.length;N++){let lt=v[N][1].sort(xe);O.next.push({type:v[N][0],next:l[lt.join(",")]||d(lt)})}return O}(me(S,0))}(function(S){let l=[[]];return v(function O(N,lt){if("choice"==N.type)return N.exprs.reduce((Tt,P)=>Tt.concat(O(P,lt)),[]);if("seq"!=N.type){if("star"==N.type){let Tt=d();return f(lt,Tt),v(O(N.expr,Tt),Tt),[f(Tt)]}if("plus"==N.type){let Tt=d();return v(O(N.expr,lt),Tt),v(O(N.expr,Tt),Tt),[f(Tt)]}if("opt"==N.type)return[f(lt)].concat(O(N.expr,lt));if("range"==N.type){let Tt=lt;for(let P=0;P<N.min;P++){let x=d();v(O(N.expr,Tt),x),Tt=x}if(-1==N.max)v(O(N.expr,Tt),Tt);else for(let P=N.min;P<N.max;P++){let x=d();f(Tt,x),v(O(N.expr,Tt),x),Tt=x}return[f(Tt)]}if("name"==N.type)return[f(lt,void 0,N.value)];throw new Error("Unknown expr type")}for(let Tt=0;;Tt++){let P=O(N.exprs[Tt],lt);if(Tt==N.exprs.length-1)return P;v(P,lt=d())}}(S,0),d()),l;function d(){return l.push([])-1}function f(N,lt,Tt){let P={term:Tt,to:lt};return l[N].push(P),P}function v(N,lt){N.forEach(Tt=>Tt.to=lt)}}(v));return function(S,l){for(let d=0,f=[S];d<f.length;d++){let v=f[d],O=!v.validEnd,N=[];for(let lt=0;lt<v.next.length;lt++){let{type:Tt,next:P}=v.next[lt];N.push(Tt.name),O&&!(Tt.isText||Tt.hasRequiredAttrs())&&(O=!1),-1==f.indexOf(P)&&f.push(P)}O&&l.err("Only non-generatable nodes ("+N.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(O,f),O}matchType(l){for(let d=0;d<this.next.length;d++)if(this.next[d].type==l)return this.next[d].next;return null}matchFragment(l,d=0,f=l.childCount){let v=this;for(let O=d;v&&O<f;O++)v=v.matchType(l.child(O).type);return v}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let l=0;l<this.next.length;l++){let{type:d}=this.next[l];if(!d.isText&&!d.hasRequiredAttrs())return d}return null}compatible(l){for(let d=0;d<this.next.length;d++)for(let f=0;f<l.next.length;f++)if(this.next[d].type==l.next[f].type)return!0;return!1}fillBefore(l,d=!1,f=0){let v=[this];return function O(N,lt){let Tt=N.matchFragment(l,f);if(Tt&&(!d||Tt.validEnd))return h.from(lt.map(P=>P.createAndFill()));for(let P=0;P<N.next.length;P++){let{type:x,next:F}=N.next[P];if(!x.isText&&!x.hasRequiredAttrs()&&-1==v.indexOf(F)){v.push(F);let q=O(F,lt.concat(x));if(q)return q}}return null}(this,[])}findWrapping(l){for(let f=0;f<this.wrapCache.length;f+=2)if(this.wrapCache[f]==l)return this.wrapCache[f+1];let d=this.computeWrapping(l);return this.wrapCache.push(l,d),d}computeWrapping(l){let d=Object.create(null),f=[{match:this,type:null,via:null}];for(;f.length;){let v=f.shift(),O=v.match;if(O.matchType(l)){let N=[];for(let lt=v;lt.type;lt=lt.via)N.push(lt.type);return N.reverse()}for(let N=0;N<O.next.length;N++){let{type:lt,next:Tt}=O.next[N];!lt.isLeaf&&!lt.hasRequiredAttrs()&&!(lt.name in d)&&(!v.type||Tt.validEnd)&&(f.push({match:lt.contentMatch,type:lt,via:v}),d[lt.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(l){if(l>=this.next.length)throw new RangeError(`There's no ${l}th edge in this content match`);return this.next[l]}toString(){let l=[];return function d(f){l.push(f);for(let v=0;v<f.next.length;v++)-1==l.indexOf(f.next[v].next)&&d(f.next[v].next)}(this),l.map((f,v)=>{let O=v+(f.validEnd?"*":" ")+" ";for(let N=0;N<f.next.length;N++)O+=(N?", ":"")+f.next[N].type.name+"->"+l.indexOf(f.next[N].next);return O}).join("\n")}}Z.empty=new Z(!0);class at{constructor(l,d){this.string=l,this.nodeTypes=d,this.inline=null,this.pos=0,this.tokens=l.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(l){return this.next==l&&(this.pos++||!0)}err(l){throw new SyntaxError(l+" (in content expression '"+this.string+"')")}}function I(S){let l=[];do{l.push(J(S))}while(S.eat("|"));return 1==l.length?l[0]:{type:"choice",exprs:l}}function J(S){let l=[];do{l.push(Q(S))}while(S.next&&")"!=S.next&&"|"!=S.next);return 1==l.length?l[0]:{type:"seq",exprs:l}}function Q(S){let l=function(S){if(S.eat("(")){let l=I(S);return S.eat(")")||S.err("Missing closing paren"),l}if(!/\W/.test(S.next)){let l=function(S,l){let d=S.nodeTypes,f=d[l];if(f)return[f];let v=[];for(let O in d){let N=d[O];N.groups.indexOf(l)>-1&&v.push(N)}return 0==v.length&&S.err("No node type or group '"+l+"' found"),v}(S,S.next).map(d=>(null==S.inline?S.inline=d.isInline:S.inline!=d.isInline&&S.err("Mixing inline and block content"),{type:"name",value:d}));return S.pos++,1==l.length?l[0]:{type:"choice",exprs:l}}S.err("Unexpected token '"+S.next+"'")}(S);for(;;)if(S.eat("+"))l={type:"plus",expr:l};else if(S.eat("*"))l={type:"star",expr:l};else if(S.eat("?"))l={type:"opt",expr:l};else{if(!S.eat("{"))break;l=At(S,l)}return l}function Et(S){/\D/.test(S.next)&&S.err("Expected number, got '"+S.next+"'");let l=Number(S.next);return S.pos++,l}function At(S,l){let d=Et(S),f=d;return S.eat(",")&&(f="}"!=S.next?Et(S):-1),S.eat("}")||S.err("Unclosed braced range"),{type:"range",min:d,max:f,expr:l}}function xe(S,l){return l-S}function me(S,l){let d=[];return function f(v){let O=S[v];if(1==O.length&&!O[0].term)return f(O[0].to);d.push(v);for(let N=0;N<O.length;N++){let{term:lt,to:Tt}=O[N];!lt&&-1==d.indexOf(Tt)&&f(Tt)}}(l),d.sort(xe)}function Me(S){let l=Object.create(null);for(let d in S){let f=S[d];if(!f.hasDefault)return null;l[d]=f.default}return l}function Vt(S,l){let d=Object.create(null);for(let f in S){let v=l&&l[f];if(void 0===v){let O=S[f];if(!O.hasDefault)throw new RangeError("No value supplied for attribute "+f);v=O.default}d[f]=v}return d}function Gt(S){let l=Object.create(null);if(S)for(let d in S)l[d]=new Oe(S[d]);return l}class ee{constructor(l,d,f){this.name=l,this.schema=d,this.spec=f,this.markSet=null,this.groups=f.group?f.group.split(" "):[],this.attrs=Gt(f.attrs),this.defaultAttrs=Me(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(f.inline||"text"==l),this.isText="text"==l}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Z.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let l in this.attrs)if(this.attrs[l].isRequired)return!0;return!1}compatibleContent(l){return this==l||this.contentMatch.compatible(l.contentMatch)}computeAttrs(l){return!l&&this.defaultAttrs?this.defaultAttrs:Vt(this.attrs,l)}create(l=null,d,f){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new tt(this,this.computeAttrs(l),h.from(d),$.setFrom(f))}createChecked(l=null,d,f){if(d=h.from(d),!this.validContent(d))throw new RangeError("Invalid content for node "+this.name);return new tt(this,this.computeAttrs(l),d,$.setFrom(f))}createAndFill(l=null,d,f){if(l=this.computeAttrs(l),(d=h.from(d)).size){let N=this.contentMatch.fillBefore(d);if(!N)return null;d=N.append(d)}let v=this.contentMatch.matchFragment(d),O=v&&v.fillBefore(h.empty,!0);return O?new tt(this,l,d.append(O),$.setFrom(f)):null}validContent(l){let d=this.contentMatch.matchFragment(l);if(!d||!d.validEnd)return!1;for(let f=0;f<l.childCount;f++)if(!this.allowsMarks(l.child(f).marks))return!1;return!0}allowsMarkType(l){return null==this.markSet||this.markSet.indexOf(l)>-1}allowsMarks(l){if(null==this.markSet)return!0;for(let d=0;d<l.length;d++)if(!this.allowsMarkType(l[d].type))return!1;return!0}allowedMarks(l){if(null==this.markSet)return l;let d;for(let f=0;f<l.length;f++)this.allowsMarkType(l[f].type)?d&&d.push(l[f]):d||(d=l.slice(0,f));return d?d.length?d:$.none:l}static compile(l,d){let f=Object.create(null);l.forEach((O,N)=>f[O]=new ee(O,d,N));let v=d.spec.topNode||"doc";if(!f[v])throw new RangeError("Schema is missing its top node type ('"+v+"')");if(!f.text)throw new RangeError("Every schema needs a 'text' type");for(let O in f.text.attrs)throw new RangeError("The text node type should not have attributes");return f}}class Oe{constructor(l){this.hasDefault=Object.prototype.hasOwnProperty.call(l,"default"),this.default=l.default}get isRequired(){return!this.hasDefault}}class Xt{constructor(l,d,f,v){this.name=l,this.rank=d,this.schema=f,this.spec=v,this.attrs=Gt(v.attrs),this.excluded=null;let O=Me(this.attrs);this.instance=O?new $(this,O):null}create(l=null){return!l&&this.instance?this.instance:new $(this,Vt(this.attrs,l))}static compile(l,d){let f=Object.create(null),v=0;return l.forEach((O,N)=>f[O]=new Xt(O,v++,d,N)),f}removeFromSet(l){for(var d=0;d<l.length;d++)l[d].type==this&&(l=l.slice(0,d).concat(l.slice(d+1)),d--);return l}isInSet(l){for(let d=0;d<l.length;d++)if(l[d].type==this)return l[d]}excludes(l){return this.excluded.indexOf(l)>-1}}class Ee{constructor(l){this.cached=Object.create(null),this.spec={nodes:s.from(l.nodes),marks:s.from(l.marks||{}),topNode:l.topNode},this.nodes=ee.compile(this.spec.nodes,this),this.marks=Xt.compile(this.spec.marks,this);let d=Object.create(null);for(let f in this.nodes){if(f in this.marks)throw new RangeError(f+" can not be both a node and a mark");let v=this.nodes[f],O=v.spec.content||"",N=v.spec.marks;v.contentMatch=d[O]||(d[O]=Z.parse(O,this.nodes)),v.inlineContent=v.contentMatch.inlineContent,v.markSet="_"==N?null:N?_e(this,N.split(" ")):""!=N&&v.inlineContent?null:[]}for(let f in this.marks){let v=this.marks[f],O=v.spec.excludes;v.excluded=null==O?[v]:""==O?[]:_e(this,O.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(l,d=null,f,v){if("string"==typeof l)l=this.nodeType(l);else{if(!(l instanceof ee))throw new RangeError("Invalid node type: "+l);if(l.schema!=this)throw new RangeError("Node type from different schema used ("+l.name+")")}return l.createChecked(d,f,v)}text(l,d){let f=this.nodes.text;return new E(f,f.defaultAttrs,l,$.setFrom(d))}mark(l,d){return"string"==typeof l&&(l=this.marks[l]),l.create(d)}nodeFromJSON(l){return tt.fromJSON(this,l)}markFromJSON(l){return $.fromJSON(this,l)}nodeType(l){let d=this.nodes[l];if(!d)throw new RangeError("Unknown node type: "+l);return d}}function _e(S,l){let d=[];for(let f=0;f<l.length;f++){let v=l[f],O=S.marks[v],N=O;if(O)d.push(O);else for(let lt in S.marks){let Tt=S.marks[lt];("_"==v||Tt.spec.group&&Tt.spec.group.split(" ").indexOf(v)>-1)&&d.push(N=Tt)}if(!N)throw new SyntaxError("Unknown mark type: '"+l[f]+"'")}return d}class ne{constructor(l,d){this.schema=l,this.rules=d,this.tags=[],this.styles=[],d.forEach(f=>{f.tag?this.tags.push(f):f.style&&this.styles.push(f)}),this.normalizeLists=!this.tags.some(f=>{if(!/^(ul|ol)\b/.test(f.tag)||!f.node)return!1;let v=l.nodes[f.node];return v.contentMatch.matchType(v)})}parse(l,d={}){let f=new C(this,d,!1);return f.addAll(l,d.from,d.to),f.finish()}parseSlice(l,d={}){let f=new C(this,d,!0);return f.addAll(l,d.from,d.to),G.maxOpen(f.finish())}matchTag(l,d,f){for(let v=f?this.tags.indexOf(f)+1:0;v<this.tags.length;v++){let O=this.tags[v];if(b(l,O.tag)&&(void 0===O.namespace||l.namespaceURI==O.namespace)&&(!O.context||d.matchesContext(O.context))){if(O.getAttrs){let N=O.getAttrs(l);if(!1===N)continue;O.attrs=N||void 0}return O}}}matchStyle(l,d,f,v){for(let O=v?this.styles.indexOf(v)+1:0;O<this.styles.length;O++){let N=this.styles[O],lt=N.style;if(!(0!=lt.indexOf(l)||N.context&&!f.matchesContext(N.context)||lt.length>l.length&&(61!=lt.charCodeAt(l.length)||lt.slice(l.length+1)!=d))){if(N.getAttrs){let Tt=N.getAttrs(d);if(!1===Tt)continue;N.attrs=Tt||void 0}return N}}}static schemaRules(l){let d=[];function f(v){let O=null==v.priority?50:v.priority,N=0;for(;N<d.length;N++){let lt=d[N];if((null==lt.priority?50:lt.priority)<O)break}d.splice(N,0,v)}for(let v in l.marks){let O=l.marks[v].spec.parseDOM;O&&O.forEach(N=>{f(N=A(N)),N.mark=v})}for(let v in l.nodes){let O=l.nodes[v].spec.parseDOM;O&&O.forEach(N=>{f(N=A(N)),N.node=v})}return d}static fromSchema(l){return l.cached.domParser||(l.cached.domParser=new ne(l,ne.schemaRules(l)))}}const re={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ve={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},he={ol:!0,ul:!0};function U(S,l,d){return null!=l?(l?1:0)|("full"===l?2:0):S&&"pre"==S.whitespace?3:-5&d}class _{constructor(l,d,f,v,O,N,lt){this.type=l,this.attrs=d,this.marks=f,this.pendingMarks=v,this.solid=O,this.options=lt,this.content=[],this.activeMarks=$.none,this.stashMarks=[],this.match=N||(4&lt?null:l.contentMatch)}findWrapping(l){if(!this.match){if(!this.type)return[];let d=this.type.contentMatch.fillBefore(h.from(l));if(!d){let v,f=this.type.contentMatch;return(v=f.findWrapping(l.type))?(this.match=f,v):null}this.match=this.type.contentMatch.matchFragment(d)}return this.match.findWrapping(l.type)}finish(l){if(!(1&this.options)){let v,f=this.content[this.content.length-1];if(f&&f.isText&&(v=/[ \t\r\n\u000c]+$/.exec(f.text))){let O=f;f.text.length==v[0].length?this.content.pop():this.content[this.content.length-1]=O.withText(O.text.slice(0,O.text.length-v[0].length))}}let d=h.from(this.content);return!l&&this.match&&(d=d.append(this.match.fillBefore(h.empty,!0))),this.type?this.type.create(this.attrs,d,this.marks):d}popFromStashMark(l){for(let d=this.stashMarks.length-1;d>=0;d--)if(l.eq(this.stashMarks[d]))return this.stashMarks.splice(d,1)[0]}applyPending(l){for(let d=0,f=this.pendingMarks;d<f.length;d++){let v=f[d];(this.type?this.type.allowsMarkType(v.type):V(v.type,l))&&!v.isInSet(this.activeMarks)&&(this.activeMarks=v.addToSet(this.activeMarks),this.pendingMarks=v.removeFromSet(this.pendingMarks))}}inlineContext(l){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:l.parentNode&&!re.hasOwnProperty(l.parentNode.nodeName.toLowerCase())}}class C{constructor(l,d,f){this.parser=l,this.options=d,this.isOpen=f,this.open=0;let O,v=d.topNode,N=U(null,d.preserveWhitespace,0)|(f?4:0);O=v?new _(v.type,v.attrs,$.none,$.none,!0,d.topMatch||v.type.contentMatch,N):new _(f?null:l.schema.topNodeType,null,$.none,$.none,!0,null,N),this.nodes=[O],this.find=d.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(l){if(3==l.nodeType)this.addTextNode(l);else if(1==l.nodeType){let d=l.getAttribute("style"),f=d?this.readStyles(function(S){let d,l=/\s*([\w-]+)\s*:\s*([^;]+)/g,f=[];for(;d=l.exec(S);)f.push(d[1],d[2].trim());return f}(d)):null,v=this.top;if(null!=f)for(let O=0;O<f.length;O++)this.addPendingMark(f[O]);if(this.addElement(l),null!=f)for(let O=0;O<f.length;O++)this.removePendingMark(f[O],v)}}addTextNode(l){let d=l.nodeValue,f=this.top;if(2&f.options||f.inlineContext(l)||/[^ \t\r\n\u000c]/.test(d)){if(1&f.options)d=2&f.options?d.replace(/\r\n?/g,"\n"):d.replace(/\r?\n|\r/g," ");else if(d=d.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(d)&&this.open==this.nodes.length-1){let v=f.content[f.content.length-1],O=l.previousSibling;(!v||O&&"BR"==O.nodeName||v.isText&&/[ \t\r\n\u000c]$/.test(v.text))&&(d=d.slice(1))}d&&this.insertNode(this.parser.schema.text(d)),this.findInText(l)}else this.findInside(l)}addElement(l,d){let v,f=l.nodeName.toLowerCase();he.hasOwnProperty(f)&&this.parser.normalizeLists&&function(S){for(let l=S.firstChild,d=null;l;l=l.nextSibling){let f=1==l.nodeType?l.nodeName.toLowerCase():null;f&&he.hasOwnProperty(f)&&d?(d.appendChild(l),l=d):"li"==f?d=l:f&&(d=null)}}(l);let O=this.options.ruleFromNode&&this.options.ruleFromNode(l)||(v=this.parser.matchTag(l,this,d));if(O?O.ignore:ve.hasOwnProperty(f))this.findInside(l),this.ignoreFallback(l);else if(!O||O.skip||O.closeParent){O&&O.closeParent?this.open=Math.max(0,this.open-1):O&&O.skip.nodeType&&(l=O.skip);let N,lt=this.top,Tt=this.needsBlock;if(re.hasOwnProperty(f))N=!0,lt.type||(this.needsBlock=!0);else if(!l.firstChild)return void this.leafFallback(l);this.addAll(l),N&&this.sync(lt),this.needsBlock=Tt}else this.addElementByRule(l,O,!1===O.consuming?v:void 0)}leafFallback(l){"BR"==l.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(l.ownerDocument.createTextNode("\n"))}ignoreFallback(l){"BR"==l.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(l){let d=$.none;t:for(let f=0;f<l.length;f+=2)for(let v;;){let O=this.parser.matchStyle(l[f],l[f+1],this,v);if(!O)continue t;if(O.ignore)return null;if(d=this.parser.schema.marks[O.mark].create(O.attrs).addToSet(d),!1!==O.consuming)break;v=O}return d}addElementByRule(l,d,f){let v,O,N;d.node?(O=this.parser.schema.nodes[d.node],O.isLeaf?this.insertNode(O.create(d.attrs))||this.leafFallback(l):v=this.enter(O,d.attrs||null,d.preserveWhitespace)):(N=this.parser.schema.marks[d.mark].create(d.attrs),this.addPendingMark(N));let lt=this.top;if(O&&O.isLeaf)this.findInside(l);else if(f)this.addElement(l,f);else if(d.getContent)this.findInside(l),d.getContent(l,this.parser.schema).forEach(Tt=>this.insertNode(Tt));else{let Tt=l;"string"==typeof d.contentElement?Tt=l.querySelector(d.contentElement):"function"==typeof d.contentElement?Tt=d.contentElement(l):d.contentElement&&(Tt=d.contentElement),this.findAround(l,Tt,!0),this.addAll(Tt)}v&&this.sync(lt)&&this.open--,N&&this.removePendingMark(N,lt)}addAll(l,d,f){let v=d||0;for(let O=d?l.childNodes[d]:l.firstChild,N=null==f?null:l.childNodes[f];O!=N;O=O.nextSibling,++v)this.findAtPoint(l,v),this.addDOM(O);this.findAtPoint(l,v)}findPlace(l){let d,f;for(let v=this.open;v>=0;v--){let O=this.nodes[v],N=O.findWrapping(l);if(N&&(!d||d.length>N.length)&&(d=N,f=O,!N.length)||O.solid)break}if(!d)return!1;this.sync(f);for(let v=0;v<d.length;v++)this.enterInner(d[v],null,!1);return!0}insertNode(l){if(l.isInline&&this.needsBlock&&!this.top.type){let d=this.textblockFromContext();d&&this.enterInner(d)}if(this.findPlace(l)){this.closeExtra();let d=this.top;d.applyPending(l.type),d.match&&(d.match=d.match.matchType(l.type));let f=d.activeMarks;for(let v=0;v<l.marks.length;v++)(!d.type||d.type.allowsMarkType(l.marks[v].type))&&(f=l.marks[v].addToSet(f));return d.content.push(l.mark(f)),!0}return!1}enter(l,d,f){let v=this.findPlace(l.create(d));return v&&this.enterInner(l,d,!0,f),v}enterInner(l,d=null,f=!1,v){this.closeExtra();let O=this.top;O.applyPending(l),O.match=O.match&&O.match.matchType(l);let N=U(l,v,O.options);4&O.options&&0==O.content.length&&(N|=4),this.nodes.push(new _(l,d,O.activeMarks,O.pendingMarks,f,null,N)),this.open++}closeExtra(l=!1){let d=this.nodes.length-1;if(d>this.open){for(;d>this.open;d--)this.nodes[d-1].content.push(this.nodes[d].finish(l));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(l){for(let d=this.open;d>=0;d--)if(this.nodes[d]==l)return this.open=d,!0;return!1}get currentPos(){this.closeExtra();let l=0;for(let d=this.open;d>=0;d--){let f=this.nodes[d].content;for(let v=f.length-1;v>=0;v--)l+=f[v].nodeSize;d&&l++}return l}findAtPoint(l,d){if(this.find)for(let f=0;f<this.find.length;f++)this.find[f].node==l&&this.find[f].offset==d&&(this.find[f].pos=this.currentPos)}findInside(l){if(this.find)for(let d=0;d<this.find.length;d++)null==this.find[d].pos&&1==l.nodeType&&l.contains(this.find[d].node)&&(this.find[d].pos=this.currentPos)}findAround(l,d,f){if(l!=d&&this.find)for(let v=0;v<this.find.length;v++)null==this.find[v].pos&&1==l.nodeType&&l.contains(this.find[v].node)&&d.compareDocumentPosition(this.find[v].node)&(f?2:4)&&(this.find[v].pos=this.currentPos)}findInText(l){if(this.find)for(let d=0;d<this.find.length;d++)this.find[d].node==l&&(this.find[d].pos=this.currentPos-(l.nodeValue.length-this.find[d].offset))}matchesContext(l){if(l.indexOf("|")>-1)return l.split(/\s*\|\s*/).some(this.matchesContext,this);let d=l.split("/"),f=this.options.context,v=!(this.isOpen||f&&f.parent.type!=this.nodes[0].type),O=(v?0:1)-(f?f.depth+1:0),N=(lt,Tt)=>{for(;lt>=0;lt--){let P=d[lt];if(""==P){if(lt==d.length-1||0==lt)continue;for(;Tt>=O;Tt--)if(N(lt-1,Tt))return!0;return!1}{let x=Tt>0||0==Tt&&v?this.nodes[Tt].type:f&&Tt>=O?f.node(Tt-O).type:null;if(!x||x.name!=P&&-1==x.groups.indexOf(P))return!1;Tt--}}return!0};return N(d.length-1,this.open)}textblockFromContext(){let l=this.options.context;if(l)for(let d=l.depth;d>=0;d--){let f=l.node(d).contentMatchAt(l.indexAfter(d)).defaultType;if(f&&f.isTextblock&&f.defaultAttrs)return f}for(let d in this.parser.schema.nodes){let f=this.parser.schema.nodes[d];if(f.isTextblock&&f.defaultAttrs)return f}}addPendingMark(l){let d=function(S,l){for(let d=0;d<l.length;d++)if(S.eq(l[d]))return l[d]}(l,this.top.pendingMarks);d&&this.top.stashMarks.push(d),this.top.pendingMarks=l.addToSet(this.top.pendingMarks)}removePendingMark(l,d){for(let f=this.open;f>=0;f--){let v=this.nodes[f];if(v.pendingMarks.lastIndexOf(l)>-1)v.pendingMarks=l.removeFromSet(v.pendingMarks);else{v.activeMarks=l.removeFromSet(v.activeMarks);let N=v.popFromStashMark(l);N&&v.type&&v.type.allowsMarkType(N.type)&&(v.activeMarks=N.addToSet(v.activeMarks))}if(v==d)break}}}function b(S,l){return(S.matches||S.msMatchesSelector||S.webkitMatchesSelector||S.mozMatchesSelector).call(S,l)}function A(S){let l={};for(let d in S)l[d]=S[d];return l}function V(S,l){let d=l.schema.nodes;for(let f in d){let v=d[f];if(!v.allowsMarkType(S))continue;let O=[],N=lt=>{O.push(lt);for(let Tt=0;Tt<lt.edgeCount;Tt++){let{type:P,next:x}=lt.edge(Tt);if(P==l||O.indexOf(x)<0&&N(x))return!0}};if(N(v.contentMatch))return!0}}class Dt{constructor(l,d){this.nodes=l,this.marks=d}serializeFragment(l,d={},f){f||(f=wt(d).createDocumentFragment());let v=f,O=[];return l.forEach(N=>{if(O.length||N.marks.length){let lt=0,Tt=0;for(;lt<O.length&&Tt<N.marks.length;){let P=N.marks[Tt];if(this.marks[P.type.name]){if(!P.eq(O[lt][0])||!1===P.type.spec.spanning)break;lt++,Tt++}else Tt++}for(;lt<O.length;)v=O.pop()[1];for(;Tt<N.marks.length;){let P=N.marks[Tt++],x=this.serializeMark(P,N.isInline,d);x&&(O.push([P,v]),v.appendChild(x.dom),v=x.contentDOM||x.dom)}}v.appendChild(this.serializeNodeInner(N,d))}),f}serializeNodeInner(l,d){let{dom:f,contentDOM:v}=Dt.renderSpec(wt(d),this.nodes[l.type.name](l));if(v){if(l.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(l.content,d,v)}return f}serializeNode(l,d={}){let f=this.serializeNodeInner(l,d);for(let v=l.marks.length-1;v>=0;v--){let O=this.serializeMark(l.marks[v],l.isInline,d);O&&((O.contentDOM||O.dom).appendChild(f),f=O.dom)}return f}serializeMark(l,d,f={}){let v=this.marks[l.type.name];return v&&Dt.renderSpec(wt(f),v(l,d))}static renderSpec(l,d,f=null){if("string"==typeof d)return{dom:l.createTextNode(d)};if(null!=d.nodeType)return{dom:d};if(d.dom&&null!=d.dom.nodeType)return d;let v=d[0],O=v.indexOf(" ");O>0&&(f=v.slice(0,O),v=v.slice(O+1));let N,lt=f?l.createElementNS(f,v):l.createElement(v),Tt=d[1],P=1;if(Tt&&"object"==typeof Tt&&null==Tt.nodeType&&!Array.isArray(Tt)){P=2;for(let x in Tt)if(null!=Tt[x]){let F=x.indexOf(" ");F>0?lt.setAttributeNS(x.slice(0,F),x.slice(F+1),Tt[x]):lt.setAttribute(x,Tt[x])}}for(let x=P;x<d.length;x++){let F=d[x];if(0===F){if(x<d.length-1||x>P)throw new RangeError("Content hole must be the only child of its parent node");return{dom:lt,contentDOM:lt}}{let{dom:q,contentDOM:nt}=Dt.renderSpec(l,F,f);if(lt.appendChild(q),nt){if(N)throw new RangeError("Multiple content holes");N=nt}}}return{dom:lt,contentDOM:N}}static fromSchema(l){return l.cached.domSerializer||(l.cached.domSerializer=new Dt(this.nodesFromSchema(l),this.marksFromSchema(l)))}static nodesFromSchema(l){let d=kt(l.nodes);return d.text||(d.text=f=>f.text),d}static marksFromSchema(l){return kt(l.marks)}}function kt(S){let l={};for(let d in S){let f=S[d].spec.toDOM;f&&(l[d]=f)}return l}function wt(S){return S.document||window.document}},62463:(Pt,ct,c)=>{c.d(ct,{C1:()=>ut,yy:()=>ft,qv:()=>rt,Sy:()=>ot,H$:()=>Bt,Y1:()=>M,xm:()=>h,Bs:()=>X});var m=c(35917),s=c(38480);const k=Object.create(null);class M{constructor(E,z,Z){this.$anchor=E,this.$head=z,this.ranges=Z||[new h(E.min(z),E.max(z))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let E=this.ranges;for(let z=0;z<E.length;z++)if(E[z].$from.pos!=E[z].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(E,z=m.p2.empty){let Z=z.content.lastChild,at=null;for(let Q=0;Q<z.openEnd;Q++)at=Z,Z=Z.lastChild;let I=E.steps.length,J=this.ranges;for(let Q=0;Q<J.length;Q++){let{$from:Et,$to:At}=J[Q],It=E.mapping.slice(I);E.replaceRange(It.map(Et.pos),It.map(At.pos),Q?m.p2.empty:z),0==Q&&Mt(E,I,(Z?Z.isInline:at&&at.isTextblock)?-1:1)}}replaceWith(E,z){let Z=E.steps.length,at=this.ranges;for(let I=0;I<at.length;I++){let{$from:J,$to:Q}=at[I],Et=E.mapping.slice(Z),At=Et.map(J.pos),It=Et.map(Q.pos);I?E.deleteRange(At,It):(E.replaceRangeWith(At,It,z),Mt(E,Z,z.isInline?-1:1))}}static findFrom(E,z,Z=!1){let at=E.parent.inlineContent?new X(E):st(E.node(0),E.parent,E.pos,E.index(),z,Z);if(at)return at;for(let I=E.depth-1;I>=0;I--){let J=z<0?st(E.node(0),E.node(I),E.before(I+1),E.index(I),z,Z):st(E.node(0),E.node(I),E.after(I+1),E.index(I)+1,z,Z);if(J)return J}return null}static near(E,z=1){return this.findFrom(E,z)||this.findFrom(E,-z)||new ut(E.node(0))}static atStart(E){return st(E,E,0,0,1)||new ut(E)}static atEnd(E){return st(E,E,E.content.size,E.childCount,-1)||new ut(E)}static fromJSON(E,z){if(!z||!z.type)throw new RangeError("Invalid input for Selection.fromJSON");let Z=k[z.type];if(!Z)throw new RangeError(`No selection type ${z.type} defined`);return Z.fromJSON(E,z)}static jsonID(E,z){if(E in k)throw new RangeError("Duplicate use of selection JSON ID "+E);return k[E]=z,z.prototype.jsonID=E,z}getBookmark(){return X.between(this.$anchor,this.$head).getBookmark()}}M.prototype.visible=!0;class h{constructor(E,z){this.$from=E,this.$to=z}}let j=!1;function y(tt){!j&&!tt.parent.inlineContent&&(j=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+tt.parent.type.name+")"))}class X extends M{constructor(E,z=E){y(E),y(z),super(E,z)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(E,z){let Z=E.resolve(z.map(this.head));if(!Z.parent.inlineContent)return M.near(Z);let at=E.resolve(z.map(this.anchor));return new X(at.parent.inlineContent?at:Z,Z)}replace(E,z=m.p2.empty){if(super.replace(E,z),z==m.p2.empty){let Z=this.$from.marksAcross(this.$to);Z&&E.ensureMarks(Z)}}eq(E){return E instanceof X&&E.anchor==this.anchor&&E.head==this.head}getBookmark(){return new $(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(E,z){if("number"!=typeof z.anchor||"number"!=typeof z.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new X(E.resolve(z.anchor),E.resolve(z.head))}static create(E,z,Z=z){let at=E.resolve(z);return new this(at,Z==z?at:E.resolve(Z))}static between(E,z,Z){let at=E.pos-z.pos;if((!Z||at)&&(Z=at>=0?1:-1),!z.parent.inlineContent){let I=M.findFrom(z,Z,!0)||M.findFrom(z,-Z,!0);if(!I)return M.near(z,Z);z=I.$head}return E.parent.inlineContent||(0==at||(E=(M.findFrom(E,-Z,!0)||M.findFrom(E,Z,!0)).$anchor).pos<z.pos!=at<0)&&(E=z),new X(E,z)}}M.jsonID("text",X);class ${constructor(E,z){this.anchor=E,this.head=z}map(E){return new $(E.map(this.anchor),E.map(this.head))}resolve(E){return X.between(E.resolve(this.anchor),E.resolve(this.head))}}class rt extends M{constructor(E){let z=E.nodeAfter,Z=E.node(0).resolve(E.pos+z.nodeSize);super(E,Z),this.node=z}map(E,z){let{deleted:Z,pos:at}=z.mapResult(this.anchor),I=E.resolve(at);return Z?M.near(I):new rt(I)}content(){return new m.p2(m.HY.from(this.node),0,0)}eq(E){return E instanceof rt&&E.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new G(this.anchor)}static fromJSON(E,z){if("number"!=typeof z.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new rt(E.resolve(z.anchor))}static create(E,z){return new rt(E.resolve(z))}static isSelectable(E){return!E.isText&&!1!==E.type.spec.selectable}}rt.prototype.visible=!1,M.jsonID("node",rt);class G{constructor(E){this.anchor=E}map(E){let{deleted:z,pos:Z}=E.mapResult(this.anchor);return z?new $(Z,Z):new G(Z)}resolve(E){let z=E.resolve(this.anchor),Z=z.nodeAfter;return Z&&rt.isSelectable(Z)?new rt(z):M.near(z)}}class ut extends M{constructor(E){super(E.resolve(0),E.resolve(E.content.size))}replace(E,z=m.p2.empty){if(z==m.p2.empty){E.delete(0,E.doc.content.size);let Z=M.atStart(E.doc);Z.eq(E.selection)||E.setSelection(Z)}else super.replace(E,z)}toJSON(){return{type:"all"}}static fromJSON(E){return new ut(E)}map(E){return new ut(E)}eq(E){return E instanceof ut}getBookmark(){return et}}M.jsonID("all",ut);const et={map(){return this},resolve:tt=>new ut(tt)};function st(tt,E,z,Z,at,I=!1){if(E.inlineContent)return X.create(tt,z);for(let J=Z-(at>0?0:1);at>0?J<E.childCount:J>=0;J+=at){let Q=E.child(J);if(Q.isAtom){if(!I&&rt.isSelectable(Q))return rt.create(tt,z-(at<0?Q.nodeSize:0))}else{let Et=st(tt,Q,z+at,at<0?Q.childCount:0,at,I);if(Et)return Et}z+=Q.nodeSize*at}return null}function Mt(tt,E,z){let Z=tt.steps.length-1;if(Z<E)return;let J,at=tt.steps[Z];(at instanceof s.Pu||at instanceof s.FC)&&(tt.mapping.maps[Z].forEach((Q,Et,At,It)=>{null==J&&(J=It)}),tt.setSelection(M.near(tt.doc.resolve(J),z)))}class H extends s.wx{constructor(E){super(E.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=E.selection,this.storedMarks=E.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(E){if(E.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=E,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(E){return this.storedMarks=E,this.updated|=2,this}ensureMarks(E){return m.vc.sameSet(this.storedMarks||this.selection.$from.marks(),E)||this.setStoredMarks(E),this}addStoredMark(E){return this.ensureMarks(E.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(E){return this.ensureMarks(E.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(E,z){super.addStep(E,z),this.updated=-3&this.updated,this.storedMarks=null}setTime(E){return this.time=E,this}replaceSelection(E){return this.selection.replace(this,E),this}replaceSelectionWith(E,z=!0){let Z=this.selection;return z&&(E=E.mark(this.storedMarks||(Z.empty?Z.$from.marks():Z.$from.marksAcross(Z.$to)||m.vc.none))),Z.replaceWith(this,E),this}deleteSelection(){return this.selection.replace(this),this}insertText(E,z,Z){let at=this.doc.type.schema;if(null==z)return E?this.replaceSelectionWith(at.text(E),!0):this.deleteSelection();{if(null==Z&&(Z=z),Z=null==Z?z:Z,!E)return this.deleteRange(z,Z);let I=this.storedMarks;if(!I){let J=this.doc.resolve(z);I=Z==z?J.marks():J.marksAcross(this.doc.resolve(Z))}return this.replaceRangeWith(z,Z,at.text(E,I)),this.selection.empty||this.setSelection(M.near(this.selection.$to)),this}}setMeta(E,z){return this.meta["string"==typeof E?E:E.key]=z,this}getMeta(E){return this.meta["string"==typeof E?E:E.key]}get isGeneric(){for(let E in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Y(tt,E){return E&&tt?tt.bind(E):tt}class L{constructor(E,z,Z){this.name=E,this.init=Y(z.init,Z),this.apply=Y(z.apply,Z)}}const dt=[new L("doc",{init:tt=>tt.doc||tt.schema.topNodeType.createAndFill(),apply:tt=>tt.doc}),new L("selection",{init:(tt,E)=>tt.selection||M.atStart(E.doc),apply:tt=>tt.selection}),new L("storedMarks",{init:tt=>tt.storedMarks||null,apply:(tt,E,z,Z)=>Z.selection.$cursor?tt.storedMarks:null}),new L("scrollToSelection",{init:()=>0,apply:(tt,E)=>tt.scrolledIntoView?E+1:E})];class pt{constructor(E,z){this.schema=E,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=dt.slice(),z&&z.forEach(Z=>{if(this.pluginsByKey[Z.key])throw new RangeError("Adding different instances of a keyed plugin ("+Z.key+")");this.plugins.push(Z),this.pluginsByKey[Z.key]=Z,Z.spec.state&&this.fields.push(new L(Z.key,Z.spec.state,Z))})}}class ft{constructor(E){this.config=E}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(E){return this.applyTransaction(E).state}filterTransaction(E,z=-1){for(let Z=0;Z<this.config.plugins.length;Z++)if(Z!=z){let at=this.config.plugins[Z];if(at.spec.filterTransaction&&!at.spec.filterTransaction.call(at,E,this))return!1}return!0}applyTransaction(E){if(!this.filterTransaction(E))return{state:this,transactions:[]};let z=[E],Z=this.applyInner(E),at=null;for(;;){let I=!1;for(let J=0;J<this.config.plugins.length;J++){let Q=this.config.plugins[J];if(Q.spec.appendTransaction){let Et=at?at[J].n:0,At=at?at[J].state:this,It=Et<z.length&&Q.spec.appendTransaction.call(Q,Et?z.slice(Et):z,At,Z);if(It&&Z.filterTransaction(It,J)){if(It.setMeta("appendedTransaction",E),!at){at=[];for(let Zt=0;Zt<this.config.plugins.length;Zt++)at.push(Zt<J?{state:Z,n:z.length}:{state:this,n:0})}z.push(It),Z=Z.applyInner(It),I=!0}at&&(at[J]={state:Z,n:z.length})}}if(!I)return{state:Z,transactions:z}}}applyInner(E){if(!E.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let z=new ft(this.config),Z=this.config.fields;for(let at=0;at<Z.length;at++){let I=Z[at];z[I.name]=I.apply(E,this[I.name],this,z)}return z}get tr(){return new H(this)}static create(E){let z=new pt(E.doc?E.doc.type.schema:E.schema,E.plugins),Z=new ft(z);for(let at=0;at<z.fields.length;at++)Z[z.fields[at].name]=z.fields[at].init(E,Z);return Z}reconfigure(E){let z=new pt(this.schema,E.plugins),Z=z.fields,at=new ft(z);for(let I=0;I<Z.length;I++){let J=Z[I].name;at[J]=this.hasOwnProperty(J)?this[J]:Z[I].init(E,at)}return at}toJSON(E){let z={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(z.storedMarks=this.storedMarks.map(Z=>Z.toJSON())),E&&"object"==typeof E)for(let Z in E){if("doc"==Z||"selection"==Z)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let at=E[Z],I=at.spec.state;I&&I.toJSON&&(z[Z]=I.toJSON.call(at,this[at.key]))}return z}static fromJSON(E,z,Z){if(!z)throw new RangeError("Invalid input for EditorState.fromJSON");if(!E.schema)throw new RangeError("Required config field 'schema' missing");let at=new pt(E.schema,E.plugins),I=new ft(at);return at.fields.forEach(J=>{if("doc"==J.name)I.doc=m.NB.fromJSON(E.schema,z.doc);else if("selection"==J.name)I.selection=M.fromJSON(I.doc,z.selection);else if("storedMarks"==J.name)z.storedMarks&&(I.storedMarks=z.storedMarks.map(E.schema.markFromJSON));else{if(Z)for(let Q in Z){let Et=Z[Q],At=Et.spec.state;if(Et.key==J.name&&At&&At.fromJSON&&Object.prototype.hasOwnProperty.call(z,Q))return void(I[J.name]=At.fromJSON.call(Et,E,z[Q],I))}I[J.name]=J.init(E,I)}}),I}}function gt(tt,E,z){for(let Z in tt){let at=tt[Z];at instanceof Function?at=at.bind(E):"handleDOMEvents"==Z&&(at=gt(at,E,{})),z[Z]=at}return z}class ot{constructor(E){this.spec=E,this.props={},E.props&&gt(E.props,this,this.props),this.key=E.key?E.key.key:bt("plugin")}getState(E){return E[this.key]}}const xt=Object.create(null);function bt(tt){return tt in xt?tt+"$"+ ++xt[tt]:(xt[tt]=0,tt+"$")}class Bt{constructor(E="key"){this.key=bt(E)}get(E){return E.config.pluginsByKey[this.key]}getState(E){return E[this.key]}}},38480:(Pt,ct,c)=>{c.d(ct,{vs:()=>et,FC:()=>L,Pu:()=>Y,wx:()=>le,Mn:()=>At,Ax:()=>Q,nj:()=>me,nd:()=>Bt,k9:()=>xt,dR:()=>Ce});var m=c(35917);const k=Math.pow(2,16);function M(U,_){return U+_*k}function h(U){return 65535&U}class G{constructor(_,C,D){this.pos=_,this.delInfo=C,this.recover=D}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class ut{constructor(_,C=!1){if(this.ranges=_,this.inverted=C,!_.length&&ut.empty)return ut.empty}recover(_){let C=0,D=h(_);if(!this.inverted)for(let b=0;b<D;b++)C+=this.ranges[3*b+2]-this.ranges[3*b+1];return this.ranges[3*D]+C+((U=_)-(65535&U))/k;var U}mapResult(_,C=1){return this._map(_,C,!1)}map(_,C=1){return this._map(_,C,!0)}_map(_,C,D){let b=0,B=this.inverted?2:1,A=this.inverted?1:2;for(let V=0;V<this.ranges.length;V+=3){let Ct=this.ranges[V]-(this.inverted?b:0);if(Ct>_)break;let Dt=this.ranges[V+B],kt=this.ranges[V+A],wt=Ct+Dt;if(_<=wt){let l=Ct+b+((Dt?_==Ct?-1:_==wt?1:C:C)<0?0:kt);if(D)return l;let d=_==(C<0?Ct:wt)?null:M(V/3,_-Ct),f=_==Ct?2:_==wt?1:4;return(C<0?_!=Ct:_!=wt)&&(f|=8),new G(l,f,d)}b+=kt-Dt}return D?_+b:new G(_+b,0,null)}touches(_,C){let D=0,b=h(C),B=this.inverted?2:1,A=this.inverted?1:2;for(let V=0;V<this.ranges.length;V+=3){let Ct=this.ranges[V]-(this.inverted?D:0);if(Ct>_)break;let Dt=this.ranges[V+B];if(_<=Ct+Dt&&V==3*b)return!0;D+=this.ranges[V+A]-Dt}return!1}forEach(_){let C=this.inverted?2:1,D=this.inverted?1:2;for(let b=0,B=0;b<this.ranges.length;b+=3){let A=this.ranges[b],V=A-(this.inverted?B:0),Ct=A+(this.inverted?0:B),Dt=this.ranges[b+C],kt=this.ranges[b+D];_(V,V+Dt,Ct,Ct+kt),B+=kt-Dt}}invert(){return new ut(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(_){return 0==_?ut.empty:new ut(_<0?[0,-_,0]:[0,0,_])}}ut.empty=new ut([]);class et{constructor(_=[],C,D=0,b=_.length){this.maps=_,this.mirror=C,this.from=D,this.to=b}slice(_=0,C=this.maps.length){return new et(this.maps,this.mirror,_,C)}copy(){return new et(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(_,C){this.to=this.maps.push(_),null!=C&&this.setMirror(this.maps.length-1,C)}appendMapping(_){for(let C=0,D=this.maps.length;C<_.maps.length;C++){let b=_.getMirror(C);this.appendMap(_.maps[C],null!=b&&b<C?D+b:void 0)}}getMirror(_){if(this.mirror)for(let C=0;C<this.mirror.length;C++)if(this.mirror[C]==_)return this.mirror[C+(C%2?-1:1)]}setMirror(_,C){this.mirror||(this.mirror=[]),this.mirror.push(_,C)}appendMappingInverted(_){for(let C=_.maps.length-1,D=this.maps.length+_.maps.length;C>=0;C--){let b=_.getMirror(C);this.appendMap(_.maps[C].invert(),null!=b&&b>C?D-b-1:void 0)}}invert(){let _=new et;return _.appendMappingInverted(this),_}map(_,C=1){if(this.mirror)return this._map(_,C,!0);for(let D=this.from;D<this.to;D++)_=this.maps[D].map(_,C);return _}mapResult(_,C=1){return this._map(_,C,!1)}_map(_,C,D){let b=0;for(let B=this.from;B<this.to;B++){let V=this.maps[B].mapResult(_,C);if(null!=V.recover){let Ct=this.getMirror(B);if(null!=Ct&&Ct>B&&Ct<this.to){B=Ct,_=this.maps[Ct].recover(V.recover);continue}}b|=V.delInfo,_=V.pos}return D?_:new G(_,b,null)}}const st=Object.create(null);class Mt{getMap(){return ut.empty}merge(_){return null}static fromJSON(_,C){if(!C||!C.stepType)throw new RangeError("Invalid input for Step.fromJSON");let D=st[C.stepType];if(!D)throw new RangeError(`No step type ${C.stepType} defined`);return D.fromJSON(_,C)}static jsonID(_,C){if(_ in st)throw new RangeError("Duplicate use of step JSON ID "+_);return st[_]=C,C.prototype.jsonID=_,C}}class ht{constructor(_,C){this.doc=_,this.failed=C}static ok(_){return new ht(_,null)}static fail(_){return new ht(null,_)}static fromReplace(_,C,D,b){try{return ht.ok(_.replace(C,D,b))}catch(B){if(B instanceof m.e4)return ht.fail(B.message);throw B}}}function _t(U,_,C){let D=[];for(let b=0;b<U.childCount;b++){let B=U.child(b);B.content.size&&(B=B.copy(_t(B.content,_,B))),B.isInline&&(B=_(B,C,b)),D.push(B)}return m.HY.fromArray(D)}class K extends Mt{constructor(_,C,D){super(),this.from=_,this.to=C,this.mark=D}apply(_){let C=_.slice(this.from,this.to),D=_.resolve(this.from),b=D.node(D.sharedDepth(this.to)),B=new m.p2(_t(C.content,(A,V)=>A.isAtom&&V.type.allowsMarkType(this.mark.type)?A.mark(this.mark.addToSet(A.marks)):A,b),C.openStart,C.openEnd);return ht.fromReplace(_,this.from,this.to,B)}invert(){return new H(this.from,this.to,this.mark)}map(_){let C=_.mapResult(this.from,1),D=_.mapResult(this.to,-1);return C.deleted&&D.deleted||C.pos>=D.pos?null:new K(C.pos,D.pos,this.mark)}merge(_){return _ instanceof K&&_.mark.eq(this.mark)&&this.from<=_.to&&this.to>=_.from?new K(Math.min(this.from,_.from),Math.max(this.to,_.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(_,C){if("number"!=typeof C.from||"number"!=typeof C.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new K(C.from,C.to,_.markFromJSON(C.mark))}}Mt.jsonID("addMark",K);class H extends Mt{constructor(_,C,D){super(),this.from=_,this.to=C,this.mark=D}apply(_){let C=_.slice(this.from,this.to),D=new m.p2(_t(C.content,b=>b.mark(this.mark.removeFromSet(b.marks)),_),C.openStart,C.openEnd);return ht.fromReplace(_,this.from,this.to,D)}invert(){return new K(this.from,this.to,this.mark)}map(_){let C=_.mapResult(this.from,1),D=_.mapResult(this.to,-1);return C.deleted&&D.deleted||C.pos>=D.pos?null:new H(C.pos,D.pos,this.mark)}merge(_){return _ instanceof H&&_.mark.eq(this.mark)&&this.from<=_.to&&this.to>=_.from?new H(Math.min(this.from,_.from),Math.max(this.to,_.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(_,C){if("number"!=typeof C.from||"number"!=typeof C.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new H(C.from,C.to,_.markFromJSON(C.mark))}}Mt.jsonID("removeMark",H);class Y extends Mt{constructor(_,C,D,b=!1){super(),this.from=_,this.to=C,this.slice=D,this.structure=b}apply(_){return this.structure&&dt(_,this.from,this.to)?ht.fail("Structure replace would overwrite content"):ht.fromReplace(_,this.from,this.to,this.slice)}getMap(){return new ut([this.from,this.to-this.from,this.slice.size])}invert(_){return new Y(this.from,this.from+this.slice.size,_.slice(this.from,this.to))}map(_){let C=_.mapResult(this.from,1),D=_.mapResult(this.to,-1);return C.deletedAcross&&D.deletedAcross?null:new Y(C.pos,Math.max(C.pos,D.pos),this.slice)}merge(_){if(!(_ instanceof Y)||_.structure||this.structure)return null;if(this.from+this.slice.size!=_.from||this.slice.openEnd||_.slice.openStart){if(_.to!=this.from||this.slice.openStart||_.slice.openEnd)return null;{let C=this.slice.size+_.slice.size==0?m.p2.empty:new m.p2(_.slice.content.append(this.slice.content),_.slice.openStart,this.slice.openEnd);return new Y(_.from,this.to,C,this.structure)}}{let C=this.slice.size+_.slice.size==0?m.p2.empty:new m.p2(this.slice.content.append(_.slice.content),this.slice.openStart,_.slice.openEnd);return new Y(this.from,this.to+(_.to-_.from),C,this.structure)}}toJSON(){let _={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(_.slice=this.slice.toJSON()),this.structure&&(_.structure=!0),_}static fromJSON(_,C){if("number"!=typeof C.from||"number"!=typeof C.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Y(C.from,C.to,m.p2.fromJSON(_,C.slice),!!C.structure)}}Mt.jsonID("replace",Y);class L extends Mt{constructor(_,C,D,b,B,A,V=!1){super(),this.from=_,this.to=C,this.gapFrom=D,this.gapTo=b,this.slice=B,this.insert=A,this.structure=V}apply(_){if(this.structure&&(dt(_,this.from,this.gapFrom)||dt(_,this.gapTo,this.to)))return ht.fail("Structure gap-replace would overwrite content");let C=_.slice(this.gapFrom,this.gapTo);if(C.openStart||C.openEnd)return ht.fail("Gap is not a flat range");let D=this.slice.insertAt(this.insert,C.content);return D?ht.fromReplace(_,this.from,this.to,D):ht.fail("Content does not fit in gap")}getMap(){return new ut([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(_){let C=this.gapTo-this.gapFrom;return new L(this.from,this.from+this.slice.size+C,this.from+this.insert,this.from+this.insert+C,_.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(_){let C=_.mapResult(this.from,1),D=_.mapResult(this.to,-1),b=_.map(this.gapFrom,-1),B=_.map(this.gapTo,1);return C.deletedAcross&&D.deletedAcross||b<C.pos||B>D.pos?null:new L(C.pos,D.pos,b,B,this.slice,this.insert,this.structure)}toJSON(){let _={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(_.slice=this.slice.toJSON()),this.structure&&(_.structure=!0),_}static fromJSON(_,C){if("number"!=typeof C.from||"number"!=typeof C.to||"number"!=typeof C.gapFrom||"number"!=typeof C.gapTo||"number"!=typeof C.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new L(C.from,C.to,C.gapFrom,C.gapTo,m.p2.fromJSON(_,C.slice),C.insert,!!C.structure)}}function dt(U,_,C){let D=U.resolve(_),b=C-_,B=D.depth;for(;b>0&&B>0&&D.indexAfter(B)==D.node(B).childCount;)B--,b--;if(b>0){let A=D.node(B).maybeChild(D.indexAfter(B));for(;b>0;){if(!A||A.isLeaf)return!0;A=A.firstChild,b--}}return!1}function ot(U,_,C){return(0==_||U.canReplace(_,U.childCount))&&(C==U.childCount||U.canReplace(0,C))}function xt(U){let C=U.parent.content.cutByIndex(U.startIndex,U.endIndex);for(let D=U.depth;;--D){let b=U.$from.node(D),B=U.$from.index(D),A=U.$to.indexAfter(D);if(D<U.depth&&b.canReplace(B,A,C))return D;if(0==D||b.type.spec.isolating||!ot(b,B,A))break}return null}function Bt(U,_,C=null,D=U){let b=function(U,_){let{parent:C,startIndex:D,endIndex:b}=U,B=C.contentMatchAt(D).findWrapping(_);return B&&C.canReplaceWith(D,b,B.length?B[0]:_)?B:null}(U,_),B=b&&function(U,_){let{parent:C,startIndex:D,endIndex:b}=U,B=C.child(D),A=_.contentMatch.findWrapping(B.type);if(!A)return null;let Ct=(A.length?A[A.length-1]:_).contentMatch;for(let Dt=D;Ct&&Dt<b;Dt++)Ct=Ct.matchType(C.child(Dt).type);return Ct&&Ct.validEnd?A:null}(D,_);return B?b.map(tt).concat({type:_,attrs:C}).concat(B.map(tt)):null}function tt(U){return{type:U,attrs:null}}function Q(U,_,C=1,D){let b=U.resolve(_),B=b.depth-C,A=D&&D[D.length-1]||b.parent;if(B<0||b.parent.type.spec.isolating||!b.parent.canReplace(b.index(),b.parent.childCount)||!A.type.validContent(b.parent.content.cutByIndex(b.index(),b.parent.childCount)))return!1;for(let Dt=b.depth-1,kt=C-2;Dt>B;Dt--,kt--){let wt=b.node(Dt),S=b.index(Dt);if(wt.type.spec.isolating)return!1;let l=wt.content.cutByIndex(S,wt.childCount),d=D&&D[kt]||wt;if(d!=wt&&(l=l.replaceChild(0,d.type.create(d.attrs))),!wt.canReplace(S+1,wt.childCount)||!d.type.validContent(l))return!1}let V=b.indexAfter(B),Ct=D&&D[0];return b.node(B).canReplaceWith(V,V,Ct?Ct.type:b.node(B+1).type)}function At(U,_){let C=U.resolve(_),D=C.index();return function(U,_){return!(!U||!_||U.isLeaf||!U.canAppend(_))}(C.nodeBefore,C.nodeAfter)&&C.parent.canReplace(D,D+1)}function me(U,_,C){let D=U.resolve(_);if(!C.content.size)return _;let b=C.content;for(let B=0;B<C.openStart;B++)b=b.firstChild.content;for(let B=1;B<=(0==C.openStart&&C.size?2:1);B++)for(let A=D.depth;A>=0;A--){let V=A==D.depth?0:D.pos<=(D.start(A+1)+D.end(A+1))/2?-1:1,Ct=D.index(A)+(V>0?1:0),Dt=D.node(A),kt=!1;if(1==B)kt=Dt.canReplace(Ct,Ct,b);else{let wt=Dt.contentMatchAt(Ct).findWrapping(b.firstChild.type);kt=wt&&Dt.canReplaceWith(Ct,Ct,wt[0])}if(kt)return 0==V?D.pos:V<0?D.before(A+1):D.after(A+1)}return null}function Ce(U,_,C=_,D=m.p2.empty){if(_==C&&!D.size)return null;let b=U.resolve(_),B=U.resolve(C);return jt(b,B,D)?new Y(_,C,D):new Me(b,B,D).fit()}function jt(U,_,C){return!C.openStart&&!C.openEnd&&U.start()==_.start()&&U.parent.canReplace(U.index(),_.index(),C.content)}Mt.jsonID("replaceAround",L);class Me{constructor(_,C,D){this.$from=_,this.$to=C,this.unplaced=D,this.frontier=[],this.placed=m.HY.empty;for(let b=0;b<=_.depth;b++){let B=_.node(b);this.frontier.push({type:B.type,match:B.contentMatchAt(_.indexAfter(b))})}for(let b=_.depth;b>0;b--)this.placed=m.HY.from(_.node(b).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let Dt=this.findFittable();Dt?this.placeNodes(Dt):this.openMore()||this.dropNode()}let _=this.mustMoveInline(),C=this.placed.size-this.depth-this.$from.depth,D=this.$from,b=this.close(_<0?this.$to:D.doc.resolve(_));if(!b)return null;let B=this.placed,A=D.depth,V=b.depth;for(;A&&V&&1==B.childCount;)B=B.firstChild.content,A--,V--;let Ct=new m.p2(B,A,V);return _>-1?new L(D.pos,_,this.$to.pos,this.$to.end(),Ct,C):Ct.size||D.pos!=this.$to.pos?new Y(D.pos,b.pos,Ct):null}findFittable(){for(let _=1;_<=2;_++)for(let C=this.unplaced.openStart;C>=0;C--){let D,b=null;C?(b=ee(this.unplaced.content,C-1).firstChild,D=b.content):D=this.unplaced.content;let B=D.firstChild;for(let A=this.depth;A>=0;A--){let Dt,{type:V,match:Ct}=this.frontier[A],kt=null;if(1==_&&(B?Ct.matchType(B.type)||(kt=Ct.fillBefore(m.HY.from(B),!1)):b&&V.compatibleContent(b.type)))return{sliceDepth:C,frontierDepth:A,parent:b,inject:kt};if(2==_&&B&&(Dt=Ct.findWrapping(B.type)))return{sliceDepth:C,frontierDepth:A,parent:b,wrap:Dt};if(b&&Ct.matchType(b.type))break}}}openMore(){let{content:_,openStart:C,openEnd:D}=this.unplaced,b=ee(_,C);return!(!b.childCount||b.firstChild.isLeaf||(this.unplaced=new m.p2(_,C+1,Math.max(D,b.size+C>=_.size-D?C+1:0)),0))}dropNode(){let{content:_,openStart:C,openEnd:D}=this.unplaced,b=ee(_,C);if(b.childCount<=1&&C>0){let B=_.size-C<=C+b.size;this.unplaced=new m.p2(Vt(_,C-1,1),C-1,B?C-1:D)}else this.unplaced=new m.p2(Vt(_,C,1),C,D)}placeNodes({sliceDepth:_,frontierDepth:C,parent:D,inject:b,wrap:B}){for(;this.depth>C;)this.closeFrontierNode();if(B)for(let f=0;f<B.length;f++)this.openFrontierNode(B[f]);let A=this.unplaced,V=D?D.content:A.content,Ct=A.openStart-_,Dt=0,kt=[],{match:wt,type:S}=this.frontier[C];if(b){for(let f=0;f<b.childCount;f++)kt.push(b.child(f));wt=wt.matchFragment(b)}let l=V.size+_-(A.content.size-A.openEnd);for(;Dt<V.childCount;){let f=V.child(Dt),v=wt.matchType(f.type);if(!v)break;Dt++,(Dt>1||0==Ct||f.content.size)&&(wt=v,kt.push(Oe(f.mark(S.allowedMarks(f.marks)),1==Dt?Ct:0,Dt==V.childCount?l:-1)))}let d=Dt==V.childCount;d||(l=-1),this.placed=Gt(this.placed,C,m.HY.from(kt)),this.frontier[C].match=wt,d&&l<0&&D&&D.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,v=V;f<l;f++){let O=v.lastChild;this.frontier.push({type:O.type,match:O.contentMatchAt(O.childCount)}),v=O.content}this.unplaced=d?0==_?m.p2.empty:new m.p2(Vt(A.content,_-1,1),_-1,l<0?A.openEnd:_-1):new m.p2(Vt(A.content,_,Dt),A.openStart,A.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let C,_=this.frontier[this.depth];if(!_.type.isTextblock||!Xt(this.$to,this.$to.depth,_.type,_.match,!1)||this.$to.depth==this.depth&&(C=this.findCloseLevel(this.$to))&&C.depth==this.depth)return-1;let{depth:D}=this.$to,b=this.$to.after(D);for(;D>1&&b==this.$to.end(--D);)++b;return b}findCloseLevel(_){t:for(let C=Math.min(this.depth,_.depth);C>=0;C--){let{match:D,type:b}=this.frontier[C],B=C<_.depth&&_.end(C+1)==_.pos+(_.depth-(C+1)),A=Xt(_,C,b,D,B);if(A){for(let V=C-1;V>=0;V--){let{match:Ct,type:Dt}=this.frontier[V],kt=Xt(_,V,Dt,Ct,!0);if(!kt||kt.childCount)continue t}return{depth:C,fit:A,move:B?_.doc.resolve(_.after(C+1)):_}}}}close(_){let C=this.findCloseLevel(_);if(!C)return null;for(;this.depth>C.depth;)this.closeFrontierNode();C.fit.childCount&&(this.placed=Gt(this.placed,C.depth,C.fit)),_=C.move;for(let D=C.depth+1;D<=_.depth;D++){let b=_.node(D),B=b.type.contentMatch.fillBefore(b.content,!0,_.index(D));this.openFrontierNode(b.type,b.attrs,B)}return _}openFrontierNode(_,C=null,D){let b=this.frontier[this.depth];b.match=b.match.matchType(_),this.placed=Gt(this.placed,this.depth,m.HY.from(_.create(C,D))),this.frontier.push({type:_,match:_.contentMatch})}closeFrontierNode(){let C=this.frontier.pop().match.fillBefore(m.HY.empty,!0);C.childCount&&(this.placed=Gt(this.placed,this.frontier.length,C))}}function Vt(U,_,C){return 0==_?U.cutByIndex(C,U.childCount):U.replaceChild(0,U.firstChild.copy(Vt(U.firstChild.content,_-1,C)))}function Gt(U,_,C){return 0==_?U.append(C):U.replaceChild(U.childCount-1,U.lastChild.copy(Gt(U.lastChild.content,_-1,C)))}function ee(U,_){for(let C=0;C<_;C++)U=U.firstChild.content;return U}function Oe(U,_,C){if(_<=0)return U;let D=U.content;return _>1&&(D=D.replaceChild(0,Oe(D.firstChild,_-1,1==D.childCount?C-1:0))),_>0&&(D=U.type.contentMatch.fillBefore(D).append(D),C<=0&&(D=D.append(U.type.contentMatch.matchFragment(D).fillBefore(m.HY.empty,!0)))),U.copy(D)}function Xt(U,_,C,D,b){let B=U.node(_),A=b?U.indexAfter(_):U.index(_);if(A==B.childCount&&!C.compatibleContent(B.type))return null;let V=D.fillBefore(B.content,!0,A);return V&&!function(U,_,C){for(let D=C;D<_.childCount;D++)if(!U.allowsMarks(_.child(D).marks))return!0;return!1}(C,B.content,A)?V:null}function _e(U){return U.spec.defining||U.spec.definingForContent}function re(U,_,C,D,b){if(_<C){let B=U.firstChild;U=U.replaceChild(0,B.copy(re(B.content,_+1,C,D,B)))}if(_>D){let B=b.contentMatchAt(0),A=B.fillBefore(U).append(U);U=A.append(B.matchFragment(A).fillBefore(m.HY.empty,!0))}return U}function se(U,_){let C=[];for(let b=Math.min(U.depth,_.depth);b>=0;b--){let B=U.start(b);if(B<U.pos-(U.depth-b)||_.end(b)>_.pos+(_.depth-b)||U.node(b).type.spec.isolating||_.node(b).type.spec.isolating)break;(B==_.start(b)||b==U.depth&&b==_.depth&&U.parent.inlineContent&&_.parent.inlineContent&&b&&_.start(b-1)==B-1)&&C.push(b)}return C}let Jt=class extends Error{};Jt=function U(_){let C=Error.call(this,_);return C.__proto__=U.prototype,C},(Jt.prototype=Object.create(Error.prototype)).constructor=Jt,Jt.prototype.name="TransformError";class le{constructor(_){this.doc=_,this.steps=[],this.docs=[],this.mapping=new et}get before(){return this.docs.length?this.docs[0]:this.doc}step(_){let C=this.maybeStep(_);if(C.failed)throw new Jt(C.failed);return this}maybeStep(_){let C=_.apply(this.doc);return C.failed||this.addStep(_,C.doc),C}get docChanged(){return this.steps.length>0}addStep(_,C){this.docs.push(this.doc),this.steps.push(_),this.mapping.appendMap(_.getMap()),this.doc=C}replace(_,C=_,D=m.p2.empty){let b=Ce(this.doc,_,C,D);return b&&this.step(b),this}replaceWith(_,C,D){return this.replace(_,C,new m.p2(m.HY.from(D),0,0))}delete(_,C){return this.replace(_,C,m.p2.empty)}insert(_,C){return this.replaceWith(_,_,C)}replaceRange(_,C,D){return function(U,_,C,D){if(!D.size)return U.deleteRange(_,C);let b=U.doc.resolve(_),B=U.doc.resolve(C);if(jt(b,B,D))return U.step(new Y(_,C,D));let A=se(b,U.doc.resolve(C));0==A[A.length-1]&&A.pop();let V=-(b.depth+1);A.unshift(V);for(let S=b.depth,l=b.pos-1;S>0;S--,l--){let d=b.node(S).type.spec;if(d.defining||d.definingAsContext||d.isolating)break;A.indexOf(S)>-1?V=S:b.before(S)==l&&A.splice(1,0,-S)}let Ct=A.indexOf(V),Dt=[],kt=D.openStart;for(let S=D.content,l=0;;l++){let d=S.firstChild;if(Dt.push(d),l==D.openStart)break;S=d.content}for(let S=kt-1;S>=0;S--){let l=Dt[S].type,d=_e(l);if(d&&b.node(Ct).type!=l)kt=S;else if(d||!l.isTextblock)break}for(let S=D.openStart;S>=0;S--){let l=(S+kt+1)%(D.openStart+1),d=Dt[l];if(d)for(let f=0;f<A.length;f++){let v=A[(f+Ct)%A.length],O=!0;v<0&&(O=!1,v=-v);let N=b.node(v-1),lt=b.index(v-1);if(N.canReplaceWith(lt,lt,d.type,d.marks))return U.replace(b.before(v),O?B.after(v):C,new m.p2(re(D.content,0,D.openStart,l),l,D.openEnd))}}let wt=U.steps.length;for(let S=A.length-1;S>=0&&(U.replace(_,C,D),!(U.steps.length>wt));S--){let l=A[S];l<0||(_=b.before(l),C=B.after(l))}}(this,_,C,D),this}replaceRangeWith(_,C,D){return function(U,_,C,D){if(!D.isInline&&_==C&&U.doc.resolve(_).parent.content.size){let b=function(U,_,C){let D=U.resolve(_);if(D.parent.canReplaceWith(D.index(),D.index(),C))return _;if(0==D.parentOffset)for(let b=D.depth-1;b>=0;b--){let B=D.index(b);if(D.node(b).canReplaceWith(B,B,C))return D.before(b+1);if(B>0)return null}if(D.parentOffset==D.parent.content.size)for(let b=D.depth-1;b>=0;b--){let B=D.indexAfter(b);if(D.node(b).canReplaceWith(B,B,C))return D.after(b+1);if(B<D.node(b).childCount)return null}return null}(U.doc,_,D.type);null!=b&&(_=C=b)}U.replaceRange(_,C,new m.p2(m.HY.from(D),0,0))}(this,_,C,D),this}deleteRange(_,C){return function(U,_,C){let D=U.doc.resolve(_),b=U.doc.resolve(C),B=se(D,b);for(let A=0;A<B.length;A++){let V=B[A],Ct=A==B.length-1;if(Ct&&0==V||D.node(V).type.contentMatch.validEnd)return U.delete(D.start(V),b.end(V));if(V>0&&(Ct||D.node(V-1).canReplace(D.index(V-1),b.indexAfter(V-1))))return U.delete(D.before(V),b.after(V))}for(let A=1;A<=D.depth&&A<=b.depth;A++)if(_-D.start(A)==D.depth-A&&C>D.end(A)&&b.end(A)-C!=b.depth-A)return U.delete(D.before(A),C);U.delete(_,C)}(this,_,C),this}lift(_,C){return function(U,_,C){let{$from:D,$to:b,depth:B}=_,A=D.before(B+1),V=b.after(B+1),Ct=A,Dt=V,kt=m.HY.empty,wt=0;for(let d=B,f=!1;d>C;d--)f||D.index(d)>0?(f=!0,kt=m.HY.from(D.node(d).copy(kt)),wt++):Ct--;let S=m.HY.empty,l=0;for(let d=B,f=!1;d>C;d--)f||b.after(d+1)<b.end(d)?(f=!0,S=m.HY.from(b.node(d).copy(S)),l++):Dt++;U.step(new L(Ct,Dt,A,V,new m.p2(kt.append(S),wt,l),kt.size-wt,!0))}(this,_,C),this}join(_,C=1){return function(U,_,C){let D=new Y(_-C,_+C,m.p2.empty,!0);U.step(D)}(this,_,C),this}wrap(_,C){return function(U,_,C){let D=m.HY.empty;for(let A=C.length-1;A>=0;A--){if(D.size){let V=C[A].type.contentMatch.matchFragment(D);if(!V||!V.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}D=m.HY.from(C[A].type.create(C[A].attrs,D))}let b=_.start,B=_.end;U.step(new L(b,B,b,B,new m.p2(D,0,0),C.length,!0))}(this,_,C),this}setBlockType(_,C=_,D,b=null){return function(U,_,C,D,b){if(!D.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let B=U.steps.length;U.doc.nodesBetween(_,C,(A,V)=>{if(A.isTextblock&&!A.hasMarkup(D,b)&&function(U,_,C){let D=U.resolve(_),b=D.index();return D.parent.canReplaceWith(b,b+1,C)}(U.doc,U.mapping.slice(B).map(V),D)){U.clearIncompatible(U.mapping.slice(B).map(V,1),D);let Ct=U.mapping.slice(B),Dt=Ct.map(V,1),kt=Ct.map(V+A.nodeSize,1);return U.step(new L(Dt,kt,Dt+1,kt-1,new m.p2(m.HY.from(D.create(b,null,A.marks)),0,0),1,!0)),!1}})}(this,_,C,D,b),this}setNodeMarkup(_,C,D=null,b=[]){return function(U,_,C,D,b){let B=U.doc.nodeAt(_);if(!B)throw new RangeError("No node at given position");C||(C=B.type);let A=C.create(D,null,b||B.marks);if(B.isLeaf)return U.replaceWith(_,_+B.nodeSize,A);if(!C.validContent(B.content))throw new RangeError("Invalid content for node type "+C.name);U.step(new L(_,_+B.nodeSize,_+1,_+B.nodeSize-1,new m.p2(m.HY.from(A),0,0),1,!0))}(this,_,C,D,b),this}split(_,C=1,D){return function(U,_,C=1,D){let b=U.doc.resolve(_),B=m.HY.empty,A=m.HY.empty;for(let V=b.depth,Ct=b.depth-C,Dt=C-1;V>Ct;V--,Dt--){B=m.HY.from(b.node(V).copy(B));let kt=D&&D[Dt];A=m.HY.from(kt?kt.type.create(kt.attrs,A):b.node(V).copy(A))}U.step(new Y(_,_,new m.p2(B.append(A),C,C),!0))}(this,_,C,D),this}addMark(_,C,D){return function(U,_,C,D){let A,V,b=[],B=[];U.doc.nodesBetween(_,C,(Ct,Dt,kt)=>{if(!Ct.isInline)return;let wt=Ct.marks;if(!D.isInSet(wt)&&kt.type.allowsMarkType(D.type)){let S=Math.max(Dt,_),l=Math.min(Dt+Ct.nodeSize,C),d=D.addToSet(wt);for(let f=0;f<wt.length;f++)wt[f].isInSet(d)||(A&&A.to==S&&A.mark.eq(wt[f])?A.to=l:b.push(A=new H(S,l,wt[f])));V&&V.to==S?V.to=l:B.push(V=new K(S,l,D))}}),b.forEach(Ct=>U.step(Ct)),B.forEach(Ct=>U.step(Ct))}(this,_,C,D),this}removeMark(_,C,D){return function(U,_,C,D){let b=[],B=0;U.doc.nodesBetween(_,C,(A,V)=>{if(!A.isInline)return;B++;let Ct=null;if(D instanceof m.ZU){let kt,Dt=A.marks;for(;kt=D.isInSet(Dt);)(Ct||(Ct=[])).push(kt),Dt=kt.removeFromSet(Dt)}else D?D.isInSet(A.marks)&&(Ct=[D]):Ct=A.marks;if(Ct&&Ct.length){let Dt=Math.min(V+A.nodeSize,C);for(let kt=0;kt<Ct.length;kt++){let S,wt=Ct[kt];for(let l=0;l<b.length;l++){let d=b[l];d.step==B-1&&wt.eq(b[l].style)&&(S=d)}S?(S.to=Dt,S.step=B):b.push({style:wt,from:Math.max(V,_),to:Dt,step:B})}}}),b.forEach(A=>U.step(new H(A.from,A.to,A.style)))}(this,_,C,D),this}clearIncompatible(_,C,D){return function(U,_,C,D=C.contentMatch){let b=U.doc.nodeAt(_),B=[],A=_+1;for(let V=0;V<b.childCount;V++){let Ct=b.child(V),Dt=A+Ct.nodeSize,kt=D.matchType(Ct.type);if(kt){D=kt;for(let wt=0;wt<Ct.marks.length;wt++)C.allowsMarkType(Ct.marks[wt].type)||U.step(new H(A,Dt,Ct.marks[wt]))}else B.push(new Y(A,Dt,m.p2.empty));A=Dt}if(!D.validEnd){let V=D.fillBefore(m.HY.empty,!0);U.replace(A,A,new m.p2(V,0,0))}for(let V=B.length-1;V>=0;V--)U.step(B[V])}(this,_,C,D),this}}},43594:(Pt,ct,c)=>{c.d(ct,{p:()=>ge,EH:()=>oe,tk:()=>Po});var m=c(62463),s=c(35917),k=c(38480);const M="undefined"!=typeof navigator?navigator:null,h="undefined"!=typeof document?document:null,j=M&&M.userAgent||"",y=/Edge\/(\d+)/.exec(j),X=/MSIE \d/.exec(j),$=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(j),rt=!!(X||$||y),G=X?document.documentMode:$?+$[1]:y?+y[1]:0,ut=!rt&&/gecko\/(\d+)/i.test(j);ut&&/Firefox\/(\d+)/.exec(j);const et=!rt&&/Chrome\/(\d+)/.exec(j),st=!!et,Mt=et?+et[1]:0,ht=!rt&&!!M&&/Apple Computer/.test(M.vendor),_t=ht&&(/Mobile\/\w+/.test(j)||!!M&&M.maxTouchPoints>2),K=_t||!!M&&/Mac/.test(M.platform),H=/Android \d/.test(j),Y=!!h&&"webkitFontSmoothing"in h.documentElement.style,L=Y?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,dt=function(n){for(var t=0;;t++)if(!(n=n.previousSibling))return t},pt=function(n){let t=n.assignedSlot||n.parentNode;return t&&11==t.nodeType?t.host:t};let ft=null;const gt=function(n,t,e){let o=ft||(ft=document.createRange());return o.setEnd(n,null==e?n.nodeValue.length:e),o.setStart(n,t||0),o},ot=function(n,t,e,o){return e&&(bt(n,t,e,o,-1)||bt(n,t,e,o,1))},xt=/^(img|br|input|textarea|hr)$/i;function bt(n,t,e,o,i){for(;;){if(n==e&&t==o)return!0;if(t==(i<0?0:Bt(n))){let r=n.parentNode;if(!r||1!=r.nodeType||E(n)||xt.test(n.nodeName)||"false"==n.contentEditable)return!1;t=dt(n)+(i<0?0:1),n=r}else{if(1!=n.nodeType)return!1;if("false"==(n=n.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?Bt(n):0}}}function Bt(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function E(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const z=function(n){let t=n.isCollapsed;return t&&st&&n.rangeCount&&!n.getRangeAt(0).collapsed&&(t=!1),t};function Z(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function at(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function I(n,t){return"number"==typeof n?n:n[t]}function J(n){let t=n.getBoundingClientRect();return{left:t.left,right:t.left+n.clientWidth*(t.width/n.offsetWidth||1),top:t.top,bottom:t.top+n.clientHeight*(t.height/n.offsetHeight||1)}}function Q(n,t,e){let o=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,r=n.dom.ownerDocument;for(let a=e||n.dom;a;a=pt(a)){if(1!=a.nodeType)continue;let u=a,p=u==r.body,T=p?at(r):J(u),g=0,R=0;if(t.top<T.top+I(o,"top")?R=-(T.top-t.top+I(i,"top")):t.bottom>T.bottom-I(o,"bottom")&&(R=t.bottom-T.bottom+I(i,"bottom")),t.left<T.left+I(o,"left")?g=-(T.left-t.left+I(i,"left")):t.right>T.right-I(o,"right")&&(g=t.right-T.right+I(i,"right")),g||R)if(p)r.defaultView.scrollBy(g,R);else{let w=u.scrollLeft,W=u.scrollTop;R&&(u.scrollTop+=R),g&&(u.scrollLeft+=g);let it=u.scrollLeft-w,mt=u.scrollTop-W;t={left:t.left-it,top:t.top-mt,right:t.right-it,bottom:t.bottom-mt}}if(p)break}}function At(n){let t=[],e=n.ownerDocument;for(let o=n;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),n!=e);o=pt(o));return t}function Zt(n,t){for(let e=0;e<n.length;e++){let{dom:o,top:i,left:r}=n[e];o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=r&&(o.scrollLeft=r)}}let zt=null;function me(n,t){let e,i,o=2e8,r=0,a=t.top,u=t.top;for(let p=n.firstChild,T=0;p;p=p.nextSibling,T++){let g;if(1==p.nodeType)g=p.getClientRects();else{if(3!=p.nodeType)continue;g=gt(p).getClientRects()}for(let R=0;R<g.length;R++){let w=g[R];if(w.top<=a&&w.bottom>=u){a=Math.max(w.bottom,a),u=Math.min(w.top,u);let W=w.left>t.left?w.left-t.left:w.right<t.left?t.left-w.right:0;if(W<o){e=p,o=W,i=W&&3==e.nodeType?{left:w.right<t.left?w.right:w.left,top:t.top}:t,1==p.nodeType&&W&&(r=T+(t.left>=(w.left+w.right)/2?1:0));continue}}!e&&(t.left>=w.right&&t.top>=w.top||t.left>=w.left&&t.top>=w.bottom)&&(r=T+1)}}return e&&3==e.nodeType?function(n,t){let e=n.nodeValue.length,o=document.createRange();for(let i=0;i<e;i++){o.setEnd(n,i+1),o.setStart(n,i);let r=Xt(o,1);if(r.top!=r.bottom&&jt(t,r))return{node:n,offset:i+(t.left>=(r.left+r.right)/2?1:0)}}return{node:n,offset:0}}(e,i):!e||o&&1==e.nodeType?{node:n,offset:r}:me(e,i)}function jt(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function ee(n,t,e){let o=n.childNodes.length;if(o&&e.top<e.bottom)for(let i=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-e.top)/(e.bottom-e.top))-2)),r=i;;){let a=n.childNodes[r];if(1==a.nodeType){let u=a.getClientRects();for(let p=0;p<u.length;p++){let T=u[p];if(jt(t,T))return ee(a,t,T)}}if((r=(r+1)%o)==i)break}return n}function Oe(n,t){let o,e=n.dom.ownerDocument,i=0;if(e.caretPositionFromPoint)try{let p=e.caretPositionFromPoint(t.left,t.top);p&&({offsetNode:o,offset:i}=p)}catch(p){}if(!o&&e.caretRangeFromPoint){let p=e.caretRangeFromPoint(t.left,t.top);p&&({startContainer:o,startOffset:i}=p)}let a,r=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top);if(!r||!n.dom.contains(1!=r.nodeType?r.parentNode:r)){let p=n.dom.getBoundingClientRect();if(!jt(t,p)||(r=ee(n.dom,t,p),!r))return null}if(ht)for(let p=r;o&&p;p=pt(p))p.draggable&&(o=void 0);if(r=function(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}(r,t),o){if(ut&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length),i<o.childNodes.length)){let T,p=o.childNodes[i];"IMG"==p.nodeName&&(T=p.getBoundingClientRect()).right<=t.left&&T.bottom>t.top&&i++}o==n.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(0==i||1!=o.nodeType||"BR"!=o.childNodes[i-1].nodeName)&&(a=function(n,t,e,o){let i=-1;for(let r=t;r!=n.dom;){let a=n.docView.nearestDesc(r,!0);if(!a)return null;if(a.node.isBlock&&a.parent){let u=a.dom.getBoundingClientRect();if(u.left>o.left||u.top>o.top)i=a.posBefore;else{if(!(u.right<o.left||u.bottom<o.top))break;i=a.posAfter}}r=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,1)}(n,o,i,t))}null==a&&(a=function(n,t,e){let{node:o,offset:i}=me(t,e),r=-1;if(1==o.nodeType&&!o.firstChild){let a=o.getBoundingClientRect();r=a.left!=a.right&&e.left>(a.left+a.right)/2?1:-1}return n.docView.posFromDOM(o,i,r)}(n,r,t));let u=n.docView.nearestDesc(r,!0);return{pos:a,inside:u?u.posAtStart-u.border:-1}}function Xt(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const Ee=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function _e(n,t,e){let{node:o,offset:i,atom:r}=n.docView.domFromPos(t,e<0?-1:1),a=Y||ut;if(3==o.nodeType){if(!a||!Ee.test(o.nodeValue)&&(e<0?i:i!=o.nodeValue.length)){let p=i,T=i,g=e<0?1:-1;return e<0&&!i?(T++,g=-1):e>=0&&i==o.nodeValue.length?(p--,g=1):e<0?p--:T++,ne(Xt(gt(o,p,T),g),g<0)}{let p=Xt(gt(o,i,i),e);if(ut&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){let T=Xt(gt(o,i-1,i-1),-1);if(T.top==p.top){let g=Xt(gt(o,i,i+1),-1);if(g.top!=p.top)return ne(g,g.left<T.left)}}return p}}if(!n.state.doc.resolve(t-(r||0)).parent.inlineContent){if(null==r&&i&&(e<0||i==Bt(o))){let p=o.childNodes[i-1];if(1==p.nodeType)return re(p.getBoundingClientRect(),!1)}if(null==r&&i<Bt(o)){let p=o.childNodes[i];if(1==p.nodeType)return re(p.getBoundingClientRect(),!0)}return re(o.getBoundingClientRect(),e>=0)}if(null==r&&i&&(e<0||i==Bt(o))){let p=o.childNodes[i-1],T=3==p.nodeType?gt(p,Bt(p)-(a?0:1)):1!=p.nodeType||"BR"==p.nodeName&&p.nextSibling?null:p;if(T)return ne(Xt(T,1),!1)}if(null==r&&i<Bt(o)){let p=o.childNodes[i];for(;p.pmViewDesc&&p.pmViewDesc.ignoreForCoords;)p=p.nextSibling;let T=p?3==p.nodeType?gt(p,0,a?0:1):1==p.nodeType?p:null:null;if(T)return ne(Xt(T,-1),!0)}return ne(Xt(3==o.nodeType?gt(o):o,-e),e>=0)}function ne(n,t){if(0==n.width)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function re(n,t){if(0==n.height)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function ve(n,t,e){let o=n.state,i=n.root.activeElement;o!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{o!=t&&n.updateState(o),i!=n.dom&&i&&i.focus()}}const se=/[\u0590-\u08ac]/;let le=null,U=null,_=!1;class V{constructor(t,e,o,i){this.parent=t,this.children=e,this.dom=o,this.contentDOM=i,this.dirty=0,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,o=this.posAtStart;;e++){let i=this.children[e];if(i==t)return o;o+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,o){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(o<0){let r,a;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(a=r.pmViewDesc)||a.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(a)+a.size:this.posAtStart}{let r,a;if(t==this.contentDOM)r=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.nextSibling}for(;r&&(!(a=r.pmViewDesc)||a.parent!=this);)r=r.nextSibling;return r?this.posBeforeChild(a):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>dt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!1;break}if(r.previousSibling)break}if(null==i&&e==t.childNodes.length)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!0;break}if(r.nextSibling)break}}return(null==i?o>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let o=!0,i=t;i;i=i.parentNode){let a,r=this.getDesc(i);if(r&&(!e||r.node)){if(!o||!(a=r.nodeDOM)||(1==a.nodeType?a.contains(1==t.nodeType?t:t.parentNode):a==t))return r;o=!1}}}getDesc(t){let e=t.pmViewDesc;for(let o=e;o;o=o.parent)if(o==this)return e}posFromDOM(t,e,o){for(let i=t;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(t,e,o)}return-1}descAt(t){for(let e=0,o=0;e<this.children.length;e++){let i=this.children[e],r=o+i.size;if(o==t&&r!=o){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<r)return i.descAt(t-o-i.border);o=r}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r,o=0,i=0;for(let r=0;o<this.children.length;o++){let a=this.children[o],u=r+a.size;if(u>t||a instanceof d){i=t-r;break}r=u}if(i)return this.children[o].domFromPos(i-this.children[o].border,e);for(;o&&!(r=this.children[o-1]).size&&r instanceof Ct&&r.side>=0;o--);if(e<=0){let r,a=!0;for(;r=o?this.children[o-1]:null,r&&r.dom.parentNode!=this.contentDOM;o--,a=!1);return r&&e&&a&&!r.border&&!r.domAtom?r.domFromPos(r.size,e):{node:this.contentDOM,offset:r?dt(r.dom)+1:0}}{let r,a=!0;for(;r=o<this.children.length?this.children[o]:null,r&&r.dom.parentNode!=this.contentDOM;o++,a=!1);return r&&a&&!r.border&&!r.domAtom?r.domFromPos(0,e):{node:this.contentDOM,offset:r?dt(r.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,o=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let a=o,u=0;;u++){let p=this.children[u],T=a+p.size;if(-1==i&&t<=T){let g=a+p.border;if(t>=g&&e<=T-p.border&&p.node&&p.contentDOM&&this.contentDOM.contains(p.contentDOM))return p.parseRange(t,e,g);t=a;for(let R=u;R>0;R--){let w=this.children[R-1];if(w.size&&w.dom.parentNode==this.contentDOM&&!w.emptyChildAt(1)){i=dt(w.dom)+1;break}t-=w.size}-1==i&&(i=0)}if(i>-1&&(T>e||u==this.children.length-1)){e=T;for(let g=u+1;g<this.children.length;g++){let R=this.children[g];if(R.size&&R.dom.parentNode==this.contentDOM&&!R.emptyChildAt(-1)){r=dt(R.dom);break}e+=R.size}-1==r&&(r=this.contentDOM.childNodes.length);break}a=T}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:o}=this.domFromPos(t,0);if(1!=e.nodeType||o==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[o]}setSelection(t,e,o,i=!1){let r=Math.min(t,e),a=Math.max(t,e);for(let w=0,W=0;w<this.children.length;w++){let it=this.children[w],mt=W+it.size;if(r>W&&a<mt)return it.setSelection(t-W-it.border,e-W-it.border,o,i);W=mt}let u=this.domFromPos(t,t?-1:1),p=e==t?u:this.domFromPos(e,e?-1:1),T=o.getSelection(),g=!1;if((ut||ht)&&t==e){let{node:w,offset:W}=u;if(3==w.nodeType){if(g=!(!W||"\n"!=w.nodeValue[W-1]),g&&W==w.nodeValue.length)for(let mt,it=w;it;it=it.parentNode){if(mt=it.nextSibling){"BR"==mt.nodeName&&(u=p={node:mt.parentNode,offset:dt(mt)+1});break}let Ot=it.pmViewDesc;if(Ot&&Ot.node&&Ot.node.isBlock)break}}else{let it=w.childNodes[W-1];g=it&&("BR"==it.nodeName||"false"==it.contentEditable)}}if(ut&&T.focusNode&&T.focusNode!=p.node&&1==T.focusNode.nodeType){let w=T.focusNode.childNodes[T.focusOffset];w&&"false"==w.contentEditable&&(i=!0)}if(!(i||g&&ht)&&ot(u.node,u.offset,T.anchorNode,T.anchorOffset)&&ot(p.node,p.offset,T.focusNode,T.focusOffset))return;let R=!1;if((T.extend||t==e)&&!g){T.collapse(u.node,u.offset);try{t!=e&&T.extend(p.node,p.offset),R=!0}catch(w){if(!(w instanceof DOMException))throw w}}if(!R){if(t>e){let W=u;u=p,p=W}let w=document.createRange();w.setEnd(p.node,p.offset),w.setStart(u.node,u.offset),T.removeAllRanges(),T.addRange(w)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let o=0,i=0;i<this.children.length;i++){let r=this.children[i],a=o+r.size;if(o==a?t<=a&&e>=o:t<a&&e>o){let u=o+r.border,p=a-r.border;if(t>=u&&e<=p)return this.dirty=t==o||e==a?2:1,void(t!=u||e!=p||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-u,e-u):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}o=a}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let o=1==t?2:1;e.dirty<o&&(e.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Ct extends V{constructor(t,e,o,i){let r,a=e.type.toDOM;if("function"==typeof a&&(a=a(o,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!e.type.spec.raw){if(1!=a.nodeType){let u=document.createElement("span");u.appendChild(a),a=u}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(t,[],a,null),this.widget=e,this.widget=e,r=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Dt extends V{constructor(t,e,o,i){super(t,[],e,null),this.textDOM=o,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class kt extends V{constructor(t,e,o,i){super(t,[],o,i),this.mark=e}static create(t,e,o,i){let r=i.nodeViews[e.type.name],a=r&&r(e,i,o);return(!a||!a.dom)&&(a=s.PW.renderSpec(document,e.type.spec.toDOM(e,o))),new kt(t,e,a.dom,a.contentDOM||a.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}}slice(t,e,o){let i=kt.create(this.parent,this.mark,!0,o),r=this.children,a=this.size;e<a&&(r=Ft(r,e,a,o)),t>0&&(r=Ft(r,0,t,o));for(let u=0;u<r.length;u++)r[u].parent=i;return i.children=r,i}}class wt extends V{constructor(t,e,o,i,r,a,u,p,T){super(t,[],r,a),this.node=e,this.outerDeco=o,this.innerDeco=i,this.nodeDOM=u,a&&this.updateChildren(p,T)}static create(t,e,o,i,r,a){let p,u=r.nodeViews[e.type.name],T=u&&u(e,r,()=>p?p.parent?p.parent.posBeforeChild(p):void 0:a,o,i),g=T&&T.dom,R=T&&T.contentDOM;if(e.isText)if(g){if(3!=g.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else g=document.createTextNode(e.text);else g||({dom:g,contentDOM:R}=s.PW.renderSpec(document,e.type.spec.toDOM(e)));!R&&!e.isText&&"BR"!=g.nodeName&&(g.hasAttribute("contenteditable")||(g.contentEditable="false"),e.type.spec.draggable&&(g.draggable=!0));let w=g;return g=x(g,o,e),T?p=new f(t,e,o,i,g,R||null,w,T,r,a+1):e.isText?new l(t,e,o,i,g,w,r):new wt(t,e,o,i,g,R||null,w,r,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let o=this.children[e];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>s.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,o){return 0==this.dirty&&t.eq(this.node)&&F(e,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let o=this.node.inlineContent,i=e,r=t.composing?this.localCompositionInfo(t,e):null,a=r&&r.pos>-1?r:null,u=r&&r.pos<0,p=new nt(this,a&&a.node);(function(n,t,e,o){let i=t.locals(n),r=0;if(0==i.length){for(let T=0;T<n.childCount;T++){let g=n.child(T);o(g,i,t.forChild(r,g),T),r+=g.nodeSize}return}let a=0,u=[],p=null;for(let T=0;;){if(a<i.length&&i[a].to==r){let mt,it=i[a++];for(;a<i.length&&i[a].to==r;)(mt||(mt=[it])).push(i[a++]);if(mt){mt.sort(vt);for(let Ot=0;Ot<mt.length;Ot++)e(mt[Ot],T,!!p)}else e(it,T,!!p)}let g,R;if(p)R=-1,g=p,p=null;else{if(!(T<n.childCount))break;R=T,g=n.child(T++)}for(let it=0;it<u.length;it++)u[it].to<=r&&u.splice(it--,1);for(;a<i.length&&i[a].from<=r&&i[a].to>r;)u.push(i[a++]);let w=r+g.nodeSize;if(g.isText){let it=w;a<i.length&&i[a].from<it&&(it=i[a].from);for(let mt=0;mt<u.length;mt++)u[mt].to<it&&(it=u[mt].to);it<w&&(p=g.cut(it-r),g=g.cut(0,it-r),w=it,R=-1)}o(g,g.isInline&&!g.isLeaf?u.filter(it=>!it.inline):u.slice(),t.forChild(r,g),R),r=w}})(this.node,this.innerDeco,(T,g,R)=>{T.spec.marks?p.syncToMarks(T.spec.marks,o,t):T.type.side>=0&&!R&&p.syncToMarks(g==this.node.childCount?s.vc.none:this.node.child(g).marks,o,t),p.placeWidget(T,t,i)},(T,g,R,w)=>{let W;p.syncToMarks(T.marks,o,t),p.findNodeMatch(T,g,R,w)||u&&t.state.selection.from>i&&t.state.selection.to<i+T.nodeSize&&(W=p.findIndexWithChild(r.node))>-1&&p.updateNodeAt(T,g,R,W,t)||p.updateNextNode(T,g,R,t,w)||p.addNode(T,g,R,t,i),i+=T.nodeSize}),p.syncToMarks([],o,t),this.node.isTextblock&&p.addTextblockHacks(),p.destroyRest(),(p.changed||2==this.dirty)&&(a&&this.protectLocalComposition(t,a),v(this.contentDOM,this.children,t),_t&&function(n){if("UL"==n.nodeName||"OL"==n.nodeName){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n),n.style.cssText=t}}(this.dom))}localCompositionInfo(t,e){let{from:o,to:i}=t.state.selection;if(!(t.state.selection instanceof m.Bs)||o<e||i>e+this.node.content.size)return null;let r=t.domSelection(),a=function(n,t){for(;;){if(3==n.nodeType)return n;if(1==n.nodeType&&t>0){if(n.childNodes.length>t&&3==n.childNodes[t].nodeType)return n.childNodes[t];t=Bt(n=n.childNodes[t-1])}else{if(!(1==n.nodeType&&t<n.childNodes.length))return null;n=n.childNodes[t],t=0}}}(r.focusNode,r.focusOffset);if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let u=a.nodeValue,p=function(n,t,e,o){for(let i=0,r=0;i<n.childCount&&r<=o;){let a=n.child(i++),u=r;if(r+=a.nodeSize,!a.isText)continue;let p=a.text;for(;i<n.childCount;){let T=n.child(i++);if(r+=T.nodeSize,!T.isText)break;p+=T.text}if(r>=e){let T=u<o?p.lastIndexOf(t,o-u-1):-1;if(T>=0&&T+t.length+u>=e)return u+T;if(e==o&&p.length>=o+t.length-u&&p.slice(o-u,o-u+t.length)==t)return o}}return-1}(this.node.content,u,o-e,i-e);return p<0?null:{node:a,pos:p,text:u}}return{node:a,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:o,text:i}){if(this.getDesc(e))return;let r=e;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let a=new Dt(this,r,e,i);t.input.compositionNodes.push(a),this.children=Ft(this.children,o,o+i.length,t,a)}update(t,e,o,i){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,o,i),0))}updateInner(t,e,o,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(F(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=Tt(this.dom,this.nodeDOM,lt(this.outerDeco,this.node,e),lt(t,this.node,e)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function S(n,t,e,o,i){return x(o,t,n),new wt(void 0,n,t,e,o,o,o,i,0)}class l extends wt{constructor(t,e,o,i,r,a,u){super(t,e,o,i,r,null,a,u,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,o,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,o){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,o)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,o){let i=this.node.cut(t,e),r=document.createTextNode(i.text);return new l(this.parent,i,this.outerDeco,this.innerDeco,r,r,o)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(0==t||e==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class d extends V{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class f extends wt{constructor(t,e,o,i,r,a,u,p,T,g){super(t,e,o,i,r,a,u,T,g),this.spec=p}update(t,e,o,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(t,e,o);return r&&this.updateInner(t,e,o,i),r}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,o,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,o,i){this.spec.setSelection?this.spec.setSelection(t,e,o):super.setSelection(t,e,o,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function v(n,t,e){let o=n.firstChild,i=!1;for(let r=0;r<t.length;r++){let a=t[r],u=a.dom;if(u.parentNode==n){for(;u!=o;)o=q(o),i=!0;o=o.nextSibling}else i=!0,n.insertBefore(u,o);if(a instanceof kt){let p=o?o.previousSibling:n.lastChild;v(a.contentDOM,a.children,e),o=p?p.nextSibling:n.firstChild}}for(;o;)o=q(o),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const O=function(n){n&&(this.nodeName=n)};O.prototype=Object.create(null);const N=[new O];function lt(n,t,e){if(0==n.length)return N;let o=e?N[0]:new O,i=[o];for(let r=0;r<n.length;r++){let a=n[r].type.attrs;if(a){a.nodeName&&i.push(o=new O(a.nodeName));for(let u in a){let p=a[u];null!=p&&(e&&1==i.length&&i.push(o=new O(t.isInline?"span":"div")),"class"==u?o.class=(o.class?o.class+" ":"")+p:"style"==u?o.style=(o.style?o.style+";":"")+p:"nodeName"!=u&&(o[u]=p))}}}return i}function Tt(n,t,e,o){if(e==N&&o==N)return t;let i=t;for(let r=0;r<o.length;r++){let a=o[r],u=e[r];if(r){let p;u&&u.nodeName==a.nodeName&&i!=n&&(p=i.parentNode)&&p.nodeName.toLowerCase()==a.nodeName||(p=document.createElement(a.nodeName),p.pmIsDeco=!0,p.appendChild(i),u=N[0]),i=p}P(i,u||N[0],a)}return i}function P(n,t,e){for(let o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&!(o in e)&&n.removeAttribute(o);for(let o in e)"class"!=o&&"style"!=o&&"nodeName"!=o&&e[o]!=t[o]&&n.setAttribute(o,e[o]);if(t.class!=e.class){let o=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let r=0;r<o.length;r++)-1==i.indexOf(o[r])&&n.classList.remove(o[r]);for(let r=0;r<i.length;r++)-1==o.indexOf(i[r])&&n.classList.add(i[r]);0==n.classList.length&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let i,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=o.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function x(n,t,e){return Tt(n,n,N,lt(t,e,1!=n.nodeType))}function F(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function q(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class nt{constructor(t,e){this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(n,t){let e=t,o=e.children.length,i=n.childCount,r=new Map,a=[];t:for(;i>0;){let u;for(;;)if(o){let T=e.children[o-1];if(!(T instanceof kt)){u=T,o--;break}e=T,o=T.children.length}else{if(e==t)break t;o=e.parent.children.indexOf(e),e=e.parent}let p=u.node;if(p){if(p!=n.child(i-1))break;--i,r.set(u,i),a.push(u)}}return{index:i,matched:r,matches:a.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let o=t;o<e;o++)this.top.children[o].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,o){let i=0,r=this.stack.length>>1,a=Math.min(r,t.length);for(;i<a&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let u=-1;for(let p=this.index;p<Math.min(this.index+3,this.top.children.length);p++)if(this.top.children[p].matchesMark(t[r])){u=p;break}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let p=kt.create(this.top,t[r],e,o);this.top.children.splice(this.index,0,p),this.top=p,this.changed=!0}this.index=0,r++}}findNodeMatch(t,e,o,i){let a,r=-1;if(i>=this.preMatch.index&&(a=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&a.matchesNode(t,e,o))r=this.top.children.indexOf(a,this.index);else for(let u=this.index,p=Math.min(this.top.children.length,u+5);u<p;u++){let T=this.top.children[u];if(T.matchesNode(t,e,o)&&!this.preMatch.matched.has(T)){r=u;break}}return!(r<0||(this.destroyBetween(this.index,r),this.index++,0))}updateNodeAt(t,e,o,i,r){let a=this.top.children[i];return 3==a.dirty&&a.dom==a.contentDOM&&(a.dirty=2),!!a.update(t,e,o,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let o=t.pmViewDesc;if(o)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==o)return i;return-1}t=e}}updateNextNode(t,e,o,i,r){for(let a=this.index;a<this.top.children.length;a++){let u=this.top.children[a];if(u instanceof wt){let p=this.preMatch.matched.get(u);if(null!=p&&p!=r)return!1;let T=u.dom;if((!this.lock||!(T==this.lock||1==T.nodeType&&T.contains(this.lock.parentNode))||t.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==t.text&&3!=u.dirty&&F(e,u.outerDeco))&&u.update(t,e,o,i))return this.destroyBetween(this.index,a),u.dom!=T&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,o,i,r){this.top.children.splice(this.index++,0,wt.create(this.top,t,e,o,i,r)),this.changed=!0}placeWidget(t,e,o){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let r=new Ct(this.top,t,e,o);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof kt;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof l)||/\n$/.test(t.node.text))&&((ht||st)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);"IMG"==t&&(o.className="ProseMirror-separator",o.alt=""),"BR"==t&&(o.className="ProseMirror-trailingBreak");let i=new d(this.top,[],o,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}}function vt(n,t){return n.type.side-t.type.side}function Ft(n,t,e,o,i){let r=[];for(let a=0,u=0;a<n.length;a++){let p=n[a],T=u,g=u+=p.size;T>=e||g<=t?r.push(p):(T<t&&r.push(p.slice(0,t-T,o)),i&&(r.push(i),i=void 0),g>e&&r.push(p.slice(e-T,p.size,o)))}return r}function Kt(n,t=null){let e=n.domSelection(),o=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),r=i&&0==i.size,a=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(a<0)return null;let p,T,u=o.resolve(a);if(z(e)){for(p=u;i&&!i.node;)i=i.parent;let g=i.node;if(i&&g.isAtom&&m.qv.isSelectable(g)&&i.parent&&(!g.isInline||!function(n,t,e){for(let o=0==t,i=t==Bt(n);o||i;){if(n==e)return!0;let r=dt(n);if(!(n=n.parentNode))return!1;o=o&&0==r,i=i&&r==Bt(n)}}(e.focusNode,e.focusOffset,i.dom))){let R=i.posBefore;T=new m.qv(a==R?u:o.resolve(R))}}else{let g=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(g<0)return null;p=o.resolve(g)}return T||(T=Ue(n,p,u,"pointer"==t||n.state.selection.head<u.pos&&!r?1:-1)),T}function Qt(n){return n.editable?n.hasFocus():ke(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function qt(n,t=!1){let e=n.state.selection;if($e(n,e),Qt(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&st){let o=n.domSelection(),i=n.domObserver.currentSelection;if(o.anchorNode&&i.anchorNode&&ot(o.anchorNode,o.anchorOffset,i.anchorNode,i.anchorOffset))return n.input.mouseDown.delayedSelectionSync=!0,void n.domObserver.setCurSelection()}if(n.domObserver.disconnectSelection(),n.cursorWrapper)!function(n){let t=n.domSelection(),e=document.createRange(),o=n.cursorWrapper.dom,i="IMG"==o.nodeName;i?e.setEnd(o.parentNode,dt(o)+1):e.setEnd(o,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&rt&&G<=11&&(o.disabled=!0,o.disabled=!1)}(n);else{let r,a,{anchor:o,head:i}=e;Se&&!(e instanceof m.Bs)&&(e.$from.parent.inlineContent||(r=be(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(a=be(n,e.to))),n.docView.setSelection(o,i,n.root,t),Se&&(r&&Ze(r),a&&Ze(a)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelection(),o=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=o||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Qt(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Se=ht||st&&Mt<63;function be(n,t){let{node:e,offset:o}=n.docView.domFromPos(t,0),i=o<e.childNodes.length?e.childNodes[o]:null,r=o?e.childNodes[o-1]:null;if(ht&&i&&"false"==i.contentEditable)return He(i);if(!(i&&"false"!=i.contentEditable||r&&"false"!=r.contentEditable)){if(i)return He(i);if(r)return He(r)}}function He(n){return n.contentEditable="true",ht&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Ze(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function $e(n,t){if(t instanceof m.qv){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(Ye(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else Ye(n)}function Ye(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Ue(n,t,e,o){return n.someProp("createSelectionBetween",i=>i(n,t,e))||m.Bs.between(t,e,o)}function De(n){return(!n.editable||n.root.activeElement==n.dom)&&ke(n)}function ke(n){let t=n.domSelection();if(!t.anchorNode)return!1;try{return n.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function ye(n,t){let{$anchor:e,$head:o}=n.selection,i=t>0?e.max(o):e.min(o),r=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return r&&m.Y1.findFrom(r,t)}function te(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function Ve(n,t,e){let o=n.state.selection;if(!(o instanceof m.Bs)){if(o instanceof m.qv&&o.node.isInline)return te(n,new m.Bs(t>0?o.$to:o.$from));{let i=ye(n.state,t);return!!i&&te(n,i)}}if(!o.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=ye(n.state,t);return!!(i&&i instanceof m.qv)&&te(n,i)}if(!(K&&e.indexOf("m")>-1)){let a,i=o.$head,r=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!r||r.isText)return!1;let u=t<0?i.pos-r.nodeSize:i.pos;return!!(r.isAtom||(a=n.docView.descAt(u))&&!a.contentDOM)&&(m.qv.isSelectable(r)?te(n,new m.qv(t<0?n.state.doc.resolve(i.pos-r.nodeSize):i)):!!Y&&te(n,new m.Bs(n.state.doc.resolve(t<0?u:u+r.nodeSize))))}}function Re(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function Pe(n){let t=n.pmViewDesc;return t&&0==t.size&&(n.nextSibling||"BR"!=n.nodeName)}function Le(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let i,r,a=!1;for(ut&&1==e.nodeType&&o<Re(e)&&Pe(e.childNodes[o])&&(a=!0);;)if(o>0){if(1!=e.nodeType)break;{let u=e.childNodes[o-1];if(Pe(u))i=e,r=--o;else{if(3!=u.nodeType)break;e=u,o=e.nodeValue.length}}}else{if(ue(e))break;{let u=e.previousSibling;for(;u&&Pe(u);)i=e.parentNode,r=dt(u),u=u.previousSibling;if(u)e=u,o=Re(e);else{if(e=e.parentNode,e==n.dom)break;o=0}}}a?Be(n,t,e,o):i&&Be(n,t,i,r)}function we(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let r,a,i=Re(e);for(;;)if(o<i){if(1!=e.nodeType)break;if(!Pe(e.childNodes[o]))break;r=e,a=++o}else{if(ue(e))break;{let u=e.nextSibling;for(;u&&Pe(u);)r=u.parentNode,a=dt(u)+1,u=u.nextSibling;if(u)e=u,o=0,i=Re(e);else{if(e=e.parentNode,e==n.dom)break;o=i=0}}}r&&Be(n,t,r,a)}function ue(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function Be(n,t,e,o){if(z(t)){let r=document.createRange();r.setEnd(e,o),r.setStart(e,o),t.removeAllRanges(),t.addRange(r)}else t.extend&&t.extend(e,o);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&qt(n)},50)}function $t(n,t,e){let o=n.state.selection;if(o instanceof m.Bs&&!o.empty||e.indexOf("s")>-1||K&&e.indexOf("m")>-1)return!1;let{$from:i,$to:r}=o;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let a=ye(n.state,t);if(a&&a instanceof m.qv)return te(n,a)}if(!i.parent.inlineContent){let a=t<0?i:r,u=o instanceof m.C1?m.Y1.near(a,t):m.Y1.findFrom(a,t);return!!u&&te(n,u)}return!1}function Ln(n,t){if(!(n.state.selection instanceof m.Bs))return!0;let{$head:e,$anchor:o,empty:i}=n.state.selection;if(!e.sameParent(o))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let r=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(r&&!r.isText){let a=n.state.tr;return t<0?a.delete(e.pos-r.nodeSize,e.pos):a.delete(e.pos,e.pos+r.nodeSize),n.dispatch(a),!0}return!1}function wn(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function Bn(n,t){let e=[],{content:o,openStart:i,openEnd:r}=t;for(;i>1&&r>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,r--;let W=o.firstChild;e.push(W.type.name,W.attrs!=W.type.defaultAttrs?W.attrs:null),o=W.content}let a=n.someProp("clipboardSerializer")||s.PW.fromSchema(n.state.schema),u=Fn(),p=u.createElement("div");p.appendChild(a.serializeFragment(o,{document:u}));let g,T=p.firstChild,R=0;for(;T&&1==T.nodeType&&(g=Wn[T.nodeName.toLowerCase()]);){for(let W=g.length-1;W>=0;W--){let it=u.createElement(g[W]);for(;p.firstChild;)it.appendChild(p.firstChild);p.appendChild(it),R++}T=p.firstChild}return T&&1==T.nodeType&&T.setAttribute("data-pm-slice",`${i} ${r}${R?` -${R}`:""} ${JSON.stringify(e)}`),{dom:p,text:n.someProp("clipboardTextSerializer",W=>W(t))||t.content.textBetween(0,t.content.size,"\n\n")}}function Nn(n,t,e,o,i){let a,u,r=i.parent.type.spec.code;if(!e&&!t)return null;let p=t&&(o||r||!e);if(p){if(n.someProp("transformPastedText",w=>{t=w(t,r||o)}),r)return t?new s.p2(s.HY.from(n.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):s.p2.empty;let R=n.someProp("clipboardTextParser",w=>w(t,i,o));if(R)u=R;else{let w=i.marks(),{schema:W}=n.state,it=s.PW.fromSchema(W);a=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(mt=>{let Ot=a.appendChild(document.createElement("p"));mt&&Ot.appendChild(it.serializeNode(W.text(mt,w)))})}}else n.someProp("transformPastedHTML",R=>{e=R(e)}),a=function(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let i,e=Fn().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(n);if((i=o&&Wn[o[1].toLowerCase()])&&(n=i.map(r=>"<"+r+">").join("")+n+i.map(r=>"</"+r+">").reverse().join("")),e.innerHTML=n,i)for(let r=0;r<i.length;r++)e=e.querySelector(i[r])||e;return e}(e),Y&&function(n){let t=n.querySelectorAll(st?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let o=t[e];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),o)}}(a);let T=a&&a.querySelector("[data-pm-slice]"),g=T&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(T.getAttribute("data-pm-slice")||"");if(g&&g[3])for(let R=+g[3];R>0&&a.firstChild;R--)a=a.firstChild;if(u||(u=(n.someProp("clipboardParser")||n.someProp("domParser")||s.aw.fromSchema(n.state.schema)).parseSlice(a,{preserveWhitespace:!(!p&&!g),context:i,ruleFromNode:w=>"BR"!=w.nodeName||w.nextSibling||!w.parentNode||io.test(w.parentNode.nodeName)?null:{ignore:!0}})),g)u=function(n,t){if(!n.size)return n;let o,e=n.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(u){return n}let{content:i,openStart:r,openEnd:a}=n;for(let u=o.length-2;u>=0;u-=2){let p=e.nodes[o[u]];if(!p||p.hasRequiredAttrs())break;i=s.HY.from(p.create(o[u+1],i)),r++,a++}return new s.p2(i,r,a)}(We(u,+g[1],+g[2]),g[4]);else if(u=s.p2.maxOpen(function(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let r,i=t.node(e).contentMatchAt(t.index(e)),a=[];if(n.forEach(u=>{if(!a)return;let T,p=i.findWrapping(u.type);if(!p)return a=null;if(T=a.length&&r.length&&_n(p,r,u,a[a.length-1],0))a[a.length-1]=T;else{a.length&&(a[a.length-1]=Un(a[a.length-1],r.length));let g=Hn(u,p);a.push(g),i=i.matchType(g.type),r=p}}),a)return s.HY.from(a)}return n}(u.content,i),!0),u.openStart||u.openEnd){let R=0,w=0;for(let W=u.content.firstChild;R<u.openStart&&!W.type.spec.isolating;R++,W=W.firstChild);for(let W=u.content.lastChild;w<u.openEnd&&!W.type.spec.isolating;w++,W=W.lastChild);u=We(u,R,w)}return n.someProp("transformPasted",R=>{u=R(u)}),u}const io=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Hn(n,t,e=0){for(let o=t.length-1;o>=e;o--)n=t[o].create(null,s.HY.from(n));return n}function _n(n,t,e,o,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let r=_n(n,t,e,o.lastChild,i+1);if(r)return o.copy(o.content.replaceChild(o.childCount-1,r));if(o.contentMatchAt(o.childCount).matchType(i==n.length-1?e.type:n[i+1]))return o.copy(o.content.append(s.HY.from(Hn(e,n,i+1))))}}function Un(n,t){if(0==t)return n;let e=n.content.replaceChild(n.childCount-1,Un(n.lastChild,t-1)),o=n.contentMatchAt(n.childCount).fillBefore(s.HY.empty,!0);return n.copy(e.append(o))}function gn(n,t,e,o,i,r){let a=t<0?n.firstChild:n.lastChild,u=a.content;return i<o-1&&(u=gn(u,t,e,o,i+1,r)),i>=e&&(u=t<0?a.contentMatchAt(0).fillBefore(u,n.childCount>1||r<=i).append(u):u.append(a.contentMatchAt(a.childCount).fillBefore(s.HY.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,a.copy(u))}function We(n,t,e){return t<n.openStart&&(n=new s.p2(gn(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new s.p2(gn(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const Wn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let zn=null;function Fn(){return zn||(zn=document.implementation.createHTMLDocument("title"))}const pe={};let ae={};class lo{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ze(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function Tn(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=o=>vn(n,o))})}function vn(n,t){return n.someProp("handleDOMEvents",e=>{let o=e[t.type];return!!o&&(o(n,t)||t.defaultPrevented)})}function Jn(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function je(n){return{left:n.clientX,top:n.clientY}}function Cn(n,t,e,o,i){if(-1==o)return!1;let r=n.state.doc.resolve(o);for(let a=r.depth+1;a>0;a--)if(n.someProp(t,u=>a>r.depth?u(n,e,r.nodeAfter,r.before(a),i,!0):u(n,e,r.node(a),r.before(a),i,!1)))return!0;return!1}function Qe(n,t,e){n.focused||n.focus();let o=n.state.tr.setSelection(t);"pointer"==e&&o.setMeta("pointer",!0),n.dispatch(o)}function dn(n,t,e,o){return Cn(n,"handleDoubleClickOn",t,e,o)||n.someProp("handleDoubleClick",i=>i(n,t,o))}function _o(n,t,e,o){return Cn(n,"handleTripleClickOn",t,e,o)||n.someProp("handleTripleClick",i=>i(n,t,o))||function(n,t,e){if(0!=e.button)return!1;let o=n.state.doc;if(-1==t)return!!o.inlineContent&&(Qe(n,m.Bs.create(o,0,o.content.size),"pointer"),!0);let i=o.resolve(t);for(let r=i.depth+1;r>0;r--){let a=r>i.depth?i.nodeAfter:i.node(r),u=i.before(r);if(a.inlineContent)Qe(n,m.Bs.create(o,u+1,u+1+a.content.size),"pointer");else{if(!m.qv.isSelectable(a))continue;Qe(n,m.qv.create(o,u),"pointer")}return!0}}(n,e,o)}function Mn(n){return Fe(n)}ae.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=16==e.keyCode||e.shiftKey,!on(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!H||!st||13!=e.keyCode))if(229!=e.keyCode&&n.domObserver.forceFlush(),!_t||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)n.someProp("handleKeyDown",o=>o(n,e))||function(n,t){let e=t.keyCode,o=function(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}(t);return 8==e||K&&72==e&&"c"==o?Ln(n,-1)||Le(n):46==e||K&&68==e&&"c"==o?Ln(n,1)||we(n):13==e||27==e||(37==e||K&&66==e&&"c"==o?Ve(n,-1,o)||Le(n):39==e||K&&70==e&&"c"==o?Ve(n,1,o)||we(n):38==e||K&&80==e&&"c"==o?$t(n,-1,o)||Le(n):40==e||K&&78==e&&"c"==o?function(n){if(!ht||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelection();if(t&&1==t.nodeType&&0==e&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;wn(n,o,"true"),setTimeout(()=>wn(n,o,"false"),20)}return!1}(n)||$t(n,1,o)||we(n):o==(K?"m":"c")&&(66==e||73==e||89==e||90==e))}(n,e)?e.preventDefault():ze(n,"key");else{let o=Date.now();n.input.lastIOSEnter=o,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==o&&(n.someProp("handleKeyDown",i=>i(n,Z(13,"Enter"))),n.input.lastIOSEnter=0)},200)}},ae.keyup=(n,t)=>{16==t.keyCode&&(n.input.shiftKey=!1)},ae.keypress=(n,t)=>{let e=t;if(on(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||K&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e)))return void e.preventDefault();let o=n.state.selection;if(!(o instanceof m.Bs&&o.$from.sameParent(o.$to))){let i=String.fromCharCode(e.charCode);n.someProp("handleTextInput",r=>r(n,o.$from.pos,o.$to.pos,i))||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};const $n=K?"metaKey":"ctrlKey";pe.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let o=Mn(n),i=Date.now(),r="singleClick";i-n.input.lastClick.time<500&&function(n,t){let e=t.x-n.clientX,o=t.y-n.clientY;return e*e+o*o<100}(e,n.input.lastClick)&&!e[$n]&&("singleClick"==n.input.lastClick.type?r="doubleClick":"doubleClick"==n.input.lastClick.type&&(r="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:r};let a=n.posAtCoords(je(e));!a||("singleClick"==r?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Yn(n,a,e,!!o)):("doubleClick"==r?dn:_o)(n,a.pos,a.inside,e)?e.preventDefault():ze(n,"pointer"))};class Yn{constructor(t,e,o,i){let r,a;if(this.view=t,this.pos=e,this.event=o,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[$n],this.allowDefault=o.shiftKey,e.inside>-1)r=t.state.doc.nodeAt(e.inside),a=e.inside;else{let g=t.state.doc.resolve(e.pos);r=g.parent,a=g.depth?g.before():0}const u=i?null:o.target,p=u?t.docView.nearestDesc(u,!0):null;this.target=p?p.dom:null;let{selection:T}=t.state;(0==o.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||T instanceof m.qv&&T.from<=a&&T.to>a)&&(this.mightDrag={node:r,pos:a,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!ut||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),ze(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>qt(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(je(t))),this.allowDefault||!e?ze(this.view,"pointer"):function(n,t,e,o,i){return Cn(n,"handleClickOn",t,e,o)||n.someProp("handleClick",r=>r(n,t,o))||(i?function(n,t){if(-1==t)return!1;let o,i,e=n.state.selection;e instanceof m.qv&&(o=e.node);let r=n.state.doc.resolve(t);for(let a=r.depth+1;a>0;a--){let u=a>r.depth?r.nodeAfter:r.node(a);if(m.qv.isSelectable(u)){i=o&&e.$from.depth>0&&a>=e.$from.depth&&r.before(e.$from.depth+1)==e.$from.pos?r.before(e.$from.depth):r.before(a);break}}return null!=i&&(Qe(n,m.qv.create(n.state.doc,i),"pointer"),!0)}(n,e):function(n,t){if(-1==t)return!1;let e=n.state.doc.resolve(t),o=e.nodeAfter;return!!(o&&o.isAtom&&m.qv.isSelectable(o))&&(Qe(n,new m.qv(e),"pointer"),!0)}(n,e))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||ht&&this.mightDrag&&!this.mightDrag.node.isAtom||st&&!(this.view.state.selection instanceof m.Bs)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Qe(this.view,m.Y1.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):ze(this.view,"pointer")}move(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),ze(this.view,"pointer"),0==t.buttons&&this.done()}}function on(n,t){return!!n.composing||!!(ht&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500)&&(n.input.compositionEndedAt=-2e8,!0)}pe.touchdown=n=>{Mn(n),ze(n,"pointer")},pe.contextmenu=n=>Mn(n);const En=H?5e3:-1;function yn(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>Fe(n),t))}function xn(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=function(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function Fe(n,t=!1){if(!(H&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),xn(n),t||n.docView&&n.docView.dirty){let e=Kt(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}ae.compositionstart=ae.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(o=>!1===o.type.spec.inclusive)))n.markCursor=n.state.storedMarks||e.marks(),Fe(n,!0),n.markCursor=null;else if(Fe(n),ut&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let o=n.domSelection();for(let i=o.focusNode,r=o.focusOffset;i&&1==i.nodeType&&0!=r;){let a=r<0?i.lastChild:i.childNodes[r-1];if(!a)break;if(3==a.nodeType){o.collapse(a,a.nodeValue.length);break}i=a,r=-1}}n.input.composing=!0}yn(n,En)},ae.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,yn(n,20))};const rn=rt&&G<15||_t&&L<604;function Vn(n,t,e,o){let i=Nn(n,t,e,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",u=>u(n,o,i||s.p2.empty)))return!0;if(!i)return!1;let r=function(n){return 0==n.openStart&&0==n.openEnd&&1==n.content.childCount?n.content.firstChild:null}(i),a=r?n.state.tr.replaceSelectionWith(r,n.input.shiftKey):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}pe.copy=ae.cut=(n,t)=>{let e=t,o=n.state.selection,i="cut"==e.type;if(o.empty)return;let r=rn?null:e.clipboardData,a=o.content(),{dom:u,text:p}=Bn(n,a);r?(e.preventDefault(),r.clearData(),r.setData("text/html",u.innerHTML),r.setData("text/plain",p)):function(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}(n,u),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},ae.paste=(n,t)=>{let e=t;if(n.composing&&!H)return;let o=rn?null:e.clipboardData;o&&Vn(n,o.getData("text/plain"),o.getData("text/html"),e)?e.preventDefault():function(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,o=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout(()=>{n.focus(),o.parentNode&&o.parentNode.removeChild(o),e?Vn(n,o.value,null,t):Vn(n,o.textContent,o.innerHTML,t)},50)}(n,e)};class wo{constructor(t,e){this.slice=t,this.move=e}}const To=K?"altKey":"ctrlKey";pe.dragstart=(n,t)=>{let e=t,o=n.input.mouseDown;if(o&&o.done(),!e.dataTransfer)return;let i=n.state.selection,r=i.empty?null:n.posAtCoords(je(e));if(!(r&&r.pos>=i.from&&r.pos<=(i instanceof m.qv?i.to-1:i.to)))if(o&&o.mightDrag)n.dispatch(n.state.tr.setSelection(m.qv.create(n.state.doc,o.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){let T=n.docView.nearestDesc(e.target,!0);T&&T.node.type.spec.draggable&&T!=n.docView&&n.dispatch(n.state.tr.setSelection(m.qv.create(n.state.doc,T.posBefore)))}let a=n.state.selection.content(),{dom:u,text:p}=Bn(n,a);e.dataTransfer.clearData(),e.dataTransfer.setData(rn?"Text":"text/html",u.innerHTML),e.dataTransfer.effectAllowed="copyMove",rn||e.dataTransfer.setData("text/plain",p),n.dragging=new wo(a,!e[To])},pe.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},ae.dragover=ae.dragenter=(n,t)=>t.preventDefault(),ae.drop=(n,t)=>{let e=t,o=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(je(e));if(!i)return;let r=n.state.doc.resolve(i.pos);if(!r)return;let a=o&&o.slice;a?n.someProp("transformPasted",it=>{a=it(a)}):a=Nn(n,e.dataTransfer.getData(rn?"Text":"text/plain"),rn?null:e.dataTransfer.getData("text/html"),!1,r);let u=!(!o||e[To]);if(n.someProp("handleDrop",it=>it(n,e,a||s.p2.empty,u)))return void e.preventDefault();if(!a)return;e.preventDefault();let p=a?(0,k.nj)(n.state.doc,r.pos,a):r.pos;null==p&&(p=r.pos);let T=n.state.tr;u&&T.deleteSelection();let g=T.mapping.map(p),R=0==a.openStart&&0==a.openEnd&&1==a.content.childCount,w=T.doc;if(R?T.replaceRangeWith(g,g,a.content.firstChild):T.replaceRange(g,g,a),T.doc.eq(w))return;let W=T.doc.resolve(g);if(R&&m.qv.isSelectable(a.content.firstChild)&&W.nodeAfter&&W.nodeAfter.sameMarkup(a.content.firstChild))T.setSelection(new m.qv(W));else{let it=T.mapping.map(p);T.mapping.maps[T.mapping.maps.length-1].forEach((mt,Ot,Rt,Yt)=>it=Yt),T.setSelection(Ue(n,W,T.doc.resolve(it)))}n.focus(),n.dispatch(T.setMeta("uiEvent","drop"))},pe.focus=n=>{n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelection())&&qt(n)},20))},pe.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},pe.beforeinput=(n,t)=>{if(st&&H&&"deleteContentBackward"==t.inputType){n.domObserver.flushSoon();let{domChangeCount:o}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=o||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",r=>r(n,Z(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in ae)pe[n]=ae[n];function un(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class jn{constructor(t,e){this.toDOM=t,this.spec=e||Ke,this.side=this.spec.side||0}map(t,e,o,i){let{pos:r,deleted:a}=t.mapResult(e.from+i,this.side<0?-1:1);return a?null:new ge(r-o,r-o,this)}valid(){return!0}eq(t){return this==t||t instanceof jn&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&un(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Ne{constructor(t,e){this.attrs=t,this.spec=e||Ke}map(t,e,o,i){let r=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-o,a=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-o;return r>=a?null:new ge(r,a,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Ne&&un(this.attrs,t.attrs)&&un(this.spec,t.spec)}static is(t){return t.type instanceof Ne}destroy(){}}class On{constructor(t,e){this.attrs=t,this.spec=e||Ke}map(t,e,o,i){let r=t.mapResult(e.from+i,1);if(r.deleted)return null;let a=t.mapResult(e.to+i,-1);return a.deleted||a.pos<=r.pos?null:new ge(r.pos-o,a.pos-o,this)}valid(t,e){let r,{index:o,offset:i}=t.content.findIndex(e.from);return i==e.from&&!(r=t.child(o)).isText&&i+r.nodeSize==e.to}eq(t){return this==t||t instanceof On&&un(this.attrs,t.attrs)&&un(this.spec,t.spec)}destroy(){}}class ge{constructor(t,e,o){this.from=t,this.to=e,this.type=o}copy(t,e){return new ge(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,o){return this.type.map(t,this,e,o)}static widget(t,e,o){return new ge(t,t,new jn(e,o))}static inline(t,e,o,i){return new ge(t,e,new Ne(o,i))}static node(t,e,o,i){return new ge(t,e,new On(o,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ne}}const Ge=[],Ke={};class oe{constructor(t,e){this.local=t.length?t:Ge,this.children=e.length?e:Ge}static create(t,e){return e.length?hn(e,t,0,Ke):ie}find(t,e,o){let i=[];return this.findInner(null==t?0:t,null==e?1e9:e,i,0,o),i}findInner(t,e,o,i,r){for(let a=0;a<this.local.length;a++){let u=this.local[a];u.from<=e&&u.to>=t&&(!r||r(u.spec))&&o.push(u.copy(u.from+i,u.to+i))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){let u=this.children[a]+1;this.children[a+2].findInner(t-u,e-u,o,i+u,r)}}map(t,e,o){return this==ie||0==t.maps.length?this:this.mapInner(t,e,0,0,o||Ke)}mapInner(t,e,o,i,r){let a;for(let u=0;u<this.local.length;u++){let p=this.local[u].map(t,o,i);p&&p.type.valid(e,p)?(a||(a=[])).push(p):r.onRemove&&r.onRemove(this.local[u].spec)}return this.children.length?function(n,t,e,o,i,r,a){let u=n.slice(),p=(g,R,w,W)=>{for(let it=0;it<u.length;it+=3){let Ot,mt=u[it+1];if(mt<0||g>mt+r)continue;let Rt=u[it]+r;R>=Rt?u[it+1]=g<=Rt?-2:-1:w>=i&&(Ot=W-w-(R-g))&&(u[it]+=Ot,u[it+1]+=Ot)}};for(let g=0;g<e.maps.length;g++)e.maps[g].forEach(p);let T=!1;for(let g=0;g<u.length;g+=3)if(u[g+1]<0){if(-2==u[g+1]){T=!0,u[g+1]=-1;continue}let R=e.map(n[g]+r),w=R-i;if(w<0||w>=o.content.size){T=!0;continue}let it=e.map(n[g+1]+r,-1)-i,{index:mt,offset:Ot}=o.content.findIndex(w),Rt=o.maybeChild(mt);if(Rt&&Ot==w&&Ot+Rt.nodeSize==it){let Yt=u[g+2].mapInner(e,Rt,R+1,n[g]+r+1,a);Yt!=ie?(u[g]=w,u[g+1]=it,u[g+2]=Yt):(u[g+1]=-2,T=!0)}else T=!0}if(T){let g=function(n,t,e,o,i,r,a){function u(p,T){for(let g=0;g<p.local.length;g++){let R=p.local[g].map(o,i,T);R?e.push(R):a.onRemove&&a.onRemove(p.local[g].spec)}for(let g=0;g<p.children.length;g+=3)u(p.children[g+2],p.children[g]+T+1)}for(let p=0;p<n.length;p+=3)-1==n[p+1]&&u(n[p+2],t[p]+r+1);return e}(u,n,t,e,i,r,a),R=hn(g,o,0,a);t=R.local;for(let w=0;w<u.length;w+=3)u[w+1]<0&&(u.splice(w,3),w-=3);for(let w=0,W=0;w<R.children.length;w+=3){let it=R.children[w];for(;W<u.length&&u[W]<it;)W+=3;u.splice(W,0,R.children[w],R.children[w+1],R.children[w+2])}}return new oe(t.sort(Je),u)}(this.children,a||[],t,e,o,i,r):a?new oe(a.sort(Je),Ge):ie}add(t,e){return e.length?this==ie?oe.create(t,e):this.addInner(t,e,0):this}addInner(t,e,o){let i,r=0;t.forEach((u,p)=>{let g,T=p+o;if(g=Dn(e,u,T)){for(i||(i=this.children.slice());r<i.length&&i[r]<p;)r+=3;i[r]==p?i[r+2]=i[r+2].addInner(u,g,T+1):i.splice(r,0,p,p+u.nodeSize,hn(g,u,T+1,Ke)),r+=3}});let a=pn(r?Pn(e):e,-o);for(let u=0;u<a.length;u++)a[u].type.valid(t,a[u])||a.splice(u--,1);return new oe(a.length?this.local.concat(a).sort(Je):this.local,i||this.children)}remove(t){return 0==t.length||this==ie?this:this.removeInner(t,0)}removeInner(t,e){let o=this.children,i=this.local;for(let r=0;r<o.length;r+=3){let a,u=o[r]+e,p=o[r+1]+e;for(let R,g=0;g<t.length;g++)(R=t[g])&&R.from>u&&R.to<p&&(t[g]=null,(a||(a=[])).push(R));if(!a)continue;o==this.children&&(o=this.children.slice());let T=o[r+2].removeInner(a,u+1);T!=ie?o[r+2]=T:(o.splice(r,3),r-=3)}if(i.length)for(let a,r=0;r<t.length;r++)if(a=t[r])for(let u=0;u<i.length;u++)i[u].eq(a,e)&&(i==this.local&&(i=this.local.slice()),i.splice(u--,1));return o==this.children&&i==this.local?this:i.length||o.length?new oe(i,o):ie}forChild(t,e){if(this==ie)return this;if(e.isLeaf)return oe.empty;let o,i;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=t){this.children[u]==t&&(o=this.children[u+2]);break}let r=t+1,a=r+e.content.size;for(let u=0;u<this.local.length;u++){let p=this.local[u];if(p.from<a&&p.to>r&&p.type instanceof Ne){let T=Math.max(r,p.from)-r,g=Math.min(a,p.to)-r;T<g&&(i||(i=[])).push(p.copy(T,g))}}if(i){let u=new oe(i.sort(Je),Ge);return o?new Ae([u,o]):u}return o||ie}eq(t){if(this==t)return!0;if(!(t instanceof oe)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return An(this.localsInner(t))}localsInner(t){if(this==ie)return Ge;if(t.inlineContent||!this.local.some(Ne.is))return this.local;let e=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof Ne||e.push(this.local[o]);return e}}oe.empty=new oe([],[]),oe.removeOverlap=An;const ie=oe.empty;class Ae{constructor(t){this.members=t}map(t,e){const o=this.members.map(i=>i.map(t,e,Ke));return Ae.from(o)}forChild(t,e){if(e.isLeaf)return oe.empty;let o=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(t,e);r!=ie&&(r instanceof Ae?o=o.concat(r.members):o.push(r))}return Ae.from(o)}eq(t){if(!(t instanceof Ae)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,o=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(t);if(r.length)if(e){o&&(e=e.slice(),o=!1);for(let a=0;a<r.length;a++)e.push(r[a])}else e=r}return e?An(o?e:e.sort(Je)):Ge}static from(t){switch(t.length){case 0:return ie;case 1:return t[0];default:return new Ae(t)}}}function pn(n,t){if(!t||!n.length)return n;let e=[];for(let o=0;o<n.length;o++){let i=n[o];e.push(new ge(i.from+t,i.to+t,i.type))}return e}function Dn(n,t,e){if(t.isLeaf)return null;let o=e+t.nodeSize,i=null;for(let a,r=0;r<n.length;r++)(a=n[r])&&a.from>e&&a.to<o&&((i||(i=[])).push(a),n[r]=null);return i}function Pn(n){let t=[];for(let e=0;e<n.length;e++)null!=n[e]&&t.push(n[e]);return t}function hn(n,t,e,o){let i=[],r=!1;t.forEach((u,p)=>{let T=Dn(n,u,p+e);if(T){r=!0;let g=hn(T,u,e+p+1,o);g!=ie&&i.push(p,p+u.nodeSize,g)}});let a=pn(r?Pn(n):n,-e).sort(Je);for(let u=0;u<a.length;u++)a[u].type.valid(t,a[u])||(o.onRemove&&o.onRemove(a[u].spec),a.splice(u--,1));return a.length||i.length?new oe(a,i):ie}function Je(n,t){return n.from-t.from||n.to-t.to}function An(n){let t=n;for(let e=0;e<t.length-1;e++){let o=t[e];if(o.from!=o.to)for(let i=e+1;i<t.length;i++){let r=t[i];if(r.from!=o.from){r.from<o.to&&(t==n&&(t=n.slice()),t[e]=o.copy(o.from,r.from),Gn(t,i,o.copy(r.from,o.to)));break}r.to!=o.to&&(t==n&&(t=n.slice()),t[i]=r.copy(r.from,o.to),Gn(t,i+1,r.copy(o.to,r.to)))}}return t}function Gn(n,t,e){for(;t<n.length&&Je(e,n[t])>0;)t++;n.splice(t,0,e)}function In(n){let t=[];return n.someProp("decorations",e=>{let o=e(n.state);o&&o!=ie&&t.push(o)}),n.cursorWrapper&&t.push(oe.create(n.state.doc,[n.cursorWrapper.deco])),Ae.from(t)}const vo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Co=rt&&G<=11;class fn{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Mo{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new fn,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let i=0;i<o.length;i++)this.queue.push(o[i]);rt&&G<=11&&o.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Co&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,vo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(De(this.view)){if(this.suppressingSelectionUpdates)return qt(this.view);if(rt&&G<=11&&!this.view.state.selection.empty){let t=this.view.domSelection();if(t.focusNode&&ot(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(t){if(0==t.rangeCount)return!0;let e=t.getRangeAt(0).commonAncestorContainer,o=this.view.docView.nearestDesc(e);return o&&o.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let e=this.view.domSelection(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&De(this.view)&&!this.ignoreSelectionChange(e),i=-1,r=-1,a=!1,u=[];if(this.view.editable)for(let p=0;p<t.length;p++){let T=this.registerMutation(t[p],u);T&&(i=i<0?T.from:Math.min(T.from,i),r=r<0?T.to:Math.max(T.to,r),T.typeOver&&(a=!0))}if(ut&&u.length>1){let p=u.filter(T=>"BR"==T.nodeName);if(2==p.length){let T=p[0],g=p[1];T.parentNode&&T.parentNode.parentNode==g.parentNode?g.remove():T.remove()}}(i>-1||o)&&(i>-1&&(this.view.docView.markDirty(i,r),Xn||(Xn=!0,"normal"==getComputedStyle(this.view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(i,r,a,u),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||qt(this.view),this.currentSelection.set(e))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(o==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if("childList"==t.type){for(let g=0;g<t.addedNodes.length;g++)e.push(t.addedNodes[g]);if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let i=t.previousSibling,r=t.nextSibling;if(rt&&G<=11&&t.addedNodes.length)for(let g=0;g<t.addedNodes.length;g++){let{previousSibling:R,nextSibling:w}=t.addedNodes[g];(!R||Array.prototype.indexOf.call(t.addedNodes,R)<0)&&(i=R),(!w||Array.prototype.indexOf.call(t.addedNodes,w)<0)&&(r=w)}let a=i&&i.parentNode==t.target?dt(i)+1:0,u=o.localPosFromDOM(t.target,a,-1),p=r&&r.parentNode==t.target?dt(r):t.target.childNodes.length;return{from:u,to:o.localPosFromDOM(t.target,p,1)}}return"attributes"==t.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let Xn=!1;function xo(n){let t=n.pmViewDesc;if(t)return t.parseRule();if("BR"==n.nodeName&&n.parentNode){if(ht&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(n.parentNode.lastChild==n||ht&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Sn(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:Ue(n,t.resolve(e.anchor),t.resolve(e.head))}function Rn(n,t,e){let o=n.depth,i=t?n.end():n.pos;for(;o>0&&(t||n.indexAfter(o)==n.node(o).childCount);)o--,i++,t=!1;if(e){let r=n.node(o).maybeChild(n.indexAfter(o));for(;r&&!r.isLeaf;)r=r.firstChild,i++}return i}class Po{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new lo,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(eo),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=qn(this),ln(this),this.nodeViews=to(this),this.docView=S(this.state.doc,sn(this),In(this),this.dom,this),this.domObserver=new Mo(this,(o,i,r,a)=>function(n,t,e,o,i){if(t<0){let Ht=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,qe=Kt(n,Ht);if(qe&&!n.state.selection.eq(qe)){let So=n.state.tr.setSelection(qe);"pointer"==Ht?So.setMeta("pointer",!0):"key"==Ht&&So.scrollIntoView(),n.dispatch(So)}return}let r=n.state.doc.resolve(t),a=r.sharedDepth(e);t=r.before(a+1),e=n.state.doc.resolve(e).after(a+1);let u=n.state.selection,p=function(n,t,e){let T,{node:o,fromOffset:i,toOffset:r,from:a,to:u}=n.docView.parseRange(t,e),p=n.domSelection(),g=p.anchorNode;if(g&&n.dom.contains(1==g.nodeType?g:g.parentNode)&&(T=[{node:g,offset:p.anchorOffset}],z(p)||T.push({node:p.focusNode,offset:p.focusOffset})),st&&8===n.input.lastKeyCode)for(let Ot=r;Ot>i;Ot--){let Rt=o.childNodes[Ot-1],Yt=Rt.pmViewDesc;if("BR"==Rt.nodeName&&!Yt){r=Ot;break}if(!Yt||Yt.size)break}let R=n.state.doc,w=n.someProp("domParser")||s.aw.fromSchema(n.state.schema),W=R.resolve(a),it=null,mt=w.parse(o,{topNode:W.parent,topMatch:W.parent.contentMatchAt(W.index()),topOpen:!0,from:i,to:r,preserveWhitespace:"pre"!=W.parent.type.whitespace||"full",findPositions:T,ruleFromNode:xo,context:W});if(T&&null!=T[0].pos){let Ot=T[0].pos,Rt=T[1]&&T[1].pos;null==Rt&&(Rt=Ot),it={anchor:Ot+a,head:Rt+a}}return{doc:mt,sel:it,from:a,to:u}}(n,t,e);if(st&&n.cursorWrapper&&p.sel&&p.sel.anchor==n.cursorWrapper.deco.from){let Ht=n.cursorWrapper.deco.type.toDOM.nextSibling,qe=Ht&&Ht.nodeValue?Ht.nodeValue.length:1;p.sel={anchor:p.sel.anchor+qe,head:p.sel.anchor+qe}}let R,w,T=n.state.doc,g=T.slice(p.from,p.to);8===n.input.lastKeyCode&&Date.now()-100<n.input.lastKeyCodeTime?(R=n.state.selection.to,w="end"):(R=n.state.selection.from,w="start"),n.input.lastKeyCode=null;let W=function(n,t,e,o,i){let r=n.findDiffStart(t,e);if(null==r)return null;let{a,b:u}=n.findDiffEnd(t,e+n.size,e+t.size);return"end"==i&&(o-=a+Math.max(0,r-Math.min(a,u))-r),a<r&&n.size<t.size?(r-=o<=r&&o>=a?r-o:0,u=r+(u-a),a=r):u<r&&(r-=o<=r&&o>=u?r-o:0,a=r+(a-u),u=r),{start:r,endA:a,endB:u}}(g.content,p.doc.content,p.from,R,w);if((_t&&n.input.lastIOSEnter>Date.now()-225||H)&&i.some(Ht=>"DIV"==Ht.nodeName||"P"==Ht.nodeName)&&(!W||W.endA>=W.endB)&&n.someProp("handleKeyDown",Ht=>Ht(n,Z(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(!W){if(!(o&&u instanceof m.Bs&&!u.empty&&u.$head.sameParent(u.$anchor))||n.composing||p.sel&&p.sel.anchor!=p.sel.head){if(p.sel){let Ht=Sn(n,n.state.doc,p.sel);Ht&&!Ht.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(Ht))}return}W={start:u.from,endA:u.to,endB:u.to}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&W.start==W.endB&&n.state.selection instanceof m.Bs&&(W.start>n.state.selection.from&&W.start<=n.state.selection.from+2&&n.state.selection.from>=p.from?W.start=n.state.selection.from:W.endA<n.state.selection.to&&W.endA>=n.state.selection.to-2&&n.state.selection.to<=p.to&&(W.endB+=n.state.selection.to-W.endA,W.endA=n.state.selection.to)),rt&&G<=11&&W.endB==W.start+1&&W.endA==W.start&&W.start>p.from&&" \xa0"==p.doc.textBetween(W.start-p.from-1,W.start-p.from+1)&&(W.start--,W.endA--,W.endB--);let Yt,it=p.doc.resolveNoCache(W.start-p.from),mt=p.doc.resolveNoCache(W.endB-p.from),Ot=T.resolve(W.start),Rt=it.sameParent(mt)&&it.parent.inlineContent&&Ot.end()>=W.endA;if((_t&&n.input.lastIOSEnter>Date.now()-225&&(!Rt||i.some(Ht=>"DIV"==Ht.nodeName||"P"==Ht.nodeName))||!Rt&&it.pos<p.doc.content.size&&(Yt=m.Y1.findFrom(p.doc.resolve(it.pos+1),1,!0))&&Yt.head==mt.pos)&&n.someProp("handleKeyDown",Ht=>Ht(n,Z(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(n.state.selection.anchor>W.start&&function(n,t,e,o,i){if(!o.parent.isTextblock||e-t<=i.pos-o.pos||Rn(o,!0,!1)<i.pos)return!1;let r=n.resolve(t);if(r.parentOffset<r.parent.content.size||!r.parent.isTextblock)return!1;let a=n.resolve(Rn(r,!0,!0));return!(!a.parent.isTextblock||a.pos>e||Rn(a,!0,!1)<e)&&o.parent.content.cut(o.parentOffset).eq(a.parent.content)}(T,W.start,W.endA,it,mt)&&n.someProp("handleKeyDown",Ht=>Ht(n,Z(8,"Backspace"))))return void(H&&st&&n.domObserver.suppressSelectionUpdates());st&&H&&W.endB==W.start&&(n.input.lastAndroidDelete=Date.now()),H&&!Rt&&it.start()!=mt.start()&&0==mt.parentOffset&&it.depth==mt.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==W.endA&&(W.endB-=2,mt=p.doc.resolveNoCache(W.endB-p.from),setTimeout(()=>{n.someProp("handleKeyDown",function(Ht){return Ht(n,Z(13,"Enter"))})},20));let de,Xe,Ie,ce=W.start,Te=W.endA;if(Rt)if(it.pos==mt.pos)rt&&G<=11&&0==it.parentOffset&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>qt(n),20)),de=n.state.tr.delete(ce,Te),Xe=T.resolve(W.start).marksAcross(T.resolve(W.endA));else if(W.endA==W.endB&&(Ie=function(n,t){let a,u,p,e=n.firstChild.marks,o=t.firstChild.marks,i=e,r=o;for(let g=0;g<o.length;g++)i=o[g].removeFromSet(i);for(let g=0;g<e.length;g++)r=e[g].removeFromSet(r);if(1==i.length&&0==r.length)u=i[0],a="add",p=g=>g.mark(u.addToSet(g.marks));else{if(0!=i.length||1!=r.length)return null;u=r[0],a="remove",p=g=>g.mark(u.removeFromSet(g.marks))}let T=[];for(let g=0;g<t.childCount;g++)T.push(p(t.child(g)));if(s.HY.from(T).eq(n))return{mark:u,type:a}}(it.parent.content.cut(it.parentOffset,mt.parentOffset),Ot.parent.content.cut(Ot.parentOffset,W.endA-Ot.start()))))de=n.state.tr,"add"==Ie.type?de.addMark(ce,Te,Ie.mark):de.removeMark(ce,Te,Ie.mark);else if(it.parent.child(it.index()).isText&&it.index()==mt.index()-(mt.textOffset?0:1)){let Ht=it.parent.textBetween(it.parentOffset,mt.parentOffset);if(n.someProp("handleTextInput",qe=>qe(n,ce,Te,Ht)))return;de=n.state.tr.insertText(Ht,ce,Te)}if(de||(de=n.state.tr.replace(ce,Te,p.doc.slice(W.start-p.from,W.endB-p.from))),p.sel){let Ht=Sn(n,de.doc,p.sel);Ht&&!(st&&H&&n.composing&&Ht.empty&&(W.start!=W.endB||n.input.lastAndroidDelete<Date.now()-100)&&(Ht.head==ce||Ht.head==de.mapping.map(Te)-1)||rt&&Ht.empty&&Ht.head==ce)&&de.setSelection(Ht)}Xe&&de.ensureMarks(Xe),n.dispatch(de.scrollIntoView())}(this,o,i,r,a)),this.domObserver.start(),function(n){for(let t in pe){let e=pe[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=o=>{Jn(n,o)&&!vn(n,o)&&(n.editable||!(o.type in ae))&&e(n,o)})}ht&&n.dom.addEventListener("input",()=>null),Tn(n)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Tn(this),this._props=t,t.plugins&&(t.plugins.forEach(eo),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)}setProps(t){let e={};for(let o in this._props)e[o]=this._props[o];e.state=this.state;for(let o in t)e[o]=t[o];this.update(e)}updateState(t){this.updateStateInner(t,this.state.plugins!=t.plugins)}updateStateInner(t,e){let o=this.state,i=!1,r=!1;if(t.storedMarks&&this.composing&&(xn(this),r=!0),this.state=t,e){let R=to(this);(function(n,t){let e=0,o=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)o++;return e!=o})(R,this.nodeViews)&&(this.nodeViews=R,i=!0),Tn(this)}this.editable=qn(this),ln(this);let a=In(this),u=sn(this),p=e?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",T=i||!this.docView.matchesNode(t.doc,u,a);(T||!t.selection.eq(o.selection))&&(r=!0);let g="preserve"==p&&r&&null==this.dom.style.overflowAnchor&&function(n){let o,i,t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top);for(let r=(t.left+t.right)/2,a=e+1;a<Math.min(innerHeight,t.bottom);a+=5){let u=n.root.elementFromPoint(r,a);if(!u||u==n.dom||!n.dom.contains(u))continue;let p=u.getBoundingClientRect();if(p.top>=e-20){o=u,i=p.top;break}}return{refDOM:o,refTop:i,stack:At(n.dom)}}(this);if(r){this.domObserver.stop();let R=T&&(rt||st)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&function(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}(o.selection,t.selection);if(T){let w=st?this.trackWrites=this.domSelection().focusNode:null;(i||!this.docView.update(t.doc,u,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=S(t.doc,u,a,this.dom,this)),w&&!this.trackWrites&&(R=!0)}R||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelection();return ot(t.node,t.offset,e.anchorNode,e.anchorOffset)}(this))?qt(this,R):($e(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==p)this.dom.scrollTop=0;else if("to selection"==p){let R=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",w=>w(this)))if(t.selection instanceof m.qv){let w=this.docView.domAfterPos(t.selection.from);1==w.nodeType&&Q(this,w.getBoundingClientRect(),R)}else Q(this,this.coordsAtPos(t.selection.head,1),R)}else g&&function({refDOM:n,refTop:t,stack:e}){let o=n?n.getBoundingClientRect().top:0;Zt(e,0==o?0:o-t)}(g)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let o=this.pluginViews[e];o.update&&o.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let o=this.directPlugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let o=this.state.plugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}}someProp(t,e){let i,o=this._props&&this._props[t];if(null!=o&&(i=e?e(o):o))return i;for(let a=0;a<this.directPlugins.length;a++){let u=this.directPlugins[a].props[t];if(null!=u&&(i=e?e(u):u))return i}let r=this.state.plugins;if(r)for(let a=0;a<r.length;a++){let u=r[a].props[t];if(null!=u&&(i=e?e(u):u))return i}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(n){if(n.setActive)return n.setActive();if(zt)return n.focus(zt);let t=At(n);n.focus(null==zt?{get preventScroll(){return zt={preventScroll:!0},!0}}:void 0),zt||(zt=!1,Zt(t,0))}(this.dom),qt(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e;return t||document}posAtCoords(t){return Oe(this,t)}coordsAtPos(t,e=1){return _e(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,o=-1){let i=this.docView.posFromDOM(t,e,o);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return function(n,t,e){return le==t&&U==e?_:(le=t,U=e,_="up"==e||"down"==e?function(n,t,e){let o=t.selection,i="up"==e?o.$from:o.$to;return ve(n,t,()=>{let{node:r}=n.docView.domFromPos(i.pos,"up"==e?-1:1);for(;;){let u=n.docView.nearestDesc(r,!0);if(!u)break;if(u.node.isBlock){r=u.dom;break}r=u.dom.parentNode}let a=_e(n,i.pos,1);for(let u=r.firstChild;u;u=u.nextSibling){let p;if(1==u.nodeType)p=u.getClientRects();else{if(3!=u.nodeType)continue;p=gt(u,0,u.nodeValue.length).getClientRects()}for(let T=0;T<p.length;T++){let g=p[T];if(g.bottom>g.top+1&&("up"==e?a.top-g.top>2*(g.bottom-a.top):g.bottom-a.bottom>2*(a.bottom-g.top)))return!1}}return!0})}(n,t,e):function(n,t,e){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let i=o.parentOffset,r=!i,a=i==o.parent.content.size,u=n.domSelection();return se.test(o.parent.textContent)&&u.modify?ve(n,t,()=>{let p=u.getRangeAt(0),T=u.focusNode,g=u.focusOffset,R=u.caretBidiLevel;u.modify("move",e,"character");let W=!(o.depth?n.docView.domAfterPos(o.before()):n.dom).contains(1==u.focusNode.nodeType?u.focusNode:u.focusNode.parentNode)||T==u.focusNode&&g==u.focusOffset;return u.removeAllRanges(),u.addRange(p),null!=R&&(u.caretBidiLevel=R),W}):"left"==e||"backward"==e?r:a}(n,t,e))}(this,e||this.state,t)}destroy(){!this.docView||(function(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],In(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(n,t){!vn(n,t)&&pe[t.type]&&(n.editable||!(t.type in ae))&&pe[t.type](n,t)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelection(){return this.root.getSelection()}}function sn(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if("function"==typeof e&&(e=e(n.state)),e)for(let o in e)"class"==o&&(t.class+=" "+e[o]),"style"==o?t.style=(t.style?t.style+";":"")+e[o]:!t[o]&&"contenteditable"!=o&&"nodeName"!=o&&(t[o]=String(e[o]))}),[ge.node(0,n.state.doc.content.size,t)]}function ln(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:ge.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function qn(n){return!n.someProp("editable",t=>!1===t(n.state))}function to(n){let t=Object.create(null);function e(o){for(let i in o)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=o[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function eo(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);
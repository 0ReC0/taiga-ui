"use strict";var Ko=Object.defineProperty,Jo=Object.defineProperties,$o=Object.getOwnPropertyDescriptors,vo=Object.getOwnPropertySymbols,Uo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,zo=(Jt,Et,d)=>Et in Jt?Ko(Jt,Et,{enumerable:!0,configurable:!0,writable:!0,value:d}):Jt[Et]=d,te=(Jt,Et)=>{for(var d in Et||(Et={}))Uo.call(Et,d)&&zo(Jt,d,Et[d]);if(vo)for(var d of vo(Et))Wo.call(Et,d)&&zo(Jt,d,Et[d]);return Jt},je=(Jt,Et)=>Jo(Jt,$o(Et)),Fo=(Jt,Et)=>{var d={};for(var T in Jt)Uo.call(Jt,T)&&Et.indexOf(T)<0&&(d[T]=Jt[T]);if(null!=Jt&&vo)for(var T of vo(Jt))Et.indexOf(T)<0&&Wo.call(Jt,T)&&(d[T]=Jt[T]);return d};(self.webpackChunk_taiga_ui_components=self.webpackChunk_taiga_ui_components||[]).push([[70224],{40256:(Jt,Et,d)=>{d.r(Et),d.d(Et,{CommandManager:()=>Ce,Editor:()=>lo,Extension:()=>ge,InputRule:()=>L,Mark:()=>Vn,Node:()=>jn,NodeView:()=>_o,PasteRule:()=>Xt,Tracker:()=>wo,callOrReturn:()=>U,combineTransactionSteps:()=>mo,defaultBlockAt:()=>ao,escapeForRegEx:()=>To,extensions:()=>Se,findChildren:()=>yo,findChildrenInRange:()=>Eo,findParentNode:()=>gn,findParentNodeClosestToPos:()=>Un,generateHTML:()=>bo,generateJSON:()=>go,generateText:()=>xo,getAttributes:()=>fo,getChangedRanges:()=>Ao,getDebugJSON:()=>co,getExtensionField:()=>Q,getHTMLFromFragment:()=>to,getMarkAttributes:()=>pe,getMarkRange:()=>on,getMarkType:()=>ye,getMarksBetween:()=>uo,getNodeAttributes:()=>Cn,getNodeType:()=>B,getSchema:()=>no,getText:()=>io,getTextBetween:()=>un,getTextContentFromNodes:()=>g,getTextSerializersFromSchema:()=>Le,inputRulesPlugin:()=>Rt,isActive:()=>ro,isList:()=>Pn,isMarkActive:()=>sn,isNodeActive:()=>oe,isNodeEmpty:()=>so,isNodeSelection:()=>Po,isTextSelection:()=>rn,markInputRule:()=>So,markPasteRule:()=>ko,mergeAttributes:()=>Z,nodeInputRule:()=>Bo,pasteRulesPlugin:()=>be,posToDOMRect:()=>po,textInputRule:()=>Ho,textPasteRule:()=>Co,textblockTypeInputRule:()=>No,wrappingInputRule:()=>Io});var T=d(62463),s=d(43594),b=d(13903),P=d(35917),m=d(38480);const ut=(n,t)=>!n.selection.empty&&(t&&t(n.tr.deleteSelection().scrollIntoView()),!0),k=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("backward",n):o.parentOffset>0))return!1;let i=at(o);if(!i){let c=o.blockRange(),p=c&&(0,m.k9)(c);return null!=p&&(t&&t(n.tr.lift(c,p).scrollIntoView()),!0)}let r=i.nodeBefore;if(!r.type.spec.isolating&&bt(n,i,t))return!0;if(0==o.parent.content.size&&(mt(r,"end")||T.qv.isSelectable(r))){let c=(0,m.dR)(n.doc,o.before(),o.after(),P.p2.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=n.tr.step(c);p.setSelection(mt(r,"end")?T.Y1.findFrom(p.doc.resolve(p.mapping.map(i.pos,-1)),-1):T.qv.create(p.doc,i.pos-r.nodeSize)),t(p.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos-r.nodeSize,i.pos).scrollIntoView()),0))};function mt(n,t,e=!1){for(let o=n;o;o="start"==t?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(e&&1!=o.childCount)return!1}return!1}const nt=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):o.parentOffset>0)return!1;r=at(o)}let c=r&&r.nodeBefore;return!(!c||!T.qv.isSelectable(c)||(t&&t(n.tr.setSelection(T.qv.create(n.doc,r.pos-c.nodeSize)).scrollIntoView()),0))};function at(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}const pt=(n,t,e)=>{let{$cursor:o}=n.selection;if(!o||(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size))return!1;let i=gt(o);if(!i)return!1;let r=i.nodeAfter;if(bt(n,i,t))return!0;if(0==o.parent.content.size&&(mt(r,"start")||T.qv.isSelectable(r))){let c=(0,m.dR)(n.doc,o.before(),o.after(),P.p2.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=n.tr.step(c);p.setSelection(mt(r,"start")?T.Y1.findFrom(p.doc.resolve(p.mapping.map(i.pos)),1):T.qv.create(p.doc,p.mapping.map(i.pos))),t(p.scrollIntoView())}return!0}}return!(!r.isAtom||i.depth!=o.depth-1||(t&&t(n.tr.delete(i.pos,i.pos+r.nodeSize).scrollIntoView()),0))},Ot=(n,t,e)=>{let{$head:o,empty:i}=n.selection,r=o;if(!i)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size)return!1;r=gt(o)}let c=r&&r.nodeAfter;return!(!c||!T.qv.isSelectable(c)||(t&&t(n.tr.setSelection(T.qv.create(n.doc,r.pos)).scrollIntoView()),0))};function gt(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const Dt=(n,t)=>{let{$head:e,$anchor:o}=n.selection;return!(!e.parent.type.spec.code||!e.sameParent(o)||(t&&t(n.tr.insertText("\n").scrollIntoView()),0))};function ht(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const X=(n,t)=>{let{$head:e,$anchor:o}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(o))return!1;let i=e.node(-1),r=e.indexAfter(-1),c=ht(i.contentMatchAt(r));if(!c||!i.canReplaceWith(r,r,c))return!1;if(t){let p=e.after(),h=n.tr.replaceWith(p,p,c.createAndFill());h.setSelection(T.Y1.near(h.doc.resolve(p),1)),t(h.scrollIntoView())}return!0},ct=(n,t)=>{let e=n.selection,{$from:o,$to:i}=e;if(e instanceof T.C1||o.parent.inlineContent||i.parent.inlineContent)return!1;let r=ht(i.parent.contentMatchAt(i.indexAfter()));if(!r||!r.isTextblock)return!1;if(t){let c=(!o.parentOffset&&i.index()<i.parent.childCount?o:i).pos,p=n.tr.insert(c,r.createAndFill());p.setSelection(T.Bs.create(p.doc,c+1)),t(p.scrollIntoView())}return!0},z=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let r=e.before();if((0,m.Ax)(n.doc,r))return t&&t(n.tr.split(r).scrollIntoView()),!0}let o=e.blockRange(),i=o&&(0,m.k9)(o);return null!=i&&(t&&t(n.tr.lift(o,i).scrollIntoView()),!0)};function bt(n,t,e){let r,c,o=t.nodeBefore,i=t.nodeAfter;if(o.type.spec.isolating||i.type.spec.isolating)return!1;if(function(n,t,e){let o=t.nodeBefore,i=t.nodeAfter,r=t.index();return!(!(o&&i&&o.type.compatibleContent(i.type))||(!o.content.size&&t.parent.canReplace(r-1,r)?(e&&e(n.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(r,r+1)||!i.isTextblock&&!(0,m.Mn)(n.doc,t.pos)||(e&&e(n.tr.clearIncompatible(t.pos,o.type,o.contentMatchAt(o.childCount)).join(t.pos).scrollIntoView()),0)))}(n,t,e))return!0;let p=t.parent.canReplace(t.index(),t.index()+1);if(p&&(r=(c=o.contentMatchAt(o.childCount)).findWrapping(i.type))&&c.matchType(r[0]||i.type).validEnd){if(e){let J=t.pos+i.nodeSize,Y=P.HY.empty;for(let wt=r.length-1;wt>=0;wt--)Y=P.HY.from(r[wt].create(null,Y));Y=P.HY.from(o.copy(Y));let tt=n.tr.step(new m.FC(t.pos-1,J,t.pos,J,new P.p2(Y,1,0),r.length,!0)),vt=J+2*r.length;(0,m.Mn)(tt.doc,vt)&&tt.join(vt),e(tt.scrollIntoView())}return!0}let h=T.Y1.findFrom(t,1),O=h&&h.$from.blockRange(h.$to),x=O&&(0,m.k9)(O);if(null!=x&&x>=t.depth)return e&&e(n.tr.lift(O,x).scrollIntoView()),!0;if(p&&mt(i,"start",!0)&&mt(o,"end")){let J=o,Y=[];for(;Y.push(J),!J.isTextblock;)J=J.lastChild;let tt=i,vt=1;for(;!tt.isTextblock;tt=tt.firstChild)vt++;if(J.canReplace(J.childCount,J.childCount,tt.content)){if(e){let wt=P.HY.empty;for(let Gt=Y.length-1;Gt>=0;Gt--)wt=P.HY.from(Y[Gt].copy(wt));e(n.tr.step(new m.FC(t.pos-Y.length,t.pos+i.nodeSize,t.pos+vt,t.pos+i.nodeSize-vt,new P.p2(wt,Y.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Nt(n){return function(t,e){let o=t.selection,i=n<0?o.$from:o.$to,r=i.depth;for(;i.node(r).isInline;){if(!r)return!1;r--}return!!i.node(r).isTextblock&&(e&&e(t.tr.setSelection(T.Bs.create(t.doc,n<0?i.start(r):i.end(r)))),!0)}}const Yt=Nt(-1),ft=Nt(1);function et(n,t=null){return function(e,o){let{from:i,to:r}=e.selection,c=!1;return e.doc.nodesBetween(i,r,(p,h)=>{if(c)return!1;if(p.isTextblock&&!p.hasMarkup(n,t))if(p.type==n)c=!0;else{let O=e.doc.resolve(h),x=O.index();c=O.parent.canReplaceWith(x,x+1,n)}}),!!c&&(o&&o(e.tr.setBlockType(i,r,n,t).scrollIntoView()),!0)}}function dt(...n){return function(t,e,o){for(let i=0;i<n.length;i++)if(n[i](t,e,o))return!0;return!1}}let Bt=dt(ut,k,nt),$t=dt(ut,pt,Ot);const qt={Enter:dt(Dt,ct,z,(n,t)=>{let{$from:e,$to:o}=n.selection;if(n.selection instanceof T.qv&&n.selection.node.isBlock)return!(!e.parentOffset||!(0,m.Ax)(n.doc,e.pos)||(t&&t(n.tr.split(e.pos).scrollIntoView()),0));if(!e.parent.isBlock)return!1;if(t){let i=o.parentOffset==o.parent.content.size,r=n.tr;(n.selection instanceof T.Bs||n.selection instanceof T.C1)&&r.deleteSelection();let c=0==e.depth?null:ht(e.node(-1).contentMatchAt(e.indexAfter(-1))),p=i&&c?[{type:c}]:void 0,h=(0,m.Ax)(r.doc,r.mapping.map(e.pos),1,p);if(!p&&!h&&(0,m.Ax)(r.doc,r.mapping.map(e.pos),1,c?[{type:c}]:void 0)&&(c&&(p=[{type:c}]),h=!0),h&&(r.split(r.mapping.map(e.pos),1,p),!i&&!e.parentOffset&&e.parent.type!=c)){let O=r.mapping.map(e.before()),x=r.doc.resolve(O);c&&e.node(-1).canReplaceWith(x.index(),x.index()+1,c)&&r.setNodeMarkup(r.mapping.map(e.before()),c)}t(r.scrollIntoView())}return!0}),"Mod-Enter":X,Backspace:Bt,"Mod-Backspace":Bt,"Shift-Backspace":Bt,Delete:$t,"Mod-Delete":$t,"Mod-a":(n,t)=>(t&&t(n.tr.setSelection(new T.C1(n.doc))),!0)},ae={"Ctrl-h":qt.Backspace,"Alt-Backspace":qt["Mod-Backspace"],"Ctrl-d":qt.Delete,"Ctrl-Alt-Backspace":qt["Mod-Delete"],"Alt-Delete":qt["Mod-Delete"],"Alt-d":qt["Mod-Delete"],"Ctrl-a":Yt,"Ctrl-e":ft};for(let n in qt)ae[n]=qt[n];function _e(n){const{state:t,transaction:e}=n;let{selection:o}=e,{doc:i}=e,{storedMarks:r}=e;return je(te({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return r},get selection(){return o},get doc(){return i},get tr(){return o=e.selection,i=e.doc,r=e.storedMarks,e}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class Ce{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:o}=this,{view:i}=e,{tr:r}=o,c=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([p,h])=>[p,(...x)=>{const J=h(...x)(c);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(r),J}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:c}=i,p=[],h=!!t,O=t||r.tr,J=je(te({},Object.fromEntries(Object.entries(o).map(([Y,tt])=>[Y,(...wt)=>{const Wt=this.buildProps(O,e),Gt=tt(...wt)(Wt);return p.push(Gt),J}]))),{run:()=>(!h&&e&&!O.getMeta("preventDispatch")&&!this.hasCustomState&&c.dispatch(O),p.every(Y=>!0===Y))});return J}createCan(t){const{rawCommands:e,state:o}=this,i=void 0,r=t||o.tr,c=this.buildProps(r,i),p=Object.fromEntries(Object.entries(e).map(([h,O])=>[h,(...x)=>O(...x)(je(te({},c),{dispatch:i}))]));return je(te({},p),{chain:()=>this.createChain(r,i)})}buildProps(t,e=!0){const{rawCommands:o,editor:i,state:r}=this,{view:c}=i;r.storedMarks&&t.setStoredMarks(r.storedMarks);const p={tr:t,editor:i,view:c,state:_e({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(o).map(([h,O])=>[h,(...x)=>O(...x)(p)]))}};return p}}function Q(n,t,e){return void 0===n.config[t]&&n.parent?Q(n.parent,t,e):"function"==typeof n.config[t]?n.config[t].bind(je(te({},e),{parent:n.parent?Q(n.parent,t,e):null})):n.config[t]}function E(n){return{baseExtensions:n.filter(i=>"extension"===i.type),nodeExtensions:n.filter(i=>"node"===i.type),markExtensions:n.filter(i=>"mark"===i.type)}}function A(n){const t=[],{nodeExtensions:e,markExtensions:o}=E(n),i=[...e,...o],r={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(c=>{const h=Q(c,"addGlobalAttributes",{name:c.name,options:c.options,storage:c.storage});h&&h().forEach(x=>{x.types.forEach(J=>{Object.entries(x.attributes).forEach(([Y,tt])=>{t.push({type:J,name:Y,attribute:te(te({},r),tt)})})})})}),i.forEach(c=>{const h=Q(c,"addAttributes",{name:c.name,options:c.options,storage:c.storage});if(!h)return;const O=h();Object.entries(O).forEach(([x,J])=>{const Y=te(te({},r),J);J.isRequired&&void 0===J.default&&delete Y.default,t.push({type:c.name,name:x,attribute:Y})})}),t}function B(n,t){if("string"==typeof n){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}function Z(...n){return n.filter(t=>!!t).reduce((t,e)=>{const o=te({},t);return Object.entries(e).forEach(([i,r])=>{o[i]=o[i]?"class"===i?[o[i],r].join(" "):"style"===i?[o[i],r].join("; "):r:r}),o},{})}function W(n,t){return t.filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,o)=>Z(e,o),{})}function G(n){return"function"==typeof n}function U(n,t,...e){return G(n)?t?n.bind(t)(...e):n(...e):n}function Ft(n,t){return n.style?n:je(te({},n),{getAttrs:e=>{const o=n.getAttrs?n.getAttrs(e):n.attrs;if(!1===o)return!1;const i=t.reduce((r,c)=>{const p=c.attribute.parseHTML?c.attribute.parseHTML(e):function(n){return"string"!=typeof n?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):"true"===n||"false"!==n&&n}(e.getAttribute(c.name));return null==p?r:je(te({},r),{[c.name]:p})},{});return te(te({},o),i)}})}function Zt(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>("attrs"!==t||!function(n={}){return 0===Object.keys(n).length&&n.constructor===Object}(e))&&null!=e))}function H(n){var t;const e=A(n),{nodeExtensions:o,markExtensions:i}=E(n),r=null===(t=o.find(h=>Q(h,"topNode")))||void 0===t?void 0:t.name,c=Object.fromEntries(o.map(h=>{const O=e.filter(Wt=>Wt.type===h.name),x={name:h.name,options:h.options,storage:h.storage},J=n.reduce((Wt,Gt)=>{const me=Q(Gt,"extendNodeSchema",x);return te(te({},Wt),me?me(h):{})},{}),Y=Zt(je(te({},J),{content:U(Q(h,"content",x)),marks:U(Q(h,"marks",x)),group:U(Q(h,"group",x)),inline:U(Q(h,"inline",x)),atom:U(Q(h,"atom",x)),selectable:U(Q(h,"selectable",x)),draggable:U(Q(h,"draggable",x)),code:U(Q(h,"code",x)),defining:U(Q(h,"defining",x)),isolating:U(Q(h,"isolating",x)),attrs:Object.fromEntries(O.map(Wt=>{var Gt;return[Wt.name,{default:null===(Gt=null==Wt?void 0:Wt.attribute)||void 0===Gt?void 0:Gt.default}]}))})),tt=U(Q(h,"parseHTML",x));tt&&(Y.parseDOM=tt.map(Wt=>Ft(Wt,O)));const vt=Q(h,"renderHTML",x);vt&&(Y.toDOM=Wt=>vt({node:Wt,HTMLAttributes:W(Wt,O)}));const wt=Q(h,"renderText",x);return wt&&(Y.toText=wt),[h.name,Y]})),p=Object.fromEntries(i.map(h=>{const O=e.filter(wt=>wt.type===h.name),x={name:h.name,options:h.options,storage:h.storage},J=n.reduce((wt,Wt)=>{const Gt=Q(Wt,"extendMarkSchema",x);return te(te({},wt),Gt?Gt(h):{})},{}),Y=Zt(je(te({},J),{inclusive:U(Q(h,"inclusive",x)),excludes:U(Q(h,"excludes",x)),group:U(Q(h,"group",x)),spanning:U(Q(h,"spanning",x)),code:U(Q(h,"code",x)),attrs:Object.fromEntries(O.map(wt=>{var Wt;return[wt.name,{default:null===(Wt=null==wt?void 0:wt.attribute)||void 0===Wt?void 0:Wt.default}]}))})),tt=U(Q(h,"parseHTML",x));tt&&(Y.parseDOM=tt.map(wt=>Ft(wt,O)));const vt=Q(h,"renderHTML",x);return vt&&(Y.toDOM=wt=>vt({mark:wt,HTMLAttributes:W(wt,O)})),[h.name,Y]}));return new P.V_({topNode:r,nodes:c,marks:p})}function l(n,t){return t.nodes[n]||t.marks[n]||null}function u(n,t){return Array.isArray(t)?t.some(e=>("string"==typeof e?e:e.name)===n.name):t}const g=(n,t=500)=>{let e="";return n.parent.nodesBetween(Math.max(0,n.parentOffset-t),n.parentOffset,(o,i,r,c)=>{var p,h;e+=(null===(h=(p=o.type.spec).toText)||void 0===h?void 0:h.call(p,{node:o,pos:i,parent:r,index:c}))||o.textContent||"%leaf%"}),e};function D(n){return"[object RegExp]"===Object.prototype.toString.call(n)}class L{constructor(t){this.find=t.find,this.handler=t.handler}}function Tt(n){var t;const{editor:e,from:o,to:i,text:r,rules:c,plugin:p}=n,{view:h}=e;if(h.composing)return!1;const O=h.state.doc.resolve(o);if(O.parent.type.spec.code||(null===(t=O.nodeBefore||O.nodeAfter)||void 0===t?void 0:t.marks.find(Y=>Y.type.spec.code)))return!1;let x=!1;const J=g(O)+r;return c.forEach(Y=>{if(x)return;const tt=((n,t)=>{if(D(t))return t.exec(n);const e=t(n);if(!e)return null;const o=[];return o.push(e.text),o.index=e.index,o.input=n,o.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(e.replaceWith)),o})(J,Y.find);if(!tt)return;const vt=h.state.tr,wt=_e({state:h.state,transaction:vt}),Wt={from:o-(tt[0].length-r.length),to:i},{commands:Gt,chain:me,can:Ne}=new Ce({editor:e,state:wt});null===Y.handler({state:wt,range:Wt,match:tt,commands:Gt,chain:me,can:Ne})||!vt.steps.length||(vt.setMeta(p,{transform:vt,from:o,to:i,text:r}),h.dispatch(vt),x=!0)}),x}function Rt(n){const{editor:t,rules:e}=n,o=new T.Sy({state:{init:()=>null,apply:(i,r)=>i.getMeta(o)||(i.selectionSet||i.docChanged?null:r)},props:{handleTextInput:(i,r,c,p)=>Tt({editor:t,from:r,to:c,text:p,rules:e,plugin:o}),handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:r}=i.state.selection;r&&Tt({editor:t,from:r.pos,to:r.pos,text:"",rules:e,plugin:o})}),!1)},handleKeyDown(i,r){if("Enter"!==r.key)return!1;const{$cursor:c}=i.state.selection;return!!c&&Tt({editor:t,from:c.pos,to:c.pos,text:"\n",rules:e,plugin:o})}},isInputRules:!0});return o}class Xt{constructor(t){this.find=t.find,this.handler=t.handler}}function be(n){const{editor:t,rules:e}=n;let o=null,i=!1,r=!1;return e.map(p=>new T.Sy({view(h){const O=x=>{var J;o=(null===(J=h.dom.parentElement)||void 0===J?void 0:J.contains(x.target))?h.dom.parentElement:null};return window.addEventListener("dragstart",O),{destroy(){window.removeEventListener("dragstart",O)}}},props:{handleDOMEvents:{drop:h=>(r=o===h.dom.parentElement,!1),paste:(h,O)=>{var x;const J=null===(x=O.clipboardData)||void 0===x?void 0:x.getData("text/html");return i=!!(null==J?void 0:J.includes("data-pm-slice")),!1}}},appendTransaction:(h,O,x)=>{const J=h[0],Y="paste"===J.getMeta("uiEvent")&&!i,tt="drop"===J.getMeta("uiEvent")&&!r;if(!Y&&!tt)return;const vt=O.doc.content.findDiffStart(x.doc.content),wt=O.doc.content.findDiffEnd(x.doc.content);if(!function(n){return"number"==typeof n}(vt)||!wt||vt===wt.b)return;const Wt=x.tr,Gt=_e({state:x,transaction:Wt});return function(n){const{editor:t,state:e,from:o,to:i,rule:r}=n,{commands:c,chain:p,can:h}=new Ce({editor:t,state:e}),O=[];return e.doc.nodesBetween(o,i,(J,Y)=>{if(!J.isTextblock||J.type.spec.code)return;const tt=Math.max(o,Y),vt=Math.min(i,Y+J.content.size);((n,t)=>{if(D(t))return[...n.matchAll(t)];const e=t(n);return e?e.map(o=>{const i=[];return i.push(o.text),i.index=o.index,i.input=n,i.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(o.replaceWith)),i}):[]})(J.textBetween(tt-Y,vt-Y,void 0,"\ufffc"),r.find).forEach(Gt=>{if(void 0===Gt.index)return;const me=tt+Gt.index+1,Ne=me+Gt[0].length,nn={from:e.tr.mapping.map(me),to:e.tr.mapping.map(Ne)},He=r.handler({state:e,range:nn,match:Gt,commands:c,chain:p,can:h});O.push(He)})}),O.every(J=>null!==J)}({editor:t,state:Gt,from:Math.max(vt-1,0),to:wt.b,rule:p})&&Wt.steps.length?Wt:void 0}}))}class Ge{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=Ge.resolve(t),this.schema=H(this.extensions),this.extensions.forEach(o=>{var i;this.editor.extensionStorage[o.name]=o.storage;const r={name:o.name,options:o.options,storage:o.storage,editor:this.editor,type:l(o.name,this.schema)};"mark"===o.type&&(null===(i=U(Q(o,"keepOnSplit",r)))||void 0===i||i)&&this.splittableMarks.push(o.name);const c=Q(o,"onBeforeCreate",r);c&&this.editor.on("beforeCreate",c);const p=Q(o,"onCreate",r);p&&this.editor.on("create",p);const h=Q(o,"onUpdate",r);h&&this.editor.on("update",h);const O=Q(o,"onSelectionUpdate",r);O&&this.editor.on("selectionUpdate",O);const x=Q(o,"onTransaction",r);x&&this.editor.on("transaction",x);const J=Q(o,"onFocus",r);J&&this.editor.on("focus",J);const Y=Q(o,"onBlur",r);Y&&this.editor.on("blur",Y);const tt=Q(o,"onDestroy",r);tt&&this.editor.on("destroy",tt)})}static resolve(t){const e=Ge.sort(Ge.flatten(t)),o=function(n){const t=n.filter((e,o)=>n.indexOf(e)!==o);return[...new Set(t)]}(e.map(i=>i.name));return o.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${o.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(e=>{const i=Q(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return i?[e,...this.flatten(i())]:e}).flat(10)}static sort(t){return t.sort((o,i)=>{const r=Q(o,"priority")||100,c=Q(i,"priority")||100;return r>c?-1:r<c?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const i=Q(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:l(e.name,this.schema)});return i?te(te({},t),i()):t},{})}get plugins(){const{editor:t}=this,e=Ge.sort([...this.extensions].reverse()),o=[],i=[],r=e.map(c=>{const p={name:c.name,options:c.options,storage:c.storage,editor:t,type:l(c.name,this.schema)},h=[],O=Q(c,"addKeyboardShortcuts",p);if(O){const tt=Object.fromEntries(Object.entries(O()).map(([wt,Wt])=>[wt,()=>Wt({editor:t})])),vt=(0,b.h)(tt);h.push(vt)}const x=Q(c,"addInputRules",p);u(c,t.options.enableInputRules)&&x&&o.push(...x());const J=Q(c,"addPasteRules",p);u(c,t.options.enablePasteRules)&&J&&i.push(...J());const Y=Q(c,"addProseMirrorPlugins",p);if(Y){const tt=Y();h.push(...tt)}return h}).flat();return[Rt({editor:t,rules:o}),...be({editor:t,rules:i}),...r]}get attributes(){return A(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=E(this.extensions);return Object.fromEntries(e.filter(o=>!!Q(o,"addNodeView")).map(o=>{const i=this.attributes.filter(h=>h.type===o.name),r={name:o.name,options:o.options,storage:o.storage,editor:t,type:B(o.name,this.schema)},c=Q(o,"addNodeView",r);return c?[o.name,(h,O,x,J)=>{const Y=W(h,i);return c()({editor:t,node:h,getPos:x,decorations:J,HTMLAttributes:Y,extension:o})}]:[]}))}}function vn(n){return"Object"===function(n){return Object.prototype.toString.call(n).slice(8,-1)}(n)&&n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function dn(n,t){const e=te({},n);return vn(n)&&vn(t)&&Object.keys(t).forEach(o=>{vn(t[o])?o in n?e[o]=dn(n[o],t[o]):Object.assign(e,{[o]:t[o]}):Object.assign(e,{[o]:t[o]})}),e}class ge{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=te(te({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=U(Q(this,"addOptions",{name:this.name}))),this.storage=U(Q(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ge(t)}configure(t={}){const e=this.extend();return e.options=dn(this.options,t),e.storage=U(Q(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new ge(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=U(Q(e,"addOptions",{name:e.name})),e.storage=U(Q(e,"addStorage",{name:e.name,options:e.options})),e}}function un(n,t,e){const{from:o,to:i}=t,{blockSeparator:r="\n\n",textSerializers:c={}}=e||{};let p="",h=!0;return n.nodesBetween(o,i,(O,x,J,Y)=>{var tt;const vt=null==c?void 0:c[O.type.name];vt?(O.isBlock&&!h&&(p+=r,h=!0),J&&(p+=vt({node:O,pos:x,parent:J,index:Y,range:t}))):O.isText?(p+=null===(tt=null==O?void 0:O.text)||void 0===tt?void 0:tt.slice(Math.max(o,x)-x,i-x),h=!1):O.isBlock&&!h&&(p+=r,h=!0)}),p}function Le(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const fe=ge.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:o,selection:i}=t,{ranges:r}=i;return un(o,{from:Math.min(...r.map(x=>x.$from.pos)),to:Math.max(...r.map(x=>x.$to.pos))},{textSerializers:Le(e)})}}})]}});function an(n,t,e={strict:!0}){const o=Object.keys(t);return!o.length||o.every(i=>e.strict?t[i]===n[i]:D(t[i])?t[i].test(n[i]):t[i]===n[i])}function pn(n,t,e={}){return n.find(o=>o.type===t&&an(o.attrs,e))}function hn(n,t,e={}){return!!pn(n,t,e)}function on(n,t,e={}){if(!n||!t)return;let o=n.parent.childAfter(n.parentOffset);if(n.parentOffset===o.offset&&0!==o.offset&&(o=n.parent.childBefore(n.parentOffset)),!o.node)return;const i=pn([...o.node.marks],t,e);if(!i)return;let r=o.index,c=n.start()+o.offset,p=r+1,h=c+o.node.nodeSize;for(pn([...o.node.marks],t,e);r>0&&i.isInSet(n.parent.child(r-1).marks);)r-=1,c-=n.parent.child(r).nodeSize;for(;p<n.parent.childCount&&hn([...n.parent.child(p).marks],t,e);)h+=n.parent.child(p).nodeSize,p+=1;return{from:c,to:h}}function ye(n,t){if("string"==typeof n){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}function Ze(n){return n&&"object"==typeof n&&!Array.isArray(n)&&!function(n){var t;return"class"===(null===(t=n.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(n)}function rn(n){return Ze(n)&&n instanceof T.Bs}function Be(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function C(n,t=null){if(!t)return null;const e=T.Y1.atStart(n),o=T.Y1.atEnd(n);if("start"===t||!0===t)return e;if("end"===t)return o;const i=e.from,r=o.to;return"all"===t?T.Bs.create(n,Be(0,i,r),Be(n.content.size,i,r)):T.Bs.create(n,Be(t,i,r),Be(t,i,r))}function f(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function N(n){const t=`<body>${n}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function $(n,t,e){if(e=te({slice:!0,parseOptions:{}},e),"object"==typeof n&&null!==n)try{return Array.isArray(n)?P.HY.fromArray(n.map(o=>t.nodeFromJSON(o))):t.nodeFromJSON(n)}catch(o){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),$("",t,e)}if("string"==typeof n){const o=P.aw.fromSchema(t);return e.slice?o.parseSlice(N(n),e.parseOptions).content:o.parse(N(n),e.parseOptions)}return $("",t,e)}function zt(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function oe(n,t,e={}){const{from:o,to:i,empty:r}=n.selection,c=t?B(t,n.schema):null,p=[];n.doc.nodesBetween(o,i,(J,Y)=>{if(J.isText)return;const tt=Math.max(o,Y),vt=Math.min(i,Y+J.nodeSize);p.push({node:J,from:tt,to:vt})});const h=i-o,O=p.filter(J=>!c||c.name===J.node.type.name).filter(J=>an(J.node.attrs,e,{strict:!1}));return r?!!O.length:O.reduce((J,Y)=>J+Y.to-Y.from,0)>=h}function a(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function _(n,t){const e="string"==typeof t?[t]:t;return Object.keys(n).reduce((o,i)=>(e.includes(i)||(o[i]=n[i]),o),{})}function ie(n,t,e={}){return $(n,t,{slice:!1,parseOptions:e})}function pe(n,t){const e=ye(t,n.schema),{from:o,to:i,empty:r}=n.selection,c=[];r?(n.storedMarks&&c.push(...n.storedMarks),c.push(...n.selection.$head.marks())):n.doc.nodesBetween(o,i,h=>{c.push(...h.marks)});const p=c.find(h=>h.type.name===e.name);return p?te({},p.attrs):{}}function yn(n,t,e){return Object.fromEntries(Object.entries(e).filter(([o])=>{const i=n.find(r=>r.type===t&&r.name===o);return!!i&&i.attribute.keepOnSplit}))}function Nn(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const o=e.filter(i=>null==t?void 0:t.includes(i.type.name));n.tr.ensureMarks(o)}}function Un(n,t){for(let e=n.depth;e>0;e-=1){const o=n.node(e);if(t(o))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:o}}}function gn(n){return t=>Un(t.$from,n)}function Pn(n,t){const{nodeExtensions:e}=E(t),o=e.find(c=>c.name===n);if(!o)return!1;const r=U(Q(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}const Sn=(n,t)=>{const e=gn(c=>c.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,m.Mn)(n.doc,e.pos)&&n.join(e.pos),!0},In=(n,t)=>{const e=gn(c=>c.type===t)(n.selection);if(!e)return!0;const o=n.doc.resolve(e.start).after(e.depth);if(void 0===o)return!0;const i=n.doc.nodeAt(o);return e.node.type===(null==i?void 0:i.type)&&(0,m.Mn)(n.doc,o)&&n.join(o),!0};function sn(n,t,e={}){const{empty:o,ranges:i}=n.selection,r=t?ye(t,n.schema):null;if(o)return!!(n.storedMarks||n.selection.$from.marks()).filter(J=>!r||r.name===J.type.name).find(J=>an(J.attrs,e,{strict:!1}));let c=0;const p=[];if(i.forEach(({$from:J,$to:Y})=>{const tt=J.pos,vt=Y.pos;n.doc.nodesBetween(tt,vt,(wt,Wt)=>{if(!wt.isText&&!wt.marks.length)return;const Gt=Math.max(tt,Wt),me=Math.min(vt,Wt+wt.nodeSize);c+=me-Gt,p.push(...wt.marks.map(nn=>({mark:nn,from:Gt,to:me})))})}),0===c)return!1;const h=p.filter(J=>!r||r.name===J.mark.type.name).filter(J=>an(J.mark.attrs,e,{strict:!1})).reduce((J,Y)=>J+Y.to-Y.from,0),O=p.filter(J=>!r||J.mark.type!==r&&J.mark.type.excludes(r)).reduce((J,Y)=>J+Y.to-Y.from,0);return(h>0?h+O:h)>=c}var En=Object.freeze({__proto__:null,blur:()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),null===(e=null==window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())}),!0),clearContent:(n=!1)=>({commands:t})=>t.setContent("",n),clearNodes:()=>({state:n,tr:t,dispatch:e})=>{const{selection:o}=t,{ranges:i}=o;return e&&i.forEach(({$from:r,$to:c})=>{n.doc.nodesBetween(r.pos,c.pos,(p,h)=>{if(p.type.isText)return;const{doc:O,mapping:x}=t,J=O.resolve(x.map(h)),Y=O.resolve(x.map(h+p.nodeSize)),tt=J.blockRange(Y);if(!tt)return;const vt=(0,m.k9)(tt);if(p.type.isTextblock){const{defaultType:wt}=J.parent.contentMatchAt(J.index());t.setNodeMarkup(tt.start,wt)}(vt||0===vt)&&t.lift(tt,vt)})}),!0},command:n=>t=>n(t),createParagraphNear:()=>({state:n,dispatch:t})=>ct(n,t),deleteNode:n=>({tr:t,state:e,dispatch:o})=>{const i=B(n,e.schema),r=t.selection.$anchor;for(let c=r.depth;c>0;c-=1)if(r.node(c).type===i){if(o){const h=r.before(c),O=r.after(c);t.delete(h,O).scrollIntoView()}return!0}return!1},deleteRange:n=>({tr:t,dispatch:e})=>{const{from:o,to:i}=n;return e&&t.delete(o,i),!0},deleteSelection:()=>({state:n,dispatch:t})=>ut(n,t),enter:()=>({commands:n})=>n.keyboardShortcut("Enter"),exitCode:()=>({state:n,dispatch:t})=>X(n,t),extendMarkRange:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const r=ye(n,o.schema),{doc:c,selection:p}=e,{$from:h,from:O,to:x}=p;if(i){const J=on(h,r,t);if(J&&J.from<=O&&J.to>=x){const Y=T.Bs.create(c,J.from,J.to);e.setSelection(Y)}}return!0},first:n=>t=>{const e="function"==typeof n?n(t):n;for(let o=0;o<e.length;o+=1)if(e[o](t))return!0;return!1},focus:(n=null,t={})=>({editor:e,view:o,tr:i,dispatch:r})=>{t=te({scrollIntoView:!0},t);const c=()=>{f()&&o.dom.focus(),requestAnimationFrame(()=>{e.isDestroyed||(o.focus(),(null==t?void 0:t.scrollIntoView)&&e.commands.scrollIntoView())})};if(o.hasFocus()&&null===n||!1===n)return!0;if(r&&null===n&&!rn(e.state.selection))return c(),!0;const p=C(e.state.doc,n)||e.state.selection,h=e.state.selection.eq(p);return r&&(h||i.setSelection(p),h&&i.storedMarks&&i.setStoredMarks(i.storedMarks),c()),!0},forEach:(n,t)=>e=>n.every((o,i)=>t(o,je(te({},e),{index:i}))),insertContent:(n,t)=>({tr:e,commands:o})=>o.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),insertContentAt:(n,t,e)=>({tr:o,dispatch:i,editor:r})=>{if(i){e=te({parseOptions:{},updateSelection:!0},e);const c=$(t,r.schema,{parseOptions:te({preserveWhitespace:"full"},e.parseOptions)});if("<>"===c.toString())return!0;let{from:p,to:h}="number"==typeof n?{from:n,to:n}:n,O=!0,x=!0;if(((n=>n.toString().startsWith("<"))(c)?c:[c]).forEach(Y=>{Y.check(),O=!!O&&Y.isText&&0===Y.marks.length,x=!!x&&Y.isBlock}),p===h&&x){const{parent:Y}=o.doc.resolve(p);Y.isTextblock&&!Y.type.spec.code&&!Y.childCount&&(p-=1,h+=1)}O?o.insertText(t,p,h):o.replaceWith(p,h,c),e.updateSelection&&function(n,t,e){const o=n.steps.length-1;if(o<t)return;const i=n.steps[o];if(!(i instanceof m.Pu||i instanceof m.FC))return;let c=0;n.mapping.maps[o].forEach((p,h,O,x)=>{0===c&&(c=x)}),n.setSelection(T.Y1.near(n.doc.resolve(c),-1))}(o,o.steps.length-1)}return!0},joinBackward:()=>({state:n,dispatch:t})=>k(n,t),joinForward:()=>({state:n,dispatch:t})=>pt(n,t),keyboardShortcut:n=>({editor:t,view:e,tr:o,dispatch:i})=>{const r=function(n){const t=n.split(/-(?!$)/);let o,i,r,c,e=t[t.length-1];"Space"===e&&(e=" ");for(let p=0;p<t.length-1;p+=1){const h=t[p];if(/^(cmd|meta|m)$/i.test(h))c=!0;else if(/^a(lt)?$/i.test(h))o=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))r=!0;else{if(!/^mod$/i.test(h))throw new Error(`Unrecognized modifier name: ${h}`);f()||zt()?c=!0:i=!0}}return o&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),c&&(e=`Meta-${e}`),r&&(e=`Shift-${e}`),e}(n).split(/-(?!$)/),c=r.find(O=>!["Alt","Ctrl","Meta","Shift"].includes(O)),p=new KeyboardEvent("keydown",{key:"Space"===c?" ":c,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),h=t.captureTransaction(()=>{e.someProp("handleKeyDown",O=>O(e,p))});return null==h||h.steps.forEach(O=>{const x=O.map(o.mapping);x&&i&&o.maybeStep(x)}),!0},lift:(n,t={})=>({state:e,dispatch:o})=>!!oe(e,B(n,e.schema),t)&&((n,t)=>{let{$from:e,$to:o}=n.selection,i=e.blockRange(o),r=i&&(0,m.k9)(i);return null!=r&&(t&&t(n.tr.lift(i,r).scrollIntoView()),!0)})(e,o),liftEmptyBlock:()=>({state:n,dispatch:t})=>z(n,t),liftListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);return!!r&&(!e||(o.node(r.depth-1).type==n?function(n,t,e,o){let i=n.tr,r=o.end,c=o.$to.end(o.depth);r<c&&(i.step(new m.FC(r-1,c,r,c,new P.p2(P.HY.from(e.create(null,o.parent.copy())),1,0),1,!0)),o=new P.Ts(i.doc.resolve(o.$from.pos),i.doc.resolve(c),o.depth));const p=(0,m.k9)(o);if(null==p)return!1;i.lift(o,p);let h=i.mapping.map(r,-1)-1;return(0,m.Mn)(i.doc,h)&&i.join(h),t(i.scrollIntoView()),!0}(t,e,n,r):function(n,t,e){let o=n.tr,i=e.parent;for(let tt=e.end,vt=e.endIndex-1,wt=e.startIndex;vt>wt;vt--)tt-=i.child(vt).nodeSize,o.delete(tt-1,tt+1);let r=o.doc.resolve(e.start),c=r.nodeAfter;if(o.mapping.map(e.end)!=e.start+r.nodeAfter.nodeSize)return!1;let p=0==e.startIndex,h=e.endIndex==i.childCount,O=r.node(-1),x=r.index(-1);if(!O.canReplace(x+(p?0:1),x+1,c.content.append(h?P.HY.empty:P.HY.from(i))))return!1;let J=r.pos,Y=J+c.nodeSize;return o.step(new m.FC(J-(p?1:0),Y+(h?1:0),J+1,Y-1,new P.p2((p?P.HY.empty:P.HY.from(i.copy(P.HY.empty))).append(h?P.HY.empty:P.HY.from(i.copy(P.HY.empty))),p?0:1,h?0:1),p?0:1)),t(o.scrollIntoView()),!0}(t,e,r)))}}(B(n,t.schema))(t,e),newlineInCode:()=>({state:n,dispatch:t})=>Dt(n,t),resetAttributes:(n,t)=>({tr:e,state:o,dispatch:i})=>{let r=null,c=null;const p=a("string"==typeof n?n:n.name,o.schema);return!!p&&("node"===p&&(r=B(n,o.schema)),"mark"===p&&(c=ye(n,o.schema)),i&&e.selection.ranges.forEach(h=>{o.doc.nodesBetween(h.$from.pos,h.$to.pos,(O,x)=>{r&&r===O.type&&e.setNodeMarkup(x,void 0,_(O.attrs,t)),c&&O.marks.length&&O.marks.forEach(J=>{c===J.type&&e.addMark(x,x+O.nodeSize,c.create(_(J.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),selectAll:()=>({tr:n,commands:t})=>t.setTextSelection({from:0,to:n.doc.content.size}),selectNodeBackward:()=>({state:n,dispatch:t})=>nt(n,t),selectNodeForward:()=>({state:n,dispatch:t})=>Ot(n,t),selectParentNode:()=>({state:n,dispatch:t})=>((n,t)=>{let i,{$from:e,to:o}=n.selection,r=e.sharedDepth(o);return 0!=r&&(i=e.before(r),t&&t(n.tr.setSelection(T.qv.create(n.doc,i))),!0)})(n,t),selectTextblockEnd:()=>({state:n,dispatch:t})=>ft(n,t),selectTextblockStart:()=>({state:n,dispatch:t})=>Yt(n,t),setContent:(n,t=!1,e={})=>({tr:o,editor:i,dispatch:r})=>{const{doc:c}=o,p=ie(n,i.schema,e),h=T.Bs.create(c,0,c.content.size);return r&&o.setSelection(h).replaceSelectionWith(p,!1).setMeta("preventUpdate",!t),!0},setMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{const{selection:r}=e,{empty:c,ranges:p}=r,h=ye(n,o.schema);if(i)if(c){const O=pe(o,h);e.addStoredMark(h.create(te(te({},O),t)))}else p.forEach(O=>{const x=O.$from.pos,J=O.$to.pos;o.doc.nodesBetween(x,J,(Y,tt)=>{const vt=Math.max(tt,x),wt=Math.min(tt+Y.nodeSize,J);Y.marks.find(Gt=>Gt.type===h)?Y.marks.forEach(Gt=>{h===Gt.type&&e.addMark(vt,wt,h.create(te(te({},Gt.attrs),t)))}):e.addMark(vt,wt,h.create(t))})});return!0},setMeta:(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),setNode:(n,t={})=>({state:e,dispatch:o,chain:i})=>{const r=B(n,e.schema);return r.isTextblock?i().command(({commands:c})=>!!et(r,t)(e)||c.clearNodes()).command(({state:c})=>et(r,t)(c,o)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,i=T.Y1.atStart(o).from,r=T.Y1.atEnd(o).to,c=Be(n,i,r),p=T.qv.create(o,c);t.setSelection(p)}return!0},setTextSelection:n=>({tr:t,dispatch:e})=>{if(e){const{doc:o}=t,{from:i,to:r}="number"==typeof n?{from:n,to:n}:n,c=T.Bs.atStart(o).from,p=T.Bs.atEnd(o).to,h=Be(i,c,p),O=Be(r,c,p),x=T.Bs.create(o,h,O);t.setSelection(x)}return!0},sinkListItem:n=>({state:t,dispatch:e})=>function(n){return function(t,e){let{$from:o,$to:i}=t.selection,r=o.blockRange(i,O=>O.childCount>0&&O.firstChild.type==n);if(!r)return!1;let c=r.startIndex;if(0==c)return!1;let p=r.parent,h=p.child(c-1);if(h.type!=n)return!1;if(e){let O=h.lastChild&&h.lastChild.type==p.type,x=P.HY.from(O?n.create():null),J=new P.p2(P.HY.from(n.create(null,P.HY.from(p.type.create(null,x)))),O?3:1,0),Y=r.start,tt=r.end;e(t.tr.step(new m.FC(Y-(O?3:1),tt,Y,tt,J,1,!0)).scrollIntoView())}return!0}}(B(n,t.schema))(t,e),splitBlock:({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:o,editor:i})=>{const{selection:r,doc:c}=t,{$from:p,$to:h}=r,x=yn(i.extensionManager.attributes,p.node().type.name,p.node().attrs);if(r instanceof T.qv&&r.node.isBlock)return!(!p.parentOffset||!(0,m.Ax)(c,p.pos)||(o&&(n&&Nn(e,i.extensionManager.splittableMarks),t.split(p.pos).scrollIntoView()),0));if(!p.parent.isBlock)return!1;if(o){const J=h.parentOffset===h.parent.content.size;r instanceof T.Bs&&t.deleteSelection();const Y=0===p.depth?void 0:function(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}(p.node(-1).contentMatchAt(p.indexAfter(-1)));let tt=J&&Y?[{type:Y,attrs:x}]:void 0,vt=(0,m.Ax)(t.doc,t.mapping.map(p.pos),1,tt);if(!tt&&!vt&&(0,m.Ax)(t.doc,t.mapping.map(p.pos),1,Y?[{type:Y}]:void 0)&&(vt=!0,tt=Y?[{type:Y,attrs:x}]:void 0),vt&&(t.split(t.mapping.map(p.pos),1,tt),Y&&!J&&!p.parentOffset&&p.parent.type!==Y)){const wt=t.mapping.map(p.before()),Wt=t.doc.resolve(wt);p.node(-1).canReplaceWith(Wt.index(),Wt.index()+1,Y)&&t.setNodeMarkup(t.mapping.map(p.before()),Y)}n&&Nn(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:n=>({tr:t,state:e,dispatch:o,editor:i})=>{var r;const c=B(n,e.schema),{$from:p,$to:h}=e.selection,O=e.selection.node;if(O&&O.isBlock||p.depth<2||!p.sameParent(h))return!1;const x=p.node(-1);if(x.type!==c)return!1;const J=i.extensionManager.attributes;if(0===p.parent.content.size&&p.node(-1).childCount===p.indexAfter(-1)){if(2===p.depth||p.node(-3).type!==c||p.index(-2)!==p.node(-2).childCount-1)return!1;if(o){let Wt=P.HY.empty;const Gt=p.index(-1)?1:p.index(-2)?2:3;for(let Tn=p.depth-Gt;Tn>=p.depth-3;Tn-=1)Wt=P.HY.from(p.node(Tn).copy(Wt));const me=p.indexAfter(-1)<p.node(-2).childCount?1:p.indexAfter(-2)<p.node(-3).childCount?2:3,Ne=yn(J,p.node().type.name,p.node().attrs),nn=(null===(r=c.contentMatch.defaultType)||void 0===r?void 0:r.createAndFill(Ne))||void 0;Wt=Wt.append(P.HY.from(c.createAndFill(null,nn)||void 0));const He=p.before(p.depth-(Gt-1));t.replace(He,p.after(-me),new P.p2(Wt,4-Gt,0));let zn=-1;t.doc.nodesBetween(He,t.doc.content.size,(Tn,re)=>{if(zn>-1)return!1;Tn.isTextblock&&0===Tn.content.size&&(zn=re+1)}),zn>-1&&t.setSelection(T.Bs.near(t.doc.resolve(zn))),t.scrollIntoView()}return!0}const Y=h.pos===p.end()?x.contentMatchAt(0).defaultType:null,tt=yn(J,x.type.name,x.attrs),vt=yn(J,p.node().type.name,p.node().attrs);t.delete(p.pos,h.pos);const wt=Y?[{type:c,attrs:tt},{type:Y,attrs:vt}]:[{type:c,attrs:tt}];return!!(0,m.Ax)(t.doc,p.pos,2)&&(o&&t.split(p.pos,2,wt).scrollIntoView(),!0)},toggleList:(n,t)=>({editor:e,tr:o,state:i,dispatch:r,chain:c,commands:p,can:h})=>{const{extensions:O}=e.extensionManager,x=B(n,i.schema),J=B(t,i.schema),{selection:Y}=i,{$from:tt,$to:vt}=Y,wt=tt.blockRange(vt);if(!wt)return!1;const Wt=gn(Gt=>Pn(Gt.type.name,O))(Y);if(wt.depth>=1&&Wt&&wt.depth-Wt.depth<=1){if(Wt.node.type===x)return p.liftListItem(J);if(Pn(Wt.node.type.name,O)&&x.validContent(Wt.node.content)&&r)return c().command(()=>(o.setNodeMarkup(Wt.pos,x),!0)).command(()=>Sn(o,x)).command(()=>In(o,x)).run()}return c().command(()=>!!h().wrapInList(x)||p.clearNodes()).wrapInList(x).command(()=>Sn(o,x)).command(()=>In(o,x)).run()},toggleMark:(n,t={},e={})=>({state:o,commands:i})=>{const{extendEmptyMarkRange:r=!1}=e,c=ye(n,o.schema);return sn(o,c,t)?i.unsetMark(c,{extendEmptyMarkRange:r}):i.setMark(c,t)},toggleNode:(n,t,e={})=>({state:o,commands:i})=>{const r=B(n,o.schema),c=B(t,o.schema);return oe(o,r,e)?i.setNode(c):i.setNode(r,e)},toggleWrap:(n,t={})=>({state:e,commands:o})=>{const i=B(n,e.schema);return oe(e,i,t)?o.lift(i):o.wrapIn(i,t)},undoInputRule:()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let o=0;o<e.length;o+=1){const i=e[o];let r;if(i.spec.isInputRules&&(r=i.getState(n))){if(t){const c=n.tr,p=r.transform;for(let h=p.steps.length-1;h>=0;h-=1)c.step(p.steps[h].invert(p.docs[h]));if(r.text){const h=c.doc.resolve(r.from).marks();c.replaceWith(r.from,r.to,n.schema.text(r.text,h))}else c.delete(r.from,r.to)}return!0}}return!1},unsetAllMarks:()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:o,ranges:i}=e;return o||t&&i.forEach(r=>{n.removeMark(r.$from.pos,r.$to.pos)}),!0},unsetMark:(n,t={})=>({tr:e,state:o,dispatch:i})=>{var r;const{extendEmptyMarkRange:c=!1}=t,{selection:p}=e,h=ye(n,o.schema),{$from:O,empty:x,ranges:J}=p;if(!i)return!0;if(x&&c){let{from:Y,to:tt}=p;const vt=null===(r=O.marks().find(Wt=>Wt.type===h))||void 0===r?void 0:r.attrs,wt=on(O,h,vt);wt&&(Y=wt.from,tt=wt.to),e.removeMark(Y,tt,h)}else J.forEach(Y=>{e.removeMark(Y.$from.pos,Y.$to.pos,h)});return e.removeStoredMark(h),!0},updateAttributes:(n,t={})=>({tr:e,state:o,dispatch:i})=>{let r=null,c=null;const p=a("string"==typeof n?n:n.name,o.schema);return!!p&&("node"===p&&(r=B(n,o.schema)),"mark"===p&&(c=ye(n,o.schema)),i&&e.selection.ranges.forEach(h=>{const O=h.$from.pos,x=h.$to.pos;o.doc.nodesBetween(O,x,(J,Y)=>{r&&r===J.type&&e.setNodeMarkup(Y,void 0,te(te({},J.attrs),t)),c&&J.marks.length&&J.marks.forEach(tt=>{if(c===tt.type){const vt=Math.max(Y,O),wt=Math.min(Y+J.nodeSize,x);e.addMark(vt,wt,c.create(te(te({},tt.attrs),t)))}})})}),!0)},wrapIn:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,c=i.blockRange(r),p=c&&(0,m.nd)(c,n,t);return!!p&&(o&&o(e.tr.wrap(c,p).scrollIntoView()),!0)}}(B(n,e.schema),t)(e,o),wrapInList:(n,t={})=>({state:e,dispatch:o})=>function(n,t=null){return function(e,o){let{$from:i,$to:r}=e.selection,c=i.blockRange(r),p=!1,h=c;if(!c)return!1;if(c.depth>=2&&i.node(c.depth-1).type.compatibleContent(n)&&0==c.startIndex){if(0==i.index(c.depth-1))return!1;let x=e.doc.resolve(c.start-2);h=new P.Ts(x,x,c.depth),c.endIndex<c.parent.childCount&&(c=new P.Ts(i,e.doc.resolve(r.end(c.depth)),c.depth)),p=!0}let O=(0,m.nd)(h,n,t,c);return!!O&&(o&&o(function(n,t,e,o,i){let r=P.HY.empty;for(let x=e.length-1;x>=0;x--)r=P.HY.from(e[x].type.create(e[x].attrs,r));n.step(new m.FC(t.start-(o?2:0),t.end,t.start,t.end,new P.p2(r,0,0),e.length,!0));let c=0;for(let x=0;x<e.length;x++)e[x].type==i&&(c=x+1);let p=e.length-c,h=t.start+e.length-(o?2:0),O=t.parent;for(let x=t.startIndex,J=t.endIndex,Y=!0;x<J;x++,Y=!1)!Y&&(0,m.Ax)(n.doc,h,p)&&(n.split(h,p),h+=2*p),h+=O.child(x).nodeSize;return n}(e.tr,c,O,p,n).scrollIntoView()),!0)}}(B(n,e.schema),t)(e,o)});const oo=ge.create({name:"commands",addCommands:()=>te({},En)}),en=ge.create({name:"editable",addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Wn=ge.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new T.Sy({key:new T.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const o=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1},blur:(t,e)=>{n.isFocused=!1;const o=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(o),!1}}}})]}}),kn=ge.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:c})=>[()=>c.undoInputRule(),()=>c.command(({tr:p})=>{const{selection:h,doc:O}=p,{empty:x,$anchor:J}=h,{pos:Y,parent:tt}=J,vt=T.Y1.atStart(O).from===Y;return!(!(x&&vt&&tt.type.isTextblock)||tt.textContent.length)&&c.clearNodes()}),()=>c.deleteSelection(),()=>c.joinBackward(),()=>c.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:c})=>[()=>c.deleteSelection(),()=>c.joinForward(),()=>c.selectNodeForward()]),o={Enter:()=>this.editor.commands.first(({commands:c})=>[()=>c.newlineInCode(),()=>c.createParagraphNear(),()=>c.liftEmptyBlock(),()=>c.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i=te({},o),r=je(te({},o),{"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return f()||zt()?r:i},addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("clearDocument"),appendTransaction:(n,t,e)=>{if(!n.some(vt=>vt.docChanged)||t.doc.eq(e.doc))return;const{empty:i,from:r,to:c}=t.selection,p=T.Y1.atStart(t.doc).from,h=T.Y1.atEnd(t.doc).to,O=r===p&&c===h,x=0===e.doc.textBetween(0,e.doc.content.size," "," ").length;if(i||!O||!x)return;const J=e.tr,Y=_e({state:e,transaction:J}),{commands:tt}=new Ce({editor:this.editor,state:Y});return tt.clearNodes(),J.steps.length?J:void 0}})]}}),Pe=ge.create({name:"tabindex",addProseMirrorPlugins(){return[new T.Sy({key:new T.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Se=Object.freeze({__proto__:null,ClipboardTextSerializer:fe,Commands:oo,Editable:en,FocusEvents:Wn,Keymap:kn,Tabindex:Pe});function Cn(n,t){const e=B(t,n.schema),{from:o,to:i}=n.selection,r=[];n.doc.nodesBetween(o,i,p=>{r.push(p)});const c=r.reverse().find(p=>p.type.name===e.name);return c?te({},c.attrs):{}}function fo(n,t){const e=a("string"==typeof t?t:t.name,n.schema);return"node"===e?Cn(n,t):"mark"===e?pe(n,t):{}}function to(n,t){const e=P.PW.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function io(n,t){return un(n,{from:0,to:n.content.size},t)}function ro(n,t,e={}){if(!t)return oe(n,null,e)||sn(n,null,e);const o=a(t,n.schema);return"node"===o?oe(n,t,e):"mark"===o&&sn(n,t,e)}function so(n){var t;const e=null===(t=n.type.createAndFill())||void 0===t?void 0:t.toJSON(),o=n.toJSON();return JSON.stringify(e)===JSON.stringify(o)}class lo extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const o=this.callbacks[t];return o&&o.forEach(i=>i.apply(this,e)),this}off(t,e){const o=this.callbacks[t];return o&&(e?this.callbacks[t]=o.filter(i=>i!==e):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(n,t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute("data-tiptap-style",""),o.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',document.getElementsByTagName("head")[0].appendChild(o),o}(0,this.options.injectNonce))}setOptions(t={}){this.options=te(te({},this.options),t),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const o=G(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:o});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,o=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(e))});this.view.updateState(o)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(Se):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(null==o?void 0:o.type));this.extensionManager=new Ge(e,this)}createCommandManager(){this.commandManager=new Ce({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=ie(this.options.content,this.schema,this.options.parseOptions),e=C(t,this.options.autofocus);this.view=new s.tk(this.options.element,je(te({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:T.yy.create({doc:t,selection:e||void 0})}));const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(c=>{var p;return null===(p=this.capturedTransaction)||void 0===p?void 0:p.step(c)}):void(this.capturedTransaction=t);const e=this.state.apply(t),o=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),o&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),r=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return fo(this.state,t)}isActive(t,e){return ro(this.state,"string"==typeof t?t:null,"string"==typeof t?e:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return to(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:o={}}=t||{};return io(this.state.doc,{blockSeparator:e,textSerializers:te(te({},o),Le(this.schema))})}get isEmpty(){return so(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function mo(n,t){const e=new m.wx(n);return t.forEach(o=>{o.steps.forEach(i=>{e.step(i)})}),e}function ao(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function yo(n,t){const e=[];return n.descendants((o,i)=>{t(o)&&e.push({node:o,pos:i})}),e}function Eo(n,t,e){const o=[];return n.nodesBetween(t.from,t.to,(i,r)=>{e(i)&&o.push({node:i,pos:r})}),o}function no(n){return H(Ge.resolve(n))}function bo(n,t){const e=no(t);return to(P.NB.fromJSON(e,n).content,e)}function go(n,t){const e=no(t),o=N(n);return P.aw.fromSchema(e).parse(o).toJSON()}function xo(n,t,e){const{blockSeparator:o="\n\n",textSerializers:i={}}=e||{},r=no(t);return io(P.NB.fromJSON(r,n),{blockSeparator:o,textSerializers:te(te({},i),Le(r))})}function Ao(n){const{mapping:t,steps:e}=n,o=[];return t.maps.forEach((i,r)=>{const c=[];if(i.ranges.length)i.forEach((p,h)=>{c.push({from:p,to:h})});else{const{from:p,to:h}=e[r];if(void 0===p||void 0===h)return;c.push({from:p,to:h})}c.forEach(({from:p,to:h})=>{const O=t.slice(r).map(p,-1),x=t.slice(r).map(h),J=t.invert().map(O,-1),Y=t.invert().map(x);o.push({oldRange:{from:J,to:Y},newRange:{from:O,to:x}})})}),function(n){const t=function(n,t=JSON.stringify){const e={};return n.filter(o=>{const i=t(o);return!Object.prototype.hasOwnProperty.call(e,i)&&(e[i]=!0)})}(n);return 1===t.length?t:t.filter((e,o)=>!t.filter((r,c)=>c!==o).some(r=>e.oldRange.from>=r.oldRange.from&&e.oldRange.to<=r.oldRange.to&&e.newRange.from>=r.newRange.from&&e.newRange.to<=r.newRange.to))}(o)}function co(n,t=0){const o=n.type===n.type.schema.topNodeType?0:1,i=t,r=i+n.nodeSize,c=n.marks.map(O=>{const x={type:O.type.name};return Object.keys(O.attrs).length&&(x.attrs=te({},O.attrs)),x}),p=te({},n.attrs),h={type:n.type.name,from:i,to:r};return Object.keys(p).length&&(h.attrs=p),c.length&&(h.marks=c),n.content.childCount&&(h.content=[],n.forEach((O,x)=>{var J;null===(J=h.content)||void 0===J||J.push(co(O,t+x+o))})),n.text&&(h.text=n.text),h}function uo(n,t,e){const o=[];return n===t?e.resolve(n).marks().forEach(i=>{const c=on(e.resolve(n-1),i.type);!c||o.push(te({mark:i},c))}):e.nodesBetween(n,t,(i,r)=>{o.push(...i.marks.map(c=>({from:r,to:r+i.nodeSize,mark:c})))}),o}function Po(n){return Ze(n)&&n instanceof T.qv}function po(n,t,e){const i=n.state.doc.content.size,r=Be(t,0,i),c=Be(e,0,i),p=n.coordsAtPos(r),h=n.coordsAtPos(c,-1),O=Math.min(p.top,h.top),x=Math.max(p.bottom,h.bottom),J=Math.min(p.left,h.left),Y=Math.max(p.right,h.right),Gt={top:O,bottom:x,left:J,right:Y,width:Y-J,height:x-O,x:J,y:O};return je(te({},Gt),{toJSON:()=>Gt})}function So(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=U(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,c=o[o.length-1],p=o[0];let h=e.to;if(c){const O=p.search(/\S/),x=e.from+p.indexOf(c),J=x+c.length;if(uo(e.from,e.to,t.doc).filter(tt=>tt.mark.type.excluded.find(wt=>wt===n.type&&wt!==tt.mark.type)).filter(tt=>tt.to>x).length)return null;J<e.to&&r.delete(J,e.to),x>e.from&&r.delete(e.from+O,x),h=e.from+O+c.length,r.addMark(e.from+O,h,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function Bo(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=U(n.getAttributes,void 0,o)||{},{tr:r}=t,c=e.from;let p=e.to;if(o[1]){let O=c+o[0].lastIndexOf(o[1]);O>p?O=p:p=O+o[1].length,r.insertText(o[0][o[0].length-1],c+o[0].length-1),r.replaceWith(O,p,n.type.create(i))}else o[0]&&r.replaceWith(c,p,n.type.create(i))}})}function No(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=t.doc.resolve(e.from),r=U(n.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,r)}})}function Ho(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const c=e.to;if(o[1]){const p=o[0].lastIndexOf(o[1]);i+=o[0].slice(p+o[1].length),r+=p;const h=r-c;h>0&&(i=o[0].slice(p-h,p)+i,r=c)}t.tr.insertText(i,r,c)}})}function Io(n){return new L({find:n.find,handler:({state:t,range:e,match:o})=>{const i=U(n.getAttributes,void 0,o)||{},r=t.tr.delete(e.from,e.to),p=r.doc.resolve(e.from).blockRange(),h=p&&(0,m.nd)(p,n.type,i);if(!h)return null;r.wrap(p,h);const O=r.doc.resolve(e.from-1).nodeBefore;O&&O.type===n.type&&(0,m.Mn)(r.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(o,O))&&r.join(e.from-1)}})}class Vn{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=te(te({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=U(Q(this,"addOptions",{name:this.name}))),this.storage=U(Q(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Vn(t)}configure(t={}){const e=this.extend();return e.options=dn(this.options,t),e.storage=U(Q(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Vn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=U(Q(e,"addOptions",{name:e.name})),e.storage=U(Q(e,"addStorage",{name:e.name,options:e.options})),e}}class jn{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=te(te({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=U(Q(this,"addOptions",{name:this.name}))),this.storage=U(Q(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new jn(t)}configure(t={}){const e=this.extend();return e.options=dn(this.options,t),e.storage=U(Q(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new jn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=U(Q(e,"addOptions",{name:e.name})),e.storage=U(Q(e,"addStorage",{name:e.name,options:e.options})),e}}class _o{constructor(t,e,o){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options=te({stopEvent:null,ignoreMutation:null},o),this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,o,i,r,c,p,h;const{view:O}=this.editor,x=t.target,J=3===x.nodeType?null===(e=x.parentElement)||void 0===e?void 0:e.closest("[data-drag-handle]"):x.closest("[data-drag-handle]");if(!this.dom||(null===(o=this.contentDOM)||void 0===o?void 0:o.contains(x))||!J)return;let Y=0,tt=0;if(this.dom!==J){const Wt=this.dom.getBoundingClientRect(),Gt=J.getBoundingClientRect(),me=null!==(i=t.offsetX)&&void 0!==i?i:null===(r=t.nativeEvent)||void 0===r?void 0:r.offsetX,Ne=null!==(c=t.offsetY)&&void 0!==c?c:null===(p=t.nativeEvent)||void 0===p?void 0:p.offsetY;Y=Gt.x-Wt.x+me,tt=Gt.y-Wt.y+Ne}null===(h=t.dataTransfer)||void 0===h||h.setDragImage(this.dom,Y,tt);const vt=T.qv.create(O.state.doc,this.getPos()),wt=O.state.tr.setSelection(vt);O.dispatch(wt)}stopEvent(t){var e;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const o=t.target;if(!this.dom.contains(o)||(null===(e=this.contentDOM)||void 0===e?void 0:e.contains(o)))return!1;const r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(o.tagName)||o.isContentEditable)&&!r)return!0;const{isEditable:p}=this.editor,{isDragging:h}=this,O=!!this.node.type.spec.draggable,x=T.qv.isSelectable(this.node),J="copy"===t.type,Y="paste"===t.type,tt="cut"===t.type,vt="mousedown"===t.type,wt=t.type.startsWith("drag");if(!O&&x&&wt&&t.preventDefault(),O&&wt&&!h)return t.preventDefault(),!1;if(O&&p&&!h&&vt){const Wt=o.closest("[data-drag-handle]");Wt&&(this.dom===Wt||this.dom.contains(Wt))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(h||r||J||Y||tt||vt&&x)}ignoreMutation(t){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:t}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===t.type||this.dom.contains(t.target)&&"childList"===t.type&&f()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(o=>o.isContentEditable)||(this.contentDOM!==t.target||"attributes"!==t.type)&&this.contentDOM.contains(t.target))))}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const o=this.getPos();return e.setNodeMarkup(o,void 0,te(te({},this.node.attrs),t)),!0})}deleteNode(){const t=this.getPos();this.editor.commands.deleteRange({from:t,to:t+this.node.nodeSize})}}function ko(n){return new Xt({find:n.find,handler:({state:t,range:e,match:o})=>{const i=U(n.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:r}=t,c=o[o.length-1],p=o[0];let h=e.to;if(c){const O=p.search(/\S/),x=e.from+p.indexOf(c),J=x+c.length;if(uo(e.from,e.to,t.doc).filter(tt=>tt.mark.type.excluded.find(wt=>wt===n.type&&wt!==tt.mark.type)).filter(tt=>tt.to>x).length)return null;J<e.to&&r.delete(J,e.to),x>e.from&&r.delete(e.from+O,x),h=e.from+O+c.length,r.addMark(e.from+O,h,n.type.create(i||{})),r.removeStoredMark(n.type)}}})}function Co(n){return new Xt({find:n.find,handler:({state:t,range:e,match:o})=>{let i=n.replace,r=e.from;const c=e.to;if(o[1]){const p=o[0].lastIndexOf(o[1]);i+=o[0].slice(p+o[1].length),r+=p;const h=r-c;h>0&&(i=o[0].slice(p-h,p)+i,r=c)}t.tr.insertText(i,r,c)}})}class wo{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((i,r)=>{const c=r.getMap().mapResult(i);return c.deleted&&(e=!0),c.pos},t),deleted:e}}}function To(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}},74634:(Jt,Et,d)=>{d.r(Et),d.d(Et,{TextStyle:()=>s,default:()=>s});var T=d(40256);const s=T.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:b=>!!b.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:b}){return["span",(0,T.mergeAttributes)(this.options.HTMLAttributes,b),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:b,commands:P})=>{const m=(0,T.getMarkAttributes)(b,this.type);return!!Object.entries(m).some(([,k])=>!!k)||P.unsetMark(this.name)}}}})},97019:(Jt,Et,d)=>{d.d(Et,{h:()=>yt});var T=d(64762),s=d(74788),b=d(36692),P=d(50170),m=d(1414),ut=d(10200),k=d(33250),mt=d(68874),nt=d(23738),at=d(52219),pt=d(12057),Ot=d(65009),gt=d(10383),_t=d(20933),Lt=d(35065),It=d(63060),Dt=d(62733),ht=d(48214),X=d(11189),ct=d(91030);function z(rt,bt){if(1&rt&&(s.TgZ(0,"button",6),s._uU(1),s.qZA()),2&rt){const Nt=bt.$implicit;s.Q6J("value",Nt),s.xp6(1),s.hij(" ",Nt," ")}}function Ct(rt,bt){if(1&rt&&(s.TgZ(0,"tui-data-list"),s.YNc(1,z,2,2,"button",5),s.qZA()),2&rt){const Nt=s.oxw();s.xp6(1),s.Q6J("ngForOf",Nt.modes)}}function xt(rt,bt){if(1&rt){const Nt=s.EpF();s.TgZ(0,"tui-primitive-textfield",7),s.NdJ("valueChange",function(ft){return s.CHM(Nt),s.oxw().onHexChange(ft)}),s._UZ(1,"input",8),s.qZA()}if(2&rt){const Nt=s.oxw();s.Q6J("textMask",Nt.hexMask)("tuiTextfieldLabelOutside",!0)("value",Nt.hex)}}function At(rt,bt){if(1&rt){const Nt=s.EpF();s.TgZ(0,"tui-input-count",9),s.NdJ("ngModelChange",function(ft){s.CHM(Nt);const S=s.oxw();return S.onRgbChange(ft,S.color[1],S.color[2],S.color[3])}),s.qZA(),s.TgZ(1,"tui-input-count",9),s.NdJ("ngModelChange",function(ft){s.CHM(Nt);const S=s.oxw();return S.onRgbChange(S.color[0],ft,S.color[2],S.color[3])}),s.qZA(),s.TgZ(2,"tui-input-count",9),s.NdJ("ngModelChange",function(ft){s.CHM(Nt);const S=s.oxw();return S.onRgbChange(S.color[0],S.color[1],ft,S.color[3])}),s.qZA()}if(2&rt){const Nt=s.oxw();s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Nt.color[0]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Nt.color[1]),s.xp6(1),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",255)("ngModel",Nt.color[2])}}class yt{constructor(){this.color=[0,0,0,1],this.colorChange=new s.vpe,this.hexMask={mask:({length:bt})=>Array.from({length:bt},()=>/\d|[a-f]|[A-F]/),guide:!1},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return(0,b.tuiRgbToHex)(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(bt){if(6!==bt.length)return;const Nt=(0,b.tuiHexToRgb)(bt);this.updateColor([Nt[0],Nt[1],Nt[2],this.color[3]])}onRgbChange(...bt){this.updateColor(bt)}updateColor(bt){this.color=bt,this.colorChange.emit(bt)}}yt.\u0275fac=function(bt){return new(bt||yt)},yt.\u0275cmp=s.Xpm({type:yt,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:6,vars:8,consts:[["tuiTextfieldSize","m","tuiDropdownAlign","left","tuiDropdownLimitWidth","min",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],[4,"tuiDataList"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["postfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"],["size","xs","tuiOption","",3,"value",4,"ngFor","ngForOf"],["size","xs","tuiOption","",3,"value"],["tuiValueAccessor","","tuiTextfieldSize","m",3,"textMask","tuiTextfieldLabelOutside","value","valueChange"],["tuiTextfield","","maxlength","6"],["tuiTextfieldSize","m",3,"tuiTextfieldLabelOutside","hideButtons","max","ngModel","ngModelChange"]],template:function(bt,Nt){if(1&bt&&(s.TgZ(0,"tui-select",0),s.NdJ("ngModelChange",function(ft){return Nt.mode=ft}),s.YNc(1,Ct,2,1,"tui-data-list",1),s.qZA(),s.YNc(2,xt,2,3,"tui-primitive-textfield",2),s.YNc(3,At,3,12,"ng-template",null,3,s.W1O),s.TgZ(5,"tui-input-count",4),s.NdJ("ngModelChange",function(ft){return Nt.onRgbChange(Nt.color[0],Nt.color[1],Nt.color[2],ft/100)}),s.qZA()),2&bt){const Yt=s.MAs(4);s.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",Nt.mode),s.xp6(2),s.Q6J("ngIf",Nt.isHex)("ngIfElse",Yt),s.xp6(3),s.Q6J("tuiTextfieldLabelOutside",!0)("hideButtons",!0)("max",100)("ngModel",Nt.opacity)}},directives:[P.u,m.O,ut.s,k.Ek,mt.x,nt.JJ,nt.On,at.g,pt.O5,Ot.E,gt.a,_t.q,pt.sg,Lt.v,It.y,Dt.B,ht.n,X.h,ct.M],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:4.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}"],changeDetection:0}),(0,T.gn)([(0,b.tuiDefaultProp)()],yt.prototype,"color",void 0)},49289:(Jt,Et,d)=>{d.d(Et,{$:()=>k});var T=d(64762),s=d(74788),b=d(91211),P=d(36692),m=d(71424),ut=d(65720);class k{constructor(nt){this.sanitizer=nt,this.colorChange=new s.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color(nt){if(this.currentColor.every((gt,_t)=>gt===nt[_t])&&nt[3]===this.opacity)return;const[at,pt,Ot]=(0,P.tuiRgbToHsv)(nt[0],nt[1],nt[2]);this.opacity=nt[3],this.hue=at/360,this.point=[pt,1-Ot/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${(0,P.tuiHsvToRgb)(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange(nt){this.point=nt,this.updateColor()}onHueChange(nt){this.hue=nt,this.updateColor()}onOpacityChange(nt){this.opacity=(0,P.tuiRound)(nt,2),this.updateColor()}getCurrentColor(nt,at){return(0,P.tuiHsvToRgb)(360*nt,at[0],255*(1-at[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}k.\u0275fac=function(nt){return new(nt||k)(s.Y36(b.H7))},k.\u0275cmp=s.Xpm({type:k,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function(nt,at){1&nt&&(s.TgZ(0,"tui-flat-picker",0),s.NdJ("valueChange",function(Ot){return at.onPointChange(Ot)}),s.qZA(),s.TgZ(1,"div",1),s.TgZ(2,"tui-linear-picker",2),s.NdJ("valueChange",function(Ot){return at.onHueChange(Ot)}),s.qZA(),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"tui-linear-picker",4),s.NdJ("valueChange",function(Ot){return at.onOpacityChange(Ot)}),s.qZA(),s.qZA()),2&nt&&(s.Udp("background-color",at.base),s.Q6J("value",at.point),s.xp6(2),s.Q6J("value",at.hue),s.xp6(1),s.Udp("background",at.gradient),s.xp6(1),s.Q6J("value",at.opacity))},directives:[m.J,ut.P],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(rgba(0,0,0,0),#000000),linear-gradient(to right,#ffffff,rgba(255,255,255,0));margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:#ff0000}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],k.prototype,"color",null),(0,T.gn)([P.tuiPure],k.prototype,"getCurrentColor",null)},23999:(Jt,Et,d)=>{d.d(Et,{s:()=>Mt});var T=d(64762),s=d(74788),b=d(91211),P=d(62842),m=d(37631),ut=d(36692),k=d(62939),mt=d(76189),nt=d(12057),at=d(49289),pt=d(34880),Ot=d(20933),gt=d(35065),_t=d(49472),Lt=d(67446),It=d(29070),Dt=d(54255),ht=d(15491),X=d(219),ct=d(97019),z=d(39607),Ct=d(5451);function xt(F,K){if(1&F&&s._UZ(0,"tui-svg",9),2&F){s.oxw();const dt=s.MAs(1);s.ekj("t-arrow_rotated",dt.open)}}function At(F,K){1&F&&s._UZ(0,"tui-svg",14)}function yt(F,K){if(1&F){const dt=s.EpF();s.TgZ(0,"button",12),s.NdJ("keydown.enter.prevent",function(){const qt=s.CHM(dt).$implicit,ae=s.oxw(2),le=s.MAs(1);return ae.onModeSelect(qt,le)})("keydown.space.prevent",function(){const qt=s.CHM(dt).$implicit,ae=s.oxw(2),le=s.MAs(1);return ae.onModeSelect(qt,le)})("click",function(){const qt=s.CHM(dt).$implicit,ae=s.oxw(2),le=s.MAs(1);return ae.onModeSelect(qt,le)}),s._uU(1),s.YNc(2,At,1,0,"tui-svg",13),s.qZA()}if(2&F){const dt=K.$implicit,Bt=s.oxw(2);s.uIk("aria-checked",Bt.isModeActive(dt)),s.xp6(1),s.hij(" ",dt," "),s.xp6(1),s.Q6J("ngIf",Bt.isModeActive(dt))}}function rt(F,K){if(1&F&&(s.TgZ(0,"tui-data-list",10),s.YNc(1,yt,3,3,"button",11),s.qZA()),2&F){const dt=s.oxw();s.xp6(1),s.Q6J("ngForOf",dt.modes)}}function bt(F,K){if(1&F){const dt=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){const qt=s.CHM(dt).$implicit;return s.oxw(2).onDirectionChange(qt)}),s.qZA()}if(2&F){const dt=K.$implicit,Bt=s.oxw(2);s.ekj("t-direction_active",Bt.isDirectionActive(dt)),s.Q6J("icon",Bt.getIcon(dt))("tuiHint",dt)("tuiHintDescribe","")}}function Nt(F,K){if(1&F){const dt=s.EpF();s.ynx(0),s._UZ(1,"hr",15),s.TgZ(2,"div",16),s.TgZ(3,"tui-linear-multi-picker",17),s.NdJ("valueChange",function($t){return s.CHM(dt),s.oxw().onStopsChange($t)})("indexChange",function($t){return s.CHM(dt),s.oxw().onIndexChange($t)}),s.qZA(),s.qZA(),s.TgZ(4,"div",18),s.YNc(5,bt,1,5,"button",19),s.qZA(),s.BQk()}if(2&F){const dt=s.oxw();s.xp6(2),s.Udp("background",dt.gradient),s.xp6(1),s.Q6J("value",dt.stopsKeys),s.xp6(2),s.Q6J("ngForOf",dt.buttons)}}function Yt(F,K){if(1&F){const dt=s.EpF();s.TgZ(0,"tui-color-edit",21),s.NdJ("colorChange",function($t){return s.CHM(dt),s.oxw().onColorChange($t)}),s.qZA()}if(2&F){const dt=s.oxw();s.Q6J("color",dt.color)}}function ft(F,K){if(1&F){const dt=s.EpF();s.TgZ(0,"tui-palette",22),s.NdJ("selectedColor",function($t){return s.CHM(dt),s.oxw().onPalettePick($t)}),s.qZA()}if(2&F){const dt=s.oxw();s.Q6J("colors",dt.palette)}}const S=[0,0,0,0],et=[[0,[0,0,0,1]],[1,[255,255,255,1]]],lt={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};class Mt{constructor(K,dt){this.sanitizer=K,this.modes=dt,this.stops=new Map(et),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new s.vpe,this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(K){this.parse(K)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(K){return lt[K]}isModeActive(K){return this.currentMode===K}isDirectionActive(K){return this.direction===K}onPalettePick(K){this.updateColor(K)}onDirectionChange(K){this.direction=K,this.updateColor(this.getGradient(K))}onModeSelect(K,dt){this.currentMode=K,dt.open=!1,this.updateColor(K===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(K){this.currentStop=this.stopsKeys[K]}onColorChange(K){this.isGradient?(this.stops.set(this.currentStop,K),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${K.join(", ")})`)}onStopsChange(K){const dt=this.stopsKeys.find($t=>!K.includes($t)),Bt=K.find($t=>!this.stopsKeys.includes($t));void 0===dt&&void 0!==Bt&&this.addStop(Bt),void 0!==dt&&void 0===Bt&&this.removeStop(dt),void 0!==dt&&void 0!==Bt&&this.replaceStop(dt,Bt),this.updateColor(this.getGradient(this.direction))}getStopsKeys(K){return Array.from(K.keys())}filterPalette(K,dt){const Bt=new Map(K);return Bt.forEach(($t,qt)=>{($t.startsWith("linear-gradient")&&!dt||!$t.startsWith("linear-gradient")&&dt)&&Bt.delete(qt)}),Bt}updateColor(K){this.colorChange.emit(K)}getGradient(K){return`linear-gradient(${K}, ${[...this.stopsKeys].sort().map(dt=>`rgba(${this.getStop(dt).join(", ")}) ${100*dt}%`).join(", ")})`}getStop(K){return this.stops.get(K)||S}addStop(K){const dt=this.stopsKeys.reduce((Bt,$t)=>Math.abs($t-K)<Math.abs(Bt-K)?$t:Bt,this.stopsKeys[0]);this.stops.set(K,this.getStop(dt)),this.stops=new Map(this.stops),this.currentStop=K}removeStop(K){this.stops.delete(K),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(K,dt){const Bt=this.getStop(K);this.currentStop=dt,this.stops=new Map(this.stopsKeys.map($t=>$t===K?[dt,Bt]:[$t,this.getStop($t)]))}parse(K){K.startsWith("linear-gradient")?this.parseGradient(K):this.parseColor(K)}parseGradient(K){if(K===this.getGradient(this.direction))return;const dt=(0,m._N)((0,m.U5)(K));this.currentMode=this.modes[1],this.direction=dt.side,this.currentStop=0,this.stops=new Map(dt.stops.length?dt.stops.map(({color:Bt,position:$t})=>[parseFloat($t)/100,(0,ut.tuiParseColor)(Bt)]):et)}parseColor(K){this.currentMode=this.modes[0],this.currentStop=0,this.color=(0,ut.tuiParseColor)(K)}}Mt.\u0275fac=function(K){return new(K||Mt)(s.Y36(b.H7),s.Y36(P.dj))},Mt.\u0275cmp=s.Xpm({type:Mt,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["tuiButton","","appearance","","size","s","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],["src","tuiIconChevronDown",1,"t-arrow"],["role","menu",1,"t-menu"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click",4,"ngFor","ngForOf"],["tuiOption","","size","xs","role","menuitemradio",3,"keydown.enter.prevent","keydown.space.prevent","click"],["src","tuiIconCheck","class","t-checkmark",4,"ngIf"],["src","tuiIconCheck",1,"t-checkmark"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","valueChange","indexChange"],[1,"t-buttons"],["tuiIconButton","","type","button","size","xs","appearance","","class","t-direction",3,"t-direction_active","icon","tuiHint","tuiHintDescribe","click",4,"ngFor","ngForOf"],["tuiIconButton","","type","button","size","xs","appearance","",1,"t-direction",3,"icon","tuiHint","tuiHintDescribe","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(K,dt){if(1&K&&(s.TgZ(0,"tui-hosted-dropdown",0,1),s.TgZ(2,"button",2),s._uU(3),s.qZA(),s.YNc(4,xt,1,2,"ng-template",null,3,s.W1O),s.YNc(6,rt,2,1,"ng-template",null,4,s.W1O),s.qZA(),s.YNc(8,Nt,6,4,"ng-container",5),s.TgZ(9,"tui-color-picker",6),s.NdJ("colorChange",function($t){return dt.onColorChange($t)}),s.qZA(),s.YNc(10,Yt,1,1,"tui-color-edit",7),s.YNc(11,ft,1,1,"tui-palette",8)),2&K){const Bt=s.MAs(5),$t=s.MAs(7);s.Q6J("content",$t),s.xp6(2),s.Q6J("iconRight",Bt),s.xp6(1),s.hij(" ",dt.currentMode," "),s.xp6(5),s.Q6J("ngIf",dt.isGradient),s.xp6(1),s.Q6J("color",dt.currentColor),s.xp6(1),s.Q6J("ngIf",!dt.isGradient),s.xp6(1),s.Q6J("ngIf",dt.palette.size)}},directives:[k.o,mt.v,nt.O5,at.$,pt.P,Ot.q,nt.sg,gt.v,_t.e,Lt.D,It.x,Dt.t,ht.D,X.$,ct.h,z.g,Ct.R],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:21.25rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,T.gn)([(0,ut.tuiDefaultProp)()],Mt.prototype,"colors",void 0),(0,T.gn)([(0,ut.tuiRequiredSetter)()],Mt.prototype,"colorSetter",null),(0,T.gn)([ut.tuiPure],Mt.prototype,"getStopsKeys",null),(0,T.gn)([ut.tuiPure],Mt.prototype,"filterPalette",null)},71424:(Jt,Et,d)=>{d.d(Et,{J:()=>m});var T=d(64762),s=d(74788),b=d(62141),P=d(36692);class m{constructor(k){this.value=[0,0],this.valueChange=new s.vpe,k.subscribe(mt=>{this.value=mt,this.valueChange.emit([mt[0],mt[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}m.\u0275fac=function(k){return new(k||m)(s.Y36(b.i))},m.\u0275cmp=s.Xpm({type:m,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([P.TuiDestroyService,b.i])],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(k,mt){1&k&&s._UZ(0,"div",0),2&k&&s.Udp("left",mt.left,"%")("top",mt.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],m.prototype,"value",void 0)},27050:(Jt,Et,d)=>{d.d(Et,{hR:()=>T.h,TD:()=>k,$v:()=>mt.$,H9:()=>pt,sV:()=>Ot.s,wl:()=>It,Jd:()=>Dt.J,ui:()=>nt,es:()=>ht.e,GU:()=>_t,P:()=>X.P,g7:()=>at,Rh:()=>ct.R,VM:()=>Lt});var T=d(97019),s=d(12057),b=d(23738),P=d(72002),m=d(753),ut=d(74788);let k=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez,b.u5,m.TextMaskModule,m.TuiValueAccessorModule,m.TuiSelectModule,P.TuiPrimitiveTextfieldModule,P.TuiTextfieldControllerModule,P.TuiDropdownModule,m.TuiInputCountModule,P.TuiDataListModule]]}),z})();var mt=d(49289);let nt=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez]]}),z})(),at=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez]]}),z})(),pt=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez,nt,at]]}),z})();var Ot=d(23999),gt=d(36692);let _t=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez]]}),z})(),Lt=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez,P.TuiHintModule]]}),z})(),It=(()=>{class z{}return z.\u0275fac=function(xt){return new(xt||z)},z.\u0275mod=ut.oAB({type:z}),z.\u0275inj=ut.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHostedDropdownModule,pt,_t,P.TuiHintModule,P.TuiSvgModule,P.TuiDataListModule,gt.TuiActiveZoneModule,k,P.TuiGroupModule,Lt]]}),z})();var Dt=d(71424),ht=d(49472),X=d(65720),ct=d(5451)},49472:(Jt,Et,d)=>{d.d(Et,{e:()=>k});var T=d(64762),s=d(74788),b=d(62141),P=d(36692),m=d(12057);function ut(mt,nt){if(1&mt){const at=s.EpF();s.TgZ(0,"div",1),s.NdJ("mousedown",function(){const gt=s.CHM(at).index;return s.oxw().onMouseDown(gt)})("dblclick",function(){const gt=s.CHM(at).index;return s.oxw().onClick(gt)}),s.qZA()}2&mt&&s.Udp("left",100*nt.$implicit,"%")}class k{constructor(nt){this.value=[0,1],this.valueChange=new s.vpe,this.indexChange=new s.vpe,this.index=NaN,nt.subscribe(([at])=>{this.onPicker(at)})}onMouseUp(){this.index=NaN}onMouseDown(nt){this.updateIndex(nt)}onClick(nt){this.value.length>2&&this.updateValue(this.value.filter((at,pt)=>pt!==nt))}onPicker(nt){isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((at,pt)=>at===nt&&pt!==this.index)&&this.updateValue(this.value.map((at,pt)=>pt===this.index?nt:at))}updateIndex(nt){this.index=nt,this.indexChange.emit(nt)}updateValue(nt){this.value=nt,this.valueChange.emit(nt)}}k.\u0275fac=function(nt){return new(nt||k)(s.Y36(b.i))},k.\u0275cmp=s.Xpm({type:k,selectors:[["tui-linear-multi-picker"]],hostBindings:function(nt,at){1&nt&&s.NdJ("mouseup",function(){return at.onMouseUp()},!1,s.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},features:[s._Bn([P.TuiDestroyService,b.i])],decls:1,vars:1,consts:[["class","t-circle",3,"left","mousedown","dblclick",4,"ngFor","ngForOf"],[1,"t-circle",3,"mousedown","dblclick"]],template:function(nt,at){1&nt&&s.YNc(0,ut,1,2,"div",0),2&nt&&s.Q6J("ngForOf",at.value)},directives:[m.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],k.prototype,"value",void 0)},65720:(Jt,Et,d)=>{d.d(Et,{P:()=>m});var T=d(64762),s=d(74788),b=d(62141),P=d(36692);class m{constructor(k){this.value=0,this.valueChange=new s.vpe,k.subscribe(([mt])=>{this.value=mt,this.valueChange.emit(mt)})}get left(){return 100*this.value}}m.\u0275fac=function(k){return new(k||m)(s.Y36(b.i))},m.\u0275cmp=s.Xpm({type:m,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[s._Bn([P.TuiDestroyService,b.i])],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(k,mt){1&k&&s._UZ(0,"div",0),2&k&&s.Udp("left",mt.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],m.prototype,"value",void 0)},5451:(Jt,Et,d)=>{d.d(Et,{R:()=>pt});var T=d(64762),s=d(74788),b=d(36692),P=d(12057),m=d(67446),ut=d(29070),k=d(54255),mt=d(15491),nt=d(219);function at(Ot,gt){if(1&Ot){const _t=s.EpF();s.TgZ(0,"button",1),s.NdJ("click",function(){const Dt=s.CHM(_t).$implicit;return s.oxw().selectedColor.emit(Dt.value)}),s.qZA()}if(2&Ot){const _t=gt.$implicit;s.Udp("background",_t.value),s.Q6J("tuiHint",_t.key)("tuiHintDescribe",_t.key)("id",_t.key)}}class pt{constructor(){this.colors=new Map,this.selectedColor=new s.vpe,this.originalOrder=(gt,_t)=>0}}pt.\u0275fac=function(gt){return new(gt||pt)},pt.\u0275cmp=s.Xpm({type:pt,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:4,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintDescribe","id","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintDescribe","id","click"]],template:function(gt,_t){1&gt&&(s.YNc(0,at,1,5,"button",0),s.ALo(1,"keyvalue")),2&gt&&s.Q6J("ngForOf",s.xi3(1,1,_t.colors,_t.originalOrder))},directives:[P.sg,m.D,ut.x,k.t,mt.D,nt.$],pipes:[P.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),(0,T.gn)([(0,b.tuiDefaultProp)()],pt.prototype,"colors",void 0)},45050:(Jt,Et,d)=>{d.d(Et,{l:()=>At});var T=d(64762),s=d(12057),b=d(74788),P=d(62842),m=d(36692),ut=d(87623),k=d(20986),mt=d(23738),nt=d(34880),at=d(76189),pt=d(82535),Ot=d(66596);function gt(yt,rt){1&yt&&(b.ynx(0),b._uU(1,"Edit anchor"),b.BQk())}function _t(yt,rt){if(1&yt){const bt=b.EpF();b.TgZ(0,"div"),b._uU(1,"URL"),b.qZA(),b.TgZ(2,"tui-toggle",11),b.NdJ("ngModelChange",function(Yt){return b.CHM(bt),b.oxw(2).changePrefix(Yt)}),b.qZA(),b.TgZ(3,"div"),b._uU(4,"Internal link"),b.qZA()}if(2&yt){const bt=b.oxw(2);b.ekj("t-property_inactive",bt.prefixIsHashMode),b.xp6(2),b.Q6J("ngModel",bt.prefixIsHashMode)("singleColor",!0),b.xp6(1),b.ekj("t-property_inactive",!bt.prefixIsHashMode)}}function Lt(yt,rt){if(1&yt&&(b.ynx(0),b._uU(1),b.BQk()),2&yt){const bt=rt.ngIf,Nt=b.oxw(2);b.xp6(1),b.hij(" ",Nt.prefixIsHashMode?bt.anchorExample:bt.urlExample," ")}}function It(yt,rt){if(1&yt){const bt=b.EpF();b.ynx(0),b.TgZ(1,"label",2),b.TgZ(2,"div",3),b.YNc(3,gt,2,0,"ng-container",0),b.YNc(4,_t,5,6,"ng-template",null,4,b.W1O),b.qZA(),b.TgZ(6,"div",5),b.TgZ(7,"div",6),b._uU(8),b.qZA(),b.TgZ(9,"tui-input-inline",7),b.NdJ("ngModelChange",function(Yt){return b.CHM(bt),b.oxw().url=Yt})("input",function(Yt){let S;return b.CHM(bt),b.oxw().onChange(null==(S=Yt.target)?null:S.value)})("keydown.prevent.enter",function(){return b.CHM(bt),b.oxw().onSave()})("keydown.backspace",function(){return b.CHM(bt),b.oxw().onBackspace()}),b.YNc(10,Lt,2,1,"ng-container",8),b.ALo(11,"async"),b.qZA(),b.qZA(),b.qZA(),b.TgZ(12,"tui-svg",9),b.NdJ("click",function(){return b.CHM(bt),b.oxw().onClear()}),b.qZA(),b.TgZ(13,"button",10),b.NdJ("click",function(){return b.CHM(bt),b.oxw().onSave()}),b.qZA(),b.BQk()}if(2&yt){const bt=b.MAs(5),Nt=b.oxw();b.xp6(3),b.Q6J("ngIf",Nt.anchorMode)("ngIfElse",bt),b.xp6(5),b.Oqu(Nt.prefix),b.xp6(1),b.ekj("t-input_filled",Nt.hasUrl),b.Q6J("ngModel",Nt.url),b.xp6(1),b.Q6J("ngIf",b.lcZ(11,9,Nt.texts$)),b.xp6(2),b.ekj("t-cleaner_hidden",!Nt.hasUrl)}}function Dt(yt,rt){if(1&yt){const bt=b.EpF();b.TgZ(0,"a",12),b._uU(1),b.qZA(),b.TgZ(2,"button",13),b.NdJ("click",function(){return b.CHM(bt),b.oxw().onEdit()}),b.qZA(),b.TgZ(3,"button",14),b.NdJ("click",function(){return b.CHM(bt),b.oxw().onRemove()}),b.qZA()}if(2&yt){const bt=b.oxw();b.Q6J("href",bt.href,b.LSH),b.xp6(1),b.AsE(" ",bt.anchorMode?"#":"","",bt.shortUrl," ")}}const z="#",Ct="http://",xt="https://";class At{constructor(rt,bt){this.documentRef=rt,this.texts$=bt,this.isOnlyAnchorMode=this.detectAnchorMode(),this.addLink=new b.vpe,this.removeLink=new b.vpe,this.url=this.getHrefOrAnchorId(),this.edit=!this.url,this.prefix=this.makeDefaultPrefix()}set anchorMode(rt){this.isOnlyAnchorMode=rt,this.prefix=rt?z:this.makeDefaultPrefix()}get anchorMode(){return this.isOnlyAnchorMode}get prefixIsHashMode(){return this.prefix===z}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get shortUrl(){return this.url.length<60?this.url:`${this.url.slice(0,Math.max(0,40))}...${this.url.slice(this.url.length-10)}`}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.getHrefOrAnchorId())}onMouseDown(rt){(0,m.tuiIsElement)(rt.target)&&!rt.target.matches("a, button, input")&&rt.preventDefault()}changePrefix(rt){this.prefix=rt?z:Ct}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix=this.isOnlyAnchorMode?z:Ct)}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange(rt){this.url=this.removePrefix(rt)}onClear(){this.url=""}makeDefaultPrefix(){var rt;const bt=this.getAnchorElement();return bt&&(!bt.getAttribute("href")&&bt.getAttribute("id")||(null===(rt=bt.getAttribute("href"))||void 0===rt?void 0:rt.startsWith(z)))?z:Ct}detectAnchorMode(){const rt=this.getAnchorElement();return!(null==rt?void 0:rt.href)&&!!(null==rt?void 0:rt.getAttribute("id"))}getFocusedParentElement(){var rt,bt;return(null===(bt=null===(rt=this.documentRef.getSelection())||void 0===rt?void 0:rt.focusNode)||void 0===bt?void 0:bt.parentElement)||null}getAnchorElement(){var rt;return(null===(rt=this.getFocusedParentElement())||void 0===rt?void 0:rt.closest("a"))||null}getHrefOrAnchorId(){const rt=this.getAnchorElement();return rt?this.removePrefix(rt.getAttribute("href")||rt.getAttribute("id")||""):this.url}removePrefix(rt){return rt.startsWith(Ct)?(this.prefix=this.isOnlyAnchorMode?z:Ct,rt.replace(Ct,"")):rt.startsWith(xt)?(this.prefix=this.isOnlyAnchorMode?z:xt,rt.replace(xt,"")):rt.startsWith(z)?(this.prefix=z,rt.replace(z,"")):rt}}At.\u0275fac=function(rt){return new(rt||At)(b.Y36(s.K0),b.Y36(P.b$))},At.\u0275cmp=b.Xpm({type:At,selectors:[["tui-edit-link"]],hostBindings:function(rt,bt){1&rt&&b.NdJ("selectionchange",function(){return bt.onSelectionChange()},!1,b.evT)("mousedown",function(Yt){return bt.onMouseDown(Yt)})},inputs:{anchorMode:"anchorMode"},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["view",""],[1,"t-label"],[1,"t-label-properties"],["fullOptions",""],[1,"t-url"],[1,"t-prefix"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","input","keydown.prevent.enter","keydown.backspace"],[4,"ngIf"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["size","m",3,"ngModel","singleColor","ngModelChange"],["tuiLink","","target","_blank",1,"t-link",3,"href"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEditLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconTrashLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"]],template:function(rt,bt){if(1&rt&&(b.YNc(0,It,14,11,"ng-container",0),b.YNc(1,Dt,4,3,"ng-template",null,1,b.W1O)),2&rt){const Nt=b.MAs(2);b.Q6J("ngIf",bt.edit)("ngIfElse",Nt)}},directives:[s.O5,ut.l,k.k,mt.JJ,mt.On,nt.P,at.v,pt.p,Ot.V],pipes:[s.Ov],styles:["[_nghost-%COMP%]{display:flex;height:5rem;align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem}.t-label-properties[_ngcontent-%COMP%]{display:flex;align-items:center;max-width:8.375rem;justify-content:space-between}.t-prefix[_ngcontent-%COMP%], .t-label-properties[_ngcontent-%COMP%]{cursor:pointer}.t-property_inactive[_ngcontent-%COMP%]{opacity:.5}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02);margin-top:.3125rem}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),(0,T.gn)([(0,m.tuiDefaultProp)()],At.prototype,"anchorMode",null)},71115:(Jt,Et,d)=>{d.d(Et,{l:()=>T.l,F:()=>mt});var T=d(45050),s=d(12057),b=d(23738),P=d(36692),m=d(72002),ut=d(753),k=d(74788);let mt=(()=>{class nt{}return nt.\u0275fac=function(pt){return new(pt||nt)},nt.\u0275mod=k.oAB({type:nt}),nt.\u0275inj=k.cJS({imports:[[s.ez,b.u5,P.TuiAutoFocusModule,m.TuiButtonModule,m.TuiSvgModule,m.TuiLinkModule,ut.TuiInputInlineModule,ut.TuiToggleModule,P.TuiLetModule]]}),nt})()},20179:(Jt,Et,d)=>{d.d(Et,{D:()=>ut});var T=d(12057),s=d(74788),b=d(82113),P=d(36692),m=d(72002);let ut=(()=>{class k{constructor(nt,at,pt,Ot,gt,_t){this.elementRef=nt,this.renderer=at,this.sanitizer=pt,this.tuiSanitizer=Ot,this.document=gt,this.editor=_t}set content(nt){this.renderer.setProperty(this.elementRef.nativeElement,"innerHTML",this.tuiSanitizer?this.tuiSanitizer.sanitize(s.q3G.HTML,nt.replace(/colwidth/g,"width")):this.sanitizer.sanitize(s.q3G.HTML,nt))}click(nt){var at,pt;if(this.editor||!(0,P.tuiIsElement)(nt.target))return;const Ot=(null===(pt=null===(at=nt.target)||void 0===at?void 0:at.closest("a"))||void 0===pt?void 0:pt.getAttribute("href"))||"";!Ot.startsWith("#")||(this.document.location.hash=Ot.replace("#",""),nt.preventDefault())}}return k.\u0275fac=function(nt){return new(nt||k)(s.Y36(s.SBq),s.Y36(s.Qsj),s.Y36(s.Tiy),s.Y36(m.TUI_SANITIZER,8),s.Y36(T.K0),s.Y36(b.JU,8))},k.\u0275cmp=s.Xpm({type:k,selectors:[["tui-editor-socket"]],hostAttrs:[1,"tui-editor-socket"],hostBindings:function(nt,at){1&nt&&s.NdJ("click",function(Ot){return at.click(Ot)})},inputs:{content:"content"},decls:0,vars:0,template:function(nt,at){},styles:['.tui-editor-socket{display:block;margin:0;overflow:hidden;color:var(--tui-text-01);font:var(--tui-font-text-m)}.tui-editor-socket._preview-image img{cursor:pointer}.tui-editor-socket h1,.tui-editor-socket h2,.tui-editor-socket h3,.tui-editor-socket h4,.tui-editor-socket h5,.tui-editor-socket h6{word-break:break-word;line-height:normal}.tui-editor-socket a:not([data-type="jump-anchor"]){color:var(--tui-link);text-decoration:none;outline:none}.tui-editor-socket a:not([data-type="jump-anchor"]):hover{color:var(--tui-link-hover);text-decoration:underline}.tui-editor-socket a:not([data-type="jump-anchor"]):active{color:var(--tui-primary-active)}.tui-editor-socket .ProseMirror a[data-type=jump-anchor]{text-decoration:underline;-webkit-text-decoration-color:var(--tui-link);text-decoration-color:var(--tui-link)}.tui-editor-socket .ProseMirror a[data-type=jump-anchor]:before{content:"#"}.tui-editor-socket .ProseMirror a[data-type=jump-anchor]:hover{color:var(--tui-link)}.tui-editor-socket .tableWrapper,.tui-editor-socket .tui-table-wrapper{overflow-x:auto}.tui-editor-socket .ProseMirror{min-height:5.375rem;padding:0 1rem;outline:none;white-space:pre-wrap}.tui-editor-socket p:empty:after{content:" ";white-space:pre}.tui-editor-socket p:first-child{margin-top:0}.tui-editor-socket ul,.tui-editor-socket ol{list-style-type:none;margin:1rem 1rem 1rem 1.5rem;padding:0}.tui-editor-socket li{margin:1rem 0}.tui-editor-socket li p{display:inline-block;margin:0 auto}.tui-editor-socket ul>li:before{content:"";display:inline-block;width:.5rem;height:.5rem;border-radius:100%;margin:.5rem .875rem .0625rem -1.375rem;background-color:var(--tui-primary);vertical-align:top;box-sizing:border-box}.tui-editor-socket li ul>li:before{background:none;border:.125rem solid var(--tui-primary)}.tui-editor-socket li ul>li>ul>li:before{background:var(--tui-primary);border-radius:0;width:.375rem;height:.375rem}.tui-editor-socket ol{counter-reset:counter}.tui-editor-socket ol>li:before{content:counter(counter) ".";width:1.5rem;margin:0 .75rem 0 -1.5rem;counter-increment:counter;color:var(--tui-base-05);vertical-align:top}.tui-editor-socket pre{white-space:pre-wrap;word-break:break-word;border-radius:.25rem;margin:1rem 0;padding:.75rem 1rem;font-family:Courier,monospace;color:var(--tui-text-02);background:var(--tui-base-02)}.tui-editor-socket code{box-shadow:none}.tui-editor-socket pre+pre{margin-top:-1.8125rem;padding-top:0}.tui-editor-socket blockquote{margin:1.25rem 0 1.25rem 1.5rem;padding-left:1.0625rem;border-left:1px solid var(--tui-base-04)}.tui-editor-socket p{margin:1rem 0}.tui-editor-socket hr{border:none;border-top:1px solid var(--tui-base-03);margin:1rem 0}.tui-editor-socket table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.tui-editor-socket table td{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word}.tui-editor-socket table th{position:relative;min-width:1em;height:2rem;border:2px solid var(--tui-base-03);padding:3px 5px;vertical-align:top;box-sizing:border-box;word-break:break-word;font-weight:bold;text-align:left;background-color:var(--tui-base-02);min-height:2rem}.tui-editor-socket table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tui-editor-socket table td>*{margin-top:0;margin-bottom:0}.tui-editor-socket table th>*{margin-top:0;margin-bottom:0}.tui-editor-socket .resize-cursor{cursor:ew-resize;cursor:col-resize}.tui-editor-socket table .tableWrapper{overflow-x:auto}.tui-editor-socket .selectedCell:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:var(--tui-selection);pointer-events:none}.tui-editor-socket font[face="Courier New"]{display:inline-block;padding:.25rem .5rem;border-radius:.25rem;background-color:#ecf1f7;word-break:break-word}.tui-editor-socket details{width:100%;border:1px solid var(--tui-base-04);border-radius:var(--tui-radius-l)}.tui-editor-socket summary{display:flex;align-items:center;min-height:3.5rem;width:100%;padding:0 1.25rem;box-sizing:border-box;border-radius:var(--tui-radius-l);pointer-events:none}.tui-editor-socket summary p{min-width:1px;margin:0}.tui-editor-socket summary::-webkit-details-marker{display:none}.tui-editor-socket details[open] summary{border-radius:var(--tui-radius-l) var(--tui-radius-l) 0 0}.tui-editor-socket div[data-type=details-content]{padding:1.25rem;min-height:3rem;border:1px solid var(--tui-base-04);border-width:1px 0 0}.tui-editor-socket .details-wrapper{position:relative;display:flex}.tui-editor-socket .details-arrow{position:absolute;top:1.5rem;right:1.25rem;height:.575rem;width:.575rem;border:1px solid var(--tui-base-06);border-width:0 2px 2px 0;transform:rotate(45deg);transition:var(--tui-duration, .3s);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;padding:0;background:none;cursor:pointer}.tui-editor-socket .details-wrapper_rendered .details-arrow{pointer-events:none}.tui-editor-socket .details-wrapper_rendered summary{transition:transform var(--tui-duration, .3s);cursor:pointer;pointer-events:auto}.tui-editor-socket .details-wrapper_rendered summary:hover{background:var(--tui-base-02)}.tui-editor-socket details[open]+.details-arrow{top:1.75rem;transform:rotate(225deg)}.t-editor-placeholder:before{content:attr(data-placeholder);float:left;color:var(--tui-base-05);pointer-events:none;height:0}.tui-group-node{display:flex;flex-direction:row}.tui-group-node:hover>.tui-group-pointer{pointer-events:auto;opacity:1}.tui-group-pointer{opacity:0;min-height:.8125rem;max-height:.8125rem;min-width:.8125rem;max-width:.8125rem;margin:.3125rem .3125rem 0 0;cursor:-webkit-grab;cursor:grab;background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="black" /></svg>\');background-repeat:no-repeat;background-size:contain;background-position:center}[data-mode=onDark] .tui-group-pointer{background-image:url(\'data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 14c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM2 6C.9 6 0 6.9 0 8s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6C.9 0 0 .9 0 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-opacity="0.2" fill="white" /></svg>\')}\n'],encapsulation:2,changeDetection:0}),k})()},69303:(Jt,Et,d)=>{d.d(Et,{a:()=>Mt});var T=d(64762),s=d(12057),b=d(74788),P=d(23738),m=d(17406),ut=d(19074),k=d(84614),mt=d(62842),nt=d(37631),at=d(36692),pt=d(79089),Ot=d(40939),gt=d(2697),_t=d(17163),Lt=d(3881),It=d(1433),Dt=d(9872),ht=d(4997),X=d(33250),ct=d(26072),z=d(9829),Ct=d(82886),xt=d(39088),At=d(20179),yt=d(74982),rt=d(45050);function bt(F,K){if(1&F&&(b.TgZ(0,"tui-toolbar",9),b.Hsn(1,1),b.qZA()),2&F){const dt=b.oxw(2);b.Q6J("tools",dt.tools)("disabled",!dt.interactive)}}function Nt(F,K){if(1&F&&(b.TgZ(0,"div",10),b._uU(1),b.qZA()),2&F){const dt=b.oxw(2);b.xp6(1),b.hij(" ",dt.exampleText," ")}}function Yt(F,K){if(1&F){const dt=b.EpF();b.TgZ(0,"div",11),b.TgZ(1,"tui-editor-socket",12),b.NdJ("valueChange",function($t){return b.CHM(dt),b.oxw(2).onModelChange($t)})("stateChange",function(){return 0}),b.qZA(),b.qZA()}if(2&F){b.oxw();const dt=b.MAs(9),Bt=b.oxw();b.Q6J("tuiDropdownSelection",Bt.dropdownSelectionHandler)("tuiDropdown",dt),b.xp6(1),b.Q6J("value",Bt.value)("editable",Bt.interactive)}}function ft(F,K){if(1&F){const dt=b.EpF();b.TgZ(0,"tui-edit-link",13,14),b.NdJ("addLink",function($t){b.CHM(dt);const qt=b.MAs(1),ae=b.oxw(2);return qt.anchorMode?ae.addAnchor($t):ae.addLink($t)})("removeLink",function(){b.CHM(dt);const $t=b.MAs(1),qt=b.oxw(2);return $t.anchorMode?qt.removeAnchor():qt.removeLink()}),b.qZA()}}function S(F,K){if(1&F){const dt=b.EpF();b.TgZ(0,"div",1),b.NdJ("tuiActiveZoneChange",function($t){return b.CHM(dt),b.oxw().onActiveZone($t)}),b.TgZ(1,"div",2),b.YNc(2,bt,2,2,"tui-toolbar",3),b.TgZ(3,"div",4),b.Hsn(4),b.qZA(),b.YNc(5,Nt,2,1,"div",5),b.qZA(),b.TgZ(6,"tui-scrollbar",6),b.YNc(7,Yt,2,4,"div",7),b.YNc(8,ft,2,0,"ng-template",null,8,b.W1O),b._UZ(10,"tui-editor-portal-host"),b.qZA(),b.qZA()}if(2&F){const dt=K.tuiLet,Bt=b.oxw();b.Q6J("readOnly",Bt.readOnly)("disabled",Bt.disabled)("focus",Bt.computedFocused)("hover",Bt.pseudoHover)("invalid",Bt.computedInvalid),b.xp6(2),b.Q6J("ngIf",dt),b.xp6(1),b.ekj("t-placeholder_raised",Bt.placeholderRaised),b.xp6(2),b.Q6J("ngIf",Bt.hasExampleText),b.xp6(2),b.Q6J("ngIf",dt)}}const et=["*",[["tools"]]];class Mt extends at.AbstractTuiControl{constructor(K,dt,Bt,$t,qt,ae){super(K,dt),this.editorLoaded$=Bt,this.editorService=$t,this.contentProcessor=qt,this.documentRef=ae,this.exampleText="",this.tools=ut.Db,this.focused=!1,this.isSelectionLink=le=>this.currentFocusedNodeIsAnchor(le)&&(0,nt.nC)(le)}get nativeFocusableElement(){var K;return this.computedDisabled?null:(null===(K=this.element)||void 0===K?void 0:K.nativeElement)||null}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:at.ALWAYS_FALSE_HANDLER}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}writeValue(K){var dt;const Bt=this.contentProcessor(K||"");super.writeValue(Bt),Bt!==K&&(null===(dt=this.control)||void 0===dt||dt.setValue(Bt))}onActiveZone(K){this.focused=K,this.updateFocused(K)}onModelChange(K){this.updateValue(K)}addAnchor(K){var dt;null===(dt=this.editor)||void 0===dt||dt.setAnchor(K)}removeAnchor(){var K;null===(K=this.editor)||void 0===K||K.removeAnchor()}addLink(K){var dt,Bt;null===(dt=this.editor)||void 0===dt||dt.selectClosest(),null===(Bt=this.editor)||void 0===Bt||Bt.setLink(K)}removeLink(){var K;null===(K=this.editor)||void 0===K||K.unsetLink()}ngOnDestroy(){var K;null===(K=this.editor)||void 0===K||K.destroy()}getFallbackValue(){return""}currentFocusedNodeIsAnchor(K){var dt,Bt,$t;return!!(null===(Bt=null===(dt=K.startContainer.parentElement)||void 0===dt?void 0:dt.closest("a"))||void 0===Bt?void 0:Bt.contains((null===($t=this.documentRef.getSelection())||void 0===$t?void 0:$t.focusNode)||null))}get hasValue(){return!!this.value}}Mt.\u0275fac=function(K){return new(K||Mt)(b.Y36(P.a5,10),b.Y36(b.sBO),b.Y36(mt.ZW),b.Y36(k.$3),b.Y36(mt.F1),b.Y36(s.K0))},Mt.\u0275cmp=b.Xpm({type:Mt,selectors:[["tui-editor"]],viewQuery:function(K,dt){if(1&K&&(b.Gf(k.JU,5,b.SBq),b.Gf(m.M6,5)),2&K){let Bt;b.iGM(Bt=b.CRH())&&(dt.element=Bt.first),b.iGM(Bt=b.CRH())&&(dt.toolbar=Bt.first)}},inputs:{exampleText:"exampleText",tools:"tools"},features:[b._Bn([(0,at.tuiAsFocusableItemAccessor)(Mt),pt.m]),b.qOj],ngContentSelectors:["*","tools"],decls:2,vars:3,consts:[["tuiWrapper","","appearance","textfield","class","t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange",4,"tuiLet"],["tuiWrapper","","appearance","textfield",1,"t-wrapper",3,"readOnly","disabled","focus","hover","invalid","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],[3,"tools","disabled",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","",1,"t-scrollbar"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown",4,"ngIf"],["dropdown",""],[3,"tools","disabled"],[1,"t-example-text"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdown"],["tuiTiptapEditor","","spellcheck","false",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange"],[3,"addLink","removeLink"],["link",""]],template:function(K,dt){1&K&&(b.F$t(et),b.YNc(0,S,11,10,"div",0),b.ALo(1,"async")),2&K&&b.Q6J("tuiLet",b.lcZ(1,1,dt.editorLoaded$))},directives:[Ot.L,gt.o,_t.e,s.O5,Lt.I,It.A,Dt.d,ht.M,X.Ek,ct.t,z.V,Ct.A,xt.y,At.D,yt.J,rt.l],pipes:[s.Ov],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m);border-radius:var(--tui-radius-m)}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:10rem;cursor:text;overflow:hidden;flex-direction:column;border-radius:inherit}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);position:absolute;left:1rem;margin-top:1rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem)}[data-size=m][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}[data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], [data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size=l][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font-size:.9375rem}[data-size=l][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size=m]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[data-mode=onDark][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size=m][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=m][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size=l][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens: none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-placeholder_raised[_ngcontent-%COMP%]{width:110%}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;max-height:inherit;border-top:1.625rem solid transparent;border-bottom:1px solid transparent;box-sizing:border-box}"],changeDetection:0}),(0,T.gn)([(0,at.tuiDefaultProp)()],Mt.prototype,"exampleText",void 0),(0,T.gn)([(0,at.tuiDefaultProp)()],Mt.prototype,"tools",void 0)},79089:(Jt,Et,d)=>{d.d(Et,{m:()=>at});var T=d(74788),s=d(84614),b=d(62842),P=d(82298),m=d(9112),ut=d(15257),k=d(88002),mt=d(47349),nt=d(73825);const at=[{provide:b.F4,deps:[b.Wf],useFactory:pt=>{const Ot=new P.t(1);return Promise.all(pt).then(gt=>Ot.next(gt)),Ot}},{provide:b.Y1,deps:[T.Qsj],useFactory:pt=>pt.createElement("div")},{provide:b.ZW,deps:[b.Y1,b.F4,b.bG],useFactory:(pt,Ot,gt)=>(0,m.aj)([gt,Ot]).pipe((0,ut.q)(1),(0,k.U)(([_t,Lt])=>new _t({element:pt,extensions:Lt})),(0,mt.d)({bufferSize:1,refCount:!0}))},s.$3,nt.Y]},9872:(Jt,Et,d)=>{d.d(Et,{d:()=>b});var T=d(36692),s=d(74788);let b=(()=>{class P extends T.AbstractTuiPortalHostComponent{}return P.\u0275fac=function(){let m;return function(k){return(m||(m=s.n5z(P)))(k||P)}}(),P.\u0275cmp=s.Xpm({type:P,selectors:[["tui-editor-portal-host"]],features:[s._Bn([{provide:T.AbstractTuiPortalService,useExisting:T.TuiDropdownPortalService},{provide:T.AbstractTuiPortalHostComponent,useExisting:P}]),s.qOj],decls:2,vars:0,consts:[["viewContainer",""]],template:function(ut,k){1&ut&&s.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),P})()},1433:(Jt,Et,d)=>{d.d(Et,{A:()=>P});var T=d(36692),s=d(73825),b=d(74788);let P=(()=>{class m{}return m.\u0275fac=function(k){return new(k||m)},m.\u0275dir=b.lG2({type:m,selectors:[["","tuiEditorPortal",""]],features:[b._Bn([{provide:T.TuiDropdownPortalService,useExisting:s.Y}])]}),m})()},73825:(Jt,Et,d)=>{d.d(Et,{Y:()=>b});var T=d(36692),s=d(74788);let b=(()=>{class P extends T.AbstractTuiPortalService{}return P.\u0275fac=function(){let m;return function(k){return(m||(m=s.n5z(P)))(k||P)}}(),P.\u0275prov=s.Yz7({token:P,factory:P.\u0275fac}),P})()},19769:(Jt,Et,d)=>{d.d(Et,{j:()=>Dt});var T=d(64762),s=d(74788),b=d(23738),P=d(91211),m=d(37631),ut=d(36692),k=d(72002),mt=d(62939),nt=d(63060),at=d(62733),pt=d(3729),Ot=d(23999),gt=d(17163);function _t(ht,X){if(1&ht&&s._UZ(0,"div",4),2&ht){const ct=s.oxw();s.Udp("background",ct.background)}}function Lt(ht,X){if(1&ht){const ct=s.EpF();s.TgZ(0,"tui-color-selector",5),s.NdJ("colorChange",function(Ct){return s.CHM(ct),s.oxw().onValueChange(Ct)}),s.qZA()}if(2&ht){const ct=X.$implicit,z=s.oxw();s.Q6J("tuiActiveZoneParent",ct)("colors",z.colors)("color",z.value)}}class Dt extends ut.AbstractTuiControl{constructor(X,ct,z){super(X,ct),this.domSanitizer=z,this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onValueChange(X){this.updateValue(X)}onFocused(X){this.updateFocused(X)}getFallbackValue(){return"#000000"}sanitize(X,ct){return X.startsWith("linear-gradient(")?ct.bypassSecurityTrustStyle((0,m.CH)((0,m._N)((0,m.U5)(X)))):X}}Dt.\u0275fac=function(X){return new(X||Dt)(s.Y36(b.a5,10),s.Y36(s.sBO),s.Y36(P.H7))},Dt.\u0275cmp=s.Xpm({type:Dt,selectors:[["tui-input-color"]],viewQuery:function(X,ct){if(1&X&&(s.Gf(k.TuiPrimitiveTextfieldComponent,5),s.Gf(k.TuiHostedDropdownComponent,5)),2&X){let z;s.iGM(z=s.CRH())&&(ct.textfield=z.first),s.iGM(z=s.CRH())&&(ct.dropdown=z.first)}},hostBindings:function(X,ct){1&X&&s.NdJ("click",function(){return ct.onClick()})},inputs:{colors:"colors"},features:[s._Bn([],[(0,k.tuiDropdownOptionsProvider)({maxHeight:600})]),s.qOj],ngContentSelectors:["*"],decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"tuiTextfieldIconLeft","pseudoFocus","pseudoHover","pseudoActive","invalid","focusable","nativeId","disabled","readOnly","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"tuiActiveZoneParent","colors","color","colorChange"]],template:function(X,ct){if(1&X&&(s.F$t(),s.TgZ(0,"tui-hosted-dropdown",0),s.NdJ("openChange",function(Ct){return ct.open=Ct}),s.TgZ(1,"tui-primitive-textfield",1),s.NdJ("valueChange",function(Ct){return ct.onValueChange(Ct)})("focusedChange",function(Ct){return ct.onFocused(Ct)}),s.Hsn(2),s.qZA(),s.qZA(),s.YNc(3,_t,1,2,"ng-template",null,2,s.W1O),s.YNc(5,Lt,1,3,"ng-template",null,3,s.W1O)),2&X){const z=s.MAs(4),Ct=s.MAs(6);s.Q6J("content",Ct)("open",ct.open),s.xp6(1),s.Q6J("tuiTextfieldIconLeft",z)("pseudoFocus",ct.computedFocused)("pseudoHover",ct.pseudoHover)("pseudoActive",ct.pseudoActive)("invalid",ct.computedInvalid)("focusable",ct.focusable)("nativeId",ct.nativeId)("disabled",ct.disabled)("readOnly",ct.readOnly)("value",ct.value)}},directives:[mt.o,nt.y,at.B,pt.aR,Ot.s,gt.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem}"],changeDetection:0}),(0,T.gn)([(0,ut.tuiDefaultProp)()],Dt.prototype,"colors",void 0),(0,T.gn)([ut.tuiPure],Dt.prototype,"sanitize",null)},37924:(Jt,Et,d)=>{d.d(Et,{X:()=>ht});var T=d(84614),s=d(62842),b=d(9112),P=d(88002),m=d(74788),ut=d(12057),k=d(40939),mt=d(62939),nt=d(76189),at=d(67446),pt=d(29070),Ot=d(54255),gt=d(15491),_t=d(219);function Lt(X,ct){if(1&X){const z=m.EpF();m.TgZ(0,"div",6),m.TgZ(1,"button",7),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).editor.onAlign("left")}),m.qZA(),m.TgZ(2,"button",8),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).editor.onAlign("center")}),m.qZA(),m.TgZ(3,"button",9),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).editor.onAlign("right")}),m.qZA(),m.TgZ(4,"button",10),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).editor.onAlign("justify")}),m.qZA(),m.qZA()}if(2&X){const z=m.oxw().tuiLet,Ct=m.oxw().ngIf;m.xp6(1),m.Q6J("pseudoActive",!(null==z||!z.left))("tuiHint",Ct.justifyLeft),m.xp6(1),m.Q6J("pseudoActive",!(null==z||!z.center))("tuiHint",Ct.justifyCenter),m.xp6(1),m.Q6J("pseudoActive",!(null==z||!z.right))("tuiHint",Ct.justifyRight),m.xp6(1),m.Q6J("pseudoActive",!(null==z||!z.justify))("tuiHint",Ct.justifyFull)}}function It(X,ct){if(1&X&&(m.TgZ(0,"tui-hosted-dropdown",2,3),m._UZ(2,"button",4),m.YNc(3,Lt,5,8,"ng-template",null,5,m.W1O),m.qZA()),2&X){const z=m.MAs(1),Ct=m.MAs(4),xt=m.oxw().ngIf;m.Q6J("content",Ct),m.xp6(2),m.Q6J("tuiHint",xt.justify)("tuiHintDescribe","")("pseudoActive",z.open)("focusable",z.open)}}function Dt(X,ct){if(1&X&&(m.ynx(0),m.YNc(1,It,5,5,"tui-hosted-dropdown",1),m.ALo(2,"async"),m.BQk()),2&X){const z=m.oxw();m.xp6(1),m.Q6J("tuiLet",m.lcZ(2,1,z.alignState$))}}let ht=(()=>{class X{constructor(z,Ct){this.editor=z,this.texts$=Ct,this.alignState$=(0,b.aj)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,P.U)(([xt,At,yt,rt])=>({left:xt,right:At,center:yt,justify:rt})))}}return X.\u0275fac=function(z){return new(z||X)(m.Y36(T.$3),m.Y36(s.rf))},X.\u0275cmp=m.Xpm({type:X,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoActive","tuiHint","click"]],template:function(z,Ct){1&z&&(m.YNc(0,Dt,3,3,"ng-container",0),m.ALo(1,"async")),2&z&&m.Q6J("ngIf",m.lcZ(1,1,Ct.texts$))},directives:[ut.O5,k.L,mt.o,nt.v,at.D,pt.x,Ot.t,gt.D,_t.$],pipes:[ut.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),X})()},15587:(Jt,Et,d)=>{d.d(Et,{T:()=>ht});var T=d(84614),s=d(62842),b=d(88002),P=d(87519),m=d(74788),ut=d(62939),k=d(76189),mt=d(67446),nt=d(29070),at=d(54255),pt=d(15491),Ot=d(219),gt=d(20933),_t=d(12057),Lt=d(35065);function It(X,ct){if(1&X){const z=m.EpF();m.TgZ(0,"button",5),m.NdJ("click",function(){const At=m.CHM(z).index;return m.oxw(2).onCode(!!At)}),m._uU(1),m.qZA()}if(2&X){const z=ct.$implicit;m.xp6(1),m.hij(" ",z," ")}}function Dt(X,ct){if(1&X&&(m.TgZ(0,"tui-data-list"),m.YNc(1,It,2,1,"button",4),m.ALo(2,"async"),m.qZA()),2&X){const z=m.oxw();m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,1,z.codeOptionsTexts$))}}let ht=(()=>{class X{constructor(z,Ct,xt){this.editor=z,this.texts$=Ct,this.codeOptionsTexts$=xt,this.hintText$=this.texts$.pipe((0,b.U)(At=>At.code)),this.insideCode$=this.editor.stateChange$.pipe((0,b.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,P.x)())}onCode(z){z?this.editor.toggleCodeBlock():this.editor.toggleCode()}}return X.\u0275fac=function(z){return new(z||X)(m.Y36(T.$3),m.Y36(s.rf),m.Y36(s.Mr))},X.\u0275cmp=m.Xpm({type:X,selectors:[["tui-code"]],decls:7,vars:9,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(z,Ct){if(1&z&&(m.TgZ(0,"tui-hosted-dropdown",0,1),m._UZ(2,"button",2),m.ALo(3,"async"),m.ALo(4,"async"),m.YNc(5,Dt,3,3,"ng-template",null,3,m.W1O),m.qZA()),2&z){const xt=m.MAs(1),At=m.MAs(6);m.Q6J("content",At),m.xp6(2),m.Q6J("tuiHint",m.lcZ(3,5,Ct.hintText$))("tuiHintDescribe","")("pseudoActive",xt.open||m.lcZ(4,7,Ct.insideCode$))("focusable",xt.open)}},directives:[ut.o,k.v,mt.D,nt.x,at.t,pt.D,Ot.$,gt.q,_t.sg,Lt.v],pipes:[_t.Ov],encapsulation:2,changeDetection:0}),X})()},18832:(Jt,Et,d)=>{d.d(Et,{U:()=>_t});var T=d(84614),s=d(62842),b=d(88002),P=d(87519),m=d(74788),ut=d(12057),k=d(76189),mt=d(67446),nt=d(29070),at=d(54255),pt=d(15491),Ot=d(219);function gt(Lt,It){if(1&Lt){const Dt=m.EpF();m.TgZ(0,"button",1),m.NdJ("click",function(){return m.CHM(Dt),m.oxw().removeDetails()}),m.ALo(1,"async"),m.qZA()}if(2&Lt){const Dt=It.ngIf,ht=m.oxw();m.Q6J("tuiHint",Dt.removeDetails)("tuiHintDescribe","")("focusable",!1)("disabled",!!m.lcZ(1,4,ht.disabled$))}}let _t=(()=>{class Lt{constructor(Dt,ht){this.editor=Dt,this.texts$=ht,this.disabled$=this.editor.stateChange$.pipe((0,b.U)(()=>!this.editor.isActive("details")),(0,P.x)())}removeDetails(){this.editor.removeDetails()}}return Lt.\u0275fac=function(Dt){return new(Dt||Lt)(m.Y36(T.$3),m.Y36(s.rf))},Lt.\u0275cmp=m.Xpm({type:Lt,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(Dt,ht){1&Dt&&(m.YNc(0,gt,2,6,"button",0),m.ALo(1,"async")),2&Dt&&m.Q6J("ngIf",m.lcZ(1,1,ht.texts$))},directives:[ut.O5,k.v,mt.D,nt.x,at.t,pt.D,Ot.$],pipes:[ut.Ov],encapsulation:2,changeDetection:0}),Lt})()},50237:(Jt,Et,d)=>{d.d(Et,{y:()=>Ot});var T=d(84614),s=d(62842),b=d(74788),P=d(12057),m=d(76189),ut=d(67446),k=d(29070),mt=d(54255),nt=d(15491),at=d(219);function pt(gt,_t){if(1&gt){const Lt=b.EpF();b.TgZ(0,"button",1),b.NdJ("click",function(){return b.CHM(Lt),b.oxw().setDetails()}),b.qZA()}2&gt&&b.Q6J("tuiHint",_t.ngIf.setDetails)("tuiHintDescribe","")("focusable",!1)}let Ot=(()=>{class gt{constructor(Lt,It){this.editor=Lt,this.texts$=It}setDetails(){this.editor.setDetails()}}return gt.\u0275fac=function(Lt){return new(Lt||gt)(b.Y36(T.$3),b.Y36(s.rf))},gt.\u0275cmp=b.Xpm({type:gt,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","click"]],template:function(Lt,It){1&Lt&&(b.YNc(0,pt,1,3,"button",0),b.ALo(1,"async")),2&Lt&&b.Q6J("ngIf",b.lcZ(1,1,It.texts$))},directives:[P.O5,m.v,ut.D,k.x,mt.t,nt.D,at.$],pipes:[P.Ov],encapsulation:2,changeDetection:0}),gt})()},84985:(Jt,Et,d)=>{d.d(Et,{m:()=>ht});var T=d(84614),s=d(62842),b=d(36692),P=d(88002),m=d(74788),ut=d(62939),k=d(76189),mt=d(67446),nt=d(29070),at=d(54255),pt=d(15491),Ot=d(219),gt=d(20933),_t=d(12057),Lt=d(35065);function It(X,ct){if(1&X){const z=m.EpF();m.TgZ(0,"button",5),m.NdJ("click",function(){const At=m.CHM(z).$implicit;return m.oxw(2).onClick(At)}),m.ALo(1,"lowercase"),m._uU(2),m.qZA()}if(2&X){const z=ct.$implicit;m.Udp("font-family",z.family)("font-size",z.px,"px")("font-weight",z.weight),m.uIk("automation-id","tui_font__"+m.lcZ(1,8,z.name||"")),m.xp6(2),m.hij(" ",z.name," ")}}function Dt(X,ct){if(1&X&&(m.TgZ(0,"tui-data-list"),m.YNc(1,It,3,10,"button",4),m.ALo(2,"async"),m.qZA()),2&X){const z=m.oxw();m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,1,z.fontsOptions$))}}let ht=(()=>{class X{constructor(z,Ct,xt,At){this.options=z,this.editor=Ct,this.texts$=xt,this.fontOptionsTexts$=At,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,P.U)(yt=>this.options.fontOptions(yt))),this.fontText$=this.texts$.pipe((0,P.U)(yt=>yt.font))}onClick({headingLevel:z,px:Ct}){z?this.editor.setHeading(z):this.editor.setParagraph({fontSize:(0,b.tuiPx)(Ct||0)})}}return X.\u0275fac=function(z){return new(z||X)(m.Y36(s.mJ),m.Y36(T.$3),m.Y36(s.rf),m.Y36(s.UN))},X.\u0275cmp=m.Xpm({type:X,selectors:[["tui-font-size"]],decls:6,vars:7,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(z,Ct){if(1&z&&(m.TgZ(0,"tui-hosted-dropdown",0,1),m._UZ(2,"button",2),m.ALo(3,"async"),m.YNc(4,Dt,3,3,"ng-template",null,3,m.W1O),m.qZA()),2&z){const xt=m.MAs(1),At=m.MAs(5);m.Q6J("content",At),m.xp6(2),m.Q6J("tuiHint",m.lcZ(3,5,Ct.fontText$))("tuiHintDescribe","")("pseudoActive",xt.open)("focusable",xt.open)}},directives:[ut.o,k.v,mt.D,nt.x,at.t,pt.D,Ot.$,gt.q,_t.sg,Lt.v],pipes:[_t.Ov,_t.i8],encapsulation:2,changeDetection:0}),X})()},62976:(Jt,Et,d)=>{d.d(Et,{h:()=>xt});var T=d(19074),s=d(84614),b=d(48699),P=d(62842),m=d(9112),ut=d(88002),k=d(74788),mt=d(12057),nt=d(62939),at=d(76189),pt=d(67446),Ot=d(29070),gt=d(54255),_t=d(15491),Lt=d(219);function It(At,yt){if(1&At){const rt=k.EpF();k.TgZ(0,"button",11),k.NdJ("click",function(){return k.CHM(rt),k.oxw(4).editor.toggleBold()}),k.qZA()}if(2&At){const rt=k.oxw(2).ngIf,bt=k.oxw().ngIf;k.Q6J("tuiHint",bt.bold)("pseudoActive",rt.bold)}}function Dt(At,yt){if(1&At){const rt=k.EpF();k.TgZ(0,"button",12),k.NdJ("click",function(){return k.CHM(rt),k.oxw(4).editor.toggleItalic()}),k.qZA()}if(2&At){const rt=k.oxw(2).ngIf,bt=k.oxw().ngIf;k.Q6J("tuiHint",bt.italic)("pseudoActive",rt.italic)}}function ht(At,yt){if(1&At){const rt=k.EpF();k.TgZ(0,"button",13),k.NdJ("click",function(){return k.CHM(rt),k.oxw(4).editor.toggleUnderline()}),k.qZA()}if(2&At){const rt=k.oxw(2).ngIf,bt=k.oxw().ngIf;k.Q6J("tuiHint",bt.underline)("pseudoActive",rt.underline)}}function X(At,yt){if(1&At){const rt=k.EpF();k.TgZ(0,"button",14),k.NdJ("click",function(){return k.CHM(rt),k.oxw(4).editor.toggleStrike()}),k.qZA()}if(2&At){const rt=k.oxw(2).ngIf,bt=k.oxw().ngIf;k.Q6J("tuiHint",bt.strikeThrough)("pseudoActive",rt.strike)}}function ct(At,yt){if(1&At&&(k.TgZ(0,"div",6),k.YNc(1,It,1,2,"button",7),k.YNc(2,Dt,1,2,"button",8),k.YNc(3,ht,1,2,"button",9),k.YNc(4,X,1,2,"button",10),k.qZA()),2&At){const rt=k.oxw(3);k.xp6(1),k.Q6J("ngIf",rt.isEnabled(rt.TuiEditorTool.Bold)),k.xp6(1),k.Q6J("ngIf",rt.isEnabled(rt.TuiEditorTool.Italic)),k.xp6(1),k.Q6J("ngIf",rt.isEnabled(rt.TuiEditorTool.Underline)),k.xp6(1),k.Q6J("ngIf",rt.isEnabled(rt.TuiEditorTool.Strikethrough))}}function z(At,yt){if(1&At&&(k.TgZ(0,"tui-hosted-dropdown",2,3),k._UZ(2,"button",4),k.YNc(3,ct,5,4,"ng-template",null,5,k.W1O),k.qZA()),2&At){const rt=yt.ngIf,bt=k.MAs(1),Nt=k.MAs(4),Yt=k.oxw().ngIf;k.Q6J("content",Nt),k.xp6(2),k.Q6J("tuiHint",Yt.fontStyle)("tuiHintDescribe","")("pseudoActive",bt.open||rt.bold||rt.italic||rt.underline||rt.strike)("focusable",bt.open)}}function Ct(At,yt){if(1&At&&(k.ynx(0),k.YNc(1,z,5,5,"tui-hosted-dropdown",1),k.ALo(2,"async"),k.BQk()),2&At){const rt=k.oxw();k.xp6(1),k.Q6J("ngIf",k.lcZ(2,1,rt.fontStyleState$))}}let xt=(()=>{class At{constructor(rt,bt){this.editor=rt,this.texts$=bt,this.toolsSet=new Set(T.Db),this.TuiEditorTool=b._,this.fontStyleState$=(0,m.aj)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,ut.U)(([Nt,Yt,ft,S])=>({bold:Nt,italic:Yt,underline:ft,strike:S})))}set enabledTools(rt){this.toolsSet=new Set(rt)}isEnabled(rt){return this.toolsSet.has(rt)}}return At.\u0275fac=function(rt){return new(rt||At)(k.Y36(s.$3),k.Y36(P.rf))},At.\u0275cmp=k.Xpm({type:At,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoActive","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"]],template:function(rt,bt){1&rt&&(k.YNc(0,Ct,3,3,"ng-container",0),k.ALo(1,"async")),2&rt&&k.Q6J("ngIf",k.lcZ(1,1,bt.texts$))},directives:[mt.O5,nt.o,at.v,pt.D,Ot.x,gt.t,_t.D,Lt.$],pipes:[mt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),At})()},19762:(Jt,Et,d)=>{d.d(Et,{d:()=>gt});var T=d(84614),s=d(62842),b=d(88002),P=d(87519),m=d(74788),ut=d(76189),k=d(67446),mt=d(29070),nt=d(54255),at=d(15491),pt=d(219),Ot=d(12057);let gt=(()=>{class _t{constructor(It,Dt){this.editor=It,this.texts$=Dt,this.insertGroupText$=this.texts$.pipe((0,b.U)(ht=>ht.insertGroup)),this.removeGroupText$=this.texts$.pipe((0,b.U)(ht=>ht.removeGroup)),this.disabled$=this.editor.stateChange$.pipe((0,b.U)(()=>!this.editor.isActive("group")),(0,P.x)())}addGroup(){this.editor.setGroup()}removeGroup(){this.editor.removeGroup()}}return _t.\u0275fac=function(It){return new(It||_t)(m.Y36(T.$3),m.Y36(s.rf))},_t.\u0275cmp=m.Xpm({type:_t,selectors:[["tui-editor-group-tool"]],decls:5,vars:13,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconPlusLarge","appearance","icon",3,"focusable","tuiHint","tuiHintDescribe","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconRemoveLarge","appearance","icon",3,"focusable","disabled","tuiHint","tuiHintDescribe","click"]],template:function(It,Dt){1&It&&(m.TgZ(0,"button",0),m.NdJ("click",function(){return Dt.addGroup()}),m.ALo(1,"async"),m.qZA(),m.TgZ(2,"button",1),m.NdJ("click",function(){return Dt.removeGroup()}),m.ALo(3,"async"),m.ALo(4,"async"),m.qZA()),2&It&&(m.Q6J("focusable",!1)("tuiHint",m.lcZ(1,7,Dt.insertGroupText$))("tuiHintDescribe",""),m.xp6(2),m.Q6J("focusable",!1)("disabled",!!m.lcZ(3,9,Dt.disabled$))("tuiHint",m.lcZ(4,11,Dt.removeGroupText$))("tuiHintDescribe",""))},directives:[ut.v,k.D,mt.x,nt.t,at.D,pt.$],pipes:[Ot.Ov],encapsulation:2,changeDetection:0}),_t})()},7416:(Jt,Et,d)=>{d.d(Et,{U:()=>xt});var T=d(64762),s=d(84614),b=d(62842),P=d(36692),m=d(88002),ut=d(87519),k=d(74788),mt=d(40939),nt=d(62939),at=d(33250),pt=d(76189),Ot=d(67446),gt=d(29070),_t=d(54255),Lt=d(15491),It=d(219),Dt=d(12057),ht=d(5451),X=d(17163);function ct(At,yt){if(1&At&&k._UZ(0,"div",6),2&At){const rt=k.oxw().tuiLet;k.Udp("background",rt)}}function z(At,yt){if(1&At){const rt=k.EpF();k.TgZ(0,"tui-palette",7),k.NdJ("selectedColor",function(Nt){return k.CHM(rt),k.oxw(2).editor.setBackgroundColor(Nt)}),k.qZA()}if(2&At){const rt=yt.$implicit,bt=k.oxw(2);k.Q6J("tuiActiveZoneParent",rt)("colors",bt.colors)}}function Ct(At,yt){if(1&At&&(k.TgZ(0,"tui-hosted-dropdown",1,2),k._UZ(2,"button",3),k.ALo(3,"async"),k.YNc(4,ct,1,2,"div",4),k.YNc(5,z,1,2,"ng-template",null,5,k.W1O),k.qZA()),2&At){const rt=yt.tuiLet,bt=k.MAs(1),Nt=k.MAs(6),Yt=k.oxw();k.Q6J("content",Nt)("tuiDropdownMaxHeight",999),k.xp6(2),k.Q6J("tuiHint",k.lcZ(3,7,Yt.backColorText$))("tuiHintDescribe","")("pseudoActive",bt.open)("focusable",bt.open),k.xp6(2),k.Q6J("ngIf",!Yt.isBlankColor(rt||""))}}class xt{constructor(yt,rt,bt){this.editor=yt,this.texts$=rt,this.defaultOptions=bt,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,m.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,ut.x)()),this.backColorText$=this.texts$.pipe((0,m.U)(Nt=>Nt.backColor))}isBlankColor(yt){return yt===this.defaultOptions.blankColor}}xt.\u0275fac=function(yt){return new(yt||xt)(k.Y36(s.$3),k.Y36(b.rf),k.Y36(b.mJ))},xt.\u0275cmp=k.Xpm({type:xt,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(yt,rt){1&yt&&(k.YNc(0,Ct,7,9,"tui-hosted-dropdown",0),k.ALo(1,"async")),2&yt&&k.Q6J("tuiLet",k.lcZ(1,1,rt.backgroundColor$))},directives:[mt.L,nt.o,at.Ek,pt.v,Ot.D,gt.x,_t.t,Lt.D,It.$,Dt.O5,ht.R,X.e],pipes:[Dt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],xt.prototype,"colors",void 0)},93252:(Jt,Et,d)=>{d.d(Et,{Xp:()=>T.X,pu:()=>ut,Tf:()=>k.T,P_:()=>mt,yj:()=>nt.y,y9:()=>at,Un:()=>pt.U,dN:()=>It.d,jP:()=>Dt,mK:()=>Ot.m,p7:()=>gt,hr:()=>_t.h,Zv:()=>Lt,UT:()=>ht.U,XC:()=>ct,w2:()=>z.w,Ur:()=>Ct,pH:()=>xt.p,mp:()=>At,iN:()=>S.i,lT:()=>yt.l,iA:()=>Nt,YH:()=>Yt.Y,er:()=>ft,_I:()=>S._,__:()=>et,M8:()=>rt.M,kU:()=>bt,G0:()=>lt.G,_t:()=>Mt});var T=d(37924),s=d(12057),b=d(36692),P=d(72002),m=d(74788);let ut=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,b.TuiLetModule]]}),F})();var k=d(15587);let mt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,P.TuiDataListModule]]}),F})();var nt=d(50237);let at=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHintModule]]}),F})();var pt=d(18832),Ot=d(84985);let gt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,P.TuiDataListModule]]}),F})();var _t=d(62976);let Lt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule]]}),F})();var It=d(19762);let Dt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHintModule]]}),F})();var ht=d(7416),X=d(27050);let ct=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,X.VM,P.TuiHintModule,P.TuiDropdownModule,b.TuiActiveZoneModule,b.TuiLetModule]]}),F})();var z=d(13441);let Ct=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiButtonModule,P.TuiHintModule,b.TuiLetModule]]}),F})();var xt=d(95558);let At=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,X.VM,P.TuiButtonModule,P.TuiHintModule,b.TuiActiveZoneModule,P.TuiDropdownModule,b.TuiLetModule]]}),F})();var yt=d(28962),rt=d(74549);let bt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,b.TuiRepeatTimesModule]]}),F})(),Nt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiDropdownModule,P.TuiButtonModule,P.TuiHintModule,bt]]}),F})();var Yt=d(76965);let ft=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHintModule,b.TuiLetModule]]}),F})();var S=d(22063);let et=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiHostedDropdownModule,P.TuiHintModule,P.TuiButtonModule,P.TuiDataListModule,b.TuiLetModule]]}),F})();var lt=d(10528);let Mt=(()=>{class F{}return F.\u0275fac=function(dt){return new(dt||F)},F.\u0275mod=m.oAB({type:F}),F.\u0275inj=m.cJS({imports:[[s.ez,P.TuiButtonModule,P.TuiHostedDropdownModule,P.TuiDropdownModule,P.TuiHintModule,X.VM,b.TuiActiveZoneModule,b.TuiLetModule]]}),F})()},13441:(Jt,Et,d)=>{d.d(Et,{w:()=>ht});var T=d(84614),s=d(62842),b=d(9112),P=d(88002),m=d(74788),ut=d(12057),k=d(40939),mt=d(62939),nt=d(76189),at=d(67446),pt=d(29070),Ot=d(54255),gt=d(15491),_t=d(219);function Lt(X,ct){if(1&X){const z=m.EpF();m.TgZ(0,"div",6),m.TgZ(1,"button",7),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).editor.toggleUnorderedList()}),m.qZA(),m.TgZ(2,"button",8),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).editor.toggleOrderedList()}),m.qZA(),m.TgZ(3,"button",9),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).sinkListItem()}),m.qZA(),m.TgZ(4,"button",10),m.NdJ("click",function(){return m.CHM(z),m.oxw(3).liftListItem()}),m.qZA(),m.qZA()}if(2&X){const z=m.oxw().tuiLet,Ct=m.oxw().ngIf;m.xp6(1),m.Q6J("tuiHint",Ct.unorderedList)("pseudoActive",!(null==z||!z.unordered)),m.xp6(1),m.Q6J("tuiHint",Ct.orderedList)("pseudoActive",!(null==z||!z.ordered)),m.xp6(1),m.Q6J("tuiHint",Ct.indent)("disabled",!(null!=z&&z.ordered||null!=z&&z.unordered)),m.xp6(1),m.Q6J("tuiHint",Ct.outdent)("disabled",!(null!=z&&z.ordered||null!=z&&z.unordered))}}function It(X,ct){if(1&X&&(m.TgZ(0,"tui-hosted-dropdown",2,3),m._UZ(2,"button",4),m.YNc(3,Lt,5,8,"ng-template",null,5,m.W1O),m.qZA()),2&X){const z=ct.tuiLet,Ct=m.MAs(1),xt=m.MAs(4),At=m.oxw().ngIf;m.Q6J("content",xt),m.xp6(2),m.Q6J("tuiHint",At.list)("tuiHintDescribe","")("pseudoActive",(null==Ct?null:Ct.open)||(null==z?null:z.unordered)||(null==z?null:z.ordered)||!1)("focusable",Ct.open)}}function Dt(X,ct){if(1&X&&(m.ynx(0),m.YNc(1,It,5,5,"tui-hosted-dropdown",1),m.ALo(2,"async"),m.BQk()),2&X){const z=m.oxw();m.xp6(1),m.Q6J("tuiLet",m.lcZ(2,1,z.listState$))}}let ht=(()=>{class X{constructor(z,Ct){this.editor=z,this.texts$=Ct,this.listState$=(0,b.aj)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,P.U)(([xt,At])=>({ordered:xt,unordered:At})))}sinkListItem(){this.editor.sinkListItem()}liftListItem(){this.editor.liftListItem()}}return X.\u0275fac=function(z){return new(z||X)(m.Y36(T.$3),m.Y36(s.rf))},X.\u0275cmp=m.Xpm({type:X,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoActive","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","disabled","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","disabled","click"]],template:function(z,Ct){1&z&&(m.YNc(0,Dt,3,3,"ng-container",0),m.ALo(1,"async")),2&z&&m.Q6J("ngIf",m.lcZ(1,1,Ct.texts$))},directives:[ut.O5,k.L,mt.o,nt.v,at.D,pt.x,Ot.t,gt.D,_t.$],pipes:[ut.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),X})()},95558:(Jt,Et,d)=>{d.d(Et,{p:()=>At});var T=d(64762),s=d(84614),b=d(62842),P=d(36692),m=d(88002),ut=d(87519),k=d(74788),mt=d(40939),nt=d(62939),at=d(33250),pt=d(76189),Ot=d(67446),gt=d(29070),_t=d(54255),Lt=d(15491),It=d(219),Dt=d(12057),ht=d(5451),X=d(17163);function ct(yt,rt){if(1&yt&&k._UZ(0,"div",7),2&yt){const bt=k.oxw(2).tuiLet;k.Udp("background",bt)}}function z(yt,rt){if(1&yt){const bt=k.EpF();k.TgZ(0,"tui-palette",8),k.NdJ("selectedColor",function(Yt){return k.CHM(bt),k.oxw(3).setCellColor(Yt)}),k.qZA()}if(2&yt){const bt=rt.$implicit,Nt=k.oxw(3);k.Q6J("tuiActiveZoneParent",bt)("colors",Nt.colors)}}function Ct(yt,rt){if(1&yt&&(k.TgZ(0,"tui-hosted-dropdown",2,3),k._UZ(2,"button",4),k.ALo(3,"async"),k.YNc(4,ct,1,2,"div",5),k.YNc(5,z,1,2,"ng-template",null,6,k.W1O),k.qZA()),2&yt){const bt=rt.tuiLet,Nt=k.MAs(1),Yt=k.MAs(6),ft=k.oxw().tuiLet,S=k.oxw();k.Q6J("content",Yt)("tuiDropdownMaxHeight",999)("canOpen",!!bt),k.xp6(2),k.Q6J("tuiHint",k.lcZ(3,9,S.cellColorText$))("tuiHintDescribe","")("pseudoActive",Nt.open)("focusable",Nt.open)("disabled",!bt),k.xp6(2),k.Q6J("ngIf",!S.isBlankColor(ft||""))}}function xt(yt,rt){if(1&yt&&(k.ynx(0),k.YNc(1,Ct,7,11,"tui-hosted-dropdown",1),k.ALo(2,"async"),k.BQk()),2&yt){const bt=k.oxw();k.xp6(1),k.Q6J("tuiLet",k.lcZ(2,1,bt.isActive$))}}class At{constructor(rt,bt,Nt){this.defaultOptions=rt,this.editor=bt,this.texts$=Nt,this.colors=this.defaultOptions.colors,this.cellColorText$=this.texts$.pipe((0,m.U)(Yt=>Yt.cellColor)),this.isActive$=this.editor.isActive$("table"),this.cellColor$=this.editor.stateChange$.pipe((0,m.U)(()=>this.editor.getCellColor()||this.defaultOptions.blankColor),(0,ut.x)())}isBlankColor(rt){return rt===this.defaultOptions.blankColor}setCellColor(rt){this.editor.setCellColor(rt)}}At.\u0275fac=function(rt){return new(rt||At)(k.Y36(b.mJ),k.Y36(s.$3),k.Y36(b.rf))},At.\u0275cmp=k.Xpm({type:At,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["cellColorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","disabled"],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(rt,bt){1&rt&&(k.YNc(0,xt,3,3,"ng-container",0),k.ALo(1,"async")),2&rt&&k.Q6J("tuiLet",k.lcZ(1,1,bt.cellColor$))},directives:[mt.L,nt.o,at.Ek,pt.v,Ot.D,gt.x,_t.t,Lt.D,It.$,Dt.O5,ht.R,X.e],pipes:[Dt.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],At.prototype,"colors",void 0)},28962:(Jt,Et,d)=>{d.d(Et,{l:()=>It});var T=d(84614),s=d(62842),b=d(88002),P=d(74788),m=d(62939),ut=d(33250),k=d(76189),mt=d(67446),nt=d(29070),at=d(54255),pt=d(15491),Ot=d(219),gt=d(74549),_t=d(12057);function Lt(Dt,ht){if(1&Dt){const X=P.EpF();P.TgZ(0,"tui-table-size-selector",4),P.NdJ("onSelectSize",function(z){return P.CHM(X),P.oxw().addTable(z)}),P.qZA()}}let It=(()=>{class Dt{constructor(X,ct){this.editor=X,this.texts$=ct,this.insertTableText$=this.texts$.pipe((0,b.U)(z=>z.insertTable))}addTable({rows:X,cols:ct}){this.editor.enter();const z=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(z),this.editor.insertTable(X,ct)}}return Dt.\u0275fac=function(X){return new(X||Dt)(P.Y36(T.$3),P.Y36(s.rf))},Dt.\u0275cmp=P.Xpm({type:Dt,selectors:[["tui-table-create"]],decls:6,vars:6,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable"],["tableDropdown",""],[3,"onSelectSize"]],template:function(X,ct){if(1&X&&(P.TgZ(0,"tui-hosted-dropdown",0,1),P._UZ(2,"button",2),P.ALo(3,"async"),P.qZA(),P.YNc(4,Lt,1,0,"ng-template",null,3,P.W1O)),2&X){const z=P.MAs(1),Ct=P.MAs(5);P.Q6J("content",Ct),P.xp6(2),P.Q6J("tuiHint",P.lcZ(3,4,ct.insertTableText$))("tuiHintDescribe","")("focusable",z.open)}},directives:[m.o,ut.Ek,k.v,mt.D,nt.x,at.t,pt.D,Ot.$,gt.M],pipes:[_t.Ov],encapsulation:2,changeDetection:0}),Dt})()},76965:(Jt,Et,d)=>{d.d(Et,{Y:()=>Dt});var T=d(84614),s=d(62842),b=d(88002),P=d(87519),m=d(74788),ut=d(40939),k=d(12057),mt=d(76189),nt=d(67446),at=d(29070),pt=d(54255),Ot=d(15491),gt=d(219);function _t(ht,X){if(1&ht){const ct=m.EpF();m.TgZ(0,"button",2),m.NdJ("click",function(){m.CHM(ct);const Ct=m.oxw().tuiLet,xt=m.oxw();return Ct.mergeCells?xt.mergeCells():xt.splitCell()}),m.qZA()}if(2&ht){const ct=X.ngIf,z=m.oxw().tuiLet;m.Q6J("icon",z.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",z.mergeCells?ct.mergeCells:ct.splitCells)("tuiHintDescribe","")("focusable",!1)("disabled",!z.mergeCells&&!z.splitCells)}}function Lt(ht,X){if(1&ht&&(m.ynx(0),m.YNc(1,_t,1,5,"button",1),m.ALo(2,"async"),m.BQk()),2&ht){const ct=m.oxw();m.xp6(1),m.Q6J("ngIf",m.lcZ(2,1,ct.texts$))}}const It=function(ht,X){return{mergeCells:ht,splitCells:X}};let Dt=(()=>{class ht{constructor(ct,z){this.editor=ct,this.texts$=z,this.canMergeCells$=this.editor.stateChange$.pipe((0,b.U)(()=>this.editor.canMergeCells()),(0,P.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,b.U)(()=>this.editor.canSplitCells()),(0,P.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}}return ht.\u0275fac=function(ct){return new(ct||ht)(m.Y36(T.$3),m.Y36(s.rf))},ht.\u0275cmp=m.Xpm({type:ht,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintDescribe","focusable","disabled","click"]],template:function(ct,z){1&ct&&(m.YNc(0,Lt,3,3,"ng-container",0),m.ALo(1,"async"),m.ALo(2,"async")),2&ct&&m.Q6J("tuiLet",m.WLB(5,It,m.lcZ(1,1,z.canMergeCells$),m.lcZ(2,3,z.canSplitCells$)))},directives:[ut.L,k.O5,mt.v,nt.D,at.x,pt.t,Ot.D,gt.$],pipes:[k.Ov],encapsulation:2,changeDetection:0}),ht})()},22063:(Jt,Et,d)=>{d.d(Et,{i:()=>z,_:()=>Ct});var T=d(84614),s=d(62842),b=d(88002),P=d(74788),m=d(40939),ut=d(62939),k=d(76189),mt=d(67446),nt=d(29070),at=d(54255),pt=d(15491),Ot=d(219),gt=d(20933),_t=d(12057),Lt=d(89786),It=d(35065);function Dt(xt,At){if(1&xt&&(P.TgZ(0,"tui-hosted-dropdown",2,3),P._UZ(2,"button",4),P.ALo(3,"async"),P.qZA()),2&xt){const yt=At.tuiLet,rt=P.MAs(1),bt=P.oxw(),Nt=P.MAs(3);P.Q6J("content",Nt)("canOpen",!!yt),P.xp6(2),P.Q6J("tuiHint",P.lcZ(3,6,bt.rowsColumnsManagingText$))("tuiHintDescribe","")("focusable",rt.open)("disabled",!yt)}}function ht(xt,At){if(1&xt){const yt=P.EpF();P.TgZ(0,"button",7),P.NdJ("click",function(){const Nt=P.CHM(yt).index,Yt=P.oxw().index;return P.oxw(2).onTableOption(2*Yt+Nt)}),P._uU(1),P.qZA()}if(2&xt){const yt=At.$implicit;P.xp6(1),P.hij(" ",yt," ")}}function X(xt,At){if(1&xt&&(P.TgZ(0,"tui-opt-group"),P.YNc(1,ht,2,1,"button",6),P.qZA()),2&xt){const yt=At.$implicit;P.xp6(1),P.Q6J("ngForOf",yt)}}function ct(xt,At){if(1&xt&&(P.TgZ(0,"tui-data-list"),P.YNc(1,X,2,1,"tui-opt-group",5),P.ALo(2,"async"),P.qZA()),2&xt){const yt=P.oxw();P.xp6(1),P.Q6J("ngForOf",P.lcZ(2,1,yt.tableCommandTexts$))}}var z=(()=>{return(xt=z||(z={}))[xt.InsertColumnBefore=0]="InsertColumnBefore",xt[xt.InsertColumnAfter=1]="InsertColumnAfter",xt[xt.InsertRowBefore=2]="InsertRowBefore",xt[xt.InsertRowAfter=3]="InsertRowAfter",xt[xt.DeleteColumn=4]="DeleteColumn",xt[xt.DeleteRow=5]="DeleteRow",z;var xt})();let Ct=(()=>{class xt{constructor(yt,rt,bt){this.editor=yt,this.texts$=rt,this.tableCommandTexts$=bt,this.commandsRegistry={[z.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[z.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[z.InsertRowAfter]:()=>this.editor.addRowAfter(),[z.InsertRowBefore]:()=>this.editor.addRowBefore(),[z.DeleteColumn]:()=>this.editor.deleteColumn(),[z.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,b.U)(Nt=>Nt.rowsColumnsManaging))}onTableOption(yt){this.commandsRegistry[yt]()}}return xt.\u0275fac=function(yt){return new(yt||xt)(P.Y36(T.$3),P.Y36(s.rf),P.Y36(s.$i))},xt.\u0275cmp=P.Xpm({type:xt,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintDescribe","focusable","disabled"],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(yt,rt){1&yt&&(P.YNc(0,Dt,4,8,"tui-hosted-dropdown",0),P.ALo(1,"async"),P.YNc(2,ct,3,3,"ng-template",null,1,P.W1O)),2&yt&&P.Q6J("tuiLet",P.lcZ(1,1,rt.isActive$))},directives:[m.L,ut.o,k.v,mt.D,nt.x,at.t,pt.D,Ot.$,gt.q,_t.sg,Lt.R,It.v],pipes:[_t.Ov],encapsulation:2,changeDetection:0}),xt})()},74549:(Jt,Et,d)=>{d.d(Et,{M:()=>at});var T=d(74788),s=d(62579),b=d(72002),P=d(36097);function m(pt,Ot){if(1&pt){const gt=T.EpF();T.TgZ(0,"div",4),T.NdJ("mouseenter",function(Lt){const Dt=T.CHM(gt).$implicit,ht=T.oxw().$implicit;return T.oxw().updateCurrentSize(Dt+1,ht+1,Lt)})("click",function(){return T.CHM(gt),T.oxw(2).onClick()}),T.qZA()}if(2&pt){const gt=Ot.$implicit,_t=T.oxw().$implicit,Lt=T.oxw();T.ekj("t-cell_hovered",Lt.tableSelectHovered(gt,_t))}}function ut(pt,Ot){if(1&pt&&(T.TgZ(0,"div",2),T.YNc(1,m,1,2,"div",3),T.qZA()),2&pt){const gt=T.oxw();T.xp6(1),T.Q6J("tuiRepeatTimesOf",gt.rowsNumber)}}let at=(()=>{class pt{constructor(gt){this.windowRef=gt,this.onSelectSize=new T.vpe,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(gt,_t){return gt<this.tableSize.rows&&_t<this.tableSize.cols}updateCurrentSize(gt,_t,Lt){(0,b.tuiGetViewportWidth)(this.windowRef)-Lt.clientX>70&&(this.tableSize={rows:gt,cols:_t})}onClick(){this.onSelectSize.emit(this.tableSize)}}return pt.\u0275fac=function(gt){return new(gt||pt)(T.Y36(s.m9))},pt.\u0275cmp=T.Xpm({type:pt,selectors:[["tui-table-size-selector"]],outputs:{onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(gt,_t){1&gt&&(T.YNc(0,ut,2,1,"div",0),T.TgZ(1,"div",1),T._uU(2),T.qZA()),2&gt&&(T.Q6J("tuiRepeatTimesOf",_t.columnsNumber),T.xp6(2),T.AsE("",_t.tableSize.cols,"\xd7",_t.tableSize.rows,""))},directives:[P.X],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),pt})()},10528:(Jt,Et,d)=>{d.d(Et,{G:()=>Ct});var T=d(64762),s=d(84614),b=d(62842),P=d(36692),m=d(88002),ut=d(87519),k=d(74788),mt=d(40939),nt=d(62939),at=d(33250),pt=d(76189),Ot=d(67446),gt=d(29070),_t=d(54255),Lt=d(15491),It=d(219),Dt=d(5451),ht=d(17163),X=d(12057);function ct(xt,At){if(1&xt){const yt=k.EpF();k.TgZ(0,"tui-palette",6),k.NdJ("selectedColor",function(bt){return k.CHM(yt),k.oxw(2).editor.setFontColor(bt)}),k.qZA()}if(2&xt){const yt=At.$implicit,rt=k.oxw(2);k.Q6J("tuiActiveZoneParent",yt)("colors",rt.colors)}}function z(xt,At){if(1&xt&&(k.TgZ(0,"tui-hosted-dropdown",1,2),k._UZ(2,"button",3),k.ALo(3,"async"),k._UZ(4,"div",4),k.YNc(5,ct,1,2,"ng-template",null,5,k.W1O),k.qZA()),2&xt){const yt=At.tuiLet,rt=k.MAs(1),bt=k.MAs(6),Nt=k.oxw();k.Q6J("content",bt)("tuiDropdownMaxHeight",999),k.xp6(2),k.Q6J("tuiHint",k.lcZ(3,8,Nt.foreColorText$))("tuiHintDescribe","")("pseudoActive",rt.open)("focusable",rt.open),k.xp6(2),k.Udp("background",yt)}}class Ct{constructor(At,yt,rt){this.defaultOptions=At,this.editor=yt,this.texts$=rt,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,m.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,ut.x)()),this.foreColorText$=this.texts$.pipe((0,m.U)(bt=>bt.foreColor))}}Ct.\u0275fac=function(At){return new(At||Ct)(k.Y36(b.mJ),k.Y36(s.$3),k.Y36(b.rf))},Ct.\u0275cmp=k.Xpm({type:Ct,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(At,yt){1&At&&(k.YNc(0,z,7,10,"tui-hosted-dropdown",0),k.ALo(1,"async")),2&At&&k.Q6J("tuiLet",k.lcZ(1,1,yt.fontColor$))},directives:[mt.L,nt.o,at.Ek,pt.v,Ot.D,gt.x,_t.t,Lt.D,It.$,Dt.R,ht.e],pipes:[X.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:20.25rem}"],changeDetection:0}),(0,T.gn)([(0,P.tuiDefaultProp)()],Ct.prototype,"colors",void 0)},17406:(Jt,Et,d)=>{d.d(Et,{M6:()=>T.M,yB:()=>mt,Bp:()=>nt.B});var T=d(4997),s=d(12057),b=d(71115),P=d(93252),m=d(36692),ut=d(72002),k=d(74788);let mt=(()=>{class at{}return at.\u0275fac=function(Ot){return new(Ot||at)},at.\u0275mod=k.oAB({type:at}),at.\u0275inj=k.cJS({imports:[[s.ez,ut.TuiHintModule,m.TuiFocusableModule,ut.TuiButtonModule,ut.TuiHostedDropdownModule,b.F,P.er,P.mp,P.__,P.iA,P.p7,P.Zv,P.pu,P.Ur,P._t,P.XC,P.P_,P.y9,m.TuiItemModule,P.jP]]}),at})();var nt=d(13044)},13044:(Jt,Et,d)=>{d.d(Et,{B:()=>b});var T=d(74788),s=d(36692);let b=(()=>{class P{constructor(ut){this.elementRef=ut}get toolsContainers(){return Array.from(this.elementRef.nativeElement.querySelectorAll("[tuiItem]"))}onHorizontalNavigation(ut){const{toolsContainers:k}=this,mt=k.findIndex(s.tuiIsNativeFocusedIn),at=k[(0,s.tuiClamp)(mt+(ut?-1:1),0,k.length-1)],pt=ut?this.findPreviousTool(at):this.findNextTool(at);pt&&pt.focus()}findFirstFocusableTool(ut=!1){const k=ut?this.toolsContainers.slice().reverse():this.toolsContainers;for(const mt of k){const nt=(0,s.tuiIsNativeMouseFocusable)(mt)?mt:(0,s.tuiGetClosestFocusable)({initial:mt,root:mt,keyboard:!1});if(nt)return nt}return null}findPreviousTool(ut){return(0,s.tuiIsNativeMouseFocusable)(ut)?ut:(0,s.tuiGetClosestFocusable)({initial:ut,root:ut,keyboard:!1})||(0,s.tuiGetClosestFocusable)({initial:ut,root:this.elementRef.nativeElement,previous:!0,keyboard:!1})}findNextTool(ut){return(0,s.tuiIsNativeMouseFocusable)(ut)?ut:(0,s.tuiGetClosestFocusable)({initial:ut,root:this.elementRef.nativeElement,keyboard:!1})}}return P.\u0275fac=function(ut){return new(ut||P)(T.Y36(T.SBq))},P.\u0275dir=T.lG2({type:P,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(ut,k){1&ut&&T.NdJ("keydown.arrowRight.prevent",function(){return k.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return k.onHorizontalNavigation(!0)})}}),P})()},4997:(Jt,Et,d)=>{d.d(Et,{M:()=>B});var T=d(64762),s=d(74788),b=d(19074),P=d(84614),m=d(48699),ut=d(62842),k=d(36692),mt=d(15257),nt=d(13044),at=d(12057),pt=d(48893),Ot=d(76189),gt=d(82707),_t=d(67446),Lt=d(29070),It=d(54255),Dt=d(15491),ht=d(219),X=d(84985),ct=d(62939),z=d(62976),Ct=d(37924),xt=d(13441),At=d(45050),yt=d(10528),rt=d(7416),bt=d(15587),Nt=d(50237),Yt=d(18832),ft=d(19762),S=d(28962),et=d(22063),lt=d(76965),Mt=d(95558);const F=["dropdown"];function K(W,G){1&W&&s.GkF(0)}function dt(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",7),s.NdJ("click",function(){return s.CHM(U),s.oxw(2).undo()}),s.qZA(),s.TgZ(2,"button",8),s.NdJ("click",function(){return s.CHM(U),s.oxw(2).redo()}),s.qZA(),s.qZA()}if(2&W){const U=s.oxw().ngIf,Pt=s.oxw();s.xp6(1),s.Q6J("tuiHint",U.undo)("tuiHintDescribe","")("disabled",Pt.undoDisabled)("focusable",!1),s.xp6(1),s.Q6J("tuiHint",U.redo)("tuiHintDescribe","")("disabled",Pt.redoDisabled)("focusable",!1)}}function Bt(W,G){1&W&&(s.TgZ(0,"div",6),s._UZ(1,"tui-font-size",9),s.qZA())}function $t(W,G){if(1&W&&s._UZ(0,"tui-font-style",19),2&W){const U=s.oxw(3);s.Q6J("enabledTools",U.toolsSet)}}function qt(W,G){1&W&&s._UZ(0,"tui-align-content",9)}function ae(W,G){1&W&&s._UZ(0,"tui-list-configs",9)}function le(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"button",20,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).toggleQuote()}),s.qZA()}if(2&W){const U=s.oxw(2).ngIf,Pt=s.oxw();s.Q6J("tuiHint",U.quote)("tuiHintDescribe","")("pseudoActive",Pt.blockquote)("disabled",Pt.unorderedList||Pt.orderedList)("focusable",!1)}}function Fe(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"tui-edit-link",26,27),s.NdJ("addLink",function(Ut){s.CHM(U),s.oxw();const Ft=s.MAs(1);return s.oxw(3).onLink(Ft,Ut)})("removeLink",function(){s.CHM(U),s.oxw();const Ut=s.MAs(1);return s.oxw(3).onLink(Ut)}),s.qZA()}}function Ke(W,G){if(1&W&&(s.TgZ(0,"tui-hosted-dropdown",22,23),s._UZ(2,"button",24,21),s.YNc(4,Fe,2,0,"ng-template",null,25,s.W1O),s.qZA()),2&W){const U=s.MAs(1),Pt=s.MAs(5),Ut=s.oxw(2).ngIf,Ft=s.oxw();s.Q6J("canOpen",Ft.canOpenAnchor)("content",Pt),s.xp6(2),s.Q6J("tuiHint",Ut.link)("tuiHintDescribe","")("pseudoActive",U.open||Ft.a)("focusable",U.open)}}function Qe(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"tui-edit-link",28),s.NdJ("addLink",function(Ut){s.CHM(U),s.oxw();const Ft=s.MAs(7);return s.oxw(2).setAnchor(Ft,Ut)})("removeLink",function(){return s.CHM(U),s.oxw(3).removeAnchor()}),s.qZA()}2&W&&s.Q6J("anchorMode",!0)}function we(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"button",29,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).onAttach()}),s.qZA()}if(2&W){const U=s.oxw(2).ngIf;s.Q6J("tuiHint",U.attach)("tuiHintDescribe","")("focusable",!1)}}function he(W,G){if(1&W&&(s.TgZ(0,"div",6),s.YNc(1,$t,1,1,"tui-font-style",10),s.YNc(2,qt,1,0,"tui-align-content",11),s.YNc(3,ae,1,0,"tui-list-configs",11),s.YNc(4,le,2,5,"button",12),s.YNc(5,Ke,6,6,"tui-hosted-dropdown",13),s.TgZ(6,"tui-hosted-dropdown",14,15),s._UZ(8,"button",16),s.YNc(9,Qe,1,1,"ng-template",null,17,s.W1O),s.qZA(),s.YNc(11,we,2,3,"button",18),s.qZA()),2&W){const U=s.MAs(7),Pt=s.MAs(10),Ut=s.oxw().ngIf,Ft=s.oxw();s.xp6(1),s.Q6J("ngIf",Ft.formatEnabled),s.xp6(1),s.Q6J("ngIf",Ft.enabled(Ft.TuiEditorTool.Align)),s.xp6(1),s.Q6J("ngIf",Ft.enabled(Ft.TuiEditorTool.List)),s.xp6(1),s.Q6J("ngIf",Ft.enabled(Ft.TuiEditorTool.Quote)),s.xp6(1),s.Q6J("ngIf",Ft.enabled(Ft.TuiEditorTool.Link)),s.xp6(1),s.Q6J("canOpen",Ft.canOpenAnchor)("content",Pt),s.xp6(2),s.Q6J("focusable",!1)("pseudoActive",U.open||Ft.jumpAnchor)("tuiHint",Ut.insertAnchor)("tuiHintDescribe",""),s.xp6(3),s.Q6J("ngIf",Ft.enabled(Ft.TuiEditorTool.Attach))}}function De(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"button",32,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).toggleSubscript()}),s.qZA()}if(2&W){const U=s.oxw(2).ngIf,Pt=s.oxw();s.Q6J("tuiHint",U.subscript)("tuiHintDescribe","")("pseudoActive",Pt.subscript)("focusable",!1)}}function Ie(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"button",33,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).toggleSuperscript()}),s.qZA()}if(2&W){const U=s.oxw(2).ngIf,Pt=s.oxw();s.Q6J("tuiHint",U.superscript)("tuiHintDescribe","")("pseudoActive",Pt.superscript)("focusable",!1)}}function Te(W,G){if(1&W&&(s.TgZ(0,"div",6),s.YNc(1,De,2,4,"button",30),s.YNc(2,Ie,2,4,"button",31),s.qZA()),2&W){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Sub)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Sup))}}function Ue(W,G){if(1&W&&s._UZ(0,"tui-text-color",35),2&W){const U=s.oxw(3);s.Q6J("colors",U.colors)}}function de(W,G){if(1&W&&s._UZ(0,"tui-highlight-color",35),2&W){const U=s.oxw(3);s.Q6J("colors",U.colors)}}function se(W,G){if(1&W&&(s.TgZ(0,"div",6),s.YNc(1,Ue,1,1,"tui-text-color",34),s.YNc(2,de,1,1,"tui-highlight-color",34),s.qZA()),2&W){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Color)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Hilite))}}function We(W,G){1&W&&s._UZ(0,"tui-code",9)}function Ee(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"button",39,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).onTeX()}),s.qZA()}if(2&W){const U=s.oxw(2).ngIf;s.Q6J("tuiHint",U.tex)("tuiHintDescribe","")("focusable",!1)}}function Re(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"div",40),s.TgZ(1,"button",41,21),s.NdJ("click",function(){return s.CHM(U),s.MAs(4).click()}),s.qZA(),s.TgZ(3,"input",42,43),s.NdJ("change",function(){s.CHM(U);const Ut=s.MAs(4);return s.oxw(3).onImage(Ut)}),s.qZA(),s.qZA()}if(2&W){const U=s.oxw(2).ngIf;s.xp6(1),s.Q6J("tuiHint",U.image)("tuiHintDescribe","")("focusable",!1),s.xp6(2),s.Q6J("tuiFocusable",!1)}}function Je(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"button",44,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(3).insertHorizontalRule()}),s.qZA()}if(2&W){const U=s.oxw(2).ngIf;s.Q6J("tuiHint",U.insertHorizontalRule)("tuiHintDescribe","")("focusable",!1)}}function $e(W,G){if(1&W&&(s.TgZ(0,"div",6),s.YNc(1,We,1,0,"tui-code",11),s.YNc(2,Ee,2,3,"button",36),s.YNc(3,Re,5,4,"div",37),s.YNc(4,Je,2,3,"button",38),s.qZA()),2&W){const U=s.oxw(2);s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Code)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Tex)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Img)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.HR))}}function _e(W,G){if(1&W){const U=s.EpF();s.TgZ(0,"div",6),s.TgZ(1,"button",45,21),s.NdJ("click",function(){return s.CHM(U),s.oxw(2).removeFormat()}),s.qZA(),s.qZA()}if(2&W){const U=s.oxw().ngIf;s.xp6(1),s.Q6J("tuiHint",U.clear)("tuiHintDescribe","")("focusable",!1)}}function Ce(W,G){1&W&&(s.TgZ(0,"div",6),s._UZ(1,"tui-details",46),s._UZ(2,"tui-details-remove",46),s.qZA())}function Ae(W,G){1&W&&(s.TgZ(0,"div",6),s._UZ(1,"tui-editor-group-tool",46),s.qZA())}function Q(W,G){if(1&W&&(s.TgZ(0,"div",6),s._UZ(1,"tui-table-create",46),s._UZ(2,"tui-table-row-column-manager",46),s._UZ(3,"tui-table-merge-cells",46),s._UZ(4,"tui-table-cell-color",35),s.qZA()),2&W){const U=s.oxw(2);s.xp6(4),s.Q6J("colors",U.colors)}}function E(W,G){if(1&W&&(s.TgZ(0,"section",4),s.YNc(1,dt,3,8,"div",5),s.YNc(2,Bt,2,0,"div",5),s.YNc(3,he,12,12,"div",5),s.YNc(4,Te,3,2,"div",5),s.YNc(5,se,3,2,"div",5),s.YNc(6,$e,5,4,"div",5),s.YNc(7,_e,3,3,"div",5),s.YNc(8,Ce,3,0,"div",5),s.YNc(9,Ae,2,0,"div",5),s.YNc(10,Q,5,1,"div",5),s.TgZ(11,"div",6),s.Hsn(12),s.qZA(),s.qZA()),2&W){const U=s.oxw();s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Undo)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Size)),s.xp6(1),s.Q6J("ngIf",U.firstBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Sub)||U.enabled(U.TuiEditorTool.Sup)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Color)||U.enabled(U.TuiEditorTool.Hilite)),s.xp6(1),s.Q6J("ngIf",U.secondBigBlockEnabled),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Clear)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Details)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Group)),s.xp6(1),s.Q6J("ngIf",U.enabled(U.TuiEditorTool.Table))}}class B{constructor(G,U,Pt,Ut,Ft){this.elementRef=G,this.editor=U,this.imageLoader=Pt,this.texts$=Ut,this.defaultOptions=Ft,this.dropdowns=k.EMPTY_QUERY,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new s.vpe,this.texClicked=new s.vpe,this.attachClicked=new s.vpe,this.TuiEditorTool=m._,this.toolsSet=new Set(b.Db)}set tools(G){this.toolsSet=new Set(G)}get focused(){return(0,k.tuiIsNativeFocusedIn)(this.elementRef.nativeElement)||!!this.dropdowns.find(({nativeElement:G})=>(0,k.tuiIsNativeFocusedIn)(G))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get jumpAnchor(){return this.editor.isActive("jumpAnchor")}get canOpenAnchor(){return!this.a&&!this.jumpAnchor}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(m._.Bold)||this.enabled(m._.Italic)||this.enabled(m._.Underline)||this.enabled(m._.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(m._.Align)||this.enabled(m._.List)||this.enabled(m._.Quote)||this.enabled(m._.Link)||this.enabled(m._.Anchor)||this.enabled(m._.Attach)}get secondBigBlockEnabled(){return this.enabled(m._.Code)||this.enabled(m._.Tex)||this.enabled(m._.Img)||this.enabled(m._.HR)}onMouseDown(G,U){U.closest("button")||(G.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage(G){var U;const Pt=null===(U=G.files)||void 0===U?void 0:U[0];G.value="",Pt&&this.imageLoader(Pt).pipe((0,mt.q)(1)).subscribe(Ut=>{this.addImage(Ut)})}onAttach(){this.attachClicked.emit()}onTeX(){this.texClicked.emit()}onLink(G,U){G.open=!1,U&&(this.editor.toggleLink(U),this.editor.selectClosest())}setAnchor(G,U){G.open=!1,U&&(this.editor.setAnchor(U),this.editor.selectClosest())}removeAnchor(){this.editor.removeAnchor()}enabled(G){return this.toolsSet.has(G)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage(G){this.editor.setImage(G)}focusFirst(){var G;const U=null===(G=this.navigationManager)||void 0===G?void 0:G.findFirstFocusableTool();U&&U.focus()}focusLast(){var G;const U=null===(G=this.navigationManager)||void 0===G?void 0:G.findFirstFocusableTool(!0);U&&U.focus()}}B.\u0275fac=function(G){return new(G||B)(s.Y36(s.SBq,8),s.Y36(P.$3),s.Y36(ut.p7),s.Y36(ut.rf),s.Y36(ut.mJ))},B.\u0275cmp=s.Xpm({type:B,selectors:[["tui-toolbar"]],viewQuery:function(G,U){if(1&G&&(s.Gf(nt.B,5),s.Gf(F,5,s.SBq)),2&G){let Pt;s.iGM(Pt=s.CRH())&&(U.navigationManager=Pt.first),s.iGM(Pt=s.CRH())&&(U.dropdowns=Pt)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function(G,U){1&G&&s.NdJ("mousedown",function(Ut){return U.onMouseDown(Ut,Ut.target)}),2&G&&s.ekj("_disabled",U.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",attachClicked:"attachClicked"},ngContentSelectors:["*"],decls:7,vars:8,consts:[[1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiItem","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","disabled","focusable","click"],["tuiItem","",1,"t-tool","t-wrapper"],["tuiItem","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiItem","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],[1,"t-wrapper",3,"canOpen","content"],["anchor",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAnchorLarge","tuiHintDirection","top-left","appearance","icon",3,"focusable","pseudoActive","tuiHint","tuiHintDescribe"],["anchorDropdown",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","disabled","focusable","click"],["button",""],["tuiItem","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable"],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],[3,"anchorMode","addLink","removeLink"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","pseudoActive","focusable","click"],["tuiItem","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiItem","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiItem","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click",4,"ngIf"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImgLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintDescribe","focusable","click"],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiIconButton","","tuiItem","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintDescribe","focusable","click"],["tuiItem","",1,"t-tool","t-tool_margin"]],template:function(G,U){1&G&&(s.F$t(),s._UZ(0,"button",0),s.YNc(1,K,1,0,"ng-container",1),s.ALo(2,"async"),s.TgZ(3,"div",2),s.NdJ("focus",function(){return U.onTopFocus()}),s.qZA(),s.TgZ(4,"div",2),s.NdJ("focus",function(){return U.onBottomFocus()}),s.qZA(),s.YNc(5,E,13,10,"section",3),s.ALo(6,"async")),2&G&&(s.xp6(1),s.Q6J("ngIf",s.lcZ(2,4,U.editor.stateChange$)),s.xp6(2),s.Q6J("tuiFocusable",U.focusable),s.xp6(1),s.Q6J("tuiFocusable",U.focusable),s.xp6(1),s.Q6J("ngIf",s.lcZ(6,6,U.texts$)))},directives:[at.O5,pt.t,nt.B,Ot.v,gt.w,_t.D,Lt.x,It.t,Dt.D,ht.$,X.m,ct.o,z.h,Ct.X,xt.w,At.l,yt.G,rt.U,bt.T,Nt.y,Yt.U,ft.d,S.l,et._,lt.Y,Mt.p],pipes:[at.Ov],styles:['.t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:"";display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}button.t-tool[_ngcontent-%COMP%]:hover, .t-tool[_ngcontent-%COMP%]     button:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:none;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-color-edit{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),(0,T.gn)([(0,k.tuiDefaultProp)()],B.prototype,"colors",void 0),(0,T.gn)([(0,k.tuiDefaultProp)()],B.prototype,"disabled",void 0),(0,T.gn)([(0,k.tuiDefaultProp)(function(W){return!W.includes(m._.Tex)&&!W.includes(m._.Attach)},"Attach and TeX are not yet implemented in Editor")],B.prototype,"tools",null)},19074:(Jt,Et,d)=>{d.d(Et,{hK:()=>s,sw:()=>T,Db:()=>P,RR:()=>m});const T=new Map([["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),s="rgb(51, 51, 51)";var b=d(48699);const P=[b._.Undo,b._.Size,b._.Bold,b._.Italic,b._.Underline,b._.Align,b._.List,b._.Quote,b._.Link,b._.Color,b._.Hilite,b._.Clear,b._.Strikethrough,b._.Code,b._.Img,b._.HR,b._.Sup,b._.Sub,b._.Table,b._.Details];function m(ut){return[{px:13,name:ut.small},{px:15,name:ut.normal},{px:17,name:ut.large},{px:24,family:"var(--tui-font-heading)",name:ut.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:ut.title,headingLevel:1,weight:"bold"}]}},60153:(Jt,Et,d)=>{d.d(Et,{Z:()=>s});var T=d(74788);let s=(()=>{class b{constructor(){this.imagePreview=new T.vpe}click(m){m instanceof HTMLImageElement&&this.imagePreview.emit(m)}}return b.\u0275fac=function(m){return new(m||b)},b.\u0275dir=T.lG2({type:b,selectors:[["tui-editor-socket","imagePreview",""]],hostAttrs:[1,"_preview-image"],hostBindings:function(m,ut){1&m&&T.NdJ("click",function(mt){return ut.click(mt.target)})},outputs:{imagePreview:"imagePreview"}}),b})()},84614:(Jt,Et,d)=>{d.d(Et,{Zj:()=>T.Z,BN:()=>b,JU:()=>P.JU,mJ:()=>P.mJ,$3:()=>P.$3});var T=d(60153),s=d(74788);let b=(()=>{class m{}return m.\u0275fac=function(k){return new(k||m)},m.\u0275mod=s.oAB({type:m}),m.\u0275inj=s.cJS({}),m})();var P=d(82113)},82113:(Jt,Et,d)=>{d.d(Et,{JU:()=>T.J,mJ:()=>b,$3:()=>P.$});var T=d(74982),s=d(74788);let b=(()=>{class m{}return m.\u0275fac=function(k){return new(k||m)},m.\u0275mod=s.oAB({type:m}),m.\u0275inj=s.cJS({}),m})();var P=d(17804)},74982:(Jt,Et,d)=>{d.d(Et,{J:()=>ut});var T=d(74788),s=d(62842),b=d(36692),P=d(46782),m=d(17804);let ut=(()=>{class k{constructor(nt,at,pt,Ot,gt,_t){this.elementRef=nt,this.renderer=at,this.editor=pt,this.editorContainer=Ot,this.editorLoaded$=gt,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,this.editorLoaded$.pipe((0,P.R)(_t)).subscribe(()=>{this.renderer.appendChild(this.elementRef.nativeElement,this.editorContainer)})}set value(nt){nt!==this.editor.html&&this.editor.setValue(nt)}set editable(nt){this.editor.editable=nt}}return k.\u0275fac=function(nt){return new(nt||k)(T.Y36(T.SBq),T.Y36(T.Qsj),T.Y36(m.$),T.Y36(s.Y1),T.Y36(s.ZW),T.Y36(b.TuiDestroyService))},k.\u0275dir=T.lG2({type:k,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[T._Bn([b.TuiDestroyService])]}),k})()},17804:(Jt,Et,d)=>{d.d(Et,{$:()=>at});var T=d(79765),s=d(74788);let b=(()=>{class pt{constructor(){this.stateChange$=new T.xQ,this.valueChange$=new T.xQ}}return pt.\u0275fac=function(gt){return new(gt||pt)},pt.\u0275dir=s.lG2({type:pt}),pt})();var P=d(62842),m=d(37631),ut=d(39761),k=d(88002),mt=d(87519);let at=(()=>{class pt extends b{constructor(gt){super(),this.editorRef=gt,this.editorRef.subscribe(_t=>{this.editor=_t,_t.on("transaction",()=>{this.stateChange$.next()}),_t.on("update",()=>{const Lt=_t.getHTML(),Dt=function(pt){return Array.isArray(pt)&&1===pt.length&&!pt[0].hasOwnProperty("content")}(_t.getJSON().content)?"":Lt;this.valueChange$.next(Dt)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(gt){this.editor.setEditable(gt)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||"rgb(51, 51, 51)"}getBackgroundColor(){var gt;return(null===(gt=this.editor)||void 0===gt?void 0:gt.getAttributes("textStyle").backgroundColor)||"rgb(51, 51, 51)"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}onAlign(gt){this.editor.chain().focus().setTextAlign(gt).run()}setImage(gt){this.editor.chain().focus().first(({commands:_t})=>[()=>{var Lt;return(null===(Lt=_t.setEditableImage)||void 0===Lt?void 0:Lt.call(_t,{src:gt}))||!1},()=>_t.setImage({src:gt})]).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(gt){this.editor.chain().focus().setFontColor(gt).run()}setBackgroundColor(gt){this.editor.chain().focus().setBackgroundColor(gt).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(gt){return this.editor.isActive(gt)}isActive$(gt){return this.stateChange$.pipe((0,ut.O)(null),(0,k.U)(()=>this.isActive(gt)),(0,mt.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(gt,_t){this.editor.chain().focus().insertTable({cols:gt,rows:_t}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(gt){this.editor.chain().focus().setHeading({level:gt}).run()}setParagraph(gt){this.editor.chain().focus().setParagraph().run(),gt&&this.editor.chain().setMark("textStyle",gt).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(gt){this.editor.commands.setTextSelection(gt)}toggleLink(gt){this.editor.chain().focus().toggleLink({href:gt}).run()}setLink(gt){this.editor.chain().focus().setLink({href:gt}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}focus(){this.editor.chain().focus().run()}setValue(gt){this.editor.commands.setContent(gt)}destroy(){this.editor.destroy()}setCellColor(gt){this.editor.chain().focus().setCellBackground(gt).run()}selectClosest(){const gt=this.editor.state.selection.anchor,{schema:_t,doc:Lt}=this.editor.state,It=(0,m.Yz)(Lt.resolve(gt),_t.marks.link);It&&this.editor.chain().setTextSelection(It).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}setGroup(){this.editor.commands.setGroup()}removeGroup(){this.editor.commands.removeGroup()}setAnchor(gt){this.editor.commands.setAnchor(gt.replace("#",""))}removeAnchor(){this.editor.commands.removeAnchor()}}return pt.\u0275fac=function(gt){return new(gt||pt)(s.LFG(P.ZW))},pt.\u0275prov=s.Yz7({token:pt,factory:pt.\u0275fac}),pt})()},48699:(Jt,Et,d)=>{d.d(Et,{_:()=>T});var T=(()=>{return(s=T||(T={})).Undo="undo",s.Anchor="anchor",s.Size="fontSize",s.Bold="bold",s.Italic="italic",s.Underline="underline",s.Strikethrough="strikeThrough",s.Align="justify",s.List="list",s.Quote="quote",s.Color="foreColor",s.Hilite="hiliteColor",s.Clear="clear",s.Link="link",s.Attach="attach",s.Tex="tex",s.Code="code",s.Img="image",s.HR="insertHorizontalRule",s.Sup="superscript",s.Sub="subscript",s.Table="insertTable",s.MergeCells="mergeCells",s.SplitCells="splitCells",s.RowsColumnsManaging="rowsColumnsManaging",s.Details="details",s.Group="group",T;var s})()},15736:(Jt,Et,d)=>{d.r(Et),d.d(Et,{BackgroundColor:()=>b}),d(74634);const b=d(40256).Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:P})=>P?{style:`background-color: ${P}`}:{},parseHTML:({style:P})=>P.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:P=>({chain:m})=>m().setMark("textStyle",{backgroundColor:P}).run(),unsetBackgroundColor:()=>({chain:P})=>P().setMark("textStyle",{backgroundColor:null}).run()})})},52658:(Jt,Et,d)=>{d.r(Et),d.d(Et,{FontColor:()=>b}),d(74634);const b=d(40256).Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:P})=>P?{style:`color: ${P}`}:{},parseHTML:({style:P})=>P.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:P=>({chain:m})=>m().setMark("textStyle",{fontColor:P}).run(),unsetFontColor:()=>({chain:P})=>P().setMark("textStyle",{fontColor:null}).run()})})},9492:(Jt,Et,d)=>{d.r(Et),d.d(Et,{TuiFontSize:()=>b}),d(74634);const b=d(40256).Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:P})=>P.fontSize,renderHTML:({fontSize:P})=>P?{style:`font-size: ${P}`}:{}}}}]},addCommands:()=>({setFontSize:P=>({chain:m})=>m().setMark("textStyle",{fontSize:P}).run(),unsetFontSize:()=>({chain:P})=>P().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})})},54920:(Jt,Et,d)=>{d.r(Et),d.d(Et,{TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>b,createGroupExtension:()=>P});var T=d(37631),s=d(40256);const b={groupNodeClass:"tui-group-node",groupPointerNodeClass:"tui-group-pointer",nested:!0,draggable:!0,createOnEnter:!1},P=(m={})=>{const{draggable:ut,nested:k,groupNodeClass:mt,groupPointerNodeClass:nt,createOnEnter:at}=Object.assign(Object.assign({},b),m);return s.Node.create({name:"group",draggable:ut,group:"block",content:k?"block+":"block",parseHTML:()=>[{tag:'div[data-type="group"]'}],renderHTML:({HTMLAttributes:pt})=>["div",(0,s.mergeAttributes)(pt,{"data-type":"group"}),0],addNodeView:()=>()=>{const pt=document.createElement("div"),Ot=document.createElement("div");if(pt.classList.add(mt),Ot.setAttribute("data-type","group"),ut){const gt=document.createElement("div");gt.classList.add(nt),gt.innerHTML="",gt.contentEditable="false",pt.append(gt,Ot)}else pt.append(Ot);return{dom:pt,contentDOM:Ot}},addCommands(){return{setGroup:()=>({commands:pt,state:Ot})=>{this.editor.chain().focus().run();const gt=(0,T.Ap)(Ot,""),Lt=`<div data-type="group">${gt.trim().startsWith("<p>")?gt:`<p>${gt}</p>`}</div>`;return pt.insertContent(Lt)},removeGroup:()=>({state:pt,dispatch:Ot})=>(0,T.yU)(pt,Ot,this.name)}},addKeyboardShortcuts(){return at?{Enter:()=>this.editor.commands.setGroup()}:{}}})}},25039:(Jt,Et,d)=>{d.r(Et),d.d(Et,{TUI_EDITOR_MAX_IMAGE_WIDTH:()=>nt,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>mt,TuiImageEditorComponent:()=>at,TuiImageEditorModule:()=>Lt,createImageEditorExtension:()=>_t});var T=d(12057),s=d(74788),b=d(40400),P=d(36692),m=d(66682),ut=d(46782),k=d(60015);const mt=new s.OlP("[TUI_EDITOR_MIN_IMAGE_WIDTH]: Min size of resizable image inside editor",{factory:()=>100}),nt=new s.OlP("[TUI_EDITOR_MAX_IMAGE_WIDTH]: Max size of resizable image inside editor",{factory:()=>1/0});let at=(()=>{class It extends b.d{constructor(ht,X,ct,z){super(),this.minWidth=ht,this.maxWidth=X,this.documentRef=ct,this.destroy$=z,this._width=0,(0,m.T)((0,P.tuiTypedFromEvent)(this.documentRef,"touchend"),(0,P.tuiTypedFromEvent)(this.documentRef,"mouseup")).pipe((0,ut.R)(z)).subscribe(()=>this.updateAttributes({width:this.width}))}get attrs(){var ht;return(null===(ht=this.node)||void 0===ht?void 0:ht.attrs)||{src:""}}get src(){return this.attrs.src}get width(){return this._width||this.attrs.width||0}get alt(){return this.attrs.alt||""}get title(){return this.attrs.title||""}onHorizontalDrag([ht],X){this._width=Math.max(this.minWidth,Math.min(this.maxWidth,this.width+X*ht))}}return It.\u0275fac=function(ht){return new(ht||It)(s.Y36(mt),s.Y36(nt),s.Y36(T.K0),s.Y36(P.TuiDestroyService))},It.\u0275cmp=s.Xpm({type:It,selectors:[["tui-image-editor"]],features:[s._Bn([P.TuiDestroyService]),s.qOj],decls:3,vars:8,consts:[[3,"src","width","alt","title"],[1,"t-border","t-border_right",3,"tuiPan"],[1,"t-border","t-border_left",3,"tuiPan"]],template:function(ht,X){1&ht&&(s._UZ(0,"img",0),s.TgZ(1,"span",1),s.NdJ("tuiPan",function(z){return X.onHorizontalDrag(z,1)}),s.qZA(),s.TgZ(2,"span",2),s.NdJ("tuiPan",function(z){return X.onHorizontalDrag(z,-1)}),s.qZA()),2&ht&&(s.Udp("min-width",X.minWidth,"px")("max-width",X.maxWidth,"px"),s.Q6J("src",X.src,s.LSH)("width",X.width)("alt",X.alt)("title",X.title))},directives:[k.g],styles:['[_nghost-%COMP%]{position:relative;display:inline-block}[_nghost-%COMP%]:hover   .t-border[_ngcontent-%COMP%]:after{opacity:1}.t-border[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;display:flex;width:.75rem;cursor:col-resize;justify-content:center;align-items:center}.t-border_left[_ngcontent-%COMP%]{left:0}.t-border_right[_ngcontent-%COMP%]{right:0}.t-border[_ngcontent-%COMP%]:after{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;content:"";width:50%;height:33%;box-sizing:border-box;border-radius:var(--tui-radius-m);background:var(--tui-base-08);border:1px solid var(--tui-base-03);opacity:0}'],changeDetection:0}),It})();var pt=d(40256);const Ot=[{tag:'img[data-type="image-editor"]'}],gt={src:{default:"",keepOnSplit:!1},width:{default:300,keepOnSplit:!1},alt:{default:"",keepOnSplit:!1},title:{default:"",keepOnSplit:!1}},_t=It=>pt.Node.create({name:"imageEditor",group:"block",atom:!0,draggable:!0,parseHTML:()=>Ot,addAttributes:()=>gt,renderHTML:({HTMLAttributes:Dt})=>["img",(0,pt.mergeAttributes)(Dt,{"data-type":"image-editor"})],addNodeView:()=>(0,b.x)(at,{injector:It}),addCommands(){return{setEditableImage:Dt=>({commands:ht})=>ht.insertContent({type:this.name,attrs:Dt})}}});let Lt=(()=>{class It{}return It.\u0275fac=function(ht){return new(ht||It)},It.\u0275mod=s.oAB({type:It}),It.\u0275inj=s.cJS({imports:[[T.ez,P.TuiPanModule]]}),It})()},12177:(Jt,Et,d)=>{function s(P){return P.isActive("bulletList")||P.isActive("orderedList")}d.r(Et),d.d(Et,{TuiTabExtension:()=>b,tuiIsOrderedOrBulletList:()=>s});const b=d(40256).Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>s(this.editor)?null:this.editor.commands.insertContent("\t")}}})},80726:(Jt,Et,d)=>{d.r(Et),d.d(Et,{StarterKit:()=>Dn});var T=d(40256);const s=/^\s*>\s$/,b=T.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:w}){return["blockquote",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{setBlockquote:()=>({commands:w})=>w.wrapIn(this.name),toggleBlockquote:()=>({commands:w})=>w.toggleWrap(this.name),unsetBlockquote:()=>({commands:w})=>w.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,T.wrappingInputRule)({find:s,type:this.type})]}}),P=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,m=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,ut=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,k=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,mt=T.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:w=>"normal"!==w.style.fontWeight&&null},{style:"font-weight",getAttrs:w=>/^(bold(er)?|[5-9]\d{2,})$/.test(w)&&null}],renderHTML({HTMLAttributes:w}){return["strong",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{setBold:()=>({commands:w})=>w.setMark(this.name),toggleBold:()=>({commands:w})=>w.toggleMark(this.name),unsetBold:()=>({commands:w})=>w.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,T.markInputRule)({find:P,type:this.type}),(0,T.markInputRule)({find:ut,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:m,type:this.type}),(0,T.markPasteRule)({find:k,type:this.type})]}}),nt=/^\s*([-+*])\s$/,at=T.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:w}){return["ul",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{toggleBulletList:()=>({commands:w})=>w.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[(0,T.wrappingInputRule)({find:nt,type:this.type})]}}),pt=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Ot=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,gt=T.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:w}){return["code",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{setCode:()=>({commands:w})=>w.setMark(this.name),toggleCode:()=>({commands:w})=>w.toggleMark(this.name),unsetCode:()=>({commands:w})=>w.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,T.markInputRule)({find:pt,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:Ot,type:this.type})]}});var _t=d(35917),Lt=d(38480);const It=Object.create(null);class Dt{constructor(a,_,v){this.$anchor=a,this.$head=_,this.ranges=v||[new ht(a.min(_),a.max(_))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let a=this.ranges;for(let _=0;_<a.length;_++)if(a[_].$from.pos!=a[_].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(a,_=_t.p2.empty){let v=_.content.lastChild,R=null;for(let kt=0;kt<_.openEnd;kt++)R=v,v=v.lastChild;let q=a.steps.length,st=this.ranges;for(let kt=0;kt<st.length;kt++){let{$from:Kt,$to:ee}=st[kt],ne=a.mapping.slice(q);a.replaceRange(ne.map(Kt.pos),ne.map(ee.pos),kt?_t.p2.empty:_),0==kt&&Nt(a,q,(v?v.isInline:R&&R.isTextblock)?-1:1)}}replaceWith(a,_){let v=a.steps.length,R=this.ranges;for(let q=0;q<R.length;q++){let{$from:st,$to:kt}=R[q],Kt=a.mapping.slice(v),ee=Kt.map(st.pos),ne=Kt.map(kt.pos);q?a.deleteRange(ee,ne):(a.replaceRangeWith(ee,ne,_),Nt(a,v,_.isInline?-1:1))}}static findFrom(a,_,v=!1){let R=a.parent.inlineContent?new z(a):bt(a.node(0),a.parent,a.pos,a.index(),_,v);if(R)return R;for(let q=a.depth-1;q>=0;q--){let st=_<0?bt(a.node(0),a.node(q),a.before(q+1),a.index(q),_,v):bt(a.node(0),a.node(q),a.after(q+1),a.index(q)+1,_,v);if(st)return st}return null}static near(a,_=1){return this.findFrom(a,_)||this.findFrom(a,-_)||new yt(a.node(0))}static atStart(a){return bt(a,a,0,0,1)||new yt(a)}static atEnd(a){return bt(a,a,a.content.size,a.childCount,-1)||new yt(a)}static fromJSON(a,_){if(!_||!_.type)throw new RangeError("Invalid input for Selection.fromJSON");let v=It[_.type];if(!v)throw new RangeError(`No selection type ${_.type} defined`);return v.fromJSON(a,_)}static jsonID(a,_){if(a in It)throw new RangeError("Duplicate use of selection JSON ID "+a);return It[a]=_,_.prototype.jsonID=a,_}getBookmark(){return z.between(this.$anchor,this.$head).getBookmark()}}Dt.prototype.visible=!0;class ht{constructor(a,_){this.$from=a,this.$to=_}}let X=!1;function ct(w){!X&&!w.parent.inlineContent&&(X=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+w.parent.type.name+")"))}class z extends Dt{constructor(a,_=a){ct(a),ct(_),super(a,_)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(a,_){let v=a.resolve(_.map(this.head));if(!v.parent.inlineContent)return Dt.near(v);let R=a.resolve(_.map(this.anchor));return new z(R.parent.inlineContent?R:v,v)}replace(a,_=_t.p2.empty){if(super.replace(a,_),_==_t.p2.empty){let v=this.$from.marksAcross(this.$to);v&&a.ensureMarks(v)}}eq(a){return a instanceof z&&a.anchor==this.anchor&&a.head==this.head}getBookmark(){return new Ct(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(a,_){if("number"!=typeof _.anchor||"number"!=typeof _.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new z(a.resolve(_.anchor),a.resolve(_.head))}static create(a,_,v=_){let R=a.resolve(_);return new this(R,v==_?R:a.resolve(v))}static between(a,_,v){let R=a.pos-_.pos;if((!v||R)&&(v=R>=0?1:-1),!_.parent.inlineContent){let q=Dt.findFrom(_,v,!0)||Dt.findFrom(_,-v,!0);if(!q)return Dt.near(_,v);_=q.$head}return a.parent.inlineContent||(0==R||(a=(Dt.findFrom(a,-v,!0)||Dt.findFrom(a,v,!0)).$anchor).pos<_.pos!=R<0)&&(a=_),new z(a,_)}}Dt.jsonID("text",z);class Ct{constructor(a,_){this.anchor=a,this.head=_}map(a){return new Ct(a.map(this.anchor),a.map(this.head))}resolve(a){return z.between(a.resolve(this.anchor),a.resolve(this.head))}}class xt extends Dt{constructor(a){let _=a.nodeAfter,v=a.node(0).resolve(a.pos+_.nodeSize);super(a,v),this.node=_}map(a,_){let{deleted:v,pos:R}=_.mapResult(this.anchor),q=a.resolve(R);return v?Dt.near(q):new xt(q)}content(){return new _t.p2(_t.HY.from(this.node),0,0)}eq(a){return a instanceof xt&&a.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new At(this.anchor)}static fromJSON(a,_){if("number"!=typeof _.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new xt(a.resolve(_.anchor))}static create(a,_){return new xt(a.resolve(_))}static isSelectable(a){return!a.isText&&!1!==a.type.spec.selectable}}xt.prototype.visible=!1,Dt.jsonID("node",xt);class At{constructor(a){this.anchor=a}map(a){let{deleted:_,pos:v}=a.mapResult(this.anchor);return _?new Ct(v,v):new At(v)}resolve(a){let _=a.resolve(this.anchor),v=_.nodeAfter;return v&&xt.isSelectable(v)?new xt(_):Dt.near(_)}}class yt extends Dt{constructor(a){super(a.resolve(0),a.resolve(a.content.size))}replace(a,_=_t.p2.empty){if(_==_t.p2.empty){a.delete(0,a.doc.content.size);let v=Dt.atStart(a.doc);v.eq(a.selection)||a.setSelection(v)}else super.replace(a,_)}toJSON(){return{type:"all"}}static fromJSON(a){return new yt(a)}map(a){return new yt(a)}eq(a){return a instanceof yt}getBookmark(){return rt}}Dt.jsonID("all",yt);const rt={map(){return this},resolve:w=>new yt(w)};function bt(w,a,_,v,R,q=!1){if(a.inlineContent)return z.create(w,_);for(let st=v-(R>0?0:1);R>0?st<a.childCount:st>=0;st+=R){let kt=a.child(st);if(kt.isAtom){if(!q&&xt.isSelectable(kt))return xt.create(w,_-(R<0?kt.nodeSize:0))}else{let Kt=bt(w,kt,_+R,R<0?kt.childCount:0,R,q);if(Kt)return Kt}_+=kt.nodeSize*R}return null}function Nt(w,a,_){let v=w.steps.length-1;if(v<a)return;let st,R=w.steps[v];(R instanceof Lt.Pu||R instanceof Lt.FC)&&(w.mapping.maps[v].forEach((kt,Kt,ee,ne)=>{null==st&&(st=ne)}),w.setSelection(Dt.near(w.doc.resolve(st),_)))}function lt(w,a){return a&&w?w.bind(a):w}class Mt{constructor(a,_,v){this.name=a,this.init=lt(_.init,v),this.apply=lt(_.apply,v)}}function Bt(w,a,_){for(let v in w){let R=w[v];R instanceof Function?R=R.bind(a):"handleDOMEvents"==v&&(R=Bt(R,a,{})),_[v]=R}return _}new Mt("doc",{init:w=>w.doc||w.schema.topNodeType.createAndFill(),apply:w=>w.doc}),new Mt("selection",{init:(w,a)=>w.selection||Dt.atStart(a.doc),apply:w=>w.selection}),new Mt("storedMarks",{init:w=>w.storedMarks||null,apply:(w,a,_,v)=>v.selection.$cursor?w.storedMarks:null}),new Mt("scrollToSelection",{init:()=>0,apply:(w,a)=>w.scrolledIntoView?a+1:a});class $t{constructor(a){this.spec=a,this.props={},a.props&&Bt(a.props,this,this.props),this.key=a.key?a.key.key:ae("plugin")}getState(a){return a[this.key]}}const qt=Object.create(null);function ae(w){return w in qt?w+"$"+ ++qt[w]:(qt[w]=0,w+"$")}class le{constructor(a="key"){this.key=ae(a)}get(a){return a.config.pluginsByKey[this.key]}getState(a){return a[this.key]}}const Fe=/^```([a-z]+)?[\s\n]$/,Ke=/^~~~([a-z]+)?[\s\n]$/,Qe=T.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:w=>{var a;const{languageClassPrefix:_}=this.options;return[...(null===(a=w.firstElementChild)||void 0===a?void 0:a.classList)||[]].filter(st=>st.startsWith(_)).map(st=>st.replace(_,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:w,HTMLAttributes:a}){return["pre",(0,T.mergeAttributes)(this.options.HTMLAttributes,a),["code",{class:w.attrs.language?this.options.languageClassPrefix+w.attrs.language:null},0]]},addCommands(){return{setCodeBlock:w=>({commands:a})=>a.setNode(this.name,w),toggleCodeBlock:w=>({commands:a})=>a.toggleNode(this.name,"paragraph",w)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:w,$anchor:a}=this.editor.state.selection;return!(!w||a.parent.type.name!==this.name)&&!(1!==a.pos&&a.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:w})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:a}=w,{selection:_}=a,{$from:v,empty:R}=_;if(!R||v.parent.type!==this.type)return!1;const q=v.parentOffset===v.parent.nodeSize-2,st=v.parent.textContent.endsWith("\n\n");return!(!q||!st)&&w.chain().command(({tr:kt})=>(kt.delete(v.pos-2,v.pos),!0)).exitCode().run()},ArrowDown:({editor:w})=>{if(!this.options.exitOnArrowDown)return!1;const{state:a}=w,{selection:_,doc:v}=a,{$from:R,empty:q}=_;if(!q||R.parent.type!==this.type||R.parentOffset!==R.parent.nodeSize-2)return!1;const kt=R.after();return void 0!==kt&&!v.nodeAt(kt)&&w.commands.exitCode()}}},addInputRules(){return[(0,T.textblockTypeInputRule)({find:Fe,type:this.type,getAttributes:w=>({language:w[1]})}),(0,T.textblockTypeInputRule)({find:Ke,type:this.type,getAttributes:w=>({language:w[1]})})]},addProseMirrorPlugins(){return[new $t({key:new le("codeBlockVSCodeHandler"),props:{handlePaste:(w,a)=>{if(!a.clipboardData||this.editor.isActive(this.type.name))return!1;const _=a.clipboardData.getData("text/plain"),v=a.clipboardData.getData("vscode-editor-data"),R=v?JSON.parse(v):void 0,q=null==R?void 0:R.mode;if(!_||!q)return!1;const{tr:st}=w.state;return st.replaceSelectionWith(this.type.create({language:q})),st.setSelection(z.near(st.doc.resolve(Math.max(0,st.selection.from-2)))),st.insertText(_.replace(/\r\n?/g,"\n")),st.setMeta("paste",!0),w.dispatch(st),!0}}})]}}),we=T.Node.create({name:"doc",topNode:!0,content:"block+"});var he=d(62463);function De(w={}){return new he.Sy({view:a=>new Ie(a,w)})}class Ie{constructor(a,_){this.editorView=a,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=_.width||1,this.color=_.color||"black",this.class=_.class,this.handlers=["dragover","dragend","drop","dragleave"].map(v=>{let R=q=>{this[v](q)};return a.dom.addEventListener(v,R),{name:v,handler:R}})}destroy(){this.handlers.forEach(({name:a,handler:_})=>this.editorView.dom.removeEventListener(a,_))}update(a,_){null!=this.cursorPos&&_.doc!=a.state.doc&&(this.cursorPos>a.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(a){a!=this.cursorPos&&(this.cursorPos=a,null==a?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let _,a=this.editorView.state.doc.resolve(this.cursorPos);if(!a.parent.inlineContent){let st=a.nodeBefore,kt=a.nodeAfter;if(st||kt){let Kt=this.editorView.nodeDOM(this.cursorPos-(st?st.nodeSize:0)).getBoundingClientRect(),ee=st?Kt.bottom:Kt.top;st&&kt&&(ee=(ee+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),_={left:Kt.left,right:Kt.right,top:ee-this.width/2,bottom:ee+this.width/2}}}if(!_){let st=this.editorView.coordsAtPos(this.cursorPos);_={left:st.left-this.width/2,right:st.left+this.width/2,top:st.top,bottom:st.bottom}}let R,q,v=this.editorView.dom.offsetParent;if(this.element||(this.element=v.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!v||v==document.body&&"static"==getComputedStyle(v).position)R=-pageXOffset,q=-pageYOffset;else{let st=v.getBoundingClientRect();R=st.left-v.scrollLeft,q=st.top-v.scrollTop}this.element.style.left=_.left-R+"px",this.element.style.top=_.top-q+"px",this.element.style.width=_.right-_.left+"px",this.element.style.height=_.bottom-_.top+"px"}scheduleRemoval(a){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),a)}dragover(a){if(!this.editorView.editable)return;let _=this.editorView.posAtCoords({left:a.clientX,top:a.clientY}),v=_&&_.inside>=0&&this.editorView.state.doc.nodeAt(_.inside),R=v&&v.type.spec.disableDropCursor,q="function"==typeof R?R(this.editorView,_):R;if(_&&!q){let st=_.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(st=(0,Lt.nj)(this.editorView.state.doc,st,this.editorView.dragging.slice),null==st))return this.setCursor(null);this.setCursor(st),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(a){(a.target==this.editorView.dom||!this.editorView.dom.contains(a.relatedTarget))&&this.setCursor(null)}}const Te=T.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[De(this.options)]}});var Ue=d(13903),de=d(43594);class se extends he.Y1{constructor(a){super(a,a)}map(a,_){let v=a.resolve(_.map(this.head));return se.valid(v)?new se(v):he.Y1.near(v)}content(){return _t.p2.empty}eq(a){return a instanceof se&&a.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(a,_){if("number"!=typeof _.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new se(a.resolve(_.pos))}getBookmark(){return new We(this.anchor)}static valid(a){let _=a.parent;if(_.isTextblock||!function(w){for(let a=w.depth;a>=0;a--){let _=w.index(a),v=w.node(a);if(0!=_)for(let R=v.child(_-1);;R=R.lastChild){if(0==R.childCount&&!R.inlineContent||R.isAtom||R.type.spec.isolating)return!0;if(R.inlineContent)return!1}else if(v.type.spec.isolating)return!0}return!0}(a)||!function(w){for(let a=w.depth;a>=0;a--){let _=w.indexAfter(a),v=w.node(a);if(_!=v.childCount)for(let R=v.child(_);;R=R.firstChild){if(0==R.childCount&&!R.inlineContent||R.isAtom||R.type.spec.isolating)return!0;if(R.inlineContent)return!1}else if(v.type.spec.isolating)return!0}return!0}(a))return!1;let v=_.type.spec.allowGapCursor;if(null!=v)return v;let R=_.contentMatchAt(a.index()).defaultType;return R&&R.isTextblock}static findGapCursorFrom(a,_,v=!1){t:for(;;){if(!v&&se.valid(a))return a;let R=a.pos,q=null;for(let st=a.depth;;st--){let kt=a.node(st);if(_>0?a.indexAfter(st)<kt.childCount:a.index(st)>0){q=kt.child(_>0?a.indexAfter(st):a.index(st)-1);break}if(0==st)return null;R+=_;let Kt=a.doc.resolve(R);if(se.valid(Kt))return Kt}for(;;){let st=_>0?q.firstChild:q.lastChild;if(!st){if(q.isAtom&&!q.isText&&!he.qv.isSelectable(q)){a=a.doc.resolve(R+q.nodeSize*_),v=!1;continue t}break}q=st,R+=_;let kt=a.doc.resolve(R);if(se.valid(kt))return kt}return null}}}se.prototype.visible=!1,se.findFrom=se.findGapCursorFrom,he.Y1.jsonID("gapcursor",se);class We{constructor(a){this.pos=a}map(a){return new We(a.map(this.pos))}resolve(a){let _=a.resolve(this.pos);return se.valid(_)?new se(_):he.Y1.near(_)}}const $e=(0,Ue.$)({ArrowLeft:_e("horiz",-1),ArrowRight:_e("horiz",1),ArrowUp:_e("vert",-1),ArrowDown:_e("vert",1)});function _e(w,a){const _="vert"==w?a>0?"down":"up":a>0?"right":"left";return function(v,R,q){let st=v.selection,kt=a>0?st.$to:st.$from,Kt=st.empty;if(st instanceof he.Bs){if(!q.endOfTextblock(_)||0==kt.depth)return!1;Kt=!1,kt=v.doc.resolve(a>0?kt.after():kt.before())}let ee=se.findGapCursorFrom(kt,a,Kt);return!!ee&&(R&&R(v.tr.setSelection(new se(ee))),!0)}}function Ce(w,a,_){if(!w||!w.editable)return!1;let v=w.state.doc.resolve(a);if(!se.valid(v))return!1;let R=w.posAtCoords({left:_.clientX,top:_.clientY});return!(R&&R.inside>-1&&he.qv.isSelectable(w.state.doc.nodeAt(R.inside))||(w.dispatch(w.state.tr.setSelection(new se(v))),0))}function Ae(w,a){if("insertCompositionText"!=a.inputType||!(w.state.selection instanceof se))return!1;let{$from:_}=w.state.selection,v=_.parent.contentMatchAt(_.index()).findWrapping(w.state.schema.nodes.text);if(!v)return!1;let R=_t.HY.empty;for(let st=v.length-1;st>=0;st--)R=_t.HY.from(v[st].createAndFill(null,R));let q=w.state.tr.replace(_.pos,_.pos,new _t.p2(R,0,0));return q.setSelection(he.Bs.near(q.doc.resolve(_.pos+1))),w.dispatch(q),!1}function Q(w){if(!(w.selection instanceof se))return null;let a=document.createElement("div");return a.className="ProseMirror-gapcursor",de.EH.create(w.doc,[de.p.widget(w.selection.head,a,{key:"gapcursor"})])}const E=T.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new he.Sy({props:{decorations:Q,createSelectionBetween:(w,a,_)=>a.pos==_.pos&&se.valid(_)?new se(_):null,handleClick:Ce,handleKeyDown:$e,handleDOMEvents:{beforeinput:Ae}}})],extendNodeSchema(w){var a;return{allowGapCursor:null!==(a=(0,T.callOrReturn)((0,T.getExtensionField)(w,"allowGapCursor",{name:w.name,options:w.options,storage:w.storage})))&&void 0!==a?a:null}}}),A=T.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:w}){return["br",(0,T.mergeAttributes)(this.options.HTMLAttributes,w)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:w,chain:a,state:_,editor:v})=>w.first([()=>w.exitCode(),()=>w.command(()=>{const{selection:R,storedMarks:q}=_;if(R.$from.parent.type.spec.isolating)return!1;const{keepMarks:st}=this.options,{splittableMarks:kt}=v.extensionManager,Kt=q||R.$to.parentOffset&&R.$from.marks();return a().insertContent({type:this.name}).command(({tr:ee,dispatch:ne})=>{if(ne&&Kt&&st){const ie=Kt.filter(ue=>kt.includes(ue.type.name));ee.ensureMarks(ie)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),B=T.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(w=>({tag:`h${w}`,attrs:{level:w}}))},renderHTML({node:w,HTMLAttributes:a}){return[`h${this.options.levels.includes(w.attrs.level)?w.attrs.level:this.options.levels[0]}`,(0,T.mergeAttributes)(this.options.HTMLAttributes,a),0]},addCommands(){return{setHeading:w=>({commands:a})=>!!this.options.levels.includes(w.level)&&a.setNode(this.name,w),toggleHeading:w=>({commands:a})=>!!this.options.levels.includes(w.level)&&a.toggleNode(this.name,"paragraph",w)}},addKeyboardShortcuts(){return this.options.levels.reduce((w,a)=>je(te({},w),{[`Mod-Alt-${a}`]:()=>this.editor.commands.toggleHeading({level:a})}),{})},addInputRules(){return this.options.levels.map(w=>(0,T.textblockTypeInputRule)({find:new RegExp(`^(#{1,${w}})\\s$`),type:this.type,getAttributes:{level:w}}))}});var Z=200,W=function(){};W.prototype.append=function(a){return a.length?(a=W.from(a),!this.length&&a||a.length<Z&&this.leafAppend(a)||this.length<Z&&a.leafPrepend(this)||this.appendInner(a)):this},W.prototype.prepend=function(a){return a.length?W.from(a).append(this):this},W.prototype.appendInner=function(a){return new U(this,a)},W.prototype.slice=function(a,_){return void 0===a&&(a=0),void 0===_&&(_=this.length),a>=_?W.empty:this.sliceInner(Math.max(0,a),Math.min(this.length,_))},W.prototype.get=function(a){if(!(a<0||a>=this.length))return this.getInner(a)},W.prototype.forEach=function(a,_,v){void 0===_&&(_=0),void 0===v&&(v=this.length),_<=v?this.forEachInner(a,_,v,0):this.forEachInvertedInner(a,_,v,0)},W.prototype.map=function(a,_,v){void 0===_&&(_=0),void 0===v&&(v=this.length);var R=[];return this.forEach(function(q,st){return R.push(a(q,st))},_,v),R},W.from=function(a){return a instanceof W?a:a&&a.length?new G(a):W.empty};var G=function(w){function a(v){w.call(this),this.values=v}w&&(a.__proto__=w),(a.prototype=Object.create(w&&w.prototype)).constructor=a;var _={length:{configurable:!0},depth:{configurable:!0}};return a.prototype.flatten=function(){return this.values},a.prototype.sliceInner=function(R,q){return 0==R&&q==this.length?this:new a(this.values.slice(R,q))},a.prototype.getInner=function(R){return this.values[R]},a.prototype.forEachInner=function(R,q,st,kt){for(var Kt=q;Kt<st;Kt++)if(!1===R(this.values[Kt],kt+Kt))return!1},a.prototype.forEachInvertedInner=function(R,q,st,kt){for(var Kt=q-1;Kt>=st;Kt--)if(!1===R(this.values[Kt],kt+Kt))return!1},a.prototype.leafAppend=function(R){if(this.length+R.length<=Z)return new a(this.values.concat(R.flatten()))},a.prototype.leafPrepend=function(R){if(this.length+R.length<=Z)return new a(R.flatten().concat(this.values))},_.length.get=function(){return this.values.length},_.depth.get=function(){return 0},Object.defineProperties(a.prototype,_),a}(W);W.empty=new G([]);var U=function(w){function a(_,v){w.call(this),this.left=_,this.right=v,this.length=_.length+v.length,this.depth=Math.max(_.depth,v.depth)+1}return w&&(a.__proto__=w),(a.prototype=Object.create(w&&w.prototype)).constructor=a,a.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},a.prototype.getInner=function(v){return v<this.left.length?this.left.get(v):this.right.get(v-this.left.length)},a.prototype.forEachInner=function(v,R,q,st){var kt=this.left.length;if(R<kt&&!1===this.left.forEachInner(v,R,Math.min(q,kt),st)||q>kt&&!1===this.right.forEachInner(v,Math.max(R-kt,0),Math.min(this.length,q)-kt,st+kt))return!1},a.prototype.forEachInvertedInner=function(v,R,q,st){var kt=this.left.length;if(R>kt&&!1===this.right.forEachInvertedInner(v,R-kt,Math.max(q,kt)-kt,st+kt)||q<kt&&!1===this.left.forEachInvertedInner(v,Math.min(R,kt),q,st))return!1},a.prototype.sliceInner=function(v,R){if(0==v&&R==this.length)return this;var q=this.left.length;return R<=q?this.left.slice(v,R):v>=q?this.right.slice(v-q,R-q):this.left.slice(v,q).append(this.right.slice(0,R-q))},a.prototype.leafAppend=function(v){var R=this.right.leafAppend(v);if(R)return new a(this.left,R)},a.prototype.leafPrepend=function(v){var R=this.left.leafPrepend(v);if(R)return new a(R,this.right)},a.prototype.appendInner=function(v){return this.left.depth>=Math.max(this.right.depth,v.depth)+1?new a(this.left,new a(this.right,v)):new a(this,v)},a}(W);const Ut=W;class Zt{constructor(a,_){this.items=a,this.eventCount=_}popEvent(a,_){if(0==this.eventCount)return null;let R,q,v=this.items.length;for(;;v--)if(this.items.get(v-1).selection){--v;break}_&&(R=this.remapping(v,this.items.length),q=R.maps.length);let kt,Kt,st=a.tr,ee=[],ne=[];return this.items.forEach((ie,ue)=>{if(!ie.step)return R||(R=this.remapping(v,ue+1),q=R.maps.length),q--,void ne.push(ie);if(R){ne.push(new l(ie.map));let Ye,pe=ie.step.map(R.slice(q));pe&&st.maybeStep(pe).doc&&(Ye=st.mapping.maps[st.mapping.maps.length-1],ee.push(new l(Ye,void 0,void 0,ee.length+ne.length))),q--,Ye&&R.appendMap(Ye,q)}else st.maybeStep(ie.step);return ie.selection?(kt=R?ie.selection.map(R.slice(q)):ie.selection,Kt=new Zt(this.items.slice(0,v).append(ne.reverse().concat(ee)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:Kt,transform:st,selection:kt}}addTransform(a,_,v,R){let q=[],st=this.eventCount,kt=this.items,Kt=!R&&kt.length?kt.get(kt.length-1):null;for(let ne=0;ne<a.steps.length;ne++){let pe,ie=a.steps[ne].invert(a.docs[ne]),ue=new l(a.mapping.maps[ne],ie,_);(pe=Kt&&Kt.merge(ue))&&(ue=pe,ne?q.pop():kt=kt.slice(0,kt.length-1)),q.push(ue),_&&(st++,_=void 0),R||(Kt=ue)}let ee=st-v.depth;return ee>g&&(kt=function(w,a){let _;return w.forEach((v,R)=>{if(v.selection&&0==a--)return _=R,!1}),w.slice(_)}(kt,ee),st-=ee),new Zt(kt.append(q),st)}remapping(a,_){let v=new Lt.vs;return this.items.forEach((R,q)=>{v.appendMap(R.map,null!=R.mirrorOffset&&q-R.mirrorOffset>=a?v.maps.length-R.mirrorOffset:void 0)},a,_),v}addMaps(a){return 0==this.eventCount?this:new Zt(this.items.append(a.map(_=>new l(_))),this.eventCount)}rebased(a,_){if(!this.eventCount)return this;let v=[],R=Math.max(0,this.items.length-_),q=a.mapping,st=a.steps.length,kt=this.eventCount;this.items.forEach(ue=>{ue.selection&&kt--},R);let Kt=_;this.items.forEach(ue=>{let pe=q.getMirror(--Kt);if(null==pe)return;st=Math.min(st,pe);let Ye=q.maps[pe];if(ue.step){let mn=a.steps[pe].invert(a.docs[pe]),Ve=ue.selection&&ue.selection.map(q.slice(Kt+1,pe));Ve&&kt++,v.push(new l(Ye,mn,Ve))}else v.push(new l(Ye))},R);let ee=[];for(let ue=_;ue<st;ue++)ee.push(new l(q.maps[ue]));let ne=this.items.slice(0,R).append(ee).append(v),ie=new Zt(ne,kt);return ie.emptyItemCount()>500&&(ie=ie.compress(this.items.length-v.length)),ie}emptyItemCount(){let a=0;return this.items.forEach(_=>{_.step||a++}),a}compress(a=this.items.length){let _=this.remapping(0,a),v=_.maps.length,R=[],q=0;return this.items.forEach((st,kt)=>{if(kt>=a)R.push(st),st.selection&&q++;else if(st.step){let Kt=st.step.map(_.slice(v)),ee=Kt&&Kt.getMap();if(v--,ee&&_.appendMap(ee,v),Kt){let ne=st.selection&&st.selection.map(_.slice(v));ne&&q++;let ue,ie=new l(ee.invert(),Kt,ne),pe=R.length-1;(ue=R.length&&R[pe].merge(ie))?R[pe]=ue:R.push(ie)}}else st.map&&v--},this.items.length,0),new Zt(Ut.from(R.reverse()),q)}}Zt.empty=new Zt(Ut.empty,0);class l{constructor(a,_,v,R){this.map=a,this.step=_,this.selection=v,this.mirrorOffset=R}merge(a){if(this.step&&a.step&&!a.selection){let _=a.step.merge(this.step);if(_)return new l(_.getMap().invert(),_,this.selection)}}}class u{constructor(a,_,v,R){this.done=a,this.undone=_,this.prevRanges=v,this.prevTime=R}}const g=20;function V(w){let a=[];return w.forEach((_,v,R,q)=>a.push(R,q)),a}function Tt(w,a){if(!w)return null;let _=[];for(let v=0;v<w.length;v+=2){let R=a.map(w[v],1),q=a.map(w[v+1],-1);R<=q&&_.push(R,q)}return _}function Rt(w,a,_,v){let R=Me(a),q=be.get(a).spec.config,st=(v?w.undone:w.done).popEvent(a,R);if(!st)return;let kt=st.selection.resolve(st.transform.doc),Kt=(v?w.done:w.undone).addTransform(st.transform,a.selection.getBookmark(),q,R),ee=new u(v?Kt:st.remaining,v?st.remaining:Kt,null,0);_(st.transform.setSelection(kt).setMeta(be,{redo:v,historyState:ee}).scrollIntoView())}let Vt=!1,Xt=null;function Me(w){let a=w.plugins;if(Xt!=a){Vt=!1,Xt=a;for(let _=0;_<a.length;_++)if(a[_].spec.historyPreserveItems){Vt=!0;break}}return Vt}const be=new he.H$("history"),Rn=new he.H$("closeHistory");function Ge(w={}){return new he.Sy({key:be,state:{init:()=>new u(Zt.empty,Zt.empty,null,0),apply:(a,_,v)=>function(w,a,_,v){let q,R=_.getMeta(be);if(R)return R.historyState;_.getMeta(Rn)&&(w=new u(w.done,w.undone,null,0));let st=_.getMeta("appendedTransaction");if(0==_.steps.length)return w;if(st&&st.getMeta(be))return st.getMeta(be).redo?new u(w.done.addTransform(_,void 0,v,Me(a)),w.undone,V(_.mapping.maps[_.steps.length-1]),w.prevTime):new u(w.done,w.undone.addTransform(_,void 0,v,Me(a)),null,w.prevTime);if(!1===_.getMeta("addToHistory")||st&&!1===st.getMeta("addToHistory"))return(q=_.getMeta("rebased"))?new u(w.done.rebased(_,q),w.undone.rebased(_,q),Tt(w.prevRanges,_.mapping),w.prevTime):new u(w.done.addMaps(_.mapping.maps),w.undone.addMaps(_.mapping.maps),Tt(w.prevRanges,_.mapping),w.prevTime);{let kt=0==w.prevTime||!st&&(w.prevTime<(_.time||0)-v.newGroupDelay||!function(w,a){if(!a)return!1;if(!w.docChanged)return!0;let _=!1;return w.mapping.maps[0].forEach((v,R)=>{for(let q=0;q<a.length;q+=2)v<=a[q+1]&&R>=a[q]&&(_=!0)}),_}(_,w.prevRanges)),Kt=st?Tt(w.prevRanges,_.mapping):V(_.mapping.maps[_.steps.length-1]);return new u(w.done.addTransform(_,kt?a.selection.getBookmark():void 0,v,Me(a)),Zt.empty,Kt,_.time)}}(_,v,a,w)},config:w={depth:w.depth||100,newGroupDelay:w.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(a,_){let v=_.inputType,R="historyUndo"==v?Ln:"historyRedo"==v?vn:null;return!!R&&(_.preventDefault(),R(a.state,a.dispatch))}}}})}const Ln=(w,a)=>{let _=be.getState(w);return!(!_||0==_.done.eventCount||(a&&Rt(_,w,a,!1),0))},vn=(w,a)=>{let _=be.getState(w);return!(!_||0==_.undone.eventCount||(a&&Rt(_,w,a,!0),0))},un=T.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:w,dispatch:a})=>Ln(w,a),redo:()=>({state:w,dispatch:a})=>vn(w,a)}),addProseMirrorPlugins(){return[Ge(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Le=Object.create(null);class fe{constructor(a,_,v){this.$anchor=a,this.$head=_,this.ranges=v||[new Xe(a.min(_),a.max(_))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let a=this.ranges;for(let _=0;_<a.length;_++)if(a[_].$from.pos!=a[_].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(a,_=_t.p2.empty){let v=_.content.lastChild,R=null;for(let kt=0;kt<_.openEnd;kt++)R=v,v=v.lastChild;let q=a.steps.length,st=this.ranges;for(let kt=0;kt<st.length;kt++){let{$from:Kt,$to:ee}=st[kt],ne=a.mapping.slice(q);a.replaceRange(ne.map(Kt.pos),ne.map(ee.pos),kt?_t.p2.empty:_),0==kt&&an(a,q,(v?v.isInline:R&&R.isTextblock)?-1:1)}}replaceWith(a,_){let v=a.steps.length,R=this.ranges;for(let q=0;q<R.length;q++){let{$from:st,$to:kt}=R[q],Kt=a.mapping.slice(v),ee=Kt.map(st.pos),ne=Kt.map(kt.pos);q?a.deleteRange(ee,ne):(a.replaceRangeWith(ee,ne,_),an(a,v,_.isInline?-1:1))}}static findFrom(a,_,v=!1){let R=a.parent.inlineContent?new xe(a):qe(a.node(0),a.parent,a.pos,a.index(),_,v);if(R)return R;for(let q=a.depth-1;q>=0;q--){let st=_<0?qe(a.node(0),a.node(q),a.before(q+1),a.index(q),_,v):qe(a.node(0),a.node(q),a.after(q+1),a.index(q)+1,_,v);if(st)return st}return null}static near(a,_=1){return this.findFrom(a,_)||this.findFrom(a,-_)||new ze(a.node(0))}static atStart(a){return qe(a,a,0,0,1)||new ze(a)}static atEnd(a){return qe(a,a,a.content.size,a.childCount,-1)||new ze(a)}static fromJSON(a,_){if(!_||!_.type)throw new RangeError("Invalid input for Selection.fromJSON");let v=Le[_.type];if(!v)throw new RangeError(`No selection type ${_.type} defined`);return v.fromJSON(a,_)}static jsonID(a,_){if(a in Le)throw new RangeError("Duplicate use of selection JSON ID "+a);return Le[a]=_,_.prototype.jsonID=a,_}getBookmark(){return xe.between(this.$anchor,this.$head).getBookmark()}}fe.prototype.visible=!0;class Xe{constructor(a,_){this.$from=a,this.$to=_}}let bn=!1;function xn(w){!bn&&!w.parent.inlineContent&&(bn=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+w.parent.type.name+")"))}class xe extends fe{constructor(a,_=a){xn(a),xn(_),super(a,_)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(a,_){let v=a.resolve(_.map(this.head));if(!v.parent.inlineContent)return fe.near(v);let R=a.resolve(_.map(this.anchor));return new xe(R.parent.inlineContent?R:v,v)}replace(a,_=_t.p2.empty){if(super.replace(a,_),_==_t.p2.empty){let v=this.$from.marksAcross(this.$to);v&&a.ensureMarks(v)}}eq(a){return a instanceof xe&&a.anchor==this.anchor&&a.head==this.head}getBookmark(){return new ln(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(a,_){if("number"!=typeof _.anchor||"number"!=typeof _.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new xe(a.resolve(_.anchor),a.resolve(_.head))}static create(a,_,v=_){let R=a.resolve(_);return new this(R,v==_?R:a.resolve(v))}static between(a,_,v){let R=a.pos-_.pos;if((!v||R)&&(v=R>=0?1:-1),!_.parent.inlineContent){let q=fe.findFrom(_,v,!0)||fe.findFrom(_,-v,!0);if(!q)return fe.near(_,v);_=q.$head}return a.parent.inlineContent||(0==R||(a=(fe.findFrom(a,-v,!0)||fe.findFrom(a,v,!0)).$anchor).pos<_.pos!=R<0)&&(a=_),new xe(a,_)}}fe.jsonID("text",xe);class ln{constructor(a,_){this.anchor=a,this.head=_}map(a){return new ln(a.map(this.anchor),a.map(this.head))}resolve(a){return xe.between(a.resolve(this.anchor),a.resolve(this.head))}}class ke extends fe{constructor(a){let _=a.nodeAfter,v=a.node(0).resolve(a.pos+_.nodeSize);super(a,v),this.node=_}map(a,_){let{deleted:v,pos:R}=_.mapResult(this.anchor),q=a.resolve(R);return v?fe.near(q):new ke(q)}content(){return new _t.p2(_t.HY.from(this.node),0,0)}eq(a){return a instanceof ke&&a.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Mn(this.anchor)}static fromJSON(a,_){if("number"!=typeof _.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ke(a.resolve(_.anchor))}static create(a,_){return new ke(a.resolve(_))}static isSelectable(a){return!a.isText&&!1!==a.type.spec.selectable}}ke.prototype.visible=!1,fe.jsonID("node",ke);class Mn{constructor(a){this.anchor=a}map(a){let{deleted:_,pos:v}=a.mapResult(this.anchor);return _?new ln(v,v):new Mn(v)}resolve(a){let _=a.resolve(this.anchor),v=_.nodeAfter;return v&&ke.isSelectable(v)?new ke(_):fe.near(_)}}class ze extends fe{constructor(a){super(a.resolve(0),a.resolve(a.content.size))}replace(a,_=_t.p2.empty){if(_==_t.p2.empty){a.delete(0,a.doc.content.size);let v=fe.atStart(a.doc);v.eq(a.selection)||a.setSelection(v)}else super.replace(a,_)}toJSON(){return{type:"all"}}static fromJSON(a){return new ze(a)}map(a){return new ze(a)}eq(a){return a instanceof ze}getBookmark(){return Bn}}fe.jsonID("all",ze);const Bn={map(){return this},resolve:w=>new ze(w)};function qe(w,a,_,v,R,q=!1){if(a.inlineContent)return xe.create(w,_);for(let st=v-(R>0?0:1);R>0?st<a.childCount:st>=0;st+=R){let kt=a.child(st);if(kt.isAtom){if(!q&&ke.isSelectable(kt))return ke.create(w,_-(R<0?kt.nodeSize:0))}else{let Kt=qe(w,kt,_+R,R<0?kt.childCount:0,R,q);if(Kt)return Kt}_+=kt.nodeSize*R}return null}function an(w,a,_){let v=w.steps.length-1;if(v<a)return;let st,R=w.steps[v];(R instanceof Lt.Pu||R instanceof Lt.FC)&&(w.mapping.maps[v].forEach((kt,Kt,ee,ne)=>{null==st&&(st=ne)}),w.setSelection(fe.near(w.doc.resolve(st),_)))}function On(w,a){return a&&w?w.bind(a):w}class tn{constructor(a,_,v){this.name=a,this.init=On(_.init,v),this.apply=On(_.apply,v)}}new tn("doc",{init:w=>w.doc||w.schema.topNodeType.createAndFill(),apply:w=>w.doc}),new tn("selection",{init:(w,a)=>w.selection||fe.atStart(a.doc),apply:w=>w.selection}),new tn("storedMarks",{init:w=>w.storedMarks||null,apply:(w,a,_,v)=>v.selection.$cursor?w.storedMarks:null}),new tn("scrollToSelection",{init:()=>0,apply:(w,a)=>w.scrolledIntoView?a+1:a}),Object.create(null);const I=T.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:w}){return["hr",(0,T.mergeAttributes)(this.options.HTMLAttributes,w)]},addCommands(){return{setHorizontalRule:()=>({chain:w})=>w().insertContent({type:this.name}).command(({tr:a,dispatch:_})=>{var v;if(_){const{$to:R}=a.selection,q=R.end();if(R.nodeAfter)a.setSelection(xe.create(a.doc,R.pos));else{const st=null===(v=R.parent.type.contentMatch.defaultType)||void 0===v?void 0:v.create();st&&(a.insert(q,st),a.setSelection(xe.create(a.doc,q)))}a.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,T.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),N=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,$=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,ot=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,j=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,it=T.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:w=>"normal"!==w.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:w}){return["em",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{setItalic:()=>({commands:w})=>w.setMark(this.name),toggleItalic:()=>({commands:w})=>w.toggleMark(this.name),unsetItalic:()=>({commands:w})=>w.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,T.markInputRule)({find:N,type:this.type}),(0,T.markInputRule)({find:ot,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:$,type:this.type}),(0,T.markPasteRule)({find:j,type:this.type})]}}),St=T.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:w}){return["li",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ht=/^(\d+)\.\s$/,zt=T.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:w=>w.hasAttribute("start")?parseInt(w.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:w}){const v=w,{start:a}=v,_=Fo(v,["start"]);return 1===a?["ol",(0,T.mergeAttributes)(this.options.HTMLAttributes,_),0]:["ol",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{toggleOrderedList:()=>({commands:w})=>w.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[(0,T.wrappingInputRule)({find:Ht,type:this.type,getAttributes:w=>({start:+w[1]}),joinPredicate:(w,a)=>a.childCount+a.attrs.start===+w[1]})]}}),Qt=T.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:w}){return["p",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{setParagraph:()=>({commands:w})=>w.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),jt=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,oe=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,ce=T.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:w=>!!w.includes("line-through")&&{}}],renderHTML({HTMLAttributes:w}){return["s",(0,T.mergeAttributes)(this.options.HTMLAttributes,w),0]},addCommands(){return{setStrike:()=>({commands:w})=>w.setMark(this.name),toggleStrike:()=>({commands:w})=>w.toggleMark(this.name),unsetStrike:()=>({commands:w})=>w.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,T.markInputRule)({find:jt,type:this.type})]},addPasteRules(){return[(0,T.markPasteRule)({find:oe,type:this.type})]}}),Oe=T.Node.create({name:"text",group:"inline"}),Dn=T.Extension.create({name:"starterKit",addExtensions(){var w,a,_,v,R,q,st,kt,Kt,ee,ne,ie,ue,pe,Ye,mn,Ve,Kn,Jn,$n,yn,Zn,Nn,An,Hn,Un,gn,Pn,Sn,In,Yn,sn,Qn,_n,Gn,Xn;const ve=[];return!1!==(null===(w=this.options)||void 0===w?void 0:w.blockquote)&&ve.push(b.configure(null===(a=this.options)||void 0===a?void 0:a.blockquote)),!1!==(null===(_=this.options)||void 0===_?void 0:_.bold)&&ve.push(mt.configure(null===(v=this.options)||void 0===v?void 0:v.bold)),!1!==(null===(R=this.options)||void 0===R?void 0:R.bulletList)&&ve.push(at.configure(null===(q=this.options)||void 0===q?void 0:q.bulletList)),!1!==(null===(st=this.options)||void 0===st?void 0:st.code)&&ve.push(gt.configure(null===(kt=this.options)||void 0===kt?void 0:kt.code)),!1!==(null===(Kt=this.options)||void 0===Kt?void 0:Kt.codeBlock)&&ve.push(Qe.configure(null===(ee=this.options)||void 0===ee?void 0:ee.codeBlock)),!1!==(null===(ne=this.options)||void 0===ne?void 0:ne.document)&&ve.push(we.configure(null===(ie=this.options)||void 0===ie?void 0:ie.document)),!1!==(null===(ue=this.options)||void 0===ue?void 0:ue.dropcursor)&&ve.push(Te.configure(null===(pe=this.options)||void 0===pe?void 0:pe.dropcursor)),!1!==(null===(Ye=this.options)||void 0===Ye?void 0:Ye.gapcursor)&&ve.push(E.configure(null===(mn=this.options)||void 0===mn?void 0:mn.gapcursor)),!1!==(null===(Ve=this.options)||void 0===Ve?void 0:Ve.hardBreak)&&ve.push(A.configure(null===(Kn=this.options)||void 0===Kn?void 0:Kn.hardBreak)),!1!==(null===(Jn=this.options)||void 0===Jn?void 0:Jn.heading)&&ve.push(B.configure(null===($n=this.options)||void 0===$n?void 0:$n.heading)),!1!==(null===(yn=this.options)||void 0===yn?void 0:yn.history)&&ve.push(un.configure(null===(Zn=this.options)||void 0===Zn?void 0:Zn.history)),!1!==(null===(Nn=this.options)||void 0===Nn?void 0:Nn.horizontalRule)&&ve.push(I.configure(null===(An=this.options)||void 0===An?void 0:An.horizontalRule)),!1!==(null===(Hn=this.options)||void 0===Hn?void 0:Hn.italic)&&ve.push(it.configure(null===(Un=this.options)||void 0===Un?void 0:Un.italic)),!1!==(null===(gn=this.options)||void 0===gn?void 0:gn.listItem)&&ve.push(St.configure(null===(Pn=this.options)||void 0===Pn?void 0:Pn.listItem)),!1!==(null===(Sn=this.options)||void 0===Sn?void 0:Sn.orderedList)&&ve.push(zt.configure(null===(In=this.options)||void 0===In?void 0:In.orderedList)),!1!==(null===(Yn=this.options)||void 0===Yn?void 0:Yn.paragraph)&&ve.push(Qt.configure(null===(sn=this.options)||void 0===sn?void 0:sn.paragraph)),!1!==(null===(Qn=this.options)||void 0===Qn?void 0:Qn.strike)&&ve.push(ce.configure(null===(_n=this.options)||void 0===_n?void 0:_n.strike)),!1!==(null===(Gn=this.options)||void 0===Gn?void 0:Gn.text)&&ve.push(Oe.configure(null===(Xn=this.options)||void 0===Xn?void 0:Xn.text)),ve}})},51919:(Jt,Et,d)=>{d.r(Et),d.d(Et,{TableCellBackground:()=>s});const s=d(40256).Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:b})=>b?{style:`background: ${b}`}:null,parseHTML:({style:b})=>b.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:b=>({chain:P})=>P().updateAttributes("tableCell",{background:b}).updateAttributes("tableHeader",{background:b}).run(),unsetCellBackground:()=>({chain:b})=>b().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})})},28279:(Jt,Et,d)=>{d.r(Et),d.d(Et,{TuiTable:()=>Be});var T=d(40256),s=d(62463),b=d(35917),P=d(13903),m=d(43594),ut=d(38480);let k,mt;if("undefined"!=typeof WeakMap){let C=new WeakMap;k=f=>C.get(f),mt=(f,y)=>(C.set(f,y),y)}else{let C=[],f=10,y=0;k=M=>{for(let I=0;I<C.length;I+=2)if(C[I]==M)return C[I+1]},mt=(M,I)=>(y==f&&(y=0),C[y++]=M,C[y++]=I)}class nt{constructor(f,y,M,I){this.left=f,this.top=y,this.right=M,this.bottom=I}}class at{constructor(f,y,M,I){this.width=f,this.height=y,this.map=M,this.problems=I}findCell(f){for(let y=0;y<this.map.length;y++){let M=this.map[y];if(M!=f)continue;let I=y%this.width,N=y/this.width|0,$=I+1,ot=N+1;for(let j=1;$<this.width&&this.map[y+j]==M;j++)$++;for(let j=1;ot<this.height&&this.map[y+this.width*j]==M;j++)ot++;return new nt(I,N,$,ot)}throw new RangeError("No cell with offset "+f+" found")}colCount(f){for(let y=0;y<this.map.length;y++)if(this.map[y]==f)return y%this.width;throw new RangeError("No cell with offset "+f+" found")}nextCell(f,y,M){let{left:I,right:N,top:$,bottom:ot}=this.findCell(f);return"horiz"==y?(M<0?0==I:N==this.width)?null:this.map[$*this.width+(M<0?I-1:N)]:(M<0?0==$:ot==this.height)?null:this.map[I+this.width*(M<0?$-1:ot)]}rectBetween(f,y){let{left:M,right:I,top:N,bottom:$}=this.findCell(f),{left:ot,right:j,top:it,bottom:St}=this.findCell(y);return new nt(Math.min(M,ot),Math.min(N,it),Math.max(I,j),Math.max($,St))}cellsInRect(f){let y=[],M={};for(let I=f.top;I<f.bottom;I++)for(let N=f.left;N<f.right;N++){let $=I*this.width+N,ot=this.map[$];M[ot]||(M[ot]=!0,(N!=f.left||!N||this.map[$-1]!=ot)&&(I!=f.top||!I||this.map[$-this.width]!=ot)&&y.push(ot))}return y}positionAt(f,y,M){for(let I=0,N=0;;I++){let $=N+M.child(I).nodeSize;if(I==f){let ot=y+f*this.width,j=(f+1)*this.width;for(;ot<j&&this.map[ot]<N;)ot++;return ot==j?$-1:this.map[ot]}N=$}}static get(f){return k(f)||mt(f,function(C){if("table"!=C.type.spec.tableRole)throw new RangeError("Not a table node: "+C.type.name);let f=function(C){let f=-1,y=!1;for(let M=0;M<C.childCount;M++){let I=C.child(M),N=0;if(y)for(let $=0;$<M;$++){let ot=C.child($);for(let j=0;j<ot.childCount;j++){let it=ot.child(j);$+it.attrs.rowspan>M&&(N+=it.attrs.colspan)}}for(let $=0;$<I.childCount;$++){let ot=I.child($);N+=ot.attrs.colspan,ot.attrs.rowspan>1&&(y=!0)}-1==f?f=N:f!=N&&(f=Math.max(f,N))}return f}(C),y=C.childCount,M=[],I=0,N=null,$=[];for(let it=0,St=f*y;it<St;it++)M[it]=0;for(let it=0,St=0;it<y;it++){let Ht=C.child(it);St++;for(let jt=0;;jt++){for(;I<M.length&&0!=M[I];)I++;if(jt==Ht.childCount)break;let oe=Ht.child(jt),{colspan:ce,rowspan:Oe,colwidth:Dn}=oe.attrs;for(let w=0;w<Oe;w++){if(w+it>=y){(N||(N=[])).push({type:"overlong_rowspan",pos:St,n:Oe-w});break}let a=I+w*f;for(let _=0;_<ce;_++){0==M[a+_]?M[a+_]=St:(N||(N=[])).push({type:"collision",row:it,pos:St,n:ce-_});let v=Dn&&Dn[_];if(v){let R=(a+_)%f*2,q=$[R];null==q||q!=v&&1==$[R+1]?($[R]=v,$[R+1]=1):q==v&&$[R+1]++}}}I+=ce,St+=oe.nodeSize}let zt=(it+1)*f,Qt=0;for(;I<zt;)0==M[I++]&&Qt++;Qt&&(N||(N=[])).push({type:"missing",row:it,n:Qt}),St++}let ot=new at(f,y,M,N),j=!1;for(let it=0;!j&&it<$.length;it+=2)null!=$[it]&&$[it+1]<y&&(j=!0);return j&&function(C,f,y){C.problems||(C.problems=[]);for(let M=0,I={};M<C.map.length;M++){let N=C.map[M];if(I[N])continue;I[N]=!0;let $=y.nodeAt(N),ot=null;for(let j=0;j<$.attrs.colspan;j++){let St=f[(M+j)%C.width*2];null!=St&&(!$.attrs.colwidth||$.attrs.colwidth[j]!=St)&&((ot||(ot=_t($.attrs)))[j]=St)}ot&&C.problems.unshift({type:"colwidth mismatch",pos:N,colwidth:ot})}}(ot,$,C),ot}(f))}}function _t(C){if(C.colwidth)return C.colwidth.slice();let f=[];for(let y=0;y<C.colspan;y++)f.push(0);return f}function ht(C){let f=C.cached.tableNodeTypes;if(!f){f=C.cached.tableNodeTypes={};for(let y in C.nodes){let M=C.nodes[y],I=M.spec.tableRole;I&&(f[I]=M)}}return f}const X=new s.H$("selectingCells");function ct(C){for(let f=C.depth-1;f>0;f--)if("row"==C.node(f).type.spec.tableRole)return C.node(0).resolve(C.before(f+1));return null}function Ct(C){let f=C.selection.$head;for(let y=f.depth;y>0;y--)if("row"==f.node(y).type.spec.tableRole)return!0;return!1}function xt(C){let f=C.selection;return f.$anchorCell?f.$anchorCell.pos>f.$headCell.pos?f.$anchorCell:f.$headCell:f.node&&"cell"==f.node.type.spec.tableRole?f.$anchor:ct(f.$head)||function(C){for(let f=C.nodeAfter,y=C.pos;f;f=f.firstChild,y++){let M=f.type.spec.tableRole;if("cell"==M||"header_cell"==M)return C.doc.resolve(y)}for(let f=C.nodeBefore,y=C.pos;f;f=f.lastChild,y--){let M=f.type.spec.tableRole;if("cell"==M||"header_cell"==M)return C.doc.resolve(y-f.nodeSize)}}(f.$head)}function yt(C){return"row"==C.parent.type.spec.tableRole&&C.nodeAfter}function bt(C,f){return C.depth==f.depth&&C.pos>=f.start(-1)&&C.pos<=f.end(-1)}function ft(C,f,y){let M=C.start(-1),N=at.get(C.node(-1)).nextCell(C.pos-M,f,y);return null==N?null:C.node(0).resolve(M+N)}function S(C,f,y){let M={};for(let I in C)M[I]=C[I];return M[f]=y,M}function et(C,f,y=1){let M=S(C,"colspan",C.colspan-y);return M.colwidth&&(M.colwidth=M.colwidth.slice(),M.colwidth.splice(f,y),M.colwidth.some(I=>I>0)||(M.colwidth=null)),M}function lt(C,f,y=1){let M=S(C,"colspan",C.colspan+y);if(M.colwidth){M.colwidth=M.colwidth.slice();for(let I=0;I<y;I++)M.colwidth.splice(f,0,0)}return M}class F extends s.Y1{constructor(f,y=f){let M=f.node(-1),I=at.get(M),N=f.start(-1),$=I.rectBetween(f.pos-N,y.pos-N),ot=f.node(0),j=I.cellsInRect($).filter(St=>St!=y.pos-N);j.unshift(y.pos-N);let it=j.map(St=>{let Ht=M.nodeAt(St),zt=St+N+1;return new s.xm(ot.resolve(zt),ot.resolve(zt+Ht.content.size))});super(it[0].$from,it[0].$to,it),this.$anchorCell=f,this.$headCell=y}map(f,y){let M=f.resolve(y.map(this.$anchorCell.pos)),I=f.resolve(y.map(this.$headCell.pos));if(yt(M)&&yt(I)&&bt(M,I)){let N=this.$anchorCell.node(-1)!=M.node(-1);return N&&this.isRowSelection()?F.rowSelection(M,I):N&&this.isColSelection()?F.colSelection(M,I):new F(M,I)}return s.Bs.between(M,I)}content(){let f=this.$anchorCell.node(-1),y=at.get(f),M=this.$anchorCell.start(-1),I=y.rectBetween(this.$anchorCell.pos-M,this.$headCell.pos-M),N={},$=[];for(let j=I.top;j<I.bottom;j++){let it=[];for(let St=j*y.width+I.left,Ht=I.left;Ht<I.right;Ht++,St++){let zt=y.map[St];if(!N[zt]){N[zt]=!0;let Qt=y.findCell(zt),jt=f.nodeAt(zt),oe=I.left-Qt.left,ce=Qt.right-I.right;if(oe>0||ce>0){let Oe=jt.attrs;oe>0&&(Oe=et(Oe,0,oe)),ce>0&&(Oe=et(Oe,Oe.colspan-ce,ce)),jt=Qt.left<I.left?jt.type.createAndFill(Oe):jt.type.create(Oe,jt.content)}if(Qt.top<I.top||Qt.bottom>I.bottom){let Oe=S(jt.attrs,"rowspan",Math.min(Qt.bottom,I.bottom)-Math.max(Qt.top,I.top));jt=Qt.top<I.top?jt.type.createAndFill(Oe):jt.type.create(Oe,jt.content)}it.push(jt)}}$.push(f.child(j).copy(b.HY.from(it)))}const ot=this.isColSelection()&&this.isRowSelection()?f:$;return new b.p2(b.HY.from(ot),1,1)}replace(f,y=b.p2.empty){let M=f.steps.length,I=this.ranges;for(let $=0;$<I.length;$++){let{$from:ot,$to:j}=I[$],it=f.mapping.slice(M);f.replace(it.map(ot.pos),it.map(j.pos),$?b.p2.empty:y)}let N=s.Y1.findFrom(f.doc.resolve(f.mapping.slice(M).map(this.to)),-1);N&&f.setSelection(N)}replaceWith(f,y){this.replace(f,new b.p2(b.HY.from(y),0,0))}forEachCell(f){let y=this.$anchorCell.node(-1),M=at.get(y),I=this.$anchorCell.start(-1),N=M.cellsInRect(M.rectBetween(this.$anchorCell.pos-I,this.$headCell.pos-I));for(let $=0;$<N.length;$++)f(y.nodeAt(N[$]),I+N[$])}isColSelection(){let f=this.$anchorCell.index(-1),y=this.$headCell.index(-1);return!(Math.min(f,y)>0)&&Math.max(f+this.$anchorCell.nodeAfter.attrs.rowspan,y+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(f,y=f){let M=at.get(f.node(-1)),I=f.start(-1),N=M.findCell(f.pos-I),$=M.findCell(y.pos-I),ot=f.node(0);return N.top<=$.top?(N.top>0&&(f=ot.resolve(I+M.map[N.left])),$.bottom<M.height&&(y=ot.resolve(I+M.map[M.width*(M.height-1)+$.right-1]))):($.top>0&&(y=ot.resolve(I+M.map[$.left])),N.bottom<M.height&&(f=ot.resolve(I+M.map[M.width*(M.height-1)+N.right-1]))),new F(f,y)}isRowSelection(){let f=at.get(this.$anchorCell.node(-1)),y=this.$anchorCell.start(-1),M=f.colCount(this.$anchorCell.pos-y),I=f.colCount(this.$headCell.pos-y);return!(Math.min(M,I)>0)&&Math.max(M+this.$anchorCell.nodeAfter.attrs.colspan,I+this.$headCell.nodeAfter.attrs.colspan)==f.width}eq(f){return f instanceof F&&f.$anchorCell.pos==this.$anchorCell.pos&&f.$headCell.pos==this.$headCell.pos}static rowSelection(f,y=f){let M=at.get(f.node(-1)),I=f.start(-1),N=M.findCell(f.pos-I),$=M.findCell(y.pos-I),ot=f.node(0);return N.left<=$.left?(N.left>0&&(f=ot.resolve(I+M.map[N.top*M.width])),$.right<M.width&&(y=ot.resolve(I+M.map[M.width*($.top+1)-1]))):($.left>0&&(y=ot.resolve(I+M.map[$.top*M.width])),N.right<M.width&&(f=ot.resolve(I+M.map[M.width*(N.top+1)-1]))),new F(f,y)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(f,y){return new F(f.resolve(y.anchor),f.resolve(y.head))}static create(f,y,M=y){return new F(f.resolve(y),f.resolve(M))}getBookmark(){return new K(this.$anchorCell.pos,this.$headCell.pos)}}F.prototype.visible=!1,s.Y1.jsonID("cell",F);class K{constructor(f,y){this.anchor=f,this.head=y}map(f){return new K(f.map(this.anchor),f.map(this.head))}resolve(f){let y=f.resolve(this.anchor),M=f.resolve(this.head);return"row"==y.parent.type.spec.tableRole&&"row"==M.parent.type.spec.tableRole&&y.index()<y.parent.childCount&&M.index()<M.parent.childCount&&bt(y,M)?new F(y,M):s.Y1.near(M,1)}}function dt(C){if(!(C.selection instanceof F))return null;let f=[];return C.selection.forEachCell((y,M)=>{f.push(m.p.node(M,M+y.nodeSize,{class:"selectedCell"}))}),m.EH.create(C.doc,f)}function Fe(C,f){let y=C.createAndFill();return new ut.wx(y).replace(0,y.content.size,f).doc}function we(C,f,y,M,I,N,$,ot){if(0==$||$==f.height)return!1;let j=!1;for(let it=I;it<N;it++){let St=$*f.width+it,Ht=f.map[St];if(f.map[St-f.width]==Ht){j=!0;let zt=y.nodeAt(Ht),{top:Qt,left:jt}=f.findCell(Ht);C.setNodeMarkup(C.mapping.slice(ot).map(Ht+M),null,S(zt.attrs,"rowspan",$-Qt)),C.insert(C.mapping.slice(ot).map(f.positionAt($,jt,y)),zt.type.createAndFill(S(zt.attrs,"rowspan",Qt+zt.attrs.rowspan-$))),it+=zt.attrs.colspan-1}}return j}function he(C,f,y,M,I,N,$,ot){if(0==$||$==f.width)return!1;let j=!1;for(let it=I;it<N;it++){let St=it*f.width+$,Ht=f.map[St];if(f.map[St-1]==Ht){j=!0;let zt=y.nodeAt(Ht),Qt=f.colCount(Ht),jt=C.mapping.slice(ot).map(Ht+M);C.setNodeMarkup(jt,null,et(zt.attrs,$-Qt,zt.attrs.colspan-($-Qt))),C.insert(jt+zt.nodeSize,zt.type.createAndFill(et(zt.attrs,0,$-Qt))),it+=zt.attrs.rowspan-1}}return j}function De(C,f,y,M,I){let N=y?C.doc.nodeAt(y-1):C.doc,$=at.get(N),{top:ot,left:j}=M,it=j+I.width,St=ot+I.height,Ht=C.tr,zt=0;function Qt(){N=y?Ht.doc.nodeAt(y-1):Ht.doc,$=at.get(N),zt=Ht.mapping.maps.length}(function(C,f,y,M,I,N,$){let it,St,j=ht(C.doc.type.schema);if(I>f.width)for(let Ht=0,zt=0;Ht<f.height;Ht++){let Qt=y.child(Ht);zt+=Qt.nodeSize;let oe,jt=[];oe=null==Qt.lastChild||Qt.lastChild.type==j.cell?it||(it=j.cell.createAndFill()):St||(St=j.header_cell.createAndFill());for(let ce=f.width;ce<I;ce++)jt.push(oe);C.insert(C.mapping.slice($).map(zt-1+M),jt)}if(N>f.height){let Ht=[];for(let jt=0,oe=(f.height-1)*f.width;jt<Math.max(f.width,I);jt++){let ce=!(jt>=f.width)&&y.nodeAt(f.map[oe+jt]).type==j.header_cell;Ht.push(ce?St||(St=j.header_cell.createAndFill()):it||(it=j.cell.createAndFill()))}let zt=j.row.create(null,b.HY.from(Ht)),Qt=[];for(let jt=f.height;jt<N;jt++)Qt.push(zt);C.insert(C.mapping.slice($).map(M+y.nodeSize-2),Qt)}return!(!it&&!St)})(Ht,$,N,y,it,St,zt)&&Qt(),we(Ht,$,N,y,j,it,ot,zt)&&Qt(),we(Ht,$,N,y,j,it,St,zt)&&Qt(),he(Ht,$,N,y,ot,St,j,zt)&&Qt(),he(Ht,$,N,y,ot,St,it,zt)&&Qt();for(let jt=ot;jt<St;jt++){let oe=$.positionAt(jt,j,N),ce=$.positionAt(jt,it,N);Ht.replace(Ht.mapping.slice(zt).map(oe+y),Ht.mapping.slice(zt).map(ce+y),new b.p2(I.rows[jt-ot],0,0))}Qt(),Ht.setSelection(new F(Ht.doc.resolve(y+$.positionAt(ot,j,N)),Ht.doc.resolve(y+$.positionAt(St-1,it-1,N)))),f(Ht)}const Ie=(0,P.$)({ArrowLeft:Ue("horiz",-1),ArrowRight:Ue("horiz",1),ArrowUp:Ue("vert",-1),ArrowDown:Ue("vert",1),"Shift-ArrowLeft":de("horiz",-1),"Shift-ArrowRight":de("horiz",1),"Shift-ArrowUp":de("vert",-1),"Shift-ArrowDown":de("vert",1),Backspace:se,"Mod-Backspace":se,Delete:se,"Mod-Delete":se});function Te(C,f,y){return!y.eq(C.selection)&&(f&&f(C.tr.setSelection(y).scrollIntoView()),!0)}function Ue(C,f){return(y,M,I)=>{let N=y.selection;if(N instanceof F)return Te(y,M,s.Y1.near(N.$headCell,f));if("horiz"!=C&&!N.empty)return!1;let $=Je(I,C,f);if(null==$)return!1;if("horiz"==C)return Te(y,M,s.Y1.near(y.doc.resolve(N.head+f),f));{let it,ot=y.doc.resolve($),j=ft(ot,C,f);return it=j?s.Y1.near(j,1):f<0?s.Y1.near(y.doc.resolve(ot.before(-1)),-1):s.Y1.near(y.doc.resolve(ot.after(-1)),1),Te(y,M,it)}}}function de(C,f){return(y,M,I)=>{let N=y.selection;if(!(N instanceof F)){let ot=Je(I,C,f);if(null==ot)return!1;N=new F(y.doc.resolve(ot))}let $=ft(N.$headCell,C,f);return!!$&&Te(y,M,new F(N.$anchorCell,$))}}function se(C,f){let y=C.selection;if(!(y instanceof F))return!1;if(f){let M=C.tr,I=ht(C.schema).cell.createAndFill().content;y.forEachCell((N,$)=>{N.content.eq(I)||M.replace(M.mapping.map($+1),M.mapping.map($+N.nodeSize-1),new b.p2(I,0,0))}),M.docChanged&&f(M)}return!0}function We(C,f){let M=ct(C.state.doc.resolve(f));return!!M&&(C.dispatch(C.state.tr.setSelection(new F(M))),!0)}function Ee(C,f,y){if(!Ct(C.state))return!1;let M=function(C){if(!C.size)return null;let{content:f,openStart:y,openEnd:M}=C;for(;1==f.childCount&&(y>0&&M>0||"table"==f.firstChild.type.spec.tableRole);)y--,M--,f=f.firstChild.content;let I=f.firstChild,N=I.type.spec.tableRole,$=I.type.schema,ot=[];if("row"==N)for(let j=0;j<f.childCount;j++){let it=f.child(j).content,St=j?0:Math.max(0,y-1),Ht=j<f.childCount-1?0:Math.max(0,M-1);(St||Ht)&&(it=Fe(ht($).row,new b.p2(it,St,Ht)).content),ot.push(it)}else{if("cell"!=N&&"header_cell"!=N)return null;ot.push(y||M?Fe(ht($).row,new b.p2(f,y,M)).content:f)}return function(C,f){let y=[];for(let I=0;I<f.length;I++){let N=f[I];for(let $=N.childCount-1;$>=0;$--){let{rowspan:ot,colspan:j}=N.child($).attrs;for(let it=I;it<I+ot;it++)y[it]=(y[it]||0)+j}}let M=0;for(let I=0;I<y.length;I++)M=Math.max(M,y[I]);for(let I=0;I<y.length;I++)if(I>=f.length&&f.push(b.HY.empty),y[I]<M){let N=ht(C).cell.createAndFill(),$=[];for(let ot=y[I];ot<M;ot++)$.push(N);f[I]=f[I].append(b.HY.from($))}return{height:f.length,width:M,rows:f}}($,ot)}(y),I=C.state.selection;if(I instanceof F){M||(M={width:1,height:1,rows:[b.HY.from(Fe(ht(C.state.schema).cell,y))]});let N=I.$anchorCell.node(-1),$=I.$anchorCell.start(-1),ot=at.get(N).rectBetween(I.$anchorCell.pos-$,I.$headCell.pos-$);return M=function({width:C,height:f,rows:y},M,I){if(C!=M){let N=[],$=[];for(let ot=0;ot<y.length;ot++){let j=y[ot],it=[];for(let St=N[ot]||0,Ht=0;St<M;Ht++){let zt=j.child(Ht%j.childCount);St+zt.attrs.colspan>M&&(zt=zt.type.create(et(zt.attrs,zt.attrs.colspan,St+zt.attrs.colspan-M),zt.content)),it.push(zt),St+=zt.attrs.colspan;for(let Qt=1;Qt<zt.attrs.rowspan;Qt++)N[ot+Qt]=(N[ot+Qt]||0)+zt.attrs.colspan}$.push(b.HY.from(it))}y=$,C=M}if(f!=I){let N=[];for(let $=0,ot=0;$<I;$++,ot++){let j=[],it=y[ot%f];for(let St=0;St<it.childCount;St++){let Ht=it.child(St);$+Ht.attrs.rowspan>I&&(Ht=Ht.type.create(S(Ht.attrs,"rowspan",Math.max(1,I-Ht.attrs.rowspan)),Ht.content)),j.push(Ht)}N.push(b.HY.from(j))}y=N,f=I}return{width:C,height:f,rows:y}}(M,ot.right-ot.left,ot.bottom-ot.top),De(C.state,C.dispatch,$,ot,M),!0}if(M){let N=xt(C.state),$=N.start(-1);return De(C.state,C.dispatch,$,at.get(N.node(-1)).findCell(N.pos-$),M),!0}return!1}function Re(C,f){if(f.ctrlKey||f.metaKey)return;let M,y=$e(C,f.target);if(f.shiftKey&&C.state.selection instanceof F)I(C.state.selection.$anchorCell,f),f.preventDefault();else if(f.shiftKey&&y&&null!=(M=ct(C.state.selection.$anchor))&&_e(C,f).pos!=M.pos)I(M,f),f.preventDefault();else if(!y)return;function I(ot,j){let it=_e(C,j),St=null==X.getState(C.state);if(!it||!bt(ot,it)){if(!St)return;it=ot}let Ht=new F(ot,it);if(St||!C.state.selection.eq(Ht)){let zt=C.state.tr.setSelection(Ht);St&&zt.setMeta(X,ot.pos),C.dispatch(zt)}}function N(){C.root.removeEventListener("mouseup",N),C.root.removeEventListener("dragstart",N),C.root.removeEventListener("mousemove",$),null!=X.getState(C.state)&&C.dispatch(C.state.tr.setMeta(X,-1))}function $(ot){let it,j=X.getState(C.state);if(null!=j)it=C.state.doc.resolve(j);else if($e(C,ot.target)!=y&&(it=_e(C,f),!it))return N();it&&I(it,ot)}C.root.addEventListener("mouseup",N),C.root.addEventListener("dragstart",N),C.root.addEventListener("mousemove",$)}function Je(C,f,y){if(!(C.state.selection instanceof s.Bs))return null;let{$head:M}=C.state.selection;for(let I=M.depth-1;I>=0;I--){let N=M.node(I);if((y<0?M.index(I):M.indexAfter(I))!=(y<0?0:N.childCount))return null;if("cell"==N.type.spec.tableRole||"header_cell"==N.type.spec.tableRole){let ot=M.before(I);return C.endOfTextblock("vert"==f?y>0?"down":"up":y>0?"right":"left")?ot:null}}return null}function $e(C,f){for(;f&&f!=C.dom;f=f.parentNode)if("TD"==f.nodeName||"TH"==f.nodeName)return f}function _e(C,f){let y=C.posAtCoords({left:f.clientX,top:f.clientY});return y&&y?ct(C.state.doc.resolve(y.pos)):null}const Ce=new s.H$("fix-tables");function Ae(C,f,y,M){let I=C.childCount,N=f.childCount;t:for(let $=0,ot=0;$<N;$++){let j=f.child($);for(let it=ot,St=Math.min(I,$+3);it<St;it++)if(C.child(it)==j){ot=it+1,y+=j.nodeSize;continue t}M(j,y),ot<I&&C.child(ot).sameMarkup(j)?Ae(C.child(ot),j,y+1,M):j.nodesBetween(0,j.content.size,M,y+1),y+=j.nodeSize}}function Q(C,f){let y,M=(I,N)=>{"table"==I.type.spec.tableRole&&(y=function(C,f,y,M){let I=at.get(f);if(!I.problems)return M;M||(M=C.tr);let $,ot,N=[];for(let j=0;j<I.height;j++)N.push(0);for(let j=0;j<I.problems.length;j++){let it=I.problems[j];if("collision"==it.type){let St=f.nodeAt(it.pos);for(let Ht=0;Ht<St.attrs.rowspan;Ht++)N[it.row+Ht]+=it.n;M.setNodeMarkup(M.mapping.map(y+1+it.pos),null,et(St.attrs,St.attrs.colspan-it.n,it.n))}else if("missing"==it.type)N[it.row]+=it.n;else if("overlong_rowspan"==it.type){let St=f.nodeAt(it.pos);M.setNodeMarkup(M.mapping.map(y+1+it.pos),null,S(St.attrs,"rowspan",St.attrs.rowspan-it.n))}else if("colwidth mismatch"==it.type){let St=f.nodeAt(it.pos);M.setNodeMarkup(M.mapping.map(y+1+it.pos),null,S(St.attrs,"colwidth",it.colwidth))}}for(let j=0;j<N.length;j++)N[j]&&(null==$&&($=j),ot=j);for(let j=0,it=y+1;j<I.height;j++){let St=f.child(j),Ht=it+St.nodeSize,zt=N[j];if(zt>0){let Qt="cell";St.firstChild&&(Qt=St.firstChild.type.spec.tableRole);let jt=[];for(let ce=0;ce<zt;ce++)jt.push(ht(C.schema)[Qt].createAndFill());M.insert(M.mapping.map(0!=j&&$!=j-1||ot!=j?Ht-1:it+1),jt)}it=Ht}return M.setMeta(Ce,{fixTables:!0})}(C,I,N,y))};return f?f.doc!=C.doc&&Ae(f.doc,C.doc,0,M):C.doc.descendants(M),y}function A(C){let $,f=C.selection,y=xt(C),M=y.node(-1),I=y.start(-1),N=at.get(M);return $=f instanceof F?N.rectBetween(f.$anchorCell.pos-I,f.$headCell.pos-I):N.findCell(y.pos-I),$.tableStart=I,$.map=N,$.table=M,$}function B(C,{map:f,tableStart:y,table:M},I){let N=I>0?-1:0;(function(C,f,y){let M=ht(f.type.schema).header_cell;for(let I=0;I<C.height;I++)if(f.nodeAt(C.map[y+I*C.width]).type!=M)return!1;return!0})(f,M,I+N)&&(N=0==I||I==f.width?null:0);for(let $=0;$<f.height;$++){let ot=$*f.width+I;if(I>0&&I<f.width&&f.map[ot-1]==f.map[ot]){let j=f.map[ot],it=M.nodeAt(j);C.setNodeMarkup(C.mapping.map(y+j),null,lt(it.attrs,I-f.colCount(j))),$+=it.attrs.rowspan-1}else{let j=null==N?ht(M.type.schema).cell:M.nodeAt(f.map[ot+N]).type,it=f.positionAt($,I,M);C.insert(C.mapping.map(y+it),j.createAndFill())}}return C}function G(C,{map:f,table:y,tableStart:M},I){let N=C.mapping.maps.length;for(let $=0;$<f.height;){let ot=$*f.width+I,j=f.map[ot],it=y.nodeAt(j);if(I>0&&f.map[ot-1]==j||I<f.width-1&&f.map[ot+1]==j)C.setNodeMarkup(C.mapping.slice(N).map(M+j),null,et(it.attrs,I-f.colCount(j)));else{let St=C.mapping.slice(N).map(M+j);C.delete(St,St+it.nodeSize)}$+=it.attrs.rowspan}}function Ut(C,{map:f,tableStart:y,table:M},I){let N=y;for(let j=0;j<I;j++)N+=M.child(j).nodeSize;let $=[],ot=I>0?-1:0;(function(C,f,y){let M=ht(f.type.schema).header_cell;for(let I=0;I<C.width;I++)if(f.nodeAt(C.map[I+y*C.width]).type!=M)return!1;return!0})(f,M,I+ot)&&(ot=0==I||I==f.height?null:0);for(let j=0,it=f.width*I;j<f.width;j++,it++)if(I>0&&I<f.height&&f.map[it]==f.map[it-f.width]){let St=f.map[it],Ht=M.nodeAt(St).attrs;C.setNodeMarkup(y+St,null,S(Ht,"rowspan",Ht.rowspan+1)),j+=Ht.colspan-1}else{let St=null==ot?ht(M.type.schema).cell:M.nodeAt(f.map[it+ot*f.width]).type;$.push(St.createAndFill())}return C.insert(N,ht(M.type.schema).row.create(null,$)),C}function H(C,{map:f,table:y,tableStart:M},I){let N=0;for(let j=0;j<I;j++)N+=y.child(j).nodeSize;let $=N+y.child(I).nodeSize,ot=C.mapping.maps.length;C.delete(N+M,$+M);for(let j=0,it=I*f.width;j<f.width;j++,it++){let St=f.map[it];if(I>0&&St==f.map[it-f.width]){let Ht=y.nodeAt(St).attrs;C.setNodeMarkup(C.mapping.slice(ot).map(St+M),null,S(Ht,"rowspan",Ht.rowspan-1)),j+=Ht.colspan-1}else if(I<f.width&&St==f.map[it+f.width]){let Ht=y.nodeAt(St),zt=Ht.type.create(S(Ht.attrs,"rowspan",Ht.attrs.rowspan-1),Ht.content),Qt=f.positionAt(I+1,j,y);C.insert(C.mapping.slice(ot).map(M+Qt),zt),j+=Ht.attrs.colspan-1}}}function u(C){let f=C.content;return 1==f.childCount&&f.firstChild.isTextblock&&0==f.firstChild.childCount}function D(C,f){let y=C.selection;if(!(y instanceof F)||y.$anchorCell.pos==y.$headCell.pos)return!1;let M=A(C),{map:I}=M;if(function({width:C,height:f,map:y},M){let I=M.top*C+M.left,N=I,$=(M.bottom-1)*C+M.left,ot=I+(M.right-M.left-1);for(let j=M.top;j<M.bottom;j++){if(M.left>0&&y[N]==y[N-1]||M.right<C&&y[ot]==y[ot+1])return!0;N+=C,ot+=C}for(let j=M.left;j<M.right;j++){if(M.top>0&&y[I]==y[I-C]||M.bottom<f&&y[$]==y[$+C])return!0;I++,$++}return!1}(I,M))return!1;if(f){let j,it,N=C.tr,$={},ot=b.HY.empty;for(let St=M.top;St<M.bottom;St++)for(let Ht=M.left;Ht<M.right;Ht++){let zt=I.map[St*I.width+Ht],Qt=M.table.nodeAt(zt);if(!$[zt])if($[zt]=!0,null==j)j=zt,it=Qt;else{u(Qt)||(ot=ot.append(Qt.content));let jt=N.mapping.map(zt+M.tableStart);N.delete(jt,jt+Qt.nodeSize)}}if(N.setNodeMarkup(j+M.tableStart,null,S(lt(it.attrs,it.attrs.colspan,M.right-M.left-it.attrs.colspan),"rowspan",M.bottom-M.top)),ot.size){let St=j+1+it.content.size,Ht=u(it)?j+1:St;N.replaceWith(Ht+M.tableStart,St+M.tableStart,ot)}N.setSelection(new F(N.doc.resolve(j+M.tableStart))),f(N)}return!0}function L(C,f){const y=ht(C.schema);return function(C){return(f,y)=>{let I,N,M=f.selection;if(M instanceof F){if(M.$anchorCell.pos!=M.$headCell.pos)return!1;I=M.$anchorCell.nodeAfter,N=M.$anchorCell.pos}else{if(I=function(C){for(let f=C.depth;f>0;f--){const y=C.node(f).type.spec.tableRole;if("cell"===y||"header_cell"===y)return C.node(f)}return null}(M.$from),!I)return!1;N=ct(M.$from).pos}if(1==I.attrs.colspan&&1==I.attrs.rowspan)return!1;if(y){let $=I.attrs,ot=[],j=$.colwidth;$.rowspan>1&&($=S($,"rowspan",1)),$.colspan>1&&($=S($,"colspan",1));let Ht,it=A(f),St=f.tr;for(let zt=0;zt<it.right-it.left;zt++)ot.push(j?S($,"colwidth",j&&j[zt]?[j[zt]]:null):$);for(let zt=it.top;zt<it.bottom;zt++){let Qt=it.map.positionAt(zt,it.left,it.table);zt==it.top&&(Qt+=I.nodeSize);for(let jt=it.left,oe=0;jt<it.right;jt++,oe++)jt==it.left&&zt==it.top||St.insert(Ht=St.mapping.map(Qt+it.tableStart,1),C({node:I,row:zt,col:jt}).createAndFill(ot[oe]))}St.setNodeMarkup(N,C({node:I,row:it.top,col:it.left}),ot[0]),M instanceof F&&St.setSelection(new F(St.doc.resolve(M.$anchorCell.pos),Ht&&St.doc.resolve(Ht))),y(St)}return!0}}(({node:M})=>y[M.type.spec.tableRole])(C,f)}function Vt(C,f,y){const M=f.map.cellsInRect({left:0,top:0,right:"row"==C?f.map.width:1,bottom:"column"==C?f.map.height:1});for(let I=0;I<M.length;I++){const N=f.table.nodeAt(M[I]);if(N&&N.type!==y.header_cell)return!1}return!0}function Xt(C,f){return(f=f||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(C){return function(f,y){if(!Ct(f))return!1;if(y){let M=ht(f.schema),I=A(f),N=f.tr,$=I.map.cellsInRect("column"==C?new nt(I.left,0,I.right,I.map.height):"row"==C?new nt(0,I.top,I.map.width,I.bottom):I),ot=$.map(j=>I.table.nodeAt(j));for(let j=0;j<$.length;j++)ot[j].type==M.header_cell&&N.setNodeMarkup(I.tableStart+$[j],M.cell,ot[j].attrs);if(0==N.steps.length)for(let j=0;j<$.length;j++)N.setNodeMarkup(I.tableStart+$[j],M.header_cell,ot[j].attrs);y(N)}return!0}}(C):function(y,M){if(!Ct(y))return!1;if(M){let I=ht(y.schema),N=A(y),$=y.tr,ot=Vt("row",N,I),j=Vt("column",N,I),St=("column"===C?ot:"row"===C&&j)?1:0,Ht="column"==C?new nt(0,St,1,N.map.height):"row"==C?new nt(St,0,N.map.width,1):N,zt="column"==C?j?I.cell:I.header_cell:"row"==C?ot?I.cell:I.header_cell:I.cell;N.map.cellsInRect(Ht).forEach(Qt=>{const jt=Qt+N.tableStart,oe=$.doc.nodeAt(jt);oe&&$.setNodeMarkup(jt,zt,oe.attrs)}),M($)}return!0}}Xt("row",{useDeprecatedLogic:!0}),Xt("column",{useDeprecatedLogic:!0});let be=Xt("cell",{useDeprecatedLogic:!0});function Ge(C){return function(f,y){if(!Ct(f))return!1;let M=function(C,f){if(f<0){let y=C.nodeBefore;if(y)return C.pos-y.nodeSize;for(let M=C.index(-1)-1,I=C.before();M>=0;M--){let N=C.node(-1).child(M);if(N.childCount)return I-1-N.lastChild.nodeSize;I-=N.nodeSize}}else{if(C.index()<C.parent.childCount-1)return C.pos+C.nodeAfter.nodeSize;let y=C.node(-1);for(let M=C.indexAfter(-1),I=C.after();M<y.childCount;M++){let N=y.child(M);if(N.childCount)return I+1;I+=N.nodeSize}}}(xt(f),C);if(null!=M){if(y){let I=f.doc.resolve(M);y(f.tr.setSelection(s.Bs.between(I,function(C){return C.node(0).resolve(C.pos+C.nodeAfter.nodeSize)}(I))).scrollIntoView())}return!0}}}class vn{constructor(f,y){this.node=f,this.cellMinWidth=y,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),dn(f,this.colgroup,this.table,y),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(f){return f.type==this.node.type&&(this.node=f,dn(f,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(f){return"attributes"==f.type&&(f.target==this.table||this.colgroup.contains(f.target))}}function dn(C,f,y,M,I,N){let $=0,ot=!0,j=f.firstChild,it=C.firstChild;for(let St=0,Ht=0;St<it.childCount;St++){let{colspan:zt,colwidth:Qt}=it.child(St).attrs;for(let jt=0;jt<zt;jt++,Ht++){let oe=I==Ht?N:Qt&&Qt[jt],ce=oe?oe+"px":"";$+=oe||M,oe||(ot=!1),j?(j.style.width!=ce&&(j.style.width=ce),j=j.nextSibling):f.appendChild(document.createElement("col")).style.width=ce}}for(;j;){let St=j.nextSibling;j.parentNode.removeChild(j),j=St}ot?(y.style.width=$+"px",y.style.minWidth=""):(y.style.width="",y.style.minWidth=$+"px")}const ge=new s.H$("tableColumnResizing");function un({handleWidth:C=5,cellMinWidth:f=25,View:y=vn,lastColumnResizable:M=!0}={}){return new s.Sy({key:ge,state:{init(N,$){return this.spec.props.nodeViews[ht($.schema).table.name]=(ot,j)=>new y(ot,f,j),new Le(-1,!1)},apply:(N,$)=>$.apply(N)},props:{attributes:N=>ge.getState(N).activeHandle>-1?{class:"resize-cursor"}:null,handleDOMEvents:{mousemove(N,$){!function(C,f,y,M,I){let N=ge.getState(C.state);if(!N.dragging){let $=function(C){for(;C&&"TD"!=C.nodeName&&"TH"!=C.nodeName;)C=C.classList.contains("ProseMirror")?null:C.parentNode;return C}(f.target),ot=-1;if($){let{left:j,right:it}=$.getBoundingClientRect();f.clientX-j<=y?ot=ln(C,f,"left"):it-f.clientX<=y&&(ot=ln(C,f,"right"))}if(ot!=N.activeHandle){if(!I&&-1!==ot){let j=C.state.doc.resolve(ot),it=j.node(-1),St=at.get(it),Ht=j.start(-1);if(St.colCount(j.pos-Ht)+j.nodeAfter.attrs.colspan-1==St.width-1)return}Mn(C,ot)}}}(N,$,C,0,M)},mouseleave(N){!function(C){let f=ge.getState(C.state);f.activeHandle>-1&&!f.dragging&&Mn(C,-1)}(N)},mousedown(N,$){!function(C,f,y){let M=ge.getState(C.state);if(-1==M.activeHandle||M.dragging)return!1;let I=C.state.doc.nodeAt(M.activeHandle),N=function(C,f,{colspan:y,colwidth:M}){let I=M&&M[M.length-1];if(I)return I;let N=C.domAtPos(f),ot=N.node.childNodes[N.offset].offsetWidth,j=y;if(M)for(let it=0;it<y;it++)M[it]&&(ot-=M[it],j--);return ot/j}(C,M.activeHandle,I.attrs);function $(j){window.removeEventListener("mouseup",$),window.removeEventListener("mousemove",ot);let it=ge.getState(C.state);it.dragging&&(function(C,f,y){let M=C.state.doc.resolve(f),I=M.node(-1),N=at.get(I),$=M.start(-1),ot=N.colCount(M.pos-$)+M.nodeAfter.attrs.colspan-1,j=C.state.tr;for(let it=0;it<N.height;it++){let St=it*N.width+ot;if(it&&N.map[St]==N.map[St-N.width])continue;let Ht=N.map[St],{attrs:zt}=I.nodeAt(Ht),Qt=1==zt.colspan?0:ot-N.colCount(Ht);if(zt.colwidth&&zt.colwidth[Qt]==y)continue;let jt=zt.colwidth?zt.colwidth.slice():qe(zt.colspan);jt[Qt]=y,j.setNodeMarkup($+Ht,null,S(zt,"colwidth",jt))}j.docChanged&&C.dispatch(j)}(C,it.activeHandle,ke(it.dragging,j,y)),C.dispatch(C.state.tr.setMeta(ge,{setDragging:null})))}function ot(j){if(!j.which)return $(j);let it=ge.getState(C.state),St=ke(it.dragging,j,y);!function(C,f,y,M){let I=C.state.doc.resolve(f),N=I.node(-1),$=I.start(-1),ot=at.get(N).colCount(I.pos-$)+I.nodeAfter.attrs.colspan-1,j=C.domAtPos(I.start(-1)).node;for(;"TABLE"!=j.nodeName;)j=j.parentNode;dn(N,j.firstChild,j,M,ot,y)}(C,it.activeHandle,St,y)}C.dispatch(C.state.tr.setMeta(ge,{setDragging:{startX:f.clientX,startWidth:N}})),window.addEventListener("mouseup",$),window.addEventListener("mousemove",ot),f.preventDefault()}(N,$,f)}},decorations(N){let $=ge.getState(N);if($.activeHandle>-1)return function(C,f){let y=[],M=C.doc.resolve(f),I=M.node(-1),N=at.get(I),$=M.start(-1),ot=N.colCount(M.pos-$)+M.nodeAfter.attrs.colspan;for(let j=0;j<N.height;j++){let it=ot+j*N.width-1;if(!(ot!=N.width&&N.map[it]==N.map[it+1]||0!=j&&N.map[it-1]==N.map[it-1-N.width])){let St=N.map[it],Ht=$+St+I.nodeAt(St).nodeSize-1,zt=document.createElement("div");zt.className="column-resize-handle",y.push(m.p.widget(Ht,zt))}}return m.EH.create(C.doc,y)}(N,$.activeHandle)},nodeViews:{}}})}class Le{constructor(f,y){this.activeHandle=f,this.dragging=y}apply(f){let y=this,M=f.getMeta(ge);if(M&&null!=M.setHandle)return new Le(M.setHandle,null);if(M&&void 0!==M.setDragging)return new Le(y.activeHandle,M.setDragging);if(y.activeHandle>-1&&f.docChanged){let I=f.mapping.map(y.activeHandle,-1);yt(f.doc.resolve(I))||(I=null),y=new Le(I,y.dragging)}return y}}function ln(C,f,y){let M=C.posAtCoords({left:f.clientX,top:f.clientY});if(!M)return-1;let{pos:I}=M,N=ct(C.state.doc.resolve(I));if(!N)return-1;if("right"==y)return N.pos;let $=at.get(N.node(-1)),ot=N.start(-1),j=$.map.indexOf(N.pos-ot);return j%$.width==0?-1:ot+$.map[j-1]}function ke(C,f,y){return Math.max(y,C.startWidth+(f.clientX-C.startX))}function Mn(C,f){C.dispatch(C.state.tr.setMeta(ge,{setHandle:f}))}function qe(C){let f=[];for(let y=0;y<C;y++)f.push(0);return f}function pn({allowTableNodeSelection:C=!1}={}){return new s.Sy({key:X,state:{init:()=>null,apply(f,y){let M=f.getMeta(X);if(null!=M)return-1==M?null:M;if(null==y||!f.docChanged)return y;let{deleted:I,pos:N}=f.mapping.mapResult(y);return I?null:N}},props:{decorations:dt,handleDOMEvents:{mousedown:Re},createSelectionBetween(f){if(null!=X.getState(f.state))return f.state.selection},handleTripleClick:We,handleKeyDown:Ie,handlePaste:Ee},appendTransaction:(f,y,M)=>function(C,f,y){let N,$,M=(f||C).selection,I=(f||C).doc;if(M instanceof s.qv&&($=M.node.type.spec.tableRole)){if("cell"==$||"header_cell"==$)N=F.create(I,M.from);else if("row"==$){let ot=I.resolve(M.from+1);N=F.rowSelection(ot,ot)}else if(!y){let ot=at.get(M.node),j=M.from+1;N=F.create(I,j+1,j+ot.map[ot.width*ot.height-1])}}else M instanceof s.Bs&&function({$from:C,$to:f}){if(C.pos==f.pos||C.pos<C.pos-6)return!1;let y=C.pos,M=f.pos,I=C.depth;for(;I>=0&&!(C.after(I+1)<C.end(I));I--,y++);for(let N=f.depth;N>=0&&!(f.before(N+1)>f.start(N));N--,M--);return y==M&&/row|table/.test(C.node(I).type.spec.tableRole)}(M)?N=s.Bs.create(I,M.from):M instanceof s.Bs&&function({$from:C,$to:f}){let y,M;for(let I=C.depth;I>0;I--){let N=C.node(I);if("cell"===N.type.spec.tableRole||"header_cell"===N.type.spec.tableRole){y=N;break}}for(let I=f.depth;I>0;I--){let N=f.node(I);if("cell"===N.type.spec.tableRole||"header_cell"===N.type.spec.tableRole){M=N;break}}return y!==M&&0===f.parentOffset}(M)&&(N=s.Bs.create(I,M.$from.start(),M.$from.end()));return N&&(f||(f=C.tr)).setSelection(N),f}(M,Q(M,y),C)})}function hn(C,f,y,M,I,N){let $=0,ot=!0,j=f.firstChild;const it=C.firstChild;for(let St=0,Ht=0;St<it.childCount;St+=1){const{colspan:zt,colwidth:Qt}=it.child(St).attrs;for(let jt=0;jt<zt;jt+=1,Ht+=1){const oe=I===Ht?N:Qt&&Qt[jt],ce=oe?`${oe}px`:"";$+=oe||M,oe||(ot=!1),j?(j.style.width!==ce&&(j.style.width=ce),j=j.nextSibling):f.appendChild(document.createElement("col")).style.width=ce}}for(;j;){const St=j.nextSibling;j.parentNode.removeChild(j),j=St}ot?(y.style.width=`${$}px`,y.style.minWidth=""):(y.style.width="",y.style.minWidth=`${$}px`)}class on{constructor(f,y){this.node=f,this.cellMinWidth=y,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),hn(f,this.colgroup,this.table,y),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(f){return f.type===this.node.type&&(this.node=f,hn(f,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(f){return"attributes"===f.type&&(f.target===this.table||this.colgroup.contains(f.target))}}function ye(C,f){return f?C.createChecked(null,f):C.createAndFill()}const Ze=({editor:C})=>{const{selection:f}=C.state;if(!function(C){return C instanceof F}(f))return!1;let y=0;const M=(0,T.findParentNodeClosestToPos)(f.ranges[0].$from,N=>"table"===N.type.name);return null==M||M.node.descendants(N=>{if("table"===N.type.name)return!1;["tableCell","tableHeader"].includes(N.type.name)&&(y+=1)}),y===f.ranges.length&&(C.commands.deleteTable(),!0)},Be=T.Node.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:on,lastColumnResizable:!0,allowTableNodeSelection:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({HTMLAttributes:C}){return["table",(0,T.mergeAttributes)(this.options.HTMLAttributes,C),["tbody",0]]},addCommands:()=>({insertTable:({rows:C=3,cols:f=3,withHeaderRow:y=!0}={})=>({tr:M,dispatch:I,editor:N})=>{const $=function(C,f,y,M,I){const N=function(C){if(C.cached.tableNodeTypes)return C.cached.tableNodeTypes;const f={};return Object.keys(C.nodes).forEach(y=>{const M=C.nodes[y];M.spec.tableRole&&(f[M.spec.tableRole]=M)}),C.cached.tableNodeTypes=f,f}(C),$=[],ot=[];for(let it=0;it<y;it+=1){const St=ye(N.cell,I);if(St&&ot.push(St),M){const Ht=ye(N.header_cell,I);Ht&&$.push(Ht)}}const j=[];for(let it=0;it<f;it+=1)j.push(N.row.createChecked(null,M&&0===it?$:ot));return N.table.createChecked(null,j)}(N.schema,C,f,y);if(I){const ot=M.selection.anchor+1;M.replaceSelectionWith($).scrollIntoView().setSelection(s.Bs.near(M.doc.resolve(ot)))}return!0},addColumnBefore:()=>({state:C,dispatch:f})=>function(C,f){if(!Ct(C))return!1;if(f){let y=A(C);f(B(C.tr,y,y.left))}return!0}(C,f),addColumnAfter:()=>({state:C,dispatch:f})=>function(C,f){if(!Ct(C))return!1;if(f){let y=A(C);f(B(C.tr,y,y.right))}return!0}(C,f),deleteColumn:()=>({state:C,dispatch:f})=>function(C,f){if(!Ct(C))return!1;if(f){let y=A(C),M=C.tr;if(0==y.left&&y.right==y.map.width)return!1;for(let I=y.right-1;G(M,y,I),I!=y.left;I--)y.table=y.tableStart?M.doc.nodeAt(y.tableStart-1):M.doc,y.map=at.get(y.table);f(M)}return!0}(C,f),addRowBefore:()=>({state:C,dispatch:f})=>function(C,f){if(!Ct(C))return!1;if(f){let y=A(C);f(Ut(C.tr,y,y.top))}return!0}(C,f),addRowAfter:()=>({state:C,dispatch:f})=>function(C,f){if(!Ct(C))return!1;if(f){let y=A(C);f(Ut(C.tr,y,y.bottom))}return!0}(C,f),deleteRow:()=>({state:C,dispatch:f})=>function(C,f){if(!Ct(C))return!1;if(f){let y=A(C),M=C.tr;if(0==y.top&&y.bottom==y.map.height)return!1;for(let I=y.bottom-1;H(M,y,I),I!=y.top;I--)y.table=y.tableStart?M.doc.nodeAt(y.tableStart-1):M.doc,y.map=at.get(y.table);f(M)}return!0}(C,f),deleteTable:()=>({state:C,dispatch:f})=>function(C,f){let y=C.selection.$anchor;for(let M=y.depth;M>0;M--)if("table"==y.node(M).type.spec.tableRole)return f&&f(C.tr.delete(y.before(M),y.after(M)).scrollIntoView()),!0;return!1}(C,f),mergeCells:()=>({state:C,dispatch:f})=>D(C,f),splitCell:()=>({state:C,dispatch:f})=>L(C,f),toggleHeaderColumn:()=>({state:C,dispatch:f})=>Xt("column")(C,f),toggleHeaderRow:()=>({state:C,dispatch:f})=>Xt("row")(C,f),toggleHeaderCell:()=>({state:C,dispatch:f})=>be(C,f),mergeOrSplit:()=>({state:C,dispatch:f})=>!!D(C,f)||L(C,f),setCellAttribute:(C,f)=>({state:y,dispatch:M})=>function(C,f){return function(y,M){if(!Ct(y))return!1;let I=xt(y);if(I.nodeAfter.attrs[C]===f)return!1;if(M){let N=y.tr;y.selection instanceof F?y.selection.forEachCell(($,ot)=>{$.attrs[C]!==f&&N.setNodeMarkup(ot,null,S($.attrs,C,f))}):N.setNodeMarkup(I.pos,null,S(I.nodeAfter.attrs,C,f)),M(N)}return!0}}(C,f)(y,M),goToNextCell:()=>({state:C,dispatch:f})=>Ge(1)(C,f),goToPreviousCell:()=>({state:C,dispatch:f})=>Ge(-1)(C,f),fixTables:()=>({state:C,dispatch:f})=>(f&&Q(C),!0),setCellSelection:C=>({tr:f,dispatch:y})=>{if(y){const M=F.create(f.doc,C.anchorCell,C.headCell);f.setSelection(M)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Ze,"Mod-Backspace":Ze,Delete:Ze,"Mod-Delete":Ze}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[un({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],pn({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema:C=>({tableRole:(0,T.callOrReturn)((0,T.getExtensionField)(C,"tableRole",{name:C.name,options:C.options,storage:C.storage}))})}).extend({renderHTML({node:C,HTMLAttributes:f}){var y,M;let I=0,N=!0;try{const $=(null===(y=C.content)||void 0===y?void 0:y.content)[0];null===(M=null==$?void 0:$.content)||void 0===M||M.content.forEach(ot=>{ot.attrs.colwidth?ot.attrs.colwidth.forEach(j=>{j?I+=j:(N=!1,I+=this.options.cellMinWidth)}):(N=!1,I+=this.options.cellMinWidth*(ot.attrs.colspan?ot.attrs.colspan:1))})}catch($){N=!1}return f.style=N&&I>0?`width: ${I}px;`:I&&I>0?`min-width: ${I}px`:null,["div",{class:"tui-table-wrapper"},["table",(0,T.mergeAttributes)(this.options.HTMLAttributes,f),["tbody",0]]]}})},88806:(Jt,Et,d)=>{d.d(Et,{v:()=>s});var T=d(74788);class s{constructor(P,m,ut){const k=m.get(T.z2F),nt=m.get(T._Vd).resolveComponentFactory(P);this.componentRef=nt.create(m,[]),this.updateProps(ut),k.attachView(this.componentRef.hostView)}get instance(){return this.componentRef.instance}get elementRef(){return this.componentRef.injector.get(T.SBq)}get dom(){return this.elementRef.nativeElement}updateProps(P){Object.entries(P).forEach(([m,ut])=>{this.instance[m]=ut})}detectChanges(){this.componentRef.changeDetectorRef.detectChanges()}destroy(){this.componentRef.destroy()}}},40400:(Jt,Et,d)=>{d.d(Et,{d:()=>P,x:()=>ut});var T=d(12057),s=d(40256),b=d(88806);class P{}class m extends s.NodeView{constructor(){super(...arguments),this.contentDOMElement=null}mount(){const mt=this.options.injector,nt=mt.get(T.K0);this.renderer=new b.v(this.component,mt,{editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(pt={})=>this.updateAttributes(pt),deleteNode:()=>this.deleteNode()}),this.extension.config.draggable&&(this.renderer.elementRef.nativeElement.ondragstart=pt=>{this.onDragStart(pt)}),this.contentDOMElement=this.node.isLeaf?null:nt.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit",this.renderer.detectChanges())}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}update(mt,nt){return this.options.update?this.options.update(mt,nt):mt.type===this.node.type&&(mt===this.node&&this.decorations===nt||(this.node=mt,this.decorations=nt,this.renderer.updateProps({node:mt,decorations:nt}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy()}maybeMoveContentDOM(){const mt=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&mt&&!mt.contains(this.contentDOMElement)&&mt.appendChild(this.contentDOMElement)}}const ut=(k,mt)=>nt=>new m(k,nt,mt)},70224:(Jt,Et,d)=>{d.r(Et),d.d(Et,{BackgroundColor:()=>Ct.BackgroundColor,EDITOR_BLANK_COLOR:()=>ct.hK,FontColor:()=>At.FontColor,INITIALIZATION_TIPTAP_CONTAINER:()=>Mt.Y1,LAZY_EDITOR_EXTENSIONS:()=>Mt.F4,LAZY_TIPTAP_EDITOR:()=>Mt.bG,StarterKit:()=>Yt.StarterKit,TIPTAP_EDITOR:()=>Mt.ZW,TUI_EDITOR_CODE_OPTIONS:()=>Mt.Mr,TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES:()=>Mt.dj,TUI_EDITOR_CONTENT_PROCESSOR:()=>Mt.F1,TUI_EDITOR_DEFAULT_OPTIONS:()=>Mt.HG,TUI_EDITOR_EXTENSIONS:()=>Mt.Wf,TUI_EDITOR_FONT_OPTIONS:()=>Mt.UN,TUI_EDITOR_GROUP_DEFAULT_OPTIONS:()=>rt.TUI_EDITOR_GROUP_DEFAULT_OPTIONS,TUI_EDITOR_LINK_TEXTS:()=>Mt.b$,TUI_EDITOR_MAX_IMAGE_WIDTH:()=>bt.TUI_EDITOR_MAX_IMAGE_WIDTH,TUI_EDITOR_MIN_IMAGE_WIDTH:()=>bt.TUI_EDITOR_MIN_IMAGE_WIDTH,TUI_EDITOR_OPTIONS:()=>Mt.mJ,TUI_EDITOR_PROVIDERS:()=>gt.m,TUI_EDITOR_TABLE_COMMANDS:()=>Mt.$i,TUI_EDITOR_TOOLBAR_TEXTS:()=>Mt.rf,TUI_IMAGE_LOADER:()=>Mt.p7,TableCellBackground:()=>S.TableCellBackground,TuiAlignContentComponent:()=>X.Xp,TuiAlignContentModule:()=>X.pu,TuiCodeComponent:()=>X.Tf,TuiCodeModule:()=>X.P_,TuiColorEditComponent:()=>T.hR,TuiColorEditModule:()=>T.TD,TuiColorPickerComponent:()=>T.$v,TuiColorPickerModule:()=>T.H9,TuiColorSelectorComponent:()=>T.sV,TuiColorSelectorModule:()=>T.wl,TuiComponentRenderer:()=>et.v,TuiDetailsComponent:()=>X.yj,TuiDetailsModule:()=>X.y9,TuiDetailsRemoveComponent:()=>X.Un,TuiEditLinkComponent:()=>s.l,TuiEditLinkModule:()=>s.F,TuiEditorComponent:()=>b.a,TuiEditorGroupToolComponent:()=>X.dN,TuiEditorImagePreviewDirective:()=>nt.Zj,TuiEditorImagePreviewModule:()=>nt.BN,TuiEditorModule:()=>Ot,TuiEditorPortalDirective:()=>_t.A,TuiEditorPortalHostComponent:()=>It.d,TuiEditorPortalService:()=>Lt.Y,TuiEditorSocketComponent:()=>m.D,TuiEditorSocketModule:()=>k,TuiEditorTool:()=>z._,TuiEditorToolGroup:()=>X.jP,TuiFlatPickerComponent:()=>T.Jd,TuiFlatPickerModule:()=>T.ui,TuiFontSize:()=>yt.TuiFontSize,TuiFontSizeComponent:()=>X.mK,TuiFontSizeModule:()=>X.p7,TuiFontStyleComponent:()=>X.hr,TuiFontStyleModule:()=>X.Zv,TuiHighlightColorComponent:()=>X.UT,TuiHighlightColorModule:()=>X.XC,TuiImageEditorComponent:()=>bt.TuiImageEditorComponent,TuiImageEditorModule:()=>bt.TuiImageEditorModule,TuiInputColorComponent:()=>Dt.j,TuiInputColorModule:()=>ht,TuiLinearMultiPickerComponent:()=>T.es,TuiLinearMultiPickerModule:()=>T.GU,TuiLinearPickerComponent:()=>T.P,TuiLinearPickerModule:()=>T.g7,TuiListConfigsComponent:()=>X.w2,TuiListConfigsModule:()=>X.Ur,TuiNodeViewNgComponent:()=>lt.d,TuiNodeViewRenderer:()=>lt.x,TuiPaletteComponent:()=>T.Rh,TuiPaletteModule:()=>T.VM,TuiTabExtension:()=>Nt.TuiTabExtension,TuiTable:()=>ft.TuiTable,TuiTableCellColorComponent:()=>X.pH,TuiTableCellColorModule:()=>X.mp,TuiTableCommands:()=>X.iN,TuiTableCreateComponent:()=>X.lT,TuiTableCreateModule:()=>X.iA,TuiTableMergeCellsComponent:()=>X.YH,TuiTableMergeCellsModule:()=>X.er,TuiTableRowColumnManagerComponent:()=>X._I,TuiTableRowColumnManagerModule:()=>X.__,TuiTableSizeSelectorComponent:()=>X.M8,TuiTableSizeSelectorModule:()=>X.kU,TuiTextColorComponent:()=>X.G0,TuiTextColorModule:()=>X._t,TuiTiptapEditorDirective:()=>nt.JU,TuiTiptapEditorModule:()=>nt.mJ,TuiTiptapEditorService:()=>nt.$3,TuiToolbarComponent:()=>mt.M6,TuiToolbarModule:()=>mt.yB,TuiToolbarNavigationManagerDirective:()=>mt.Bp,createGroupExtension:()=>rt.createGroupExtension,createImageEditorExtension:()=>bt.createImageEditorExtension,defaultEditorColors:()=>ct.sw,defaultEditorExtensions:()=>xt,defaultEditorTools:()=>ct.Db,tuiDefaultFontOptionsHandler:()=>ct.RR,tuiDeleteNode:()=>F.yU,tuiEditorOptionsProvider:()=>Mt.Uv,tuiGetElementPoint:()=>F.Ws,tuiGetGradientData:()=>F.U5,tuiGetMarkRange:()=>F.Yz,tuiGetSelectedContent:()=>F.Ap,tuiInsertHtml:()=>F.Xd,tuiInsertText:()=>F.Oi,tuiIsOrderedOrBulletList:()=>Nt.tuiIsOrderedOrBulletList,tuiIsSafeLinkRange:()=>F.nC,tuiIsSelectionIn:()=>F.i0,tuiLegacyEditorConverter:()=>F.Er,tuiParseGradient:()=>F._N,tuiToGradient:()=>F.CH});var T=d(27050),s=d(71115),b=d(69303),P=d(12057),m=d(20179),ut=d(74788);let k=(()=>{class K{}return K.\u0275fac=function(Bt){return new(Bt||K)},K.\u0275mod=ut.oAB({type:K}),K.\u0275inj=ut.cJS({}),K})();var mt=d(17406),nt=d(84614),at=d(36692),pt=d(72002);let Ot=(()=>{class K{}return K.\u0275fac=function(Bt){return new(Bt||K)},K.\u0275mod=ut.oAB({type:K}),K.\u0275inj=ut.cJS({imports:[[P.ez,mt.yB,pt.TuiWrapperModule,pt.TuiScrollbarModule,s.F,at.TuiActiveZoneModule,pt.TuiDropdownModule,nt.mJ,k,at.TuiLetModule]]}),K})();var gt=d(79089),_t=d(1433),Lt=d(73825),It=d(9872),Dt=d(19769);let ht=(()=>{class K{}return K.\u0275fac=function(Bt){return new(Bt||K)},K.\u0275mod=ut.oAB({type:K}),K.\u0275inj=ut.cJS({imports:[[P.ez,pt.TuiPrimitiveTextfieldModule,pt.TuiTextfieldControllerModule,pt.TuiHostedDropdownModule,T.wl,at.TuiActiveZoneModule]]}),K})();var X=d(93252),ct=d(19074),z=d(48699),Ct=d(15736);const xt=[Promise.resolve().then(d.bind(d,80726)).then(({StarterKit:K})=>K).then(K=>K.configure({heading:{levels:[1,2]}})),d.e(45861).then(d.bind(d,45861)).then(({default:K})=>K.configure({types:["heading","paragraph"]})),Promise.resolve().then(d.bind(d,74634)).then(({default:K})=>K),d.e(77008).then(d.bind(d,77008)).then(({default:K})=>K),d.e(91347).then(d.bind(d,91347)).then(({default:K})=>K),d.e(35609).then(d.bind(d,35609)).then(({default:K})=>K),Promise.resolve().then(d.bind(d,52658)).then(({FontColor:K})=>K),d.e(12955).then(d.bind(d,12955)).then(({default:K})=>K.configure({inline:!0})),d.e(63658).then(d.bind(d,63658)).then(({default:K})=>K.configure({openOnClick:!1})),d.e(54058).then(d.bind(d,54058)).then(({TuiJumpAnchor:K})=>K),Promise.resolve().then(d.bind(d,15736)).then(({BackgroundColor:K})=>K),Promise.resolve().then(d.bind(d,28279)).then(({TuiTable:K})=>K.configure({resizable:!0})),d.e(72219).then(d.bind(d,72219)).then(({default:K})=>K),d.e(74096).then(d.bind(d,74096)).then(({default:K})=>K),d.e(53107).then(d.bind(d,53107)).then(({TableHeader:K})=>K),Promise.resolve().then(d.bind(d,12177)).then(({TuiTabExtension:K})=>K),Promise.resolve().then(d.bind(d,51919)).then(({TableCellBackground:K})=>K),d.e(44312).then(d.bind(d,44312)).then(({TuiDetailsContent:K})=>K),d.e(44312).then(d.bind(d,44312)).then(({TuiDetails:K})=>K),d.e(44312).then(d.bind(d,44312)).then(({TuiSummary:K})=>K),Promise.resolve().then(d.bind(d,9492)).then(({TuiFontSize:K})=>K)];var At=d(52658),yt=d(9492),rt=d(54920),bt=d(25039),Nt=d(12177),Yt=d(80726),ft=d(28279),S=d(51919),et=d(88806),lt=d(40400),Mt=d(62842),F=d(37631)},62141:(Jt,Et,d)=>{d.d(Et,{i:()=>at});var T=d(12057),s=d(74788),b=d(37631),P=d(36692),m=d(18891),ut=d(43190),k=d(88002),mt=d(46782),nt=d(39761);let at=(()=>{class pt extends m.y{constructor(gt,{nativeElement:_t},Lt){const It=(0,P.tuiTypedFromEvent)(_t,"mousedown").pipe((0,P.tuiPreventDefault)(),(0,ut.w)(Dt=>{const ht=(0,P.tuiTypedFromEvent)(Lt,"mousemove").pipe((0,k.U)(({clientX:X,clientY:ct})=>(0,b.Ws)(X,ct,_t)),(0,mt.R)((0,P.tuiTypedFromEvent)(Lt,"mouseup")));return Dt.target===_t?ht.pipe((0,nt.O)((0,b.Ws)(Dt.clientX,Dt.clientY,_t))):ht}),(0,mt.R)(gt));super(Dt=>It.subscribe(Dt))}}return pt.\u0275fac=function(gt){return new(gt||pt)(s.LFG(P.TuiDestroyService),s.LFG(s.SBq),s.LFG(T.K0))},pt.\u0275prov=s.Yz7({token:pt,factory:pt.\u0275fac}),pt})()},62842:(Jt,Et,d)=>{d.d(Et,{Y1:()=>xt,F4:()=>b,bG:()=>Ct,ZW:()=>z,Mr:()=>Lt,dj:()=>pt,F1:()=>nt,HG:()=>m,Wf:()=>s,UN:()=>It,b$:()=>_t,mJ:()=>ut,$i:()=>gt,rf:()=>Ot,p7:()=>X,Uv:()=>k});var T=d(74788);const s=new T.OlP("[TUI_EDITOR_EXTENSIONS]: Extensions for editor"),b=new T.OlP("[LAZY_EDITOR_EXTENSIONS]: lazy extensions");var P=d(19074);const m={colors:P.sw,blankColor:P.hK,fontOptions:P.RR},ut=new T.OlP("[TUI_EDITOR_OPTIONS]: Default Editor colors",{factory:()=>m});function k(At){return{provide:ut,useValue:Object.assign(Object.assign({},m),At)}}var mt=d(54487);const nt=new T.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]: Content value processor for tui-editor",{factory:()=>mt.y});var at=d(72773);const pt=new T.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]: tui-color-selector i18n",{factory:()=>["Solid color","Gradient"]}),Ot=new T.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]: tui-editor-toolbar i18n",{factory:(0,at.vv)("toolbarTools")}),gt=new T.OlP("[TUI_EDITOR_TABLE_COMMANDS]: tui-editor-toolbar table i18n",{factory:(0,at.vv)("editorTableCommands")}),_t=new T.OlP("[TUI_EDITOR_LINK_TEXTS]: tui-editor-toolbar edit-link i18n",{factory:(0,at.vv)("editorEditLink")}),Lt=new T.OlP("[TUI_EDITOR_CODE_OPTIONS]: tui-editor-toolbar codes options",{factory:(0,at.vv)("editorCodeOptions")}),It=new T.OlP("[TUI_EDITOR_FONT_OPTIONS]: tui-editor-toolbar font options",{factory:(0,at.vv)("editorFontOptions")});var Dt=d(36692),ht=d(88002);const X=new T.OlP("[TUI_IMAGE_LOADER]: Image loader handler",{factory:()=>At=>{const yt=new FileReader;return yt.readAsDataURL(At),(0,Dt.tuiTypedFromEvent)(yt,"load").pipe((0,ht.U)(()=>String(yt.result)))}});var ct=d(82298);const z=new T.OlP("[TIPTAP_EDITOR]: Token for Tiptap Editor"),Ct=new T.OlP("[LAZY_TIPTAP_EDITOR]: Lazy loaded Editor",{factory:()=>{const At=new ct.t(1);return Promise.resolve().then(d.bind(d,40256)).then(yt=>At.next(yt.Editor)),At}}),xt=new T.OlP("[INITIALIZATION_TIPTAP_CONTAINER]: The container in which the tip-tap editor is initialized")},37631:(Jt,Et,d)=>{function T(ft,S,et){const lt=ft.selection.$anchor;for(let Mt=lt.depth;Mt>0;Mt--)if(lt.node(Mt).type.name===et)return S&&S(ft.tr.delete(lt.before(Mt),lt.after(Mt)).scrollIntoView()),!0;return!1}d.d(Et,{yU:()=>T,Ws:()=>b,U5:()=>P,Yz:()=>k,Ap:()=>nt,Xd:()=>at,Oi:()=>pt,nC:()=>Nt,i0:()=>Ot,Er:()=>gt,_N:()=>rt,CH:()=>Yt});var s=d(36692);function b(ft,S,et){const{left:lt,top:Mt,width:F,height:K}=et.getBoundingClientRect();return[(0,s.tuiClamp)(ft-lt,0,F)/F,(0,s.tuiClamp)(S-Mt,0,K)/K]}function P(ft){return ft.slice(0,Math.max(0,ft.length-1)).replace("linear-gradient(","")}function ut(ft,S,et={}){return ft.find(({attrs:lt,type:Mt})=>Mt===S&&function(ft,S){const et=Object.keys(S);return!et.length||!!et.filter(lt=>S[lt]===ft[lt]).length}(lt,et))||null}function k(ft,S,et={}){if(!ft||!S)return null;const{node:lt,offset:Mt}=ft.parent.childAfter(ft.parentOffset);if(!lt)return null;const F=ut(lt.marks,S,et);if(!F)return null;let K=ft.index(),dt=ft.start()+Mt,Bt=K+1,$t=dt+lt.nodeSize;for(ut(lt.marks,S,et);K>0&&F.isInSet(ft.parent.child(K-1).marks);)K-=1,dt-=ft.parent.child(K).nodeSize;for(;Bt<ft.parent.childCount&&ut(ft.parent.child(Bt).marks,S,et);)$t+=ft.parent.child(Bt).nodeSize,Bt+=1;return{from:dt,to:$t}}var mt=d(40256);function nt(ft,S){const et=null!=S?S:ft.selection.$head.parent.textContent,lt=ft.doc.cut(ft.selection.from,ft.selection.to);return lt.content.size?(0,mt.getHTMLFromFragment)(lt.content,ft.schema):et}function at(ft,S){if(ft.queryCommandSupported("insertHTML"))return void ft.execCommand("insertHTML",!1,S);const et=ft.getSelection();if(!et)throw new s.TuiDocumentSelectionException;ft.execCommand("ms-beginUndoUnit");const lt=et.getRangeAt(0),Mt=lt.createContextualFragment(S);lt.deleteContents(),lt.insertNode(Mt),ft.execCommand("ms-endUndoUnit")}function pt(ft,S){if(ft.queryCommandSupported("insertText"))return void ft.execCommand("insertText",!1,S);const et=ft.getSelection();if(!et)throw new s.TuiDocumentSelectionException;ft.execCommand("ms-beginUndoUnit");const lt=et.getRangeAt(0);lt.deleteContents(),lt.insertNode(ft.createTextNode(S)),ft.execCommand("ms-endUndoUnit")}function Ot({anchorNode:ft,focusNode:S},et){return!!ft&&!!S&&(0,s.tuiIsNodeIn)(ft,et)&&(0,s.tuiIsNodeIn)(S,et)}function gt(ft){const S=(new DOMParser).parseFromString(ft,"text/html");return _t(S.body),S.body.innerHTML}function _t(ft){for(const S of Array.from(ft.children))if(S.children.length&&_t(S),"FONT"===S.tagName)if(S.hasAttribute("size"))switch(S.getAttribute("size")){case"6":Lt("h1",S);break;case"5":Lt("h2",S);break;case"4":It("17px",S);break;case"3":It("15px",S);break;case"2":It("13px",S)}else S.hasAttribute("color")&&Dt(S)}function Lt(ft,S){var et,lt,Mt,F,K,dt,Bt,$t,qt;const ae=document.createElement(ft);if(ae.innerHTML=S.innerHTML,"P"===(null===(et=S.parentElement)||void 0===et?void 0:et.tagName)){const le=null===(Mt=null===(lt=S.parentElement)||void 0===lt?void 0:lt.parentElement)||void 0===Mt?void 0:Mt.insertBefore(ae,S.parentElement);null===(F=S.parentElement)||void 0===F||F.removeChild(S),(null==le?void 0:le.nextSibling)&&!(null===(dt=null===(K=null==le?void 0:le.nextSibling)||void 0===K?void 0:K.textContent)||void 0===dt?void 0:dt.trim())&&(null===($t=null===(Bt=le.nextSibling)||void 0===Bt?void 0:Bt.parentElement)||void 0===$t||$t.removeChild(le.nextSibling))}else null===(qt=S.parentElement)||void 0===qt||qt.replaceChild(ae,S)}function It(ft,S){var et;const lt=document.createElement("p"),Mt=document.createElement("span");Mt.setAttribute("style",`font-size: ${ft}`),Mt.innerHTML=S.innerHTML,lt.append(Mt),null===(et=S.parentElement)||void 0===et||et.replaceChild("P"===S.parentElement.tagName?Mt:lt,S)}function Dt(ft){var S;const et=document.createElement("span");et.setAttribute("style",`color: ${ft.getAttribute("color")}`),et.innerHTML=ft.innerHTML,null===(S=ft.parentElement)||void 0===S||S.replaceChild(et,ft)}const yt=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function rt(ft){const S=new RegExp(yt.join(""),"gi"),et=ft.startsWith("to")||ft.match(/^\d/)?ft.slice(Math.max(0,ft.indexOf(",")+1)).trim():ft,lt=ft.startsWith("to")?ft.split(",")[0]:"to bottom";let Mt=[],F=S.exec(et);for(;null!==F;)Mt=Mt.concat({color:F[1],position:bt(F[2],Mt.length)}),F=S.exec(et);return Mt=Mt.filter(({color:K})=>K.startsWith("#")||K.startsWith("rgb")),{stops:Mt,side:lt}}function bt(ft,S){const et=1===S?"100%":`${S}%`;return(null==ft?void 0:ft.includes("%"))?ft:et}function Nt(ft){var S;return ft.endOffset-ft.startOffset>0||0!==ft.startOffset&&ft.endOffset!==((null===(S=ft.endContainer.nodeValue)||void 0===S?void 0:S.length)||0)}function Yt({stops:ft,side:S}){return`linear-gradient(${S}, ${ft.map(({color:et,position:lt})=>`rgba(${(0,s.tuiParseColor)(et).join(", ")}) ${lt}`).join(", ")})`}},13903:(Jt,Et,d)=>{d.d(Et,{$:()=>Dt,h:()=>It});for(var T={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},b="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),m=("undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)),ut="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),k=m||b&&+b[1]<57,mt=0;mt<10;mt++)T[48+mt]=T[96+mt]=String(mt);for(mt=1;mt<=24;mt++)T[mt+111]="F"+mt;for(mt=65;mt<=90;mt++)T[mt]=String.fromCharCode(mt+32),s[mt]=String.fromCharCode(mt);for(var nt in T)s.hasOwnProperty(nt)||(s[nt]=T[nt]);var pt=d(62463);const Ot="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function gt(ht){let z,Ct,xt,At,X=ht.split(/-(?!$)/),ct=X[X.length-1];"Space"==ct&&(ct=" ");for(let yt=0;yt<X.length-1;yt++){let rt=X[yt];if(/^(cmd|meta|m)$/i.test(rt))At=!0;else if(/^a(lt)?$/i.test(rt))z=!0;else if(/^(c|ctrl|control)$/i.test(rt))Ct=!0;else if(/^s(hift)?$/i.test(rt))xt=!0;else{if(!/^mod$/i.test(rt))throw new Error("Unrecognized modifier name: "+rt);Ot?At=!0:Ct=!0}}return z&&(ct="Alt-"+ct),Ct&&(ct="Ctrl-"+ct),At&&(ct="Meta-"+ct),xt&&(ct="Shift-"+ct),ct}function Lt(ht,X,ct){return X.altKey&&(ht="Alt-"+ht),X.ctrlKey&&(ht="Ctrl-"+ht),X.metaKey&&(ht="Meta-"+ht),!1!==ct&&X.shiftKey&&(ht="Shift-"+ht),ht}function It(ht){return new pt.Sy({props:{handleKeyDown:Dt(ht)}})}function Dt(ht){let X=function(ht){let X=Object.create(null);for(let ct in ht)X[gt(ct)]=ht[ct];return X}(ht);return function(ct,z){let At,Ct=function(ht){var ct=!(k&&(ht.ctrlKey||ht.altKey||ht.metaKey)||ut&&ht.shiftKey&&ht.key&&1==ht.key.length||"Unidentified"==ht.key)&&ht.key||(ht.shiftKey?s:T)[ht.keyCode]||ht.key||"Unidentified";return"Esc"==ct&&(ct="Escape"),"Del"==ct&&(ct="Delete"),"Left"==ct&&(ct="ArrowLeft"),"Up"==ct&&(ct="ArrowUp"),"Right"==ct&&(ct="ArrowRight"),"Down"==ct&&(ct="ArrowDown"),ct}(z),xt=1==Ct.length&&" "!=Ct,yt=X[Lt(Ct,z,!xt)];if(yt&&yt(ct.state,ct.dispatch,ct))return!0;if(xt&&(z.shiftKey||z.altKey||z.metaKey||Ct.charCodeAt(0)>127)&&(At=T[z.keyCode])&&At!=Ct){let rt=X[Lt(At,z,!0)];if(rt&&rt(ct.state,ct.dispatch,ct))return!0}else if(xt&&z.shiftKey){let rt=X[Lt(Ct,z,!0)];if(rt&&rt(ct.state,ct.dispatch,ct))return!0}return!1}}},35917:(Jt,Et,d)=>{function T(H){this.content=H}d.d(Et,{aw:()=>Ee,PW:()=>Ut,HY:()=>m,vc:()=>nt,ZU:()=>de,NB:()=>ft,Ts:()=>Nt,e4:()=>at,V_:()=>se,p2:()=>pt}),T.prototype={constructor:T,find:function(H){for(var l=0;l<this.content.length;l+=2)if(this.content[l]===H)return l;return-1},get:function(H){var l=this.find(H);return-1==l?void 0:this.content[l+1]},update:function(H,l,u){var g=u&&u!=H?this.remove(u):this,D=g.find(H),L=g.content.slice();return-1==D?L.push(u||H,l):(L[D+1]=l,u&&(L[D]=u)),new T(L)},remove:function(H){var l=this.find(H);if(-1==l)return this;var u=this.content.slice();return u.splice(l,2),new T(u)},addToStart:function(H,l){return new T([H,l].concat(this.remove(H).content))},addToEnd:function(H,l){var u=this.remove(H).content.slice();return u.push(H,l),new T(u)},addBefore:function(H,l,u){var g=this.remove(l),D=g.content.slice(),L=g.find(H);return D.splice(-1==L?D.length:L,0,l,u),new T(D)},forEach:function(H){for(var l=0;l<this.content.length;l+=2)H(this.content[l],this.content[l+1])},prepend:function(H){return(H=T.from(H)).size?new T(H.content.concat(this.subtract(H).content)):this},append:function(H){return(H=T.from(H)).size?new T(this.subtract(H).content.concat(H.content)):this},subtract:function(H){var l=this;H=T.from(H);for(var u=0;u<H.content.length;u+=2)l=l.remove(H.content[u]);return l},toObject:function(){var H={};return this.forEach(function(l,u){H[l]=u}),H},get size(){return this.content.length>>1}},T.from=function(H){if(H instanceof T)return H;var l=[];if(H)for(var u in H)l.push(u,H[u]);return new T(l)};const s=T;function b(H,l,u){for(let g=0;;g++){if(g==H.childCount||g==l.childCount)return H.childCount==l.childCount?null:u;let D=H.child(g),L=l.child(g);if(D!=L){if(!D.sameMarkup(L))return u;if(D.isText&&D.text!=L.text){for(let V=0;D.text[V]==L.text[V];V++)u++;return u}if(D.content.size||L.content.size){let V=b(D.content,L.content,u+1);if(null!=V)return V}u+=D.nodeSize}else u+=D.nodeSize}}function P(H,l,u,g){for(let D=H.childCount,L=l.childCount;;){if(0==D||0==L)return D==L?null:{a:u,b:g};let V=H.child(--D),Tt=l.child(--L),Rt=V.nodeSize;if(V!=Tt){if(!V.sameMarkup(Tt))return{a:u,b:g};if(V.isText&&V.text!=Tt.text){let Vt=0,Xt=Math.min(V.text.length,Tt.text.length);for(;Vt<Xt&&V.text[V.text.length-Vt-1]==Tt.text[Tt.text.length-Vt-1];)Vt++,u--,g--;return{a:u,b:g}}if(V.content.size||Tt.content.size){let Vt=P(V.content,Tt.content,u-1,g-1);if(Vt)return Vt}u-=Rt,g-=Rt}else u-=Rt,g-=Rt}}class m{constructor(l,u){if(this.content=l,this.size=u||0,null==u)for(let g=0;g<l.length;g++)this.size+=l[g].nodeSize}nodesBetween(l,u,g,D=0,L){for(let V=0,Tt=0;Tt<u;V++){let Rt=this.content[V],Vt=Tt+Rt.nodeSize;if(Vt>l&&!1!==g(Rt,D+Tt,L||null,V)&&Rt.content.size){let Xt=Tt+1;Rt.nodesBetween(Math.max(0,l-Xt),Math.min(Rt.content.size,u-Xt),g,D+Xt)}Tt=Vt}}descendants(l){this.nodesBetween(0,this.size,l)}textBetween(l,u,g,D){let L="",V=!0;return this.nodesBetween(l,u,(Tt,Rt)=>{Tt.isText?(L+=Tt.text.slice(Math.max(l,Rt)-Rt,u-Rt),V=!g):Tt.isLeaf?(D?L+="function"==typeof D?D(Tt):D:Tt.type.spec.leafText&&(L+=Tt.type.spec.leafText(Tt)),V=!g):!V&&Tt.isBlock&&(L+=g,V=!0)},0),L}append(l){if(!l.size)return this;if(!this.size)return l;let u=this.lastChild,g=l.firstChild,D=this.content.slice(),L=0;for(u.isText&&u.sameMarkup(g)&&(D[D.length-1]=u.withText(u.text+g.text),L=1);L<l.content.length;L++)D.push(l.content[L]);return new m(D,this.size+l.size)}cut(l,u=this.size){if(0==l&&u==this.size)return this;let g=[],D=0;if(u>l)for(let L=0,V=0;V<u;L++){let Tt=this.content[L],Rt=V+Tt.nodeSize;Rt>l&&((V<l||Rt>u)&&(Tt=Tt.isText?Tt.cut(Math.max(0,l-V),Math.min(Tt.text.length,u-V)):Tt.cut(Math.max(0,l-V-1),Math.min(Tt.content.size,u-V-1))),g.push(Tt),D+=Tt.nodeSize),V=Rt}return new m(g,D)}cutByIndex(l,u){return l==u?m.empty:0==l&&u==this.content.length?this:new m(this.content.slice(l,u))}replaceChild(l,u){let g=this.content[l];if(g==u)return this;let D=this.content.slice(),L=this.size+u.nodeSize-g.nodeSize;return D[l]=u,new m(D,L)}addToStart(l){return new m([l].concat(this.content),this.size+l.nodeSize)}addToEnd(l){return new m(this.content.concat(l),this.size+l.nodeSize)}eq(l){if(this.content.length!=l.content.length)return!1;for(let u=0;u<this.content.length;u++)if(!this.content[u].eq(l.content[u]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(l){let u=this.content[l];if(!u)throw new RangeError("Index "+l+" out of range for "+this);return u}maybeChild(l){return this.content[l]||null}forEach(l){for(let u=0,g=0;u<this.content.length;u++){let D=this.content[u];l(D,g,u),g+=D.nodeSize}}findDiffStart(l,u=0){return b(this,l,u)}findDiffEnd(l,u=this.size,g=l.size){return P(this,l,u,g)}findIndex(l,u=-1){if(0==l)return k(0,l);if(l==this.size)return k(this.content.length,l);if(l>this.size||l<0)throw new RangeError(`Position ${l} outside of fragment (${this})`);for(let g=0,D=0;;g++){let V=D+this.child(g).nodeSize;if(V>=l)return V==l||u>0?k(g+1,V):k(g,D);D=V}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(l=>l.toJSON()):null}static fromJSON(l,u){if(!u)return m.empty;if(!Array.isArray(u))throw new RangeError("Invalid input for Fragment.fromJSON");return new m(u.map(l.nodeFromJSON))}static fromArray(l){if(!l.length)return m.empty;let u,g=0;for(let D=0;D<l.length;D++){let L=l[D];g+=L.nodeSize,D&&L.isText&&l[D-1].sameMarkup(L)?(u||(u=l.slice(0,D)),u[u.length-1]=L.withText(u[u.length-1].text+L.text)):u&&u.push(L)}return new m(u||l,g)}static from(l){if(!l)return m.empty;if(l instanceof m)return l;if(Array.isArray(l))return this.fromArray(l);if(l.attrs)return new m([l],l.nodeSize);throw new RangeError("Can not convert "+l+" to a Fragment"+(l.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}m.empty=new m([],0);const ut={index:0,offset:0};function k(H,l){return ut.index=H,ut.offset=l,ut}function mt(H,l){if(H===l)return!0;if(!H||"object"!=typeof H||!l||"object"!=typeof l)return!1;let u=Array.isArray(H);if(Array.isArray(l)!=u)return!1;if(u){if(H.length!=l.length)return!1;for(let g=0;g<H.length;g++)if(!mt(H[g],l[g]))return!1}else{for(let g in H)if(!(g in l)||!mt(H[g],l[g]))return!1;for(let g in l)if(!(g in H))return!1}return!0}let nt=(()=>{class H{constructor(u,g){this.type=u,this.attrs=g}addToSet(u){let g,D=!1;for(let L=0;L<u.length;L++){let V=u[L];if(this.eq(V))return u;if(this.type.excludes(V.type))g||(g=u.slice(0,L));else{if(V.type.excludes(this.type))return u;!D&&V.type.rank>this.type.rank&&(g||(g=u.slice(0,L)),g.push(this),D=!0),g&&g.push(V)}}return g||(g=u.slice()),D||g.push(this),g}removeFromSet(u){for(let g=0;g<u.length;g++)if(this.eq(u[g]))return u.slice(0,g).concat(u.slice(g+1));return u}isInSet(u){for(let g=0;g<u.length;g++)if(this.eq(u[g]))return!0;return!1}eq(u){return this==u||this.type==u.type&&mt(this.attrs,u.attrs)}toJSON(){let u={type:this.type.name};for(let g in this.attrs){u.attrs=this.attrs;break}return u}static fromJSON(u,g){if(!g)throw new RangeError("Invalid input for Mark.fromJSON");let D=u.marks[g.type];if(!D)throw new RangeError(`There is no mark type ${g.type} in this schema`);return D.create(g.attrs)}static sameSet(u,g){if(u==g)return!0;if(u.length!=g.length)return!1;for(let D=0;D<u.length;D++)if(!u[D].eq(g[D]))return!1;return!0}static setFrom(u){if(!u||Array.isArray(u)&&0==u.length)return H.none;if(u instanceof H)return[u];let g=u.slice();return g.sort((D,L)=>D.type.rank-L.type.rank),g}}return H.none=[],H})();class at extends Error{}class pt{constructor(l,u,g){this.content=l,this.openStart=u,this.openEnd=g}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(l,u){let g=gt(this.content,l+this.openStart,u);return g&&new pt(g,this.openStart,this.openEnd)}removeBetween(l,u){return new pt(Ot(this.content,l+this.openStart,u+this.openStart),this.openStart,this.openEnd)}eq(l){return this.content.eq(l.content)&&this.openStart==l.openStart&&this.openEnd==l.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let l={content:this.content.toJSON()};return this.openStart>0&&(l.openStart=this.openStart),this.openEnd>0&&(l.openEnd=this.openEnd),l}static fromJSON(l,u){if(!u)return pt.empty;let g=u.openStart||0,D=u.openEnd||0;if("number"!=typeof g||"number"!=typeof D)throw new RangeError("Invalid input for Slice.fromJSON");return new pt(m.fromJSON(l,u.content),g,D)}static maxOpen(l,u=!0){let g=0,D=0;for(let L=l.firstChild;L&&!L.isLeaf&&(u||!L.type.spec.isolating);L=L.firstChild)g++;for(let L=l.lastChild;L&&!L.isLeaf&&(u||!L.type.spec.isolating);L=L.lastChild)D++;return new pt(l,g,D)}}function Ot(H,l,u){let{index:g,offset:D}=H.findIndex(l),L=H.maybeChild(g),{index:V,offset:Tt}=H.findIndex(u);if(D==l||L.isText){if(Tt!=u&&!H.child(V).isText)throw new RangeError("Removing non-flat range");return H.cut(0,l).append(H.cut(u))}if(g!=V)throw new RangeError("Removing non-flat range");return H.replaceChild(g,L.copy(Ot(L.content,l-D-1,u-D-1)))}function gt(H,l,u,g){let{index:D,offset:L}=H.findIndex(l),V=H.maybeChild(D);if(L==l||V.isText)return g&&!g.canReplace(D,D,u)?null:H.cut(0,l).append(u).append(H.cut(l));let Tt=gt(V.content,l-L-1,u);return Tt&&H.replaceChild(D,V.copy(Tt))}function _t(H,l,u){if(u.openStart>H.depth)throw new at("Inserted content deeper than insertion position");if(H.depth-u.openStart!=l.depth-u.openEnd)throw new at("Inconsistent open depths");return Lt(H,l,u,0)}function Lt(H,l,u,g){let D=H.index(g),L=H.node(g);if(D==l.index(g)&&g<H.depth-u.openStart){let V=Lt(H,l,u,g+1);return L.copy(L.content.replaceChild(D,V))}if(u.content.size){if(u.openStart||u.openEnd||H.depth!=g||l.depth!=g){let{start:V,end:Tt}=function(H,l){let u=l.depth-H.openStart,D=l.node(u).copy(H.content);for(let L=u-1;L>=0;L--)D=l.node(L).copy(m.from(D));return{start:D.resolveNoCache(H.openStart+u),end:D.resolveNoCache(D.content.size-H.openEnd-u)}}(u,H);return ct(L,z(H,V,Tt,l,g))}{let V=H.parent,Tt=V.content;return ct(V,Tt.cut(0,H.parentOffset).append(u.content).append(Tt.cut(l.parentOffset)))}}return ct(L,Ct(H,l,g))}function It(H,l){if(!l.type.compatibleContent(H.type))throw new at("Cannot join "+l.type.name+" onto "+H.type.name)}function Dt(H,l,u){let g=H.node(u);return It(g,l.node(u)),g}function ht(H,l){let u=l.length-1;u>=0&&H.isText&&H.sameMarkup(l[u])?l[u]=H.withText(l[u].text+H.text):l.push(H)}function X(H,l,u,g){let D=(l||H).node(u),L=0,V=l?l.index(u):D.childCount;H&&(L=H.index(u),H.depth>u?L++:H.textOffset&&(ht(H.nodeAfter,g),L++));for(let Tt=L;Tt<V;Tt++)ht(D.child(Tt),g);l&&l.depth==u&&l.textOffset&&ht(l.nodeBefore,g)}function ct(H,l){if(!H.type.validContent(l))throw new at("Invalid content for node "+H.type.name);return H.copy(l)}function z(H,l,u,g,D){let L=H.depth>D&&Dt(H,l,D+1),V=g.depth>D&&Dt(u,g,D+1),Tt=[];return X(null,H,D,Tt),L&&V&&l.index(D)==u.index(D)?(It(L,V),ht(ct(L,z(H,l,u,g,D+1)),Tt)):(L&&ht(ct(L,Ct(H,l,D+1)),Tt),X(l,u,D,Tt),V&&ht(ct(V,Ct(u,g,D+1)),Tt)),X(g,null,D,Tt),new m(Tt)}function Ct(H,l,u){let g=[];return X(null,H,u,g),H.depth>u&&ht(ct(Dt(H,l,u+1),Ct(H,l,u+1)),g),X(l,null,u,g),new m(g)}pt.empty=new pt(m.empty,0,0);class At{constructor(l,u,g){this.pos=l,this.path=u,this.parentOffset=g,this.depth=u.length/3-1}resolveDepth(l){return null==l?this.depth:l<0?this.depth+l:l}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(l){return this.path[3*this.resolveDepth(l)]}index(l){return this.path[3*this.resolveDepth(l)+1]}indexAfter(l){return l=this.resolveDepth(l),this.index(l)+(l!=this.depth||this.textOffset?1:0)}start(l){return 0==(l=this.resolveDepth(l))?0:this.path[3*l-1]+1}end(l){return l=this.resolveDepth(l),this.start(l)+this.node(l).content.size}before(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position before the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]}after(l){if(!(l=this.resolveDepth(l)))throw new RangeError("There is no position after the top-level node");return l==this.depth+1?this.pos:this.path[3*l-1]+this.path[3*l].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let l=this.parent,u=this.index(this.depth);if(u==l.childCount)return null;let g=this.pos-this.path[this.path.length-1],D=l.child(u);return g?l.child(u).cut(g):D}get nodeBefore(){let l=this.index(this.depth),u=this.pos-this.path[this.path.length-1];return u?this.parent.child(l).cut(0,u):0==l?null:this.parent.child(l-1)}posAtIndex(l,u){u=this.resolveDepth(u);let g=this.path[3*u],D=0==u?0:this.path[3*u-1]+1;for(let L=0;L<l;L++)D+=g.child(L).nodeSize;return D}marks(){let l=this.parent,u=this.index();if(0==l.content.size)return nt.none;if(this.textOffset)return l.child(u).marks;let g=l.maybeChild(u-1),D=l.maybeChild(u);if(!g){let Tt=g;g=D,D=Tt}let L=g.marks;for(var V=0;V<L.length;V++)!1===L[V].type.spec.inclusive&&(!D||!L[V].isInSet(D.marks))&&(L=L[V--].removeFromSet(L));return L}marksAcross(l){let u=this.parent.maybeChild(this.index());if(!u||!u.isInline)return null;let g=u.marks,D=l.parent.maybeChild(l.index());for(var L=0;L<g.length;L++)!1===g[L].type.spec.inclusive&&(!D||!g[L].isInSet(D.marks))&&(g=g[L--].removeFromSet(g));return g}sharedDepth(l){for(let u=this.depth;u>0;u--)if(this.start(u)<=l&&this.end(u)>=l)return u;return 0}blockRange(l=this,u){if(l.pos<this.pos)return l.blockRange(this);for(let g=this.depth-(this.parent.inlineContent||this.pos==l.pos?1:0);g>=0;g--)if(l.pos<=this.end(g)&&(!u||u(this.node(g))))return new Nt(this,l,g);return null}sameParent(l){return this.pos-this.parentOffset==l.pos-l.parentOffset}max(l){return l.pos>this.pos?l:this}min(l){return l.pos<this.pos?l:this}toString(){let l="";for(let u=1;u<=this.depth;u++)l+=(l?"/":"")+this.node(u).type.name+"_"+this.index(u-1);return l+":"+this.parentOffset}static resolve(l,u){if(!(u>=0&&u<=l.content.size))throw new RangeError("Position "+u+" out of range");let g=[],D=0,L=u;for(let V=l;;){let{index:Tt,offset:Rt}=V.content.findIndex(L),Vt=L-Rt;if(g.push(V,Tt,D+Rt),!Vt||(V=V.child(Tt),V.isText))break;L=Vt-1,D+=Rt+1}return new At(u,g,L)}static resolveCached(l,u){for(let D=0;D<yt.length;D++){let L=yt[D];if(L.pos==u&&L.doc==l)return L}let g=yt[rt]=At.resolve(l,u);return rt=(rt+1)%bt,g}}let yt=[],rt=0,bt=12;class Nt{constructor(l,u,g){this.$from=l,this.$to=u,this.depth=g}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Yt=Object.create(null);class ft{constructor(l,u,g,D=nt.none){this.type=l,this.attrs=u,this.marks=D,this.content=g||m.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(l){return this.content.child(l)}maybeChild(l){return this.content.maybeChild(l)}forEach(l){this.content.forEach(l)}nodesBetween(l,u,g,D=0){this.content.nodesBetween(l,u,g,D,this)}descendants(l){this.nodesBetween(0,this.content.size,l)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(l,u,g,D){return this.content.textBetween(l,u,g,D)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(l){return this==l||this.sameMarkup(l)&&this.content.eq(l.content)}sameMarkup(l){return this.hasMarkup(l.type,l.attrs,l.marks)}hasMarkup(l,u,g){return this.type==l&&mt(this.attrs,u||l.defaultAttrs||Yt)&&nt.sameSet(this.marks,g||nt.none)}copy(l=null){return l==this.content?this:new ft(this.type,this.attrs,l,this.marks)}mark(l){return l==this.marks?this:new ft(this.type,this.attrs,this.content,l)}cut(l,u=this.content.size){return 0==l&&u==this.content.size?this:this.copy(this.content.cut(l,u))}slice(l,u=this.content.size,g=!1){if(l==u)return pt.empty;let D=this.resolve(l),L=this.resolve(u),V=g?0:D.sharedDepth(u),Tt=D.start(V),Vt=D.node(V).content.cut(D.pos-Tt,L.pos-Tt);return new pt(Vt,D.depth-V,L.depth-V)}replace(l,u,g){return _t(this.resolve(l),this.resolve(u),g)}nodeAt(l){for(let u=this;;){let{index:g,offset:D}=u.content.findIndex(l);if(u=u.maybeChild(g),!u)return null;if(D==l||u.isText)return u;l-=D+1}}childAfter(l){let{index:u,offset:g}=this.content.findIndex(l);return{node:this.content.maybeChild(u),index:u,offset:g}}childBefore(l){if(0==l)return{node:null,index:0,offset:0};let{index:u,offset:g}=this.content.findIndex(l);if(g<l)return{node:this.content.child(u),index:u,offset:g};let D=this.content.child(u-1);return{node:D,index:u-1,offset:g-D.nodeSize}}resolve(l){return At.resolveCached(this,l)}resolveNoCache(l){return At.resolve(this,l)}rangeHasMark(l,u,g){let D=!1;return u>l&&this.nodesBetween(l,u,L=>(g.isInSet(L.marks)&&(D=!0),!D)),D}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let l=this.type.name;return this.content.size&&(l+="("+this.content.toStringInner()+")"),et(this.marks,l)}contentMatchAt(l){let u=this.type.contentMatch.matchFragment(this.content,0,l);if(!u)throw new Error("Called contentMatchAt on a node with invalid content");return u}canReplace(l,u,g=m.empty,D=0,L=g.childCount){let V=this.contentMatchAt(l).matchFragment(g,D,L),Tt=V&&V.matchFragment(this.content,u);if(!Tt||!Tt.validEnd)return!1;for(let Rt=D;Rt<L;Rt++)if(!this.type.allowsMarks(g.child(Rt).marks))return!1;return!0}canReplaceWith(l,u,g,D){if(D&&!this.type.allowsMarks(D))return!1;let L=this.contentMatchAt(l).matchType(g),V=L&&L.matchFragment(this.content,u);return!!V&&V.validEnd}canAppend(l){return l.content.size?this.canReplace(this.childCount,this.childCount,l.content):this.type.compatibleContent(l.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let l=nt.none;for(let u=0;u<this.marks.length;u++)l=this.marks[u].addToSet(l);if(!nt.sameSet(l,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(u=>u.type.name)}`);this.content.forEach(u=>u.check())}toJSON(){let l={type:this.type.name};for(let u in this.attrs){l.attrs=this.attrs;break}return this.content.size&&(l.content=this.content.toJSON()),this.marks.length&&(l.marks=this.marks.map(u=>u.toJSON())),l}static fromJSON(l,u){if(!u)throw new RangeError("Invalid input for Node.fromJSON");let g=null;if(u.marks){if(!Array.isArray(u.marks))throw new RangeError("Invalid mark data for Node.fromJSON");g=u.marks.map(l.markFromJSON)}if("text"==u.type){if("string"!=typeof u.text)throw new RangeError("Invalid text node in JSON");return l.text(u.text,g)}let D=m.fromJSON(l,u.content);return l.nodeType(u.type).create(u.attrs,D,g)}}ft.prototype.text=void 0;class S extends ft{constructor(l,u,g,D){if(super(l,u,null,D),!g)throw new RangeError("Empty text nodes are not allowed");this.text=g}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):et(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(l,u){return this.text.slice(l,u)}get nodeSize(){return this.text.length}mark(l){return l==this.marks?this:new S(this.type,this.attrs,this.text,l)}withText(l){return l==this.text?this:new S(this.type,this.attrs,l,this.marks)}cut(l=0,u=this.text.length){return 0==l&&u==this.text.length?this:this.withText(this.text.slice(l,u))}eq(l){return this.sameMarkup(l)&&this.text==l.text}toJSON(){let l=super.toJSON();return l.text=this.text,l}}function et(H,l){for(let u=H.length-1;u>=0;u--)l=H[u].type.name+"("+l+")";return l}class lt{constructor(l){this.validEnd=l,this.next=[],this.wrapCache=[]}static parse(l,u){let g=new Mt(l,u);if(null==g.next)return lt.empty;let D=F(g);g.next&&g.err("Unexpected trailing text");let L=function(H){let l=Object.create(null);return function u(g){let D=[];g.forEach(V=>{H[V].forEach(({term:Tt,to:Rt})=>{if(!Tt)return;let Vt;for(let Xt=0;Xt<D.length;Xt++)D[Xt][0]==Tt&&(Vt=D[Xt][1]);Ke(H,Rt).forEach(Xt=>{Vt||D.push([Tt,Vt=[]]),-1==Vt.indexOf(Xt)&&Vt.push(Xt)})})});let L=l[g.join(",")]=new lt(g.indexOf(H.length-1)>-1);for(let V=0;V<D.length;V++){let Tt=D[V][1].sort(Fe);L.next.push({type:D[V][0],next:l[Tt.join(",")]||u(Tt)})}return L}(Ke(H,0))}(function(H){let l=[[]];return D(function L(V,Tt){if("choice"==V.type)return V.exprs.reduce((Rt,Vt)=>Rt.concat(L(Vt,Tt)),[]);if("seq"!=V.type){if("star"==V.type){let Rt=u();return g(Tt,Rt),D(L(V.expr,Rt),Rt),[g(Rt)]}if("plus"==V.type){let Rt=u();return D(L(V.expr,Tt),Rt),D(L(V.expr,Rt),Rt),[g(Rt)]}if("opt"==V.type)return[g(Tt)].concat(L(V.expr,Tt));if("range"==V.type){let Rt=Tt;for(let Vt=0;Vt<V.min;Vt++){let Xt=u();D(L(V.expr,Rt),Xt),Rt=Xt}if(-1==V.max)D(L(V.expr,Rt),Rt);else for(let Vt=V.min;Vt<V.max;Vt++){let Xt=u();g(Rt,Xt),D(L(V.expr,Rt),Xt),Rt=Xt}return[g(Rt)]}if("name"==V.type)return[g(Tt,void 0,V.value)];throw new Error("Unknown expr type")}for(let Rt=0;;Rt++){let Vt=L(V.exprs[Rt],Tt);if(Rt==V.exprs.length-1)return Vt;D(Vt,Tt=u())}}(H,0),u()),l;function u(){return l.push([])-1}function g(V,Tt,Rt){let Vt={term:Rt,to:Tt};return l[V].push(Vt),Vt}function D(V,Tt){V.forEach(Rt=>Rt.to=Tt)}}(D));return function(H,l){for(let u=0,g=[H];u<g.length;u++){let D=g[u],L=!D.validEnd,V=[];for(let Tt=0;Tt<D.next.length;Tt++){let{type:Rt,next:Vt}=D.next[Tt];V.push(Rt.name),L&&!(Rt.isText||Rt.hasRequiredAttrs())&&(L=!1),-1==g.indexOf(Vt)&&g.push(Vt)}L&&l.err("Only non-generatable nodes ("+V.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(L,g),L}matchType(l){for(let u=0;u<this.next.length;u++)if(this.next[u].type==l)return this.next[u].next;return null}matchFragment(l,u=0,g=l.childCount){let D=this;for(let L=u;D&&L<g;L++)D=D.matchType(l.child(L).type);return D}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let l=0;l<this.next.length;l++){let{type:u}=this.next[l];if(!u.isText&&!u.hasRequiredAttrs())return u}return null}compatible(l){for(let u=0;u<this.next.length;u++)for(let g=0;g<l.next.length;g++)if(this.next[u].type==l.next[g].type)return!0;return!1}fillBefore(l,u=!1,g=0){let D=[this];return function L(V,Tt){let Rt=V.matchFragment(l,g);if(Rt&&(!u||Rt.validEnd))return m.from(Tt.map(Vt=>Vt.createAndFill()));for(let Vt=0;Vt<V.next.length;Vt++){let{type:Xt,next:Me}=V.next[Vt];if(!Xt.isText&&!Xt.hasRequiredAttrs()&&-1==D.indexOf(Me)){D.push(Me);let cn=L(Me,Tt.concat(Xt));if(cn)return cn}}return null}(this,[])}findWrapping(l){for(let g=0;g<this.wrapCache.length;g+=2)if(this.wrapCache[g]==l)return this.wrapCache[g+1];let u=this.computeWrapping(l);return this.wrapCache.push(l,u),u}computeWrapping(l){let u=Object.create(null),g=[{match:this,type:null,via:null}];for(;g.length;){let D=g.shift(),L=D.match;if(L.matchType(l)){let V=[];for(let Tt=D;Tt.type;Tt=Tt.via)V.push(Tt.type);return V.reverse()}for(let V=0;V<L.next.length;V++){let{type:Tt,next:Rt}=L.next[V];!Tt.isLeaf&&!Tt.hasRequiredAttrs()&&!(Tt.name in u)&&(!D.type||Rt.validEnd)&&(g.push({match:Tt.contentMatch,type:Tt,via:D}),u[Tt.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(l){if(l>=this.next.length)throw new RangeError(`There's no ${l}th edge in this content match`);return this.next[l]}toString(){let l=[];return function u(g){l.push(g);for(let D=0;D<g.next.length;D++)-1==l.indexOf(g.next[D].next)&&u(g.next[D].next)}(this),l.map((g,D)=>{let L=D+(g.validEnd?"*":" ")+" ";for(let V=0;V<g.next.length;V++)L+=(V?", ":"")+g.next[V].type.name+"->"+l.indexOf(g.next[V].next);return L}).join("\n")}}lt.empty=new lt(!0);class Mt{constructor(l,u){this.string=l,this.nodeTypes=u,this.inline=null,this.pos=0,this.tokens=l.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(l){return this.next==l&&(this.pos++||!0)}err(l){throw new SyntaxError(l+" (in content expression '"+this.string+"')")}}function F(H){let l=[];do{l.push(K(H))}while(H.eat("|"));return 1==l.length?l[0]:{type:"choice",exprs:l}}function K(H){let l=[];do{l.push(dt(H))}while(H.next&&")"!=H.next&&"|"!=H.next);return 1==l.length?l[0]:{type:"seq",exprs:l}}function dt(H){let l=function(H){if(H.eat("(")){let l=F(H);return H.eat(")")||H.err("Missing closing paren"),l}if(!/\W/.test(H.next)){let l=function(H,l){let u=H.nodeTypes,g=u[l];if(g)return[g];let D=[];for(let L in u){let V=u[L];V.groups.indexOf(l)>-1&&D.push(V)}return 0==D.length&&H.err("No node type or group '"+l+"' found"),D}(H,H.next).map(u=>(null==H.inline?H.inline=u.isInline:H.inline!=u.isInline&&H.err("Mixing inline and block content"),{type:"name",value:u}));return H.pos++,1==l.length?l[0]:{type:"choice",exprs:l}}H.err("Unexpected token '"+H.next+"'")}(H);for(;;)if(H.eat("+"))l={type:"plus",expr:l};else if(H.eat("*"))l={type:"star",expr:l};else if(H.eat("?"))l={type:"opt",expr:l};else{if(!H.eat("{"))break;l=$t(H,l)}return l}function Bt(H){/\D/.test(H.next)&&H.err("Expected number, got '"+H.next+"'");let l=Number(H.next);return H.pos++,l}function $t(H,l){let u=Bt(H),g=u;return H.eat(",")&&(g="}"!=H.next?Bt(H):-1),H.eat("}")||H.err("Unclosed braced range"),{type:"range",min:u,max:g,expr:l}}function Fe(H,l){return l-H}function Ke(H,l){let u=[];return function g(D){let L=H[D];if(1==L.length&&!L[0].term)return g(L[0].to);u.push(D);for(let V=0;V<L.length;V++){let{term:Tt,to:Rt}=L[V];!Tt&&-1==u.indexOf(Rt)&&g(Rt)}}(l),u.sort(Fe)}function he(H){let l=Object.create(null);for(let u in H){let g=H[u];if(!g.hasDefault)return null;l[u]=g.default}return l}function De(H,l){let u=Object.create(null);for(let g in H){let D=l&&l[g];if(void 0===D){let L=H[g];if(!L.hasDefault)throw new RangeError("No value supplied for attribute "+g);D=L.default}u[g]=D}return u}function Ie(H){let l=Object.create(null);if(H)for(let u in H)l[u]=new Ue(H[u]);return l}class Te{constructor(l,u,g){this.name=l,this.schema=u,this.spec=g,this.markSet=null,this.groups=g.group?g.group.split(" "):[],this.attrs=Ie(g.attrs),this.defaultAttrs=he(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(g.inline||"text"==l),this.isText="text"==l}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==lt.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let l in this.attrs)if(this.attrs[l].isRequired)return!0;return!1}compatibleContent(l){return this==l||this.contentMatch.compatible(l.contentMatch)}computeAttrs(l){return!l&&this.defaultAttrs?this.defaultAttrs:De(this.attrs,l)}create(l=null,u,g){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ft(this,this.computeAttrs(l),m.from(u),nt.setFrom(g))}createChecked(l=null,u,g){if(u=m.from(u),!this.validContent(u))throw new RangeError("Invalid content for node "+this.name);return new ft(this,this.computeAttrs(l),u,nt.setFrom(g))}createAndFill(l=null,u,g){if(l=this.computeAttrs(l),(u=m.from(u)).size){let V=this.contentMatch.fillBefore(u);if(!V)return null;u=V.append(u)}let D=this.contentMatch.matchFragment(u),L=D&&D.fillBefore(m.empty,!0);return L?new ft(this,l,u.append(L),nt.setFrom(g)):null}validContent(l){let u=this.contentMatch.matchFragment(l);if(!u||!u.validEnd)return!1;for(let g=0;g<l.childCount;g++)if(!this.allowsMarks(l.child(g).marks))return!1;return!0}allowsMarkType(l){return null==this.markSet||this.markSet.indexOf(l)>-1}allowsMarks(l){if(null==this.markSet)return!0;for(let u=0;u<l.length;u++)if(!this.allowsMarkType(l[u].type))return!1;return!0}allowedMarks(l){if(null==this.markSet)return l;let u;for(let g=0;g<l.length;g++)this.allowsMarkType(l[g].type)?u&&u.push(l[g]):u||(u=l.slice(0,g));return u?u.length?u:nt.none:l}static compile(l,u){let g=Object.create(null);l.forEach((L,V)=>g[L]=new Te(L,u,V));let D=u.spec.topNode||"doc";if(!g[D])throw new RangeError("Schema is missing its top node type ('"+D+"')");if(!g.text)throw new RangeError("Every schema needs a 'text' type");for(let L in g.text.attrs)throw new RangeError("The text node type should not have attributes");return g}}class Ue{constructor(l){this.hasDefault=Object.prototype.hasOwnProperty.call(l,"default"),this.default=l.default}get isRequired(){return!this.hasDefault}}class de{constructor(l,u,g,D){this.name=l,this.rank=u,this.schema=g,this.spec=D,this.attrs=Ie(D.attrs),this.excluded=null;let L=he(this.attrs);this.instance=L?new nt(this,L):null}create(l=null){return!l&&this.instance?this.instance:new nt(this,De(this.attrs,l))}static compile(l,u){let g=Object.create(null),D=0;return l.forEach((L,V)=>g[L]=new de(L,D++,u,V)),g}removeFromSet(l){for(var u=0;u<l.length;u++)l[u].type==this&&(l=l.slice(0,u).concat(l.slice(u+1)),u--);return l}isInSet(l){for(let u=0;u<l.length;u++)if(l[u].type==this)return l[u]}excludes(l){return this.excluded.indexOf(l)>-1}}class se{constructor(l){this.cached=Object.create(null),this.spec={nodes:s.from(l.nodes),marks:s.from(l.marks||{}),topNode:l.topNode},this.nodes=Te.compile(this.spec.nodes,this),this.marks=de.compile(this.spec.marks,this);let u=Object.create(null);for(let g in this.nodes){if(g in this.marks)throw new RangeError(g+" can not be both a node and a mark");let D=this.nodes[g],L=D.spec.content||"",V=D.spec.marks;D.contentMatch=u[L]||(u[L]=lt.parse(L,this.nodes)),D.inlineContent=D.contentMatch.inlineContent,D.markSet="_"==V?null:V?We(this,V.split(" ")):""!=V&&D.inlineContent?null:[]}for(let g in this.marks){let D=this.marks[g],L=D.spec.excludes;D.excluded=null==L?[D]:""==L?[]:We(this,L.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(l,u=null,g,D){if("string"==typeof l)l=this.nodeType(l);else{if(!(l instanceof Te))throw new RangeError("Invalid node type: "+l);if(l.schema!=this)throw new RangeError("Node type from different schema used ("+l.name+")")}return l.createChecked(u,g,D)}text(l,u){let g=this.nodes.text;return new S(g,g.defaultAttrs,l,nt.setFrom(u))}mark(l,u){return"string"==typeof l&&(l=this.marks[l]),l.create(u)}nodeFromJSON(l){return ft.fromJSON(this,l)}markFromJSON(l){return nt.fromJSON(this,l)}nodeType(l){let u=this.nodes[l];if(!u)throw new RangeError("Unknown node type: "+l);return u}}function We(H,l){let u=[];for(let g=0;g<l.length;g++){let D=l[g],L=H.marks[D],V=L;if(L)u.push(L);else for(let Tt in H.marks){let Rt=H.marks[Tt];("_"==D||Rt.spec.group&&Rt.spec.group.split(" ").indexOf(D)>-1)&&u.push(V=Rt)}if(!V)throw new SyntaxError("Unknown mark type: '"+l[g]+"'")}return u}class Ee{constructor(l,u){this.schema=l,this.rules=u,this.tags=[],this.styles=[],u.forEach(g=>{g.tag?this.tags.push(g):g.style&&this.styles.push(g)}),this.normalizeLists=!this.tags.some(g=>{if(!/^(ul|ol)\b/.test(g.tag)||!g.node)return!1;let D=l.nodes[g.node];return D.contentMatch.matchType(D)})}parse(l,u={}){let g=new A(this,u,!1);return g.addAll(l,u.from,u.to),g.finish()}parseSlice(l,u={}){let g=new A(this,u,!0);return g.addAll(l,u.from,u.to),pt.maxOpen(g.finish())}matchTag(l,u,g){for(let D=g?this.tags.indexOf(g)+1:0;D<this.tags.length;D++){let L=this.tags[D];if(Z(l,L.tag)&&(void 0===L.namespace||l.namespaceURI==L.namespace)&&(!L.context||u.matchesContext(L.context))){if(L.getAttrs){let V=L.getAttrs(l);if(!1===V)continue;L.attrs=V||void 0}return L}}}matchStyle(l,u,g,D){for(let L=D?this.styles.indexOf(D)+1:0;L<this.styles.length;L++){let V=this.styles[L],Tt=V.style;if(!(0!=Tt.indexOf(l)||V.context&&!g.matchesContext(V.context)||Tt.length>l.length&&(61!=Tt.charCodeAt(l.length)||Tt.slice(l.length+1)!=u))){if(V.getAttrs){let Rt=V.getAttrs(u);if(!1===Rt)continue;V.attrs=Rt||void 0}return V}}}static schemaRules(l){let u=[];function g(D){let L=null==D.priority?50:D.priority,V=0;for(;V<u.length;V++){let Tt=u[V];if((null==Tt.priority?50:Tt.priority)<L)break}u.splice(V,0,D)}for(let D in l.marks){let L=l.marks[D].spec.parseDOM;L&&L.forEach(V=>{g(V=G(V)),V.mark=D})}for(let D in l.nodes){let L=l.nodes[D].spec.parseDOM;L&&L.forEach(V=>{g(V=G(V)),V.node=D})}return u}static fromSchema(l){return l.cached.domParser||(l.cached.domParser=new Ee(l,Ee.schemaRules(l)))}}const Re={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Je={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},$e={ol:!0,ul:!0};function Q(H,l,u){return null!=l?(l?1:0)|("full"===l?2:0):H&&"pre"==H.whitespace?3:-5&u}class E{constructor(l,u,g,D,L,V,Tt){this.type=l,this.attrs=u,this.marks=g,this.pendingMarks=D,this.solid=L,this.options=Tt,this.content=[],this.activeMarks=nt.none,this.stashMarks=[],this.match=V||(4&Tt?null:l.contentMatch)}findWrapping(l){if(!this.match){if(!this.type)return[];let u=this.type.contentMatch.fillBefore(m.from(l));if(!u){let D,g=this.type.contentMatch;return(D=g.findWrapping(l.type))?(this.match=g,D):null}this.match=this.type.contentMatch.matchFragment(u)}return this.match.findWrapping(l.type)}finish(l){if(!(1&this.options)){let D,g=this.content[this.content.length-1];if(g&&g.isText&&(D=/[ \t\r\n\u000c]+$/.exec(g.text))){let L=g;g.text.length==D[0].length?this.content.pop():this.content[this.content.length-1]=L.withText(L.text.slice(0,L.text.length-D[0].length))}}let u=m.from(this.content);return!l&&this.match&&(u=u.append(this.match.fillBefore(m.empty,!0))),this.type?this.type.create(this.attrs,u,this.marks):u}popFromStashMark(l){for(let u=this.stashMarks.length-1;u>=0;u--)if(l.eq(this.stashMarks[u]))return this.stashMarks.splice(u,1)[0]}applyPending(l){for(let u=0,g=this.pendingMarks;u<g.length;u++){let D=g[u];(this.type?this.type.allowsMarkType(D.type):U(D.type,l))&&!D.isInSet(this.activeMarks)&&(this.activeMarks=D.addToSet(this.activeMarks),this.pendingMarks=D.removeFromSet(this.pendingMarks))}}inlineContext(l){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:l.parentNode&&!Re.hasOwnProperty(l.parentNode.nodeName.toLowerCase())}}class A{constructor(l,u,g){this.parser=l,this.options=u,this.isOpen=g,this.open=0;let L,D=u.topNode,V=Q(null,u.preserveWhitespace,0)|(g?4:0);L=D?new E(D.type,D.attrs,nt.none,nt.none,!0,u.topMatch||D.type.contentMatch,V):new E(g?null:l.schema.topNodeType,null,nt.none,nt.none,!0,null,V),this.nodes=[L],this.find=u.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(l){if(3==l.nodeType)this.addTextNode(l);else if(1==l.nodeType){let u=l.getAttribute("style"),g=u?this.readStyles(function(H){let u,l=/\s*([\w-]+)\s*:\s*([^;]+)/g,g=[];for(;u=l.exec(H);)g.push(u[1],u[2].trim());return g}(u)):null,D=this.top;if(null!=g)for(let L=0;L<g.length;L++)this.addPendingMark(g[L]);if(this.addElement(l),null!=g)for(let L=0;L<g.length;L++)this.removePendingMark(g[L],D)}}addTextNode(l){let u=l.nodeValue,g=this.top;if(2&g.options||g.inlineContext(l)||/[^ \t\r\n\u000c]/.test(u)){if(1&g.options)u=2&g.options?u.replace(/\r\n?/g,"\n"):u.replace(/\r?\n|\r/g," ");else if(u=u.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(u)&&this.open==this.nodes.length-1){let D=g.content[g.content.length-1],L=l.previousSibling;(!D||L&&"BR"==L.nodeName||D.isText&&/[ \t\r\n\u000c]$/.test(D.text))&&(u=u.slice(1))}u&&this.insertNode(this.parser.schema.text(u)),this.findInText(l)}else this.findInside(l)}addElement(l,u){let D,g=l.nodeName.toLowerCase();$e.hasOwnProperty(g)&&this.parser.normalizeLists&&function(H){for(let l=H.firstChild,u=null;l;l=l.nextSibling){let g=1==l.nodeType?l.nodeName.toLowerCase():null;g&&$e.hasOwnProperty(g)&&u?(u.appendChild(l),l=u):"li"==g?u=l:g&&(u=null)}}(l);let L=this.options.ruleFromNode&&this.options.ruleFromNode(l)||(D=this.parser.matchTag(l,this,u));if(L?L.ignore:Je.hasOwnProperty(g))this.findInside(l),this.ignoreFallback(l);else if(!L||L.skip||L.closeParent){L&&L.closeParent?this.open=Math.max(0,this.open-1):L&&L.skip.nodeType&&(l=L.skip);let V,Tt=this.top,Rt=this.needsBlock;if(Re.hasOwnProperty(g))V=!0,Tt.type||(this.needsBlock=!0);else if(!l.firstChild)return void this.leafFallback(l);this.addAll(l),V&&this.sync(Tt),this.needsBlock=Rt}else this.addElementByRule(l,L,!1===L.consuming?D:void 0)}leafFallback(l){"BR"==l.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(l.ownerDocument.createTextNode("\n"))}ignoreFallback(l){"BR"==l.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(l){let u=nt.none;t:for(let g=0;g<l.length;g+=2)for(let D;;){let L=this.parser.matchStyle(l[g],l[g+1],this,D);if(!L)continue t;if(L.ignore)return null;if(u=this.parser.schema.marks[L.mark].create(L.attrs).addToSet(u),!1!==L.consuming)break;D=L}return u}addElementByRule(l,u,g){let D,L,V;u.node?(L=this.parser.schema.nodes[u.node],L.isLeaf?this.insertNode(L.create(u.attrs))||this.leafFallback(l):D=this.enter(L,u.attrs||null,u.preserveWhitespace)):(V=this.parser.schema.marks[u.mark].create(u.attrs),this.addPendingMark(V));let Tt=this.top;if(L&&L.isLeaf)this.findInside(l);else if(g)this.addElement(l,g);else if(u.getContent)this.findInside(l),u.getContent(l,this.parser.schema).forEach(Rt=>this.insertNode(Rt));else{let Rt=l;"string"==typeof u.contentElement?Rt=l.querySelector(u.contentElement):"function"==typeof u.contentElement?Rt=u.contentElement(l):u.contentElement&&(Rt=u.contentElement),this.findAround(l,Rt,!0),this.addAll(Rt)}D&&this.sync(Tt)&&this.open--,V&&this.removePendingMark(V,Tt)}addAll(l,u,g){let D=u||0;for(let L=u?l.childNodes[u]:l.firstChild,V=null==g?null:l.childNodes[g];L!=V;L=L.nextSibling,++D)this.findAtPoint(l,D),this.addDOM(L);this.findAtPoint(l,D)}findPlace(l){let u,g;for(let D=this.open;D>=0;D--){let L=this.nodes[D],V=L.findWrapping(l);if(V&&(!u||u.length>V.length)&&(u=V,g=L,!V.length)||L.solid)break}if(!u)return!1;this.sync(g);for(let D=0;D<u.length;D++)this.enterInner(u[D],null,!1);return!0}insertNode(l){if(l.isInline&&this.needsBlock&&!this.top.type){let u=this.textblockFromContext();u&&this.enterInner(u)}if(this.findPlace(l)){this.closeExtra();let u=this.top;u.applyPending(l.type),u.match&&(u.match=u.match.matchType(l.type));let g=u.activeMarks;for(let D=0;D<l.marks.length;D++)(!u.type||u.type.allowsMarkType(l.marks[D].type))&&(g=l.marks[D].addToSet(g));return u.content.push(l.mark(g)),!0}return!1}enter(l,u,g){let D=this.findPlace(l.create(u));return D&&this.enterInner(l,u,!0,g),D}enterInner(l,u=null,g=!1,D){this.closeExtra();let L=this.top;L.applyPending(l),L.match=L.match&&L.match.matchType(l);let V=Q(l,D,L.options);4&L.options&&0==L.content.length&&(V|=4),this.nodes.push(new E(l,u,L.activeMarks,L.pendingMarks,g,null,V)),this.open++}closeExtra(l=!1){let u=this.nodes.length-1;if(u>this.open){for(;u>this.open;u--)this.nodes[u-1].content.push(this.nodes[u].finish(l));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(l){for(let u=this.open;u>=0;u--)if(this.nodes[u]==l)return this.open=u,!0;return!1}get currentPos(){this.closeExtra();let l=0;for(let u=this.open;u>=0;u--){let g=this.nodes[u].content;for(let D=g.length-1;D>=0;D--)l+=g[D].nodeSize;u&&l++}return l}findAtPoint(l,u){if(this.find)for(let g=0;g<this.find.length;g++)this.find[g].node==l&&this.find[g].offset==u&&(this.find[g].pos=this.currentPos)}findInside(l){if(this.find)for(let u=0;u<this.find.length;u++)null==this.find[u].pos&&1==l.nodeType&&l.contains(this.find[u].node)&&(this.find[u].pos=this.currentPos)}findAround(l,u,g){if(l!=u&&this.find)for(let D=0;D<this.find.length;D++)null==this.find[D].pos&&1==l.nodeType&&l.contains(this.find[D].node)&&u.compareDocumentPosition(this.find[D].node)&(g?2:4)&&(this.find[D].pos=this.currentPos)}findInText(l){if(this.find)for(let u=0;u<this.find.length;u++)this.find[u].node==l&&(this.find[u].pos=this.currentPos-(l.nodeValue.length-this.find[u].offset))}matchesContext(l){if(l.indexOf("|")>-1)return l.split(/\s*\|\s*/).some(this.matchesContext,this);let u=l.split("/"),g=this.options.context,D=!(this.isOpen||g&&g.parent.type!=this.nodes[0].type),L=(D?0:1)-(g?g.depth+1:0),V=(Tt,Rt)=>{for(;Tt>=0;Tt--){let Vt=u[Tt];if(""==Vt){if(Tt==u.length-1||0==Tt)continue;for(;Rt>=L;Rt--)if(V(Tt-1,Rt))return!0;return!1}{let Xt=Rt>0||0==Rt&&D?this.nodes[Rt].type:g&&Rt>=L?g.node(Rt-L).type:null;if(!Xt||Xt.name!=Vt&&-1==Xt.groups.indexOf(Vt))return!1;Rt--}}return!0};return V(u.length-1,this.open)}textblockFromContext(){let l=this.options.context;if(l)for(let u=l.depth;u>=0;u--){let g=l.node(u).contentMatchAt(l.indexAfter(u)).defaultType;if(g&&g.isTextblock&&g.defaultAttrs)return g}for(let u in this.parser.schema.nodes){let g=this.parser.schema.nodes[u];if(g.isTextblock&&g.defaultAttrs)return g}}addPendingMark(l){let u=function(H,l){for(let u=0;u<l.length;u++)if(H.eq(l[u]))return l[u]}(l,this.top.pendingMarks);u&&this.top.stashMarks.push(u),this.top.pendingMarks=l.addToSet(this.top.pendingMarks)}removePendingMark(l,u){for(let g=this.open;g>=0;g--){let D=this.nodes[g];if(D.pendingMarks.lastIndexOf(l)>-1)D.pendingMarks=l.removeFromSet(D.pendingMarks);else{D.activeMarks=l.removeFromSet(D.activeMarks);let V=D.popFromStashMark(l);V&&D.type&&D.type.allowsMarkType(V.type)&&(D.activeMarks=V.addToSet(D.activeMarks))}if(D==u)break}}}function Z(H,l){return(H.matches||H.msMatchesSelector||H.webkitMatchesSelector||H.mozMatchesSelector).call(H,l)}function G(H){let l={};for(let u in H)l[u]=H[u];return l}function U(H,l){let u=l.schema.nodes;for(let g in u){let D=u[g];if(!D.allowsMarkType(H))continue;let L=[],V=Tt=>{L.push(Tt);for(let Rt=0;Rt<Tt.edgeCount;Rt++){let{type:Vt,next:Xt}=Tt.edge(Rt);if(Vt==l||L.indexOf(Xt)<0&&V(Xt))return!0}};if(V(D.contentMatch))return!0}}class Ut{constructor(l,u){this.nodes=l,this.marks=u}serializeFragment(l,u={},g){g||(g=Zt(u).createDocumentFragment());let D=g,L=[];return l.forEach(V=>{if(L.length||V.marks.length){let Tt=0,Rt=0;for(;Tt<L.length&&Rt<V.marks.length;){let Vt=V.marks[Rt];if(this.marks[Vt.type.name]){if(!Vt.eq(L[Tt][0])||!1===Vt.type.spec.spanning)break;Tt++,Rt++}else Rt++}for(;Tt<L.length;)D=L.pop()[1];for(;Rt<V.marks.length;){let Vt=V.marks[Rt++],Xt=this.serializeMark(Vt,V.isInline,u);Xt&&(L.push([Vt,D]),D.appendChild(Xt.dom),D=Xt.contentDOM||Xt.dom)}}D.appendChild(this.serializeNodeInner(V,u))}),g}serializeNodeInner(l,u){let{dom:g,contentDOM:D}=Ut.renderSpec(Zt(u),this.nodes[l.type.name](l));if(D){if(l.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(l.content,u,D)}return g}serializeNode(l,u={}){let g=this.serializeNodeInner(l,u);for(let D=l.marks.length-1;D>=0;D--){let L=this.serializeMark(l.marks[D],l.isInline,u);L&&((L.contentDOM||L.dom).appendChild(g),g=L.dom)}return g}serializeMark(l,u,g={}){let D=this.marks[l.type.name];return D&&Ut.renderSpec(Zt(g),D(l,u))}static renderSpec(l,u,g=null){if("string"==typeof u)return{dom:l.createTextNode(u)};if(null!=u.nodeType)return{dom:u};if(u.dom&&null!=u.dom.nodeType)return u;let D=u[0],L=D.indexOf(" ");L>0&&(g=D.slice(0,L),D=D.slice(L+1));let V,Tt=g?l.createElementNS(g,D):l.createElement(D),Rt=u[1],Vt=1;if(Rt&&"object"==typeof Rt&&null==Rt.nodeType&&!Array.isArray(Rt)){Vt=2;for(let Xt in Rt)if(null!=Rt[Xt]){let Me=Xt.indexOf(" ");Me>0?Tt.setAttributeNS(Xt.slice(0,Me),Xt.slice(Me+1),Rt[Xt]):Tt.setAttribute(Xt,Rt[Xt])}}for(let Xt=Vt;Xt<u.length;Xt++){let Me=u[Xt];if(0===Me){if(Xt<u.length-1||Xt>Vt)throw new RangeError("Content hole must be the only child of its parent node");return{dom:Tt,contentDOM:Tt}}{let{dom:cn,contentDOM:be}=Ut.renderSpec(l,Me,g);if(Tt.appendChild(cn),be){if(V)throw new RangeError("Multiple content holes");V=be}}}return{dom:Tt,contentDOM:V}}static fromSchema(l){return l.cached.domSerializer||(l.cached.domSerializer=new Ut(this.nodesFromSchema(l),this.marksFromSchema(l)))}static nodesFromSchema(l){let u=Ft(l.nodes);return u.text||(u.text=g=>g.text),u}static marksFromSchema(l){return Ft(l.marks)}}function Ft(H){let l={};for(let u in H){let g=H[u].spec.toDOM;g&&(l[u]=g)}return l}function Zt(H){return H.document||window.document}},62463:(Jt,Et,d)=>{d.d(Et,{C1:()=>Ot,yy:()=>At,qv:()=>at,Sy:()=>rt,H$:()=>Yt,Y1:()=>P,xm:()=>m,Bs:()=>mt});var T=d(35917),s=d(38480);const b=Object.create(null);class P{constructor(S,et,lt){this.$anchor=S,this.$head=et,this.ranges=lt||[new m(S.min(et),S.max(et))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let S=this.ranges;for(let et=0;et<S.length;et++)if(S[et].$from.pos!=S[et].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(S,et=T.p2.empty){let lt=et.content.lastChild,Mt=null;for(let dt=0;dt<et.openEnd;dt++)Mt=lt,lt=lt.lastChild;let F=S.steps.length,K=this.ranges;for(let dt=0;dt<K.length;dt++){let{$from:Bt,$to:$t}=K[dt],qt=S.mapping.slice(F);S.replaceRange(qt.map(Bt.pos),qt.map($t.pos),dt?T.p2.empty:et),0==dt&&Lt(S,F,(lt?lt.isInline:Mt&&Mt.isTextblock)?-1:1)}}replaceWith(S,et){let lt=S.steps.length,Mt=this.ranges;for(let F=0;F<Mt.length;F++){let{$from:K,$to:dt}=Mt[F],Bt=S.mapping.slice(lt),$t=Bt.map(K.pos),qt=Bt.map(dt.pos);F?S.deleteRange($t,qt):(S.replaceRangeWith($t,qt,et),Lt(S,lt,et.isInline?-1:1))}}static findFrom(S,et,lt=!1){let Mt=S.parent.inlineContent?new mt(S):_t(S.node(0),S.parent,S.pos,S.index(),et,lt);if(Mt)return Mt;for(let F=S.depth-1;F>=0;F--){let K=et<0?_t(S.node(0),S.node(F),S.before(F+1),S.index(F),et,lt):_t(S.node(0),S.node(F),S.after(F+1),S.index(F)+1,et,lt);if(K)return K}return null}static near(S,et=1){return this.findFrom(S,et)||this.findFrom(S,-et)||new Ot(S.node(0))}static atStart(S){return _t(S,S,0,0,1)||new Ot(S)}static atEnd(S){return _t(S,S,S.content.size,S.childCount,-1)||new Ot(S)}static fromJSON(S,et){if(!et||!et.type)throw new RangeError("Invalid input for Selection.fromJSON");let lt=b[et.type];if(!lt)throw new RangeError(`No selection type ${et.type} defined`);return lt.fromJSON(S,et)}static jsonID(S,et){if(S in b)throw new RangeError("Duplicate use of selection JSON ID "+S);return b[S]=et,et.prototype.jsonID=S,et}getBookmark(){return mt.between(this.$anchor,this.$head).getBookmark()}}P.prototype.visible=!0;class m{constructor(S,et){this.$from=S,this.$to=et}}let ut=!1;function k(ft){!ut&&!ft.parent.inlineContent&&(ut=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+ft.parent.type.name+")"))}class mt extends P{constructor(S,et=S){k(S),k(et),super(S,et)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(S,et){let lt=S.resolve(et.map(this.head));if(!lt.parent.inlineContent)return P.near(lt);let Mt=S.resolve(et.map(this.anchor));return new mt(Mt.parent.inlineContent?Mt:lt,lt)}replace(S,et=T.p2.empty){if(super.replace(S,et),et==T.p2.empty){let lt=this.$from.marksAcross(this.$to);lt&&S.ensureMarks(lt)}}eq(S){return S instanceof mt&&S.anchor==this.anchor&&S.head==this.head}getBookmark(){return new nt(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(S,et){if("number"!=typeof et.anchor||"number"!=typeof et.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new mt(S.resolve(et.anchor),S.resolve(et.head))}static create(S,et,lt=et){let Mt=S.resolve(et);return new this(Mt,lt==et?Mt:S.resolve(lt))}static between(S,et,lt){let Mt=S.pos-et.pos;if((!lt||Mt)&&(lt=Mt>=0?1:-1),!et.parent.inlineContent){let F=P.findFrom(et,lt,!0)||P.findFrom(et,-lt,!0);if(!F)return P.near(et,lt);et=F.$head}return S.parent.inlineContent||(0==Mt||(S=(P.findFrom(S,-lt,!0)||P.findFrom(S,lt,!0)).$anchor).pos<et.pos!=Mt<0)&&(S=et),new mt(S,et)}}P.jsonID("text",mt);class nt{constructor(S,et){this.anchor=S,this.head=et}map(S){return new nt(S.map(this.anchor),S.map(this.head))}resolve(S){return mt.between(S.resolve(this.anchor),S.resolve(this.head))}}class at extends P{constructor(S){let et=S.nodeAfter,lt=S.node(0).resolve(S.pos+et.nodeSize);super(S,lt),this.node=et}map(S,et){let{deleted:lt,pos:Mt}=et.mapResult(this.anchor),F=S.resolve(Mt);return lt?P.near(F):new at(F)}content(){return new T.p2(T.HY.from(this.node),0,0)}eq(S){return S instanceof at&&S.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new pt(this.anchor)}static fromJSON(S,et){if("number"!=typeof et.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new at(S.resolve(et.anchor))}static create(S,et){return new at(S.resolve(et))}static isSelectable(S){return!S.isText&&!1!==S.type.spec.selectable}}at.prototype.visible=!1,P.jsonID("node",at);class pt{constructor(S){this.anchor=S}map(S){let{deleted:et,pos:lt}=S.mapResult(this.anchor);return et?new nt(lt,lt):new pt(lt)}resolve(S){let et=S.resolve(this.anchor),lt=et.nodeAfter;return lt&&at.isSelectable(lt)?new at(et):P.near(et)}}class Ot extends P{constructor(S){super(S.resolve(0),S.resolve(S.content.size))}replace(S,et=T.p2.empty){if(et==T.p2.empty){S.delete(0,S.doc.content.size);let lt=P.atStart(S.doc);lt.eq(S.selection)||S.setSelection(lt)}else super.replace(S,et)}toJSON(){return{type:"all"}}static fromJSON(S){return new Ot(S)}map(S){return new Ot(S)}eq(S){return S instanceof Ot}getBookmark(){return gt}}P.jsonID("all",Ot);const gt={map(){return this},resolve:ft=>new Ot(ft)};function _t(ft,S,et,lt,Mt,F=!1){if(S.inlineContent)return mt.create(ft,et);for(let K=lt-(Mt>0?0:1);Mt>0?K<S.childCount:K>=0;K+=Mt){let dt=S.child(K);if(dt.isAtom){if(!F&&at.isSelectable(dt))return at.create(ft,et-(Mt<0?dt.nodeSize:0))}else{let Bt=_t(ft,dt,et+Mt,Mt<0?dt.childCount:0,Mt,F);if(Bt)return Bt}et+=dt.nodeSize*Mt}return null}function Lt(ft,S,et){let lt=ft.steps.length-1;if(lt<S)return;let K,Mt=ft.steps[lt];(Mt instanceof s.Pu||Mt instanceof s.FC)&&(ft.mapping.maps[lt].forEach((dt,Bt,$t,qt)=>{null==K&&(K=qt)}),ft.setSelection(P.near(ft.doc.resolve(K),et)))}class X extends s.wx{constructor(S){super(S.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=S.selection,this.storedMarks=S.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(S){if(S.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=S,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(S){return this.storedMarks=S,this.updated|=2,this}ensureMarks(S){return T.vc.sameSet(this.storedMarks||this.selection.$from.marks(),S)||this.setStoredMarks(S),this}addStoredMark(S){return this.ensureMarks(S.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(S){return this.ensureMarks(S.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(S,et){super.addStep(S,et),this.updated=-3&this.updated,this.storedMarks=null}setTime(S){return this.time=S,this}replaceSelection(S){return this.selection.replace(this,S),this}replaceSelectionWith(S,et=!0){let lt=this.selection;return et&&(S=S.mark(this.storedMarks||(lt.empty?lt.$from.marks():lt.$from.marksAcross(lt.$to)||T.vc.none))),lt.replaceWith(this,S),this}deleteSelection(){return this.selection.replace(this),this}insertText(S,et,lt){let Mt=this.doc.type.schema;if(null==et)return S?this.replaceSelectionWith(Mt.text(S),!0):this.deleteSelection();{if(null==lt&&(lt=et),lt=null==lt?et:lt,!S)return this.deleteRange(et,lt);let F=this.storedMarks;if(!F){let K=this.doc.resolve(et);F=lt==et?K.marks():K.marksAcross(this.doc.resolve(lt))}return this.replaceRangeWith(et,lt,Mt.text(S,F)),this.selection.empty||this.setSelection(P.near(this.selection.$to)),this}}setMeta(S,et){return this.meta["string"==typeof S?S:S.key]=et,this}getMeta(S){return this.meta["string"==typeof S?S:S.key]}get isGeneric(){for(let S in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function ct(ft,S){return S&&ft?ft.bind(S):ft}class z{constructor(S,et,lt){this.name=S,this.init=ct(et.init,lt),this.apply=ct(et.apply,lt)}}const Ct=[new z("doc",{init:ft=>ft.doc||ft.schema.topNodeType.createAndFill(),apply:ft=>ft.doc}),new z("selection",{init:(ft,S)=>ft.selection||P.atStart(S.doc),apply:ft=>ft.selection}),new z("storedMarks",{init:ft=>ft.storedMarks||null,apply:(ft,S,et,lt)=>lt.selection.$cursor?ft.storedMarks:null}),new z("scrollToSelection",{init:()=>0,apply:(ft,S)=>ft.scrolledIntoView?S+1:S})];class xt{constructor(S,et){this.schema=S,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Ct.slice(),et&&et.forEach(lt=>{if(this.pluginsByKey[lt.key])throw new RangeError("Adding different instances of a keyed plugin ("+lt.key+")");this.plugins.push(lt),this.pluginsByKey[lt.key]=lt,lt.spec.state&&this.fields.push(new z(lt.key,lt.spec.state,lt))})}}class At{constructor(S){this.config=S}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(S){return this.applyTransaction(S).state}filterTransaction(S,et=-1){for(let lt=0;lt<this.config.plugins.length;lt++)if(lt!=et){let Mt=this.config.plugins[lt];if(Mt.spec.filterTransaction&&!Mt.spec.filterTransaction.call(Mt,S,this))return!1}return!0}applyTransaction(S){if(!this.filterTransaction(S))return{state:this,transactions:[]};let et=[S],lt=this.applyInner(S),Mt=null;for(;;){let F=!1;for(let K=0;K<this.config.plugins.length;K++){let dt=this.config.plugins[K];if(dt.spec.appendTransaction){let Bt=Mt?Mt[K].n:0,$t=Mt?Mt[K].state:this,qt=Bt<et.length&&dt.spec.appendTransaction.call(dt,Bt?et.slice(Bt):et,$t,lt);if(qt&&lt.filterTransaction(qt,K)){if(qt.setMeta("appendedTransaction",S),!Mt){Mt=[];for(let ae=0;ae<this.config.plugins.length;ae++)Mt.push(ae<K?{state:lt,n:et.length}:{state:this,n:0})}et.push(qt),lt=lt.applyInner(qt),F=!0}Mt&&(Mt[K]={state:lt,n:et.length})}}if(!F)return{state:lt,transactions:et}}}applyInner(S){if(!S.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let et=new At(this.config),lt=this.config.fields;for(let Mt=0;Mt<lt.length;Mt++){let F=lt[Mt];et[F.name]=F.apply(S,this[F.name],this,et)}return et}get tr(){return new X(this)}static create(S){let et=new xt(S.doc?S.doc.type.schema:S.schema,S.plugins),lt=new At(et);for(let Mt=0;Mt<et.fields.length;Mt++)lt[et.fields[Mt].name]=et.fields[Mt].init(S,lt);return lt}reconfigure(S){let et=new xt(this.schema,S.plugins),lt=et.fields,Mt=new At(et);for(let F=0;F<lt.length;F++){let K=lt[F].name;Mt[K]=this.hasOwnProperty(K)?this[K]:lt[F].init(S,Mt)}return Mt}toJSON(S){let et={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(et.storedMarks=this.storedMarks.map(lt=>lt.toJSON())),S&&"object"==typeof S)for(let lt in S){if("doc"==lt||"selection"==lt)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let Mt=S[lt],F=Mt.spec.state;F&&F.toJSON&&(et[lt]=F.toJSON.call(Mt,this[Mt.key]))}return et}static fromJSON(S,et,lt){if(!et)throw new RangeError("Invalid input for EditorState.fromJSON");if(!S.schema)throw new RangeError("Required config field 'schema' missing");let Mt=new xt(S.schema,S.plugins),F=new At(Mt);return Mt.fields.forEach(K=>{if("doc"==K.name)F.doc=T.NB.fromJSON(S.schema,et.doc);else if("selection"==K.name)F.selection=P.fromJSON(F.doc,et.selection);else if("storedMarks"==K.name)et.storedMarks&&(F.storedMarks=et.storedMarks.map(S.schema.markFromJSON));else{if(lt)for(let dt in lt){let Bt=lt[dt],$t=Bt.spec.state;if(Bt.key==K.name&&$t&&$t.fromJSON&&Object.prototype.hasOwnProperty.call(et,dt))return void(F[K.name]=$t.fromJSON.call(Bt,S,et[dt],F))}F[K.name]=K.init(S,F)}}),F}}function yt(ft,S,et){for(let lt in ft){let Mt=ft[lt];Mt instanceof Function?Mt=Mt.bind(S):"handleDOMEvents"==lt&&(Mt=yt(Mt,S,{})),et[lt]=Mt}return et}class rt{constructor(S){this.spec=S,this.props={},S.props&&yt(S.props,this,this.props),this.key=S.key?S.key.key:Nt("plugin")}getState(S){return S[this.key]}}const bt=Object.create(null);function Nt(ft){return ft in bt?ft+"$"+ ++bt[ft]:(bt[ft]=0,ft+"$")}class Yt{constructor(S="key"){this.key=Nt(S)}get(S){return S.config.pluginsByKey[this.key]}getState(S){return S[this.key]}}},38480:(Jt,Et,d)=>{d.d(Et,{vs:()=>gt,FC:()=>z,Pu:()=>ct,wx:()=>Ae,Mn:()=>$t,Ax:()=>dt,nj:()=>Ke,nd:()=>Yt,k9:()=>bt,dR:()=>Qe});var T=d(35917);const b=Math.pow(2,16);function P(Q,E){return Q+E*b}function m(Q){return 65535&Q}class pt{constructor(E,A,B){this.pos=E,this.delInfo=A,this.recover=B}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Ot{constructor(E,A=!1){if(this.ranges=E,this.inverted=A,!E.length&&Ot.empty)return Ot.empty}recover(E){let A=0,B=m(E);if(!this.inverted)for(let Z=0;Z<B;Z++)A+=this.ranges[3*Z+2]-this.ranges[3*Z+1];return this.ranges[3*B]+A+((Q=E)-(65535&Q))/b;var Q}mapResult(E,A=1){return this._map(E,A,!1)}map(E,A=1){return this._map(E,A,!0)}_map(E,A,B){let Z=0,W=this.inverted?2:1,G=this.inverted?1:2;for(let U=0;U<this.ranges.length;U+=3){let Pt=this.ranges[U]-(this.inverted?Z:0);if(Pt>E)break;let Ut=this.ranges[U+W],Ft=this.ranges[U+G],Zt=Pt+Ut;if(E<=Zt){let l=Pt+Z+((Ut?E==Pt?-1:E==Zt?1:A:A)<0?0:Ft);if(B)return l;let u=E==(A<0?Pt:Zt)?null:P(U/3,E-Pt),g=E==Pt?2:E==Zt?1:4;return(A<0?E!=Pt:E!=Zt)&&(g|=8),new pt(l,g,u)}Z+=Ft-Ut}return B?E+Z:new pt(E+Z,0,null)}touches(E,A){let B=0,Z=m(A),W=this.inverted?2:1,G=this.inverted?1:2;for(let U=0;U<this.ranges.length;U+=3){let Pt=this.ranges[U]-(this.inverted?B:0);if(Pt>E)break;let Ut=this.ranges[U+W];if(E<=Pt+Ut&&U==3*Z)return!0;B+=this.ranges[U+G]-Ut}return!1}forEach(E){let A=this.inverted?2:1,B=this.inverted?1:2;for(let Z=0,W=0;Z<this.ranges.length;Z+=3){let G=this.ranges[Z],U=G-(this.inverted?W:0),Pt=G+(this.inverted?0:W),Ut=this.ranges[Z+A],Ft=this.ranges[Z+B];E(U,U+Ut,Pt,Pt+Ft),W+=Ft-Ut}}invert(){return new Ot(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(E){return 0==E?Ot.empty:new Ot(E<0?[0,-E,0]:[0,0,E])}}Ot.empty=new Ot([]);class gt{constructor(E=[],A,B=0,Z=E.length){this.maps=E,this.mirror=A,this.from=B,this.to=Z}slice(E=0,A=this.maps.length){return new gt(this.maps,this.mirror,E,A)}copy(){return new gt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(E,A){this.to=this.maps.push(E),null!=A&&this.setMirror(this.maps.length-1,A)}appendMapping(E){for(let A=0,B=this.maps.length;A<E.maps.length;A++){let Z=E.getMirror(A);this.appendMap(E.maps[A],null!=Z&&Z<A?B+Z:void 0)}}getMirror(E){if(this.mirror)for(let A=0;A<this.mirror.length;A++)if(this.mirror[A]==E)return this.mirror[A+(A%2?-1:1)]}setMirror(E,A){this.mirror||(this.mirror=[]),this.mirror.push(E,A)}appendMappingInverted(E){for(let A=E.maps.length-1,B=this.maps.length+E.maps.length;A>=0;A--){let Z=E.getMirror(A);this.appendMap(E.maps[A].invert(),null!=Z&&Z>A?B-Z-1:void 0)}}invert(){let E=new gt;return E.appendMappingInverted(this),E}map(E,A=1){if(this.mirror)return this._map(E,A,!0);for(let B=this.from;B<this.to;B++)E=this.maps[B].map(E,A);return E}mapResult(E,A=1){return this._map(E,A,!1)}_map(E,A,B){let Z=0;for(let W=this.from;W<this.to;W++){let U=this.maps[W].mapResult(E,A);if(null!=U.recover){let Pt=this.getMirror(W);if(null!=Pt&&Pt>W&&Pt<this.to){W=Pt,E=this.maps[Pt].recover(U.recover);continue}}Z|=U.delInfo,E=U.pos}return B?E:new pt(E,Z,null)}}const _t=Object.create(null);class Lt{getMap(){return Ot.empty}merge(E){return null}static fromJSON(E,A){if(!A||!A.stepType)throw new RangeError("Invalid input for Step.fromJSON");let B=_t[A.stepType];if(!B)throw new RangeError(`No step type ${A.stepType} defined`);return B.fromJSON(E,A)}static jsonID(E,A){if(E in _t)throw new RangeError("Duplicate use of step JSON ID "+E);return _t[E]=A,A.prototype.jsonID=E,A}}class It{constructor(E,A){this.doc=E,this.failed=A}static ok(E){return new It(E,null)}static fail(E){return new It(null,E)}static fromReplace(E,A,B,Z){try{return It.ok(E.replace(A,B,Z))}catch(W){if(W instanceof T.e4)return It.fail(W.message);throw W}}}function Dt(Q,E,A){let B=[];for(let Z=0;Z<Q.childCount;Z++){let W=Q.child(Z);W.content.size&&(W=W.copy(Dt(W.content,E,W))),W.isInline&&(W=E(W,A,Z)),B.push(W)}return T.HY.fromArray(B)}class ht extends Lt{constructor(E,A,B){super(),this.from=E,this.to=A,this.mark=B}apply(E){let A=E.slice(this.from,this.to),B=E.resolve(this.from),Z=B.node(B.sharedDepth(this.to)),W=new T.p2(Dt(A.content,(G,U)=>G.isAtom&&U.type.allowsMarkType(this.mark.type)?G.mark(this.mark.addToSet(G.marks)):G,Z),A.openStart,A.openEnd);return It.fromReplace(E,this.from,this.to,W)}invert(){return new X(this.from,this.to,this.mark)}map(E){let A=E.mapResult(this.from,1),B=E.mapResult(this.to,-1);return A.deleted&&B.deleted||A.pos>=B.pos?null:new ht(A.pos,B.pos,this.mark)}merge(E){return E instanceof ht&&E.mark.eq(this.mark)&&this.from<=E.to&&this.to>=E.from?new ht(Math.min(this.from,E.from),Math.max(this.to,E.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(E,A){if("number"!=typeof A.from||"number"!=typeof A.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ht(A.from,A.to,E.markFromJSON(A.mark))}}Lt.jsonID("addMark",ht);class X extends Lt{constructor(E,A,B){super(),this.from=E,this.to=A,this.mark=B}apply(E){let A=E.slice(this.from,this.to),B=new T.p2(Dt(A.content,Z=>Z.mark(this.mark.removeFromSet(Z.marks)),E),A.openStart,A.openEnd);return It.fromReplace(E,this.from,this.to,B)}invert(){return new ht(this.from,this.to,this.mark)}map(E){let A=E.mapResult(this.from,1),B=E.mapResult(this.to,-1);return A.deleted&&B.deleted||A.pos>=B.pos?null:new X(A.pos,B.pos,this.mark)}merge(E){return E instanceof X&&E.mark.eq(this.mark)&&this.from<=E.to&&this.to>=E.from?new X(Math.min(this.from,E.from),Math.max(this.to,E.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(E,A){if("number"!=typeof A.from||"number"!=typeof A.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new X(A.from,A.to,E.markFromJSON(A.mark))}}Lt.jsonID("removeMark",X);class ct extends Lt{constructor(E,A,B,Z=!1){super(),this.from=E,this.to=A,this.slice=B,this.structure=Z}apply(E){return this.structure&&Ct(E,this.from,this.to)?It.fail("Structure replace would overwrite content"):It.fromReplace(E,this.from,this.to,this.slice)}getMap(){return new Ot([this.from,this.to-this.from,this.slice.size])}invert(E){return new ct(this.from,this.from+this.slice.size,E.slice(this.from,this.to))}map(E){let A=E.mapResult(this.from,1),B=E.mapResult(this.to,-1);return A.deletedAcross&&B.deletedAcross?null:new ct(A.pos,Math.max(A.pos,B.pos),this.slice)}merge(E){if(!(E instanceof ct)||E.structure||this.structure)return null;if(this.from+this.slice.size!=E.from||this.slice.openEnd||E.slice.openStart){if(E.to!=this.from||this.slice.openStart||E.slice.openEnd)return null;{let A=this.slice.size+E.slice.size==0?T.p2.empty:new T.p2(E.slice.content.append(this.slice.content),E.slice.openStart,this.slice.openEnd);return new ct(E.from,this.to,A,this.structure)}}{let A=this.slice.size+E.slice.size==0?T.p2.empty:new T.p2(this.slice.content.append(E.slice.content),this.slice.openStart,E.slice.openEnd);return new ct(this.from,this.to+(E.to-E.from),A,this.structure)}}toJSON(){let E={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(E.slice=this.slice.toJSON()),this.structure&&(E.structure=!0),E}static fromJSON(E,A){if("number"!=typeof A.from||"number"!=typeof A.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ct(A.from,A.to,T.p2.fromJSON(E,A.slice),!!A.structure)}}Lt.jsonID("replace",ct);class z extends Lt{constructor(E,A,B,Z,W,G,U=!1){super(),this.from=E,this.to=A,this.gapFrom=B,this.gapTo=Z,this.slice=W,this.insert=G,this.structure=U}apply(E){if(this.structure&&(Ct(E,this.from,this.gapFrom)||Ct(E,this.gapTo,this.to)))return It.fail("Structure gap-replace would overwrite content");let A=E.slice(this.gapFrom,this.gapTo);if(A.openStart||A.openEnd)return It.fail("Gap is not a flat range");let B=this.slice.insertAt(this.insert,A.content);return B?It.fromReplace(E,this.from,this.to,B):It.fail("Content does not fit in gap")}getMap(){return new Ot([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(E){let A=this.gapTo-this.gapFrom;return new z(this.from,this.from+this.slice.size+A,this.from+this.insert,this.from+this.insert+A,E.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(E){let A=E.mapResult(this.from,1),B=E.mapResult(this.to,-1),Z=E.map(this.gapFrom,-1),W=E.map(this.gapTo,1);return A.deletedAcross&&B.deletedAcross||Z<A.pos||W>B.pos?null:new z(A.pos,B.pos,Z,W,this.slice,this.insert,this.structure)}toJSON(){let E={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(E.slice=this.slice.toJSON()),this.structure&&(E.structure=!0),E}static fromJSON(E,A){if("number"!=typeof A.from||"number"!=typeof A.to||"number"!=typeof A.gapFrom||"number"!=typeof A.gapTo||"number"!=typeof A.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new z(A.from,A.to,A.gapFrom,A.gapTo,T.p2.fromJSON(E,A.slice),A.insert,!!A.structure)}}function Ct(Q,E,A){let B=Q.resolve(E),Z=A-E,W=B.depth;for(;Z>0&&W>0&&B.indexAfter(W)==B.node(W).childCount;)W--,Z--;if(Z>0){let G=B.node(W).maybeChild(B.indexAfter(W));for(;Z>0;){if(!G||G.isLeaf)return!0;G=G.firstChild,Z--}}return!1}function rt(Q,E,A){return(0==E||Q.canReplace(E,Q.childCount))&&(A==Q.childCount||Q.canReplace(0,A))}function bt(Q){let A=Q.parent.content.cutByIndex(Q.startIndex,Q.endIndex);for(let B=Q.depth;;--B){let Z=Q.$from.node(B),W=Q.$from.index(B),G=Q.$to.indexAfter(B);if(B<Q.depth&&Z.canReplace(W,G,A))return B;if(0==B||Z.type.spec.isolating||!rt(Z,W,G))break}return null}function Yt(Q,E,A=null,B=Q){let Z=function(Q,E){let{parent:A,startIndex:B,endIndex:Z}=Q,W=A.contentMatchAt(B).findWrapping(E);return W&&A.canReplaceWith(B,Z,W.length?W[0]:E)?W:null}(Q,E),W=Z&&function(Q,E){let{parent:A,startIndex:B,endIndex:Z}=Q,W=A.child(B),G=E.contentMatch.findWrapping(W.type);if(!G)return null;let Pt=(G.length?G[G.length-1]:E).contentMatch;for(let Ut=B;Pt&&Ut<Z;Ut++)Pt=Pt.matchType(A.child(Ut).type);return Pt&&Pt.validEnd?G:null}(B,E);return W?Z.map(ft).concat({type:E,attrs:A}).concat(W.map(ft)):null}function ft(Q){return{type:Q,attrs:null}}function dt(Q,E,A=1,B){let Z=Q.resolve(E),W=Z.depth-A,G=B&&B[B.length-1]||Z.parent;if(W<0||Z.parent.type.spec.isolating||!Z.parent.canReplace(Z.index(),Z.parent.childCount)||!G.type.validContent(Z.parent.content.cutByIndex(Z.index(),Z.parent.childCount)))return!1;for(let Ut=Z.depth-1,Ft=A-2;Ut>W;Ut--,Ft--){let Zt=Z.node(Ut),H=Z.index(Ut);if(Zt.type.spec.isolating)return!1;let l=Zt.content.cutByIndex(H,Zt.childCount),u=B&&B[Ft]||Zt;if(u!=Zt&&(l=l.replaceChild(0,u.type.create(u.attrs))),!Zt.canReplace(H+1,Zt.childCount)||!u.type.validContent(l))return!1}let U=Z.indexAfter(W),Pt=B&&B[0];return Z.node(W).canReplaceWith(U,U,Pt?Pt.type:Z.node(W+1).type)}function $t(Q,E){let A=Q.resolve(E),B=A.index();return function(Q,E){return!(!Q||!E||Q.isLeaf||!Q.canAppend(E))}(A.nodeBefore,A.nodeAfter)&&A.parent.canReplace(B,B+1)}function Ke(Q,E,A){let B=Q.resolve(E);if(!A.content.size)return E;let Z=A.content;for(let W=0;W<A.openStart;W++)Z=Z.firstChild.content;for(let W=1;W<=(0==A.openStart&&A.size?2:1);W++)for(let G=B.depth;G>=0;G--){let U=G==B.depth?0:B.pos<=(B.start(G+1)+B.end(G+1))/2?-1:1,Pt=B.index(G)+(U>0?1:0),Ut=B.node(G),Ft=!1;if(1==W)Ft=Ut.canReplace(Pt,Pt,Z);else{let Zt=Ut.contentMatchAt(Pt).findWrapping(Z.firstChild.type);Ft=Zt&&Ut.canReplaceWith(Pt,Pt,Zt[0])}if(Ft)return 0==U?B.pos:U<0?B.before(G+1):B.after(G+1)}return null}function Qe(Q,E,A=E,B=T.p2.empty){if(E==A&&!B.size)return null;let Z=Q.resolve(E),W=Q.resolve(A);return we(Z,W,B)?new ct(E,A,B):new he(Z,W,B).fit()}function we(Q,E,A){return!A.openStart&&!A.openEnd&&Q.start()==E.start()&&Q.parent.canReplace(Q.index(),E.index(),A.content)}Lt.jsonID("replaceAround",z);class he{constructor(E,A,B){this.$from=E,this.$to=A,this.unplaced=B,this.frontier=[],this.placed=T.HY.empty;for(let Z=0;Z<=E.depth;Z++){let W=E.node(Z);this.frontier.push({type:W.type,match:W.contentMatchAt(E.indexAfter(Z))})}for(let Z=E.depth;Z>0;Z--)this.placed=T.HY.from(E.node(Z).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let Ut=this.findFittable();Ut?this.placeNodes(Ut):this.openMore()||this.dropNode()}let E=this.mustMoveInline(),A=this.placed.size-this.depth-this.$from.depth,B=this.$from,Z=this.close(E<0?this.$to:B.doc.resolve(E));if(!Z)return null;let W=this.placed,G=B.depth,U=Z.depth;for(;G&&U&&1==W.childCount;)W=W.firstChild.content,G--,U--;let Pt=new T.p2(W,G,U);return E>-1?new z(B.pos,E,this.$to.pos,this.$to.end(),Pt,A):Pt.size||B.pos!=this.$to.pos?new ct(B.pos,Z.pos,Pt):null}findFittable(){for(let E=1;E<=2;E++)for(let A=this.unplaced.openStart;A>=0;A--){let B,Z=null;A?(Z=Te(this.unplaced.content,A-1).firstChild,B=Z.content):B=this.unplaced.content;let W=B.firstChild;for(let G=this.depth;G>=0;G--){let Ut,{type:U,match:Pt}=this.frontier[G],Ft=null;if(1==E&&(W?Pt.matchType(W.type)||(Ft=Pt.fillBefore(T.HY.from(W),!1)):Z&&U.compatibleContent(Z.type)))return{sliceDepth:A,frontierDepth:G,parent:Z,inject:Ft};if(2==E&&W&&(Ut=Pt.findWrapping(W.type)))return{sliceDepth:A,frontierDepth:G,parent:Z,wrap:Ut};if(Z&&Pt.matchType(Z.type))break}}}openMore(){let{content:E,openStart:A,openEnd:B}=this.unplaced,Z=Te(E,A);return!(!Z.childCount||Z.firstChild.isLeaf||(this.unplaced=new T.p2(E,A+1,Math.max(B,Z.size+A>=E.size-B?A+1:0)),0))}dropNode(){let{content:E,openStart:A,openEnd:B}=this.unplaced,Z=Te(E,A);if(Z.childCount<=1&&A>0){let W=E.size-A<=A+Z.size;this.unplaced=new T.p2(De(E,A-1,1),A-1,W?A-1:B)}else this.unplaced=new T.p2(De(E,A,1),A,B)}placeNodes({sliceDepth:E,frontierDepth:A,parent:B,inject:Z,wrap:W}){for(;this.depth>A;)this.closeFrontierNode();if(W)for(let g=0;g<W.length;g++)this.openFrontierNode(W[g]);let G=this.unplaced,U=B?B.content:G.content,Pt=G.openStart-E,Ut=0,Ft=[],{match:Zt,type:H}=this.frontier[A];if(Z){for(let g=0;g<Z.childCount;g++)Ft.push(Z.child(g));Zt=Zt.matchFragment(Z)}let l=U.size+E-(G.content.size-G.openEnd);for(;Ut<U.childCount;){let g=U.child(Ut),D=Zt.matchType(g.type);if(!D)break;Ut++,(Ut>1||0==Pt||g.content.size)&&(Zt=D,Ft.push(Ue(g.mark(H.allowedMarks(g.marks)),1==Ut?Pt:0,Ut==U.childCount?l:-1)))}let u=Ut==U.childCount;u||(l=-1),this.placed=Ie(this.placed,A,T.HY.from(Ft)),this.frontier[A].match=Zt,u&&l<0&&B&&B.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,D=U;g<l;g++){let L=D.lastChild;this.frontier.push({type:L.type,match:L.contentMatchAt(L.childCount)}),D=L.content}this.unplaced=u?0==E?T.p2.empty:new T.p2(De(G.content,E-1,1),E-1,l<0?G.openEnd:E-1):new T.p2(De(G.content,E,Ut),G.openStart,G.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let A,E=this.frontier[this.depth];if(!E.type.isTextblock||!de(this.$to,this.$to.depth,E.type,E.match,!1)||this.$to.depth==this.depth&&(A=this.findCloseLevel(this.$to))&&A.depth==this.depth)return-1;let{depth:B}=this.$to,Z=this.$to.after(B);for(;B>1&&Z==this.$to.end(--B);)++Z;return Z}findCloseLevel(E){t:for(let A=Math.min(this.depth,E.depth);A>=0;A--){let{match:B,type:Z}=this.frontier[A],W=A<E.depth&&E.end(A+1)==E.pos+(E.depth-(A+1)),G=de(E,A,Z,B,W);if(G){for(let U=A-1;U>=0;U--){let{match:Pt,type:Ut}=this.frontier[U],Ft=de(E,U,Ut,Pt,!0);if(!Ft||Ft.childCount)continue t}return{depth:A,fit:G,move:W?E.doc.resolve(E.after(A+1)):E}}}}close(E){let A=this.findCloseLevel(E);if(!A)return null;for(;this.depth>A.depth;)this.closeFrontierNode();A.fit.childCount&&(this.placed=Ie(this.placed,A.depth,A.fit)),E=A.move;for(let B=A.depth+1;B<=E.depth;B++){let Z=E.node(B),W=Z.type.contentMatch.fillBefore(Z.content,!0,E.index(B));this.openFrontierNode(Z.type,Z.attrs,W)}return E}openFrontierNode(E,A=null,B){let Z=this.frontier[this.depth];Z.match=Z.match.matchType(E),this.placed=Ie(this.placed,this.depth,T.HY.from(E.create(A,B))),this.frontier.push({type:E,match:E.contentMatch})}closeFrontierNode(){let A=this.frontier.pop().match.fillBefore(T.HY.empty,!0);A.childCount&&(this.placed=Ie(this.placed,this.frontier.length,A))}}function De(Q,E,A){return 0==E?Q.cutByIndex(A,Q.childCount):Q.replaceChild(0,Q.firstChild.copy(De(Q.firstChild.content,E-1,A)))}function Ie(Q,E,A){return 0==E?Q.append(A):Q.replaceChild(Q.childCount-1,Q.lastChild.copy(Ie(Q.lastChild.content,E-1,A)))}function Te(Q,E){for(let A=0;A<E;A++)Q=Q.firstChild.content;return Q}function Ue(Q,E,A){if(E<=0)return Q;let B=Q.content;return E>1&&(B=B.replaceChild(0,Ue(B.firstChild,E-1,1==B.childCount?A-1:0))),E>0&&(B=Q.type.contentMatch.fillBefore(B).append(B),A<=0&&(B=B.append(Q.type.contentMatch.matchFragment(B).fillBefore(T.HY.empty,!0)))),Q.copy(B)}function de(Q,E,A,B,Z){let W=Q.node(E),G=Z?Q.indexAfter(E):Q.index(E);if(G==W.childCount&&!A.compatibleContent(W.type))return null;let U=B.fillBefore(W.content,!0,G);return U&&!function(Q,E,A){for(let B=A;B<E.childCount;B++)if(!Q.allowsMarks(E.child(B).marks))return!0;return!1}(A,W.content,G)?U:null}function We(Q){return Q.spec.defining||Q.spec.definingForContent}function Re(Q,E,A,B,Z){if(E<A){let W=Q.firstChild;Q=Q.replaceChild(0,W.copy(Re(W.content,E+1,A,B,W)))}if(E>B){let W=Z.contentMatchAt(0),G=W.fillBefore(Q).append(Q);Q=G.append(W.matchFragment(G).fillBefore(T.HY.empty,!0))}return Q}function _e(Q,E){let A=[];for(let Z=Math.min(Q.depth,E.depth);Z>=0;Z--){let W=Q.start(Z);if(W<Q.pos-(Q.depth-Z)||E.end(Z)>E.pos+(E.depth-Z)||Q.node(Z).type.spec.isolating||E.node(Z).type.spec.isolating)break;(W==E.start(Z)||Z==Q.depth&&Z==E.depth&&Q.parent.inlineContent&&E.parent.inlineContent&&Z&&E.start(Z-1)==W-1)&&A.push(Z)}return A}let Ce=class extends Error{};Ce=function Q(E){let A=Error.call(this,E);return A.__proto__=Q.prototype,A},(Ce.prototype=Object.create(Error.prototype)).constructor=Ce,Ce.prototype.name="TransformError";class Ae{constructor(E){this.doc=E,this.steps=[],this.docs=[],this.mapping=new gt}get before(){return this.docs.length?this.docs[0]:this.doc}step(E){let A=this.maybeStep(E);if(A.failed)throw new Ce(A.failed);return this}maybeStep(E){let A=E.apply(this.doc);return A.failed||this.addStep(E,A.doc),A}get docChanged(){return this.steps.length>0}addStep(E,A){this.docs.push(this.doc),this.steps.push(E),this.mapping.appendMap(E.getMap()),this.doc=A}replace(E,A=E,B=T.p2.empty){let Z=Qe(this.doc,E,A,B);return Z&&this.step(Z),this}replaceWith(E,A,B){return this.replace(E,A,new T.p2(T.HY.from(B),0,0))}delete(E,A){return this.replace(E,A,T.p2.empty)}insert(E,A){return this.replaceWith(E,E,A)}replaceRange(E,A,B){return function(Q,E,A,B){if(!B.size)return Q.deleteRange(E,A);let Z=Q.doc.resolve(E),W=Q.doc.resolve(A);if(we(Z,W,B))return Q.step(new ct(E,A,B));let G=_e(Z,Q.doc.resolve(A));0==G[G.length-1]&&G.pop();let U=-(Z.depth+1);G.unshift(U);for(let H=Z.depth,l=Z.pos-1;H>0;H--,l--){let u=Z.node(H).type.spec;if(u.defining||u.definingAsContext||u.isolating)break;G.indexOf(H)>-1?U=H:Z.before(H)==l&&G.splice(1,0,-H)}let Pt=G.indexOf(U),Ut=[],Ft=B.openStart;for(let H=B.content,l=0;;l++){let u=H.firstChild;if(Ut.push(u),l==B.openStart)break;H=u.content}for(let H=Ft-1;H>=0;H--){let l=Ut[H].type,u=We(l);if(u&&Z.node(Pt).type!=l)Ft=H;else if(u||!l.isTextblock)break}for(let H=B.openStart;H>=0;H--){let l=(H+Ft+1)%(B.openStart+1),u=Ut[l];if(u)for(let g=0;g<G.length;g++){let D=G[(g+Pt)%G.length],L=!0;D<0&&(L=!1,D=-D);let V=Z.node(D-1),Tt=Z.index(D-1);if(V.canReplaceWith(Tt,Tt,u.type,u.marks))return Q.replace(Z.before(D),L?W.after(D):A,new T.p2(Re(B.content,0,B.openStart,l),l,B.openEnd))}}let Zt=Q.steps.length;for(let H=G.length-1;H>=0&&(Q.replace(E,A,B),!(Q.steps.length>Zt));H--){let l=G[H];l<0||(E=Z.before(l),A=W.after(l))}}(this,E,A,B),this}replaceRangeWith(E,A,B){return function(Q,E,A,B){if(!B.isInline&&E==A&&Q.doc.resolve(E).parent.content.size){let Z=function(Q,E,A){let B=Q.resolve(E);if(B.parent.canReplaceWith(B.index(),B.index(),A))return E;if(0==B.parentOffset)for(let Z=B.depth-1;Z>=0;Z--){let W=B.index(Z);if(B.node(Z).canReplaceWith(W,W,A))return B.before(Z+1);if(W>0)return null}if(B.parentOffset==B.parent.content.size)for(let Z=B.depth-1;Z>=0;Z--){let W=B.indexAfter(Z);if(B.node(Z).canReplaceWith(W,W,A))return B.after(Z+1);if(W<B.node(Z).childCount)return null}return null}(Q.doc,E,B.type);null!=Z&&(E=A=Z)}Q.replaceRange(E,A,new T.p2(T.HY.from(B),0,0))}(this,E,A,B),this}deleteRange(E,A){return function(Q,E,A){let B=Q.doc.resolve(E),Z=Q.doc.resolve(A),W=_e(B,Z);for(let G=0;G<W.length;G++){let U=W[G],Pt=G==W.length-1;if(Pt&&0==U||B.node(U).type.contentMatch.validEnd)return Q.delete(B.start(U),Z.end(U));if(U>0&&(Pt||B.node(U-1).canReplace(B.index(U-1),Z.indexAfter(U-1))))return Q.delete(B.before(U),Z.after(U))}for(let G=1;G<=B.depth&&G<=Z.depth;G++)if(E-B.start(G)==B.depth-G&&A>B.end(G)&&Z.end(G)-A!=Z.depth-G)return Q.delete(B.before(G),A);Q.delete(E,A)}(this,E,A),this}lift(E,A){return function(Q,E,A){let{$from:B,$to:Z,depth:W}=E,G=B.before(W+1),U=Z.after(W+1),Pt=G,Ut=U,Ft=T.HY.empty,Zt=0;for(let u=W,g=!1;u>A;u--)g||B.index(u)>0?(g=!0,Ft=T.HY.from(B.node(u).copy(Ft)),Zt++):Pt--;let H=T.HY.empty,l=0;for(let u=W,g=!1;u>A;u--)g||Z.after(u+1)<Z.end(u)?(g=!0,H=T.HY.from(Z.node(u).copy(H)),l++):Ut++;Q.step(new z(Pt,Ut,G,U,new T.p2(Ft.append(H),Zt,l),Ft.size-Zt,!0))}(this,E,A),this}join(E,A=1){return function(Q,E,A){let B=new ct(E-A,E+A,T.p2.empty,!0);Q.step(B)}(this,E,A),this}wrap(E,A){return function(Q,E,A){let B=T.HY.empty;for(let G=A.length-1;G>=0;G--){if(B.size){let U=A[G].type.contentMatch.matchFragment(B);if(!U||!U.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}B=T.HY.from(A[G].type.create(A[G].attrs,B))}let Z=E.start,W=E.end;Q.step(new z(Z,W,Z,W,new T.p2(B,0,0),A.length,!0))}(this,E,A),this}setBlockType(E,A=E,B,Z=null){return function(Q,E,A,B,Z){if(!B.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let W=Q.steps.length;Q.doc.nodesBetween(E,A,(G,U)=>{if(G.isTextblock&&!G.hasMarkup(B,Z)&&function(Q,E,A){let B=Q.resolve(E),Z=B.index();return B.parent.canReplaceWith(Z,Z+1,A)}(Q.doc,Q.mapping.slice(W).map(U),B)){Q.clearIncompatible(Q.mapping.slice(W).map(U,1),B);let Pt=Q.mapping.slice(W),Ut=Pt.map(U,1),Ft=Pt.map(U+G.nodeSize,1);return Q.step(new z(Ut,Ft,Ut+1,Ft-1,new T.p2(T.HY.from(B.create(Z,null,G.marks)),0,0),1,!0)),!1}})}(this,E,A,B,Z),this}setNodeMarkup(E,A,B=null,Z=[]){return function(Q,E,A,B,Z){let W=Q.doc.nodeAt(E);if(!W)throw new RangeError("No node at given position");A||(A=W.type);let G=A.create(B,null,Z||W.marks);if(W.isLeaf)return Q.replaceWith(E,E+W.nodeSize,G);if(!A.validContent(W.content))throw new RangeError("Invalid content for node type "+A.name);Q.step(new z(E,E+W.nodeSize,E+1,E+W.nodeSize-1,new T.p2(T.HY.from(G),0,0),1,!0))}(this,E,A,B,Z),this}split(E,A=1,B){return function(Q,E,A=1,B){let Z=Q.doc.resolve(E),W=T.HY.empty,G=T.HY.empty;for(let U=Z.depth,Pt=Z.depth-A,Ut=A-1;U>Pt;U--,Ut--){W=T.HY.from(Z.node(U).copy(W));let Ft=B&&B[Ut];G=T.HY.from(Ft?Ft.type.create(Ft.attrs,G):Z.node(U).copy(G))}Q.step(new ct(E,E,new T.p2(W.append(G),A,A),!0))}(this,E,A,B),this}addMark(E,A,B){return function(Q,E,A,B){let G,U,Z=[],W=[];Q.doc.nodesBetween(E,A,(Pt,Ut,Ft)=>{if(!Pt.isInline)return;let Zt=Pt.marks;if(!B.isInSet(Zt)&&Ft.type.allowsMarkType(B.type)){let H=Math.max(Ut,E),l=Math.min(Ut+Pt.nodeSize,A),u=B.addToSet(Zt);for(let g=0;g<Zt.length;g++)Zt[g].isInSet(u)||(G&&G.to==H&&G.mark.eq(Zt[g])?G.to=l:Z.push(G=new X(H,l,Zt[g])));U&&U.to==H?U.to=l:W.push(U=new ht(H,l,B))}}),Z.forEach(Pt=>Q.step(Pt)),W.forEach(Pt=>Q.step(Pt))}(this,E,A,B),this}removeMark(E,A,B){return function(Q,E,A,B){let Z=[],W=0;Q.doc.nodesBetween(E,A,(G,U)=>{if(!G.isInline)return;W++;let Pt=null;if(B instanceof T.ZU){let Ft,Ut=G.marks;for(;Ft=B.isInSet(Ut);)(Pt||(Pt=[])).push(Ft),Ut=Ft.removeFromSet(Ut)}else B?B.isInSet(G.marks)&&(Pt=[B]):Pt=G.marks;if(Pt&&Pt.length){let Ut=Math.min(U+G.nodeSize,A);for(let Ft=0;Ft<Pt.length;Ft++){let H,Zt=Pt[Ft];for(let l=0;l<Z.length;l++){let u=Z[l];u.step==W-1&&Zt.eq(Z[l].style)&&(H=u)}H?(H.to=Ut,H.step=W):Z.push({style:Zt,from:Math.max(U,E),to:Ut,step:W})}}}),Z.forEach(G=>Q.step(new X(G.from,G.to,G.style)))}(this,E,A,B),this}clearIncompatible(E,A,B){return function(Q,E,A,B=A.contentMatch){let Z=Q.doc.nodeAt(E),W=[],G=E+1;for(let U=0;U<Z.childCount;U++){let Pt=Z.child(U),Ut=G+Pt.nodeSize,Ft=B.matchType(Pt.type);if(Ft){B=Ft;for(let Zt=0;Zt<Pt.marks.length;Zt++)A.allowsMarkType(Pt.marks[Zt].type)||Q.step(new X(G,Ut,Pt.marks[Zt]))}else W.push(new ct(G,Ut,T.p2.empty));G=Ut}if(!B.validEnd){let U=B.fillBefore(T.HY.empty,!0);Q.replace(G,G,new T.p2(U,0,0))}for(let U=W.length-1;U>=0;U--)Q.step(W[U])}(this,E,A,B),this}}},43594:(Jt,Et,d)=>{d.d(Et,{p:()=>en,EH:()=>Pe,tk:()=>Io});var T=d(62463),s=d(35917),b=d(38480);const P="undefined"!=typeof navigator?navigator:null,m="undefined"!=typeof document?document:null,ut=P&&P.userAgent||"",k=/Edge\/(\d+)/.exec(ut),mt=/MSIE \d/.exec(ut),nt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ut),at=!!(mt||nt||k),pt=mt?document.documentMode:nt?+nt[1]:k?+k[1]:0,Ot=!at&&/gecko\/(\d+)/i.test(ut);Ot&&/Firefox\/(\d+)/.exec(ut);const gt=!at&&/Chrome\/(\d+)/.exec(ut),_t=!!gt,Lt=gt?+gt[1]:0,It=!at&&!!P&&/Apple Computer/.test(P.vendor),Dt=It&&(/Mobile\/\w+/.test(ut)||!!P&&P.maxTouchPoints>2),ht=Dt||!!P&&/Mac/.test(P.platform),X=/Android \d/.test(ut),ct=!!m&&"webkitFontSmoothing"in m.documentElement.style,z=ct?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,Ct=function(n){for(var t=0;;t++)if(!(n=n.previousSibling))return t},xt=function(n){let t=n.assignedSlot||n.parentNode;return t&&11==t.nodeType?t.host:t};let At=null;const yt=function(n,t,e){let o=At||(At=document.createRange());return o.setEnd(n,null==e?n.nodeValue.length:e),o.setStart(n,t||0),o},rt=function(n,t,e,o){return e&&(Nt(n,t,e,o,-1)||Nt(n,t,e,o,1))},bt=/^(img|br|input|textarea|hr)$/i;function Nt(n,t,e,o,i){for(;;){if(n==e&&t==o)return!0;if(t==(i<0?0:Yt(n))){let r=n.parentNode;if(!r||1!=r.nodeType||S(n)||bt.test(n.nodeName)||"false"==n.contentEditable)return!1;t=Ct(n)+(i<0?0:1),n=r}else{if(1!=n.nodeType)return!1;if("false"==(n=n.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?Yt(n):0}}}function Yt(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function S(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const et=function(n){let t=n.isCollapsed;return t&&_t&&n.rangeCount&&!n.getRangeAt(0).collapsed&&(t=!1),t};function lt(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function Mt(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function F(n,t){return"number"==typeof n?n:n[t]}function K(n){let t=n.getBoundingClientRect();return{left:t.left,right:t.left+n.clientWidth*(t.width/n.offsetWidth||1),top:t.top,bottom:t.top+n.clientHeight*(t.height/n.offsetHeight||1)}}function dt(n,t,e){let o=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,r=n.dom.ownerDocument;for(let c=e||n.dom;c;c=xt(c)){if(1!=c.nodeType)continue;let p=c,h=p==r.body,O=h?Mt(r):K(p),x=0,J=0;if(t.top<O.top+F(o,"top")?J=-(O.top-t.top+F(i,"top")):t.bottom>O.bottom-F(o,"bottom")&&(J=t.bottom-O.bottom+F(i,"bottom")),t.left<O.left+F(o,"left")?x=-(O.left-t.left+F(i,"left")):t.right>O.right-F(o,"right")&&(x=t.right-O.right+F(i,"right")),x||J)if(h)r.defaultView.scrollBy(x,J);else{let Y=p.scrollLeft,tt=p.scrollTop;J&&(p.scrollTop+=J),x&&(p.scrollLeft+=x);let vt=p.scrollLeft-Y,wt=p.scrollTop-tt;t={left:t.left-vt,top:t.top-wt,right:t.right-vt,bottom:t.bottom-wt}}if(h)break}}function $t(n){let t=[],e=n.ownerDocument;for(let o=n;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),n!=e);o=xt(o));return t}function ae(n,t){for(let e=0;e<n.length;e++){let{dom:o,top:i,left:r}=n[e];o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=r&&(o.scrollLeft=r)}}let le=null;function Ke(n,t){let e,i,o=2e8,r=0,c=t.top,p=t.top;for(let h=n.firstChild,O=0;h;h=h.nextSibling,O++){let x;if(1==h.nodeType)x=h.getClientRects();else{if(3!=h.nodeType)continue;x=yt(h).getClientRects()}for(let J=0;J<x.length;J++){let Y=x[J];if(Y.top<=c&&Y.bottom>=p){c=Math.max(Y.bottom,c),p=Math.min(Y.top,p);let tt=Y.left>t.left?Y.left-t.left:Y.right<t.left?t.left-Y.right:0;if(tt<o){e=h,o=tt,i=tt&&3==e.nodeType?{left:Y.right<t.left?Y.right:Y.left,top:t.top}:t,1==h.nodeType&&tt&&(r=O+(t.left>=(Y.left+Y.right)/2?1:0));continue}}!e&&(t.left>=Y.right&&t.top>=Y.top||t.left>=Y.left&&t.top>=Y.bottom)&&(r=O+1)}}return e&&3==e.nodeType?function(n,t){let e=n.nodeValue.length,o=document.createRange();for(let i=0;i<e;i++){o.setEnd(n,i+1),o.setStart(n,i);let r=de(o,1);if(r.top!=r.bottom&&we(t,r))return{node:n,offset:i+(t.left>=(r.left+r.right)/2?1:0)}}return{node:n,offset:0}}(e,i):!e||o&&1==e.nodeType?{node:n,offset:r}:Ke(e,i)}function we(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function Te(n,t,e){let o=n.childNodes.length;if(o&&e.top<e.bottom)for(let i=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-e.top)/(e.bottom-e.top))-2)),r=i;;){let c=n.childNodes[r];if(1==c.nodeType){let p=c.getClientRects();for(let h=0;h<p.length;h++){let O=p[h];if(we(t,O))return Te(c,t,O)}}if((r=(r+1)%o)==i)break}return n}function Ue(n,t){let o,e=n.dom.ownerDocument,i=0;if(e.caretPositionFromPoint)try{let h=e.caretPositionFromPoint(t.left,t.top);h&&({offsetNode:o,offset:i}=h)}catch(h){}if(!o&&e.caretRangeFromPoint){let h=e.caretRangeFromPoint(t.left,t.top);h&&({startContainer:o,startOffset:i}=h)}let c,r=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top);if(!r||!n.dom.contains(1!=r.nodeType?r.parentNode:r)){let h=n.dom.getBoundingClientRect();if(!we(t,h)||(r=Te(n.dom,t,h),!r))return null}if(It)for(let h=r;o&&h;h=xt(h))h.draggable&&(o=void 0);if(r=function(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}(r,t),o){if(Ot&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length),i<o.childNodes.length)){let O,h=o.childNodes[i];"IMG"==h.nodeName&&(O=h.getBoundingClientRect()).right<=t.left&&O.bottom>t.top&&i++}o==n.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?c=n.state.doc.content.size:(0==i||1!=o.nodeType||"BR"!=o.childNodes[i-1].nodeName)&&(c=function(n,t,e,o){let i=-1;for(let r=t;r!=n.dom;){let c=n.docView.nearestDesc(r,!0);if(!c)return null;if(c.node.isBlock&&c.parent){let p=c.dom.getBoundingClientRect();if(p.left>o.left||p.top>o.top)i=c.posBefore;else{if(!(p.right<o.left||p.bottom<o.top))break;i=c.posAfter}}r=c.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,1)}(n,o,i,t))}null==c&&(c=function(n,t,e){let{node:o,offset:i}=Ke(t,e),r=-1;if(1==o.nodeType&&!o.firstChild){let c=o.getBoundingClientRect();r=c.left!=c.right&&e.left>(c.left+c.right)/2?1:-1}return n.docView.posFromDOM(o,i,r)}(n,r,t));let p=n.docView.nearestDesc(r,!0);return{pos:c,inside:p?p.posAtStart-p.border:-1}}function de(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const se=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function We(n,t,e){let{node:o,offset:i,atom:r}=n.docView.domFromPos(t,e<0?-1:1),c=ct||Ot;if(3==o.nodeType){if(!c||!se.test(o.nodeValue)&&(e<0?i:i!=o.nodeValue.length)){let h=i,O=i,x=e<0?1:-1;return e<0&&!i?(O++,x=-1):e>=0&&i==o.nodeValue.length?(h--,x=1):e<0?h--:O++,Ee(de(yt(o,h,O),x),x<0)}{let h=de(yt(o,i,i),e);if(Ot&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){let O=de(yt(o,i-1,i-1),-1);if(O.top==h.top){let x=de(yt(o,i,i+1),-1);if(x.top!=h.top)return Ee(x,x.left<O.left)}}return h}}if(!n.state.doc.resolve(t-(r||0)).parent.inlineContent){if(null==r&&i&&(e<0||i==Yt(o))){let h=o.childNodes[i-1];if(1==h.nodeType)return Re(h.getBoundingClientRect(),!1)}if(null==r&&i<Yt(o)){let h=o.childNodes[i];if(1==h.nodeType)return Re(h.getBoundingClientRect(),!0)}return Re(o.getBoundingClientRect(),e>=0)}if(null==r&&i&&(e<0||i==Yt(o))){let h=o.childNodes[i-1],O=3==h.nodeType?yt(h,Yt(h)-(c?0:1)):1!=h.nodeType||"BR"==h.nodeName&&h.nextSibling?null:h;if(O)return Ee(de(O,1),!1)}if(null==r&&i<Yt(o)){let h=o.childNodes[i];for(;h.pmViewDesc&&h.pmViewDesc.ignoreForCoords;)h=h.nextSibling;let O=h?3==h.nodeType?yt(h,0,c?0:1):1==h.nodeType?h:null:null;if(O)return Ee(de(O,-1),!0)}return Ee(de(3==o.nodeType?yt(o):o,-e),e>=0)}function Ee(n,t){if(0==n.width)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Re(n,t){if(0==n.height)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Je(n,t,e){let o=n.state,i=n.root.activeElement;o!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{o!=t&&n.updateState(o),i!=n.dom&&i&&i.focus()}}const _e=/[\u0590-\u08ac]/;let Ae=null,Q=null,E=!1;class U{constructor(t,e,o,i){this.parent=t,this.children=e,this.dom=o,this.contentDOM=i,this.dirty=0,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,o=this.posAtStart;;e++){let i=this.children[e];if(i==t)return o;o+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,o){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(o<0){let r,c;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(c=r.pmViewDesc)||c.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(c)+c.size:this.posAtStart}{let r,c;if(t==this.contentDOM)r=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.nextSibling}for(;r&&(!(c=r.pmViewDesc)||c.parent!=this);)r=r.nextSibling;return r?this.posBeforeChild(c):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>Ct(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!1;break}if(r.previousSibling)break}if(null==i&&e==t.childNodes.length)for(let r=t;;r=r.parentNode){if(r==this.dom){i=!0;break}if(r.nextSibling)break}}return(null==i?o>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let o=!0,i=t;i;i=i.parentNode){let c,r=this.getDesc(i);if(r&&(!e||r.node)){if(!o||!(c=r.nodeDOM)||(1==c.nodeType?c.contains(1==t.nodeType?t:t.parentNode):c==t))return r;o=!1}}}getDesc(t){let e=t.pmViewDesc;for(let o=e;o;o=o.parent)if(o==this)return e}posFromDOM(t,e,o){for(let i=t;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(t,e,o)}return-1}descAt(t){for(let e=0,o=0;e<this.children.length;e++){let i=this.children[e],r=o+i.size;if(o==t&&r!=o){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<r)return i.descAt(t-o-i.border);o=r}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r,o=0,i=0;for(let r=0;o<this.children.length;o++){let c=this.children[o],p=r+c.size;if(p>t||c instanceof u){i=t-r;break}r=p}if(i)return this.children[o].domFromPos(i-this.children[o].border,e);for(;o&&!(r=this.children[o-1]).size&&r instanceof Pt&&r.side>=0;o--);if(e<=0){let r,c=!0;for(;r=o?this.children[o-1]:null,r&&r.dom.parentNode!=this.contentDOM;o--,c=!1);return r&&e&&c&&!r.border&&!r.domAtom?r.domFromPos(r.size,e):{node:this.contentDOM,offset:r?Ct(r.dom)+1:0}}{let r,c=!0;for(;r=o<this.children.length?this.children[o]:null,r&&r.dom.parentNode!=this.contentDOM;o++,c=!1);return r&&c&&!r.border&&!r.domAtom?r.domFromPos(0,e):{node:this.contentDOM,offset:r?Ct(r.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,o=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let c=o,p=0;;p++){let h=this.children[p],O=c+h.size;if(-1==i&&t<=O){let x=c+h.border;if(t>=x&&e<=O-h.border&&h.node&&h.contentDOM&&this.contentDOM.contains(h.contentDOM))return h.parseRange(t,e,x);t=c;for(let J=p;J>0;J--){let Y=this.children[J-1];if(Y.size&&Y.dom.parentNode==this.contentDOM&&!Y.emptyChildAt(1)){i=Ct(Y.dom)+1;break}t-=Y.size}-1==i&&(i=0)}if(i>-1&&(O>e||p==this.children.length-1)){e=O;for(let x=p+1;x<this.children.length;x++){let J=this.children[x];if(J.size&&J.dom.parentNode==this.contentDOM&&!J.emptyChildAt(-1)){r=Ct(J.dom);break}e+=J.size}-1==r&&(r=this.contentDOM.childNodes.length);break}c=O}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:o}=this.domFromPos(t,0);if(1!=e.nodeType||o==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[o]}setSelection(t,e,o,i=!1){let r=Math.min(t,e),c=Math.max(t,e);for(let Y=0,tt=0;Y<this.children.length;Y++){let vt=this.children[Y],wt=tt+vt.size;if(r>tt&&c<wt)return vt.setSelection(t-tt-vt.border,e-tt-vt.border,o,i);tt=wt}let p=this.domFromPos(t,t?-1:1),h=e==t?p:this.domFromPos(e,e?-1:1),O=o.getSelection(),x=!1;if((Ot||It)&&t==e){let{node:Y,offset:tt}=p;if(3==Y.nodeType){if(x=!(!tt||"\n"!=Y.nodeValue[tt-1]),x&&tt==Y.nodeValue.length)for(let wt,vt=Y;vt;vt=vt.parentNode){if(wt=vt.nextSibling){"BR"==wt.nodeName&&(p=h={node:wt.parentNode,offset:Ct(wt)+1});break}let Wt=vt.pmViewDesc;if(Wt&&Wt.node&&Wt.node.isBlock)break}}else{let vt=Y.childNodes[tt-1];x=vt&&("BR"==vt.nodeName||"false"==vt.contentEditable)}}if(Ot&&O.focusNode&&O.focusNode!=h.node&&1==O.focusNode.nodeType){let Y=O.focusNode.childNodes[O.focusOffset];Y&&"false"==Y.contentEditable&&(i=!0)}if(!(i||x&&It)&&rt(p.node,p.offset,O.anchorNode,O.anchorOffset)&&rt(h.node,h.offset,O.focusNode,O.focusOffset))return;let J=!1;if((O.extend||t==e)&&!x){O.collapse(p.node,p.offset);try{t!=e&&O.extend(h.node,h.offset),J=!0}catch(Y){if(!(Y instanceof DOMException))throw Y}}if(!J){if(t>e){let tt=p;p=h,h=tt}let Y=document.createRange();Y.setEnd(h.node,h.offset),Y.setStart(p.node,p.offset),O.removeAllRanges(),O.addRange(Y)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let o=0,i=0;i<this.children.length;i++){let r=this.children[i],c=o+r.size;if(o==c?t<=c&&e>=o:t<c&&e>o){let p=o+r.border,h=c-r.border;if(t>=p&&e<=h)return this.dirty=t==o||e==c?2:1,void(t!=p||e!=h||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-p,e-p):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}o=c}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let o=1==t?2:1;e.dirty<o&&(e.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Pt extends U{constructor(t,e,o,i){let r,c=e.type.toDOM;if("function"==typeof c&&(c=c(o,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i)),!e.type.spec.raw){if(1!=c.nodeType){let p=document.createElement("span");p.appendChild(c),c=p}c.contentEditable="false",c.classList.add("ProseMirror-widget")}super(t,[],c,null),this.widget=e,this.widget=e,r=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Ut extends U{constructor(t,e,o,i){super(t,[],e,null),this.textDOM=o,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class Ft extends U{constructor(t,e,o,i){super(t,[],o,i),this.mark=e}static create(t,e,o,i){let r=i.nodeViews[e.type.name],c=r&&r(e,i,o);return(!c||!c.dom)&&(c=s.PW.renderSpec(document,e.type.spec.toDOM(e,o))),new Ft(t,e,c.dom,c.contentDOM||c.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}}slice(t,e,o){let i=Ft.create(this.parent,this.mark,!0,o),r=this.children,c=this.size;e<c&&(r=un(r,e,c,o)),t>0&&(r=un(r,0,t,o));for(let p=0;p<r.length;p++)r[p].parent=i;return i.children=r,i}}class Zt extends U{constructor(t,e,o,i,r,c,p,h,O){super(t,[],r,c),this.node=e,this.outerDeco=o,this.innerDeco=i,this.nodeDOM=p,c&&this.updateChildren(h,O)}static create(t,e,o,i,r,c){let h,p=r.nodeViews[e.type.name],O=p&&p(e,r,()=>h?h.parent?h.parent.posBeforeChild(h):void 0:c,o,i),x=O&&O.dom,J=O&&O.contentDOM;if(e.isText)if(x){if(3!=x.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else x=document.createTextNode(e.text);else x||({dom:x,contentDOM:J}=s.PW.renderSpec(document,e.type.spec.toDOM(e)));!J&&!e.isText&&"BR"!=x.nodeName&&(x.hasAttribute("contenteditable")||(x.contentEditable="false"),e.type.spec.draggable&&(x.draggable=!0));let Y=x;return x=Xt(x,o,e),O?h=new g(t,e,o,i,x,J||null,Y,O,r,c+1):e.isText?new l(t,e,o,i,x,Y,r):new Zt(t,e,o,i,x,J||null,Y,r,c+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let o=this.children[e];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>s.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,o){return 0==this.dirty&&t.eq(this.node)&&Me(e,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let o=this.node.inlineContent,i=e,r=t.composing?this.localCompositionInfo(t,e):null,c=r&&r.pos>-1?r:null,p=r&&r.pos<0,h=new be(this,c&&c.node);(function(n,t,e,o){let i=t.locals(n),r=0;if(0==i.length){for(let O=0;O<n.childCount;O++){let x=n.child(O);o(x,i,t.forChild(r,x),O),r+=x.nodeSize}return}let c=0,p=[],h=null;for(let O=0;;){if(c<i.length&&i[c].to==r){let wt,vt=i[c++];for(;c<i.length&&i[c].to==r;)(wt||(wt=[vt])).push(i[c++]);if(wt){wt.sort(Ge);for(let Wt=0;Wt<wt.length;Wt++)e(wt[Wt],O,!!h)}else e(vt,O,!!h)}let x,J;if(h)J=-1,x=h,h=null;else{if(!(O<n.childCount))break;J=O,x=n.child(O++)}for(let vt=0;vt<p.length;vt++)p[vt].to<=r&&p.splice(vt--,1);for(;c<i.length&&i[c].from<=r&&i[c].to>r;)p.push(i[c++]);let Y=r+x.nodeSize;if(x.isText){let vt=Y;c<i.length&&i[c].from<vt&&(vt=i[c].from);for(let wt=0;wt<p.length;wt++)p[wt].to<vt&&(vt=p[wt].to);vt<Y&&(h=x.cut(vt-r),x=x.cut(0,vt-r),Y=vt,J=-1)}o(x,x.isInline&&!x.isLeaf?p.filter(vt=>!vt.inline):p.slice(),t.forChild(r,x),J),r=Y}})(this.node,this.innerDeco,(O,x,J)=>{O.spec.marks?h.syncToMarks(O.spec.marks,o,t):O.type.side>=0&&!J&&h.syncToMarks(x==this.node.childCount?s.vc.none:this.node.child(x).marks,o,t),h.placeWidget(O,t,i)},(O,x,J,Y)=>{let tt;h.syncToMarks(O.marks,o,t),h.findNodeMatch(O,x,J,Y)||p&&t.state.selection.from>i&&t.state.selection.to<i+O.nodeSize&&(tt=h.findIndexWithChild(r.node))>-1&&h.updateNodeAt(O,x,J,tt,t)||h.updateNextNode(O,x,J,t,Y)||h.addNode(O,x,J,t,i),i+=O.nodeSize}),h.syncToMarks([],o,t),this.node.isTextblock&&h.addTextblockHacks(),h.destroyRest(),(h.changed||2==this.dirty)&&(c&&this.protectLocalComposition(t,c),D(this.contentDOM,this.children,t),Dt&&function(n){if("UL"==n.nodeName||"OL"==n.nodeName){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n),n.style.cssText=t}}(this.dom))}localCompositionInfo(t,e){let{from:o,to:i}=t.state.selection;if(!(t.state.selection instanceof T.Bs)||o<e||i>e+this.node.content.size)return null;let r=t.domSelection(),c=function(n,t){for(;;){if(3==n.nodeType)return n;if(1==n.nodeType&&t>0){if(n.childNodes.length>t&&3==n.childNodes[t].nodeType)return n.childNodes[t];t=Yt(n=n.childNodes[t-1])}else{if(!(1==n.nodeType&&t<n.childNodes.length))return null;n=n.childNodes[t],t=0}}}(r.focusNode,r.focusOffset);if(!c||!this.dom.contains(c.parentNode))return null;if(this.node.inlineContent){let p=c.nodeValue,h=function(n,t,e,o){for(let i=0,r=0;i<n.childCount&&r<=o;){let c=n.child(i++),p=r;if(r+=c.nodeSize,!c.isText)continue;let h=c.text;for(;i<n.childCount;){let O=n.child(i++);if(r+=O.nodeSize,!O.isText)break;h+=O.text}if(r>=e){let O=p<o?h.lastIndexOf(t,o-p-1):-1;if(O>=0&&O+t.length+p>=e)return p+O;if(e==o&&h.length>=o+t.length-p&&h.slice(o-p,o-p+t.length)==t)return o}}return-1}(this.node.content,p,o-e,i-e);return h<0?null:{node:c,pos:h,text:p}}return{node:c,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:o,text:i}){if(this.getDesc(e))return;let r=e;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let c=new Ut(this,r,e,i);t.input.compositionNodes.push(c),this.children=un(this.children,o,o+i.length,t,c)}update(t,e,o,i){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,o,i),0))}updateInner(t,e,o,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(Me(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=Rt(this.dom,this.nodeDOM,Tt(this.outerDeco,this.node,e),Tt(t,this.node,e)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function H(n,t,e,o,i){return Xt(o,t,n),new Zt(void 0,n,t,e,o,o,o,i,0)}class l extends Zt{constructor(t,e,o,i,r,c,p){super(t,e,o,i,r,null,c,p,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,o,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,o){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,o)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,o){let i=this.node.cut(t,e),r=document.createTextNode(i.text);return new l(this.parent,i,this.outerDeco,this.innerDeco,r,r,o)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(0==t||e==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class u extends U{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class g extends Zt{constructor(t,e,o,i,r,c,p,h,O,x){super(t,e,o,i,r,c,p,O,x),this.spec=h}update(t,e,o,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(t,e,o);return r&&this.updateInner(t,e,o,i),r}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,o,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,o,i){this.spec.setSelection?this.spec.setSelection(t,e,o):super.setSelection(t,e,o,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function D(n,t,e){let o=n.firstChild,i=!1;for(let r=0;r<t.length;r++){let c=t[r],p=c.dom;if(p.parentNode==n){for(;p!=o;)o=cn(o),i=!0;o=o.nextSibling}else i=!0,n.insertBefore(p,o);if(c instanceof Ft){let h=o?o.previousSibling:n.lastChild;D(c.contentDOM,c.children,e),o=h?h.nextSibling:n.firstChild}}for(;o;)o=cn(o),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const L=function(n){n&&(this.nodeName=n)};L.prototype=Object.create(null);const V=[new L];function Tt(n,t,e){if(0==n.length)return V;let o=e?V[0]:new L,i=[o];for(let r=0;r<n.length;r++){let c=n[r].type.attrs;if(c){c.nodeName&&i.push(o=new L(c.nodeName));for(let p in c){let h=c[p];null!=h&&(e&&1==i.length&&i.push(o=new L(t.isInline?"span":"div")),"class"==p?o.class=(o.class?o.class+" ":"")+h:"style"==p?o.style=(o.style?o.style+";":"")+h:"nodeName"!=p&&(o[p]=h))}}}return i}function Rt(n,t,e,o){if(e==V&&o==V)return t;let i=t;for(let r=0;r<o.length;r++){let c=o[r],p=e[r];if(r){let h;p&&p.nodeName==c.nodeName&&i!=n&&(h=i.parentNode)&&h.nodeName.toLowerCase()==c.nodeName||(h=document.createElement(c.nodeName),h.pmIsDeco=!0,h.appendChild(i),p=V[0]),i=h}Vt(i,p||V[0],c)}return i}function Vt(n,t,e){for(let o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&!(o in e)&&n.removeAttribute(o);for(let o in e)"class"!=o&&"style"!=o&&"nodeName"!=o&&e[o]!=t[o]&&n.setAttribute(o,e[o]);if(t.class!=e.class){let o=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let r=0;r<o.length;r++)-1==i.indexOf(o[r])&&n.classList.remove(o[r]);for(let r=0;r<i.length;r++)-1==o.indexOf(i[r])&&n.classList.add(i[r]);0==n.classList.length&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let i,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=o.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Xt(n,t,e){return Rt(n,n,V,Tt(t,e,1!=n.nodeType))}function Me(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function cn(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class be{constructor(t,e){this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(n,t){let e=t,o=e.children.length,i=n.childCount,r=new Map,c=[];t:for(;i>0;){let p;for(;;)if(o){let O=e.children[o-1];if(!(O instanceof Ft)){p=O,o--;break}e=O,o=O.children.length}else{if(e==t)break t;o=e.parent.children.indexOf(e),e=e.parent}let h=p.node;if(h){if(h!=n.child(i-1))break;--i,r.set(p,i),c.push(p)}}return{index:i,matched:r,matches:c.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let o=t;o<e;o++)this.top.children[o].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,o){let i=0,r=this.stack.length>>1,c=Math.min(r,t.length);for(;i<c&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let p=-1;for(let h=this.index;h<Math.min(this.index+3,this.top.children.length);h++)if(this.top.children[h].matchesMark(t[r])){p=h;break}if(p>-1)p>this.index&&(this.changed=!0,this.destroyBetween(this.index,p)),this.top=this.top.children[this.index];else{let h=Ft.create(this.top,t[r],e,o);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,r++}}findNodeMatch(t,e,o,i){let c,r=-1;if(i>=this.preMatch.index&&(c=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&c.matchesNode(t,e,o))r=this.top.children.indexOf(c,this.index);else for(let p=this.index,h=Math.min(this.top.children.length,p+5);p<h;p++){let O=this.top.children[p];if(O.matchesNode(t,e,o)&&!this.preMatch.matched.has(O)){r=p;break}}return!(r<0||(this.destroyBetween(this.index,r),this.index++,0))}updateNodeAt(t,e,o,i,r){let c=this.top.children[i];return 3==c.dirty&&c.dom==c.contentDOM&&(c.dirty=2),!!c.update(t,e,o,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let o=t.pmViewDesc;if(o)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==o)return i;return-1}t=e}}updateNextNode(t,e,o,i,r){for(let c=this.index;c<this.top.children.length;c++){let p=this.top.children[c];if(p instanceof Zt){let h=this.preMatch.matched.get(p);if(null!=h&&h!=r)return!1;let O=p.dom;if((!this.lock||!(O==this.lock||1==O.nodeType&&O.contains(this.lock.parentNode))||t.isText&&p.node&&p.node.isText&&p.nodeDOM.nodeValue==t.text&&3!=p.dirty&&Me(e,p.outerDeco))&&p.update(t,e,o,i))return this.destroyBetween(this.index,c),p.dom!=O&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,o,i,r){this.top.children.splice(this.index++,0,Zt.create(this.top,t,e,o,i,r)),this.changed=!0}placeWidget(t,e,o){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let r=new Pt(this.top,t,e,o);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof Ft;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof l)||/\n$/.test(t.node.text))&&((It||_t)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);"IMG"==t&&(o.className="ProseMirror-separator",o.alt=""),"BR"==t&&(o.className="ProseMirror-trailingBreak");let i=new u(this.top,[],o,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}}function Ge(n,t){return n.type.side-t.type.side}function un(n,t,e,o,i){let r=[];for(let c=0,p=0;c<n.length;c++){let h=n[c],O=p,x=p+=h.size;O>=e||x<=t?r.push(h):(O<t&&r.push(h.slice(0,t-O,o)),i&&(r.push(i),i=void 0),x>e&&r.push(h.slice(e-O,h.size,o)))}return r}function Le(n,t=null){let e=n.domSelection(),o=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),r=i&&0==i.size,c=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(c<0)return null;let h,O,p=o.resolve(c);if(et(e)){for(h=p;i&&!i.node;)i=i.parent;let x=i.node;if(i&&x.isAtom&&T.qv.isSelectable(x)&&i.parent&&(!x.isInline||!function(n,t,e){for(let o=0==t,i=t==Yt(n);o||i;){if(n==e)return!0;let r=Ct(n);if(!(n=n.parentNode))return!1;o=o&&0==r,i=i&&r==Yt(n)}}(e.focusNode,e.focusOffset,i.dom))){let J=i.posBefore;O=new T.qv(c==J?p:o.resolve(J))}}else{let x=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(x<0)return null;h=o.resolve(x)}return O||(O=qe(n,h,p,"pointer"==t||n.state.selection.head<p.pos&&!r?1:-1)),O}function fe(n){return n.editable?n.hasFocus():pn(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Xe(n,t=!1){let e=n.state.selection;if(ze(n,e),fe(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&_t){let o=n.domSelection(),i=n.domObserver.currentSelection;if(o.anchorNode&&i.anchorNode&&rt(o.anchorNode,o.anchorOffset,i.anchorNode,i.anchorOffset))return n.input.mouseDown.delayedSelectionSync=!0,void n.domObserver.setCurSelection()}if(n.domObserver.disconnectSelection(),n.cursorWrapper)!function(n){let t=n.domSelection(),e=document.createRange(),o=n.cursorWrapper.dom,i="IMG"==o.nodeName;i?e.setEnd(o.parentNode,Ct(o)+1):e.setEnd(o,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&at&&pt<=11&&(o.disabled=!0,o.disabled=!1)}(n);else{let r,c,{anchor:o,head:i}=e;bn&&!(e instanceof T.Bs)&&(e.$from.parent.inlineContent||(r=xn(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(c=xn(n,e.to))),n.docView.setSelection(o,i,n.root,t),bn&&(r&&ln(r),c&&ln(c)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelection(),o=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=o||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!fe(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const bn=It||_t&&Lt<63;function xn(n,t){let{node:e,offset:o}=n.docView.domFromPos(t,0),i=o<e.childNodes.length?e.childNodes[o]:null,r=o?e.childNodes[o-1]:null;if(It&&i&&"false"==i.contentEditable)return xe(i);if(!(i&&"false"!=i.contentEditable||r&&"false"!=r.contentEditable)){if(i)return xe(i);if(r)return xe(r)}}function xe(n){return n.contentEditable="true",It&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function ln(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function ze(n,t){if(t instanceof T.qv){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(Bn(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else Bn(n)}function Bn(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function qe(n,t,e,o){return n.someProp("createSelectionBetween",i=>i(n,t,e))||T.Bs.between(t,e,o)}function an(n){return(!n.editable||n.root.activeElement==n.dom)&&pn(n)}function pn(n){let t=n.domSelection();if(!t.anchorNode)return!1;try{return n.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function on(n,t){let{$anchor:e,$head:o}=n.selection,i=t>0?e.max(o):e.min(o),r=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return r&&T.Y1.findFrom(r,t)}function ye(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function On(n,t,e){let o=n.state.selection;if(!(o instanceof T.Bs)){if(o instanceof T.qv&&o.node.isInline)return ye(n,new T.Bs(t>0?o.$to:o.$from));{let i=on(n.state,t);return!!i&&ye(n,i)}}if(!o.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=on(n.state,t);return!!(i&&i instanceof T.qv)&&ye(n,i)}if(!(ht&&e.indexOf("m")>-1)){let c,i=o.$head,r=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!r||r.isText)return!1;let p=t<0?i.pos-r.nodeSize:i.pos;return!!(r.isAtom||(c=n.docView.descAt(p))&&!c.contentDOM)&&(T.qv.isSelectable(r)?ye(n,new T.qv(t<0?n.state.doc.resolve(i.pos-r.nodeSize):i)):!!ct&&ye(n,new T.Bs(n.state.doc.resolve(t<0?p:p+r.nodeSize))))}}function tn(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function fn(n){let t=n.pmViewDesc;return t&&0==t.size&&(n.nextSibling||"BR"!=n.nodeName)}function Ze(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let i,r,c=!1;for(Ot&&1==e.nodeType&&o<tn(e)&&fn(e.childNodes[o])&&(c=!0);;)if(o>0){if(1!=e.nodeType)break;{let p=e.childNodes[o-1];if(fn(p))i=e,r=--o;else{if(3!=p.nodeType)break;e=p,o=e.nodeValue.length}}}else{if(Be(e))break;{let p=e.previousSibling;for(;p&&fn(p);)i=e.parentNode,r=Ct(p),p=p.previousSibling;if(p)e=p,o=tn(e);else{if(e=e.parentNode,e==n.dom)break;o=0}}}c?C(n,t,e,o):i&&C(n,t,i,r)}function rn(n){let t=n.domSelection(),e=t.focusNode,o=t.focusOffset;if(!e)return;let r,c,i=tn(e);for(;;)if(o<i){if(1!=e.nodeType)break;if(!fn(e.childNodes[o]))break;r=e,c=++o}else{if(Be(e))break;{let p=e.nextSibling;for(;p&&fn(p);)r=p.parentNode,c=Ct(p)+1,p=p.nextSibling;if(p)e=p,o=0,i=tn(e);else{if(e=e.parentNode,e==n.dom)break;o=i=0}}}r&&C(n,t,r,c)}function Be(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function C(n,t,e,o){if(et(t)){let r=document.createRange();r.setEnd(e,o),r.setStart(e,o),t.removeAllRanges(),t.addRange(r)}else t.extend&&t.extend(e,o);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Xe(n)},50)}function f(n,t,e){let o=n.state.selection;if(o instanceof T.Bs&&!o.empty||e.indexOf("s")>-1||ht&&e.indexOf("m")>-1)return!1;let{$from:i,$to:r}=o;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let c=on(n.state,t);if(c&&c instanceof T.qv)return ye(n,c)}if(!i.parent.inlineContent){let c=t<0?i:r,p=o instanceof T.C1?T.Y1.near(c,t):T.Y1.findFrom(c,t);return!!p&&ye(n,p)}return!1}function y(n,t){if(!(n.state.selection instanceof T.Bs))return!0;let{$head:e,$anchor:o,empty:i}=n.state.selection;if(!e.sameParent(o))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let r=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(r&&!r.isText){let c=n.state.tr;return t<0?c.delete(e.pos-r.nodeSize,e.pos):c.delete(e.pos,e.pos+r.nodeSize),n.dispatch(c),!0}return!1}function M(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function ot(n,t){let e=[],{content:o,openStart:i,openEnd:r}=t;for(;i>1&&r>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,r--;let tt=o.firstChild;e.push(tt.type.name,tt.attrs!=tt.type.defaultAttrs?tt.attrs:null),o=tt.content}let c=n.someProp("clipboardSerializer")||s.PW.fromSchema(n.state.schema),p=Dn(),h=p.createElement("div");h.appendChild(c.serializeFragment(o,{document:p}));let x,O=h.firstChild,J=0;for(;O&&1==O.nodeType&&(x=ce[O.nodeName.toLowerCase()]);){for(let tt=x.length-1;tt>=0;tt--){let vt=p.createElement(x[tt]);for(;h.firstChild;)vt.appendChild(h.firstChild);h.appendChild(vt),J++}O=h.firstChild}return O&&1==O.nodeType&&O.setAttribute("data-pm-slice",`${i} ${r}${J?` -${J}`:""} ${JSON.stringify(e)}`),{dom:h,text:n.someProp("clipboardTextSerializer",tt=>tt(t))||t.content.textBetween(0,t.content.size,"\n\n")}}function j(n,t,e,o,i){let c,p,r=i.parent.type.spec.code;if(!e&&!t)return null;let h=t&&(o||r||!e);if(h){if(n.someProp("transformPastedText",Y=>{t=Y(t,r||o)}),r)return t?new s.p2(s.HY.from(n.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):s.p2.empty;let J=n.someProp("clipboardTextParser",Y=>Y(t,i,o));if(J)p=J;else{let Y=i.marks(),{schema:tt}=n.state,vt=s.PW.fromSchema(tt);c=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(wt=>{let Wt=c.appendChild(document.createElement("p"));wt&&Wt.appendChild(vt.serializeNode(tt.text(wt,Y)))})}}else n.someProp("transformPastedHTML",J=>{e=J(e)}),c=function(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let i,e=Dn().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(n);if((i=o&&ce[o[1].toLowerCase()])&&(n=i.map(r=>"<"+r+">").join("")+n+i.map(r=>"</"+r+">").reverse().join("")),e.innerHTML=n,i)for(let r=0;r<i.length;r++)e=e.querySelector(i[r])||e;return e}(e),ct&&function(n){let t=n.querySelectorAll(_t?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let o=t[e];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),o)}}(c);let O=c&&c.querySelector("[data-pm-slice]"),x=O&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(O.getAttribute("data-pm-slice")||"");if(x&&x[3])for(let J=+x[3];J>0&&c.firstChild;J--)c=c.firstChild;if(p||(p=(n.someProp("clipboardParser")||n.someProp("domParser")||s.aw.fromSchema(n.state.schema)).parseSlice(c,{preserveWhitespace:!(!h&&!x),context:i,ruleFromNode:Y=>"BR"!=Y.nodeName||Y.nextSibling||!Y.parentNode||it.test(Y.parentNode.nodeName)?null:{ignore:!0}})),x)p=function(n,t){if(!n.size)return n;let o,e=n.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(p){return n}let{content:i,openStart:r,openEnd:c}=n;for(let p=o.length-2;p>=0;p-=2){let h=e.nodes[o[p]];if(!h||h.hasRequiredAttrs())break;i=s.HY.from(h.create(o[p+1],i)),r++,c++}return new s.p2(i,r,c)}(oe(p,+x[1],+x[2]),x[4]);else if(p=s.p2.maxOpen(function(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let r,i=t.node(e).contentMatchAt(t.index(e)),c=[];if(n.forEach(p=>{if(!c)return;let O,h=i.findWrapping(p.type);if(!h)return c=null;if(O=c.length&&r.length&&zt(h,r,p,c[c.length-1],0))c[c.length-1]=O;else{c.length&&(c[c.length-1]=Qt(c[c.length-1],r.length));let x=Ht(p,h);c.push(x),i=i.matchType(x.type),r=h}}),c)return s.HY.from(c)}return n}(p.content,i),!0),p.openStart||p.openEnd){let J=0,Y=0;for(let tt=p.content.firstChild;J<p.openStart&&!tt.type.spec.isolating;J++,tt=tt.firstChild);for(let tt=p.content.lastChild;Y<p.openEnd&&!tt.type.spec.isolating;Y++,tt=tt.lastChild);p=oe(p,J,Y)}return n.someProp("transformPasted",J=>{p=J(p)}),p}const it=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Ht(n,t,e=0){for(let o=t.length-1;o>=e;o--)n=t[o].create(null,s.HY.from(n));return n}function zt(n,t,e,o,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let r=zt(n,t,e,o.lastChild,i+1);if(r)return o.copy(o.content.replaceChild(o.childCount-1,r));if(o.contentMatchAt(o.childCount).matchType(i==n.length-1?e.type:n[i+1]))return o.copy(o.content.append(s.HY.from(Ht(e,n,i+1))))}}function Qt(n,t){if(0==t)return n;let e=n.content.replaceChild(n.childCount-1,Qt(n.lastChild,t-1)),o=n.contentMatchAt(n.childCount).fillBefore(s.HY.empty,!0);return n.copy(e.append(o))}function jt(n,t,e,o,i,r){let c=t<0?n.firstChild:n.lastChild,p=c.content;return i<o-1&&(p=jt(p,t,e,o,i+1,r)),i>=e&&(p=t<0?c.contentMatchAt(0).fillBefore(p,n.childCount>1||r<=i).append(p):p.append(c.contentMatchAt(c.childCount).fillBefore(s.HY.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,c.copy(p))}function oe(n,t,e){return t<n.openStart&&(n=new s.p2(jt(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new s.p2(jt(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const ce={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Oe=null;function Dn(){return Oe||(Oe=document.implementation.createHTMLDocument("title"))}const v={};let R={};class q{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function kt(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function ee(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=o=>ne(n,o))})}function ne(n,t){return n.someProp("handleDOMEvents",e=>{let o=e[t.type];return!!o&&(o(n,t)||t.defaultPrevented)})}function ie(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function pe(n){return{left:n.clientX,top:n.clientY}}function mn(n,t,e,o,i){if(-1==o)return!1;let r=n.state.doc.resolve(o);for(let c=r.depth+1;c>0;c--)if(n.someProp(t,p=>c>r.depth?p(n,e,r.nodeAfter,r.before(c),i,!0):p(n,e,r.node(c),r.before(c),i,!1)))return!0;return!1}function Ve(n,t,e){n.focused||n.focus();let o=n.state.tr.setSelection(t);"pointer"==e&&o.setMeta("pointer",!0),n.dispatch(o)}function yn(n,t,e,o){return mn(n,"handleDoubleClickOn",t,e,o)||n.someProp("handleDoubleClick",i=>i(n,t,o))}function Zn(n,t,e,o){return mn(n,"handleTripleClickOn",t,e,o)||n.someProp("handleTripleClick",i=>i(n,t,o))||function(n,t,e){if(0!=e.button)return!1;let o=n.state.doc;if(-1==t)return!!o.inlineContent&&(Ve(n,T.Bs.create(o,0,o.content.size),"pointer"),!0);let i=o.resolve(t);for(let r=i.depth+1;r>0;r--){let c=r>i.depth?i.nodeAfter:i.node(r),p=i.before(r);if(c.inlineContent)Ve(n,T.Bs.create(o,p+1,p+1+c.content.size),"pointer");else{if(!T.qv.isSelectable(c))continue;Ve(n,T.qv.create(o,p),"pointer")}return!0}}(n,e,o)}function An(n){return sn(n)}R.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=16==e.keyCode||e.shiftKey,!gn(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!X||!_t||13!=e.keyCode))if(229!=e.keyCode&&n.domObserver.forceFlush(),!Dt||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)n.someProp("handleKeyDown",o=>o(n,e))||function(n,t){let e=t.keyCode,o=function(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}(t);return 8==e||ht&&72==e&&"c"==o?y(n,-1)||Ze(n):46==e||ht&&68==e&&"c"==o?y(n,1)||rn(n):13==e||27==e||(37==e||ht&&66==e&&"c"==o?On(n,-1,o)||Ze(n):39==e||ht&&70==e&&"c"==o?On(n,1,o)||rn(n):38==e||ht&&80==e&&"c"==o?f(n,-1,o)||Ze(n):40==e||ht&&78==e&&"c"==o?function(n){if(!It||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelection();if(t&&1==t.nodeType&&0==e&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;M(n,o,"true"),setTimeout(()=>M(n,o,"false"),20)}return!1}(n)||f(n,1,o)||rn(n):o==(ht?"m":"c")&&(66==e||73==e||89==e||90==e))}(n,e)?e.preventDefault():kt(n,"key");else{let o=Date.now();n.input.lastIOSEnter=o,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==o&&(n.someProp("handleKeyDown",i=>i(n,lt(13,"Enter"))),n.input.lastIOSEnter=0)},200)}},R.keyup=(n,t)=>{16==t.keyCode&&(n.input.shiftKey=!1)},R.keypress=(n,t)=>{let e=t;if(gn(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||ht&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e)))return void e.preventDefault();let o=n.state.selection;if(!(o instanceof T.Bs&&o.$from.sameParent(o.$to))){let i=String.fromCharCode(e.charCode);n.someProp("handleTextInput",r=>r(n,o.$from.pos,o.$to.pos,i))||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};const Hn=ht?"metaKey":"ctrlKey";v.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let o=An(n),i=Date.now(),r="singleClick";i-n.input.lastClick.time<500&&function(n,t){let e=t.x-n.clientX,o=t.y-n.clientY;return e*e+o*o<100}(e,n.input.lastClick)&&!e[Hn]&&("singleClick"==n.input.lastClick.type?r="doubleClick":"doubleClick"==n.input.lastClick.type&&(r="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:r};let c=n.posAtCoords(pe(e));!c||("singleClick"==r?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Un(n,c,e,!!o)):("doubleClick"==r?yn:Zn)(n,c.pos,c.inside,e)?e.preventDefault():kt(n,"pointer"))};class Un{constructor(t,e,o,i){let r,c;if(this.view=t,this.pos=e,this.event=o,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[Hn],this.allowDefault=o.shiftKey,e.inside>-1)r=t.state.doc.nodeAt(e.inside),c=e.inside;else{let x=t.state.doc.resolve(e.pos);r=x.parent,c=x.depth?x.before():0}const p=i?null:o.target,h=p?t.docView.nearestDesc(p,!0):null;this.target=h?h.dom:null;let{selection:O}=t.state;(0==o.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||O instanceof T.qv&&O.from<=c&&O.to>c)&&(this.mightDrag={node:r,pos:c,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Ot||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),kt(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Xe(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(pe(t))),this.allowDefault||!e?kt(this.view,"pointer"):function(n,t,e,o,i){return mn(n,"handleClickOn",t,e,o)||n.someProp("handleClick",r=>r(n,t,o))||(i?function(n,t){if(-1==t)return!1;let o,i,e=n.state.selection;e instanceof T.qv&&(o=e.node);let r=n.state.doc.resolve(t);for(let c=r.depth+1;c>0;c--){let p=c>r.depth?r.nodeAfter:r.node(c);if(T.qv.isSelectable(p)){i=o&&e.$from.depth>0&&c>=e.$from.depth&&r.before(e.$from.depth+1)==e.$from.pos?r.before(e.$from.depth):r.before(c);break}}return null!=i&&(Ve(n,T.qv.create(n.state.doc,i),"pointer"),!0)}(n,e):function(n,t){if(-1==t)return!1;let e=n.state.doc.resolve(t),o=e.nodeAfter;return!!(o&&o.isAtom&&T.qv.isSelectable(o))&&(Ve(n,new T.qv(e),"pointer"),!0)}(n,e))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||It&&this.mightDrag&&!this.mightDrag.node.isAtom||_t&&!(this.view.state.selection instanceof T.Bs)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Ve(this.view,T.Y1.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):kt(this.view,"pointer")}move(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),kt(this.view,"pointer"),0==t.buttons&&this.done()}}function gn(n,t){return!!n.composing||!!(It&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500)&&(n.input.compositionEndedAt=-2e8,!0)}v.touchdown=n=>{An(n),kt(n,"pointer")},v.contextmenu=n=>An(n);const Pn=X?5e3:-1;function Sn(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>sn(n),t))}function In(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=function(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function sn(n,t=!1){if(!(X&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),In(n),t||n.docView&&n.docView.dirty){let e=Le(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}R.compositionstart=R.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(o=>!1===o.type.spec.inclusive)))n.markCursor=n.state.storedMarks||e.marks(),sn(n,!0),n.markCursor=null;else if(sn(n),Ot&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let o=n.domSelection();for(let i=o.focusNode,r=o.focusOffset;i&&1==i.nodeType&&0!=r;){let c=r<0?i.lastChild:i.childNodes[r-1];if(!c)break;if(3==c.nodeType){o.collapse(c,c.nodeValue.length);break}i=c,r=-1}}n.input.composing=!0}Sn(n,Pn)},R.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,Sn(n,20))};const _n=at&&pt<15||Dt&&z<604;function ve(n,t,e,o){let i=j(n,t,e,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",p=>p(n,o,i||s.p2.empty)))return!0;if(!i)return!1;let r=function(n){return 0==n.openStart&&0==n.openEnd&&1==n.content.childCount?n.content.firstChild:null}(i),c=r?n.state.tr.replaceSelectionWith(r,n.input.shiftKey):n.state.tr.replaceSelection(i);return n.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}v.copy=R.cut=(n,t)=>{let e=t,o=n.state.selection,i="cut"==e.type;if(o.empty)return;let r=_n?null:e.clipboardData,c=o.content(),{dom:p,text:h}=ot(n,c);r?(e.preventDefault(),r.clearData(),r.setData("text/html",p.innerHTML),r.setData("text/plain",h)):function(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}(n,p),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},R.paste=(n,t)=>{let e=t;if(n.composing&&!X)return;let o=_n?null:e.clipboardData;o&&ve(n,o.getData("text/plain"),o.getData("text/html"),e)?e.preventDefault():function(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,o=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout(()=>{n.focus(),o.parentNode&&o.parentNode.removeChild(o),e?ve(n,o.value,null,t):ve(n,o.textContent,o.innerHTML,t)},50)}(n,e)};class Lo{constructor(t,e){this.slice=t,this.move=e}}const Mo=ht?"altKey":"ctrlKey";v.dragstart=(n,t)=>{let e=t,o=n.input.mouseDown;if(o&&o.done(),!e.dataTransfer)return;let i=n.state.selection,r=i.empty?null:n.posAtCoords(pe(e));if(!(r&&r.pos>=i.from&&r.pos<=(i instanceof T.qv?i.to-1:i.to)))if(o&&o.mightDrag)n.dispatch(n.state.tr.setSelection(T.qv.create(n.state.doc,o.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){let O=n.docView.nearestDesc(e.target,!0);O&&O.node.type.spec.draggable&&O!=n.docView&&n.dispatch(n.state.tr.setSelection(T.qv.create(n.state.doc,O.posBefore)))}let c=n.state.selection.content(),{dom:p,text:h}=ot(n,c);e.dataTransfer.clearData(),e.dataTransfer.setData(_n?"Text":"text/html",p.innerHTML),e.dataTransfer.effectAllowed="copyMove",_n||e.dataTransfer.setData("text/plain",h),n.dragging=new Lo(c,!e[Mo])},v.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},R.dragover=R.dragenter=(n,t)=>t.preventDefault(),R.drop=(n,t)=>{let e=t,o=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(pe(e));if(!i)return;let r=n.state.doc.resolve(i.pos);if(!r)return;let c=o&&o.slice;c?n.someProp("transformPasted",vt=>{c=vt(c)}):c=j(n,e.dataTransfer.getData(_n?"Text":"text/plain"),_n?null:e.dataTransfer.getData("text/html"),!1,r);let p=!(!o||e[Mo]);if(n.someProp("handleDrop",vt=>vt(n,e,c||s.p2.empty,p)))return void e.preventDefault();if(!c)return;e.preventDefault();let h=c?(0,b.nj)(n.state.doc,r.pos,c):r.pos;null==h&&(h=r.pos);let O=n.state.tr;p&&O.deleteSelection();let x=O.mapping.map(h),J=0==c.openStart&&0==c.openEnd&&1==c.content.childCount,Y=O.doc;if(J?O.replaceRangeWith(x,x,c.content.firstChild):O.replaceRange(x,x,c),O.doc.eq(Y))return;let tt=O.doc.resolve(x);if(J&&T.qv.isSelectable(c.content.firstChild)&&tt.nodeAfter&&tt.nodeAfter.sameMarkup(c.content.firstChild))O.setSelection(new T.qv(tt));else{let vt=O.mapping.map(h);O.mapping.maps[O.mapping.maps.length-1].forEach((wt,Wt,Gt,me)=>vt=me),O.setSelection(qe(n,tt,O.doc.resolve(vt)))}n.focus(),n.dispatch(O.setMeta("uiEvent","drop"))},v.focus=n=>{n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelection())&&Xe(n)},20))},v.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},v.beforeinput=(n,t)=>{if(_t&&X&&"deleteContentBackward"==t.inputType){n.domObserver.flushSoon();let{domChangeCount:o}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=o||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",r=>r(n,lt(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in R)v[n]=R[n];function qn(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class ho{constructor(t,e){this.toDOM=t,this.spec=e||kn,this.side=this.spec.side||0}map(t,e,o,i){let{pos:r,deleted:c}=t.mapResult(e.from+i,this.side<0?-1:1);return c?null:new en(r-o,r-o,this)}valid(){return!0}eq(t){return this==t||t instanceof ho&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&qn(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class En{constructor(t,e){this.attrs=t,this.spec=e||kn}map(t,e,o,i){let r=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-o,c=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-o;return r>=c?null:new en(r,c,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof En&&qn(this.attrs,t.attrs)&&qn(this.spec,t.spec)}static is(t){return t.type instanceof En}destroy(){}}class oo{constructor(t,e){this.attrs=t,this.spec=e||kn}map(t,e,o,i){let r=t.mapResult(e.from+i,1);if(r.deleted)return null;let c=t.mapResult(e.to+i,-1);return c.deleted||c.pos<=r.pos?null:new en(r.pos-o,c.pos-o,this)}valid(t,e){let r,{index:o,offset:i}=t.content.findIndex(e.from);return i==e.from&&!(r=t.child(o)).isText&&i+r.nodeSize==e.to}eq(t){return this==t||t instanceof oo&&qn(this.attrs,t.attrs)&&qn(this.spec,t.spec)}destroy(){}}class en{constructor(t,e,o){this.from=t,this.to=e,this.type=o}copy(t,e){return new en(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,o){return this.type.map(t,this,e,o)}static widget(t,e,o){return new en(t,t,new ho(e,o))}static inline(t,e,o,i){return new en(t,e,new En(o,i))}static node(t,e,o,i){return new en(t,e,new oo(o,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof En}}const Wn=[],kn={};class Pe{constructor(t,e){this.local=t.length?t:Wn,this.children=e.length?e:Wn}static create(t,e){return e.length?eo(e,t,0,kn):Se}find(t,e,o){let i=[];return this.findInner(null==t?0:t,null==e?1e9:e,i,0,o),i}findInner(t,e,o,i,r){for(let c=0;c<this.local.length;c++){let p=this.local[c];p.from<=e&&p.to>=t&&(!r||r(p.spec))&&o.push(p.copy(p.from+i,p.to+i))}for(let c=0;c<this.children.length;c+=3)if(this.children[c]<e&&this.children[c+1]>t){let p=this.children[c]+1;this.children[c+2].findInner(t-p,e-p,o,i+p,r)}}map(t,e,o){return this==Se||0==t.maps.length?this:this.mapInner(t,e,0,0,o||kn)}mapInner(t,e,o,i,r){let c;for(let p=0;p<this.local.length;p++){let h=this.local[p].map(t,o,i);h&&h.type.valid(e,h)?(c||(c=[])).push(h):r.onRemove&&r.onRemove(this.local[p].spec)}return this.children.length?function(n,t,e,o,i,r,c){let p=n.slice(),h=(x,J,Y,tt)=>{for(let vt=0;vt<p.length;vt+=3){let Wt,wt=p[vt+1];if(wt<0||x>wt+r)continue;let Gt=p[vt]+r;J>=Gt?p[vt+1]=x<=Gt?-2:-1:Y>=i&&(Wt=tt-Y-(J-x))&&(p[vt]+=Wt,p[vt+1]+=Wt)}};for(let x=0;x<e.maps.length;x++)e.maps[x].forEach(h);let O=!1;for(let x=0;x<p.length;x+=3)if(p[x+1]<0){if(-2==p[x+1]){O=!0,p[x+1]=-1;continue}let J=e.map(n[x]+r),Y=J-i;if(Y<0||Y>=o.content.size){O=!0;continue}let vt=e.map(n[x+1]+r,-1)-i,{index:wt,offset:Wt}=o.content.findIndex(Y),Gt=o.maybeChild(wt);if(Gt&&Wt==Y&&Wt+Gt.nodeSize==vt){let me=p[x+2].mapInner(e,Gt,J+1,n[x]+r+1,c);me!=Se?(p[x]=Y,p[x+1]=vt,p[x+2]=me):(p[x+1]=-2,O=!0)}else O=!0}if(O){let x=function(n,t,e,o,i,r,c){function p(h,O){for(let x=0;x<h.local.length;x++){let J=h.local[x].map(o,i,O);J?e.push(J):c.onRemove&&c.onRemove(h.local[x].spec)}for(let x=0;x<h.children.length;x+=3)p(h.children[x+2],h.children[x]+O+1)}for(let h=0;h<n.length;h+=3)-1==n[h+1]&&p(n[h+2],t[h]+r+1);return e}(p,n,t,e,i,r,c),J=eo(x,o,0,c);t=J.local;for(let Y=0;Y<p.length;Y+=3)p[Y+1]<0&&(p.splice(Y,3),Y-=3);for(let Y=0,tt=0;Y<J.children.length;Y+=3){let vt=J.children[Y];for(;tt<p.length&&p[tt]<vt;)tt+=3;p.splice(tt,0,J.children[Y],J.children[Y+1],J.children[Y+2])}}return new Pe(t.sort(wn),p)}(this.children,c||[],t,e,o,i,r):c?new Pe(c.sort(wn),Wn):Se}add(t,e){return e.length?this==Se?Pe.create(t,e):this.addInner(t,e,0):this}addInner(t,e,o){let i,r=0;t.forEach((p,h)=>{let x,O=h+o;if(x=ro(e,p,O)){for(i||(i=this.children.slice());r<i.length&&i[r]<h;)r+=3;i[r]==h?i[r+2]=i[r+2].addInner(p,x,O+1):i.splice(r,0,h,h+p.nodeSize,eo(x,p,O+1,kn)),r+=3}});let c=to(r?so(e):e,-o);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||c.splice(p--,1);return new Pe(c.length?this.local.concat(c).sort(wn):this.local,i||this.children)}remove(t){return 0==t.length||this==Se?this:this.removeInner(t,0)}removeInner(t,e){let o=this.children,i=this.local;for(let r=0;r<o.length;r+=3){let c,p=o[r]+e,h=o[r+1]+e;for(let J,x=0;x<t.length;x++)(J=t[x])&&J.from>p&&J.to<h&&(t[x]=null,(c||(c=[])).push(J));if(!c)continue;o==this.children&&(o=this.children.slice());let O=o[r+2].removeInner(c,p+1);O!=Se?o[r+2]=O:(o.splice(r,3),r-=3)}if(i.length)for(let c,r=0;r<t.length;r++)if(c=t[r])for(let p=0;p<i.length;p++)i[p].eq(c,e)&&(i==this.local&&(i=this.local.slice()),i.splice(p--,1));return o==this.children&&i==this.local?this:i.length||o.length?new Pe(i,o):Se}forChild(t,e){if(this==Se)return this;if(e.isLeaf)return Pe.empty;let o,i;for(let p=0;p<this.children.length;p+=3)if(this.children[p]>=t){this.children[p]==t&&(o=this.children[p+2]);break}let r=t+1,c=r+e.content.size;for(let p=0;p<this.local.length;p++){let h=this.local[p];if(h.from<c&&h.to>r&&h.type instanceof En){let O=Math.max(r,h.from)-r,x=Math.min(c,h.to)-r;O<x&&(i||(i=[])).push(h.copy(O,x))}}if(i){let p=new Pe(i.sort(wn),Wn);return o?new Cn([p,o]):p}return o||Se}eq(t){if(this==t)return!0;if(!(t instanceof Pe)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return lo(this.localsInner(t))}localsInner(t){if(this==Se)return Wn;if(t.inlineContent||!this.local.some(En.is))return this.local;let e=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof En||e.push(this.local[o]);return e}}Pe.empty=new Pe([],[]),Pe.removeOverlap=lo;const Se=Pe.empty;class Cn{constructor(t){this.members=t}map(t,e){const o=this.members.map(i=>i.map(t,e,kn));return Cn.from(o)}forChild(t,e){if(e.isLeaf)return Pe.empty;let o=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(t,e);r!=Se&&(r instanceof Cn?o=o.concat(r.members):o.push(r))}return Cn.from(o)}eq(t){if(!(t instanceof Cn)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,o=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(t);if(r.length)if(e){o&&(e=e.slice(),o=!1);for(let c=0;c<r.length;c++)e.push(r[c])}else e=r}return e?lo(o?e:e.sort(wn)):Wn}static from(t){switch(t.length){case 0:return Se;case 1:return t[0];default:return new Cn(t)}}}function to(n,t){if(!t||!n.length)return n;let e=[];for(let o=0;o<n.length;o++){let i=n[o];e.push(new en(i.from+t,i.to+t,i.type))}return e}function ro(n,t,e){if(t.isLeaf)return null;let o=e+t.nodeSize,i=null;for(let c,r=0;r<n.length;r++)(c=n[r])&&c.from>e&&c.to<o&&((i||(i=[])).push(c),n[r]=null);return i}function so(n){let t=[];for(let e=0;e<n.length;e++)null!=n[e]&&t.push(n[e]);return t}function eo(n,t,e,o){let i=[],r=!1;t.forEach((p,h)=>{let O=ro(n,p,h+e);if(O){r=!0;let x=eo(O,p,e+h+1,o);x!=Se&&i.push(h,h+p.nodeSize,x)}});let c=to(r?so(n):n,-e).sort(wn);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||(o.onRemove&&o.onRemove(c[p].spec),c.splice(p--,1));return c.length||i.length?new Pe(c,i):Se}function wn(n,t){return n.from-t.from||n.to-t.to}function lo(n){let t=n;for(let e=0;e<t.length-1;e++){let o=t[e];if(o.from!=o.to)for(let i=e+1;i<t.length;i++){let r=t[i];if(r.from!=o.from){r.from<o.to&&(t==n&&(t=n.slice()),t[e]=o.copy(o.from,r.from),mo(t,i,o.copy(r.from,o.to)));break}r.to!=o.to&&(t==n&&(t=n.slice()),t[i]=r.copy(r.from,o.to),mo(t,i+1,r.copy(o.to,r.to)))}}return t}function mo(n,t,e){for(;t<n.length&&wn(e,n[t])>0;)t++;n.splice(t,0,e)}function ao(n){let t=[];return n.someProp("decorations",e=>{let o=e(n.state);o&&o!=Se&&t.push(o)}),n.cursorWrapper&&t.push(Pe.create(n.state.doc,[n.cursorWrapper.deco])),Cn.from(t)}const yo={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Eo=at&&pt<=11;class no{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class bo{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new no,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let i=0;i<o.length;i++)this.queue.push(o[i]);at&&pt<=11&&o.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Eo&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,yo)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(an(this.view)){if(this.suppressingSelectionUpdates)return Xe(this.view);if(at&&pt<=11&&!this.view.state.selection.empty){let t=this.view.domSelection();if(t.focusNode&&rt(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(t){if(0==t.rangeCount)return!0;let e=t.getRangeAt(0).commonAncestorContainer,o=this.view.docView.nearestDesc(e);return o&&o.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let e=this.view.domSelection(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&an(this.view)&&!this.ignoreSelectionChange(e),i=-1,r=-1,c=!1,p=[];if(this.view.editable)for(let h=0;h<t.length;h++){let O=this.registerMutation(t[h],p);O&&(i=i<0?O.from:Math.min(O.from,i),r=r<0?O.to:Math.max(O.to,r),O.typeOver&&(c=!0))}if(Ot&&p.length>1){let h=p.filter(O=>"BR"==O.nodeName);if(2==h.length){let O=h[0],x=h[1];O.parentNode&&O.parentNode.parentNode==x.parentNode?x.remove():O.remove()}}(i>-1||o)&&(i>-1&&(this.view.docView.markDirty(i,r),go||(go=!0,"normal"==getComputedStyle(this.view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(i,r,c,p),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Xe(this.view),this.currentSelection.set(e))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(o==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if("childList"==t.type){for(let x=0;x<t.addedNodes.length;x++)e.push(t.addedNodes[x]);if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let i=t.previousSibling,r=t.nextSibling;if(at&&pt<=11&&t.addedNodes.length)for(let x=0;x<t.addedNodes.length;x++){let{previousSibling:J,nextSibling:Y}=t.addedNodes[x];(!J||Array.prototype.indexOf.call(t.addedNodes,J)<0)&&(i=J),(!Y||Array.prototype.indexOf.call(t.addedNodes,Y)<0)&&(r=Y)}let c=i&&i.parentNode==t.target?Ct(i)+1:0,p=o.localPosFromDOM(t.target,c,-1),h=r&&r.parentNode==t.target?Ct(r):t.target.childNodes.length;return{from:p,to:o.localPosFromDOM(t.target,h,1)}}return"attributes"==t.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let go=!1;function Do(n){let t=n.pmViewDesc;if(t)return t.parseRule();if("BR"==n.nodeName&&n.parentNode){if(It&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(n.parentNode.lastChild==n||It&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function co(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:qe(n,t.resolve(e.anchor),t.resolve(e.head))}function po(n,t,e){let o=n.depth,i=t?n.end():n.pos;for(;o>0&&(t||n.indexAfter(o)==n.node(o).childCount);)o--,i++,t=!1;if(e){let r=n.node(o).maybeChild(n.indexAfter(o));for(;r&&!r.isLeaf;)r=r.firstChild,i++}return i}class Io{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new q,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(To),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=_o(this),jn(this),this.nodeViews=Co(this),this.docView=H(this.state.doc,Vn(this),ao(this),this.dom,this),this.domObserver=new bo(this,(o,i,r,c)=>function(n,t,e,o,i){if(t<0){let re=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,Fn=Le(n,re);if(Fn&&!n.state.selection.eq(Fn)){let Ro=n.state.tr.setSelection(Fn);"pointer"==re?Ro.setMeta("pointer",!0):"key"==re&&Ro.scrollIntoView(),n.dispatch(Ro)}return}let r=n.state.doc.resolve(t),c=r.sharedDepth(e);t=r.before(c+1),e=n.state.doc.resolve(e).after(c+1);let p=n.state.selection,h=function(n,t,e){let O,{node:o,fromOffset:i,toOffset:r,from:c,to:p}=n.docView.parseRange(t,e),h=n.domSelection(),x=h.anchorNode;if(x&&n.dom.contains(1==x.nodeType?x:x.parentNode)&&(O=[{node:x,offset:h.anchorOffset}],et(h)||O.push({node:h.focusNode,offset:h.focusOffset})),_t&&8===n.input.lastKeyCode)for(let Wt=r;Wt>i;Wt--){let Gt=o.childNodes[Wt-1],me=Gt.pmViewDesc;if("BR"==Gt.nodeName&&!me){r=Wt;break}if(!me||me.size)break}let J=n.state.doc,Y=n.someProp("domParser")||s.aw.fromSchema(n.state.schema),tt=J.resolve(c),vt=null,wt=Y.parse(o,{topNode:tt.parent,topMatch:tt.parent.contentMatchAt(tt.index()),topOpen:!0,from:i,to:r,preserveWhitespace:"pre"!=tt.parent.type.whitespace||"full",findPositions:O,ruleFromNode:Do,context:tt});if(O&&null!=O[0].pos){let Wt=O[0].pos,Gt=O[1]&&O[1].pos;null==Gt&&(Gt=Wt),vt={anchor:Wt+c,head:Gt+c}}return{doc:wt,sel:vt,from:c,to:p}}(n,t,e);if(_t&&n.cursorWrapper&&h.sel&&h.sel.anchor==n.cursorWrapper.deco.from){let re=n.cursorWrapper.deco.type.toDOM.nextSibling,Fn=re&&re.nodeValue?re.nodeValue.length:1;h.sel={anchor:h.sel.anchor+Fn,head:h.sel.anchor+Fn}}let J,Y,O=n.state.doc,x=O.slice(h.from,h.to);8===n.input.lastKeyCode&&Date.now()-100<n.input.lastKeyCodeTime?(J=n.state.selection.to,Y="end"):(J=n.state.selection.from,Y="start"),n.input.lastKeyCode=null;let tt=function(n,t,e,o,i){let r=n.findDiffStart(t,e);if(null==r)return null;let{a:c,b:p}=n.findDiffEnd(t,e+n.size,e+t.size);return"end"==i&&(o-=c+Math.max(0,r-Math.min(c,p))-r),c<r&&n.size<t.size?(r-=o<=r&&o>=c?r-o:0,p=r+(p-c),c=r):p<r&&(r-=o<=r&&o>=p?r-o:0,c=r+(c-p),p=r),{start:r,endA:c,endB:p}}(x.content,h.doc.content,h.from,J,Y);if((Dt&&n.input.lastIOSEnter>Date.now()-225||X)&&i.some(re=>"DIV"==re.nodeName||"P"==re.nodeName)&&(!tt||tt.endA>=tt.endB)&&n.someProp("handleKeyDown",re=>re(n,lt(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(!tt){if(!(o&&p instanceof T.Bs&&!p.empty&&p.$head.sameParent(p.$anchor))||n.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let re=co(n,n.state.doc,h.sel);re&&!re.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(re))}return}tt={start:p.from,endA:p.to,endB:p.to}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&tt.start==tt.endB&&n.state.selection instanceof T.Bs&&(tt.start>n.state.selection.from&&tt.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?tt.start=n.state.selection.from:tt.endA<n.state.selection.to&&tt.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(tt.endB+=n.state.selection.to-tt.endA,tt.endA=n.state.selection.to)),at&&pt<=11&&tt.endB==tt.start+1&&tt.endA==tt.start&&tt.start>h.from&&" \xa0"==h.doc.textBetween(tt.start-h.from-1,tt.start-h.from+1)&&(tt.start--,tt.endA--,tt.endB--);let me,vt=h.doc.resolveNoCache(tt.start-h.from),wt=h.doc.resolveNoCache(tt.endB-h.from),Wt=O.resolve(tt.start),Gt=vt.sameParent(wt)&&vt.parent.inlineContent&&Wt.end()>=tt.endA;if((Dt&&n.input.lastIOSEnter>Date.now()-225&&(!Gt||i.some(re=>"DIV"==re.nodeName||"P"==re.nodeName))||!Gt&&vt.pos<h.doc.content.size&&(me=T.Y1.findFrom(h.doc.resolve(vt.pos+1),1,!0))&&me.head==wt.pos)&&n.someProp("handleKeyDown",re=>re(n,lt(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(n.state.selection.anchor>tt.start&&function(n,t,e,o,i){if(!o.parent.isTextblock||e-t<=i.pos-o.pos||po(o,!0,!1)<i.pos)return!1;let r=n.resolve(t);if(r.parentOffset<r.parent.content.size||!r.parent.isTextblock)return!1;let c=n.resolve(po(r,!0,!0));return!(!c.parent.isTextblock||c.pos>e||po(c,!0,!1)<e)&&o.parent.content.cut(o.parentOffset).eq(c.parent.content)}(O,tt.start,tt.endA,vt,wt)&&n.someProp("handleKeyDown",re=>re(n,lt(8,"Backspace"))))return void(X&&_t&&n.domObserver.suppressSelectionUpdates());_t&&X&&tt.endB==tt.start&&(n.input.lastAndroidDelete=Date.now()),X&&!Gt&&vt.start()!=wt.start()&&0==wt.parentOffset&&vt.depth==wt.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==tt.endA&&(tt.endB-=2,wt=h.doc.resolveNoCache(tt.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(re){return re(n,lt(13,"Enter"))})},20));let He,zn,Tn,Ne=tt.start,nn=tt.endA;if(Gt)if(vt.pos==wt.pos)at&&pt<=11&&0==vt.parentOffset&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Xe(n),20)),He=n.state.tr.delete(Ne,nn),zn=O.resolve(tt.start).marksAcross(O.resolve(tt.endA));else if(tt.endA==tt.endB&&(Tn=function(n,t){let c,p,h,e=n.firstChild.marks,o=t.firstChild.marks,i=e,r=o;for(let x=0;x<o.length;x++)i=o[x].removeFromSet(i);for(let x=0;x<e.length;x++)r=e[x].removeFromSet(r);if(1==i.length&&0==r.length)p=i[0],c="add",h=x=>x.mark(p.addToSet(x.marks));else{if(0!=i.length||1!=r.length)return null;p=r[0],c="remove",h=x=>x.mark(p.removeFromSet(x.marks))}let O=[];for(let x=0;x<t.childCount;x++)O.push(h(t.child(x)));if(s.HY.from(O).eq(n))return{mark:p,type:c}}(vt.parent.content.cut(vt.parentOffset,wt.parentOffset),Wt.parent.content.cut(Wt.parentOffset,tt.endA-Wt.start()))))He=n.state.tr,"add"==Tn.type?He.addMark(Ne,nn,Tn.mark):He.removeMark(Ne,nn,Tn.mark);else if(vt.parent.child(vt.index()).isText&&vt.index()==wt.index()-(wt.textOffset?0:1)){let re=vt.parent.textBetween(vt.parentOffset,wt.parentOffset);if(n.someProp("handleTextInput",Fn=>Fn(n,Ne,nn,re)))return;He=n.state.tr.insertText(re,Ne,nn)}if(He||(He=n.state.tr.replace(Ne,nn,h.doc.slice(tt.start-h.from,tt.endB-h.from))),h.sel){let re=co(n,He.doc,h.sel);re&&!(_t&&X&&n.composing&&re.empty&&(tt.start!=tt.endB||n.input.lastAndroidDelete<Date.now()-100)&&(re.head==Ne||re.head==He.mapping.map(nn)-1)||at&&re.empty&&re.head==Ne)&&He.setSelection(re)}zn&&He.ensureMarks(zn),n.dispatch(He.scrollIntoView())}(this,o,i,r,c)),this.domObserver.start(),function(n){for(let t in v){let e=v[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=o=>{ie(n,o)&&!ne(n,o)&&(n.editable||!(o.type in R))&&e(n,o)})}It&&n.dom.addEventListener("input",()=>null),ee(n)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&ee(this),this._props=t,t.plugins&&(t.plugins.forEach(To),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)}setProps(t){let e={};for(let o in this._props)e[o]=this._props[o];e.state=this.state;for(let o in t)e[o]=t[o];this.update(e)}updateState(t){this.updateStateInner(t,this.state.plugins!=t.plugins)}updateStateInner(t,e){let o=this.state,i=!1,r=!1;if(t.storedMarks&&this.composing&&(In(this),r=!0),this.state=t,e){let J=Co(this);(function(n,t){let e=0,o=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)o++;return e!=o})(J,this.nodeViews)&&(this.nodeViews=J,i=!0),ee(this)}this.editable=_o(this),jn(this);let c=ao(this),p=Vn(this),h=e?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",O=i||!this.docView.matchesNode(t.doc,p,c);(O||!t.selection.eq(o.selection))&&(r=!0);let x="preserve"==h&&r&&null==this.dom.style.overflowAnchor&&function(n){let o,i,t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top);for(let r=(t.left+t.right)/2,c=e+1;c<Math.min(innerHeight,t.bottom);c+=5){let p=n.root.elementFromPoint(r,c);if(!p||p==n.dom||!n.dom.contains(p))continue;let h=p.getBoundingClientRect();if(h.top>=e-20){o=p,i=h.top;break}}return{refDOM:o,refTop:i,stack:$t(n.dom)}}(this);if(r){this.domObserver.stop();let J=O&&(at||_t)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&function(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}(o.selection,t.selection);if(O){let Y=_t?this.trackWrites=this.domSelection().focusNode:null;(i||!this.docView.update(t.doc,p,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=H(t.doc,p,c,this.dom,this)),Y&&!this.trackWrites&&(J=!0)}J||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelection();return rt(t.node,t.offset,e.anchorNode,e.anchorOffset)}(this))?Xe(this,J):(ze(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==h)this.dom.scrollTop=0;else if("to selection"==h){let J=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",Y=>Y(this)))if(t.selection instanceof T.qv){let Y=this.docView.domAfterPos(t.selection.from);1==Y.nodeType&&dt(this,Y.getBoundingClientRect(),J)}else dt(this,this.coordsAtPos(t.selection.head,1),J)}else x&&function({refDOM:n,refTop:t,stack:e}){let o=n?n.getBoundingClientRect().top:0;ae(e,0==o?0:o-t)}(x)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let o=this.pluginViews[e];o.update&&o.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let o=this.directPlugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let o=this.state.plugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}}someProp(t,e){let i,o=this._props&&this._props[t];if(null!=o&&(i=e?e(o):o))return i;for(let c=0;c<this.directPlugins.length;c++){let p=this.directPlugins[c].props[t];if(null!=p&&(i=e?e(p):p))return i}let r=this.state.plugins;if(r)for(let c=0;c<r.length;c++){let p=r[c].props[t];if(null!=p&&(i=e?e(p):p))return i}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(n){if(n.setActive)return n.setActive();if(le)return n.focus(le);let t=$t(n);n.focus(null==le?{get preventScroll(){return le={preventScroll:!0},!0}}:void 0),le||(le=!1,ae(t,0))}(this.dom),Xe(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e;return t||document}posAtCoords(t){return Ue(this,t)}coordsAtPos(t,e=1){return We(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,o=-1){let i=this.docView.posFromDOM(t,e,o);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return function(n,t,e){return Ae==t&&Q==e?E:(Ae=t,Q=e,E="up"==e||"down"==e?function(n,t,e){let o=t.selection,i="up"==e?o.$from:o.$to;return Je(n,t,()=>{let{node:r}=n.docView.domFromPos(i.pos,"up"==e?-1:1);for(;;){let p=n.docView.nearestDesc(r,!0);if(!p)break;if(p.node.isBlock){r=p.dom;break}r=p.dom.parentNode}let c=We(n,i.pos,1);for(let p=r.firstChild;p;p=p.nextSibling){let h;if(1==p.nodeType)h=p.getClientRects();else{if(3!=p.nodeType)continue;h=yt(p,0,p.nodeValue.length).getClientRects()}for(let O=0;O<h.length;O++){let x=h[O];if(x.bottom>x.top+1&&("up"==e?c.top-x.top>2*(x.bottom-c.top):x.bottom-c.bottom>2*(c.bottom-x.top)))return!1}}return!0})}(n,t,e):function(n,t,e){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let i=o.parentOffset,r=!i,c=i==o.parent.content.size,p=n.domSelection();return _e.test(o.parent.textContent)&&p.modify?Je(n,t,()=>{let h=p.getRangeAt(0),O=p.focusNode,x=p.focusOffset,J=p.caretBidiLevel;p.modify("move",e,"character");let tt=!(o.depth?n.docView.domAfterPos(o.before()):n.dom).contains(1==p.focusNode.nodeType?p.focusNode:p.focusNode.parentNode)||O==p.focusNode&&x==p.focusOffset;return p.removeAllRanges(),p.addRange(h),null!=J&&(p.caretBidiLevel=J),tt}):"left"==e||"backward"==e?r:c}(n,t,e))}(this,e||this.state,t)}destroy(){!this.docView||(function(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ao(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(n,t){!ne(n,t)&&v[t.type]&&(n.editable||!(t.type in R))&&v[t.type](n,t)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelection(){return this.root.getSelection()}}function Vn(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if("function"==typeof e&&(e=e(n.state)),e)for(let o in e)"class"==o&&(t.class+=" "+e[o]),"style"==o?t.style=(t.style?t.style+";":"")+e[o]:!t[o]&&"contenteditable"!=o&&"nodeName"!=o&&(t[o]=String(e[o]))}),[en.node(0,n.state.doc.content.size,t)]}function jn(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:en.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function _o(n){return!n.someProp("editable",t=>!1===t(n.state))}function Co(n){let t=Object.create(null);function e(o){for(let i in o)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=o[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function To(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);